{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.10.13", "generated_at": "2025-11-08T23:54:58.851953Z", "invocation_id": "67ffa40f-1239-400b-804c-6399f4e5dba6", "invocation_started_at": "2025-11-08T23:54:52.660766Z", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-08T23:54:54.136953Z", "completed_at": "2025-11-08T23:54:54.147587Z"}, {"name": "execute", "started_at": "2025-11-08T23:54:54.147973Z", "completed_at": "2025-11-08T23:54:54.979428Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.8436648845672607, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c0439a-0305-74a0-0004-20ca000270da"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.citrus_trade.stg_trhs", "compiled": true, "compiled_code": "select\n  value:DECLARANT::int as declarant,\n  value:DECLARANT_ISO::string as declarant_iso,\n  value:PARTNER::string as partner,\n  value:PARTNER_ISO::string as partner_iso,\n  value:FLOW::int as flow,\n  value:TRANSPORT_MODE::int as transport_mode,\n  value:PERIOD::int as period,\n  year(to_date(left(period,4),'YYYY')) as year,\n  value:HS4::string as hs4,\n  value:HS4_NAME::string as hs4_name,\n  value:HS6::string as hs6,\n  value:HS6_NAME::string as hs6_name,\n  value:VALUE_IN_EUROS::float as value_in_euros,\n  value:QUANTITY_IN_KG::float as quantity_in_kg\nfrom trade_flow.raw.raw_trhs", "relation_name": "TRADE_FLOW.staging.stg_trhs", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-08T23:54:54.986114Z", "completed_at": "2025-11-08T23:54:54.992830Z"}, {"name": "execute", "started_at": "2025-11-08T23:54:54.993237Z", "completed_at": "2025-11-08T23:54:55.676749Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.6917946338653564, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c0439a-0305-74a0-0004-20ca000270de"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.citrus_trade.trade_by_hs", "compiled": true, "compiled_code": "select\n    *\nfrom TRADE_FLOW.staging.stg_trhs\nwhere hs6 = '080510'", "relation_name": "TRADE_FLOW.marts.trade_by_hs", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-08T23:54:55.684795Z", "completed_at": "2025-11-08T23:54:55.693789Z"}, {"name": "execute", "started_at": "2025-11-08T23:54:55.694284Z", "completed_at": "2025-11-08T23:54:56.330113Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.646822452545166, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c0439a-0305-74a0-0004-20ca000270e2"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.citrus_trade.imports_by_year", "compiled": true, "compiled_code": "select\n    declarant_iso,\n    year,\n    sum(value_in_euros) as revenue,\n    sum(quantity_in_kg) as quantity,\n    revenue/nullif(quantity,0) as price_avg\nfrom TRADE_FLOW.marts.trade_by_hs\nwhere flow = 1\ngroup by 1,2", "relation_name": "TRADE_FLOW.marts.imports_by_year", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-08T23:54:55.689952Z", "completed_at": "2025-11-08T23:54:55.697705Z"}, {"name": "execute", "started_at": "2025-11-08T23:54:55.698077Z", "completed_at": "2025-11-08T23:54:56.353193Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.6643517017364502, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c0439a-0305-74a0-0004-20ca000270e6"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.citrus_trade.imports_exports_2020", "compiled": true, "compiled_code": "select\n    declarant_iso,\n    flow,\n    sum(value_in_euros) over(partition by declarant_iso, flow) as revenue,\n    sum(quantity_in_kg) over(partition by declarant_iso, flow) as quantity,\n    revenue/nullif(quantity,0) as price_avg\nfrom TRADE_FLOW.marts.trade_by_hs\nwhere year = 2020\ngroup by \n    declarant_iso,\n    flow,\n    value_in_euros,\n    quantity_in_kg", "relation_name": "TRADE_FLOW.marts.imports_exports_2020", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-08T23:54:56.355397Z", "completed_at": "2025-11-08T23:54:56.357975Z"}, {"name": "execute", "started_at": "2025-11-08T23:54:56.358184Z", "completed_at": "2025-11-08T23:54:57.105007Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.750220775604248, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c0439a-0305-74a0-0004-20ca000270ee"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.citrus_trade.score_2020", "compiled": true, "compiled_code": "select distinct \n    declarant_iso,\n    revenue,\n    quantity,\n    price_avg,\n    (revenue - min(revenue) over())/((max(revenue) over())-(min(revenue) over())) as revenue_score,\n    (quantity - min(quantity) over())/((max(quantity) over())-(min(quantity) over())) as quantity_score,\n    (price_avg - min(price_avg) over())/((max(price_avg) over())-(min(price_avg) over())) as price_score\nfrom TRADE_FLOW.marts.imports_exports_2020\nwhere flow = 1", "relation_name": "TRADE_FLOW.marts.score_2020", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-08T23:54:56.333350Z", "completed_at": "2025-11-08T23:54:56.336482Z"}, {"name": "execute", "started_at": "2025-11-08T23:54:56.336762Z", "completed_at": "2025-11-08T23:54:57.113019Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.7803523540496826, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c0439a-0305-74a0-0004-20ca000270ea"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.citrus_trade.growth_score", "compiled": true, "compiled_code": "with \n    previous_year AS (\n        select \n            declarant_iso,\n            year,\n            lag(revenue,1) over(partition by declarant_iso order by year) revenue_previous_year,\n            revenue,\n            first_value(revenue) over(partition by declarant_iso order by year) as revenue_first_year,\n            last_value(revenue) over(partition by declarant_iso order by year) as revenue_last_year\n        from TRADE_FLOW.marts.imports_by_year\n    ),\n    growth_speed AS (\n        select \n            declarant_iso,\n            year,\n            revenue_first_year,\n            revenue_last_year,\n            revenue_last_year/nullif(revenue_first_year,0) as growth_overall,\n            revenue_previous_year,\n            revenue,\n            (revenue - revenue_previous_year)/revenue * 100 as growth_speed \n        from previous_year\n    ),\n    previous_year_growth_speed AS (\n        select \n            declarant_iso,\n            year,\n            revenue_first_year,\n            revenue_last_year,\n            growth_overall,\n            revenue_previous_year,\n            revenue,\n            growth_speed,\n            lag(growth_speed,1) over(partition by declarant_iso order by year) growth_speed_previous_year,\n        from growth_speed\n    ),\n    avg_acc AS (\n        select \n            declarant_iso,\n            year,\n            revenue_first_year,\n            revenue_last_year,\n            growth_overall,\n            revenue_previous_year,\n            revenue,\n            growth_speed_previous_year,\n            growth_speed,\n            growth_speed - growth_speed_previous_year as growth_acceleration,\n            avg(growth_acceleration) over(partition by declarant_iso) as avg_acceleration\n        from previous_year_growth_speed\n    ),\n    normalized as (\n        select \n            declarant_iso,\n            year,\n            revenue_first_year,\n            revenue_last_year,\n            growth_overall,\n            (growth_overall - min(growth_overall) OVER())/(max(growth_overall) OVER() - min(growth_overall) OVER()) as growth_overall_norm,\n            revenue_previous_year,\n            revenue,\n            growth_speed_previous_year,\n            growth_speed,\n            growth_acceleration,\n            avg_acceleration,\n            (avg_acceleration - min(avg_acceleration) OVER())/(max(avg_acceleration) OVER() - min(avg_acceleration) OVER()) as avg_acceleration_norm\n        from avg_acc \n    )\n    select \n        declarant_iso,\n        growth_overall_norm * avg_acceleration_norm as growth_score,\n        array_agg(object_construct('year',year,'revenue',cast(revenue as string))) within group (order by year) as revenue_by_year\n    from normalized \n    group by 1,2", "relation_name": "TRADE_FLOW.marts.growth_score", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-08T23:54:57.118417Z", "completed_at": "2025-11-08T23:54:57.124150Z"}, {"name": "execute", "started_at": "2025-11-08T23:54:57.124744Z", "completed_at": "2025-11-08T23:54:57.925022Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.8080534934997559, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c0439a-0305-74a0-0004-20ca000270f2"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.citrus_trade.imports_score", "compiled": true, "compiled_code": "select distinct\n    sc.declarant_iso,\n    sc.revenue as revenue_2020,\n    sc.quantity as quantity_2020,\n    sc.price_avg as price_avg_2020,\n    gs.revenue_by_year,\n    sc.revenue_score,\n    sc.quantity_score,\n    sc.price_score,\n    gs.growth_score\nfrom TRADE_FLOW.marts.score_2020 as sc\ninner join TRADE_FLOW.marts.growth_score as gs\n    on gs.declarant_iso = sc.declarant_iso", "relation_name": "TRADE_FLOW.marts.imports_score", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-08T23:54:57.932723Z", "completed_at": "2025-11-08T23:54:57.939829Z"}, {"name": "execute", "started_at": "2025-11-08T23:54:57.940319Z", "completed_at": "2025-11-08T23:54:58.536617Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.6054539680480957, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01c0439a-0305-74a0-0004-20ca000270f6"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.citrus_trade.imports_score_unpivot", "compiled": true, "compiled_code": "with \n    scores as (\n        select \n            declarant_iso,\n            score_type,\n            score\n        from TRADE_FLOW.marts.imports_score\n        unpivot (\n            score for score_type in (\n                revenue_score as \"revenue\",\n                quantity_score as \"quantity\",\n                price_score as \"price\",\n                growth_score as \"growth\"\n            )\n        )\n    ),\n    metrics as (\n        select \n            declarant_iso,\n            metric_type,\n            metric\n        from TRADE_FLOW.marts.imports_score\n        unpivot (\n            metric for metric_type in (\n                revenue_2020 as \"revenue\",\n                quantity_2020 as \"quantity\",\n                price_avg_2020 as \"price\"\n            )\n        )\n    )\nselect \n    s.declarant_iso,\n    s.score_type,\n    s.score,\n    m.metric,\n    case \n        when s.score_type = 'revenue' then 'Euro'\n        when s.score_type = 'quantity' then 'Kg'\n        when s.score_type = 'price' then 'Euro per Kg'\n    end as metric_unit\nfrom scores as s\nleft join metrics as m\n    on s.declarant_iso = m.declarant_iso\n    and s.score_type = m.metric_type", "relation_name": "TRADE_FLOW.analytics.imports_score_unpivot", "batch_results": null}], "elapsed_time": 5.535197496414185, "args": {"upload_to_artifacts_ingest_api": false, "partial_parse_file_diff": true, "defer": false, "use_fast_test_edges": false, "cache_selected_only": false, "exclude": [], "require_explicit_package_overrides_for_builtin_materializations": true, "require_generic_test_arguments_property": true, "state_modified_compare_more_unrendered_values": false, "introspect": true, "macro_debugging": false, "quiet": false, "version_check": true, "which": "run", "profiles_dir": "/opt/airflow/dbt", "require_resource_names_without_spaces": true, "validate_macro_args": false, "log_format": "default", "static_parser": true, "empty": false, "show_resource_report": false, "indirect_selection": "eager", "require_all_warnings_handled_by_warn_error": false, "warn_error_options": {"error": [], "warn": [], "silence": []}, "print": true, "show_all_deprecations": false, "require_yaml_configuration_for_mf_time_spines": false, "populate_cache": true, "require_batched_execution_for_custom_microbatch_strategy": false, "write_json": true, "log_path": "/opt/airflow/dbt/logs", "log_level_file": "debug", "favor_state": false, "invocation_command": "dbt run", "send_anonymous_usage_stats": true, "require_nested_cumulative_type_params": false, "log_format_file": "debug", "select": [], "source_freshness_run_project_hooks": true, "printer_width": 80, "use_colors": true, "skip_nodes_if_on_run_start_fails": false, "vars": {}, "log_level": "info", "project_dir": "/opt/airflow/dbt", "strict_mode": false, "state_modified_compare_vars": false, "use_colors_file": true, "log_file_max_bytes": 10485760, "partial_parse": true}}