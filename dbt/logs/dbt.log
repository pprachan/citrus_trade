[0m00:55:23.460499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac5d3a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac3ebec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac2fcc20>]}


============================== 00:55:23.475651 | c151ed3a-eeb8-4112-834c-f6d8dc7149ae ==============================
[0m00:55:23.475651 [info ] [MainThread]: Running with dbt=1.10.13
[0m00:55:23.476292 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'invocation_command': 'dbt docs serve --profiles-dir . --target dev --port 8085', 'partial_parse': 'True', 'empty': 'None', 'target_path': 'None', 'introspect': 'True', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '.', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'write_json': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'no_print': 'None', 'use_colors': 'True', 'log_cache_events': 'False', 'debug': 'False', 'fail_fast': 'False', 'cache_selected_only': 'False', 'log_path': '/opt/airflow/dbt/logs', 'indirect_selection': 'eager', 'printer_width': '80'}
[0m00:55:25.852175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c151ed3a-eeb8-4112-834c-f6d8dc7149ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ffcff20>]}
[0m00:55:25.888026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c151ed3a-eeb8-4112-834c-f6d8dc7149ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffabc61ee0>]}
[0m00:55:25.929007 [error] [MainThread]: Encountered an error:
[Errno 2] No such file or directory: '/opt/airflow/dbt/target'
[0m00:55:25.930963 [error] [MainThread]: Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/cli/requires.py", line 178, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/cli/requires.py", line 128, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/cli/requires.py", line 272, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/cli/requires.py", line 303, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/cli/requires.py", line 350, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/cli/main.py", line 307, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/task/docs/serve.py", line 15, in run
    os.chdir(self.config.project_target_path)
FileNotFoundError: [Errno 2] No such file or directory: '/opt/airflow/dbt/target'

[0m00:55:25.932568 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_success": false, "command_wall_clock_time": 2.5425813, "process_in_blocks": "40880", "process_kernel_time": 0.747125, "process_mem_max_rss": "209324", "process_out_blocks": "22646", "process_user_time": 4.435726}
[0m00:55:25.933439 [debug] [MainThread]: Command `dbt docs serve` failed at 00:55:25.933341 after 2.54 seconds
[0m00:55:25.933765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac2c86e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90005d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90292b70>]}
[0m00:55:25.934032 [debug] [MainThread]: Flushing usage events
[0m00:55:26.410986 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:55:34.014090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff885a9fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff885a8050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ad39a00>]}


============================== 00:55:34.019438 | 08dadce3-6575-41d3-8aba-cf38eb7720cc ==============================
[0m00:55:34.019438 [info ] [MainThread]: Running with dbt=1.10.13
[0m00:55:34.019848 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'indirect_selection': 'eager', 'quiet': 'False', 'target_path': 'None', 'partial_parse': 'True', 'cache_selected_only': 'False', 'printer_width': '80', 'introspect': 'True', 'write_json': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_cache_events': 'False', 'log_format': 'default', 'no_print': 'None', 'log_path': '/opt/airflow/dbt/logs', 'invocation_command': 'dbt docs serve --profiles-dir . --target dev --port 8085', 'empty': 'None', 'profiles_dir': '.', 'send_anonymous_usage_stats': 'True'}
[0m00:55:34.596800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '08dadce3-6575-41d3-8aba-cf38eb7720cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6e12dbb0>]}
[0m00:55:34.637073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '08dadce3-6575-41d3-8aba-cf38eb7720cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6c9f7dd0>]}
[0m00:55:34.653819 [error] [MainThread]: Encountered an error:
[Errno 2] No such file or directory: '/opt/airflow/dbt/target'
[0m00:55:34.655003 [error] [MainThread]: Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/cli/requires.py", line 178, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/cli/requires.py", line 128, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/cli/requires.py", line 272, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/cli/requires.py", line 303, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/cli/requires.py", line 350, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/cli/main.py", line 307, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/task/docs/serve.py", line 15, in run
    os.chdir(self.config.project_target_path)
FileNotFoundError: [Errno 2] No such file or directory: '/opt/airflow/dbt/target'

[0m00:55:34.656183 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_success": false, "command_wall_clock_time": 0.67280006, "process_in_blocks": "0", "process_kernel_time": 0.340373, "process_mem_max_rss": "204824", "process_out_blocks": "6", "process_user_time": 2.427457}
[0m00:55:34.656928 [debug] [MainThread]: Command `dbt docs serve` failed at 00:55:34.656834 after 0.67 seconds
[0m00:55:34.657262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88c8a2a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6cd47380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff880539b0>]}
[0m00:55:34.657591 [debug] [MainThread]: Flushing usage events
[0m00:55:35.110466 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:55:42.116514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f1345c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8efc9700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ea47fb0>]}


============================== 00:55:42.124671 | 875d43a4-d27b-4e89-b3ff-8ae4eb463267 ==============================
[0m00:55:42.124671 [info ] [MainThread]: Running with dbt=1.10.13
[0m00:55:42.125697 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'log_cache_events': 'False', 'log_path': '/opt/airflow/dbt/logs', 'partial_parse': 'True', 'invocation_command': 'dbt docs serve --profiles-dir . --target dev --port 8085', 'fail_fast': 'False', 'version_check': 'True', 'use_experimental_parser': 'False', 'log_format': 'default', 'printer_width': '80', 'debug': 'False', 'empty': 'None', 'indirect_selection': 'eager', 'profiles_dir': '.', 'use_colors': 'True', 'write_json': 'True', 'cache_selected_only': 'False', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'introspect': 'True', 'warn_error': 'None', 'quiet': 'False'}
[0m00:55:43.356916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '875d43a4-d27b-4e89-b3ff-8ae4eb463267', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff72b685f0>]}
[0m00:55:43.419693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '875d43a4-d27b-4e89-b3ff-8ae4eb463267', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e9b2a20>]}
[0m00:55:43.440162 [error] [MainThread]: Encountered an error:
[Errno 2] No such file or directory: '/opt/airflow/dbt/target'
[0m00:55:43.441769 [error] [MainThread]: Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/cli/requires.py", line 178, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/cli/requires.py", line 128, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/cli/requires.py", line 272, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/cli/requires.py", line 303, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/cli/requires.py", line 350, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/cli/main.py", line 307, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/task/docs/serve.py", line 15, in run
    os.chdir(self.config.project_target_path)
FileNotFoundError: [Errno 2] No such file or directory: '/opt/airflow/dbt/target'

[0m00:55:43.443245 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_success": false, "command_wall_clock_time": 1.3672204, "process_in_blocks": "0", "process_kernel_time": 0.594297, "process_mem_max_rss": "204844", "process_out_blocks": "6", "process_user_time": 3.677419}
[0m00:55:43.444440 [debug] [MainThread]: Command `dbt docs serve` failed at 00:55:43.444323 after 1.37 seconds
[0m00:55:43.444997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e1e56d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff734f1a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7286bf50>]}
[0m00:55:43.445766 [debug] [MainThread]: Flushing usage events
[0m00:55:43.907504 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:55:52.082305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b7ad220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9aefda00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a769820>]}


============================== 00:55:52.089245 | 986339f2-866a-4ba4-9a99-baeb0b3bb5d8 ==============================
[0m00:55:52.089245 [info ] [MainThread]: Running with dbt=1.10.13
[0m00:55:52.089793 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'static_parser': 'True', 'indirect_selection': 'eager', 'introspect': 'True', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'fail_fast': 'False', 'empty': 'None', 'quiet': 'False', 'log_format': 'default', 'log_cache_events': 'False', 'no_print': 'None', 'log_path': '/opt/airflow/dbt/logs', 'cache_selected_only': 'False', 'partial_parse': 'True', 'warn_error': 'None', 'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True', 'invocation_command': 'dbt docs serve --profiles-dir . --target dev --port 8085', 'printer_width': '80', 'profiles_dir': '.', 'write_json': 'True'}
[0m00:55:52.849571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '986339f2-866a-4ba4-9a99-baeb0b3bb5d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f37b8c0>]}
[0m00:55:52.883702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '986339f2-866a-4ba4-9a99-baeb0b3bb5d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f0ba900>]}
[0m00:55:52.899478 [error] [MainThread]: Encountered an error:
[Errno 2] No such file or directory: '/opt/airflow/dbt/target'
[0m00:55:52.900753 [error] [MainThread]: Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/cli/requires.py", line 178, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/cli/requires.py", line 128, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/cli/requires.py", line 272, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/cli/requires.py", line 303, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/cli/requires.py", line 350, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/cli/main.py", line 307, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/task/docs/serve.py", line 15, in run
    os.chdir(self.config.project_target_path)
FileNotFoundError: [Errno 2] No such file or directory: '/opt/airflow/dbt/target'

[0m00:55:52.901965 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_success": false, "command_wall_clock_time": 0.8614258, "process_in_blocks": "24", "process_kernel_time": 0.499952, "process_mem_max_rss": "204864", "process_out_blocks": "6", "process_user_time": 3.218507}
[0m00:55:52.902567 [debug] [MainThread]: Command `dbt docs serve` failed at 00:55:52.902477 after 0.86 seconds
[0m00:55:52.902919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a819a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ec8a540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ecc1a60>]}
[0m00:55:52.903173 [debug] [MainThread]: Flushing usage events
[0m00:55:53.365351 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:56:00.185525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf3c0950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaed99700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaed6cb30>]}


============================== 00:56:00.191902 | b643941a-c873-46d1-a0d7-91b80bdf78d4 ==============================
[0m00:56:00.191902 [info ] [MainThread]: Running with dbt=1.10.13
[0m00:56:00.192864 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '.', 'invocation_command': 'dbt docs serve --profiles-dir . --target dev --port 8085', 'log_format': 'default', 'printer_width': '80', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'debug': 'False', 'target_path': 'None', 'empty': 'None', 'use_colors': 'True', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'static_parser': 'True', 'quiet': 'False', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'partial_parse': 'True', 'introspect': 'True', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'write_json': 'True', 'use_experimental_parser': 'False'}
[0m00:56:00.763680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b643941a-c873-46d1-a0d7-91b80bdf78d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff943bd010>]}
[0m00:56:00.796808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b643941a-c873-46d1-a0d7-91b80bdf78d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae1e73e0>]}
[0m00:56:00.810533 [error] [MainThread]: Encountered an error:
[Errno 2] No such file or directory: '/opt/airflow/dbt/target'
[0m00:56:00.811541 [error] [MainThread]: Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/cli/requires.py", line 178, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/cli/requires.py", line 128, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/cli/requires.py", line 272, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/cli/requires.py", line 303, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/cli/requires.py", line 350, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/cli/main.py", line 307, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/task/docs/serve.py", line 15, in run
    os.chdir(self.config.project_target_path)
FileNotFoundError: [Errno 2] No such file or directory: '/opt/airflow/dbt/target'

[0m00:56:00.812433 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_success": false, "command_wall_clock_time": 0.66096294, "process_in_blocks": "0", "process_kernel_time": 0.265899, "process_mem_max_rss": "204968", "process_out_blocks": "6", "process_user_time": 2.396127}
[0m00:56:00.813058 [debug] [MainThread]: Command `dbt docs serve` failed at 00:56:00.812989 after 0.66 seconds
[0m00:56:00.813303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf06bb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93010f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92a44290>]}
[0m00:56:00.813523 [debug] [MainThread]: Flushing usage events
[0m00:56:01.312850 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:56:07.799875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97cf1fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff951bfaa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95b1cfb0>]}


============================== 00:56:07.805927 | c4cfefaa-a52b-40e4-a263-06a8c8f05170 ==============================
[0m00:56:07.805927 [info ] [MainThread]: Running with dbt=1.10.13
[0m00:56:07.806331 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'quiet': 'False', 'use_colors': 'True', 'log_path': '/opt/airflow/dbt/logs', 'log_format': 'default', 'warn_error': 'None', 'log_cache_events': 'False', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'invocation_command': 'dbt docs serve --profiles-dir . --target dev --port 8085', 'cache_selected_only': 'False', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_experimental_parser': 'False', 'empty': 'None', 'write_json': 'True', 'target_path': 'None', 'static_parser': 'True', 'indirect_selection': 'eager', 'profiles_dir': '.', 'version_check': 'True', 'debug': 'False', 'no_print': 'None'}
[0m00:56:08.318514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c4cfefaa-a52b-40e4-a263-06a8c8f05170', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff794a2c00>]}
[0m00:56:08.352619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c4cfefaa-a52b-40e4-a263-06a8c8f05170', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff79b52f30>]}
[0m00:56:08.366028 [error] [MainThread]: Encountered an error:
[Errno 2] No such file or directory: '/opt/airflow/dbt/target'
[0m00:56:08.367033 [error] [MainThread]: Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/cli/requires.py", line 178, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/cli/requires.py", line 128, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/cli/requires.py", line 272, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/cli/requires.py", line 303, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/cli/requires.py", line 350, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/cli/main.py", line 307, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/task/docs/serve.py", line 15, in run
    os.chdir(self.config.project_target_path)
FileNotFoundError: [Errno 2] No such file or directory: '/opt/airflow/dbt/target'

[0m00:56:08.367920 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_success": false, "command_wall_clock_time": 0.59879994, "process_in_blocks": "0", "process_kernel_time": 0.172638, "process_mem_max_rss": "204816", "process_out_blocks": "6", "process_user_time": 2.298185}
[0m00:56:08.368565 [debug] [MainThread]: Command `dbt docs serve` failed at 00:56:08.368502 after 0.60 seconds
[0m00:56:08.368810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95585640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95247770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94c2f1a0>]}
[0m00:56:08.369024 [debug] [MainThread]: Flushing usage events
[0m00:56:08.842408 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:56:18.430642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9221db80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91f39a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f74d610>]}


============================== 00:56:18.465061 | b9b413ff-845b-4762-8042-6f4238568199 ==============================
[0m00:56:18.465061 [info ] [MainThread]: Running with dbt=1.10.13
[0m00:56:18.466994 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'fail_fast': 'False', 'write_json': 'True', 'invocation_command': 'dbt docs serve --profiles-dir . --target dev --port 8085', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'None', 'send_anonymous_usage_stats': 'True', 'log_path': '/opt/airflow/dbt/logs', 'target_path': 'None', 'profiles_dir': '.', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_format': 'default', 'debug': 'False', 'quiet': 'False', 'version_check': 'True', 'cache_selected_only': 'False', 'use_colors': 'True', 'partial_parse': 'True', 'no_print': 'None', 'printer_width': '80'}
[0m00:56:19.572126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b9b413ff-845b-4762-8042-6f4238568199', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff73a40470>]}
[0m00:56:19.661940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b9b413ff-845b-4762-8042-6f4238568199', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff73881e50>]}
[0m00:56:19.701391 [error] [MainThread]: Encountered an error:
[Errno 2] No such file or directory: '/opt/airflow/dbt/target'
[0m00:56:19.708308 [error] [MainThread]: Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/cli/requires.py", line 178, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/cli/requires.py", line 128, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/cli/requires.py", line 272, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/cli/requires.py", line 303, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/cli/requires.py", line 350, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/cli/main.py", line 307, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/task/docs/serve.py", line 15, in run
    os.chdir(self.config.project_target_path)
FileNotFoundError: [Errno 2] No such file or directory: '/opt/airflow/dbt/target'

[0m00:56:19.712330 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_success": false, "command_wall_clock_time": 1.4983724, "process_in_blocks": "0", "process_kernel_time": 0.719698, "process_mem_max_rss": "204716", "process_out_blocks": "6", "process_user_time": 3.551605}
[0m00:56:19.718015 [debug] [MainThread]: Command `dbt docs serve` failed at 00:56:19.717836 after 1.51 seconds
[0m00:56:19.723340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f74c8f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff74182cc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff738e2480>]}
[0m00:56:19.725088 [debug] [MainThread]: Flushing usage events
[0m00:56:20.230613 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:56:33.720068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffadb52360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffade79700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffabe0a900>]}


============================== 00:56:33.726183 | e2061129-361b-4436-bd29-890cde453c19 ==============================
[0m00:56:33.726183 [info ] [MainThread]: Running with dbt=1.10.13
[0m00:56:33.726661 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'introspect': 'True', 'printer_width': '80', 'invocation_command': 'dbt docs serve --profiles-dir . --target dev --port 8085', 'log_cache_events': 'False', 'quiet': 'False', 'version_check': 'True', 'empty': 'None', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'profiles_dir': '.', 'no_print': 'None', 'cache_selected_only': 'False', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'use_colors': 'True', 'log_format': 'default', 'indirect_selection': 'eager', 'static_parser': 'True', 'write_json': 'True'}
[0m00:56:34.409435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e2061129-361b-4436-bd29-890cde453c19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffab6dc5f0>]}
[0m00:56:34.443399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e2061129-361b-4436-bd29-890cde453c19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91cae5a0>]}
[0m00:56:34.460528 [error] [MainThread]: Encountered an error:
[Errno 2] No such file or directory: '/opt/airflow/dbt/target'
[0m00:56:34.462049 [error] [MainThread]: Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/cli/requires.py", line 178, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/cli/requires.py", line 128, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/cli/requires.py", line 272, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/cli/requires.py", line 303, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/cli/requires.py", line 350, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/cli/main.py", line 307, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/task/docs/serve.py", line 15, in run
    os.chdir(self.config.project_target_path)
FileNotFoundError: [Errno 2] No such file or directory: '/opt/airflow/dbt/target'

[0m00:56:34.463496 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_success": false, "command_wall_clock_time": 0.7785609, "process_in_blocks": "30688", "process_kernel_time": 0.390056, "process_mem_max_rss": "204836", "process_out_blocks": "6", "process_user_time": 2.661031}
[0m00:56:34.465298 [debug] [MainThread]: Command `dbt docs serve` failed at 00:56:34.465062 after 0.78 seconds
[0m00:56:34.466063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffab537320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffabe09940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffabcc1970>]}
[0m00:56:34.466495 [debug] [MainThread]: Flushing usage events
[0m00:56:34.973353 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:10:32.273923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88beea80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89e7da30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8790a5d0>]}


============================== 01:10:32.279721 | 64ca0492-670a-4f73-8cc2-b223a127f0c2 ==============================
[0m01:10:32.279721 [info ] [MainThread]: Running with dbt=1.10.13
[0m01:10:32.280368 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'empty': 'None', 'version_check': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'target_path': 'None', 'use_colors': 'True', 'debug': 'False', 'log_cache_events': 'False', 'no_print': 'None', 'partial_parse': 'True', 'fail_fast': 'False', 'profiles_dir': '.', 'write_json': 'True', 'use_experimental_parser': 'False', 'printer_width': '80', 'log_path': '/opt/airflow/dbt/logs', 'invocation_command': 'dbt deps --profiles-dir . --target dev', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'cache_selected_only': 'False', 'warn_error': 'None', 'quiet': 'False'}
[0m01:10:32.353077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '64ca0492-670a-4f73-8cc2-b223a127f0c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff872bf6e0>]}
[0m01:10:32.366446 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m01:10:32.368808 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m01:10:32.370466 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.122753456, "process_in_blocks": "0", "process_kernel_time": 0.181763, "process_mem_max_rss": "103140", "process_out_blocks": "3227", "process_user_time": 0.976726}
[0m01:10:32.371678 [debug] [MainThread]: Command `dbt deps` succeeded at 01:10:32.371585 after 0.12 seconds
[0m01:10:32.372048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87ca3f80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff895a4ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff872c47d0>]}
[0m01:10:32.372520 [debug] [MainThread]: Flushing usage events
[0m01:10:32.901568 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:10:33.884594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa93de930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa924ae70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa93de5a0>]}


============================== 01:10:33.886751 | eae8de0f-fc6a-498c-8ca3-a8396e7b37f9 ==============================
[0m01:10:33.886751 [info ] [MainThread]: Running with dbt=1.10.13
[0m01:10:33.887211 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'debug': 'False', 'log_format': 'default', 'write_json': 'True', 'log_cache_events': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'introspect': 'True', 'empty': 'False', 'invocation_command': 'dbt run --profiles-dir . --target dev', 'profiles_dir': '.', 'use_experimental_parser': 'False', 'log_path': '/opt/airflow/dbt/logs', 'quiet': 'False', 'use_colors': 'True', 'fail_fast': 'False', 'static_parser': 'True', 'version_check': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'printer_width': '80', 'indirect_selection': 'eager', 'partial_parse': 'True'}
[0m01:10:34.201424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'eae8de0f-fc6a-498c-8ca3-a8396e7b37f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7fc63c0>]}
[0m01:10:34.238685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'eae8de0f-fc6a-498c-8ca3-a8396e7b37f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaaad1f10>]}
[0m01:10:34.239557 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m01:10:34.307667 [debug] [MainThread]: checksum: 87546e06832e1286bf2d49b8b108dd3f58da97cbfca650a1f147ec4aedfbbf25, vars: {}, profile: , target: dev, version: 1.10.13
[0m01:10:34.309594 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m01:10:34.310357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'eae8de0f-fc6a-498c-8ca3-a8396e7b37f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7d92cc0>]}
[0m01:10:35.087410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'eae8de0f-fc6a-498c-8ca3-a8396e7b37f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa71ebef0>]}
[0m01:10:35.159011 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m01:10:35.162796 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m01:10:35.185129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'eae8de0f-fc6a-498c-8ca3-a8396e7b37f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa695a690>]}
[0m01:10:35.185922 [info ] [MainThread]: Found 2 models, 2 sources, 492 macros
[0m01:10:35.186586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eae8de0f-fc6a-498c-8ca3-a8396e7b37f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa72d5190>]}
[0m01:10:35.190684 [info ] [MainThread]: 
[0m01:10:35.191543 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m01:10:35.192849 [info ] [MainThread]: 
[0m01:10:35.194328 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:10:35.201673 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JAFFLE_SHOP'
[0m01:10:35.252176 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP"
[0m01:10:35.252674 [debug] [ThreadPool]: On list_JAFFLE_SHOP: show terse schemas in database JAFFLE_SHOP
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_JAFFLE_SHOP"} */
[0m01:10:35.253210 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:10:38.914127 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 3.661 seconds
[0m01:10:38.920139 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_JAFFLE_SHOP, now list_JAFFLE_SHOP_ANALYTICS)
[0m01:10:38.936822 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP_ANALYTICS"
[0m01:10:38.937357 [debug] [ThreadPool]: On list_JAFFLE_SHOP_ANALYTICS: show objects in JAFFLE_SHOP.ANALYTICS
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_JAFFLE_SHOP_ANALYTICS"} */;
[0m01:10:39.297232 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.359 seconds
[0m01:10:39.304051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eae8de0f-fc6a-498c-8ca3-a8396e7b37f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa89eaf00>]}
[0m01:10:39.314927 [debug] [Thread-1 (]: Began running node model.jaffle_shop.customers
[0m01:10:39.315478 [debug] [Thread-2 (]: Began running node model.jaffle_shop.first_model
[0m01:10:39.316141 [info ] [Thread-1 (]: 1 of 2 START sql table model ANALYTICS.customers ............................... [RUN]
[0m01:10:39.317049 [info ] [Thread-2 (]: 2 of 2 START sql view model ANALYTICS.first_model .............................. [RUN]
[0m01:10:39.318424 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_JAFFLE_SHOP_ANALYTICS, now model.jaffle_shop.customers)
[0m01:10:39.319559 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.jaffle_shop.first_model'
[0m01:10:39.320201 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.customers
[0m01:10:39.320642 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.first_model
[0m01:10:39.329451 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.customers"
[0m01:10:39.331394 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.first_model"
[0m01:10:39.335923 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.customers
[0m01:10:39.342139 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.first_model
[0m01:10:39.381740 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.customers"
[0m01:10:39.382358 [debug] [Thread-2 (]: Writing runtime sql for node "model.jaffle_shop.first_model"
[0m01:10:39.385328 [debug] [Thread-1 (]: Using snowflake connection "model.jaffle_shop.customers"
[0m01:10:39.385792 [debug] [Thread-1 (]: On model.jaffle_shop.customers: create or replace transient table JAFFLE_SHOP.ANALYTICS.customers
    
    
    
    as (SELECT
    id
    ,split_part(name,' ',1) as first_name
    ,split_part(name,' ',2) as last_name
FROM JAFFLE_SHOP.RAW.customers
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */;
[0m01:10:39.388201 [debug] [Thread-2 (]: Using snowflake connection "model.jaffle_shop.first_model"
[0m01:10:39.388538 [debug] [Thread-2 (]: On model.jaffle_shop.first_model: create or replace   view JAFFLE_SHOP.ANALYTICS.first_model
  
  
  
  
  as (
    with customers as (

    select
        id as customer_id,
        name

    from jaffle_shop.raw.customers

),

orders as (

    select
        id as order_id,
        customer as customer_id,
        ordered_at
    from jaffle_shop.raw.orders

),

customer_orders as (

    select
        customer_id,
        min(ordered_at) as first_order_date,
        max(ordered_at) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
  )
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.first_model"} */;
[0m01:10:39.388855 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m01:10:40.744897 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.358 seconds
[0m01:10:40.776068 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eae8de0f-fc6a-498c-8ca3-a8396e7b37f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffab4f9850>]}
[0m01:10:40.777018 [info ] [Thread-1 (]: 1 of 2 OK created sql table model ANALYTICS.customers .......................... [[32mSUCCESS 1[0m in 1.46s]
[0m01:10:40.777850 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.customers
[0m01:10:41.297990 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.909 seconds
[0m01:10:41.304975 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eae8de0f-fc6a-498c-8ca3-a8396e7b37f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa723cf50>]}
[0m01:10:41.306364 [info ] [Thread-2 (]: 2 of 2 OK created sql view model ANALYTICS.first_model ......................... [[32mSUCCESS 1[0m in 1.99s]
[0m01:10:41.308224 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.first_model
[0m01:10:41.312014 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:10:41.312698 [debug] [MainThread]: Connection 'model.jaffle_shop.customers' was left open.
[0m01:10:41.313298 [debug] [MainThread]: On model.jaffle_shop.customers: Close
[0m01:10:41.488549 [debug] [MainThread]: Connection 'model.jaffle_shop.first_model' was left open.
[0m01:10:41.490283 [debug] [MainThread]: On model.jaffle_shop.first_model: Close
[0m01:10:41.629338 [info ] [MainThread]: 
[0m01:10:41.630905 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 6.43 seconds (6.43s).
[0m01:10:41.633332 [debug] [MainThread]: Command end result
[0m01:10:41.673836 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m01:10:41.677124 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m01:10:41.682600 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/target/run_results.json
[0m01:10:41.682840 [info ] [MainThread]: 
[0m01:10:41.683249 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:10:41.683719 [info ] [MainThread]: 
[0m01:10:41.684217 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m01:10:41.686843 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.828772, "process_in_blocks": "0", "process_kernel_time": 0.514594, "process_mem_max_rss": "160040", "process_out_blocks": "5583", "process_user_time": 2.543708}
[0m01:10:41.687853 [debug] [MainThread]: Command `dbt run` succeeded at 01:10:41.687503 after 7.83 seconds
[0m01:10:41.688579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa99b1730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9b28560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9b29490>]}
[0m01:10:41.689117 [debug] [MainThread]: Flushing usage events
[0m01:10:42.164152 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:10:43.392263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91ac6bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90c186e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9351e1b0>]}


============================== 01:10:43.394693 | 7bd9bd42-6735-458e-8529-503e7057304c ==============================
[0m01:10:43.394693 [info ] [MainThread]: Running with dbt=1.10.13
[0m01:10:43.395112 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'use_colors': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'version_check': 'True', 'partial_parse': 'True', 'no_print': 'None', 'printer_width': '80', 'introspect': 'True', 'indirect_selection': 'eager', 'debug': 'False', 'log_format': 'default', 'warn_error': 'None', 'empty': 'None', 'profiles_dir': '.', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt docs generate --profiles-dir . --target dev', 'log_path': '/opt/airflow/dbt/logs', 'static_parser': 'True', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'write_json': 'True', 'cache_selected_only': 'False'}
[0m01:10:43.596218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7bd9bd42-6735-458e-8529-503e7057304c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90b88530>]}
[0m01:10:43.626298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7bd9bd42-6735-458e-8529-503e7057304c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8fc385c0>]}
[0m01:10:43.626758 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m01:10:43.678857 [debug] [MainThread]: checksum: 87546e06832e1286bf2d49b8b108dd3f58da97cbfca650a1f147ec4aedfbbf25, vars: {}, profile: , target: dev, version: 1.10.13
[0m01:10:43.780746 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:10:43.781081 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:10:43.797269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7bd9bd42-6735-458e-8529-503e7057304c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f057920>]}
[0m01:10:43.805438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7bd9bd42-6735-458e-8529-503e7057304c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ed555e0>]}
[0m01:10:43.805695 [info ] [MainThread]: Found 2 models, 2 sources, 492 macros
[0m01:10:43.805954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7bd9bd42-6735-458e-8529-503e7057304c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9090dc10>]}
[0m01:10:43.807082 [info ] [MainThread]: 
[0m01:10:43.807438 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m01:10:43.807840 [info ] [MainThread]: 
[0m01:10:43.808317 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:10:43.810840 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JAFFLE_SHOP_ANALYTICS'
[0m01:10:43.846546 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP_ANALYTICS"
[0m01:10:43.846877 [debug] [ThreadPool]: On list_JAFFLE_SHOP_ANALYTICS: show objects in JAFFLE_SHOP.ANALYTICS
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_JAFFLE_SHOP_ANALYTICS"} */;
[0m01:10:43.847048 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:10:44.368264 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.521 seconds
[0m01:10:44.374812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7bd9bd42-6735-458e-8529-503e7057304c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90e06840>]}
[0m01:10:44.380813 [debug] [Thread-1 (]: Began running node model.jaffle_shop.customers
[0m01:10:44.381581 [debug] [Thread-2 (]: Began running node model.jaffle_shop.first_model
[0m01:10:44.382309 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_JAFFLE_SHOP_ANALYTICS, now model.jaffle_shop.customers)
[0m01:10:44.383334 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.jaffle_shop.first_model'
[0m01:10:44.383917 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.customers
[0m01:10:44.384496 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.first_model
[0m01:10:44.395326 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.customers"
[0m01:10:44.397433 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.first_model"
[0m01:10:44.399364 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.customers
[0m01:10:44.400317 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.customers
[0m01:10:44.400672 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.first_model
[0m01:10:44.401617 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.first_model
[0m01:10:44.403151 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:10:44.403476 [debug] [MainThread]: Connection 'model.jaffle_shop.customers' was left open.
[0m01:10:44.403762 [debug] [MainThread]: On model.jaffle_shop.customers: Close
[0m01:10:44.518681 [debug] [MainThread]: Connection 'model.jaffle_shop.first_model' was properly closed.
[0m01:10:44.520446 [debug] [MainThread]: Command end result
[0m01:10:44.592798 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m01:10:44.594232 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m01:10:44.598277 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/target/run_results.json
[0m01:10:44.602391 [debug] [MainThread]: Acquiring new snowflake connection 'generate_catalog'
[0m01:10:44.602572 [info ] [MainThread]: Building catalog
[0m01:10:44.608358 [debug] [ThreadPool]: Acquiring new snowflake connection 'JAFFLE_SHOP.information_schema'
[0m01:10:44.617766 [debug] [ThreadPool]: Using snowflake connection "JAFFLE_SHOP.information_schema"
[0m01:10:44.618128 [debug] [ThreadPool]: On JAFFLE_SHOP.information_schema: with tables as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",
        case
            when is_dynamic = 'YES' and table_type = 'BASE TABLE' THEN 'DYNAMIC TABLE'
            else table_type
        end as "table_type",
        comment as "table_comment",

        -- note: this is the _role_ that owns the table
        table_owner as "table_owner",

        'Clustering Key' as "stats:clustering_key:label",
        clustering_key as "stats:clustering_key:value",
        'The key used to cluster this table' as "stats:clustering_key:description",
        (clustering_key is not null) as "stats:clustering_key:include",

        'Row Count' as "stats:row_count:label",
        row_count as "stats:row_count:value",
        'An approximate count of rows in this table' as "stats:row_count:description",
        (row_count is not null) as "stats:row_count:include",

        'Approximate Size' as "stats:bytes:label",
        bytes as "stats:bytes:value",
        'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
        (bytes is not null) as "stats:bytes:include",

        'Last Modified' as "stats:last_modified:label",
        to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
        'The timestamp for last update/change' as "stats:last_modified:description",
        (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"
    from JAFFLE_SHOP.INFORMATION_SCHEMA.tables
            where (
                (
                    
    "table_schema" ilike 'ANALYTICS' and upper("table_schema") = upper('ANALYTICS')

                    and 
    "table_name" ilike 'first_model' and upper("table_name") = upper('first_model')

                )
             or 
                (
                    
    "table_schema" ilike 'ANALYTICS' and upper("table_schema") = upper('ANALYTICS')

                    and 
    "table_name" ilike 'customers' and upper("table_name") = upper('customers')

                )
             or 
                (
                    
    "table_schema" ilike 'RAW' and upper("table_schema") = upper('RAW')

                    and 
    "table_name" ilike 'customers' and upper("table_name") = upper('customers')

                )
             or 
                (
                    
    "table_schema" ilike 'RAW' and upper("table_schema") = upper('RAW')

                    and 
    "table_name" ilike 'orders' and upper("table_name") = upper('orders')

                )
            )
        ),
        columns as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",

        column_name as "column_name",
        ordinal_position as "column_index",
        data_type as "column_type",
        comment as "column_comment"
    from JAFFLE_SHOP.INFORMATION_SCHEMA.columns
            where (
                (
                    
    "table_schema" ilike 'ANALYTICS' and upper("table_schema") = upper('ANALYTICS')

                    and 
    "table_name" ilike 'first_model' and upper("table_name") = upper('first_model')

                )
             or 
                (
                    
    "table_schema" ilike 'ANALYTICS' and upper("table_schema") = upper('ANALYTICS')

                    and 
    "table_name" ilike 'customers' and upper("table_name") = upper('customers')

                )
             or 
                (
                    
    "table_schema" ilike 'RAW' and upper("table_schema") = upper('RAW')

                    and 
    "table_name" ilike 'customers' and upper("table_name") = upper('customers')

                )
             or 
                (
                    
    "table_schema" ilike 'RAW' and upper("table_schema") = upper('RAW')

                    and 
    "table_name" ilike 'orders' and upper("table_name") = upper('orders')

                )
            )
        )
        select *
    from tables
    join columns using ("table_database", "table_schema", "table_name")
    order by "column_index"
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "JAFFLE_SHOP.information_schema"} */
[0m01:10:44.618440 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:10:47.554277 [debug] [ThreadPool]: SQL status: SUCCESS 17 in 2.936 seconds
[0m01:10:47.584126 [debug] [MainThread]: Wrote artifact CatalogArtifact to /opt/airflow/dbt/target/catalog.json
[0m01:10:47.607219 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m01:10:47.609065 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m01:10:47.609284 [info ] [MainThread]: Catalog written to /opt/airflow/dbt/target/catalog.json
[0m01:10:47.610307 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 4.2459006, "process_in_blocks": "0", "process_kernel_time": 0.238205, "process_mem_max_rss": "152776", "process_out_blocks": "5379", "process_user_time": 1.434257}
[0m01:10:47.610738 [debug] [MainThread]: Command `dbt docs generate` succeeded at 01:10:47.610663 after 4.25 seconds
[0m01:10:47.611005 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m01:10:47.611183 [debug] [MainThread]: Connection 'JAFFLE_SHOP.information_schema' was left open.
[0m01:10:47.611347 [debug] [MainThread]: On JAFFLE_SHOP.information_schema: Close
[0m01:10:47.748110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90d21610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e3f4260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8cdf0b00>]}
[0m01:10:47.749077 [debug] [MainThread]: Flushing usage events
[0m01:10:48.199853 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:10:49.290681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffabec2ab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad2a1ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffab060d70>]}


============================== 01:10:49.292907 | 6376d4ee-3ec6-4806-8aad-4670ba46b2a9 ==============================
[0m01:10:49.292907 [info ] [MainThread]: Running with dbt=1.10.13
[0m01:10:49.293354 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'empty': 'None', 'log_path': '/opt/airflow/dbt/logs', 'target_path': 'None', 'invocation_command': 'dbt docs serve --profiles-dir . --target dev --port 8085', 'version_check': 'True', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'printer_width': '80', 'introspect': 'True', 'cache_selected_only': 'False', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'quiet': 'False', 'use_experimental_parser': 'False', 'use_colors': 'True', 'partial_parse': 'True', 'no_print': 'None', 'debug': 'False', 'warn_error': 'None', 'profiles_dir': '.', 'static_parser': 'True', 'log_format': 'default', 'fail_fast': 'False'}
[0m01:10:49.480479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6376d4ee-3ec6-4806-8aad-4670ba46b2a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa995b080>]}
[0m01:10:49.522659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6376d4ee-3ec6-4806-8aad-4670ba46b2a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9e58500>]}
[0m01:15:56.700595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96318500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff960aae40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96145bb0>]}


============================== 01:15:56.705396 | 4c0c1270-94dc-4255-88e6-a23e587d5cc1 ==============================
[0m01:15:56.705396 [info ] [MainThread]: Running with dbt=1.10.13
[0m01:15:56.705960 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'empty': 'None', 'log_format': 'default', 'use_colors': 'True', 'log_cache_events': 'False', 'no_print': 'None', 'static_parser': 'True', 'invocation_command': 'dbt deps --profiles-dir . --target dev', 'log_path': '/opt/airflow/dbt/logs', 'indirect_selection': 'eager', 'printer_width': '80', 'version_check': 'True', 'quiet': 'False', 'fail_fast': 'False', 'debug': 'False', 'partial_parse': 'True', 'profiles_dir': '.', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'target_path': 'None', 'use_experimental_parser': 'False', 'warn_error': 'None', 'write_json': 'True'}
[0m01:15:56.766474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4c0c1270-94dc-4255-88e6-a23e587d5cc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff953fa660>]}
[0m01:15:56.776168 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m01:15:56.780897 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m01:15:56.783492 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.10930809, "process_in_blocks": "832", "process_kernel_time": 0.13241, "process_mem_max_rss": "103264", "process_out_blocks": "3227", "process_user_time": 0.894772}
[0m01:15:56.784069 [debug] [MainThread]: Command `dbt deps` succeeded at 01:15:56.783981 after 0.11 seconds
[0m01:15:56.784645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95629400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95208d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95ad16a0>]}
[0m01:15:56.785175 [debug] [MainThread]: Flushing usage events
[0m01:15:57.279326 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:15:58.175569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3cbac30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4e87170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5285280>]}


============================== 01:15:58.177685 | c8379ba2-3406-4784-bd4c-469704c4d982 ==============================
[0m01:15:58.177685 [info ] [MainThread]: Running with dbt=1.10.13
[0m01:15:58.178062 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'write_json': 'True', 'quiet': 'False', 'version_check': 'True', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'use_colors': 'True', 'debug': 'False', 'no_print': 'None', 'log_format': 'default', 'printer_width': '80', 'fail_fast': 'False', 'log_cache_events': 'False', 'empty': 'False', 'partial_parse': 'True', 'warn_error': 'None', 'profiles_dir': '.', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'log_path': '/opt/airflow/dbt/logs', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir . --target dev', 'indirect_selection': 'eager'}
[0m01:15:58.380837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c8379ba2-3406-4784-bd4c-469704c4d982', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa16419a0>]}
[0m01:15:58.411148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c8379ba2-3406-4784-bd4c-469704c4d982', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3297aa0>]}
[0m01:15:58.411645 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m01:15:58.455942 [debug] [MainThread]: checksum: 87546e06832e1286bf2d49b8b108dd3f58da97cbfca650a1f147ec4aedfbbf25, vars: {}, profile: , target: dev, version: 1.10.13
[0m01:15:58.559596 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:15:58.559889 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:15:58.575944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c8379ba2-3406-4784-bd4c-469704c4d982', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1dccb00>]}
[0m01:15:58.614737 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m01:15:58.616103 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m01:15:58.631211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c8379ba2-3406-4784-bd4c-469704c4d982', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa107fa40>]}
[0m01:15:58.631523 [info ] [MainThread]: Found 2 models, 2 sources, 492 macros
[0m01:15:58.631759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c8379ba2-3406-4784-bd4c-469704c4d982', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa141f950>]}
[0m01:15:58.632951 [info ] [MainThread]: 
[0m01:15:58.633204 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m01:15:58.633441 [info ] [MainThread]: 
[0m01:15:58.634202 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:15:58.636661 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JAFFLE_SHOP'
[0m01:15:58.665152 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP"
[0m01:15:58.665469 [debug] [ThreadPool]: On list_JAFFLE_SHOP: show terse schemas in database JAFFLE_SHOP
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_JAFFLE_SHOP"} */
[0m01:15:58.665680 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:16:02.172876 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 3.507 seconds
[0m01:16:02.179214 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_JAFFLE_SHOP, now list_JAFFLE_SHOP_ANALYTICS)
[0m01:16:02.196397 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP_ANALYTICS"
[0m01:16:02.196905 [debug] [ThreadPool]: On list_JAFFLE_SHOP_ANALYTICS: show objects in JAFFLE_SHOP.ANALYTICS
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_JAFFLE_SHOP_ANALYTICS"} */;
[0m01:16:02.373812 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.176 seconds
[0m01:16:02.380012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c8379ba2-3406-4784-bd4c-469704c4d982', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2b36960>]}
[0m01:16:02.391471 [debug] [Thread-1 (]: Began running node model.jaffle_shop.customers
[0m01:16:02.392039 [debug] [Thread-2 (]: Began running node model.jaffle_shop.first_model
[0m01:16:02.392733 [info ] [Thread-1 (]: 1 of 2 START sql table model ANALYTICS.customers ............................... [RUN]
[0m01:16:02.393535 [info ] [Thread-2 (]: 2 of 2 START sql view model ANALYTICS.first_model .............................. [RUN]
[0m01:16:02.394998 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_JAFFLE_SHOP_ANALYTICS, now model.jaffle_shop.customers)
[0m01:16:02.395845 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.jaffle_shop.first_model'
[0m01:16:02.396391 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.customers
[0m01:16:02.396892 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.first_model
[0m01:16:02.406920 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.customers"
[0m01:16:02.408795 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.first_model"
[0m01:16:02.410573 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.customers
[0m01:16:02.417580 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.first_model
[0m01:16:02.452954 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.customers"
[0m01:16:02.456262 [debug] [Thread-2 (]: Writing runtime sql for node "model.jaffle_shop.first_model"
[0m01:16:02.457416 [debug] [Thread-1 (]: Using snowflake connection "model.jaffle_shop.customers"
[0m01:16:02.457671 [debug] [Thread-1 (]: On model.jaffle_shop.customers: create or replace transient table JAFFLE_SHOP.ANALYTICS.customers
    
    
    
    as (SELECT
    id
    ,split_part(name,' ',1) as first_name
    ,split_part(name,' ',2) as last_name
FROM JAFFLE_SHOP.RAW.customers
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */;
[0m01:16:02.458383 [debug] [Thread-2 (]: Using snowflake connection "model.jaffle_shop.first_model"
[0m01:16:02.459955 [debug] [Thread-2 (]: On model.jaffle_shop.first_model: create or replace   view JAFFLE_SHOP.ANALYTICS.first_model
  
  
  
  
  as (
    with customers as (

    select
        id as customer_id,
        name

    from jaffle_shop.raw.customers

),

orders as (

    select
        id as order_id,
        customer as customer_id,
        ordered_at
    from jaffle_shop.raw.orders

),

customer_orders as (

    select
        customer_id,
        min(ordered_at) as first_order_date,
        max(ordered_at) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
  )
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.first_model"} */;
[0m01:16:02.460245 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m01:16:04.017974 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.559 seconds
[0m01:16:04.032395 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c8379ba2-3406-4784-bd4c-469704c4d982', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa39e2c60>]}
[0m01:16:04.032961 [info ] [Thread-1 (]: 1 of 2 OK created sql table model ANALYTICS.customers .......................... [[32mSUCCESS 1[0m in 1.64s]
[0m01:16:04.033502 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.customers
[0m01:16:05.143043 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 2.683 seconds
[0m01:16:05.146373 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c8379ba2-3406-4784-bd4c-469704c4d982', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9aa02330>]}
[0m01:16:05.147462 [info ] [Thread-2 (]: 2 of 2 OK created sql view model ANALYTICS.first_model ......................... [[32mSUCCESS 1[0m in 2.75s]
[0m01:16:05.148362 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.first_model
[0m01:16:05.150169 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:16:05.150464 [debug] [MainThread]: Connection 'model.jaffle_shop.customers' was left open.
[0m01:16:05.150952 [debug] [MainThread]: On model.jaffle_shop.customers: Close
[0m01:16:05.272325 [debug] [MainThread]: Connection 'model.jaffle_shop.first_model' was left open.
[0m01:16:05.272737 [debug] [MainThread]: On model.jaffle_shop.first_model: Close
[0m01:16:05.385177 [info ] [MainThread]: 
[0m01:16:05.385621 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 6.75 seconds (6.75s).
[0m01:16:05.386701 [debug] [MainThread]: Command end result
[0m01:16:05.403528 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m01:16:05.405522 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m01:16:05.409952 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/target/run_results.json
[0m01:16:05.410190 [info ] [MainThread]: 
[0m01:16:05.410486 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:16:05.411216 [info ] [MainThread]: 
[0m01:16:05.411525 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m01:16:05.412751 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.263981, "process_in_blocks": "0", "process_kernel_time": 0.276091, "process_mem_max_rss": "155060", "process_out_blocks": "4583", "process_user_time": 1.528581}
[0m01:16:05.413149 [debug] [MainThread]: Command `dbt run` succeeded at 01:16:05.413056 after 7.26 seconds
[0m01:16:05.413420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2ec4b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa33a0b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2b36660>]}
[0m01:16:05.413648 [debug] [MainThread]: Flushing usage events
[0m01:16:05.875223 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:16:06.945706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaaa7efc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa809460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad349b20>]}


============================== 01:16:06.947810 | 32ee632b-bd9a-4e22-8d35-d0a50714a46b ==============================
[0m01:16:06.947810 [info ] [MainThread]: Running with dbt=1.10.13
[0m01:16:06.948264 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'introspect': 'True', 'quiet': 'False', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'use_colors': 'True', 'invocation_command': 'dbt docs generate --profiles-dir . --target dev', 'no_print': 'None', 'target_path': 'None', 'log_cache_events': 'False', 'printer_width': '80', 'profiles_dir': '.', 'fail_fast': 'False', 'debug': 'False', 'write_json': 'True', 'static_parser': 'True', 'version_check': 'True', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': '/opt/airflow/dbt/logs', 'indirect_selection': 'eager', 'empty': 'None', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True'}
[0m01:16:07.128365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '32ee632b-bd9a-4e22-8d35-d0a50714a46b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa90e9100>]}
[0m01:16:07.158940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '32ee632b-bd9a-4e22-8d35-d0a50714a46b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaed90a10>]}
[0m01:16:07.159495 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m01:16:07.199482 [debug] [MainThread]: checksum: 87546e06832e1286bf2d49b8b108dd3f58da97cbfca650a1f147ec4aedfbbf25, vars: {}, profile: , target: dev, version: 1.10.13
[0m01:16:07.294686 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:16:07.294948 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:16:07.311856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '32ee632b-bd9a-4e22-8d35-d0a50714a46b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8c35820>]}
[0m01:16:07.319907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '32ee632b-bd9a-4e22-8d35-d0a50714a46b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8759a00>]}
[0m01:16:07.320210 [info ] [MainThread]: Found 2 models, 2 sources, 492 macros
[0m01:16:07.320449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '32ee632b-bd9a-4e22-8d35-d0a50714a46b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8e4e5d0>]}
[0m01:16:07.321684 [info ] [MainThread]: 
[0m01:16:07.321927 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m01:16:07.322244 [info ] [MainThread]: 
[0m01:16:07.322928 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:16:07.325342 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JAFFLE_SHOP_ANALYTICS'
[0m01:16:07.352214 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP_ANALYTICS"
[0m01:16:07.352514 [debug] [ThreadPool]: On list_JAFFLE_SHOP_ANALYTICS: show objects in JAFFLE_SHOP.ANALYTICS
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_JAFFLE_SHOP_ANALYTICS"} */;
[0m01:16:07.352729 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:16:07.873795 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.521 seconds
[0m01:16:07.879004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '32ee632b-bd9a-4e22-8d35-d0a50714a46b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8a530b0>]}
[0m01:16:07.884066 [debug] [Thread-1 (]: Began running node model.jaffle_shop.customers
[0m01:16:07.884740 [debug] [Thread-2 (]: Began running node model.jaffle_shop.first_model
[0m01:16:07.885349 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_JAFFLE_SHOP_ANALYTICS, now model.jaffle_shop.customers)
[0m01:16:07.886136 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.jaffle_shop.first_model'
[0m01:16:07.886722 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.customers
[0m01:16:07.887308 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.first_model
[0m01:16:07.898312 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.customers"
[0m01:16:07.900412 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.first_model"
[0m01:16:07.902304 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.customers
[0m01:16:07.903258 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.customers
[0m01:16:07.903630 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.first_model
[0m01:16:07.904557 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.first_model
[0m01:16:07.905990 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:16:07.906328 [debug] [MainThread]: Connection 'model.jaffle_shop.customers' was left open.
[0m01:16:07.906599 [debug] [MainThread]: On model.jaffle_shop.customers: Close
[0m01:16:08.053437 [debug] [MainThread]: Connection 'model.jaffle_shop.first_model' was properly closed.
[0m01:16:08.055696 [debug] [MainThread]: Command end result
[0m01:16:08.127762 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m01:16:08.129171 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m01:16:08.133290 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/target/run_results.json
[0m01:16:08.136218 [debug] [MainThread]: Acquiring new snowflake connection 'generate_catalog'
[0m01:16:08.136413 [info ] [MainThread]: Building catalog
[0m01:16:08.142618 [debug] [ThreadPool]: Acquiring new snowflake connection 'JAFFLE_SHOP.information_schema'
[0m01:16:08.150367 [debug] [ThreadPool]: Using snowflake connection "JAFFLE_SHOP.information_schema"
[0m01:16:08.150703 [debug] [ThreadPool]: On JAFFLE_SHOP.information_schema: with tables as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",
        case
            when is_dynamic = 'YES' and table_type = 'BASE TABLE' THEN 'DYNAMIC TABLE'
            else table_type
        end as "table_type",
        comment as "table_comment",

        -- note: this is the _role_ that owns the table
        table_owner as "table_owner",

        'Clustering Key' as "stats:clustering_key:label",
        clustering_key as "stats:clustering_key:value",
        'The key used to cluster this table' as "stats:clustering_key:description",
        (clustering_key is not null) as "stats:clustering_key:include",

        'Row Count' as "stats:row_count:label",
        row_count as "stats:row_count:value",
        'An approximate count of rows in this table' as "stats:row_count:description",
        (row_count is not null) as "stats:row_count:include",

        'Approximate Size' as "stats:bytes:label",
        bytes as "stats:bytes:value",
        'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
        (bytes is not null) as "stats:bytes:include",

        'Last Modified' as "stats:last_modified:label",
        to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
        'The timestamp for last update/change' as "stats:last_modified:description",
        (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"
    from JAFFLE_SHOP.INFORMATION_SCHEMA.tables
            where (
                (
                    
    "table_schema" ilike 'ANALYTICS' and upper("table_schema") = upper('ANALYTICS')

                    and 
    "table_name" ilike 'customers' and upper("table_name") = upper('customers')

                )
             or 
                (
                    
    "table_schema" ilike 'RAW' and upper("table_schema") = upper('RAW')

                    and 
    "table_name" ilike 'orders' and upper("table_name") = upper('orders')

                )
             or 
                (
                    
    "table_schema" ilike 'RAW' and upper("table_schema") = upper('RAW')

                    and 
    "table_name" ilike 'customers' and upper("table_name") = upper('customers')

                )
             or 
                (
                    
    "table_schema" ilike 'ANALYTICS' and upper("table_schema") = upper('ANALYTICS')

                    and 
    "table_name" ilike 'first_model' and upper("table_name") = upper('first_model')

                )
            )
        ),
        columns as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",

        column_name as "column_name",
        ordinal_position as "column_index",
        data_type as "column_type",
        comment as "column_comment"
    from JAFFLE_SHOP.INFORMATION_SCHEMA.columns
            where (
                (
                    
    "table_schema" ilike 'ANALYTICS' and upper("table_schema") = upper('ANALYTICS')

                    and 
    "table_name" ilike 'customers' and upper("table_name") = upper('customers')

                )
             or 
                (
                    
    "table_schema" ilike 'RAW' and upper("table_schema") = upper('RAW')

                    and 
    "table_name" ilike 'orders' and upper("table_name") = upper('orders')

                )
             or 
                (
                    
    "table_schema" ilike 'RAW' and upper("table_schema") = upper('RAW')

                    and 
    "table_name" ilike 'customers' and upper("table_name") = upper('customers')

                )
             or 
                (
                    
    "table_schema" ilike 'ANALYTICS' and upper("table_schema") = upper('ANALYTICS')

                    and 
    "table_name" ilike 'first_model' and upper("table_name") = upper('first_model')

                )
            )
        )
        select *
    from tables
    join columns using ("table_database", "table_schema", "table_name")
    order by "column_index"
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "JAFFLE_SHOP.information_schema"} */
[0m01:16:08.151015 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:16:11.601497 [debug] [ThreadPool]: SQL status: SUCCESS 17 in 3.450 seconds
[0m01:16:11.638215 [debug] [MainThread]: Wrote artifact CatalogArtifact to /opt/airflow/dbt/target/catalog.json
[0m01:16:11.661060 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m01:16:11.662908 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m01:16:11.663146 [info ] [MainThread]: Catalog written to /opt/airflow/dbt/target/catalog.json
[0m01:16:11.664530 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 4.745863, "process_in_blocks": "0", "process_kernel_time": 0.124307, "process_mem_max_rss": "152912", "process_out_blocks": "5379", "process_user_time": 1.387427}
[0m01:16:11.665040 [debug] [MainThread]: Command `dbt docs generate` succeeded at 01:16:11.664943 after 4.75 seconds
[0m01:16:11.665329 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m01:16:11.665531 [debug] [MainThread]: Connection 'JAFFLE_SHOP.information_schema' was left open.
[0m01:16:11.665713 [debug] [MainThread]: On JAFFLE_SHOP.information_schema: Close
[0m01:16:11.788262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaabb7740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8d49490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8d499d0>]}
[0m01:16:11.788908 [debug] [MainThread]: Flushing usage events
[0m01:16:12.238272 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:16:13.256771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0891ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0956930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0890bc0>]}


============================== 01:16:13.258886 | 1492df54-3ef7-4529-b8bc-ed33c4f52f77 ==============================
[0m01:16:13.258886 [info ] [MainThread]: Running with dbt=1.10.13
[0m01:16:13.259260 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'write_json': 'True', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'introspect': 'True', 'log_path': '/opt/airflow/dbt/logs', 'printer_width': '80', 'log_format': 'default', 'warn_error': 'None', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'invocation_command': 'dbt docs serve --profiles-dir . --target dev --port 8085 --host 0.0.0.0', 'empty': 'None', 'static_parser': 'True', 'profiles_dir': '.', 'quiet': 'False', 'version_check': 'True', 'use_experimental_parser': 'False', 'debug': 'False', 'use_colors': 'True', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True'}
[0m01:16:13.439330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1492df54-3ef7-4529-b8bc-ed33c4f52f77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa241e840>]}
[0m01:16:13.468830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1492df54-3ef7-4529-b8bc-ed33c4f52f77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9efba9f0>]}
[0m01:55:30.037829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e1c29f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e02ec90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f411fa0>]}


============================== 01:55:30.041509 | 78d98b45-4496-452a-adf1-3292614adf0c ==============================
[0m01:55:30.041509 [info ] [MainThread]: Running with dbt=1.10.13
[0m01:55:30.042063 [debug] [MainThread]: running dbt with arguments {'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True', 'target_path': 'None', 'warn_error': 'None', 'use_experimental_parser': 'False', 'no_print': 'None', 'printer_width': '80', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '.', 'quiet': 'False', 'introspect': 'True', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'debug': 'False', 'invocation_command': 'dbt deps --profiles-dir . --target dev', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'log_format': 'default', 'version_check': 'True', 'partial_parse': 'True', 'fail_fast': 'False', 'use_colors': 'True'}
[0m01:55:30.148217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '78d98b45-4496-452a-adf1-3292614adf0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d10af60>]}
[0m01:55:30.164488 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m01:55:30.167322 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m01:55:30.169589 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.17507283, "process_in_blocks": "15880", "process_kernel_time": 0.367843, "process_mem_max_rss": "101524", "process_out_blocks": "3", "process_user_time": 1.27208}
[0m01:55:30.170893 [debug] [MainThread]: Command `dbt deps` succeeded at 01:55:30.170782 after 0.18 seconds
[0m01:55:30.171243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d3ec500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ce4b080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81f4a930>]}
[0m01:55:30.171584 [debug] [MainThread]: Flushing usage events
[0m01:55:30.674538 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:55:31.635976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2355eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1ebd3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1e08c20>]}


============================== 01:55:31.638083 | 44b46b15-4de6-45c8-a419-f0dc23c3d3a2 ==============================
[0m01:55:31.638083 [info ] [MainThread]: Running with dbt=1.10.13
[0m01:55:31.638610 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'printer_width': '80', 'profiles_dir': '.', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True', 'partial_parse': 'True', 'empty': 'False', 'invocation_command': 'dbt run --profiles-dir . --target dev', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'introspect': 'True', 'write_json': 'True', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'cache_selected_only': 'False', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'indirect_selection': 'eager', 'use_colors': 'True', 'log_cache_events': 'False', 'quiet': 'False', 'target_path': 'None', 'static_parser': 'True'}
[0m01:55:31.884282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '44b46b15-4de6-45c8-a419-f0dc23c3d3a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb03898b0>]}
[0m01:55:31.915207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '44b46b15-4de6-45c8-a419-f0dc23c3d3a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0586ea0>]}
[0m01:55:31.915787 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m01:55:31.963916 [debug] [MainThread]: checksum: 87546e06832e1286bf2d49b8b108dd3f58da97cbfca650a1f147ec4aedfbbf25, vars: {}, profile: , target: dev, version: 1.10.13
[0m01:55:32.077212 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 2 files added, 0 files changed.
[0m01:55:32.077629 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://models/analytics/orders.sql
[0m01:55:32.077806 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://models/analytics/order_customer.sql
[0m01:55:32.077943 [debug] [MainThread]: Partial parsing: deleted file: jaffle_shop://models/examples/first_model.sql
[0m01:55:32.208556 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.jaffle_shop.examples
[0m01:55:32.216236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '44b46b15-4de6-45c8-a419-f0dc23c3d3a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf888d40>]}
[0m01:55:32.259292 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m01:55:32.261316 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m01:55:32.270177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '44b46b15-4de6-45c8-a419-f0dc23c3d3a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf99e210>]}
[0m01:55:32.270462 [info ] [MainThread]: Found 3 models, 2 sources, 492 macros
[0m01:55:32.270647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '44b46b15-4de6-45c8-a419-f0dc23c3d3a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffafa4f620>]}
[0m01:55:32.271832 [info ] [MainThread]: 
[0m01:55:32.272073 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m01:55:32.272544 [info ] [MainThread]: 
[0m01:55:32.273215 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:55:32.276393 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JAFFLE_SHOP'
[0m01:55:32.312774 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP"
[0m01:55:32.313148 [debug] [ThreadPool]: On list_JAFFLE_SHOP: show terse schemas in database JAFFLE_SHOP
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_JAFFLE_SHOP"} */
[0m01:55:32.313358 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:55:35.239214 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2.926 seconds
[0m01:55:35.247929 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JAFFLE_SHOP_ANALYTICS'
[0m01:55:35.259779 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP_ANALYTICS"
[0m01:55:35.260186 [debug] [ThreadPool]: On list_JAFFLE_SHOP_ANALYTICS: show objects in JAFFLE_SHOP.ANALYTICS
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_JAFFLE_SHOP_ANALYTICS"} */;
[0m01:55:35.260495 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:55:36.925552 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.664 seconds
[0m01:55:36.934567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '44b46b15-4de6-45c8-a419-f0dc23c3d3a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3d84ad0>]}
[0m01:55:36.944323 [debug] [Thread-1 (]: Began running node model.jaffle_shop.customers
[0m01:55:36.944973 [debug] [Thread-2 (]: Began running node model.jaffle_shop.orders
[0m01:55:36.945888 [info ] [Thread-1 (]: 1 of 3 START sql table model ANALYTICS.customers ............................... [RUN]
[0m01:55:36.946969 [info ] [Thread-2 (]: 2 of 3 START sql table model ANALYTICS.orders .................................. [RUN]
[0m01:55:36.948322 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_JAFFLE_SHOP_ANALYTICS, now model.jaffle_shop.customers)
[0m01:55:36.949462 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.jaffle_shop.orders'
[0m01:55:36.950059 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.customers
[0m01:55:36.950575 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.orders
[0m01:55:36.962669 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.customers"
[0m01:55:36.965598 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.orders"
[0m01:55:36.967688 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.customers
[0m01:55:36.968056 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.orders
[0m01:55:37.004073 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.customers"
[0m01:55:37.008605 [debug] [Thread-2 (]: Writing runtime sql for node "model.jaffle_shop.orders"
[0m01:55:37.012132 [debug] [Thread-1 (]: Using snowflake connection "model.jaffle_shop.customers"
[0m01:55:37.012427 [debug] [Thread-1 (]: On model.jaffle_shop.customers: create or replace transient table JAFFLE_SHOP.ANALYTICS.customers
    
    
    
    as (SELECT
    id
    ,split_part(name,' ',1) as first_name
    ,split_part(name,' ',2) as last_name
FROM JAFFLE_SHOP.RAW.customers
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */;
[0m01:55:37.012837 [debug] [Thread-2 (]: Using snowflake connection "model.jaffle_shop.orders"
[0m01:55:37.014092 [debug] [Thread-2 (]: On model.jaffle_shop.orders: create or replace transient table JAFFLE_SHOP.ANALYTICS.orders
    
    
    
    as (SELECT
        id as order_id
        ,customer as customer_id
        ,ordered_at
    FROM JAFFLE_SHOP.RAW.orders
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.orders"} */;
[0m01:55:37.014328 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m01:55:37.518634 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.505 seconds
[0m01:55:37.558943 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '44b46b15-4de6-45c8-a419-f0dc23c3d3a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb22f6480>]}
[0m01:55:37.559820 [info ] [Thread-1 (]: 1 of 3 OK created sql table model ANALYTICS.customers .......................... [[32mSUCCESS 1[0m in 0.61s]
[0m01:55:37.560826 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.customers
[0m01:55:38.521795 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.507 seconds
[0m01:55:38.526827 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '44b46b15-4de6-45c8-a419-f0dc23c3d3a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac49ef00>]}
[0m01:55:38.528092 [info ] [Thread-2 (]: 2 of 3 OK created sql table model ANALYTICS.orders ............................. [[32mSUCCESS 1[0m in 1.58s]
[0m01:55:38.529359 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.orders
[0m01:55:38.531557 [debug] [Thread-4 (]: Began running node model.jaffle_shop.order_customer
[0m01:55:38.532550 [info ] [Thread-4 (]: 3 of 3 START sql table model ANALYTICS.order_customer .......................... [RUN]
[0m01:55:38.533471 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.jaffle_shop.order_customer'
[0m01:55:38.534278 [debug] [Thread-4 (]: Began compiling node model.jaffle_shop.order_customer
[0m01:55:38.539853 [debug] [Thread-4 (]: Writing injected SQL for node "model.jaffle_shop.order_customer"
[0m01:55:38.541945 [debug] [Thread-4 (]: Began executing node model.jaffle_shop.order_customer
[0m01:55:38.546273 [debug] [Thread-4 (]: Writing runtime sql for node "model.jaffle_shop.order_customer"
[0m01:55:38.548706 [debug] [Thread-4 (]: Using snowflake connection "model.jaffle_shop.order_customer"
[0m01:55:38.549176 [debug] [Thread-4 (]: On model.jaffle_shop.order_customer: create or replace transient table JAFFLE_SHOP.ANALYTICS.order_customer
    
    
    
    as (select 
    o.order_id
    ,o.customer_id
    ,c.first_name
    ,c.last_name
from JAFFLE_SHOP.ANALYTICS.customers as c
join JAFFLE_SHOP.ANALYTICS.orders o on o.customer_id = c.id
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.order_customer"} */;
[0m01:55:38.549665 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m01:55:40.264237 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.714 seconds
[0m01:55:40.272828 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '44b46b15-4de6-45c8-a419-f0dc23c3d3a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac3366f0>]}
[0m01:55:40.274629 [info ] [Thread-4 (]: 3 of 3 OK created sql table model ANALYTICS.order_customer ..................... [[32mSUCCESS 1[0m in 1.74s]
[0m01:55:40.276239 [debug] [Thread-4 (]: Finished running node model.jaffle_shop.order_customer
[0m01:55:40.281048 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:55:40.281791 [debug] [MainThread]: Connection 'list_JAFFLE_SHOP' was left open.
[0m01:55:40.282356 [debug] [MainThread]: On list_JAFFLE_SHOP: Close
[0m01:55:40.418762 [debug] [MainThread]: Connection 'model.jaffle_shop.customers' was left open.
[0m01:55:40.419188 [debug] [MainThread]: On model.jaffle_shop.customers: Close
[0m01:55:40.541008 [debug] [MainThread]: Connection 'model.jaffle_shop.orders' was left open.
[0m01:55:40.541823 [debug] [MainThread]: On model.jaffle_shop.orders: Close
[0m01:55:40.656391 [debug] [MainThread]: Connection 'model.jaffle_shop.order_customer' was left open.
[0m01:55:40.657125 [debug] [MainThread]: On model.jaffle_shop.order_customer: Close
[0m01:55:40.791427 [info ] [MainThread]: 
[0m01:55:40.792708 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 8.52 seconds (8.52s).
[0m01:55:40.795360 [debug] [MainThread]: Command end result
[0m01:55:40.840228 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m01:55:40.846083 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m01:55:40.859221 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/target/run_results.json
[0m01:55:40.859608 [info ] [MainThread]: 
[0m01:55:40.859928 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:55:40.860222 [info ] [MainThread]: 
[0m01:55:40.861012 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m01:55:40.863022 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.254222, "process_in_blocks": "3896", "process_kernel_time": 0.291975, "process_mem_max_rss": "160532", "process_out_blocks": "3042", "process_user_time": 1.930448}
[0m01:55:40.863667 [debug] [MainThread]: Command `dbt run` succeeded at 01:55:40.863574 after 9.26 seconds
[0m01:55:40.864067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1816510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3145fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf8a7a70>]}
[0m01:55:40.864337 [debug] [MainThread]: Flushing usage events
[0m01:55:41.332208 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:55:42.536848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb665cb60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6f4e1b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb665fa10>]}


============================== 01:55:42.542297 | 2fe2bd8f-8efc-4533-b260-9f83f352c87d ==============================
[0m01:55:42.542297 [info ] [MainThread]: Running with dbt=1.10.13
[0m01:55:42.542929 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'no_print': 'None', 'partial_parse': 'True', 'static_parser': 'True', 'quiet': 'False', 'warn_error': 'None', 'invocation_command': 'dbt docs generate --profiles-dir . --target dev', 'fail_fast': 'False', 'log_cache_events': 'False', 'profiles_dir': '.', 'send_anonymous_usage_stats': 'True', 'printer_width': '80', 'debug': 'False', 'indirect_selection': 'eager', 'use_colors': 'True', 'write_json': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'log_format': 'default', 'version_check': 'True', 'empty': 'None', 'log_path': '/opt/airflow/dbt/logs'}
[0m01:55:42.753297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2fe2bd8f-8efc-4533-b260-9f83f352c87d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb35f9220>]}
[0m01:55:42.783953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2fe2bd8f-8efc-4533-b260-9f83f352c87d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2e53200>]}
[0m01:55:42.784526 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m01:55:42.827096 [debug] [MainThread]: checksum: 87546e06832e1286bf2d49b8b108dd3f58da97cbfca650a1f147ec4aedfbbf25, vars: {}, profile: , target: dev, version: 1.10.13
[0m01:55:42.919121 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:55:42.919474 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:55:42.923475 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.jaffle_shop.examples
[0m01:55:42.938316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2fe2bd8f-8efc-4533-b260-9f83f352c87d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2a52b40>]}
[0m01:55:42.947598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2fe2bd8f-8efc-4533-b260-9f83f352c87d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb294daf0>]}
[0m01:55:42.947842 [info ] [MainThread]: Found 3 models, 2 sources, 492 macros
[0m01:55:42.948043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2fe2bd8f-8efc-4533-b260-9f83f352c87d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb29809e0>]}
[0m01:55:42.949167 [info ] [MainThread]: 
[0m01:55:42.949421 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m01:55:42.949620 [info ] [MainThread]: 
[0m01:55:42.950333 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:55:42.952937 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JAFFLE_SHOP_ANALYTICS'
[0m01:55:42.981740 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP_ANALYTICS"
[0m01:55:42.982063 [debug] [ThreadPool]: On list_JAFFLE_SHOP_ANALYTICS: show objects in JAFFLE_SHOP.ANALYTICS
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_JAFFLE_SHOP_ANALYTICS"} */;
[0m01:55:42.982220 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:55:43.439916 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.457 seconds
[0m01:55:43.445276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2fe2bd8f-8efc-4533-b260-9f83f352c87d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb308a180>]}
[0m01:55:43.450192 [debug] [Thread-1 (]: Began running node model.jaffle_shop.customers
[0m01:55:43.450802 [debug] [Thread-2 (]: Began running node model.jaffle_shop.orders
[0m01:55:43.451459 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_JAFFLE_SHOP_ANALYTICS, now model.jaffle_shop.customers)
[0m01:55:43.452222 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.jaffle_shop.orders'
[0m01:55:43.452773 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.customers
[0m01:55:43.453443 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.orders
[0m01:55:43.464343 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.customers"
[0m01:55:43.467311 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.orders"
[0m01:55:43.469307 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.customers
[0m01:55:43.470238 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.customers
[0m01:55:43.470613 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.orders
[0m01:55:43.471544 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.orders
[0m01:55:43.472422 [debug] [Thread-4 (]: Began running node model.jaffle_shop.order_customer
[0m01:55:43.472960 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.jaffle_shop.order_customer'
[0m01:55:43.473258 [debug] [Thread-4 (]: Began compiling node model.jaffle_shop.order_customer
[0m01:55:43.476217 [debug] [Thread-4 (]: Writing injected SQL for node "model.jaffle_shop.order_customer"
[0m01:55:43.477315 [debug] [Thread-4 (]: Began executing node model.jaffle_shop.order_customer
[0m01:55:43.477923 [debug] [Thread-4 (]: Finished running node model.jaffle_shop.order_customer
[0m01:55:43.479212 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:55:43.479564 [debug] [MainThread]: Connection 'model.jaffle_shop.customers' was left open.
[0m01:55:43.480060 [debug] [MainThread]: On model.jaffle_shop.customers: Close
[0m01:55:43.654011 [debug] [MainThread]: Connection 'model.jaffle_shop.orders' was properly closed.
[0m01:55:43.654931 [debug] [MainThread]: Connection 'model.jaffle_shop.order_customer' was properly closed.
[0m01:55:43.656849 [debug] [MainThread]: Command end result
[0m01:55:43.726481 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m01:55:43.728093 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m01:55:43.732119 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/target/run_results.json
[0m01:55:43.736841 [debug] [MainThread]: Acquiring new snowflake connection 'generate_catalog'
[0m01:55:43.737120 [info ] [MainThread]: Building catalog
[0m01:55:43.743194 [debug] [ThreadPool]: Acquiring new snowflake connection 'JAFFLE_SHOP.information_schema'
[0m01:55:43.751079 [debug] [ThreadPool]: Using snowflake connection "JAFFLE_SHOP.information_schema"
[0m01:55:43.751407 [debug] [ThreadPool]: On JAFFLE_SHOP.information_schema: with tables as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",
        case
            when is_dynamic = 'YES' and table_type = 'BASE TABLE' THEN 'DYNAMIC TABLE'
            else table_type
        end as "table_type",
        comment as "table_comment",

        -- note: this is the _role_ that owns the table
        table_owner as "table_owner",

        'Clustering Key' as "stats:clustering_key:label",
        clustering_key as "stats:clustering_key:value",
        'The key used to cluster this table' as "stats:clustering_key:description",
        (clustering_key is not null) as "stats:clustering_key:include",

        'Row Count' as "stats:row_count:label",
        row_count as "stats:row_count:value",
        'An approximate count of rows in this table' as "stats:row_count:description",
        (row_count is not null) as "stats:row_count:include",

        'Approximate Size' as "stats:bytes:label",
        bytes as "stats:bytes:value",
        'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
        (bytes is not null) as "stats:bytes:include",

        'Last Modified' as "stats:last_modified:label",
        to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
        'The timestamp for last update/change' as "stats:last_modified:description",
        (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"
    from JAFFLE_SHOP.INFORMATION_SCHEMA.tables
            where (
                (
                    
    "table_schema" ilike 'ANALYTICS' and upper("table_schema") = upper('ANALYTICS')

                    and 
    "table_name" ilike 'order_customer' and upper("table_name") = upper('order_customer')

                )
             or 
                (
                    
    "table_schema" ilike 'ANALYTICS' and upper("table_schema") = upper('ANALYTICS')

                    and 
    "table_name" ilike 'customers' and upper("table_name") = upper('customers')

                )
             or 
                (
                    
    "table_schema" ilike 'RAW' and upper("table_schema") = upper('RAW')

                    and 
    "table_name" ilike 'orders' and upper("table_name") = upper('orders')

                )
             or 
                (
                    
    "table_schema" ilike 'RAW' and upper("table_schema") = upper('RAW')

                    and 
    "table_name" ilike 'customers' and upper("table_name") = upper('customers')

                )
             or 
                (
                    
    "table_schema" ilike 'ANALYTICS' and upper("table_schema") = upper('ANALYTICS')

                    and 
    "table_name" ilike 'orders' and upper("table_name") = upper('orders')

                )
            )
        ),
        columns as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",

        column_name as "column_name",
        ordinal_position as "column_index",
        data_type as "column_type",
        comment as "column_comment"
    from JAFFLE_SHOP.INFORMATION_SCHEMA.columns
            where (
                (
                    
    "table_schema" ilike 'ANALYTICS' and upper("table_schema") = upper('ANALYTICS')

                    and 
    "table_name" ilike 'order_customer' and upper("table_name") = upper('order_customer')

                )
             or 
                (
                    
    "table_schema" ilike 'ANALYTICS' and upper("table_schema") = upper('ANALYTICS')

                    and 
    "table_name" ilike 'customers' and upper("table_name") = upper('customers')

                )
             or 
                (
                    
    "table_schema" ilike 'RAW' and upper("table_schema") = upper('RAW')

                    and 
    "table_name" ilike 'orders' and upper("table_name") = upper('orders')

                )
             or 
                (
                    
    "table_schema" ilike 'RAW' and upper("table_schema") = upper('RAW')

                    and 
    "table_name" ilike 'customers' and upper("table_name") = upper('customers')

                )
             or 
                (
                    
    "table_schema" ilike 'ANALYTICS' and upper("table_schema") = upper('ANALYTICS')

                    and 
    "table_name" ilike 'orders' and upper("table_name") = upper('orders')

                )
            )
        )
        select *
    from tables
    join columns using ("table_database", "table_schema", "table_name")
    order by "column_index"
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "JAFFLE_SHOP.information_schema"} */
[0m01:55:43.751716 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:55:46.611281 [debug] [ThreadPool]: SQL status: SUCCESS 19 in 2.859 seconds
[0m01:55:46.635698 [debug] [MainThread]: Wrote artifact CatalogArtifact to /opt/airflow/dbt/target/catalog.json
[0m01:55:46.656475 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m01:55:46.657983 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m01:55:46.658199 [info ] [MainThread]: Catalog written to /opt/airflow/dbt/target/catalog.json
[0m01:55:46.659165 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 4.1499505, "process_in_blocks": "40", "process_kernel_time": 0.215859, "process_mem_max_rss": "153400", "process_out_blocks": "5389", "process_user_time": 1.403084}
[0m01:55:46.659544 [debug] [MainThread]: Command `dbt docs generate` succeeded at 01:55:46.659474 after 4.15 seconds
[0m01:55:46.659800 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m01:55:46.659965 [debug] [MainThread]: Connection 'JAFFLE_SHOP.information_schema' was left open.
[0m01:55:46.660118 [debug] [MainThread]: On JAFFLE_SHOP.information_schema: Close
[0m01:55:46.778072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6e19730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2707d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1c1b860>]}
[0m01:55:46.778784 [debug] [MainThread]: Flushing usage events
[0m01:55:47.285162 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:55:48.327218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e489220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7be19700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7bf2bd10>]}


============================== 01:55:48.329302 | b786cc31-26a0-429a-8632-3a0d54ca4438 ==============================
[0m01:55:48.329302 [info ] [MainThread]: Running with dbt=1.10.13
[0m01:55:48.329602 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt docs serve --profiles-dir . --target dev --port 8085 --host 0.0.0.0', 'log_path': '/opt/airflow/dbt/logs', 'printer_width': '80', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'use_colors': 'True', 'partial_parse': 'True', 'fail_fast': 'False', 'no_print': 'None', 'target_path': 'None', 'cache_selected_only': 'False', 'debug': 'False', 'introspect': 'True', 'warn_error': 'None', 'write_json': 'True', 'log_cache_events': 'False', 'empty': 'None', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'quiet': 'False', 'profiles_dir': '.', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_format': 'default'}
[0m01:55:48.503346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b786cc31-26a0-429a-8632-3a0d54ca4438', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e2b2600>]}
[0m01:55:48.532891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b786cc31-26a0-429a-8632-3a0d54ca4438', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c7654f0>]}
[0m12:33:13.163395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4b6baa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3e79a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3446120>]}


============================== 12:33:13.170297 | c48a7a4e-6f01-4ff7-a88b-0e209368a1a6 ==============================
[0m12:33:13.170297 [info ] [MainThread]: Running with dbt=1.10.13
[0m12:33:13.173092 [debug] [MainThread]: running dbt with arguments {'log_path': '/opt/airflow/dbt/logs', 'write_json': 'True', 'fail_fast': 'False', 'version_check': 'True', 'no_print': 'None', 'indirect_selection': 'eager', 'invocation_command': 'dbt deps --profiles-dir . --target dev', 'warn_error': 'None', 'quiet': 'False', 'log_format': 'default', 'debug': 'False', 'partial_parse': 'True', 'printer_width': '80', 'empty': 'None', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'profiles_dir': '.', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'cache_selected_only': 'False'}
[0m12:33:13.269873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c48a7a4e-6f01-4ff7-a88b-0e209368a1a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2be2600>]}
[0m12:33:13.287572 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m12:33:13.290785 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m12:33:13.292167 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.18516976, "process_in_blocks": "0", "process_kernel_time": 0.515247, "process_mem_max_rss": "101504", "process_out_blocks": "3", "process_user_time": 1.540671}
[0m12:33:13.292887 [debug] [MainThread]: Command `dbt deps` succeeded at 12:33:13.292822 after 0.19 seconds
[0m12:33:13.293250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5015ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2d37080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2c497c0>]}
[0m12:33:13.294156 [debug] [MainThread]: Flushing usage events
[0m12:33:13.804488 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:33:16.338158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff853438c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff847a9e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85287ec0>]}


============================== 12:33:16.351597 | fa41200f-bebd-4ca7-bbd9-c4beb0a2beea ==============================
[0m12:33:16.351597 [info ] [MainThread]: Running with dbt=1.10.13
[0m12:33:16.353057 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'introspect': 'True', 'version_check': 'True', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'no_print': 'None', 'use_colors': 'True', 'log_path': '/opt/airflow/dbt/logs', 'log_cache_events': 'False', 'static_parser': 'True', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'profiles_dir': '.', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'empty': 'False', 'invocation_command': 'dbt run --profiles-dir . --target dev', 'partial_parse': 'True'}
[0m12:33:17.124588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fa41200f-bebd-4ca7-bbd9-c4beb0a2beea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82f27530>]}
[0m12:33:17.232540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fa41200f-bebd-4ca7-bbd9-c4beb0a2beea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84917830>]}
[0m12:33:17.235000 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m12:33:17.404634 [debug] [MainThread]: checksum: 87546e06832e1286bf2d49b8b108dd3f58da97cbfca650a1f147ec4aedfbbf25, vars: {}, profile: , target: dev, version: 1.10.13
[0m12:33:17.697798 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m12:33:17.699052 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://models/examples/my_first_dbt_model.sql
[0m12:33:18.115908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fa41200f-bebd-4ca7-bbd9-c4beb0a2beea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82e4ebd0>]}
[0m12:33:18.256856 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m12:33:18.262098 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m12:33:18.297864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fa41200f-bebd-4ca7-bbd9-c4beb0a2beea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82a225a0>]}
[0m12:33:18.299613 [info ] [MainThread]: Found 4 models, 2 sources, 492 macros
[0m12:33:18.302502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fa41200f-bebd-4ca7-bbd9-c4beb0a2beea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82e4deb0>]}
[0m12:33:18.307631 [info ] [MainThread]: 
[0m12:33:18.309229 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:33:18.309815 [info ] [MainThread]: 
[0m12:33:18.311297 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:33:18.317120 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JAFFLE_SHOP'
[0m12:33:18.440234 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP"
[0m12:33:18.441510 [debug] [ThreadPool]: On list_JAFFLE_SHOP: show terse schemas in database JAFFLE_SHOP
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_JAFFLE_SHOP"} */
[0m12:33:18.442405 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:33:21.787540 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 3.344 seconds
[0m12:33:21.798660 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JAFFLE_SHOP_ANALYTICS'
[0m12:33:21.830597 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP_ANALYTICS"
[0m12:33:21.832689 [debug] [ThreadPool]: On list_JAFFLE_SHOP_ANALYTICS: show objects in JAFFLE_SHOP.ANALYTICS
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_JAFFLE_SHOP_ANALYTICS"} */;
[0m12:33:21.833178 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:33:24.609931 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.776 seconds
[0m12:33:24.623846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fa41200f-bebd-4ca7-bbd9-c4beb0a2beea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86e28c50>]}
[0m12:33:24.639091 [debug] [Thread-1 (]: Began running node model.jaffle_shop.customers
[0m12:33:24.640101 [debug] [Thread-2 (]: Began running node model.jaffle_shop.my_first_dbt_model
[0m12:33:24.640756 [debug] [Thread-3 (]: Began running node model.jaffle_shop.orders
[0m12:33:24.642013 [info ] [Thread-1 (]: 1 of 4 START sql table model ANALYTICS.customers ............................... [RUN]
[0m12:33:24.646785 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_JAFFLE_SHOP_ANALYTICS, now model.jaffle_shop.customers)
[0m12:33:24.645605 [info ] [Thread-3 (]: 3 of 4 START sql table model ANALYTICS.orders .................................. [RUN]
[0m12:33:24.643884 [info ] [Thread-2 (]: 2 of 4 START sql view model ANALYTICS.my_first_dbt_model ....................... [RUN]
[0m12:33:24.650367 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.jaffle_shop.my_first_dbt_model'
[0m12:33:24.649302 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_JAFFLE_SHOP, now model.jaffle_shop.orders)
[0m12:33:24.648347 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.customers
[0m12:33:24.651160 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.my_first_dbt_model
[0m12:33:24.652006 [debug] [Thread-3 (]: Began compiling node model.jaffle_shop.orders
[0m12:33:24.665405 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.customers"
[0m12:33:24.669048 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.my_first_dbt_model"
[0m12:33:24.671869 [debug] [Thread-3 (]: Writing injected SQL for node "model.jaffle_shop.orders"
[0m12:33:24.675548 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.customers
[0m12:33:24.675852 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.my_first_dbt_model
[0m12:33:24.687577 [debug] [Thread-3 (]: Began executing node model.jaffle_shop.orders
[0m12:33:24.768397 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.customers"
[0m12:33:24.752190 [debug] [Thread-3 (]: Writing runtime sql for node "model.jaffle_shop.orders"
[0m12:33:24.794250 [debug] [Thread-2 (]: Writing runtime sql for node "model.jaffle_shop.my_first_dbt_model"
[0m12:33:24.797139 [debug] [Thread-3 (]: Using snowflake connection "model.jaffle_shop.orders"
[0m12:33:24.799281 [debug] [Thread-3 (]: On model.jaffle_shop.orders: create or replace transient table JAFFLE_SHOP.ANALYTICS.orders
    
    
    
    as (SELECT
        id as order_id
        ,customer as customer_id
        ,ordered_at
    FROM JAFFLE_SHOP.RAW.orders
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.orders"} */;
[0m12:33:24.798620 [debug] [Thread-1 (]: Using snowflake connection "model.jaffle_shop.customers"
[0m12:33:24.803559 [debug] [Thread-1 (]: On model.jaffle_shop.customers: create or replace transient table JAFFLE_SHOP.ANALYTICS.customers
    
    
    
    as (SELECT
    id
    ,split_part(name,' ',1) as first_name
    ,split_part(name,' ',2) as last_name
FROM JAFFLE_SHOP.RAW.customers
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */;
[0m12:33:24.806498 [debug] [Thread-2 (]: Using snowflake connection "model.jaffle_shop.my_first_dbt_model"
[0m12:33:24.810806 [debug] [Thread-2 (]: On model.jaffle_shop.my_first_dbt_model: create or replace   view JAFFLE_SHOP.ANALYTICS.my_first_dbt_model
  
  
  
  
  as (
    with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from raw.jaffle_shop.customers

),

orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from raw.jaffle_shop.orders

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
  )
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */;
[0m12:33:24.813090 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:33:25.612414 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01bfc531-0305-4f1b-0004-0c2600042172
[0m12:33:25.613199 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 002003 (02000): SQL compilation error:
Database 'RAW' does not exist or not authorized.
[0m12:33:25.627802 [debug] [Thread-2 (]: Database Error in model my_first_dbt_model (models/examples/my_first_dbt_model.sql)
  002003 (02000): SQL compilation error:
  Database 'RAW' does not exist or not authorized.
  compiled code at target/run/jaffle_shop/models/examples/my_first_dbt_model.sql
[0m12:33:25.638241 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fa41200f-bebd-4ca7-bbd9-c4beb0a2beea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff853f2540>]}
[0m12:33:25.640641 [error] [Thread-2 (]: 2 of 4 ERROR creating sql view model ANALYTICS.my_first_dbt_model .............. [[31mERROR[0m in 0.98s]
[0m12:33:25.642197 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.my_first_dbt_model
[0m12:33:25.644223 [debug] [Thread-7 (]: Marking all children of 'model.jaffle_shop.my_first_dbt_model' to be skipped because of status 'error'.  Reason: Database Error in model my_first_dbt_model (models/examples/my_first_dbt_model.sql)
  002003 (02000): SQL compilation error:
  Database 'RAW' does not exist or not authorized.
  compiled code at target/run/jaffle_shop/models/examples/my_first_dbt_model.sql.
[0m12:33:26.996839 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.189 seconds
[0m12:33:27.008317 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 2.208 seconds
[0m12:33:27.055562 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fa41200f-bebd-4ca7-bbd9-c4beb0a2beea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81143a10>]}
[0m12:33:27.056373 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fa41200f-bebd-4ca7-bbd9-c4beb0a2beea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff811fe1b0>]}
[0m12:33:27.057104 [info ] [Thread-1 (]: 1 of 4 OK created sql table model ANALYTICS.customers .......................... [[32mSUCCESS 1[0m in 2.41s]
[0m12:33:27.057893 [info ] [Thread-3 (]: 3 of 4 OK created sql table model ANALYTICS.orders ............................. [[32mSUCCESS 1[0m in 2.41s]
[0m12:33:27.058654 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.customers
[0m12:33:27.059172 [debug] [Thread-3 (]: Finished running node model.jaffle_shop.orders
[0m12:33:27.061240 [debug] [Thread-4 (]: Began running node model.jaffle_shop.order_customer
[0m12:33:27.061688 [info ] [Thread-4 (]: 4 of 4 START sql table model ANALYTICS.order_customer .......................... [RUN]
[0m12:33:27.062472 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.jaffle_shop.order_customer'
[0m12:33:27.063254 [debug] [Thread-4 (]: Began compiling node model.jaffle_shop.order_customer
[0m12:33:27.072810 [debug] [Thread-4 (]: Writing injected SQL for node "model.jaffle_shop.order_customer"
[0m12:33:27.074538 [debug] [Thread-4 (]: Began executing node model.jaffle_shop.order_customer
[0m12:33:27.077189 [debug] [Thread-4 (]: Writing runtime sql for node "model.jaffle_shop.order_customer"
[0m12:33:27.078765 [debug] [Thread-4 (]: Using snowflake connection "model.jaffle_shop.order_customer"
[0m12:33:27.079227 [debug] [Thread-4 (]: On model.jaffle_shop.order_customer: create or replace transient table JAFFLE_SHOP.ANALYTICS.order_customer
    
    
    
    as (select 
    o.order_id
    ,o.customer_id
    ,c.first_name
    ,c.last_name
from JAFFLE_SHOP.ANALYTICS.customers as c
join JAFFLE_SHOP.ANALYTICS.orders o on o.customer_id = c.id
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.order_customer"} */;
[0m12:33:27.079694 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:33:29.409686 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 2.329 seconds
[0m12:33:29.433075 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fa41200f-bebd-4ca7-bbd9-c4beb0a2beea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81d87bf0>]}
[0m12:33:29.435912 [info ] [Thread-4 (]: 4 of 4 OK created sql table model ANALYTICS.order_customer ..................... [[32mSUCCESS 1[0m in 2.37s]
[0m12:33:29.438040 [debug] [Thread-4 (]: Finished running node model.jaffle_shop.order_customer
[0m12:33:29.449461 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:33:29.452051 [debug] [MainThread]: Connection 'model.jaffle_shop.orders' was left open.
[0m12:33:29.453240 [debug] [MainThread]: On model.jaffle_shop.orders: Close
[0m12:33:29.711394 [debug] [MainThread]: Connection 'model.jaffle_shop.customers' was left open.
[0m12:33:29.713275 [debug] [MainThread]: On model.jaffle_shop.customers: Close
[0m12:33:29.874176 [debug] [MainThread]: Connection 'model.jaffle_shop.my_first_dbt_model' was left open.
[0m12:33:29.876002 [debug] [MainThread]: On model.jaffle_shop.my_first_dbt_model: Close
[0m12:33:30.133110 [debug] [MainThread]: Connection 'model.jaffle_shop.order_customer' was left open.
[0m12:33:30.133914 [debug] [MainThread]: On model.jaffle_shop.order_customer: Close
[0m12:33:30.314373 [info ] [MainThread]: 
[0m12:33:30.315441 [info ] [MainThread]: Finished running 3 table models, 1 view model in 0 hours 0 minutes and 12.00 seconds (12.00s).
[0m12:33:30.318140 [debug] [MainThread]: Command end result
[0m12:33:30.389118 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m12:33:30.395480 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m12:33:30.403209 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/target/run_results.json
[0m12:33:30.403957 [info ] [MainThread]: 
[0m12:33:30.404775 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:33:30.405551 [info ] [MainThread]: 
[0m12:33:30.406199 [error] [MainThread]: [31mFailure in model my_first_dbt_model (models/examples/my_first_dbt_model.sql)[0m
[0m12:33:30.406631 [error] [MainThread]:   Database Error in model my_first_dbt_model (models/examples/my_first_dbt_model.sql)
  002003 (02000): SQL compilation error:
  Database 'RAW' does not exist or not authorized.
  compiled code at target/run/jaffle_shop/models/examples/my_first_dbt_model.sql
[0m12:33:30.407121 [info ] [MainThread]: 
[0m12:33:30.407640 [info ] [MainThread]:   compiled code at target/compiled/jaffle_shop/models/examples/my_first_dbt_model.sql
[0m12:33:30.408040 [info ] [MainThread]: 
[0m12:33:30.408455 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=4
[0m12:33:30.410382 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 14.163809, "process_in_blocks": "256", "process_kernel_time": 1.192691, "process_mem_max_rss": "160744", "process_out_blocks": "3078", "process_user_time": 4.337433}
[0m12:33:30.410946 [debug] [MainThread]: Command `dbt run` failed at 12:33:30.410868 after 14.16 seconds
[0m12:33:30.411590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84cd6720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff853f2540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff805b6690>]}
[0m12:33:30.412027 [debug] [MainThread]: Flushing usage events
[0m12:33:30.913578 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:22:13.441076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad9207a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffade00fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb02af740>]}


============================== 15:22:13.444782 | 4aad2dec-7d13-4d98-83dd-83fc305887f8 ==============================
[0m15:22:13.444782 [info ] [MainThread]: Running with dbt=1.10.13
[0m15:22:13.445141 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'cache_selected_only': 'False', 'invocation_command': 'dbt deps --profiles-dir . --target dev', 'send_anonymous_usage_stats': 'True', 'empty': 'None', 'use_colors': 'True', 'write_json': 'True', 'no_print': 'None', 'version_check': 'True', 'printer_width': '80', 'warn_error': 'None', 'debug': 'False', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'log_path': '/opt/airflow/dbt/logs', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': '.', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'fail_fast': 'False', 'quiet': 'False'}
[0m15:22:13.517333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4aad2dec-7d13-4d98-83dd-83fc305887f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae2a2f60>]}
[0m15:22:13.534436 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m15:22:13.535510 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m15:22:13.536731 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.12840888, "process_in_blocks": "98064", "process_kernel_time": 0.446455, "process_mem_max_rss": "100724", "process_out_blocks": "3", "process_user_time": 0.924294}
[0m15:22:13.536994 [debug] [MainThread]: Command `dbt deps` succeeded at 15:22:13.536943 after 0.13 seconds
[0m15:22:13.537170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae0c09b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad173080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb02af740>]}
[0m15:22:13.537342 [debug] [MainThread]: Flushing usage events
[0m15:22:14.900876 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:22:15.952990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb9418860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb9d5e3f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffba02b3e0>]}


============================== 15:22:15.955968 | f58cf2bd-51c1-4a3d-a124-fd00bdf34fb6 ==============================
[0m15:22:15.955968 [info ] [MainThread]: Running with dbt=1.10.13
[0m15:22:15.956550 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'debug': 'False', 'invocation_command': 'dbt run --profiles-dir . --target dev', 'introspect': 'True', 'version_check': 'True', 'warn_error': 'None', 'empty': 'False', 'target_path': 'None', 'profiles_dir': '.', 'indirect_selection': 'eager', 'printer_width': '80', 'log_format': 'default', 'use_colors': 'True', 'partial_parse': 'True', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False'}
[0m15:22:16.764865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f58cf2bd-51c1-4a3d-a124-fd00bdf34fb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8f90c50>]}
[0m15:22:16.812539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f58cf2bd-51c1-4a3d-a124-fd00bdf34fb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7c4f4a0>]}
[0m15:22:16.815461 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m15:22:16.893636 [debug] [MainThread]: checksum: 87546e06832e1286bf2d49b8b108dd3f58da97cbfca650a1f147ec4aedfbbf25, vars: {}, profile: , target: dev, version: 1.10.13
[0m15:22:16.993854 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m15:22:16.994555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f58cf2bd-51c1-4a3d-a124-fd00bdf34fb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb76a6750>]}
[0m15:22:17.670573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f58cf2bd-51c1-4a3d-a124-fd00bdf34fb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb75c7a70>]}
[0m15:22:17.710912 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m15:22:17.713434 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m15:22:17.724194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f58cf2bd-51c1-4a3d-a124-fd00bdf34fb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb779ba70>]}
[0m15:22:17.724663 [info ] [MainThread]: Found 4 models, 6 sources, 493 macros
[0m15:22:17.725462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f58cf2bd-51c1-4a3d-a124-fd00bdf34fb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7612ea0>]}
[0m15:22:17.726607 [info ] [MainThread]: 
[0m15:22:17.726880 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:22:17.727071 [info ] [MainThread]: 
[0m15:22:17.727382 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:22:17.730344 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JAFFLE_SHOP'
[0m15:22:17.736279 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JAFFLE_SHOP'
[0m15:22:17.787207 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP"
[0m15:22:17.787702 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP"
[0m15:22:17.787951 [debug] [ThreadPool]: On list_JAFFLE_SHOP: show terse schemas in database JAFFLE_SHOP
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_JAFFLE_SHOP"} */
[0m15:22:17.788253 [debug] [ThreadPool]: On list_JAFFLE_SHOP: show terse schemas in database JAFFLE_SHOP
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_JAFFLE_SHOP"} */
[0m15:22:17.788457 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:22:17.788735 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:22:21.690146 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 3.901 seconds
[0m15:22:21.692648 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 3.904 seconds
[0m15:22:21.704005 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_JAFFLE_SHOP, now list_JAFFLE_SHOP_ANALYTICS)
[0m15:22:21.710456 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_JAFFLE_SHOP, now list_JAFFLE_SHOP_staging)
[0m15:22:21.730384 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP_ANALYTICS"
[0m15:22:21.733713 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP_staging"
[0m15:22:21.734150 [debug] [ThreadPool]: On list_JAFFLE_SHOP_ANALYTICS: show objects in JAFFLE_SHOP.ANALYTICS
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_JAFFLE_SHOP_ANALYTICS"} */;
[0m15:22:21.734653 [debug] [ThreadPool]: On list_JAFFLE_SHOP_staging: show objects in JAFFLE_SHOP.staging
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_JAFFLE_SHOP_staging"} */;
[0m15:22:21.848940 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.111 seconds
[0m15:22:21.850259 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.115 seconds
[0m15:22:21.855734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f58cf2bd-51c1-4a3d-a124-fd00bdf34fb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7a29730>]}
[0m15:22:21.867068 [debug] [Thread-1 (]: Began running node model.jaffle_shop.my_first_dbt_model
[0m15:22:21.867837 [debug] [Thread-2 (]: Began running node model.jaffle_shop.stg_customers
[0m15:22:21.868149 [debug] [Thread-3 (]: Began running node model.jaffle_shop.stg_orders
[0m15:22:21.868744 [info ] [Thread-1 (]: 1 of 4 START sql view model ANALYTICS.my_first_dbt_model ....................... [RUN]
[0m15:22:21.869362 [info ] [Thread-2 (]: 2 of 4 START sql table model staging.stg_customers ............................. [RUN]
[0m15:22:21.869744 [info ] [Thread-3 (]: 3 of 4 START sql table model staging.stg_orders ................................ [RUN]
[0m15:22:21.870214 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_JAFFLE_SHOP_ANALYTICS, now model.jaffle_shop.my_first_dbt_model)
[0m15:22:21.870482 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_JAFFLE_SHOP_staging, now model.jaffle_shop.stg_customers)
[0m15:22:21.871050 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.jaffle_shop.stg_orders'
[0m15:22:21.871447 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.my_first_dbt_model
[0m15:22:21.871709 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.stg_customers
[0m15:22:21.872483 [debug] [Thread-3 (]: Began compiling node model.jaffle_shop.stg_orders
[0m15:22:21.878508 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.my_first_dbt_model"
[0m15:22:21.881209 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.stg_customers"
[0m15:22:21.883150 [debug] [Thread-3 (]: Writing injected SQL for node "model.jaffle_shop.stg_orders"
[0m15:22:21.885236 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.my_first_dbt_model
[0m15:22:21.904385 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.my_first_dbt_model"
[0m15:22:21.904728 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.stg_customers
[0m15:22:21.905025 [debug] [Thread-3 (]: Began executing node model.jaffle_shop.stg_orders
[0m15:22:21.929312 [debug] [Thread-3 (]: Writing runtime sql for node "model.jaffle_shop.stg_orders"
[0m15:22:21.932081 [debug] [Thread-2 (]: Writing runtime sql for node "model.jaffle_shop.stg_customers"
[0m15:22:21.933914 [debug] [Thread-1 (]: Using snowflake connection "model.jaffle_shop.my_first_dbt_model"
[0m15:22:21.934488 [debug] [Thread-1 (]: On model.jaffle_shop.my_first_dbt_model: create or replace   view JAFFLE_SHOP.ANALYTICS.my_first_dbt_model
  
  
  
  
  as (
    with customers as (

    select
        id as customer_id,
        name
    from jaffle_shop.raw.raw_customers

),

orders as (

    select
        id as order_id,
        customer as customer_id,
        ordered_at
    from jaffle_shop.raw.raw_orders

),

customer_orders as (

    select
        customer_id,
        min(ordered_at) as first_order_date,
        max(ordered_at) as most_recent_order_date,
        count(order_id) as number_of_orders
    from orders

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
  )
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */;
[0m15:22:21.938708 [debug] [Thread-3 (]: Using snowflake connection "model.jaffle_shop.stg_orders"
[0m15:22:21.939246 [debug] [Thread-3 (]: On model.jaffle_shop.stg_orders: create or replace transient table JAFFLE_SHOP.staging.stg_orders
    
    
    
    as (SELECT
        id as order_id
        ,customer as customer_id
        ,ordered_at
        ,store_id
        ,subtotal
        ,tax_paid
        ,order_total
    FROM JAFFLE_SHOP.RAW.raw_orders
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */;
[0m15:22:21.939787 [debug] [Thread-2 (]: Using snowflake connection "model.jaffle_shop.stg_customers"
[0m15:22:21.940002 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:22:21.940269 [debug] [Thread-2 (]: On model.jaffle_shop.stg_customers: create or replace transient table JAFFLE_SHOP.staging.stg_customers
    
    
    
    as (SELECT
    id as customer_id
    ,split_part(name,' ',1) as first_name
    ,split_part(name,' ',2) as last_name
FROM JAFFLE_SHOP.RAW.raw_customers
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */;
[0m15:22:22.155493 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.221 seconds
[0m15:22:22.183927 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f58cf2bd-51c1-4a3d-a124-fd00bdf34fb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5d3ede0>]}
[0m15:22:22.184807 [info ] [Thread-1 (]: 1 of 4 OK created sql view model ANALYTICS.my_first_dbt_model .................. [[32mSUCCESS 1[0m in 0.31s]
[0m15:22:22.185534 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.my_first_dbt_model
[0m15:22:23.077329 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.127 seconds
[0m15:22:23.080939 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f58cf2bd-51c1-4a3d-a124-fd00bdf34fb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4597860>]}
[0m15:22:23.081711 [info ] [Thread-2 (]: 2 of 4 OK created sql table model staging.stg_customers ........................ [[32mSUCCESS 1[0m in 1.21s]
[0m15:22:23.082365 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.stg_customers
[0m15:22:24.475117 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 2.535 seconds
[0m15:22:24.478330 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f58cf2bd-51c1-4a3d-a124-fd00bdf34fb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5d86690>]}
[0m15:22:24.479240 [info ] [Thread-3 (]: 3 of 4 OK created sql table model staging.stg_orders ........................... [[32mSUCCESS 1[0m in 2.61s]
[0m15:22:24.480128 [debug] [Thread-3 (]: Finished running node model.jaffle_shop.stg_orders
[0m15:22:24.482117 [debug] [Thread-4 (]: Began running node model.jaffle_shop.orders_customers
[0m15:22:24.482979 [info ] [Thread-4 (]: 4 of 4 START sql table model ANALYTICS.orders_customers ........................ [RUN]
[0m15:22:24.483924 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.jaffle_shop.orders_customers'
[0m15:22:24.484675 [debug] [Thread-4 (]: Began compiling node model.jaffle_shop.orders_customers
[0m15:22:24.491002 [debug] [Thread-4 (]: Writing injected SQL for node "model.jaffle_shop.orders_customers"
[0m15:22:24.492927 [debug] [Thread-4 (]: Began executing node model.jaffle_shop.orders_customers
[0m15:22:24.496263 [debug] [Thread-4 (]: Writing runtime sql for node "model.jaffle_shop.orders_customers"
[0m15:22:24.498353 [debug] [Thread-4 (]: Using snowflake connection "model.jaffle_shop.orders_customers"
[0m15:22:24.498822 [debug] [Thread-4 (]: On model.jaffle_shop.orders_customers: create or replace transient table JAFFLE_SHOP.ANALYTICS.orders_customers
    
    
    
    as (select 
    o.order_id
    ,o.customer_id
    ,c.first_name
    ,c.last_name
from JAFFLE_SHOP.staging.stg_customers as c
join JAFFLE_SHOP.staging.stg_orders o on o.customer_id = c.customer_id
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.orders_customers"} */;
[0m15:22:24.499203 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:22:26.624249 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 2.125 seconds
[0m15:22:26.627466 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f58cf2bd-51c1-4a3d-a124-fd00bdf34fb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb45b2bd0>]}
[0m15:22:26.628557 [info ] [Thread-4 (]: 4 of 4 OK created sql table model ANALYTICS.orders_customers ................... [[32mSUCCESS 1[0m in 2.14s]
[0m15:22:26.629071 [debug] [Thread-4 (]: Finished running node model.jaffle_shop.orders_customers
[0m15:22:26.631174 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:22:26.631497 [debug] [MainThread]: Connection 'model.jaffle_shop.my_first_dbt_model' was left open.
[0m15:22:26.631708 [debug] [MainThread]: On model.jaffle_shop.my_first_dbt_model: Close
[0m15:22:26.741683 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_customers' was left open.
[0m15:22:26.742536 [debug] [MainThread]: On model.jaffle_shop.stg_customers: Close
[0m15:22:26.901595 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_orders' was left open.
[0m15:22:26.902100 [debug] [MainThread]: On model.jaffle_shop.stg_orders: Close
[0m15:22:27.016143 [debug] [MainThread]: Connection 'model.jaffle_shop.orders_customers' was left open.
[0m15:22:27.017077 [debug] [MainThread]: On model.jaffle_shop.orders_customers: Close
[0m15:22:27.159222 [info ] [MainThread]: 
[0m15:22:27.161143 [info ] [MainThread]: Finished running 3 table models, 1 view model in 0 hours 0 minutes and 9.43 seconds (9.43s).
[0m15:22:27.163701 [debug] [MainThread]: Command end result
[0m15:22:27.190563 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m15:22:27.194015 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m15:22:27.200833 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/target/run_results.json
[0m15:22:27.201297 [info ] [MainThread]: 
[0m15:22:27.201747 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:22:27.202303 [info ] [MainThread]: 
[0m15:22:27.202711 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m15:22:27.204837 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.292279, "process_in_blocks": "49904", "process_kernel_time": 1.200435, "process_mem_max_rss": "169828", "process_out_blocks": "7820", "process_user_time": 3.321946}
[0m15:22:27.205530 [debug] [MainThread]: Command `dbt run` succeeded at 15:22:27.205441 after 11.29 seconds
[0m15:22:27.205975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7649e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb764b7a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7178230>]}
[0m15:22:27.206303 [debug] [MainThread]: Flushing usage events
[0m15:22:28.603862 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:22:30.730899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7af4e0c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7a845130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ab03230>]}


============================== 15:22:30.740318 | 2c887ff5-f0ca-470e-b6b0-aed4d49dafa8 ==============================
[0m15:22:30.740318 [info ] [MainThread]: Running with dbt=1.10.13
[0m15:22:30.741604 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'static_parser': 'True', 'partial_parse': 'True', 'version_check': 'True', 'write_json': 'True', 'cache_selected_only': 'False', 'use_colors': 'True', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': '/opt/airflow/dbt/logs', 'indirect_selection': 'eager', 'introspect': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'no_print': 'None', 'fail_fast': 'False', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'invocation_command': 'dbt docs generate --profiles-dir . --target dev', 'profiles_dir': '.', 'warn_error': 'None', 'debug': 'False', 'printer_width': '80', 'quiet': 'False'}
[0m15:22:31.099658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2c887ff5-f0ca-470e-b6b0-aed4d49dafa8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c8b6810>]}
[0m15:22:31.143982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2c887ff5-f0ca-470e-b6b0-aed4d49dafa8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ab951f0>]}
[0m15:22:31.144735 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m15:22:31.206709 [debug] [MainThread]: checksum: 87546e06832e1286bf2d49b8b108dd3f58da97cbfca650a1f147ec4aedfbbf25, vars: {}, profile: , target: dev, version: 1.10.13
[0m15:22:31.339921 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:22:31.340352 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:22:31.363809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2c887ff5-f0ca-470e-b6b0-aed4d49dafa8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff78751f70>]}
[0m15:22:31.380849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2c887ff5-f0ca-470e-b6b0-aed4d49dafa8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7864afc0>]}
[0m15:22:31.381435 [info ] [MainThread]: Found 4 models, 6 sources, 493 macros
[0m15:22:31.382003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2c887ff5-f0ca-470e-b6b0-aed4d49dafa8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff784576b0>]}
[0m15:22:31.383618 [info ] [MainThread]: 
[0m15:22:31.384196 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:22:31.384554 [info ] [MainThread]: 
[0m15:22:31.385046 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:22:31.388905 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JAFFLE_SHOP_staging'
[0m15:22:31.397991 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JAFFLE_SHOP_ANALYTICS'
[0m15:22:31.443980 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP_staging"
[0m15:22:31.444514 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP_ANALYTICS"
[0m15:22:31.444742 [debug] [ThreadPool]: On list_JAFFLE_SHOP_staging: show objects in JAFFLE_SHOP.staging
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_JAFFLE_SHOP_staging"} */;
[0m15:22:31.445067 [debug] [ThreadPool]: On list_JAFFLE_SHOP_ANALYTICS: show objects in JAFFLE_SHOP.ANALYTICS
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_JAFFLE_SHOP_ANALYTICS"} */;
[0m15:22:31.445351 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:22:31.445613 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:22:33.118959 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.673 seconds
[0m15:22:33.121779 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.676 seconds
[0m15:22:33.123625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2c887ff5-f0ca-470e-b6b0-aed4d49dafa8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7897c380>]}
[0m15:22:33.125874 [debug] [Thread-1 (]: Began running node model.jaffle_shop.my_first_dbt_model
[0m15:22:33.126125 [debug] [Thread-2 (]: Began running node model.jaffle_shop.stg_customers
[0m15:22:33.126314 [debug] [Thread-3 (]: Began running node model.jaffle_shop.stg_orders
[0m15:22:33.126562 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_JAFFLE_SHOP_ANALYTICS, now model.jaffle_shop.my_first_dbt_model)
[0m15:22:33.126911 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_JAFFLE_SHOP_staging, now model.jaffle_shop.stg_customers)
[0m15:22:33.127287 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.jaffle_shop.stg_orders'
[0m15:22:33.127551 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.my_first_dbt_model
[0m15:22:33.127783 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.stg_customers
[0m15:22:33.128031 [debug] [Thread-3 (]: Began compiling node model.jaffle_shop.stg_orders
[0m15:22:33.132329 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.my_first_dbt_model"
[0m15:22:33.135313 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.stg_customers"
[0m15:22:33.137022 [debug] [Thread-3 (]: Writing injected SQL for node "model.jaffle_shop.stg_orders"
[0m15:22:33.138139 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.my_first_dbt_model
[0m15:22:33.138616 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.my_first_dbt_model
[0m15:22:33.138940 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.stg_customers
[0m15:22:33.139180 [debug] [Thread-3 (]: Began executing node model.jaffle_shop.stg_orders
[0m15:22:33.139600 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.stg_customers
[0m15:22:33.139969 [debug] [Thread-3 (]: Finished running node model.jaffle_shop.stg_orders
[0m15:22:33.140527 [debug] [Thread-4 (]: Began running node model.jaffle_shop.orders_customers
[0m15:22:33.140839 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.jaffle_shop.orders_customers'
[0m15:22:33.141030 [debug] [Thread-4 (]: Began compiling node model.jaffle_shop.orders_customers
[0m15:22:33.142765 [debug] [Thread-4 (]: Writing injected SQL for node "model.jaffle_shop.orders_customers"
[0m15:22:33.143418 [debug] [Thread-4 (]: Began executing node model.jaffle_shop.orders_customers
[0m15:22:33.143756 [debug] [Thread-4 (]: Finished running node model.jaffle_shop.orders_customers
[0m15:22:33.144512 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:22:33.144738 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_customers' was left open.
[0m15:22:33.144926 [debug] [MainThread]: On model.jaffle_shop.stg_customers: Close
[0m15:22:33.269475 [debug] [MainThread]: Connection 'model.jaffle_shop.my_first_dbt_model' was left open.
[0m15:22:33.270501 [debug] [MainThread]: On model.jaffle_shop.my_first_dbt_model: Close
[0m15:22:33.392923 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_orders' was properly closed.
[0m15:22:33.393674 [debug] [MainThread]: Connection 'model.jaffle_shop.orders_customers' was properly closed.
[0m15:22:33.396000 [debug] [MainThread]: Command end result
[0m15:22:33.586262 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m15:22:33.592443 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m15:22:33.602637 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/target/run_results.json
[0m15:22:33.628818 [debug] [MainThread]: Acquiring new snowflake connection 'generate_catalog'
[0m15:22:33.630519 [info ] [MainThread]: Building catalog
[0m15:22:33.662229 [debug] [ThreadPool]: Acquiring new snowflake connection 'JAFFLE_SHOP.information_schema'
[0m15:22:33.690822 [debug] [ThreadPool]: Using snowflake connection "JAFFLE_SHOP.information_schema"
[0m15:22:33.691547 [debug] [ThreadPool]: On JAFFLE_SHOP.information_schema: with tables as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",
        case
            when is_dynamic = 'YES' and table_type = 'BASE TABLE' THEN 'DYNAMIC TABLE'
            else table_type
        end as "table_type",
        comment as "table_comment",

        -- note: this is the _role_ that owns the table
        table_owner as "table_owner",

        'Clustering Key' as "stats:clustering_key:label",
        clustering_key as "stats:clustering_key:value",
        'The key used to cluster this table' as "stats:clustering_key:description",
        (clustering_key is not null) as "stats:clustering_key:include",

        'Row Count' as "stats:row_count:label",
        row_count as "stats:row_count:value",
        'An approximate count of rows in this table' as "stats:row_count:description",
        (row_count is not null) as "stats:row_count:include",

        'Approximate Size' as "stats:bytes:label",
        bytes as "stats:bytes:value",
        'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
        (bytes is not null) as "stats:bytes:include",

        'Last Modified' as "stats:last_modified:label",
        to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
        'The timestamp for last update/change' as "stats:last_modified:description",
        (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"
    from JAFFLE_SHOP.INFORMATION_SCHEMA.tables
            where (
                (
                    
    "table_schema" ilike 'RAW' and upper("table_schema") = upper('RAW')

                    and 
    "table_name" ilike 'raw_orders' and upper("table_name") = upper('raw_orders')

                )
             or 
                (
                    
    "table_schema" ilike 'RAW' and upper("table_schema") = upper('RAW')

                    and 
    "table_name" ilike 'raw_stores' and upper("table_name") = upper('raw_stores')

                )
             or 
                (
                    
    "table_schema" ilike 'ANALYTICS' and upper("table_schema") = upper('ANALYTICS')

                    and 
    "table_name" ilike 'my_first_dbt_model' and upper("table_name") = upper('my_first_dbt_model')

                )
             or 
                (
                    
    "table_schema" ilike 'RAW' and upper("table_schema") = upper('RAW')

                    and 
    "table_name" ilike 'raw_customers' and upper("table_name") = upper('raw_customers')

                )
             or 
                (
                    
    "table_schema" ilike 'RAW' and upper("table_schema") = upper('RAW')

                    and 
    "table_name" ilike 'raw_products' and upper("table_name") = upper('raw_products')

                )
             or 
                (
                    
    "table_schema" ilike 'RAW' and upper("table_schema") = upper('RAW')

                    and 
    "table_name" ilike 'raw_items' and upper("table_name") = upper('raw_items')

                )
             or 
                (
                    
    "table_schema" ilike 'staging' and upper("table_schema") = upper('staging')

                    and 
    "table_name" ilike 'stg_customers' and upper("table_name") = upper('stg_customers')

                )
             or 
                (
                    
    "table_schema" ilike 'ANALYTICS' and upper("table_schema") = upper('ANALYTICS')

                    and 
    "table_name" ilike 'orders_customers' and upper("table_name") = upper('orders_customers')

                )
             or 
                (
                    
    "table_schema" ilike 'staging' and upper("table_schema") = upper('staging')

                    and 
    "table_name" ilike 'stg_orders' and upper("table_name") = upper('stg_orders')

                )
             or 
                (
                    
    "table_schema" ilike 'RAW' and upper("table_schema") = upper('RAW')

                    and 
    "table_name" ilike 'raw_supplies' and upper("table_name") = upper('raw_supplies')

                )
            )
        ),
        columns as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",

        column_name as "column_name",
        ordinal_position as "column_index",
        data_type as "column_type",
        comment as "column_comment"
    from JAFFLE_SHOP.INFORMATION_SCHEMA.columns
            where (
                (
                    
    "table_schema" ilike 'RAW' and upper("table_schema") = upper('RAW')

                    and 
    "table_name" ilike 'raw_orders' and upper("table_name") = upper('raw_orders')

                )
             or 
                (
                    
    "table_schema" ilike 'RAW' and upper("table_schema") = upper('RAW')

                    and 
    "table_name" ilike 'raw_stores' and upper("table_name") = upper('raw_stores')

                )
             or 
                (
                    
    "table_schema" ilike 'ANALYTICS' and upper("table_schema") = upper('ANALYTICS')

                    and 
    "table_name" ilike 'my_first_dbt_model' and upper("table_name") = upper('my_first_dbt_model')

                )
             or 
                (
                    
    "table_schema" ilike 'RAW' and upper("table_schema") = upper('RAW')

                    and 
    "table_name" ilike 'raw_customers' and upper("table_name") = upper('raw_customers')

                )
             or 
                (
                    
    "table_schema" ilike 'RAW' and upper("table_schema") = upper('RAW')

                    and 
    "table_name" ilike 'raw_products' and upper("table_name") = upper('raw_products')

                )
             or 
                (
                    
    "table_schema" ilike 'RAW' and upper("table_schema") = upper('RAW')

                    and 
    "table_name" ilike 'raw_items' and upper("table_name") = upper('raw_items')

                )
             or 
                (
                    
    "table_schema" ilike 'staging' and upper("table_schema") = upper('staging')

                    and 
    "table_name" ilike 'stg_customers' and upper("table_name") = upper('stg_customers')

                )
             or 
                (
                    
    "table_schema" ilike 'ANALYTICS' and upper("table_schema") = upper('ANALYTICS')

                    and 
    "table_name" ilike 'orders_customers' and upper("table_name") = upper('orders_customers')

                )
             or 
                (
                    
    "table_schema" ilike 'staging' and upper("table_schema") = upper('staging')

                    and 
    "table_name" ilike 'stg_orders' and upper("table_name") = upper('stg_orders')

                )
             or 
                (
                    
    "table_schema" ilike 'RAW' and upper("table_schema") = upper('RAW')

                    and 
    "table_name" ilike 'raw_supplies' and upper("table_name") = upper('raw_supplies')

                )
            )
        )
        select *
    from tables
    join columns using ("table_database", "table_schema", "table_name")
    order by "column_index"
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "JAFFLE_SHOP.information_schema"} */
[0m15:22:33.692147 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:22:38.801697 [debug] [ThreadPool]: SQL status: SUCCESS 45 in 5.106 seconds
[0m15:22:38.850563 [debug] [MainThread]: Wrote artifact CatalogArtifact to /opt/airflow/dbt/target/catalog.json
[0m15:22:38.872586 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m15:22:38.874597 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m15:22:38.874802 [info ] [MainThread]: Catalog written to /opt/airflow/dbt/target/catalog.json
[0m15:22:38.876571 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 8.232785, "process_in_blocks": "3400", "process_kernel_time": 0.459909, "process_mem_max_rss": "155760", "process_out_blocks": "5463", "process_user_time": 2.384452}
[0m15:22:38.877041 [debug] [MainThread]: Command `dbt docs generate` succeeded at 15:22:38.876982 after 8.23 seconds
[0m15:22:38.877417 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m15:22:38.877574 [debug] [MainThread]: Connection 'JAFFLE_SHOP.information_schema' was left open.
[0m15:22:38.877750 [debug] [MainThread]: On JAFFLE_SHOP.information_schema: Close
[0m15:22:39.011004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff75ba81d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff75ba8170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7a3be0f0>]}
[0m15:22:39.012231 [debug] [MainThread]: Flushing usage events
[0m15:22:40.231842 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:22:41.484900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3f5dc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3aa1820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa38149e0>]}


============================== 15:22:41.487410 | ce5c2ae3-0bb0-4b63-a69b-34b279ae437e ==============================
[0m15:22:41.487410 [info ] [MainThread]: Running with dbt=1.10.13
[0m15:22:41.487741 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'profiles_dir': '.', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'log_format': 'default', 'indirect_selection': 'eager', 'invocation_command': 'dbt docs serve --profiles-dir . --target dev --port 8085 --host 0.0.0.0', 'use_experimental_parser': 'False', 'no_print': 'None', 'target_path': 'None', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'empty': 'None', 'static_parser': 'True', 'partial_parse': 'True', 'introspect': 'True', 'version_check': 'True', 'write_json': 'True', 'fail_fast': 'False', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'debug': 'False', 'log_cache_events': 'False'}
[0m15:22:41.695314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ce5c2ae3-0bb0-4b63-a69b-34b279ae437e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1985220>]}
[0m15:22:41.726462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ce5c2ae3-0bb0-4b63-a69b-34b279ae437e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa19ba060>]}
[0m18:09:49.908397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c988e60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c951880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c4da960>]}


============================== 18:09:49.913850 | 2956aa10-38f1-4ade-984a-4eadb0c042a6 ==============================
[0m18:09:49.913850 [info ] [MainThread]: Running with dbt=1.10.13
[0m18:09:49.914362 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'partial_parse': 'True', 'profiles_dir': '/opt/airflow/dbt', 'static_parser': 'True', 'quiet': 'False', 'log_format': 'default', 'version_check': 'True', 'write_json': 'True', 'use_experimental_parser': 'False', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'log_cache_events': 'False', 'invocation_command': 'dbt source freshness', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'warn_error': 'None', 'target_path': 'None', 'cache_selected_only': 'False', 'empty': 'None', 'printer_width': '80', 'introspect': 'True', 'indirect_selection': 'eager'}
[0m18:09:51.856548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2956aa10-38f1-4ade-984a-4eadb0c042a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff728fb590>]}
[0m18:09:51.890752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2956aa10-38f1-4ade-984a-4eadb0c042a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff70b7de50>]}
[0m18:09:51.891324 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m18:09:51.966634 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m18:09:51.967487 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m18:09:51.967862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '2956aa10-38f1-4ade-984a-4eadb0c042a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c9f7d70>]}
[0m18:09:52.697557 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.jaffle_shop.examples
- models.jaffle_shop.analytics
[0m18:09:52.703444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2956aa10-38f1-4ade-984a-4eadb0c042a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff70401040>]}
[0m18:09:52.745174 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m18:09:52.746728 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m18:09:52.787960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2956aa10-38f1-4ade-984a-4eadb0c042a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7031c9e0>]}
[0m18:09:52.788328 [info ] [MainThread]: Found 3 models, 6 sources, 493 macros
[0m18:09:52.788596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2956aa10-38f1-4ade-984a-4eadb0c042a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c1f1880>]}
[0m18:09:52.789754 [info ] [MainThread]: 
[0m18:09:52.790061 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:09:52.790355 [info ] [MainThread]: 
[0m18:09:52.790818 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:09:52.793731 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JAFFLE_SHOP_ANALYTICS'
[0m18:09:52.836525 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP_ANALYTICS"
[0m18:09:52.836980 [debug] [ThreadPool]: On list_JAFFLE_SHOP_ANALYTICS: show objects in JAFFLE_SHOP.ANALYTICS
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_JAFFLE_SHOP_ANALYTICS"} */;
[0m18:09:52.837209 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:09:57.269662 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 4.432 seconds
[0m18:09:57.278786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2956aa10-38f1-4ade-984a-4eadb0c042a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff702a7020>]}
[0m18:09:57.280303 [info ] [MainThread]: Pulling freshness from warehouse metadata tables for 0 sources
[0m18:09:57.290479 [debug] [Thread-1 (]: Began running node source.jaffle_shop.jaffle_shop.raw_orders
[0m18:09:57.291858 [info ] [Thread-1 (]: 1 of 1 START freshness of jaffle_shop.raw_orders ............................... [RUN]
[0m18:09:57.292878 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_JAFFLE_SHOP_ANALYTICS, now source.jaffle_shop.jaffle_shop.raw_orders)
[0m18:09:57.293603 [debug] [Thread-1 (]: Began compiling node source.jaffle_shop.jaffle_shop.raw_orders
[0m18:09:57.294273 [debug] [Thread-1 (]: Began executing node source.jaffle_shop.jaffle_shop.raw_orders
[0m18:09:57.305623 [debug] [Thread-1 (]: Using snowflake connection "source.jaffle_shop.jaffle_shop.raw_orders"
[0m18:09:57.306143 [debug] [Thread-1 (]: On source.jaffle_shop.jaffle_shop.raw_orders: select
      max(loaded_at_field) as max_loaded_at,
      convert_timezone('UTC', current_timestamp()) as snapshotted_at
    from JAFFLE_SHOP.RAW.raw_orders
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "source.jaffle_shop.jaffle_shop.raw_orders"} */
[0m18:09:57.541837 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bfd761-0305-55b1-0004-0c260004958e
[0m18:09:57.542536 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 2 at position 10
invalid identifier 'LOADED_AT_FIELD'
[0m18:09:57.543134 [debug] [Thread-1 (]: Snowflake adapter: Error running SQL: macro collect_freshness
[0m18:09:57.543551 [debug] [Thread-1 (]: Snowflake adapter: Rolling back transaction.
[0m18:09:57.547976 [debug] [Thread-1 (]: Database Error in source raw_orders (models/staging/_src_jaffle_shop.yml)
  000904 (42000): SQL compilation error: error line 2 at position 10
  invalid identifier 'LOADED_AT_FIELD'
[0m18:09:57.548672 [error] [Thread-1 (]: 1 of 1 ERROR freshness of jaffle_shop.raw_orders ............................... [[31mERROR[0m in 0.26s]
[0m18:09:57.549451 [debug] [Thread-1 (]: Finished running node source.jaffle_shop.jaffle_shop.raw_orders
[0m18:09:57.551663 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:09:57.552145 [debug] [MainThread]: Connection 'source.jaffle_shop.jaffle_shop.raw_orders' was left open.
[0m18:09:57.552538 [debug] [MainThread]: On source.jaffle_shop.jaffle_shop.raw_orders: Close
[0m18:09:57.744594 [info ] [MainThread]: 
[0m18:09:57.745609 [info ] [MainThread]: Finished running 1 source in 0 hours 0 minutes and 4.95 seconds (4.95s).
[0m18:09:57.770526 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m18:09:57.772908 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m18:09:57.776106 [debug] [MainThread]: Wrote artifact FreshnessResult to /opt/airflow/dbt/target/sources.json
[0m18:09:57.776438 [info ] [MainThread]: 
[0m18:09:57.776805 [error] [MainThread]:   Database Error in source raw_orders (models/staging/_src_jaffle_shop.yml)
  000904 (42000): SQL compilation error: error line 2 at position 10
  invalid identifier 'LOADED_AT_FIELD'
[0m18:09:57.777074 [info ] [MainThread]: Done.
[0m18:09:57.778777 [debug] [MainThread]: Resource report: {"command_name": "freshness", "command_success": false, "command_wall_clock_time": 7.902339, "process_in_blocks": "46136", "process_kernel_time": 1.399524, "process_mem_max_rss": "239928", "process_out_blocks": "28441", "process_user_time": 4.574054}
[0m18:09:57.779317 [debug] [MainThread]: Command `dbt source freshness` failed at 18:09:57.779228 after 7.90 seconds
[0m18:09:57.779787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff702c1b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff702c0830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c1f22d0>]}
[0m18:09:57.780098 [debug] [MainThread]: Flushing usage events
[0m18:09:58.655527 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:05:44.853278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb778e930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbaff6b70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb736f170>]}


============================== 19:05:44.858734 | c4a23f96-7ffe-4d9b-a05d-d49128211d91 ==============================
[0m19:05:44.858734 [info ] [MainThread]: Running with dbt=1.10.13
[0m19:05:44.859137 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '/opt/airflow/dbt', 'indirect_selection': 'eager', 'printer_width': '80', 'cache_selected_only': 'False', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'empty': 'None', 'target_path': 'None', 'fail_fast': 'False', 'warn_error': 'None', 'invocation_command': 'dbt source freshness', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'log_cache_events': 'False', 'log_format': 'default', 'use_colors': 'True', 'version_check': 'True', 'use_experimental_parser': 'False', 'static_parser': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'introspect': 'True'}
[0m19:05:45.522707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c4a23f96-7ffe-4d9b-a05d-d49128211d91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9af1ac00>]}
[0m19:05:45.558147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c4a23f96-7ffe-4d9b-a05d-d49128211d91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d19eae0>]}
[0m19:05:45.558830 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m19:05:45.623175 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m19:05:45.696616 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:05:45.697070 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:05:45.700784 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.jaffle_shop.examples
- models.jaffle_shop.analytics
[0m19:05:45.717887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c4a23f96-7ffe-4d9b-a05d-d49128211d91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9aaa9a00>]}
[0m19:05:45.762720 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m19:05:45.764847 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m19:05:45.779723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c4a23f96-7ffe-4d9b-a05d-d49128211d91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a6009e0>]}
[0m19:05:45.780102 [info ] [MainThread]: Found 3 models, 6 sources, 493 macros
[0m19:05:45.780368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c4a23f96-7ffe-4d9b-a05d-d49128211d91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6cade80>]}
[0m19:05:45.781503 [info ] [MainThread]: 
[0m19:05:45.781858 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:05:45.782073 [info ] [MainThread]: 
[0m19:05:45.782408 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:05:45.785150 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JAFFLE_SHOP_ANALYTICS'
[0m19:05:45.839406 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP_ANALYTICS"
[0m19:05:45.839971 [debug] [ThreadPool]: On list_JAFFLE_SHOP_ANALYTICS: show objects in JAFFLE_SHOP.ANALYTICS
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_JAFFLE_SHOP_ANALYTICS"} */;
[0m19:05:45.840235 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:05:49.280279 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 3.439 seconds
[0m19:05:49.288037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c4a23f96-7ffe-4d9b-a05d-d49128211d91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb66175f0>]}
[0m19:05:49.289668 [info ] [MainThread]: Pulling freshness from warehouse metadata tables for 0 sources
[0m19:05:49.298989 [debug] [Thread-1 (]: Began running node source.jaffle_shop.jaffle_shop.raw_orders
[0m19:05:49.299881 [info ] [Thread-1 (]: 1 of 1 START freshness of jaffle_shop.raw_orders ............................... [RUN]
[0m19:05:49.300902 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_JAFFLE_SHOP_ANALYTICS, now source.jaffle_shop.jaffle_shop.raw_orders)
[0m19:05:49.301602 [debug] [Thread-1 (]: Began compiling node source.jaffle_shop.jaffle_shop.raw_orders
[0m19:05:49.302245 [debug] [Thread-1 (]: Began executing node source.jaffle_shop.jaffle_shop.raw_orders
[0m19:05:49.312907 [debug] [Thread-1 (]: Using snowflake connection "source.jaffle_shop.jaffle_shop.raw_orders"
[0m19:05:49.313504 [debug] [Thread-1 (]: On source.jaffle_shop.jaffle_shop.raw_orders: select
      max(loaded_at_field) as max_loaded_at,
      convert_timezone('UTC', current_timestamp()) as snapshotted_at
    from JAFFLE_SHOP.RAW.raw_orders
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "source.jaffle_shop.jaffle_shop.raw_orders"} */
[0m19:05:49.649219 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bfd799-0305-511b-0004-0c260004a68e
[0m19:05:49.650328 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 2 at position 10
invalid identifier 'LOADED_AT_FIELD'
[0m19:05:49.651437 [debug] [Thread-1 (]: Snowflake adapter: Error running SQL: macro collect_freshness
[0m19:05:49.652298 [debug] [Thread-1 (]: Snowflake adapter: Rolling back transaction.
[0m19:05:49.659454 [debug] [Thread-1 (]: Database Error in source raw_orders (models/staging/_src_jaffle_shop.yml)
  000904 (42000): SQL compilation error: error line 2 at position 10
  invalid identifier 'LOADED_AT_FIELD'
[0m19:05:49.660662 [error] [Thread-1 (]: 1 of 1 ERROR freshness of jaffle_shop.raw_orders ............................... [[31mERROR[0m in 0.36s]
[0m19:05:49.661844 [debug] [Thread-1 (]: Finished running node source.jaffle_shop.jaffle_shop.raw_orders
[0m19:05:49.664488 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:05:49.665120 [debug] [MainThread]: Connection 'source.jaffle_shop.jaffle_shop.raw_orders' was left open.
[0m19:05:49.665683 [debug] [MainThread]: On source.jaffle_shop.jaffle_shop.raw_orders: Close
[0m19:05:49.845898 [info ] [MainThread]: 
[0m19:05:49.847908 [info ] [MainThread]: Finished running 1 source in 0 hours 0 minutes and 4.06 seconds (4.06s).
[0m19:05:49.957666 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m19:05:49.959154 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m19:05:49.961235 [debug] [MainThread]: Wrote artifact FreshnessResult to /opt/airflow/dbt/target/sources.json
[0m19:05:49.961466 [info ] [MainThread]: 
[0m19:05:49.961745 [error] [MainThread]:   Database Error in source raw_orders (models/staging/_src_jaffle_shop.yml)
  000904 (42000): SQL compilation error: error line 2 at position 10
  invalid identifier 'LOADED_AT_FIELD'
[0m19:05:49.962043 [info ] [MainThread]: Done.
[0m19:05:49.962977 [debug] [MainThread]: Resource report: {"command_name": "freshness", "command_success": false, "command_wall_clock_time": 5.1407304, "process_in_blocks": "0", "process_kernel_time": 0.57989, "process_mem_max_rss": "230492", "process_out_blocks": "2057", "process_user_time": 2.955114}
[0m19:05:49.963304 [debug] [MainThread]: Command `dbt source freshness` failed at 19:05:49.963254 after 5.14 seconds
[0m19:05:49.963548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6798f20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbb058d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a8cab70>]}
[0m19:05:49.963773 [debug] [MainThread]: Flushing usage events
[0m19:05:51.152757 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:26:10.255085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff867448f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86706930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86705010>]}


============================== 19:26:10.264467 | 562cef60-efba-4898-b625-b151f0b79591 ==============================
[0m19:26:10.264467 [info ] [MainThread]: Running with dbt=1.10.13
[0m19:26:10.265927 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'cache_selected_only': 'False', 'target_path': 'None', 'version_check': 'True', 'log_format': 'default', 'introspect': 'True', 'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'static_parser': 'True', 'warn_error': 'None', 'no_print': 'None', 'profiles_dir': '.', 'write_json': 'True', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'invocation_command': 'dbt deps --profiles-dir . --target dev', 'log_path': '/opt/airflow/dbt/logs', 'partial_parse': 'True', 'empty': 'None', 'quiet': 'False', 'indirect_selection': 'eager', 'fail_fast': 'False'}
[0m19:26:10.370379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '562cef60-efba-4898-b625-b151f0b79591', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85829610>]}
[0m19:26:10.394959 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m19:26:10.397383 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m19:26:10.400081 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.20391083, "process_in_blocks": "42248", "process_kernel_time": 0.441575, "process_mem_max_rss": "102132", "process_out_blocks": "3227", "process_user_time": 2.040738}
[0m19:26:10.400513 [debug] [MainThread]: Command `dbt deps` succeeded at 19:26:10.400444 after 0.20 seconds
[0m19:26:10.400758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff856846e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff861186b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86000500>]}
[0m19:26:10.401187 [debug] [MainThread]: Flushing usage events
[0m19:26:11.453379 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:26:14.155133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8bfd1c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e429d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8bf99640>]}


============================== 19:26:14.168390 | 9ab47663-f5dd-4c36-89da-00e6730b30de ==============================
[0m19:26:14.168390 [info ] [MainThread]: Running with dbt=1.10.13
[0m19:26:14.171375 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run --profiles-dir . --target dev', 'write_json': 'True', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': '/opt/airflow/dbt/logs', 'use_colors': 'True', 'static_parser': 'True', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'profiles_dir': '.', 'log_format': 'default', 'cache_selected_only': 'False', 'partial_parse': 'True', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'printer_width': '80', 'debug': 'False', 'quiet': 'False', 'empty': 'False', 'indirect_selection': 'eager', 'warn_error': 'None', 'introspect': 'True', 'no_print': 'None'}
[0m19:26:15.150183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9ab47663-f5dd-4c36-89da-00e6730b30de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e0c6480>]}
[0m19:26:15.273010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9ab47663-f5dd-4c36-89da-00e6730b30de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a458f50>]}
[0m19:26:15.274646 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m19:26:15.407837 [debug] [MainThread]: checksum: 87546e06832e1286bf2d49b8b108dd3f58da97cbfca650a1f147ec4aedfbbf25, vars: {}, profile: , target: dev, version: 1.10.13
[0m19:26:15.613962 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m19:26:15.615068 [debug] [MainThread]: previous checksum: 87546e06832e1286bf2d49b8b108dd3f58da97cbfca650a1f147ec4aedfbbf25, current checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe
[0m19:26:15.615431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '9ab47663-f5dd-4c36-89da-00e6730b30de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89da63c0>]}
[0m19:26:16.972912 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.jaffle_shop.examples
- models.jaffle_shop.analytics
[0m19:26:16.986479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9ab47663-f5dd-4c36-89da-00e6730b30de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89cbae40>]}
[0m19:26:17.117012 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m19:26:17.126160 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m19:26:17.171912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9ab47663-f5dd-4c36-89da-00e6730b30de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff895b7cb0>]}
[0m19:26:17.172734 [info ] [MainThread]: Found 3 models, 6 sources, 493 macros
[0m19:26:17.174045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9ab47663-f5dd-4c36-89da-00e6730b30de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89d0d340>]}
[0m19:26:17.175998 [info ] [MainThread]: 
[0m19:26:17.176684 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:26:17.177078 [info ] [MainThread]: 
[0m19:26:17.177815 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:26:17.185278 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JAFFLE_SHOP'
[0m19:26:17.367354 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP"
[0m19:26:17.368663 [debug] [ThreadPool]: On list_JAFFLE_SHOP: show terse schemas in database JAFFLE_SHOP
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_JAFFLE_SHOP"} */
[0m19:26:17.370387 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:26:22.844967 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 5.472 seconds
[0m19:26:22.858215 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_JAFFLE_SHOP, now list_JAFFLE_SHOP_ANALYTICS)
[0m19:26:22.878353 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP_ANALYTICS"
[0m19:26:22.878977 [debug] [ThreadPool]: On list_JAFFLE_SHOP_ANALYTICS: show objects in JAFFLE_SHOP.ANALYTICS
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_JAFFLE_SHOP_ANALYTICS"} */;
[0m19:26:23.100912 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.221 seconds
[0m19:26:23.108057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9ab47663-f5dd-4c36-89da-00e6730b30de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89571970>]}
[0m19:26:23.147402 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_customers
[0m19:26:23.148184 [info ] [Thread-1 (]: 1 of 3 START sql view model ANALYTICS.stg_customers ............................ [RUN]
[0m19:26:23.147836 [debug] [Thread-2 (]: Began running node model.jaffle_shop.stg_orders
[0m19:26:23.149928 [info ] [Thread-2 (]: 2 of 3 START sql view model ANALYTICS.stg_orders ............................... [RUN]
[0m19:26:23.151150 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.jaffle_shop.stg_orders'
[0m19:26:23.152065 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.stg_orders
[0m19:26:23.149030 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_JAFFLE_SHOP_ANALYTICS, now model.jaffle_shop.stg_customers)
[0m19:26:23.163876 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_customers
[0m19:26:23.163581 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.stg_orders"
[0m19:26:23.168518 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_customers"
[0m19:26:23.177823 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_customers
[0m19:26:23.178196 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.stg_orders
[0m19:26:23.250003 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_customers"
[0m19:26:23.254529 [debug] [Thread-2 (]: Writing runtime sql for node "model.jaffle_shop.stg_orders"
[0m19:26:23.262419 [debug] [Thread-2 (]: Using snowflake connection "model.jaffle_shop.stg_orders"
[0m19:26:23.263784 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: create or replace   view JAFFLE_SHOP.ANALYTICS.stg_orders
  
  
  
  
  as (
    SELECT
        id
        ,customer as customer_id
        ,ordered_at
        ,store_id
        ,subtotal
        ,tax_paid
        ,order_total
    FROM JAFFLE_SHOP.RAW.raw_orders
  )
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */;
[0m19:26:23.269651 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m19:26:23.264863 [debug] [Thread-1 (]: Using snowflake connection "model.jaffle_shop.stg_customers"
[0m19:26:23.277667 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: create or replace   view JAFFLE_SHOP.ANALYTICS.stg_customers
  
  
  
  
  as (
    SELECT
    id
    ,split_part(name,' ',1) as first_name
    ,split_part(name,' ',2) as last_name
FROM JAFFLE_SHOP.RAW.raw_customers
  )
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */;
[0m19:26:23.749522 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.470 seconds
[0m19:26:23.806132 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ab47663-f5dd-4c36-89da-00e6730b30de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e0c5700>]}
[0m19:26:23.807755 [info ] [Thread-1 (]: 1 of 3 OK created sql view model ANALYTICS.stg_customers ....................... [[32mSUCCESS 1[0m in 0.66s]
[0m19:26:23.809079 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_customers
[0m19:26:24.365673 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.096 seconds
[0m19:26:24.372262 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ab47663-f5dd-4c36-89da-00e6730b30de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89cb94c0>]}
[0m19:26:24.376677 [info ] [Thread-2 (]: 2 of 3 OK created sql view model ANALYTICS.stg_orders .......................... [[32mSUCCESS 1[0m in 1.22s]
[0m19:26:24.379539 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.stg_orders
[0m19:26:24.383504 [debug] [Thread-4 (]: Began running node model.jaffle_shop.dim_customers
[0m19:26:24.385967 [info ] [Thread-4 (]: 3 of 3 START sql table model ANALYTICS.dim_customers ........................... [RUN]
[0m19:26:24.387785 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.jaffle_shop.dim_customers'
[0m19:26:24.390517 [debug] [Thread-4 (]: Began compiling node model.jaffle_shop.dim_customers
[0m19:26:24.411265 [debug] [Thread-4 (]: Writing injected SQL for node "model.jaffle_shop.dim_customers"
[0m19:26:24.417172 [debug] [Thread-4 (]: Began executing node model.jaffle_shop.dim_customers
[0m19:26:24.457130 [debug] [Thread-4 (]: Writing runtime sql for node "model.jaffle_shop.dim_customers"
[0m19:26:24.468369 [debug] [Thread-4 (]: Using snowflake connection "model.jaffle_shop.dim_customers"
[0m19:26:24.469585 [debug] [Thread-4 (]: On model.jaffle_shop.dim_customers: create or replace transient table JAFFLE_SHOP.ANALYTICS.dim_customers
    
    
    
    as (with customer_orders as (

    select
        customer_id,
        min(ordered_at) as first_order_date,
        max(ordered_at) as most_recent_order_date,
        sum(order_total) as lifetime_value, 
        count(id) as number_of_orders
    from JAFFLE_SHOP.ANALYTICS.stg_orders
    group by 1

),
customers as (

    select
        c.id,
        c.first_name,
        c.last_name,
        co.first_order_date,
        co.most_recent_order_date,
        coalesce(co.lifetime_value,0) as lifetime_value,
        coalesce(co.number_of_orders, 0) as number_of_orders
    from JAFFLE_SHOP.ANALYTICS.stg_customers as c
    left join customer_orders as co on co.customer_id = c.id 

)

select * from customers
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */;
[0m19:26:24.470473 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m19:26:26.613211 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 2.138 seconds
[0m19:26:26.640899 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ab47663-f5dd-4c36-89da-00e6730b30de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff899248c0>]}
[0m19:26:26.650275 [info ] [Thread-4 (]: 3 of 3 OK created sql table model ANALYTICS.dim_customers ...................... [[32mSUCCESS 1[0m in 2.25s]
[0m19:26:26.653877 [debug] [Thread-4 (]: Finished running node model.jaffle_shop.dim_customers
[0m19:26:26.686026 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:26:26.688832 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_customers' was left open.
[0m19:26:26.708672 [debug] [MainThread]: On model.jaffle_shop.stg_customers: Close
[0m19:26:27.121092 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_orders' was left open.
[0m19:26:27.122660 [debug] [MainThread]: On model.jaffle_shop.stg_orders: Close
[0m19:26:27.418489 [debug] [MainThread]: Connection 'model.jaffle_shop.dim_customers' was left open.
[0m19:26:27.423957 [debug] [MainThread]: On model.jaffle_shop.dim_customers: Close
[0m19:26:27.666046 [info ] [MainThread]: 
[0m19:26:27.668583 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 10.49 seconds (10.49s).
[0m19:26:27.670705 [debug] [MainThread]: Command end result
[0m19:26:27.793446 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m19:26:27.808185 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m19:26:27.831675 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/target/run_results.json
[0m19:26:27.832862 [info ] [MainThread]: 
[0m19:26:27.833874 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:26:27.834963 [info ] [MainThread]: 
[0m19:26:27.836176 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m19:26:27.851260 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 13.77385, "process_in_blocks": "16376", "process_kernel_time": 1.352276, "process_mem_max_rss": "161772", "process_out_blocks": "5752", "process_user_time": 6.089539}
[0m19:26:27.853900 [debug] [MainThread]: Command `dbt run` succeeded at 19:26:27.853658 after 13.78 seconds
[0m19:26:27.855149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8bf20b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8bfd1c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89d4efc0>]}
[0m19:26:27.855973 [debug] [MainThread]: Flushing usage events
[0m19:26:28.672044 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:26:31.933648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90b6a840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90af3ce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90b46e10>]}


============================== 19:26:31.941326 | f7ef8ee3-a69d-4625-8902-46fefabce420 ==============================
[0m19:26:31.941326 [info ] [MainThread]: Running with dbt=1.10.13
[0m19:26:31.942672 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'printer_width': '80', 'warn_error': 'None', 'version_check': 'True', 'write_json': 'True', 'empty': 'None', 'fail_fast': 'False', 'invocation_command': 'dbt docs generate --profiles-dir . --target dev', 'log_format': 'default', 'use_experimental_parser': 'False', 'quiet': 'False', 'introspect': 'True', 'no_print': 'None', 'use_colors': 'True', 'static_parser': 'True', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '.', 'cache_selected_only': 'False', 'partial_parse': 'True', 'debug': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:26:32.474382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f7ef8ee3-a69d-4625-8902-46fefabce420', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ee2f710>]}
[0m19:26:32.546430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f7ef8ee3-a69d-4625-8902-46fefabce420', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91130aa0>]}
[0m19:26:32.549532 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m19:26:32.638981 [debug] [MainThread]: checksum: 87546e06832e1286bf2d49b8b108dd3f58da97cbfca650a1f147ec4aedfbbf25, vars: {}, profile: , target: dev, version: 1.10.13
[0m19:26:32.892982 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:26:32.894599 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:26:32.898150 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.jaffle_shop.examples
- models.jaffle_shop.analytics
[0m19:26:32.993710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f7ef8ee3-a69d-4625-8902-46fefabce420', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ed33d40>]}
[0m19:26:33.015917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f7ef8ee3-a69d-4625-8902-46fefabce420', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e85a930>]}
[0m19:26:33.016870 [info ] [MainThread]: Found 3 models, 6 sources, 493 macros
[0m19:26:33.017649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f7ef8ee3-a69d-4625-8902-46fefabce420', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ea7cdd0>]}
[0m19:26:33.021906 [info ] [MainThread]: 
[0m19:26:33.023328 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:26:33.025742 [info ] [MainThread]: 
[0m19:26:33.031517 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:26:33.039505 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JAFFLE_SHOP_ANALYTICS'
[0m19:26:33.105237 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP_ANALYTICS"
[0m19:26:33.106336 [debug] [ThreadPool]: On list_JAFFLE_SHOP_ANALYTICS: show objects in JAFFLE_SHOP.ANALYTICS
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_JAFFLE_SHOP_ANALYTICS"} */;
[0m19:26:33.107574 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:26:34.209179 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.099 seconds
[0m19:26:34.227847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f7ef8ee3-a69d-4625-8902-46fefabce420', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92cf9190>]}
[0m19:26:34.235121 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_customers
[0m19:26:34.237387 [debug] [Thread-2 (]: Began running node model.jaffle_shop.stg_orders
[0m19:26:34.239087 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_JAFFLE_SHOP_ANALYTICS, now model.jaffle_shop.stg_customers)
[0m19:26:34.241925 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.jaffle_shop.stg_orders'
[0m19:26:34.244197 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_customers
[0m19:26:34.245710 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.stg_orders
[0m19:26:34.265768 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.stg_orders"
[0m19:26:34.268658 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_customers"
[0m19:26:34.280732 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.stg_orders
[0m19:26:34.282128 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_customers
[0m19:26:34.287125 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_customers
[0m19:26:34.284609 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.stg_orders
[0m19:26:34.292768 [debug] [Thread-4 (]: Began running node model.jaffle_shop.dim_customers
[0m19:26:34.294374 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.jaffle_shop.dim_customers'
[0m19:26:34.295705 [debug] [Thread-4 (]: Began compiling node model.jaffle_shop.dim_customers
[0m19:26:34.314966 [debug] [Thread-4 (]: Writing injected SQL for node "model.jaffle_shop.dim_customers"
[0m19:26:34.326444 [debug] [Thread-4 (]: Began executing node model.jaffle_shop.dim_customers
[0m19:26:34.329335 [debug] [Thread-4 (]: Finished running node model.jaffle_shop.dim_customers
[0m19:26:34.334848 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:26:34.336100 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_customers' was left open.
[0m19:26:34.338953 [debug] [MainThread]: On model.jaffle_shop.stg_customers: Close
[0m19:26:34.662780 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_orders' was properly closed.
[0m19:26:34.664628 [debug] [MainThread]: Connection 'model.jaffle_shop.dim_customers' was properly closed.
[0m19:26:34.667129 [debug] [MainThread]: Command end result
[0m19:26:34.806856 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m19:26:34.813131 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m19:26:34.832444 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/target/run_results.json
[0m19:26:34.873113 [debug] [MainThread]: Acquiring new snowflake connection 'generate_catalog'
[0m19:26:34.873844 [info ] [MainThread]: Building catalog
[0m19:26:34.911335 [debug] [ThreadPool]: Acquiring new snowflake connection 'JAFFLE_SHOP.information_schema'
[0m19:26:34.941319 [debug] [ThreadPool]: Using snowflake connection "JAFFLE_SHOP.information_schema"
[0m19:26:34.942564 [debug] [ThreadPool]: On JAFFLE_SHOP.information_schema: with tables as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",
        case
            when is_dynamic = 'YES' and table_type = 'BASE TABLE' THEN 'DYNAMIC TABLE'
            else table_type
        end as "table_type",
        comment as "table_comment",

        -- note: this is the _role_ that owns the table
        table_owner as "table_owner",

        'Clustering Key' as "stats:clustering_key:label",
        clustering_key as "stats:clustering_key:value",
        'The key used to cluster this table' as "stats:clustering_key:description",
        (clustering_key is not null) as "stats:clustering_key:include",

        'Row Count' as "stats:row_count:label",
        row_count as "stats:row_count:value",
        'An approximate count of rows in this table' as "stats:row_count:description",
        (row_count is not null) as "stats:row_count:include",

        'Approximate Size' as "stats:bytes:label",
        bytes as "stats:bytes:value",
        'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
        (bytes is not null) as "stats:bytes:include",

        'Last Modified' as "stats:last_modified:label",
        to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
        'The timestamp for last update/change' as "stats:last_modified:description",
        (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"
    from JAFFLE_SHOP.INFORMATION_SCHEMA.tables
            where (
                (
                    
    "table_schema" ilike 'ANALYTICS' and upper("table_schema") = upper('ANALYTICS')

                    and 
    "table_name" ilike 'dim_customers' and upper("table_name") = upper('dim_customers')

                )
             or 
                (
                    
    "table_schema" ilike 'RAW' and upper("table_schema") = upper('RAW')

                    and 
    "table_name" ilike 'raw_customers' and upper("table_name") = upper('raw_customers')

                )
             or 
                (
                    
    "table_schema" ilike 'ANALYTICS' and upper("table_schema") = upper('ANALYTICS')

                    and 
    "table_name" ilike 'stg_customers' and upper("table_name") = upper('stg_customers')

                )
             or 
                (
                    
    "table_schema" ilike 'ANALYTICS' and upper("table_schema") = upper('ANALYTICS')

                    and 
    "table_name" ilike 'stg_orders' and upper("table_name") = upper('stg_orders')

                )
             or 
                (
                    
    "table_schema" ilike 'RAW' and upper("table_schema") = upper('RAW')

                    and 
    "table_name" ilike 'raw_items' and upper("table_name") = upper('raw_items')

                )
             or 
                (
                    
    "table_schema" ilike 'RAW' and upper("table_schema") = upper('RAW')

                    and 
    "table_name" ilike 'raw_orders' and upper("table_name") = upper('raw_orders')

                )
             or 
                (
                    
    "table_schema" ilike 'RAW' and upper("table_schema") = upper('RAW')

                    and 
    "table_name" ilike 'raw_products' and upper("table_name") = upper('raw_products')

                )
             or 
                (
                    
    "table_schema" ilike 'RAW' and upper("table_schema") = upper('RAW')

                    and 
    "table_name" ilike 'raw_stores' and upper("table_name") = upper('raw_stores')

                )
             or 
                (
                    
    "table_schema" ilike 'RAW' and upper("table_schema") = upper('RAW')

                    and 
    "table_name" ilike 'raw_supplies' and upper("table_name") = upper('raw_supplies')

                )
            )
        ),
        columns as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",

        column_name as "column_name",
        ordinal_position as "column_index",
        data_type as "column_type",
        comment as "column_comment"
    from JAFFLE_SHOP.INFORMATION_SCHEMA.columns
            where (
                (
                    
    "table_schema" ilike 'ANALYTICS' and upper("table_schema") = upper('ANALYTICS')

                    and 
    "table_name" ilike 'dim_customers' and upper("table_name") = upper('dim_customers')

                )
             or 
                (
                    
    "table_schema" ilike 'RAW' and upper("table_schema") = upper('RAW')

                    and 
    "table_name" ilike 'raw_customers' and upper("table_name") = upper('raw_customers')

                )
             or 
                (
                    
    "table_schema" ilike 'ANALYTICS' and upper("table_schema") = upper('ANALYTICS')

                    and 
    "table_name" ilike 'stg_customers' and upper("table_name") = upper('stg_customers')

                )
             or 
                (
                    
    "table_schema" ilike 'ANALYTICS' and upper("table_schema") = upper('ANALYTICS')

                    and 
    "table_name" ilike 'stg_orders' and upper("table_name") = upper('stg_orders')

                )
             or 
                (
                    
    "table_schema" ilike 'RAW' and upper("table_schema") = upper('RAW')

                    and 
    "table_name" ilike 'raw_items' and upper("table_name") = upper('raw_items')

                )
             or 
                (
                    
    "table_schema" ilike 'RAW' and upper("table_schema") = upper('RAW')

                    and 
    "table_name" ilike 'raw_orders' and upper("table_name") = upper('raw_orders')

                )
             or 
                (
                    
    "table_schema" ilike 'RAW' and upper("table_schema") = upper('RAW')

                    and 
    "table_name" ilike 'raw_products' and upper("table_name") = upper('raw_products')

                )
             or 
                (
                    
    "table_schema" ilike 'RAW' and upper("table_schema") = upper('RAW')

                    and 
    "table_name" ilike 'raw_stores' and upper("table_name") = upper('raw_stores')

                )
             or 
                (
                    
    "table_schema" ilike 'RAW' and upper("table_schema") = upper('RAW')

                    and 
    "table_name" ilike 'raw_supplies' and upper("table_name") = upper('raw_supplies')

                )
            )
        )
        select *
    from tables
    join columns using ("table_database", "table_schema", "table_name")
    order by "column_index"
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "JAFFLE_SHOP.information_schema"} */
[0m19:26:34.943834 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:26:39.879279 [debug] [ThreadPool]: SQL status: SUCCESS 43 in 4.934 seconds
[0m19:26:39.951541 [debug] [MainThread]: Wrote artifact CatalogArtifact to /opt/airflow/dbt/target/catalog.json
[0m19:26:40.024526 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m19:26:40.029174 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m19:26:40.029902 [info ] [MainThread]: Catalog written to /opt/airflow/dbt/target/catalog.json
[0m19:26:40.033260 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 8.167858, "process_in_blocks": "2080", "process_kernel_time": 0.618946, "process_mem_max_rss": "153108", "process_out_blocks": "5445", "process_user_time": 3.384427}
[0m19:26:40.035546 [debug] [MainThread]: Command `dbt docs generate` succeeded at 19:26:40.035021 after 8.17 seconds
[0m19:26:40.036552 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m19:26:40.037820 [debug] [MainThread]: Connection 'JAFFLE_SHOP.information_schema' was left open.
[0m19:26:40.038912 [debug] [MainThread]: On JAFFLE_SHOP.information_schema: Close
[0m19:26:40.473259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90ba27e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90ba2870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ea7c590>]}
[0m19:26:40.476922 [debug] [MainThread]: Flushing usage events
[0m19:26:41.181835 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:26:44.388016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d8233b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ec87050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d822fc0>]}


============================== 19:26:44.396675 | c747fcf3-c931-4850-9587-f12bfb0d26a6 ==============================
[0m19:26:44.396675 [info ] [MainThread]: Running with dbt=1.10.13
[0m19:26:44.397898 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'fail_fast': 'False', 'write_json': 'True', 'profiles_dir': '.', 'partial_parse': 'True', 'log_format': 'default', 'static_parser': 'True', 'indirect_selection': 'eager', 'version_check': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': '/opt/airflow/dbt/logs', 'invocation_command': 'dbt docs serve --profiles-dir . --target dev --port 5050 --host 0.0.0.0', 'quiet': 'False', 'log_cache_events': 'False', 'printer_width': '80', 'no_print': 'None', 'use_colors': 'True', 'debug': 'False', 'empty': 'None', 'introspect': 'True', 'cache_selected_only': 'False'}
[0m19:26:44.896721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c747fcf3-c931-4850-9587-f12bfb0d26a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f1ee900>]}
[0m19:26:44.944353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c747fcf3-c931-4850-9587-f12bfb0d26a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f7947d0>]}
[0m11:18:31.999864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa049ec30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1770ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0979970>]}


============================== 11:18:32.012704 | 925d63d8-8814-4df8-80a0-4c51691c287e ==============================
[0m11:18:32.012704 [info ] [MainThread]: Running with dbt=1.10.13
[0m11:18:32.013514 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'version_check': 'True', 'debug': 'False', 'quiet': 'False', 'use_colors': 'True', 'printer_width': '80', 'introspect': 'True', 'cache_selected_only': 'False', 'log_path': '/opt/airflow/dbt/logs', 'static_parser': 'True', 'target_path': 'None', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'warn_error': 'None', 'partial_parse': 'True', 'invocation_command': 'dbt source freshness --profiles-dir /opt/airflow/dbt --target dev', 'write_json': 'True', 'log_format': 'default', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'profiles_dir': '/opt/airflow/dbt', 'empty': 'None', 'send_anonymous_usage_stats': 'True', 'no_print': 'None'}
[0m11:18:34.145800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '925d63d8-8814-4df8-80a0-4c51691c287e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2cce9f0>]}
[0m11:18:34.183224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '925d63d8-8814-4df8-80a0-4c51691c287e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff849c6960>]}
[0m11:18:34.184196 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m11:18:34.285083 [debug] [MainThread]: checksum: 87546e06832e1286bf2d49b8b108dd3f58da97cbfca650a1f147ec4aedfbbf25, vars: {}, profile: , target: dev, version: 1.10.13
[0m11:18:34.375574 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:18:34.375941 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:18:34.379135 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.jaffle_shop.examples
- models.jaffle_shop.analytics
[0m11:18:34.395951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '925d63d8-8814-4df8-80a0-4c51691c287e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff847517c0>]}
[0m11:18:34.439544 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m11:18:34.441425 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m11:18:34.493778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '925d63d8-8814-4df8-80a0-4c51691c287e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84552b40>]}
[0m11:18:34.494192 [info ] [MainThread]: Found 3 models, 6 sources, 493 macros
[0m11:18:34.494662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '925d63d8-8814-4df8-80a0-4c51691c287e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff842cb860>]}
[0m11:18:34.495853 [info ] [MainThread]: 
[0m11:18:34.496159 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:18:34.496588 [info ] [MainThread]: 
[0m11:18:34.497113 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:18:34.499958 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JAFFLE_SHOP_ANALYTICS'
[0m11:18:34.561025 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP_ANALYTICS"
[0m11:18:34.561526 [debug] [ThreadPool]: On list_JAFFLE_SHOP_ANALYTICS: show objects in JAFFLE_SHOP.ANALYTICS
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_JAFFLE_SHOP_ANALYTICS"} */;
[0m11:18:34.561880 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:18:38.386315 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 3.826 seconds
[0m11:18:38.393412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '925d63d8-8814-4df8-80a0-4c51691c287e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff945228d0>]}
[0m11:18:38.394712 [info ] [MainThread]: Pulling freshness from warehouse metadata tables for 0 sources
[0m11:18:38.404935 [debug] [Thread-1 (]: Began running node source.jaffle_shop.jaffle_shop.raw_orders
[0m11:18:38.405549 [info ] [Thread-1 (]: 1 of 1 START freshness of jaffle_shop.raw_orders ............................... [RUN]
[0m11:18:38.406563 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_JAFFLE_SHOP_ANALYTICS, now source.jaffle_shop.jaffle_shop.raw_orders)
[0m11:18:38.407000 [debug] [Thread-1 (]: Began compiling node source.jaffle_shop.jaffle_shop.raw_orders
[0m11:18:38.407358 [debug] [Thread-1 (]: Began executing node source.jaffle_shop.jaffle_shop.raw_orders
[0m11:18:38.414030 [debug] [Thread-1 (]: Using snowflake connection "source.jaffle_shop.jaffle_shop.raw_orders"
[0m11:18:38.414561 [debug] [Thread-1 (]: On source.jaffle_shop.jaffle_shop.raw_orders: select
      max(loaded_at_field) as max_loaded_at,
      convert_timezone('UTC', current_timestamp()) as snapshotted_at
    from JAFFLE_SHOP.RAW.raw_orders
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "source.jaffle_shop.jaffle_shop.raw_orders"} */
[0m11:18:38.648864 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bfdb66-0305-57db-0004-0c260004b01e
[0m11:18:38.649360 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 2 at position 10
invalid identifier 'LOADED_AT_FIELD'
[0m11:18:38.649767 [debug] [Thread-1 (]: Snowflake adapter: Error running SQL: macro collect_freshness
[0m11:18:38.650066 [debug] [Thread-1 (]: Snowflake adapter: Rolling back transaction.
[0m11:18:38.652752 [debug] [Thread-1 (]: Database Error in source raw_orders (models/staging/_src_jaffle_shop.yml)
  000904 (42000): SQL compilation error: error line 2 at position 10
  invalid identifier 'LOADED_AT_FIELD'
[0m11:18:38.653328 [error] [Thread-1 (]: 1 of 1 ERROR freshness of jaffle_shop.raw_orders ............................... [[31mERROR[0m in 0.25s]
[0m11:18:38.654427 [debug] [Thread-1 (]: Finished running node source.jaffle_shop.jaffle_shop.raw_orders
[0m11:18:38.656066 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:18:38.656473 [debug] [MainThread]: Connection 'source.jaffle_shop.jaffle_shop.raw_orders' was left open.
[0m11:18:38.657410 [debug] [MainThread]: On source.jaffle_shop.jaffle_shop.raw_orders: Close
[0m11:18:38.769703 [info ] [MainThread]: 
[0m11:18:38.770391 [info ] [MainThread]: Finished running 1 source in 0 hours 0 minutes and 4.27 seconds (4.27s).
[0m11:18:38.797262 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m11:18:38.799246 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m11:18:38.802560 [debug] [MainThread]: Wrote artifact FreshnessResult to /opt/airflow/dbt/target/sources.json
[0m11:18:38.803114 [info ] [MainThread]: 
[0m11:18:38.803786 [error] [MainThread]:   Database Error in source raw_orders (models/staging/_src_jaffle_shop.yml)
  000904 (42000): SQL compilation error: error line 2 at position 10
  invalid identifier 'LOADED_AT_FIELD'
[0m11:18:38.804101 [info ] [MainThread]: Done.
[0m11:18:38.805505 [debug] [MainThread]: Resource report: {"command_name": "freshness", "command_success": false, "command_wall_clock_time": 6.845525, "process_in_blocks": "72720", "process_kernel_time": 1.319635, "process_mem_max_rss": "236012", "process_out_blocks": "27337", "process_user_time": 4.961616}
[0m11:18:38.806655 [debug] [MainThread]: Command `dbt source freshness` failed at 11:18:38.806503 after 6.85 seconds
[0m11:18:38.807138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0088da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa07543e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84718290>]}
[0m11:18:38.807868 [debug] [MainThread]: Flushing usage events
[0m11:18:39.334547 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:20:06.784061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d4a8ec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c654f20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d20f800>]}


============================== 11:20:06.790061 | abdc9605-454e-4a5b-b798-b8ddbd4d5af0 ==============================
[0m11:20:06.790061 [info ] [MainThread]: Running with dbt=1.10.13
[0m11:20:06.790540 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt source freshness --profiles-dir /opt/airflow/dbt --target dev', 'write_json': 'True', 'static_parser': 'True', 'debug': 'False', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'indirect_selection': 'eager', 'warn_error': 'None', 'quiet': 'False', 'log_format': 'default', 'target_path': 'None', 'log_path': '/opt/airflow/dbt/logs', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_colors': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'empty': 'None', 'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'printer_width': '80'}
[0m11:20:07.593641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'abdc9605-454e-4a5b-b798-b8ddbd4d5af0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80a6c5f0>]}
[0m11:20:07.630765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'abdc9605-454e-4a5b-b798-b8ddbd4d5af0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80bd21b0>]}
[0m11:20:07.631475 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m11:20:07.700850 [debug] [MainThread]: checksum: 87546e06832e1286bf2d49b8b108dd3f58da97cbfca650a1f147ec4aedfbbf25, vars: {}, profile: , target: dev, version: 1.10.13
[0m11:20:07.769242 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:20:07.769855 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:20:07.773254 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.jaffle_shop.examples
- models.jaffle_shop.analytics
[0m11:20:07.793082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'abdc9605-454e-4a5b-b798-b8ddbd4d5af0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff808a9a30>]}
[0m11:20:07.841126 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m11:20:07.842864 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m11:20:07.859855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'abdc9605-454e-4a5b-b798-b8ddbd4d5af0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff806239b0>]}
[0m11:20:07.860271 [info ] [MainThread]: Found 3 models, 6 sources, 493 macros
[0m11:20:07.860740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'abdc9605-454e-4a5b-b798-b8ddbd4d5af0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c2dd820>]}
[0m11:20:07.861855 [info ] [MainThread]: 
[0m11:20:07.862222 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:20:07.862557 [info ] [MainThread]: 
[0m11:20:07.863024 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:20:07.865730 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JAFFLE_SHOP_ANALYTICS'
[0m11:20:07.900299 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP_ANALYTICS"
[0m11:20:07.900717 [debug] [ThreadPool]: On list_JAFFLE_SHOP_ANALYTICS: show objects in JAFFLE_SHOP.ANALYTICS
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_JAFFLE_SHOP_ANALYTICS"} */;
[0m11:20:07.900965 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:20:10.070087 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2.172 seconds
[0m11:20:10.076428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'abdc9605-454e-4a5b-b798-b8ddbd4d5af0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80927ec0>]}
[0m11:20:10.077856 [info ] [MainThread]: Pulling freshness from warehouse metadata tables for 0 sources
[0m11:20:10.101686 [debug] [Thread-1 (]: Began running node source.jaffle_shop.jaffle_shop.raw_orders
[0m11:20:10.103848 [info ] [Thread-1 (]: 1 of 1 START freshness of jaffle_shop.raw_orders ............................... [RUN]
[0m11:20:10.104617 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_JAFFLE_SHOP_ANALYTICS, now source.jaffle_shop.jaffle_shop.raw_orders)
[0m11:20:10.105168 [debug] [Thread-1 (]: Began compiling node source.jaffle_shop.jaffle_shop.raw_orders
[0m11:20:10.105755 [debug] [Thread-1 (]: Began executing node source.jaffle_shop.jaffle_shop.raw_orders
[0m11:20:10.115505 [debug] [Thread-1 (]: Using snowflake connection "source.jaffle_shop.jaffle_shop.raw_orders"
[0m11:20:10.116836 [debug] [Thread-1 (]: On source.jaffle_shop.jaffle_shop.raw_orders: select
      max(loaded_at_field) as max_loaded_at,
      convert_timezone('UTC', current_timestamp()) as snapshotted_at
    from JAFFLE_SHOP.RAW.raw_orders
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "source.jaffle_shop.jaffle_shop.raw_orders"} */
[0m11:20:10.235656 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bfdb68-0305-55b1-0004-0c26000495ae
[0m11:20:10.236162 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 2 at position 10
invalid identifier 'LOADED_AT_FIELD'
[0m11:20:10.236666 [debug] [Thread-1 (]: Snowflake adapter: Error running SQL: macro collect_freshness
[0m11:20:10.236994 [debug] [Thread-1 (]: Snowflake adapter: Rolling back transaction.
[0m11:20:10.240193 [debug] [Thread-1 (]: Database Error in source raw_orders (models/staging/_src_jaffle_shop.yml)
  000904 (42000): SQL compilation error: error line 2 at position 10
  invalid identifier 'LOADED_AT_FIELD'
[0m11:20:10.241080 [error] [Thread-1 (]: 1 of 1 ERROR freshness of jaffle_shop.raw_orders ............................... [[31mERROR[0m in 0.14s]
[0m11:20:10.242203 [debug] [Thread-1 (]: Finished running node source.jaffle_shop.jaffle_shop.raw_orders
[0m11:20:10.245956 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:20:10.249049 [debug] [MainThread]: Connection 'source.jaffle_shop.jaffle_shop.raw_orders' was left open.
[0m11:20:10.250008 [debug] [MainThread]: On source.jaffle_shop.jaffle_shop.raw_orders: Close
[0m11:20:10.346756 [info ] [MainThread]: 
[0m11:20:10.347391 [info ] [MainThread]: Finished running 1 source in 0 hours 0 minutes and 2.48 seconds (2.48s).
[0m11:20:10.463888 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m11:20:10.467392 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m11:20:10.471545 [debug] [MainThread]: Wrote artifact FreshnessResult to /opt/airflow/dbt/target/sources.json
[0m11:20:10.471990 [info ] [MainThread]: 
[0m11:20:10.472829 [error] [MainThread]:   Database Error in source raw_orders (models/staging/_src_jaffle_shop.yml)
  000904 (42000): SQL compilation error: error line 2 at position 10
  invalid identifier 'LOADED_AT_FIELD'
[0m11:20:10.473462 [info ] [MainThread]: Done.
[0m11:20:10.474910 [debug] [MainThread]: Resource report: {"command_name": "freshness", "command_success": false, "command_wall_clock_time": 3.724796, "process_in_blocks": "24", "process_kernel_time": 0.516901, "process_mem_max_rss": "230384", "process_out_blocks": "2057", "process_user_time": 3.189091}
[0m11:20:10.475402 [debug] [MainThread]: Command `dbt source freshness` failed at 11:20:10.475322 after 3.73 seconds
[0m11:20:10.475743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d20e8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9edae8a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9cde4860>]}
[0m11:20:10.476032 [debug] [MainThread]: Flushing usage events
[0m11:20:11.036501 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:26:19.769878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa95478c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffabd199d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad559e80>]}


============================== 11:26:19.777786 | 59856dba-02d4-4dc1-9077-acba6f44f8d3 ==============================
[0m11:26:19.777786 [info ] [MainThread]: Running with dbt=1.10.13
[0m11:26:19.778560 [debug] [MainThread]: running dbt with arguments {'log_path': '/opt/airflow/dbt/logs', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'log_format': 'default', 'printer_width': '80', 'empty': 'None', 'no_print': 'None', 'debug': 'False', 'quiet': 'False', 'invocation_command': 'dbt source freshness --profiles-dir /opt/airflow/dbt --target dev', 'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'profiles_dir': '/opt/airflow/dbt', 'cache_selected_only': 'False', 'fail_fast': 'False', 'static_parser': 'True', 'version_check': 'True', 'indirect_selection': 'eager'}
[0m11:26:20.763721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '59856dba-02d4-4dc1-9077-acba6f44f8d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d56f830>]}
[0m11:26:20.810927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '59856dba-02d4-4dc1-9077-acba6f44f8d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d93eb40>]}
[0m11:26:20.811789 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m11:26:20.914333 [debug] [MainThread]: checksum: 87546e06832e1286bf2d49b8b108dd3f58da97cbfca650a1f147ec4aedfbbf25, vars: {}, profile: , target: dev, version: 1.10.13
[0m11:26:21.067549 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:26:21.069696 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://models/staging/_src_jaffle_shop.yml
[0m11:26:21.541510 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.jaffle_shop.analytics
- models.jaffle_shop.examples
[0m11:26:21.559118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '59856dba-02d4-4dc1-9077-acba6f44f8d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8cee95b0>]}
[0m11:26:21.862470 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m11:26:21.864680 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m11:26:21.885173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '59856dba-02d4-4dc1-9077-acba6f44f8d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8cb97530>]}
[0m11:26:21.885778 [info ] [MainThread]: Found 3 models, 6 sources, 493 macros
[0m11:26:21.886178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '59856dba-02d4-4dc1-9077-acba6f44f8d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d4681d0>]}
[0m11:26:21.887999 [info ] [MainThread]: 
[0m11:26:21.888954 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:26:21.889439 [info ] [MainThread]: 
[0m11:26:21.890045 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:26:21.893683 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JAFFLE_SHOP_ANALYTICS'
[0m11:26:21.928244 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP_ANALYTICS"
[0m11:26:21.928768 [debug] [ThreadPool]: On list_JAFFLE_SHOP_ANALYTICS: show objects in JAFFLE_SHOP.ANALYTICS
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_JAFFLE_SHOP_ANALYTICS"} */;
[0m11:26:21.929057 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:26:25.239723 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 3.307 seconds
[0m11:26:25.249357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '59856dba-02d4-4dc1-9077-acba6f44f8d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9b8cd70>]}
[0m11:26:25.251862 [info ] [MainThread]: Pulling freshness from warehouse metadata tables for 1 sources
[0m11:26:25.972548 [debug] [MainThread]: Using snowflake connection "master"
[0m11:26:25.973008 [debug] [MainThread]: On master: select table_schema as schema,
               table_name as identifier,
               last_altered as last_modified,
               convert_timezone('UTC', current_timestamp()) as snapshotted_at
        from JAFFLE_SHOP.INFORMATION_SCHEMA.tables
        where ((upper(table_schema) = upper('RAW') and
             upper(table_name) = upper('raw_orders')))
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
[0m11:26:27.200893 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.227 seconds
[0m11:26:27.207981 [debug] [Thread-1 (]: Began running node source.jaffle_shop.jaffle_shop.raw_orders
[0m11:26:27.208490 [info ] [Thread-1 (]: 1 of 1 START freshness of jaffle_shop.raw_orders ............................... [RUN]
[0m11:26:27.209241 [debug] [Thread-1 (]: Acquiring new snowflake connection 'source.jaffle_shop.jaffle_shop.raw_orders'
[0m11:26:27.210548 [debug] [Thread-1 (]: Began compiling node source.jaffle_shop.jaffle_shop.raw_orders
[0m11:26:27.212310 [debug] [Thread-1 (]: Began executing node source.jaffle_shop.jaffle_shop.raw_orders
[0m11:26:27.214601 [error] [Thread-1 (]: 1 of 1 ERROR STALE freshness of jaffle_shop.raw_orders ......................... [[31mERROR STALE[0m in 0.01s]
[0m11:26:27.215777 [debug] [Thread-1 (]: Finished running node source.jaffle_shop.jaffle_shop.raw_orders
[0m11:26:27.217457 [debug] [Thread-7 (]: Marking all children of 'source.jaffle_shop.jaffle_shop.raw_orders' to be skipped because of status 'error'. 
[0m11:26:27.224920 [debug] [MainThread]: Connection 'master' was left open.
[0m11:26:27.236142 [debug] [MainThread]: On master: Close
[0m11:26:27.334529 [debug] [MainThread]: Connection 'list_JAFFLE_SHOP_ANALYTICS' was left open.
[0m11:26:27.335286 [debug] [MainThread]: On list_JAFFLE_SHOP_ANALYTICS: Close
[0m11:26:27.457005 [debug] [MainThread]: Connection 'source.jaffle_shop.jaffle_shop.raw_orders' was properly closed.
[0m11:26:27.457579 [info ] [MainThread]: 
[0m11:26:27.458278 [info ] [MainThread]: Finished running 1 source in 0 hours 0 minutes and 5.57 seconds (5.57s).
[0m11:26:27.483372 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m11:26:27.486425 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m11:26:27.497740 [debug] [MainThread]: Wrote artifact FreshnessResult to /opt/airflow/dbt/target/sources.json
[0m11:26:27.498755 [info ] [MainThread]: 
[0m11:26:27.501158 [error] [MainThread]: [31mFailure in source raw_orders (models/staging/_src_jaffle_shop.yml)[0m
[0m11:26:27.503788 [error] [MainThread]:   Status: error
[0m11:26:27.505008 [info ] [MainThread]: Done.
[0m11:26:27.509118 [debug] [MainThread]: Resource report: {"command_name": "freshness", "command_success": false, "command_wall_clock_time": 7.8038893, "process_in_blocks": "0", "process_kernel_time": 0.60861, "process_mem_max_rss": "233704", "process_out_blocks": "3070", "process_user_time": 4.158497}
[0m11:26:27.515866 [debug] [MainThread]: Command `dbt source freshness` failed at 11:26:27.513373 after 7.81 seconds
[0m11:26:27.520171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8cef2d20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff865e4140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff865c1280>]}
[0m11:26:27.521181 [debug] [MainThread]: Flushing usage events
[0m11:26:28.040766 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:17:18.754552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93db4680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93db7b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9337cbf0>]}


============================== 12:17:18.760442 | ae0823bf-f2ec-4944-9f1e-b4addb101843 ==============================
[0m12:17:18.760442 [info ] [MainThread]: Running with dbt=1.10.13
[0m12:17:18.760909 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'profiles_dir': '/opt/airflow/dbt', 'printer_width': '80', 'invocation_command': 'dbt deps', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'quiet': 'False', 'log_format': 'default', 'write_json': 'True', 'introspect': 'True', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'log_cache_events': 'False', 'use_colors': 'True', 'partial_parse': 'True', 'target_path': 'None', 'warn_error': 'None', 'empty': 'None', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'fail_fast': 'False', 'no_print': 'None'}
[0m12:17:18.923755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ae0823bf-f2ec-4944-9f1e-b4addb101843', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff931545f0>]}
[0m12:17:18.967130 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-zbcrsr8g'
[0m12:17:18.967830 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m12:17:19.112030 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m12:17:19.113542 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json
[0m12:17:19.200751 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json 200
[0m12:17:19.205645 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m12:17:19.279525 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m12:17:19.289640 [info ] [MainThread]: Updating lock file in file path: /opt/airflow/dbt/package-lock.yml
[0m12:17:19.293102 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-q37auy_y'
[0m12:17:19.296128 [info ] [MainThread]: Installing dbt-labs/codegen
[0m12:17:19.640323 [info ] [MainThread]: Installed from version 0.13.1
[0m12:17:19.640771 [info ] [MainThread]: Up to date!
[0m12:17:19.641234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'ae0823bf-f2ec-4944-9f1e-b4addb101843', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff931f1df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9610d700>]}
[0m12:17:19.641715 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m12:17:20.076207 [info ] [MainThread]: Installed from version 1.3.1
[0m12:17:20.076823 [info ] [MainThread]: Up to date!
[0m12:17:20.077626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'ae0823bf-f2ec-4944-9f1e-b4addb101843', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93e1edb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93068e00>]}
[0m12:17:20.079210 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 1.3566798, "process_in_blocks": "14944", "process_kernel_time": 0.704926, "process_mem_max_rss": "109304", "process_out_blocks": "2935", "process_user_time": 1.652827}
[0m12:17:20.079642 [debug] [MainThread]: Command `dbt deps` succeeded at 12:17:20.079572 after 1.36 seconds
[0m12:17:20.079938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95024740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff939fb2c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93068e00>]}
[0m12:17:20.080206 [debug] [MainThread]: Flushing usage events
[0m12:17:20.585740 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:20:54.144613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9001ba70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8fe7b830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9001b890>]}


============================== 12:20:54.150756 | 73dc7bc7-0809-471e-b21a-adf5945e472c ==============================
[0m12:20:54.150756 [info ] [MainThread]: Running with dbt=1.10.13
[0m12:20:54.151172 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'static_parser': 'True', 'write_json': 'True', 'introspect': 'True', 'no_print': 'None', 'use_colors': 'True', 'empty': 'None', 'log_cache_events': 'False', 'quiet': 'False', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'debug': 'False', 'fail_fast': 'False', 'warn_error': 'None', 'log_format': 'default', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run-operation generate_source --args {"schema_name": "RAW", "database_name": "JAFFLE_SHOP"}', 'cache_selected_only': 'False', 'partial_parse': 'True', 'log_path': '/opt/airflow/dbt/logs'}
[0m12:20:56.010467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '73dc7bc7-0809-471e-b21a-adf5945e472c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff754a1190>]}
[0m12:20:56.045417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '73dc7bc7-0809-471e-b21a-adf5945e472c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff74253920>]}
[0m12:20:56.046124 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m12:20:56.123777 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m12:20:56.172620 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m12:20:56.173235 [debug] [MainThread]: previous checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, current checksum: 87546e06832e1286bf2d49b8b108dd3f58da97cbfca650a1f147ec4aedfbbf25
[0m12:20:56.173834 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m12:20:56.174333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '73dc7bc7-0809-471e-b21a-adf5945e472c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f8b96d0>]}
[0m12:20:57.158714 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.jaffle_shop.examples
- models.jaffle_shop.analytics
[0m12:20:57.164716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '73dc7bc7-0809-471e-b21a-adf5945e472c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff73289ac0>]}
[0m12:20:57.213042 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m12:20:57.215337 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m12:20:57.223623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '73dc7bc7-0809-471e-b21a-adf5945e472c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7311adb0>]}
[0m12:20:57.223949 [info ] [MainThread]: Found 3 models, 6 sources, 631 macros
[0m12:20:57.224313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '73dc7bc7-0809-471e-b21a-adf5945e472c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff731d4fb0>]}
[0m12:20:57.224916 [debug] [MainThread]: Acquiring new snowflake connection 'macro_generate_source'
[0m12:20:57.275853 [debug] [MainThread]: Using snowflake connection "macro_generate_source"
[0m12:20:57.276319 [debug] [MainThread]: On macro_generate_source: select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from JAFFLE_SHOP.information_schema.tables
        where table_schema ilike 'RAW'
        and table_name ilike '%'
        and table_name not ilike ''
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "macro_generate_source"} */
[0m12:20:57.276610 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:21:01.634074 [debug] [MainThread]: SQL status: SUCCESS 6 in 4.356 seconds
[0m12:21:01.643527 [info ] [MainThread]: version: 2

sources:
  - name: raw
    tables:
      - name: raw_customers
      - name: raw_items
      - name: raw_orders
      - name: raw_products
      - name: raw_stores
      - name: raw_supplies
[0m12:21:01.660263 [debug] [MainThread]: Wrote artifact RunResultsArtifact to /opt/airflow/dbt/target/run_results.json
[0m12:21:01.663546 [debug] [MainThread]: Resource report: {"command_name": "run-operation", "command_success": true, "command_wall_clock_time": 7.5508385, "process_in_blocks": "12848", "process_kernel_time": 0.979124, "process_mem_max_rss": "236264", "process_out_blocks": "26205", "process_user_time": 4.864329}
[0m12:21:01.664734 [debug] [MainThread]: Command `dbt run-operation` succeeded at 12:21:01.664466 after 7.55 seconds
[0m12:21:01.665464 [debug] [MainThread]: Connection 'macro_generate_source' was left open.
[0m12:21:01.665995 [debug] [MainThread]: On macro_generate_source: Close
[0m12:21:01.947919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff730d86b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff730ef1a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7298ede0>]}
[0m12:21:01.949325 [debug] [MainThread]: Flushing usage events
[0m12:21:02.502384 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:41:42.269496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81ed1760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84559760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81bb4800>]}


============================== 12:41:42.275775 | aab86efd-e919-470e-a693-6c9da0051b7f ==============================
[0m12:41:42.275775 [info ] [MainThread]: Running with dbt=1.10.13
[0m12:41:42.276286 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'partial_parse': 'True', 'invocation_command': 'dbt deps', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt', 'target_path': 'None', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'log_format': 'default', 'empty': 'None', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': '/opt/airflow/dbt/logs', 'printer_width': '80', 'no_print': 'None', 'write_json': 'True', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'fail_fast': 'False', 'introspect': 'True', 'quiet': 'False', 'use_experimental_parser': 'False', 'warn_error': 'None'}
[0m12:41:42.436385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'aab86efd-e919-470e-a693-6c9da0051b7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff840ae810>]}
[0m12:41:42.453423 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-6zpfmzey'
[0m12:41:42.453960 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m12:41:42.593381 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m12:41:42.594960 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json
[0m12:41:42.677483 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json 200
[0m12:41:42.682429 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m12:41:42.775425 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m12:41:42.786729 [info ] [MainThread]: Updating lock file in file path: /opt/airflow/dbt/package-lock.yml
[0m12:41:42.870138 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-c22j2kug'
[0m12:41:42.874163 [info ] [MainThread]: Installing dbt-labs/codegen
[0m12:41:43.200216 [info ] [MainThread]: Installed from version 0.13.1
[0m12:41:43.200894 [info ] [MainThread]: Up to date!
[0m12:41:43.202058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'aab86efd-e919-470e-a693-6c9da0051b7f', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff814179e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8143ec90>]}
[0m12:41:43.202727 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m12:41:43.727795 [info ] [MainThread]: Installed from version 1.3.1
[0m12:41:43.729281 [info ] [MainThread]: Up to date!
[0m12:41:43.731511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'aab86efd-e919-470e-a693-6c9da0051b7f', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8152a1b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81db1eb0>]}
[0m12:41:43.737496 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 1.5121264, "process_in_blocks": "1912", "process_kernel_time": 0.378564, "process_mem_max_rss": "107660", "process_out_blocks": "1031", "process_user_time": 2.215113}
[0m12:41:43.739431 [debug] [MainThread]: Command `dbt deps` succeeded at 12:41:43.738870 after 1.51 seconds
[0m12:41:43.742493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff862ac860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8231e000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81654680>]}
[0m12:41:43.743625 [debug] [MainThread]: Flushing usage events
[0m12:41:44.220113 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:00:46.332466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa91d54c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa99e0fe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa91d7a70>]}


============================== 13:00:46.338739 | 0224d81b-03ed-4375-8431-f4d7e65fe14d ==============================
[0m13:00:46.338739 [info ] [MainThread]: Running with dbt=1.10.13
[0m13:00:46.339347 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt test --profiles-dir /opt/airflow/dbt --target dev', 'empty': 'None', 'debug': 'False', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'partial_parse': 'True', 'no_print': 'None', 'log_path': '/opt/airflow/dbt/logs', 'log_cache_events': 'False', 'static_parser': 'True', 'target_path': 'None', 'quiet': 'False', 'printer_width': '80', 'cache_selected_only': 'False', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'version_check': 'True', 'log_format': 'default', 'indirect_selection': 'eager', 'write_json': 'True', 'profiles_dir': '/opt/airflow/dbt'}
[0m13:00:47.821407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0224d81b-03ed-4375-8431-f4d7e65fe14d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d197ce0>]}
[0m13:00:47.873345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0224d81b-03ed-4375-8431-f4d7e65fe14d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f764650>]}
[0m13:00:47.874258 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m13:00:47.968223 [debug] [MainThread]: checksum: 87546e06832e1286bf2d49b8b108dd3f58da97cbfca650a1f147ec4aedfbbf25, vars: {}, profile: , target: dev, version: 1.10.13
[0m13:00:48.025676 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m13:00:48.026160 [debug] [MainThread]: previous checksum: 87546e06832e1286bf2d49b8b108dd3f58da97cbfca650a1f147ec4aedfbbf25, current checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe
[0m13:00:48.026543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '0224d81b-03ed-4375-8431-f4d7e65fe14d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8cd340e0>]}
[0m13:00:48.971923 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.jaffle_shop.examples
- models.jaffle_shop.analytics
[0m13:00:48.977900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0224d81b-03ed-4375-8431-f4d7e65fe14d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c7c0860>]}
[0m13:00:49.033928 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m13:00:49.035844 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m13:00:49.060380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0224d81b-03ed-4375-8431-f4d7e65fe14d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ce0bd70>]}
[0m13:00:49.060771 [info ] [MainThread]: Found 3 models, 4 data tests, 6 sources, 631 macros
[0m13:00:49.061063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0224d81b-03ed-4375-8431-f4d7e65fe14d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c782ea0>]}
[0m13:00:49.062431 [info ] [MainThread]: 
[0m13:00:49.062722 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:00:49.063065 [info ] [MainThread]: 
[0m13:00:49.063512 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:00:49.066223 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JAFFLE_SHOP_ANALYTICS'
[0m13:00:49.107492 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP_ANALYTICS"
[0m13:00:49.107951 [debug] [ThreadPool]: On list_JAFFLE_SHOP_ANALYTICS: show objects in JAFFLE_SHOP.ANALYTICS
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_JAFFLE_SHOP_ANALYTICS"} */;
[0m13:00:49.108233 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:00:52.802035 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 3.693 seconds
[0m13:00:52.808609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0224d81b-03ed-4375-8431-f4d7e65fe14d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c75d3d0>]}
[0m13:00:52.815337 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m13:00:52.815951 [debug] [Thread-2 (]: Began running node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m13:00:52.816434 [debug] [Thread-3 (]: Began running node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m13:00:52.816948 [info ] [Thread-1 (]: 1 of 4 START test not_null_stg_customers_customer_id ........................... [RUN]
[0m13:00:52.817635 [debug] [Thread-4 (]: Began running node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m13:00:52.818280 [info ] [Thread-2 (]: 2 of 4 START test not_null_stg_orders_order_id ................................. [RUN]
[0m13:00:52.819102 [info ] [Thread-3 (]: 3 of 4 START test unique_stg_customers_customer_id ............................. [RUN]
[0m13:00:52.822570 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_JAFFLE_SHOP_ANALYTICS, now test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa)
[0m13:00:52.823512 [info ] [Thread-4 (]: 4 of 4 START test unique_stg_orders_order_id ................................... [RUN]
[0m13:00:52.824670 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64'
[0m13:00:52.825562 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.jaffle_shop.unique_stg_customers_customer_id.c7614daada'
[0m13:00:52.826327 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m13:00:52.827171 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a'
[0m13:00:52.827739 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m13:00:52.828292 [debug] [Thread-3 (]: Began compiling node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m13:00:52.840848 [debug] [Thread-4 (]: Began compiling node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m13:00:52.852515 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m13:00:52.859431 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
[0m13:00:52.865643 [debug] [Thread-3 (]: Writing injected SQL for node "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
[0m13:00:52.869311 [debug] [Thread-4 (]: Writing injected SQL for node "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
[0m13:00:52.871602 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m13:00:52.877702 [debug] [Thread-4 (]: Began executing node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m13:00:52.890664 [debug] [Thread-3 (]: Began executing node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m13:00:52.893675 [debug] [Thread-4 (]: Writing runtime sql for node "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
[0m13:00:52.894004 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m13:00:52.894315 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m13:00:52.896002 [debug] [Thread-3 (]: Writing runtime sql for node "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
[0m13:00:52.897940 [debug] [Thread-2 (]: Writing runtime sql for node "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
[0m13:00:52.899199 [debug] [Thread-1 (]: Using snowflake connection "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m13:00:52.899798 [debug] [Thread-3 (]: Using snowflake connection "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
[0m13:00:52.900073 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from JAFFLE_SHOP.ANALYTICS.stg_customers
where customer_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"} */
[0m13:00:52.900523 [debug] [Thread-3 (]: On test.jaffle_shop.unique_stg_customers_customer_id.c7614daada: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from JAFFLE_SHOP.ANALYTICS.stg_customers
where customer_id is not null
group by customer_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"} */
[0m13:00:52.900978 [debug] [Thread-2 (]: Using snowflake connection "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
[0m13:00:52.901449 [debug] [Thread-4 (]: Using snowflake connection "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
[0m13:00:52.902641 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:00:52.902945 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from JAFFLE_SHOP.ANALYTICS.stg_orders
where order_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"} */
[0m13:00:52.903248 [debug] [Thread-4 (]: On test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_id as unique_field,
    count(*) as n_records

from JAFFLE_SHOP.ANALYTICS.stg_orders
where order_id is not null
group by order_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"} */
[0m13:00:52.904442 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:00:52.906513 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:00:54.169501 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.267 seconds
[0m13:00:54.188650 [info ] [Thread-1 (]: 1 of 4 PASS not_null_stg_customers_customer_id ................................. [[32mPASS[0m in 1.37s]
[0m13:00:54.190902 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m13:00:54.192244 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.288 seconds
[0m13:00:54.195625 [info ] [Thread-2 (]: 2 of 4 PASS not_null_stg_orders_order_id ....................................... [[32mPASS[0m in 1.37s]
[0m13:00:54.196757 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m13:00:54.239314 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.336 seconds
[0m13:00:54.243066 [info ] [Thread-3 (]: 3 of 4 PASS unique_stg_customers_customer_id ................................... [[32mPASS[0m in 1.42s]
[0m13:00:54.244197 [debug] [Thread-3 (]: Finished running node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m13:00:54.521505 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.614 seconds
[0m13:00:54.526992 [info ] [Thread-4 (]: 4 of 4 PASS unique_stg_orders_order_id ......................................... [[32mPASS[0m in 1.70s]
[0m13:00:54.528471 [debug] [Thread-4 (]: Finished running node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m13:00:54.532283 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:00:54.533083 [debug] [MainThread]: Connection 'test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa' was left open.
[0m13:00:54.533888 [debug] [MainThread]: On test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa: Close
[0m13:00:54.688557 [debug] [MainThread]: Connection 'test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64' was left open.
[0m13:00:54.689250 [debug] [MainThread]: On test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64: Close
[0m13:00:54.797025 [debug] [MainThread]: Connection 'test.jaffle_shop.unique_stg_customers_customer_id.c7614daada' was left open.
[0m13:00:54.797986 [debug] [MainThread]: On test.jaffle_shop.unique_stg_customers_customer_id.c7614daada: Close
[0m13:00:54.960374 [debug] [MainThread]: Connection 'test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a' was left open.
[0m13:00:54.961293 [debug] [MainThread]: On test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a: Close
[0m13:00:55.209078 [info ] [MainThread]: 
[0m13:00:55.210440 [info ] [MainThread]: Finished running 4 data tests in 0 hours 0 minutes and 6.15 seconds (6.15s).
[0m13:00:55.213143 [debug] [MainThread]: Command end result
[0m13:00:55.260634 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m13:00:55.263905 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m13:00:55.270508 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/target/run_results.json
[0m13:00:55.270963 [info ] [MainThread]: 
[0m13:00:55.271952 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:00:55.272838 [info ] [MainThread]: 
[0m13:00:55.273482 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m13:00:55.275293 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 8.978681, "process_in_blocks": "1424", "process_kernel_time": 0.693845, "process_mem_max_rss": "244468", "process_out_blocks": "4160", "process_user_time": 4.870878}
[0m13:00:55.275805 [debug] [MainThread]: Command `dbt test` succeeded at 13:00:55.275707 after 8.98 seconds
[0m13:00:55.276266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9883ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c37b380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8cffb60>]}
[0m13:00:55.276690 [debug] [MainThread]: Flushing usage events
[0m13:00:55.825199 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:03:15.510988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa862eb40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa727a8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6e90650>]}


============================== 13:03:15.517215 | 75e7fee4-1e99-4e66-8a40-7a9eeef27dcf ==============================
[0m13:03:15.517215 [info ] [MainThread]: Running with dbt=1.10.13
[0m13:03:15.517759 [debug] [MainThread]: running dbt with arguments {'empty': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'write_json': 'True', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'quiet': 'False', 'partial_parse': 'True', 'version_check': 'True', 'printer_width': '80', 'profiles_dir': '/opt/airflow/dbt', 'cache_selected_only': 'False', 'introspect': 'True', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/dbt --target dev', 'use_experimental_parser': 'False', 'target_path': 'None', 'static_parser': 'True'}
[0m13:03:16.166759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '75e7fee4-1e99-4e66-8a40-7a9eeef27dcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6038860>]}
[0m13:03:16.201624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '75e7fee4-1e99-4e66-8a40-7a9eeef27dcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8cccf770>]}
[0m13:03:16.202321 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m13:03:16.280307 [debug] [MainThread]: checksum: 87546e06832e1286bf2d49b8b108dd3f58da97cbfca650a1f147ec4aedfbbf25, vars: {}, profile: , target: dev, version: 1.10.13
[0m13:03:16.401750 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:03:16.402074 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:03:16.405244 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.jaffle_shop.examples
- models.jaffle_shop.analytics
[0m13:03:16.428014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '75e7fee4-1e99-4e66-8a40-7a9eeef27dcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a66bda0>]}
[0m13:03:16.525028 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m13:03:16.527731 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m13:03:16.554932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '75e7fee4-1e99-4e66-8a40-7a9eeef27dcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a0ced20>]}
[0m13:03:16.555367 [info ] [MainThread]: Found 3 models, 4 data tests, 6 sources, 631 macros
[0m13:03:16.555738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '75e7fee4-1e99-4e66-8a40-7a9eeef27dcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a2b30e0>]}
[0m13:03:16.557376 [info ] [MainThread]: 
[0m13:03:16.557904 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:03:16.558288 [info ] [MainThread]: 
[0m13:03:16.558923 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:03:16.563750 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JAFFLE_SHOP_ANALYTICS'
[0m13:03:16.613821 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP_ANALYTICS"
[0m13:03:16.614317 [debug] [ThreadPool]: On list_JAFFLE_SHOP_ANALYTICS: show objects in JAFFLE_SHOP.ANALYTICS
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_JAFFLE_SHOP_ANALYTICS"} */;
[0m13:03:16.614630 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:03:19.043547 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2.429 seconds
[0m13:03:19.048092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '75e7fee4-1e99-4e66-8a40-7a9eeef27dcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a66bec0>]}
[0m13:03:19.053160 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m13:03:19.053496 [debug] [Thread-2 (]: Began running node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m13:03:19.053815 [debug] [Thread-3 (]: Began running node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m13:03:19.054095 [debug] [Thread-4 (]: Began running node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m13:03:19.054455 [info ] [Thread-1 (]: 1 of 4 START test not_null_stg_customers_customer_id ........................... [RUN]
[0m13:03:19.055092 [info ] [Thread-2 (]: 2 of 4 START test not_null_stg_orders_order_id ................................. [RUN]
[0m13:03:19.055974 [info ] [Thread-3 (]: 3 of 4 START test unique_stg_customers_customer_id ............................. [RUN]
[0m13:03:19.056409 [info ] [Thread-4 (]: 4 of 4 START test unique_stg_orders_order_id ................................... [RUN]
[0m13:03:19.057041 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_JAFFLE_SHOP_ANALYTICS, now test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa)
[0m13:03:19.057623 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64'
[0m13:03:19.058161 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.jaffle_shop.unique_stg_customers_customer_id.c7614daada'
[0m13:03:19.058707 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a'
[0m13:03:19.059243 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m13:03:19.059728 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m13:03:19.060179 [debug] [Thread-3 (]: Began compiling node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m13:03:19.060766 [debug] [Thread-4 (]: Began compiling node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m13:03:19.085184 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
[0m13:03:19.086576 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m13:03:19.093131 [debug] [Thread-3 (]: Writing injected SQL for node "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
[0m13:03:19.098840 [debug] [Thread-4 (]: Writing injected SQL for node "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
[0m13:03:19.101980 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m13:03:19.115608 [debug] [Thread-3 (]: Began executing node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m13:03:19.119440 [debug] [Thread-2 (]: Writing runtime sql for node "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
[0m13:03:19.121290 [debug] [Thread-3 (]: Writing runtime sql for node "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
[0m13:03:19.121627 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m13:03:19.121881 [debug] [Thread-4 (]: Began executing node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m13:03:19.123813 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m13:03:19.125412 [debug] [Thread-4 (]: Writing runtime sql for node "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
[0m13:03:19.126144 [debug] [Thread-2 (]: Using snowflake connection "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
[0m13:03:19.126697 [debug] [Thread-3 (]: Using snowflake connection "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
[0m13:03:19.127482 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from JAFFLE_SHOP.ANALYTICS.stg_orders
where order_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"} */
[0m13:03:19.128144 [debug] [Thread-3 (]: On test.jaffle_shop.unique_stg_customers_customer_id.c7614daada: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from JAFFLE_SHOP.ANALYTICS.stg_customers
where customer_id is not null
group by customer_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"} */
[0m13:03:19.129038 [debug] [Thread-4 (]: Using snowflake connection "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
[0m13:03:19.129680 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:03:19.130191 [debug] [Thread-1 (]: Using snowflake connection "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m13:03:19.130621 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:03:19.130999 [debug] [Thread-4 (]: On test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_id as unique_field,
    count(*) as n_records

from JAFFLE_SHOP.ANALYTICS.stg_orders
where order_id is not null
group by order_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"} */
[0m13:03:19.133568 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from JAFFLE_SHOP.ANALYTICS.stg_customers
where customer_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"} */
[0m13:03:19.142837 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:03:19.315132 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.171 seconds
[0m13:03:19.324570 [info ] [Thread-1 (]: 1 of 4 PASS not_null_stg_customers_customer_id ................................. [[32mPASS[0m in 0.27s]
[0m13:03:19.326268 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m13:03:19.613161 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.484 seconds
[0m13:03:19.616244 [info ] [Thread-2 (]: 2 of 4 PASS not_null_stg_orders_order_id ....................................... [[32mPASS[0m in 0.56s]
[0m13:03:19.617187 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m13:03:19.814950 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.672 seconds
[0m13:03:19.821277 [info ] [Thread-4 (]: 4 of 4 PASS unique_stg_orders_order_id ......................................... [[32mPASS[0m in 0.76s]
[0m13:03:19.822891 [debug] [Thread-4 (]: Finished running node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m13:03:20.047725 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.916 seconds
[0m13:03:20.054924 [info ] [Thread-3 (]: 3 of 4 PASS unique_stg_customers_customer_id ................................... [[32mPASS[0m in 1.00s]
[0m13:03:20.057969 [debug] [Thread-3 (]: Finished running node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m13:03:20.063235 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:03:20.064305 [debug] [MainThread]: Connection 'test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa' was left open.
[0m13:03:20.065451 [debug] [MainThread]: On test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa: Close
[0m13:03:20.232813 [debug] [MainThread]: Connection 'test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64' was left open.
[0m13:03:20.234848 [debug] [MainThread]: On test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64: Close
[0m13:03:20.418041 [debug] [MainThread]: Connection 'test.jaffle_shop.unique_stg_customers_customer_id.c7614daada' was left open.
[0m13:03:20.419666 [debug] [MainThread]: On test.jaffle_shop.unique_stg_customers_customer_id.c7614daada: Close
[0m13:03:20.621043 [debug] [MainThread]: Connection 'test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a' was left open.
[0m13:03:20.621775 [debug] [MainThread]: On test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a: Close
[0m13:03:20.728905 [info ] [MainThread]: 
[0m13:03:20.730035 [info ] [MainThread]: Finished running 4 data tests in 0 hours 0 minutes and 4.17 seconds (4.17s).
[0m13:03:20.731708 [debug] [MainThread]: Command end result
[0m13:03:20.763989 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m13:03:20.766298 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m13:03:20.774209 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/target/run_results.json
[0m13:03:20.774732 [info ] [MainThread]: 
[0m13:03:20.775434 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:03:20.775843 [info ] [MainThread]: 
[0m13:03:20.776149 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m13:03:20.779893 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 5.307393, "process_in_blocks": "0", "process_kernel_time": 0.845593, "process_mem_max_rss": "238764", "process_out_blocks": "2790", "process_user_time": 4.173303}
[0m13:03:20.780349 [debug] [MainThread]: Command `dbt test` succeeded at 13:03:20.780285 after 5.31 seconds
[0m13:03:20.780740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffab3bb230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa627e960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7fe03b0>]}
[0m13:03:20.781119 [debug] [MainThread]: Flushing usage events
[0m13:03:21.310568 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:20:37.186461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82db0c80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff824ccf20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82c6aba0>]}


============================== 13:20:37.192094 | 83dce13c-82a7-4d49-b4e8-8dc807760dfd ==============================
[0m13:20:37.192094 [info ] [MainThread]: Running with dbt=1.10.13
[0m13:20:37.192526 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'version_check': 'True', 'introspect': 'True', 'empty': 'None', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'no_print': 'None', 'log_format': 'default', 'log_cache_events': 'False', 'partial_parse': 'True', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/dbt --target dev', 'static_parser': 'True', 'fail_fast': 'False', 'debug': 'False', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '/opt/airflow/dbt', 'warn_error': 'None', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'use_colors': 'True', 'log_path': '/opt/airflow/dbt/logs'}
[0m13:20:37.803078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '83dce13c-82a7-4d49-b4e8-8dc807760dfd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff66f8e030>]}
[0m13:20:37.837145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '83dce13c-82a7-4d49-b4e8-8dc807760dfd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff66df30e0>]}
[0m13:20:37.837767 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m13:20:37.919114 [debug] [MainThread]: checksum: 87546e06832e1286bf2d49b8b108dd3f58da97cbfca650a1f147ec4aedfbbf25, vars: {}, profile: , target: dev, version: 1.10.13
[0m13:20:38.029211 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:20:38.029826 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://models/staging/_stg_jaffle_shop.yml
[0m13:20:38.258407 [error] [MainThread]: Encountered an error:
Parsing Error
  Invalid test config given in models/staging/_stg_jaffle_shop.yml:
  	test definition dictionary must have exactly one key, got [('relationships', None), ('field', 'customer_id'), ('to', "ref('stg_customers')")] instead (3 keys)
  	@: UnparsedModelUpdate(original_file_path='mode...ne)
[0m13:20:38.260042 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 1.1045299, "process_in_blocks": "0", "process_kernel_time": 0.336362, "process_mem_max_rss": "213064", "process_out_blocks": "5", "process_user_time": 2.899749}
[0m13:20:38.261043 [debug] [MainThread]: Command `dbt test` failed at 13:20:38.260961 after 1.11 seconds
[0m13:20:38.261433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86d67290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff66860950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83f72510>]}
[0m13:20:38.261833 [debug] [MainThread]: Flushing usage events
[0m13:20:38.726621 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:20:51.879139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb657ffb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb534b200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3ad4710>]}


============================== 13:20:51.884789 | f7bba3f4-3869-4994-b18f-32c46b5a13b4 ==============================
[0m13:20:51.884789 [info ] [MainThread]: Running with dbt=1.10.13
[0m13:20:51.885278 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'empty': 'None', 'debug': 'False', 'printer_width': '80', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/dbt --target dev', 'partial_parse': 'True', 'log_path': '/opt/airflow/dbt/logs', 'no_print': 'None', 'log_cache_events': 'False', 'use_colors': 'True', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt', 'static_parser': 'True', 'quiet': 'False', 'use_experimental_parser': 'False', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'write_json': 'True', 'log_format': 'default', 'fail_fast': 'False', 'warn_error': 'None', 'target_path': 'None', 'introspect': 'True', 'indirect_selection': 'eager'}
[0m13:20:52.485913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f7bba3f4-3869-4994-b18f-32c46b5a13b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97bfad20>]}
[0m13:20:52.520610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f7bba3f4-3869-4994-b18f-32c46b5a13b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a00b290>]}
[0m13:20:52.521271 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m13:20:52.592145 [debug] [MainThread]: checksum: 87546e06832e1286bf2d49b8b108dd3f58da97cbfca650a1f147ec4aedfbbf25, vars: {}, profile: , target: dev, version: 1.10.13
[0m13:20:52.689140 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:20:52.690139 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://models/staging/_stg_jaffle_shop.yml
[0m13:20:52.888054 [error] [MainThread]: Encountered an error:
Parsing Error
  Invalid test config given in models/staging/_stg_jaffle_shop.yml:
  	test definition dictionary must have exactly one key, got [('relationships', None), ('field', 'customer_id'), ('to', "ref('stg_customers')")] instead (3 keys)
  	@: UnparsedModelUpdate(original_file_path='mode...ne)
[0m13:20:52.889883 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 1.0418178, "process_in_blocks": "0", "process_kernel_time": 0.368787, "process_mem_max_rss": "212936", "process_out_blocks": "5", "process_user_time": 2.734327}
[0m13:20:52.891123 [debug] [MainThread]: Command `dbt test` failed at 13:20:52.891008 after 1.04 seconds
[0m13:20:52.891814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb594d580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97bfa450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff972a9940>]}
[0m13:20:52.892280 [debug] [MainThread]: Flushing usage events
[0m13:20:53.408613 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:23:02.659147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8cb5b0b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c6317c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ef15910>]}


============================== 13:23:02.664849 | 601745b8-5969-4f06-b20e-0334e5076f9a ==============================
[0m13:23:02.664849 [info ] [MainThread]: Running with dbt=1.10.13
[0m13:23:02.665263 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'introspect': 'True', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/dbt --target dev', 'log_path': '/opt/airflow/dbt/logs', 'partial_parse': 'True', 'no_print': 'None', 'static_parser': 'True', 'target_path': 'None', 'use_colors': 'True', 'profiles_dir': '/opt/airflow/dbt', 'log_cache_events': 'False', 'version_check': 'True', 'warn_error': 'None', 'debug': 'False', 'quiet': 'False', 'printer_width': '80'}
[0m13:23:03.270635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '601745b8-5969-4f06-b20e-0334e5076f9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff716c6930>]}
[0m13:23:03.305730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '601745b8-5969-4f06-b20e-0334e5076f9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ca41130>]}
[0m13:23:03.306441 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m13:23:03.376230 [debug] [MainThread]: checksum: 87546e06832e1286bf2d49b8b108dd3f58da97cbfca650a1f147ec4aedfbbf25, vars: {}, profile: , target: dev, version: 1.10.13
[0m13:23:03.480549 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:23:03.481099 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://models/staging/_stg_jaffle_shop.yml
[0m13:23:03.673618 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `relationships`. Arguments to generic tests
should be nested under the `arguments` property.`
[0m13:23:03.674270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '601745b8-5969-4f06-b20e-0334e5076f9a', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff70566540>]}
[0m13:23:03.770361 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.jaffle_shop.examples
- models.jaffle_shop.analytics
[0m13:23:03.778531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '601745b8-5969-4f06-b20e-0334e5076f9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7042c0b0>]}
[0m13:23:03.844616 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m13:23:03.847258 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m13:23:03.869825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '601745b8-5969-4f06-b20e-0334e5076f9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff704ae5d0>]}
[0m13:23:03.870346 [info ] [MainThread]: Found 3 models, 5 data tests, 6 sources, 631 macros
[0m13:23:03.870640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '601745b8-5969-4f06-b20e-0334e5076f9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff705669c0>]}
[0m13:23:03.872127 [info ] [MainThread]: 
[0m13:23:03.872514 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:23:03.872746 [info ] [MainThread]: 
[0m13:23:03.873230 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:23:03.876038 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JAFFLE_SHOP_ANALYTICS'
[0m13:23:03.911716 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP_ANALYTICS"
[0m13:23:03.912138 [debug] [ThreadPool]: On list_JAFFLE_SHOP_ANALYTICS: show objects in JAFFLE_SHOP.ANALYTICS
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_JAFFLE_SHOP_ANALYTICS"} */;
[0m13:23:03.912934 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:23:06.957725 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 3.045 seconds
[0m13:23:06.960960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '601745b8-5969-4f06-b20e-0334e5076f9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d08c140>]}
[0m13:23:06.965375 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m13:23:06.965751 [debug] [Thread-2 (]: Began running node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m13:23:06.966079 [debug] [Thread-3 (]: Began running node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m13:23:06.966407 [info ] [Thread-1 (]: 1 of 5 START test not_null_stg_customers_customer_id ........................... [RUN]
[0m13:23:06.967309 [debug] [Thread-4 (]: Began running node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m13:23:06.967656 [info ] [Thread-2 (]: 2 of 5 START test not_null_stg_orders_order_id ................................. [RUN]
[0m13:23:06.968446 [info ] [Thread-3 (]: 3 of 5 START test relationships_stg_orders_customer_id__customer_id__ref_stg_customers_  [RUN]
[0m13:23:06.969215 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_JAFFLE_SHOP_ANALYTICS, now test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa)
[0m13:23:06.969918 [info ] [Thread-4 (]: 4 of 5 START test unique_stg_customers_customer_id ............................. [RUN]
[0m13:23:06.970851 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64'
[0m13:23:06.971399 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500'
[0m13:23:06.971821 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m13:23:06.972311 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.jaffle_shop.unique_stg_customers_customer_id.c7614daada'
[0m13:23:06.972662 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m13:23:06.972988 [debug] [Thread-3 (]: Began compiling node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m13:23:06.983983 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m13:23:06.984545 [debug] [Thread-4 (]: Began compiling node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m13:23:06.988445 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
[0m13:23:06.992427 [debug] [Thread-3 (]: Writing injected SQL for node "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m13:23:06.996942 [debug] [Thread-4 (]: Writing injected SQL for node "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
[0m13:23:06.998586 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m13:23:07.014447 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m13:23:07.020906 [debug] [Thread-3 (]: Began executing node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m13:23:07.039905 [debug] [Thread-2 (]: Writing runtime sql for node "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
[0m13:23:07.040386 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m13:23:07.042611 [debug] [Thread-3 (]: Writing runtime sql for node "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m13:23:07.044129 [debug] [Thread-4 (]: Began executing node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m13:23:07.045572 [debug] [Thread-2 (]: Using snowflake connection "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
[0m13:23:07.047691 [debug] [Thread-4 (]: Writing runtime sql for node "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
[0m13:23:07.048462 [debug] [Thread-1 (]: Using snowflake connection "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m13:23:07.048841 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from JAFFLE_SHOP.ANALYTICS.stg_orders
where order_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"} */
[0m13:23:07.049444 [debug] [Thread-3 (]: Using snowflake connection "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m13:23:07.049841 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from JAFFLE_SHOP.ANALYTICS.stg_customers
where customer_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"} */
[0m13:23:07.050194 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:23:07.050568 [debug] [Thread-3 (]: On test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select customer_id as from_field
    from JAFFLE_SHOP.ANALYTICS.stg_orders
    where customer_id is not null
),

parent as (
    select customer_id as to_field
    from JAFFLE_SHOP.ANALYTICS.stg_customers
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"} */
[0m13:23:07.051248 [debug] [Thread-4 (]: Using snowflake connection "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
[0m13:23:07.055205 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:23:07.057715 [debug] [Thread-4 (]: On test.jaffle_shop.unique_stg_customers_customer_id.c7614daada: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from JAFFLE_SHOP.ANALYTICS.stg_customers
where customer_id is not null
group by customer_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"} */
[0m13:23:07.064333 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:23:07.201351 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.150 seconds
[0m13:23:07.207617 [info ] [Thread-1 (]: 1 of 5 PASS not_null_stg_customers_customer_id ................................. [[32mPASS[0m in 0.24s]
[0m13:23:07.208432 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m13:23:07.208919 [debug] [Thread-1 (]: Began running node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m13:23:07.209302 [info ] [Thread-1 (]: 5 of 5 START test unique_stg_orders_order_id ................................... [RUN]
[0m13:23:07.209774 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa, now test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a)
[0m13:23:07.210063 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m13:23:07.213165 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
[0m13:23:07.214243 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m13:23:07.215865 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
[0m13:23:07.216819 [debug] [Thread-1 (]: Using snowflake connection "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
[0m13:23:07.217077 [debug] [Thread-1 (]: On test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_id as unique_field,
    count(*) as n_records

from JAFFLE_SHOP.ANALYTICS.stg_orders
where order_id is not null
group by order_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"} */
[0m13:23:07.381186 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.164 seconds
[0m13:23:07.384021 [info ] [Thread-1 (]: 5 of 5 PASS unique_stg_orders_order_id ......................................... [[32mPASS[0m in 0.17s]
[0m13:23:07.385139 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m13:23:07.534732 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.484 seconds
[0m13:23:07.541460 [info ] [Thread-2 (]: 2 of 5 PASS not_null_stg_orders_order_id ....................................... [[32mPASS[0m in 0.57s]
[0m13:23:07.542851 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m13:23:07.868793 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.804 seconds
[0m13:23:07.872189 [info ] [Thread-4 (]: 4 of 5 PASS unique_stg_customers_customer_id ................................... [[32mPASS[0m in 0.90s]
[0m13:23:07.873227 [debug] [Thread-4 (]: Finished running node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m13:23:08.615072 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.560 seconds
[0m13:23:08.618552 [info ] [Thread-3 (]: 3 of 5 PASS relationships_stg_orders_customer_id__customer_id__ref_stg_customers_  [[32mPASS[0m in 1.65s]
[0m13:23:08.619594 [debug] [Thread-3 (]: Finished running node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m13:23:08.622220 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:23:08.622830 [debug] [MainThread]: Connection 'test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a' was left open.
[0m13:23:08.623401 [debug] [MainThread]: On test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a: Close
[0m13:23:08.734556 [debug] [MainThread]: Connection 'test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64' was left open.
[0m13:23:08.735131 [debug] [MainThread]: On test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64: Close
[0m13:23:08.860925 [debug] [MainThread]: Connection 'test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500' was left open.
[0m13:23:08.862640 [debug] [MainThread]: On test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: Close
[0m13:23:08.997103 [debug] [MainThread]: Connection 'test.jaffle_shop.unique_stg_customers_customer_id.c7614daada' was left open.
[0m13:23:08.998771 [debug] [MainThread]: On test.jaffle_shop.unique_stg_customers_customer_id.c7614daada: Close
[0m13:23:09.117928 [info ] [MainThread]: 
[0m13:23:09.118997 [info ] [MainThread]: Finished running 5 data tests in 0 hours 0 minutes and 5.24 seconds (5.24s).
[0m13:23:09.120479 [debug] [MainThread]: Command end result
[0m13:23:09.147936 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m13:23:09.149651 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m13:23:09.154191 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/target/run_results.json
[0m13:23:09.154462 [info ] [MainThread]: 
[0m13:23:09.154734 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:23:09.155109 [info ] [MainThread]: 
[0m13:23:09.155525 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=5
[0m13:23:09.156009 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m13:23:09.156998 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 6.529071, "process_in_blocks": "0", "process_kernel_time": 0.59142, "process_mem_max_rss": "242208", "process_out_blocks": "4196", "process_user_time": 3.430643}
[0m13:23:09.157598 [debug] [MainThread]: Command `dbt test` succeeded at 13:23:09.157531 after 6.53 seconds
[0m13:23:09.157853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ce41b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff704a29c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ccddd30>]}
[0m13:23:09.158147 [debug] [MainThread]: Flushing usage events
[0m13:23:09.647639 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:28:11.468502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb475d2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3d6a1e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3d6acc0>]}


============================== 13:28:11.474916 | d27117c5-0326-408f-99ee-7a4df73f9674 ==============================
[0m13:28:11.474916 [info ] [MainThread]: Running with dbt=1.10.13
[0m13:28:11.475377 [debug] [MainThread]: running dbt with arguments {'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/opt/airflow/dbt', 'no_print': 'None', 'use_colors': 'True', 'target_path': 'None', 'quiet': 'False', 'log_format': 'default', 'version_check': 'True', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'printer_width': '80', 'write_json': 'True', 'static_parser': 'True', 'partial_parse': 'True', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/dbt --target dev', 'debug': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'warn_error': 'None', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'fail_fast': 'False', 'empty': 'None'}
[0m13:28:12.124411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd27117c5-0326-408f-99ee-7a4df73f9674', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97c9be30>]}
[0m13:28:12.161034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd27117c5-0326-408f-99ee-7a4df73f9674', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a1eab70>]}
[0m13:28:12.161750 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m13:28:12.936968 [debug] [MainThread]: checksum: 87546e06832e1286bf2d49b8b108dd3f58da97cbfca650a1f147ec4aedfbbf25, vars: {}, profile: , target: dev, version: 1.10.13
[0m13:28:13.097162 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m13:28:13.098134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd27117c5-0326-408f-99ee-7a4df73f9674', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97858ce0>]}
[0m13:28:14.240848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd27117c5-0326-408f-99ee-7a4df73f9674', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff973f1160>]}
[0m13:28:14.327124 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m13:28:14.334081 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m13:28:14.394832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd27117c5-0326-408f-99ee-7a4df73f9674', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff973a6120>]}
[0m13:28:14.395558 [info ] [MainThread]: Found 3 models, 5 data tests, 6 sources, 631 macros
[0m13:28:14.396147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd27117c5-0326-408f-99ee-7a4df73f9674', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96b62d20>]}
[0m13:28:14.398459 [info ] [MainThread]: 
[0m13:28:14.399897 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:28:14.400615 [info ] [MainThread]: 
[0m13:28:14.402235 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:28:14.407561 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JAFFLE_SHOP_ANALYTICS'
[0m13:28:14.460501 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP_ANALYTICS"
[0m13:28:14.461482 [debug] [ThreadPool]: On list_JAFFLE_SHOP_ANALYTICS: show objects in JAFFLE_SHOP.ANALYTICS
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_JAFFLE_SHOP_ANALYTICS"} */;
[0m13:28:14.463146 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:28:16.559840 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2.097 seconds
[0m13:28:16.563855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd27117c5-0326-408f-99ee-7a4df73f9674', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff976944d0>]}
[0m13:28:16.570321 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m13:28:16.570784 [debug] [Thread-2 (]: Began running node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m13:28:16.571198 [debug] [Thread-3 (]: Began running node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m13:28:16.571585 [info ] [Thread-1 (]: 1 of 5 START test not_null_stg_customers_customer_id ........................... [RUN]
[0m13:28:16.572092 [debug] [Thread-4 (]: Began running node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m13:28:16.572537 [info ] [Thread-2 (]: 2 of 5 START test not_null_stg_orders_order_id ................................. [RUN]
[0m13:28:16.576253 [info ] [Thread-3 (]: 3 of 5 START test relationships_stg_orders_customer_id__customer_id__ref_stg_customers_  [RUN]
[0m13:28:16.577175 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_JAFFLE_SHOP_ANALYTICS, now test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa)
[0m13:28:16.577799 [info ] [Thread-4 (]: 4 of 5 START test unique_stg_customers_customer_id ............................. [RUN]
[0m13:28:16.578743 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64'
[0m13:28:16.579463 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500'
[0m13:28:16.580360 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m13:28:16.581437 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.jaffle_shop.unique_stg_customers_customer_id.c7614daada'
[0m13:28:16.582357 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m13:28:16.583065 [debug] [Thread-3 (]: Began compiling node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m13:28:16.596744 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m13:28:16.597077 [debug] [Thread-4 (]: Began compiling node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m13:28:16.599837 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
[0m13:28:16.603091 [debug] [Thread-3 (]: Writing injected SQL for node "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m13:28:16.607837 [debug] [Thread-4 (]: Writing injected SQL for node "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
[0m13:28:16.608677 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m13:28:16.609193 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m13:28:16.625552 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m13:28:16.627501 [debug] [Thread-2 (]: Writing runtime sql for node "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
[0m13:28:16.627827 [debug] [Thread-4 (]: Began executing node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m13:28:16.628171 [debug] [Thread-3 (]: Began executing node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m13:28:16.630100 [debug] [Thread-4 (]: Writing runtime sql for node "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
[0m13:28:16.630760 [debug] [Thread-1 (]: Using snowflake connection "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m13:28:16.632375 [debug] [Thread-3 (]: Writing runtime sql for node "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m13:28:16.632809 [debug] [Thread-2 (]: Using snowflake connection "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
[0m13:28:16.633293 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from JAFFLE_SHOP.ANALYTICS.stg_customers
where customer_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"} */
[0m13:28:16.633918 [debug] [Thread-4 (]: Using snowflake connection "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
[0m13:28:16.634222 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from JAFFLE_SHOP.ANALYTICS.stg_orders
where order_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"} */
[0m13:28:16.635158 [debug] [Thread-3 (]: Using snowflake connection "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m13:28:16.635672 [debug] [Thread-4 (]: On test.jaffle_shop.unique_stg_customers_customer_id.c7614daada: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from JAFFLE_SHOP.ANALYTICS.stg_customers
where customer_id is not null
group by customer_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"} */
[0m13:28:16.636178 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:28:16.636541 [debug] [Thread-3 (]: On test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select customer_id as from_field
    from JAFFLE_SHOP.ANALYTICS.stg_orders
    where customer_id is not null
),

parent as (
    select customer_id as to_field
    from JAFFLE_SHOP.ANALYTICS.stg_customers
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"} */
[0m13:28:16.636819 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:28:16.638594 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:28:17.096137 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.461 seconds
[0m13:28:17.103622 [info ] [Thread-1 (]: 1 of 5 PASS not_null_stg_customers_customer_id ................................. [[32mPASS[0m in 0.53s]
[0m13:28:17.104503 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m13:28:17.105398 [debug] [Thread-1 (]: Began running node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m13:28:17.105860 [info ] [Thread-1 (]: 5 of 5 START test unique_stg_orders_order_id ................................... [RUN]
[0m13:28:17.106589 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa, now test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a)
[0m13:28:17.107169 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m13:28:17.112190 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
[0m13:28:17.113891 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m13:28:17.116680 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
[0m13:28:17.118012 [debug] [Thread-1 (]: Using snowflake connection "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
[0m13:28:17.118347 [debug] [Thread-1 (]: On test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_id as unique_field,
    count(*) as n_records

from JAFFLE_SHOP.ANALYTICS.stg_orders
where order_id is not null
group by order_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"} */
[0m13:28:17.249003 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.612 seconds
[0m13:28:17.251039 [info ] [Thread-4 (]: 4 of 5 PASS unique_stg_customers_customer_id ................................... [[32mPASS[0m in 0.67s]
[0m13:28:17.251690 [debug] [Thread-4 (]: Finished running node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m13:28:17.280998 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.642 seconds
[0m13:28:17.281987 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.646 seconds
[0m13:28:17.283511 [info ] [Thread-3 (]: 3 of 5 PASS relationships_stg_orders_customer_id__customer_id__ref_stg_customers_  [[32mPASS[0m in 0.70s]
[0m13:28:17.285053 [info ] [Thread-2 (]: 2 of 5 PASS not_null_stg_orders_order_id ....................................... [[32mPASS[0m in 0.71s]
[0m13:28:17.285672 [debug] [Thread-3 (]: Finished running node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m13:28:17.286204 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m13:28:17.319765 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.201 seconds
[0m13:28:17.321431 [info ] [Thread-1 (]: 5 of 5 PASS unique_stg_orders_order_id ......................................... [[32mPASS[0m in 0.21s]
[0m13:28:17.322190 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m13:28:17.323850 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:28:17.324260 [debug] [MainThread]: Connection 'test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a' was left open.
[0m13:28:17.324651 [debug] [MainThread]: On test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a: Close
[0m13:28:17.437211 [debug] [MainThread]: Connection 'test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64' was left open.
[0m13:28:17.438110 [debug] [MainThread]: On test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64: Close
[0m13:28:17.549813 [debug] [MainThread]: Connection 'test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500' was left open.
[0m13:28:17.551148 [debug] [MainThread]: On test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: Close
[0m13:28:17.653143 [debug] [MainThread]: Connection 'test.jaffle_shop.unique_stg_customers_customer_id.c7614daada' was left open.
[0m13:28:17.654546 [debug] [MainThread]: On test.jaffle_shop.unique_stg_customers_customer_id.c7614daada: Close
[0m13:28:17.770269 [info ] [MainThread]: 
[0m13:28:17.771275 [info ] [MainThread]: Finished running 5 data tests in 0 hours 0 minutes and 3.37 seconds (3.37s).
[0m13:28:17.772586 [debug] [MainThread]: Command end result
[0m13:28:17.816307 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m13:28:17.819992 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m13:28:17.828442 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/target/run_results.json
[0m13:28:17.828931 [info ] [MainThread]: 
[0m13:28:17.829776 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:28:17.830181 [info ] [MainThread]: 
[0m13:28:17.830589 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=5
[0m13:28:17.832109 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 6.395121, "process_in_blocks": "0", "process_kernel_time": 0.773752, "process_mem_max_rss": "244608", "process_out_blocks": "4189", "process_user_time": 4.970162}
[0m13:28:17.832556 [debug] [MainThread]: Command `dbt test` succeeded at 13:28:17.832475 after 6.40 seconds
[0m13:28:17.832903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4399e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb439a840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e1bfc50>]}
[0m13:28:17.833271 [debug] [MainThread]: Flushing usage events
[0m13:28:18.328796 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:47:27.703883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa68cc620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6892000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6892120>]}


============================== 13:47:27.709921 | 43b501c7-55d3-4068-95c7-6f115f32f115 ==============================
[0m13:47:27.709921 [info ] [MainThread]: Running with dbt=1.10.13
[0m13:47:27.710449 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'quiet': 'False', 'warn_error': 'None', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/dbt --target dev', 'profiles_dir': '/opt/airflow/dbt', 'log_path': '/opt/airflow/dbt/logs', 'printer_width': '80', 'log_format': 'default', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'static_parser': 'True', 'fail_fast': 'False', 'empty': 'None', 'target_path': 'None', 'cache_selected_only': 'False', 'introspect': 'True', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'no_print': 'None', 'send_anonymous_usage_stats': 'True'}
[0m13:47:28.300329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '43b501c7-55d3-4068-95c7-6f115f32f115', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b44acc0>]}
[0m13:47:28.348574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '43b501c7-55d3-4068-95c7-6f115f32f115', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8aa22810>]}
[0m13:47:28.349426 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m13:47:28.446952 [debug] [MainThread]: checksum: 87546e06832e1286bf2d49b8b108dd3f58da97cbfca650a1f147ec4aedfbbf25, vars: {}, profile: , target: dev, version: 1.10.13
[0m13:47:28.628360 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:47:28.629192 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://models/staging/_src_jaffle_shop.yml
[0m13:47:29.024066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '43b501c7-55d3-4068-95c7-6f115f32f115', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a0d38f0>]}
[0m13:47:29.082213 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m13:47:29.085055 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m13:47:29.105565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '43b501c7-55d3-4068-95c7-6f115f32f115', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89d33620>]}
[0m13:47:29.105981 [info ] [MainThread]: Found 3 models, 9 data tests, 6 sources, 631 macros
[0m13:47:29.106597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '43b501c7-55d3-4068-95c7-6f115f32f115', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a1318e0>]}
[0m13:47:29.108059 [info ] [MainThread]: 
[0m13:47:29.108369 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:47:29.108624 [info ] [MainThread]: 
[0m13:47:29.109060 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:47:29.111892 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JAFFLE_SHOP_ANALYTICS'
[0m13:47:29.145667 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP_ANALYTICS"
[0m13:47:29.146087 [debug] [ThreadPool]: On list_JAFFLE_SHOP_ANALYTICS: show objects in JAFFLE_SHOP.ANALYTICS
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_JAFFLE_SHOP_ANALYTICS"} */;
[0m13:47:29.146333 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:47:31.003666 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.857 seconds
[0m13:47:31.009867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '43b501c7-55d3-4068-95c7-6f115f32f115', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89d83290>]}
[0m13:47:31.027261 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m13:47:31.028108 [debug] [Thread-2 (]: Began running node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m13:47:31.028569 [debug] [Thread-3 (]: Began running node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m13:47:31.029261 [info ] [Thread-1 (]: 1 of 9 START test not_null_stg_customers_customer_id ........................... [RUN]
[0m13:47:31.030496 [debug] [Thread-4 (]: Began running node test.jaffle_shop.source_not_null_jaffle_shop_raw_customers_id.0848441319
[0m13:47:31.033911 [info ] [Thread-2 (]: 2 of 9 START test not_null_stg_orders_order_id ................................. [RUN]
[0m13:47:31.036393 [info ] [Thread-3 (]: 3 of 9 START test relationships_stg_orders_customer_id__customer_id__ref_stg_customers_  [RUN]
[0m13:47:31.039323 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_JAFFLE_SHOP_ANALYTICS, now test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa)
[0m13:47:31.040480 [info ] [Thread-4 (]: 4 of 9 START test source_not_null_jaffle_shop_raw_customers_id ................. [RUN]
[0m13:47:31.042263 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64'
[0m13:47:31.044239 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500'
[0m13:47:31.046252 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m13:47:31.052344 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.jaffle_shop.source_not_null_jaffle_shop_raw_customers_id.0848441319'
[0m13:47:31.053867 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m13:47:31.086992 [debug] [Thread-3 (]: Began compiling node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m13:47:31.106049 [debug] [Thread-4 (]: Began compiling node test.jaffle_shop.source_not_null_jaffle_shop_raw_customers_id.0848441319
[0m13:47:31.107938 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m13:47:31.116110 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
[0m13:47:31.124384 [debug] [Thread-3 (]: Writing injected SQL for node "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m13:47:31.132200 [debug] [Thread-4 (]: Writing injected SQL for node "test.jaffle_shop.source_not_null_jaffle_shop_raw_customers_id.0848441319"
[0m13:47:31.134401 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m13:47:31.135448 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m13:47:31.168836 [debug] [Thread-4 (]: Began executing node test.jaffle_shop.source_not_null_jaffle_shop_raw_customers_id.0848441319
[0m13:47:31.172996 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m13:47:31.174302 [debug] [Thread-2 (]: Writing runtime sql for node "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
[0m13:47:31.179504 [debug] [Thread-4 (]: Writing runtime sql for node "test.jaffle_shop.source_not_null_jaffle_shop_raw_customers_id.0848441319"
[0m13:47:31.180976 [debug] [Thread-3 (]: Began executing node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m13:47:31.185714 [debug] [Thread-3 (]: Writing runtime sql for node "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m13:47:31.187711 [debug] [Thread-1 (]: Using snowflake connection "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m13:47:31.190357 [debug] [Thread-2 (]: Using snowflake connection "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
[0m13:47:31.192484 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from JAFFLE_SHOP.ANALYTICS.stg_customers
where customer_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"} */
[0m13:47:31.200460 [debug] [Thread-3 (]: Using snowflake connection "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m13:47:31.202633 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from JAFFLE_SHOP.ANALYTICS.stg_orders
where order_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"} */
[0m13:47:31.205112 [debug] [Thread-4 (]: Using snowflake connection "test.jaffle_shop.source_not_null_jaffle_shop_raw_customers_id.0848441319"
[0m13:47:31.210408 [debug] [Thread-3 (]: On test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select customer_id as from_field
    from JAFFLE_SHOP.ANALYTICS.stg_orders
    where customer_id is not null
),

parent as (
    select customer_id as to_field
    from JAFFLE_SHOP.ANALYTICS.stg_customers
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"} */
[0m13:47:31.211411 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:47:31.215340 [debug] [Thread-4 (]: On test.jaffle_shop.source_not_null_jaffle_shop_raw_customers_id.0848441319: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id
from JAFFLE_SHOP.RAW.raw_customers
where id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.source_not_null_jaffle_shop_raw_customers_id.0848441319"} */
[0m13:47:31.218719 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:47:31.228339 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:47:31.358751 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.152 seconds
[0m13:47:31.370966 [info ] [Thread-1 (]: 1 of 9 PASS not_null_stg_customers_customer_id ................................. [[32mPASS[0m in 0.33s]
[0m13:47:31.373343 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m13:47:31.375520 [debug] [Thread-1 (]: Began running node test.jaffle_shop.source_not_null_jaffle_shop_raw_orders_id.48f68cd946
[0m13:47:31.382875 [info ] [Thread-1 (]: 5 of 9 START test source_not_null_jaffle_shop_raw_orders_id .................... [RUN]
[0m13:47:31.384407 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa, now test.jaffle_shop.source_not_null_jaffle_shop_raw_orders_id.48f68cd946)
[0m13:47:31.384945 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.source_not_null_jaffle_shop_raw_orders_id.48f68cd946
[0m13:47:31.389138 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.source_not_null_jaffle_shop_raw_orders_id.48f68cd946"
[0m13:47:31.391840 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.source_not_null_jaffle_shop_raw_orders_id.48f68cd946
[0m13:47:31.394165 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_shop.source_not_null_jaffle_shop_raw_orders_id.48f68cd946"
[0m13:47:31.395432 [debug] [Thread-1 (]: Using snowflake connection "test.jaffle_shop.source_not_null_jaffle_shop_raw_orders_id.48f68cd946"
[0m13:47:31.395784 [debug] [Thread-1 (]: On test.jaffle_shop.source_not_null_jaffle_shop_raw_orders_id.48f68cd946: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id
from JAFFLE_SHOP.RAW.raw_orders
where id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.source_not_null_jaffle_shop_raw_orders_id.48f68cd946"} */
[0m13:47:31.927064 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.531 seconds
[0m13:47:31.930401 [info ] [Thread-1 (]: 5 of 9 PASS source_not_null_jaffle_shop_raw_orders_id .......................... [[32mPASS[0m in 0.55s]
[0m13:47:31.931442 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.source_not_null_jaffle_shop_raw_orders_id.48f68cd946
[0m13:47:31.932156 [debug] [Thread-1 (]: Began running node test.jaffle_shop.source_unique_jaffle_shop_raw_customers_id.0505c14273
[0m13:47:31.932772 [info ] [Thread-1 (]: 6 of 9 START test source_unique_jaffle_shop_raw_customers_id ................... [RUN]
[0m13:47:31.933513 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.source_not_null_jaffle_shop_raw_orders_id.48f68cd946, now test.jaffle_shop.source_unique_jaffle_shop_raw_customers_id.0505c14273)
[0m13:47:31.934172 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.source_unique_jaffle_shop_raw_customers_id.0505c14273
[0m13:47:31.942174 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.source_unique_jaffle_shop_raw_customers_id.0505c14273"
[0m13:47:31.943756 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.source_unique_jaffle_shop_raw_customers_id.0505c14273
[0m13:47:31.946642 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_shop.source_unique_jaffle_shop_raw_customers_id.0505c14273"
[0m13:47:31.948524 [debug] [Thread-1 (]: Using snowflake connection "test.jaffle_shop.source_unique_jaffle_shop_raw_customers_id.0505c14273"
[0m13:47:31.949076 [debug] [Thread-1 (]: On test.jaffle_shop.source_unique_jaffle_shop_raw_customers_id.0505c14273: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    id as unique_field,
    count(*) as n_records

from JAFFLE_SHOP.RAW.raw_customers
where id is not null
group by id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.source_unique_jaffle_shop_raw_customers_id.0505c14273"} */
[0m13:47:31.995606 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.777 seconds
[0m13:47:31.998364 [info ] [Thread-3 (]: 3 of 9 PASS relationships_stg_orders_customer_id__customer_id__ref_stg_customers_  [[32mPASS[0m in 0.95s]
[0m13:47:31.999206 [debug] [Thread-3 (]: Finished running node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m13:47:31.999815 [debug] [Thread-3 (]: Began running node test.jaffle_shop.source_unique_jaffle_shop_raw_orders_id.21905c5ae2
[0m13:47:32.000385 [info ] [Thread-3 (]: 7 of 9 START test source_unique_jaffle_shop_raw_orders_id ...................... [RUN]
[0m13:47:32.000953 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500, now test.jaffle_shop.source_unique_jaffle_shop_raw_orders_id.21905c5ae2)
[0m13:47:32.001406 [debug] [Thread-3 (]: Began compiling node test.jaffle_shop.source_unique_jaffle_shop_raw_orders_id.21905c5ae2
[0m13:47:32.007972 [debug] [Thread-3 (]: Writing injected SQL for node "test.jaffle_shop.source_unique_jaffle_shop_raw_orders_id.21905c5ae2"
[0m13:47:32.009747 [debug] [Thread-3 (]: Began executing node test.jaffle_shop.source_unique_jaffle_shop_raw_orders_id.21905c5ae2
[0m13:47:32.012287 [debug] [Thread-3 (]: Writing runtime sql for node "test.jaffle_shop.source_unique_jaffle_shop_raw_orders_id.21905c5ae2"
[0m13:47:32.013895 [debug] [Thread-3 (]: Using snowflake connection "test.jaffle_shop.source_unique_jaffle_shop_raw_orders_id.21905c5ae2"
[0m13:47:32.014297 [debug] [Thread-3 (]: On test.jaffle_shop.source_unique_jaffle_shop_raw_orders_id.21905c5ae2: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    id as unique_field,
    count(*) as n_records

from JAFFLE_SHOP.RAW.raw_orders
where id is not null
group by id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.source_unique_jaffle_shop_raw_orders_id.21905c5ae2"} */
[0m13:47:32.068662 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.857 seconds
[0m13:47:32.071168 [info ] [Thread-2 (]: 2 of 9 PASS not_null_stg_orders_order_id ....................................... [[32mPASS[0m in 1.03s]
[0m13:47:32.072090 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m13:47:32.072752 [debug] [Thread-2 (]: Began running node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m13:47:32.073300 [info ] [Thread-2 (]: 8 of 9 START test unique_stg_customers_customer_id ............................. [RUN]
[0m13:47:32.073957 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64, now test.jaffle_shop.unique_stg_customers_customer_id.c7614daada)
[0m13:47:32.074483 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m13:47:32.079226 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
[0m13:47:32.080382 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m13:47:32.083205 [debug] [Thread-2 (]: Writing runtime sql for node "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
[0m13:47:32.084432 [debug] [Thread-2 (]: Using snowflake connection "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
[0m13:47:32.084854 [debug] [Thread-2 (]: On test.jaffle_shop.unique_stg_customers_customer_id.c7614daada: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from JAFFLE_SHOP.ANALYTICS.stg_customers
where customer_id is not null
group by customer_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"} */
[0m13:47:32.183039 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.955 seconds
[0m13:47:32.186552 [info ] [Thread-4 (]: 4 of 9 PASS source_not_null_jaffle_shop_raw_customers_id ....................... [[32mPASS[0m in 1.13s]
[0m13:47:32.187768 [debug] [Thread-4 (]: Finished running node test.jaffle_shop.source_not_null_jaffle_shop_raw_customers_id.0848441319
[0m13:47:32.188592 [debug] [Thread-4 (]: Began running node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m13:47:32.189423 [info ] [Thread-4 (]: 9 of 9 START test unique_stg_orders_order_id ................................... [RUN]
[0m13:47:32.190355 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.source_not_null_jaffle_shop_raw_customers_id.0848441319, now test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a)
[0m13:47:32.191064 [debug] [Thread-4 (]: Began compiling node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m13:47:32.197055 [debug] [Thread-4 (]: Writing injected SQL for node "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
[0m13:47:32.198703 [debug] [Thread-4 (]: Began executing node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m13:47:32.202433 [debug] [Thread-4 (]: Writing runtime sql for node "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
[0m13:47:32.204025 [debug] [Thread-4 (]: Using snowflake connection "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
[0m13:47:32.204523 [debug] [Thread-4 (]: On test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_id as unique_field,
    count(*) as n_records

from JAFFLE_SHOP.ANALYTICS.stg_orders
where order_id is not null
group by order_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"} */
[0m13:47:32.228109 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.143 seconds
[0m13:47:32.230634 [info ] [Thread-2 (]: 8 of 9 PASS unique_stg_customers_customer_id ................................... [[32mPASS[0m in 0.16s]
[0m13:47:32.231457 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m13:47:32.312716 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.363 seconds
[0m13:47:32.317546 [info ] [Thread-1 (]: 6 of 9 PASS source_unique_jaffle_shop_raw_customers_id ......................... [[32mPASS[0m in 0.38s]
[0m13:47:32.320127 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.source_unique_jaffle_shop_raw_customers_id.0505c14273
[0m13:47:32.330525 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.316 seconds
[0m13:47:32.334297 [info ] [Thread-3 (]: 7 of 9 PASS source_unique_jaffle_shop_raw_orders_id ............................ [[32mPASS[0m in 0.33s]
[0m13:47:32.335590 [debug] [Thread-3 (]: Finished running node test.jaffle_shop.source_unique_jaffle_shop_raw_orders_id.21905c5ae2
[0m13:47:32.389818 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.184 seconds
[0m13:47:32.394442 [info ] [Thread-4 (]: 9 of 9 PASS unique_stg_orders_order_id ......................................... [[32mPASS[0m in 0.20s]
[0m13:47:32.396250 [debug] [Thread-4 (]: Finished running node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m13:47:32.399522 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:47:32.400384 [debug] [MainThread]: Connection 'test.jaffle_shop.source_unique_jaffle_shop_raw_customers_id.0505c14273' was left open.
[0m13:47:32.401493 [debug] [MainThread]: On test.jaffle_shop.source_unique_jaffle_shop_raw_customers_id.0505c14273: Close
[0m13:47:32.496872 [debug] [MainThread]: Connection 'test.jaffle_shop.unique_stg_customers_customer_id.c7614daada' was left open.
[0m13:47:32.497956 [debug] [MainThread]: On test.jaffle_shop.unique_stg_customers_customer_id.c7614daada: Close
[0m13:47:32.661544 [debug] [MainThread]: Connection 'test.jaffle_shop.source_unique_jaffle_shop_raw_orders_id.21905c5ae2' was left open.
[0m13:47:32.662976 [debug] [MainThread]: On test.jaffle_shop.source_unique_jaffle_shop_raw_orders_id.21905c5ae2: Close
[0m13:47:32.760407 [debug] [MainThread]: Connection 'test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a' was left open.
[0m13:47:32.761070 [debug] [MainThread]: On test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a: Close
[0m13:47:32.863108 [info ] [MainThread]: 
[0m13:47:32.864824 [info ] [MainThread]: Finished running 9 data tests in 0 hours 0 minutes and 3.75 seconds (3.75s).
[0m13:47:32.868460 [debug] [MainThread]: Command end result
[0m13:47:32.917301 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m13:47:32.919639 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m13:47:32.925224 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/target/run_results.json
[0m13:47:32.925536 [info ] [MainThread]: 
[0m13:47:32.925897 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:47:32.926365 [info ] [MainThread]: 
[0m13:47:32.926834 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=9
[0m13:47:32.928013 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 5.259116, "process_in_blocks": "0", "process_kernel_time": 0.496908, "process_mem_max_rss": "244924", "process_out_blocks": "4272", "process_user_time": 4.248618}
[0m13:47:32.928532 [debug] [MainThread]: Command `dbt test` succeeded at 13:47:32.928445 after 5.26 seconds
[0m13:47:32.928970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6345eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6345460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89d8fe30>]}
[0m13:47:32.929439 [debug] [MainThread]: Flushing usage events
[0m13:47:34.408263 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:42:24.978200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa88ad1f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa83c95b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8fd2360>]}


============================== 17:42:24.984615 | 2a6c04f6-b6e7-4a8f-9e51-4b9b0746abbd ==============================
[0m17:42:24.984615 [info ] [MainThread]: Running with dbt=1.10.13
[0m17:42:24.985166 [debug] [MainThread]: running dbt with arguments {'empty': 'None', 'use_experimental_parser': 'False', 'version_check': 'True', 'fail_fast': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'indirect_selection': 'eager', 'target_path': 'None', 'debug': 'False', 'quiet': 'False', 'cache_selected_only': 'False', 'log_format': 'default', 'profiles_dir': '/opt/airflow/dbt', 'invocation_command': 'dbt run-operation generate_source --args {"schema_name": "RAW", "database_name": "JAFFLE_SHOP"}', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'write_json': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'use_colors': 'True', 'printer_width': '80', 'no_print': 'None'}
[0m17:42:25.929866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2a6c04f6-b6e7-4a8f-9e51-4b9b0746abbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d59adb0>]}
[0m17:42:25.968673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2a6c04f6-b6e7-4a8f-9e51-4b9b0746abbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8e40da0>]}
[0m17:42:25.969634 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m17:42:26.101761 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m17:42:26.180024 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m17:42:26.180517 [debug] [MainThread]: previous checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, current checksum: 87546e06832e1286bf2d49b8b108dd3f58da97cbfca650a1f147ec4aedfbbf25
[0m17:42:26.180909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '2a6c04f6-b6e7-4a8f-9e51-4b9b0746abbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa88ad9d0>]}
[0m17:42:27.514073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2a6c04f6-b6e7-4a8f-9e51-4b9b0746abbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8bb98620>]}
[0m17:42:27.612485 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m17:42:27.616718 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m17:42:27.641285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2a6c04f6-b6e7-4a8f-9e51-4b9b0746abbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c320470>]}
[0m17:42:27.641891 [info ] [MainThread]: Found 3 models, 9 data tests, 6 sources, 631 macros
[0m17:42:27.642234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2a6c04f6-b6e7-4a8f-9e51-4b9b0746abbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c8113d0>]}
[0m17:42:27.643021 [debug] [MainThread]: Acquiring new snowflake connection 'macro_generate_source'
[0m17:42:27.731630 [debug] [MainThread]: Using snowflake connection "macro_generate_source"
[0m17:42:27.732224 [debug] [MainThread]: On macro_generate_source: select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from JAFFLE_SHOP.information_schema.tables
        where table_schema ilike 'RAW'
        and table_name ilike '%'
        and table_name not ilike ''
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "macro_generate_source"} */
[0m17:42:27.732717 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:42:31.072533 [debug] [MainThread]: SQL status: SUCCESS 0 in 3.335 seconds
[0m17:42:31.091071 [info ] [MainThread]: version: 2

sources:
  - name: raw
    tables:
[0m17:42:31.140560 [debug] [MainThread]: Wrote artifact RunResultsArtifact to /opt/airflow/dbt/target/run_results.json
[0m17:42:31.146698 [debug] [MainThread]: Resource report: {"command_name": "run-operation", "command_success": true, "command_wall_clock_time": 6.2026525, "process_in_blocks": "35856", "process_kernel_time": 1.010448, "process_mem_max_rss": "235000", "process_out_blocks": "5290", "process_user_time": 5.078748}
[0m17:42:31.150183 [debug] [MainThread]: Command `dbt run-operation` succeeded at 17:42:31.149632 after 6.21 seconds
[0m17:42:31.153855 [debug] [MainThread]: Connection 'macro_generate_source' was left open.
[0m17:42:31.155857 [debug] [MainThread]: On macro_generate_source: Close
[0m17:42:31.511374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8940740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b7139b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b702090>]}
[0m17:42:31.515540 [debug] [MainThread]: Flushing usage events
[0m17:42:32.140942 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:57:41.266530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff857860c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff850a5d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff850a6c00>]}


============================== 19:57:41.273162 | 003f3d36-e1f7-4e6c-aa04-a95a7e2bfd50 ==============================
[0m19:57:41.273162 [info ] [MainThread]: Running with dbt=1.10.13
[0m19:57:41.273629 [debug] [MainThread]: running dbt with arguments {'log_path': '/opt/airflow/dbt/logs', 'introspect': 'True', 'debug': 'False', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'static_parser': 'True', 'fail_fast': 'False', 'partial_parse': 'True', 'target_path': 'None', 'printer_width': '80', 'no_print': 'None', 'quiet': 'False', 'log_cache_events': 'False', 'empty': 'False', 'use_colors': 'True', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'profiles_dir': '/opt/airflow/dbt', 'invocation_command': 'dbt run --select int_orders_pivoted', 'cache_selected_only': 'False', 'log_format': 'default'}
[0m19:57:42.186719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '003f3d36-e1f7-4e6c-aa04-a95a7e2bfd50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff693e6b40>]}
[0m19:57:42.221129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '003f3d36-e1f7-4e6c-aa04-a95a7e2bfd50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff69989130>]}
[0m19:57:42.221678 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m19:57:42.308410 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m19:57:42.419352 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 4 files changed.
[0m19:57:42.419788 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://models/staging/stg_payments.sql
[0m19:57:42.420005 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://models/intermediate/int_orders_pivoted.sql
[0m19:57:42.420435 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://models/staging/_src_jaffle_shop.yml
[0m19:57:42.420669 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://models/staging/stg_customers.sql
[0m19:57:42.420873 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://models/staging/stg_orders.sql
[0m19:57:42.421062 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://models/marts/marketing/dim_customers.sql
[0m19:57:42.783387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '003f3d36-e1f7-4e6c-aa04-a95a7e2bfd50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff848c8ec0>]}
[0m19:57:42.839676 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m19:57:42.841141 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m19:57:42.857489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '003f3d36-e1f7-4e6c-aa04-a95a7e2bfd50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff68b6ea80>]}
[0m19:57:42.857838 [info ] [MainThread]: Found 5 models, 9 data tests, 3 sources, 631 macros
[0m19:57:42.858120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '003f3d36-e1f7-4e6c-aa04-a95a7e2bfd50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff68b50b30>]}
[0m19:57:42.859167 [info ] [MainThread]: 
[0m19:57:42.859420 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:57:42.859683 [info ] [MainThread]: 
[0m19:57:42.860116 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:57:42.860805 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JAFFLE_SHOP'
[0m19:57:42.896891 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP"
[0m19:57:42.897270 [debug] [ThreadPool]: On list_JAFFLE_SHOP: show terse schemas in database JAFFLE_SHOP
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_JAFFLE_SHOP"} */
[0m19:57:42.897510 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:57:46.282907 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 3.385 seconds
[0m19:57:46.298623 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_JAFFLE_SHOP, now list_JAFFLE_SHOP_ANALYTICS)
[0m19:57:46.317167 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP_ANALYTICS"
[0m19:57:46.317746 [debug] [ThreadPool]: On list_JAFFLE_SHOP_ANALYTICS: show objects in JAFFLE_SHOP.ANALYTICS
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_JAFFLE_SHOP_ANALYTICS"} */;
[0m19:57:46.587738 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.269 seconds
[0m19:57:46.596738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '003f3d36-e1f7-4e6c-aa04-a95a7e2bfd50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff68792810>]}
[0m19:57:46.606610 [debug] [Thread-1 (]: Began running node model.jaffle_shop.int_orders_pivoted
[0m19:57:46.607758 [info ] [Thread-1 (]: 1 of 1 START sql view model ANALYTICS.int_orders_pivoted ....................... [RUN]
[0m19:57:46.608857 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_JAFFLE_SHOP_ANALYTICS, now model.jaffle_shop.int_orders_pivoted)
[0m19:57:46.609626 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.int_orders_pivoted
[0m19:57:46.621560 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.int_orders_pivoted"
[0m19:57:46.624897 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.int_orders_pivoted
[0m19:57:46.657579 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.int_orders_pivoted"
[0m19:57:46.659384 [debug] [Thread-1 (]: Using snowflake connection "model.jaffle_shop.int_orders_pivoted"
[0m19:57:46.659778 [debug] [Thread-1 (]: On model.jaffle_shop.int_orders_pivoted: create or replace   view JAFFLE_SHOP.ANALYTICS.int_orders_pivoted
  
  
  
  
  as (
    with 
paid as (
    select
        *
    from JAFFLE_SHOP.ANALYTICS.stg_payments
    where status ='success'
),
pivoted as (
    select
        *
    from paid
)
select 
    *
from pivoted
  )
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.int_orders_pivoted"} */;
[0m19:57:46.848664 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bfe30d-0305-5acf-0004-0c260004fe5e
[0m19:57:46.849814 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 12 at position 10
invalid identifier 'STATUS'
[0m19:57:46.855592 [debug] [Thread-1 (]: Database Error in model int_orders_pivoted (models/intermediate/int_orders_pivoted.sql)
  000904 (42000): SQL compilation error: error line 12 at position 10
  invalid identifier 'STATUS'
  compiled code at target/run/jaffle_shop/models/intermediate/int_orders_pivoted.sql
[0m19:57:46.859101 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '003f3d36-e1f7-4e6c-aa04-a95a7e2bfd50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff603aa510>]}
[0m19:57:46.860128 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model ANALYTICS.int_orders_pivoted .............. [[31mERROR[0m in 0.25s]
[0m19:57:46.861167 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.int_orders_pivoted
[0m19:57:46.862053 [debug] [Thread-7 (]: Marking all children of 'model.jaffle_shop.int_orders_pivoted' to be skipped because of status 'error'.  Reason: Database Error in model int_orders_pivoted (models/intermediate/int_orders_pivoted.sql)
  000904 (42000): SQL compilation error: error line 12 at position 10
  invalid identifier 'STATUS'
  compiled code at target/run/jaffle_shop/models/intermediate/int_orders_pivoted.sql.
[0m19:57:46.865327 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:57:46.865850 [debug] [MainThread]: Connection 'model.jaffle_shop.int_orders_pivoted' was left open.
[0m19:57:46.866321 [debug] [MainThread]: On model.jaffle_shop.int_orders_pivoted: Close
[0m19:57:47.842303 [info ] [MainThread]: 
[0m19:57:47.844116 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 4.98 seconds (4.98s).
[0m19:57:47.846093 [debug] [MainThread]: Command end result
[0m19:57:47.889557 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m19:57:47.892279 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m19:57:47.897897 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/target/run_results.json
[0m19:57:47.898289 [info ] [MainThread]: 
[0m19:57:47.898847 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m19:57:47.899283 [info ] [MainThread]: 
[0m19:57:47.900100 [error] [MainThread]: [31mFailure in model int_orders_pivoted (models/intermediate/int_orders_pivoted.sql)[0m
[0m19:57:47.900600 [error] [MainThread]:   Database Error in model int_orders_pivoted (models/intermediate/int_orders_pivoted.sql)
  000904 (42000): SQL compilation error: error line 12 at position 10
  invalid identifier 'STATUS'
  compiled code at target/run/jaffle_shop/models/intermediate/int_orders_pivoted.sql
[0m19:57:47.901284 [info ] [MainThread]: 
[0m19:57:47.901798 [info ] [MainThread]:   compiled code at target/compiled/jaffle_shop/models/intermediate/int_orders_pivoted.sql
[0m19:57:47.902292 [info ] [MainThread]: 
[0m19:57:47.902741 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m19:57:47.904540 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 6.669952, "process_in_blocks": "49600", "process_kernel_time": 0.730845, "process_mem_max_rss": "236820", "process_out_blocks": "4212", "process_user_time": 3.45227}
[0m19:57:47.905147 [debug] [MainThread]: Command `dbt run` failed at 19:57:47.905063 after 6.67 seconds
[0m19:57:47.905696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff68730920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff68141c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff690a7ef0>]}
[0m19:57:47.906108 [debug] [MainThread]: Flushing usage events
[0m19:57:49.292917 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:58:12.314097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa54f7470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa73451f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4e74b00>]}


============================== 19:58:12.319751 | af63ce6a-e40f-46a1-88ed-52ddeee03ab7 ==============================
[0m19:58:12.319751 [info ] [MainThread]: Running with dbt=1.10.13
[0m19:58:12.320178 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'introspect': 'True', 'partial_parse': 'True', 'quiet': 'False', 'log_cache_events': 'False', 'log_path': '/opt/airflow/dbt/logs', 'use_experimental_parser': 'False', 'send_anonymous_usage_stats': 'True', 'invocation_command': 'dbt run --select int_orders_pivoted', 'empty': 'False', 'indirect_selection': 'eager', 'static_parser': 'True', 'no_print': 'None', 'printer_width': '80', 'write_json': 'True', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_colors': 'True', 'cache_selected_only': 'False', 'fail_fast': 'False', 'target_path': 'None', 'debug': 'False'}
[0m19:58:12.869213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'af63ce6a-e40f-46a1-88ed-52ddeee03ab7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff896c8770>]}
[0m19:58:12.904330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'af63ce6a-e40f-46a1-88ed-52ddeee03ab7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89b02c60>]}
[0m19:58:12.904920 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m19:58:12.978208 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m19:58:13.078132 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:58:13.078672 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://models/intermediate/int_orders_pivoted.sql
[0m19:58:13.224734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'af63ce6a-e40f-46a1-88ed-52ddeee03ab7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88ba7b00>]}
[0m19:58:13.337744 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m19:58:13.339173 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m19:58:13.353353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'af63ce6a-e40f-46a1-88ed-52ddeee03ab7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88ecc9e0>]}
[0m19:58:13.353719 [info ] [MainThread]: Found 5 models, 9 data tests, 3 sources, 631 macros
[0m19:58:13.353978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'af63ce6a-e40f-46a1-88ed-52ddeee03ab7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88b56810>]}
[0m19:58:13.354930 [info ] [MainThread]: 
[0m19:58:13.355215 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:58:13.355544 [info ] [MainThread]: 
[0m19:58:13.355994 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:58:13.356679 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JAFFLE_SHOP'
[0m19:58:13.383319 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP"
[0m19:58:13.383693 [debug] [ThreadPool]: On list_JAFFLE_SHOP: show terse schemas in database JAFFLE_SHOP
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_JAFFLE_SHOP"} */
[0m19:58:13.383891 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:58:16.322263 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2.938 seconds
[0m19:58:16.336599 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_JAFFLE_SHOP, now list_JAFFLE_SHOP_ANALYTICS)
[0m19:58:16.353743 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP_ANALYTICS"
[0m19:58:16.354425 [debug] [ThreadPool]: On list_JAFFLE_SHOP_ANALYTICS: show objects in JAFFLE_SHOP.ANALYTICS
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_JAFFLE_SHOP_ANALYTICS"} */;
[0m19:58:16.494564 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.139 seconds
[0m19:58:16.540828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'af63ce6a-e40f-46a1-88ed-52ddeee03ab7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88b68260>]}
[0m19:58:16.565687 [debug] [Thread-1 (]: Began running node model.jaffle_shop.int_orders_pivoted
[0m19:58:16.567555 [info ] [Thread-1 (]: 1 of 1 START sql view model ANALYTICS.int_orders_pivoted ....................... [RUN]
[0m19:58:16.568888 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_JAFFLE_SHOP_ANALYTICS, now model.jaffle_shop.int_orders_pivoted)
[0m19:58:16.570519 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.int_orders_pivoted
[0m19:58:16.613680 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.int_orders_pivoted"
[0m19:58:16.622505 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.int_orders_pivoted
[0m19:58:16.684407 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.int_orders_pivoted"
[0m19:58:16.688679 [debug] [Thread-1 (]: Using snowflake connection "model.jaffle_shop.int_orders_pivoted"
[0m19:58:16.689716 [debug] [Thread-1 (]: On model.jaffle_shop.int_orders_pivoted: create or replace   view JAFFLE_SHOP.ANALYTICS.int_orders_pivoted
  
  
  
  
  as (
    with 
paid as (
    select
        *
    from JAFFLE_SHOP.ANALYTICS.stg_orders
    where status ='success'
),
pivoted as (
    select
        *
    from paid
)
select 
    *
from pivoted
  )
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.int_orders_pivoted"} */;
[0m19:58:16.936623 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.246 seconds
[0m19:58:16.964866 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af63ce6a-e40f-46a1-88ed-52ddeee03ab7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5bd4dd0>]}
[0m19:58:16.966078 [info ] [Thread-1 (]: 1 of 1 OK created sql view model ANALYTICS.int_orders_pivoted .................. [[32mSUCCESS 1[0m in 0.39s]
[0m19:58:16.967254 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.int_orders_pivoted
[0m19:58:16.970244 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:58:16.970659 [debug] [MainThread]: Connection 'model.jaffle_shop.int_orders_pivoted' was left open.
[0m19:58:16.971014 [debug] [MainThread]: On model.jaffle_shop.int_orders_pivoted: Close
[0m19:58:18.081010 [info ] [MainThread]: 
[0m19:58:18.082922 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 4.72 seconds (4.72s).
[0m19:58:18.089769 [debug] [MainThread]: Command end result
[0m19:58:18.138959 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m19:58:18.144273 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m19:58:18.153168 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/target/run_results.json
[0m19:58:18.153652 [info ] [MainThread]: 
[0m19:58:18.154415 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:58:18.154837 [info ] [MainThread]: 
[0m19:58:18.155310 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m19:58:18.159026 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.878424, "process_in_blocks": "0", "process_kernel_time": 0.414493, "process_mem_max_rss": "233424", "process_out_blocks": "4215", "process_user_time": 3.285914}
[0m19:58:18.160099 [debug] [MainThread]: Command `dbt run` succeeded at 19:58:18.159994 after 5.88 seconds
[0m19:58:18.161452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4e74b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4cf0f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9bb7140>]}
[0m19:58:18.162517 [debug] [MainThread]: Flushing usage events
[0m19:58:19.674277 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:00:52.477194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8adb0e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a70a540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89e13e60>]}


============================== 20:00:52.483547 | 1c2af184-4277-4bf9-b698-8bce97a3f1df ==============================
[0m20:00:52.483547 [info ] [MainThread]: Running with dbt=1.10.13
[0m20:00:52.484083 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'empty': 'False', 'target_path': 'None', 'debug': 'False', 'quiet': 'False', 'no_print': 'None', 'version_check': 'True', 'introspect': 'True', 'write_json': 'True', 'invocation_command': 'dbt run --select int_orders_pivoted', 'indirect_selection': 'eager', 'log_format': 'default', 'cache_selected_only': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'log_path': '/opt/airflow/dbt/logs', 'partial_parse': 'True', 'profiles_dir': '/opt/airflow/dbt', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'use_experimental_parser': 'False'}
[0m20:00:53.205009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1c2af184-4277-4bf9-b698-8bce97a3f1df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6e370ef0>]}
[0m20:00:53.246802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1c2af184-4277-4bf9-b698-8bce97a3f1df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6e31b2f0>]}
[0m20:00:53.247501 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m20:00:53.322618 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m20:00:53.463966 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:00:53.464514 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://models/intermediate/int_orders_pivoted.sql
[0m20:00:53.618421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1c2af184-4277-4bf9-b698-8bce97a3f1df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6ddbbd70>]}
[0m20:00:53.732868 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m20:00:53.734860 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m20:00:53.751832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1c2af184-4277-4bf9-b698-8bce97a3f1df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ba26d80>]}
[0m20:00:53.752206 [info ] [MainThread]: Found 5 models, 9 data tests, 3 sources, 631 macros
[0m20:00:53.752479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1c2af184-4277-4bf9-b698-8bce97a3f1df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6d94bfe0>]}
[0m20:00:53.753801 [info ] [MainThread]: 
[0m20:00:53.754172 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:00:53.754462 [info ] [MainThread]: 
[0m20:00:53.754954 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:00:53.755736 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JAFFLE_SHOP'
[0m20:00:53.788396 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP"
[0m20:00:53.788824 [debug] [ThreadPool]: On list_JAFFLE_SHOP: show terse schemas in database JAFFLE_SHOP
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_JAFFLE_SHOP"} */
[0m20:00:53.789060 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:00:56.662690 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2.874 seconds
[0m20:00:56.676398 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_JAFFLE_SHOP, now list_JAFFLE_SHOP_ANALYTICS)
[0m20:00:56.687902 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP_ANALYTICS"
[0m20:00:56.688383 [debug] [ThreadPool]: On list_JAFFLE_SHOP_ANALYTICS: show objects in JAFFLE_SHOP.ANALYTICS
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_JAFFLE_SHOP_ANALYTICS"} */;
[0m20:00:57.073134 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.384 seconds
[0m20:00:57.082515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1c2af184-4277-4bf9-b698-8bce97a3f1df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6d94a750>]}
[0m20:00:57.092127 [debug] [Thread-1 (]: Began running node model.jaffle_shop.int_orders_pivoted
[0m20:00:57.093397 [info ] [Thread-1 (]: 1 of 1 START sql view model ANALYTICS.int_orders_pivoted ....................... [RUN]
[0m20:00:57.094363 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_JAFFLE_SHOP_ANALYTICS, now model.jaffle_shop.int_orders_pivoted)
[0m20:00:57.095178 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.int_orders_pivoted
[0m20:00:57.107224 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.int_orders_pivoted"
[0m20:00:57.115870 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.int_orders_pivoted
[0m20:00:57.146952 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.int_orders_pivoted"
[0m20:00:57.148619 [debug] [Thread-1 (]: Using snowflake connection "model.jaffle_shop.int_orders_pivoted"
[0m20:00:57.148970 [debug] [Thread-1 (]: On model.jaffle_shop.int_orders_pivoted: create or replace   view JAFFLE_SHOP.ANALYTICS.int_orders_pivoted
  
  
  
  
  as (
    with 
paid as (
    select
        *
    from JAFFLE_SHOP.ANALYTICS.stg_orders
    where status ='completed'
),
pivoted as (
    select
        *
    from paid
)
select 
    *
from pivoted
  )
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.int_orders_pivoted"} */;
[0m20:00:57.405382 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.256 seconds
[0m20:00:57.434276 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1c2af184-4277-4bf9-b698-8bce97a3f1df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8aad4c80>]}
[0m20:00:57.435218 [info ] [Thread-1 (]: 1 of 1 OK created sql view model ANALYTICS.int_orders_pivoted .................. [[32mSUCCESS 1[0m in 0.34s]
[0m20:00:57.436205 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.int_orders_pivoted
[0m20:00:57.438023 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:00:57.438321 [debug] [MainThread]: Connection 'model.jaffle_shop.int_orders_pivoted' was left open.
[0m20:00:57.438560 [debug] [MainThread]: On model.jaffle_shop.int_orders_pivoted: Close
[0m20:00:58.581098 [info ] [MainThread]: 
[0m20:00:58.582096 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 4.83 seconds (4.83s).
[0m20:00:58.583264 [debug] [MainThread]: Command end result
[0m20:00:58.620246 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m20:00:58.622888 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m20:00:58.635270 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/target/run_results.json
[0m20:00:58.635761 [info ] [MainThread]: 
[0m20:00:58.636367 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:00:58.636655 [info ] [MainThread]: 
[0m20:00:58.637119 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m20:00:58.639467 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.1972857, "process_in_blocks": "0", "process_kernel_time": 0.642197, "process_mem_max_rss": "233612", "process_out_blocks": "4215", "process_user_time": 3.438832}
[0m20:00:58.640270 [debug] [MainThread]: Command `dbt run` succeeded at 20:00:58.640143 after 6.20 seconds
[0m20:00:58.640946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a34eba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a34f440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e95b110>]}
[0m20:00:58.641282 [debug] [MainThread]: Flushing usage events
[0m20:01:00.026940 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:14:44.220582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff917ce510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90b46a20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90668c20>]}


============================== 20:14:44.226979 | 1b1c5d95-aca0-4fb5-94aa-99cb7220e11f ==============================
[0m20:14:44.226979 [info ] [MainThread]: Running with dbt=1.10.13
[0m20:14:44.227518 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '/opt/airflow/dbt', 'quiet': 'False', 'use_experimental_parser': 'False', 'empty': 'False', 'indirect_selection': 'eager', 'log_format': 'default', 'cache_selected_only': 'False', 'version_check': 'True', 'use_colors': 'True', 'partial_parse': 'True', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --select int_orders_pivoted', 'warn_error': 'None', 'write_json': 'True', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'no_print': 'None', 'fail_fast': 'False', 'log_cache_events': 'False', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'target_path': 'None'}
[0m20:14:44.800674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1b1c5d95-aca0-4fb5-94aa-99cb7220e11f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff74f66d20>]}
[0m20:14:44.835535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1b1c5d95-aca0-4fb5-94aa-99cb7220e11f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff75160b00>]}
[0m20:14:44.836147 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m20:14:44.964588 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m20:14:45.127933 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:14:45.128464 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://models/intermediate/int_orders_pivoted.sql
[0m20:14:45.284871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1b1c5d95-aca0-4fb5-94aa-99cb7220e11f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff74487ce0>]}
[0m20:14:45.396147 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m20:14:45.397609 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m20:14:45.411704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1b1c5d95-aca0-4fb5-94aa-99cb7220e11f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff744e7d10>]}
[0m20:14:45.412077 [info ] [MainThread]: Found 5 models, 9 data tests, 3 sources, 631 macros
[0m20:14:45.412380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1b1c5d95-aca0-4fb5-94aa-99cb7220e11f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff74520500>]}
[0m20:14:45.413363 [info ] [MainThread]: 
[0m20:14:45.413671 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:14:45.413962 [info ] [MainThread]: 
[0m20:14:45.414460 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:14:45.415148 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JAFFLE_SHOP'
[0m20:14:45.443362 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP"
[0m20:14:45.443763 [debug] [ThreadPool]: On list_JAFFLE_SHOP: show terse schemas in database JAFFLE_SHOP
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_JAFFLE_SHOP"} */
[0m20:14:45.444012 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:14:47.295796 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.852 seconds
[0m20:14:47.306786 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_JAFFLE_SHOP, now list_JAFFLE_SHOP_ANALYTICS)
[0m20:14:47.323500 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP_ANALYTICS"
[0m20:14:47.324160 [debug] [ThreadPool]: On list_JAFFLE_SHOP_ANALYTICS: show objects in JAFFLE_SHOP.ANALYTICS
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_JAFFLE_SHOP_ANALYTICS"} */;
[0m20:14:47.479529 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.155 seconds
[0m20:14:47.486003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1b1c5d95-aca0-4fb5-94aa-99cb7220e11f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff744e7e60>]}
[0m20:14:47.493284 [debug] [Thread-1 (]: Began running node model.jaffle_shop.int_orders_pivoted
[0m20:14:47.494344 [info ] [Thread-1 (]: 1 of 1 START sql view model ANALYTICS.int_orders_pivoted ....................... [RUN]
[0m20:14:47.495265 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_JAFFLE_SHOP_ANALYTICS, now model.jaffle_shop.int_orders_pivoted)
[0m20:14:47.496182 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.int_orders_pivoted
[0m20:14:47.511938 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.int_orders_pivoted"
[0m20:14:47.513838 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.int_orders_pivoted
[0m20:14:47.543289 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.int_orders_pivoted"
[0m20:14:47.544989 [debug] [Thread-1 (]: Using snowflake connection "model.jaffle_shop.int_orders_pivoted"
[0m20:14:47.545387 [debug] [Thread-1 (]: On model.jaffle_shop.int_orders_pivoted: create or replace   view JAFFLE_SHOP.ANALYTICS.int_orders_pivoted
  
  
  
  
  as (
    with 
completed as (
    select
        p.order_id
        ,p.payment_method
        ,p.amount
    from JAFFLE_SHOP.ANALYTICS.stg_payments as p 
    left join JAFFLE_SHOP.ANALYTICS.stg_orders as o using (order_id)
    where status ='completed'
),
pivoted as (
    select
        order_id,
        
        
            sum(case when payment_method = 'bank_transfer' then amount else 0) as bank_transfer_amount,
        
            sum(case when payment_method = 'credit_card' then amount else 0) as credit_card_amount,
        
            sum(case when payment_method = 'coupon' then amount else 0) as coupon_amount,
        
            sum(case when payment_method = 'gift_card' then amount else 0) as gift_card_amount,
        
    from completed
)
select 
    *
from pivoted
  )
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.int_orders_pivoted"} */;
[0m20:14:48.348297 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bfe31e-0305-5ad3-0004-0c26000538f6
[0m20:14:48.349638 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 22 at position 77 unexpected ')'.
syntax error line 24 at position 75 unexpected ')'.
syntax error line 26 at position 70 unexpected ')'.
syntax error line 28 at position 73 unexpected ')'.
[0m20:14:48.355069 [debug] [Thread-1 (]: Database Error in model int_orders_pivoted (models/intermediate/int_orders_pivoted.sql)
  001003 (42000): SQL compilation error:
  syntax error line 22 at position 77 unexpected ')'.
  syntax error line 24 at position 75 unexpected ')'.
  syntax error line 26 at position 70 unexpected ')'.
  syntax error line 28 at position 73 unexpected ')'.
  compiled code at target/run/jaffle_shop/models/intermediate/int_orders_pivoted.sql
[0m20:14:48.357673 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b1c5d95-aca0-4fb5-94aa-99cb7220e11f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff71072ff0>]}
[0m20:14:48.358827 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model ANALYTICS.int_orders_pivoted .............. [[31mERROR[0m in 0.86s]
[0m20:14:48.359780 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.int_orders_pivoted
[0m20:14:48.360606 [debug] [Thread-7 (]: Marking all children of 'model.jaffle_shop.int_orders_pivoted' to be skipped because of status 'error'.  Reason: Database Error in model int_orders_pivoted (models/intermediate/int_orders_pivoted.sql)
  001003 (42000): SQL compilation error:
  syntax error line 22 at position 77 unexpected ')'.
  syntax error line 24 at position 75 unexpected ')'.
  syntax error line 26 at position 70 unexpected ')'.
  syntax error line 28 at position 73 unexpected ')'.
  compiled code at target/run/jaffle_shop/models/intermediate/int_orders_pivoted.sql.
[0m20:14:48.363280 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:14:48.363772 [debug] [MainThread]: Connection 'model.jaffle_shop.int_orders_pivoted' was left open.
[0m20:14:48.364200 [debug] [MainThread]: On model.jaffle_shop.int_orders_pivoted: Close
[0m20:14:48.555774 [info ] [MainThread]: 
[0m20:14:48.556540 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.14 seconds (3.14s).
[0m20:14:48.557741 [debug] [MainThread]: Command end result
[0m20:14:48.597513 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m20:14:48.599327 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m20:14:48.603926 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/target/run_results.json
[0m20:14:48.604269 [info ] [MainThread]: 
[0m20:14:48.604607 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m20:14:48.605018 [info ] [MainThread]: 
[0m20:14:48.605475 [error] [MainThread]: [31mFailure in model int_orders_pivoted (models/intermediate/int_orders_pivoted.sql)[0m
[0m20:14:48.605790 [error] [MainThread]:   Database Error in model int_orders_pivoted (models/intermediate/int_orders_pivoted.sql)
  001003 (42000): SQL compilation error:
  syntax error line 22 at position 77 unexpected ')'.
  syntax error line 24 at position 75 unexpected ')'.
  syntax error line 26 at position 70 unexpected ')'.
  syntax error line 28 at position 73 unexpected ')'.
  compiled code at target/run/jaffle_shop/models/intermediate/int_orders_pivoted.sql
[0m20:14:48.606071 [info ] [MainThread]: 
[0m20:14:48.606390 [info ] [MainThread]:   compiled code at target/compiled/jaffle_shop/models/intermediate/int_orders_pivoted.sql
[0m20:14:48.606693 [info ] [MainThread]: 
[0m20:14:48.607100 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m20:14:48.608287 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 4.42164, "process_in_blocks": "0", "process_kernel_time": 0.461847, "process_mem_max_rss": "233780", "process_out_blocks": "4230", "process_user_time": 3.160488}
[0m20:14:48.608654 [debug] [MainThread]: Command `dbt run` failed at 20:14:48.608578 after 4.42 seconds
[0m20:14:48.609015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90565ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90cbb020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff904db8f0>]}
[0m20:14:48.609270 [debug] [MainThread]: Flushing usage events
[0m20:14:49.998301 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:18:50.558760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97e06de0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97645790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff976475f0>]}


============================== 20:18:50.564182 | 2b228f2b-661b-4622-8304-2f68ac98bb96 ==============================
[0m20:18:50.564182 [info ] [MainThread]: Running with dbt=1.10.13
[0m20:18:50.564699 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'cache_selected_only': 'False', 'quiet': 'False', 'empty': 'False', 'warn_error': 'None', 'target_path': 'None', 'log_path': '/opt/airflow/dbt/logs', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'log_cache_events': 'False', 'log_format': 'default', 'introspect': 'True', 'indirect_selection': 'eager', 'use_colors': 'True', 'printer_width': '80', 'use_experimental_parser': 'False', 'static_parser': 'True', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'invocation_command': 'dbt run --select int_orders_pivoted', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False'}
[0m20:18:51.129864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2b228f2b-661b-4622-8304-2f68ac98bb96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b71bcb0>]}
[0m20:18:51.167352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2b228f2b-661b-4622-8304-2f68ac98bb96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b756090>]}
[0m20:18:51.168233 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m20:18:51.246158 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m20:18:51.345530 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:18:51.346019 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://models/intermediate/int_orders_pivoted.sql
[0m20:18:51.497171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2b228f2b-661b-4622-8304-2f68ac98bb96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7adff920>]}
[0m20:18:51.605973 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m20:18:51.607467 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m20:18:51.622313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2b228f2b-661b-4622-8304-2f68ac98bb96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ae5f4a0>]}
[0m20:18:51.622718 [info ] [MainThread]: Found 5 models, 9 data tests, 3 sources, 631 macros
[0m20:18:51.623034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2b228f2b-661b-4622-8304-2f68ac98bb96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ae5ff50>]}
[0m20:18:51.624092 [info ] [MainThread]: 
[0m20:18:51.624378 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:18:51.624676 [info ] [MainThread]: 
[0m20:18:51.625109 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:18:51.625781 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JAFFLE_SHOP'
[0m20:18:51.653385 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP"
[0m20:18:51.653789 [debug] [ThreadPool]: On list_JAFFLE_SHOP: show terse schemas in database JAFFLE_SHOP
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_JAFFLE_SHOP"} */
[0m20:18:51.653995 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:18:54.621097 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2.967 seconds
[0m20:18:54.628958 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_JAFFLE_SHOP, now list_JAFFLE_SHOP_ANALYTICS)
[0m20:18:54.644569 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP_ANALYTICS"
[0m20:18:54.645197 [debug] [ThreadPool]: On list_JAFFLE_SHOP_ANALYTICS: show objects in JAFFLE_SHOP.ANALYTICS
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_JAFFLE_SHOP_ANALYTICS"} */;
[0m20:18:54.784386 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.138 seconds
[0m20:18:54.791611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2b228f2b-661b-4622-8304-2f68ac98bb96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff73fb06b0>]}
[0m20:18:54.801144 [debug] [Thread-1 (]: Began running node model.jaffle_shop.int_orders_pivoted
[0m20:18:54.802260 [info ] [Thread-1 (]: 1 of 1 START sql view model ANALYTICS.int_orders_pivoted ....................... [RUN]
[0m20:18:54.803298 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_JAFFLE_SHOP_ANALYTICS, now model.jaffle_shop.int_orders_pivoted)
[0m20:18:54.804495 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.int_orders_pivoted
[0m20:18:54.819086 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.int_orders_pivoted"
[0m20:18:54.821522 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.int_orders_pivoted
[0m20:18:54.849875 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.int_orders_pivoted"
[0m20:18:54.851575 [debug] [Thread-1 (]: Using snowflake connection "model.jaffle_shop.int_orders_pivoted"
[0m20:18:54.851945 [debug] [Thread-1 (]: On model.jaffle_shop.int_orders_pivoted: create or replace   view JAFFLE_SHOP.ANALYTICS.int_orders_pivoted
  
  
  
  
  as (
    with 
completed as (
    select
        p.order_id
        ,p.payment_method
        ,p.amount
    from JAFFLE_SHOP.ANALYTICS.stg_payments as p 
    left join JAFFLE_SHOP.ANALYTICS.stg_orders as o using (order_id)
    where status ='completed'
),
pivoted as (
    select
        order_id,
        
        
            sum(case when payment_method = 'bank_transfer' then amount else 0) as bank_transfer_amount
            
                ,
            
        
            sum(case when payment_method = 'credit_card' then amount else 0) as credit_card_amount
            
                ,
            
        
            sum(case when payment_method = 'coupon' then amount else 0) as coupon_amount
            
                ,
            
        
            sum(case when payment_method = 'gift_card' then amount else 0) as gift_card_amount
            
        
    from completed
)
select 
    *
from pivoted
  )
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.int_orders_pivoted"} */;
[0m20:18:55.794865 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bfe322-0305-5ad3-0004-0c26000538fe
[0m20:18:55.796901 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 22 at position 77 unexpected ')'.
syntax error line 27 at position 75 unexpected ')'.
syntax error line 32 at position 70 unexpected ')'.
syntax error line 37 at position 73 unexpected ')'.
[0m20:18:55.805192 [debug] [Thread-1 (]: Database Error in model int_orders_pivoted (models/intermediate/int_orders_pivoted.sql)
  001003 (42000): SQL compilation error:
  syntax error line 22 at position 77 unexpected ')'.
  syntax error line 27 at position 75 unexpected ')'.
  syntax error line 32 at position 70 unexpected ')'.
  syntax error line 37 at position 73 unexpected ')'.
  compiled code at target/run/jaffle_shop/models/intermediate/int_orders_pivoted.sql
[0m20:18:55.809320 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b228f2b-661b-4622-8304-2f68ac98bb96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7356b020>]}
[0m20:18:55.811283 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model ANALYTICS.int_orders_pivoted .............. [[31mERROR[0m in 1.00s]
[0m20:18:55.812631 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.int_orders_pivoted
[0m20:18:55.813634 [debug] [Thread-7 (]: Marking all children of 'model.jaffle_shop.int_orders_pivoted' to be skipped because of status 'error'.  Reason: Database Error in model int_orders_pivoted (models/intermediate/int_orders_pivoted.sql)
  001003 (42000): SQL compilation error:
  syntax error line 22 at position 77 unexpected ')'.
  syntax error line 27 at position 75 unexpected ')'.
  syntax error line 32 at position 70 unexpected ')'.
  syntax error line 37 at position 73 unexpected ')'.
  compiled code at target/run/jaffle_shop/models/intermediate/int_orders_pivoted.sql.
[0m20:18:55.818592 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:18:55.819239 [debug] [MainThread]: Connection 'model.jaffle_shop.int_orders_pivoted' was left open.
[0m20:18:55.819858 [debug] [MainThread]: On model.jaffle_shop.int_orders_pivoted: Close
[0m20:18:55.956778 [info ] [MainThread]: 
[0m20:18:55.958363 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 4.33 seconds (4.33s).
[0m20:18:55.960601 [debug] [MainThread]: Command end result
[0m20:18:56.024716 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m20:18:56.027709 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m20:18:56.033205 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/target/run_results.json
[0m20:18:56.033463 [info ] [MainThread]: 
[0m20:18:56.033853 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m20:18:56.034206 [info ] [MainThread]: 
[0m20:18:56.034610 [error] [MainThread]: [31mFailure in model int_orders_pivoted (models/intermediate/int_orders_pivoted.sql)[0m
[0m20:18:56.034929 [error] [MainThread]:   Database Error in model int_orders_pivoted (models/intermediate/int_orders_pivoted.sql)
  001003 (42000): SQL compilation error:
  syntax error line 22 at position 77 unexpected ')'.
  syntax error line 27 at position 75 unexpected ')'.
  syntax error line 32 at position 70 unexpected ')'.
  syntax error line 37 at position 73 unexpected ')'.
  compiled code at target/run/jaffle_shop/models/intermediate/int_orders_pivoted.sql
[0m20:18:56.035300 [info ] [MainThread]: 
[0m20:18:56.035910 [info ] [MainThread]:   compiled code at target/compiled/jaffle_shop/models/intermediate/int_orders_pivoted.sql
[0m20:18:56.036201 [info ] [MainThread]: 
[0m20:18:56.036657 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m20:18:56.038241 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 5.5092697, "process_in_blocks": "0", "process_kernel_time": 0.451303, "process_mem_max_rss": "233608", "process_out_blocks": "4232", "process_user_time": 3.109441}
[0m20:18:56.038799 [debug] [MainThread]: Command `dbt run` failed at 20:18:56.038720 after 5.51 seconds
[0m20:18:56.039208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97716db0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97ad0ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff976b44d0>]}
[0m20:18:56.039488 [debug] [MainThread]: Flushing usage events
[0m20:18:57.364694 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:20:32.613959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa340d3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0baf380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa24c8d40>]}


============================== 20:20:32.620612 | df80d655-b496-4e29-bb38-64e4e80250ba ==============================
[0m20:20:32.620612 [info ] [MainThread]: Running with dbt=1.10.13
[0m20:20:32.621102 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'write_json': 'True', 'static_parser': 'True', 'warn_error': 'None', 'debug': 'False', 'log_cache_events': 'False', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_experimental_parser': 'False', 'empty': 'False', 'indirect_selection': 'eager', 'no_print': 'None', 'use_colors': 'True', 'partial_parse': 'True', 'target_path': 'None', 'invocation_command': 'dbt compile --select int_orders_pivoted', 'cache_selected_only': 'False', 'log_path': '/opt/airflow/dbt/logs', 'printer_width': '80'}
[0m20:20:33.189491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'df80d655-b496-4e29-bb38-64e4e80250ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84bc45f0>]}
[0m20:20:33.223624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'df80d655-b496-4e29-bb38-64e4e80250ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84f5b0b0>]}
[0m20:20:33.224188 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m20:20:33.304447 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m20:20:33.411389 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:20:33.411702 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:20:33.437568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'df80d655-b496-4e29-bb38-64e4e80250ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84ee3a40>]}
[0m20:20:33.496713 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m20:20:33.498985 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m20:20:33.513098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'df80d655-b496-4e29-bb38-64e4e80250ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84673470>]}
[0m20:20:33.513468 [info ] [MainThread]: Found 5 models, 9 data tests, 3 sources, 631 macros
[0m20:20:33.513721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'df80d655-b496-4e29-bb38-64e4e80250ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84628440>]}
[0m20:20:33.514696 [info ] [MainThread]: 
[0m20:20:33.515000 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:20:33.515321 [info ] [MainThread]: 
[0m20:20:33.515795 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:20:33.518335 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JAFFLE_SHOP_ANALYTICS'
[0m20:20:33.557097 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP_ANALYTICS"
[0m20:20:33.557477 [debug] [ThreadPool]: On list_JAFFLE_SHOP_ANALYTICS: show objects in JAFFLE_SHOP.ANALYTICS
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_JAFFLE_SHOP_ANALYTICS"} */;
[0m20:20:33.557697 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:20:35.597952 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 2.040 seconds
[0m20:20:35.604633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'df80d655-b496-4e29-bb38-64e4e80250ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84d57ce0>]}
[0m20:20:35.612577 [debug] [Thread-1 (]: Began running node model.jaffle_shop.int_orders_pivoted
[0m20:20:35.613452 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_JAFFLE_SHOP_ANALYTICS, now model.jaffle_shop.int_orders_pivoted)
[0m20:20:35.614127 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.int_orders_pivoted
[0m20:20:35.626792 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.int_orders_pivoted"
[0m20:20:35.628569 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.int_orders_pivoted
[0m20:20:35.629391 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.int_orders_pivoted
[0m20:20:35.630858 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:20:35.631264 [debug] [MainThread]: Connection 'model.jaffle_shop.int_orders_pivoted' was left open.
[0m20:20:35.631697 [debug] [MainThread]: On model.jaffle_shop.int_orders_pivoted: Close
[0m20:20:36.525448 [debug] [MainThread]: Command end result
[0m20:20:36.579250 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m20:20:36.581298 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m20:20:36.586752 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/target/run_results.json
[0m20:20:36.587294 [info ] [MainThread]: Compiled node 'int_orders_pivoted' is:
with 
completed as (
    select
        p.order_id
        ,p.payment_method
        ,p.amount
    from JAFFLE_SHOP.ANALYTICS.stg_payments as p 
    left join JAFFLE_SHOP.ANALYTICS.stg_orders as o using (order_id)
    where status ='completed'
),
pivoted as (
    select
        order_id,
        
        
            sum(case when payment_method = 'bank_transfer' then amount else 0) as bank_transfer_amount
            
                ,
            
        
            sum(case when payment_method = 'credit_card' then amount else 0) as credit_card_amount
            
                ,
            
        
            sum(case when payment_method = 'coupon' then amount else 0) as coupon_amount
            
                ,
            
        
            sum(case when payment_method = 'gift_card' then amount else 0) as gift_card_amount
            
        
    from completed
)
select 
    *
from pivoted
[0m20:20:36.588439 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 4.0076537, "process_in_blocks": "0", "process_kernel_time": 0.415748, "process_mem_max_rss": "231012", "process_out_blocks": "2828", "process_user_time": 2.995212}
[0m20:20:36.588880 [debug] [MainThread]: Command `dbt compile` succeeded at 20:20:36.588801 after 4.01 seconds
[0m20:20:36.589230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa24c8d40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0baf380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84693710>]}
[0m20:20:36.589581 [debug] [MainThread]: Flushing usage events
[0m20:20:37.792424 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:23:05.923181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa61752e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa51a3470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5921bb0>]}


============================== 20:23:05.929449 | 82f25f96-abaf-4dfc-a1cd-2cc79b904638 ==============================
[0m20:23:05.929449 [info ] [MainThread]: Running with dbt=1.10.13
[0m20:23:05.929940 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/opt/airflow/dbt', 'invocation_command': 'dbt compile --select int_orders_pivoted', 'debug': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'empty': 'False', 'printer_width': '80', 'use_experimental_parser': 'False', 'introspect': 'True', 'no_print': 'None', 'log_format': 'default', 'cache_selected_only': 'False', 'write_json': 'True', 'quiet': 'False', 'indirect_selection': 'eager', 'fail_fast': 'False', 'static_parser': 'True', 'warn_error': 'None', 'target_path': 'None', 'use_colors': 'True'}
[0m20:23:06.566437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '82f25f96-abaf-4dfc-a1cd-2cc79b904638', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff896c8290>]}
[0m20:23:06.600579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '82f25f96-abaf-4dfc-a1cd-2cc79b904638', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff898b6d80>]}
[0m20:23:06.601139 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m20:23:06.682271 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m20:23:06.779933 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:23:06.780399 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://models/intermediate/int_orders_pivoted.sql
[0m20:23:06.929757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '82f25f96-abaf-4dfc-a1cd-2cc79b904638', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88f2fcb0>]}
[0m20:23:07.053700 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m20:23:07.055565 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m20:23:07.070257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '82f25f96-abaf-4dfc-a1cd-2cc79b904638', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88f8d4f0>]}
[0m20:23:07.070652 [info ] [MainThread]: Found 5 models, 9 data tests, 3 sources, 631 macros
[0m20:23:07.070954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '82f25f96-abaf-4dfc-a1cd-2cc79b904638', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88fa58e0>]}
[0m20:23:07.072029 [info ] [MainThread]: 
[0m20:23:07.072327 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:23:07.072607 [info ] [MainThread]: 
[0m20:23:07.073111 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:23:07.075866 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JAFFLE_SHOP_ANALYTICS'
[0m20:23:07.107894 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP_ANALYTICS"
[0m20:23:07.108334 [debug] [ThreadPool]: On list_JAFFLE_SHOP_ANALYTICS: show objects in JAFFLE_SHOP.ANALYTICS
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_JAFFLE_SHOP_ANALYTICS"} */;
[0m20:23:07.108578 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:23:10.361797 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 3.253 seconds
[0m20:23:10.366205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '82f25f96-abaf-4dfc-a1cd-2cc79b904638', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8934e870>]}
[0m20:23:10.371632 [debug] [Thread-1 (]: Began running node model.jaffle_shop.int_orders_pivoted
[0m20:23:10.372264 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_JAFFLE_SHOP_ANALYTICS, now model.jaffle_shop.int_orders_pivoted)
[0m20:23:10.372796 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.int_orders_pivoted
[0m20:23:10.382353 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.int_orders_pivoted"
[0m20:23:10.383685 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.int_orders_pivoted
[0m20:23:10.384408 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.int_orders_pivoted
[0m20:23:10.385653 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:23:10.386046 [debug] [MainThread]: Connection 'model.jaffle_shop.int_orders_pivoted' was left open.
[0m20:23:10.386377 [debug] [MainThread]: On model.jaffle_shop.int_orders_pivoted: Close
[0m20:23:11.377765 [debug] [MainThread]: Command end result
[0m20:23:11.432086 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m20:23:11.434502 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m20:23:11.441264 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/target/run_results.json
[0m20:23:11.441644 [info ] [MainThread]: Compiled node 'int_orders_pivoted' is:
with 
completed as (
    select
        p.order_id
        ,p.payment_method
        ,p.amount
    from JAFFLE_SHOP.ANALYTICS.stg_payments as p 
    left join JAFFLE_SHOP.ANALYTICS.stg_orders as o using (order_id)
    where status ='completed'
),
pivoted as (
    select
        order_id,
            sum(case when payment_method = 'bank_transfer' then amount else 0) as bank_transfer_amount,
            sum(case when payment_method = 'credit_card' then amount else 0) as credit_card_amount,
            sum(case when payment_method = 'coupon' then amount else 0) as coupon_amount,
            sum(case when payment_method = 'gift_card' then amount else 0) as gift_card_amount
    from completed
)
select 
    *
from pivoted
[0m20:23:11.443603 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 5.5648623, "process_in_blocks": "0", "process_kernel_time": 0.459829, "process_mem_max_rss": "232720", "process_out_blocks": "4220", "process_user_time": 3.233109}
[0m20:23:11.444389 [debug] [MainThread]: Command `dbt compile` succeeded at 20:23:11.444221 after 5.57 seconds
[0m20:23:11.444899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5921bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa57835c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5782030>]}
[0m20:23:11.445285 [debug] [MainThread]: Flushing usage events
[0m20:23:12.674195 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:23:19.762849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97a3f710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff985ba3f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97d382f0>]}


============================== 20:23:19.768420 | 50081d59-3238-42a6-a480-c05abf4c8636 ==============================
[0m20:23:19.768420 [info ] [MainThread]: Running with dbt=1.10.13
[0m20:23:19.768819 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'log_format': 'default', 'use_experimental_parser': 'False', 'quiet': 'False', 'static_parser': 'True', 'partial_parse': 'True', 'fail_fast': 'False', 'log_cache_events': 'False', 'empty': 'False', 'write_json': 'True', 'profiles_dir': '/opt/airflow/dbt', 'invocation_command': 'dbt run --select int_orders_pivoted', 'version_check': 'True', 'indirect_selection': 'eager', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_colors': 'True', 'target_path': 'None', 'log_path': '/opt/airflow/dbt/logs', 'introspect': 'True', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'debug': 'False'}
[0m20:23:20.308726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '50081d59-3238-42a6-a480-c05abf4c8636', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c0021b0>]}
[0m20:23:20.343295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '50081d59-3238-42a6-a480-c05abf4c8636', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7bda2330>]}
[0m20:23:20.343877 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m20:23:20.417074 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m20:23:20.515743 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:23:20.516080 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:23:20.541468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '50081d59-3238-42a6-a480-c05abf4c8636', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b99da00>]}
[0m20:23:20.596322 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m20:23:20.597696 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m20:23:20.610829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '50081d59-3238-42a6-a480-c05abf4c8636', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7bcd96a0>]}
[0m20:23:20.611197 [info ] [MainThread]: Found 5 models, 9 data tests, 3 sources, 631 macros
[0m20:23:20.611458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '50081d59-3238-42a6-a480-c05abf4c8636', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b599a90>]}
[0m20:23:20.612497 [info ] [MainThread]: 
[0m20:23:20.612763 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:23:20.613075 [info ] [MainThread]: 
[0m20:23:20.613511 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:23:20.614126 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JAFFLE_SHOP'
[0m20:23:20.638295 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP"
[0m20:23:20.638750 [debug] [ThreadPool]: On list_JAFFLE_SHOP: show terse schemas in database JAFFLE_SHOP
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_JAFFLE_SHOP"} */
[0m20:23:20.639025 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:23:21.553671 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.914 seconds
[0m20:23:21.565233 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_JAFFLE_SHOP, now list_JAFFLE_SHOP_ANALYTICS)
[0m20:23:21.581931 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP_ANALYTICS"
[0m20:23:21.582537 [debug] [ThreadPool]: On list_JAFFLE_SHOP_ANALYTICS: show objects in JAFFLE_SHOP.ANALYTICS
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_JAFFLE_SHOP_ANALYTICS"} */;
[0m20:23:21.698876 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.115 seconds
[0m20:23:21.705437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '50081d59-3238-42a6-a480-c05abf4c8636', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7bcdb9b0>]}
[0m20:23:21.713122 [debug] [Thread-1 (]: Began running node model.jaffle_shop.int_orders_pivoted
[0m20:23:21.714026 [info ] [Thread-1 (]: 1 of 1 START sql view model ANALYTICS.int_orders_pivoted ....................... [RUN]
[0m20:23:21.714915 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_JAFFLE_SHOP_ANALYTICS, now model.jaffle_shop.int_orders_pivoted)
[0m20:23:21.715628 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.int_orders_pivoted
[0m20:23:21.728003 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.int_orders_pivoted"
[0m20:23:21.729550 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.int_orders_pivoted
[0m20:23:21.761532 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.int_orders_pivoted"
[0m20:23:21.763209 [debug] [Thread-1 (]: Using snowflake connection "model.jaffle_shop.int_orders_pivoted"
[0m20:23:21.763595 [debug] [Thread-1 (]: On model.jaffle_shop.int_orders_pivoted: create or replace   view JAFFLE_SHOP.ANALYTICS.int_orders_pivoted
  
  
  
  
  as (
    with 
completed as (
    select
        p.order_id
        ,p.payment_method
        ,p.amount
    from JAFFLE_SHOP.ANALYTICS.stg_payments as p 
    left join JAFFLE_SHOP.ANALYTICS.stg_orders as o using (order_id)
    where status ='completed'
),
pivoted as (
    select
        order_id,
            sum(case when payment_method = 'bank_transfer' then amount else 0) as bank_transfer_amount,
            sum(case when payment_method = 'credit_card' then amount else 0) as credit_card_amount,
            sum(case when payment_method = 'coupon' then amount else 0) as coupon_amount,
            sum(case when payment_method = 'gift_card' then amount else 0) as gift_card_amount
    from completed
)
select 
    *
from pivoted
  )
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.int_orders_pivoted"} */;
[0m20:23:22.538625 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bfe327-0305-5acf-0004-0c260004feae
[0m20:23:22.540051 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 20 at position 77 unexpected ')'.
syntax error line 21 at position 75 unexpected ')'.
syntax error line 22 at position 70 unexpected ')'.
syntax error line 23 at position 73 unexpected ')'.
[0m20:23:22.547170 [debug] [Thread-1 (]: Database Error in model int_orders_pivoted (models/intermediate/int_orders_pivoted.sql)
  001003 (42000): SQL compilation error:
  syntax error line 20 at position 77 unexpected ')'.
  syntax error line 21 at position 75 unexpected ')'.
  syntax error line 22 at position 70 unexpected ')'.
  syntax error line 23 at position 73 unexpected ')'.
  compiled code at target/run/jaffle_shop/models/intermediate/int_orders_pivoted.sql
[0m20:23:22.550671 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '50081d59-3238-42a6-a480-c05abf4c8636', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff981c8d70>]}
[0m20:23:22.551898 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model ANALYTICS.int_orders_pivoted .............. [[31mERROR[0m in 0.83s]
[0m20:23:22.553051 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.int_orders_pivoted
[0m20:23:22.554087 [debug] [Thread-7 (]: Marking all children of 'model.jaffle_shop.int_orders_pivoted' to be skipped because of status 'error'.  Reason: Database Error in model int_orders_pivoted (models/intermediate/int_orders_pivoted.sql)
  001003 (42000): SQL compilation error:
  syntax error line 20 at position 77 unexpected ')'.
  syntax error line 21 at position 75 unexpected ')'.
  syntax error line 22 at position 70 unexpected ')'.
  syntax error line 23 at position 73 unexpected ')'.
  compiled code at target/run/jaffle_shop/models/intermediate/int_orders_pivoted.sql.
[0m20:23:22.557425 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:23:22.558194 [debug] [MainThread]: Connection 'model.jaffle_shop.int_orders_pivoted' was left open.
[0m20:23:22.558796 [debug] [MainThread]: On model.jaffle_shop.int_orders_pivoted: Close
[0m20:23:22.692515 [info ] [MainThread]: 
[0m20:23:22.694407 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.08 seconds (2.08s).
[0m20:23:22.696525 [debug] [MainThread]: Command end result
[0m20:23:22.765360 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m20:23:22.767560 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m20:23:22.772855 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/target/run_results.json
[0m20:23:22.773325 [info ] [MainThread]: 
[0m20:23:22.773885 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m20:23:22.774541 [info ] [MainThread]: 
[0m20:23:22.775146 [error] [MainThread]: [31mFailure in model int_orders_pivoted (models/intermediate/int_orders_pivoted.sql)[0m
[0m20:23:22.775678 [error] [MainThread]:   Database Error in model int_orders_pivoted (models/intermediate/int_orders_pivoted.sql)
  001003 (42000): SQL compilation error:
  syntax error line 20 at position 77 unexpected ')'.
  syntax error line 21 at position 75 unexpected ')'.
  syntax error line 22 at position 70 unexpected ')'.
  syntax error line 23 at position 73 unexpected ')'.
  compiled code at target/run/jaffle_shop/models/intermediate/int_orders_pivoted.sql
[0m20:23:22.776275 [info ] [MainThread]: 
[0m20:23:22.777170 [info ] [MainThread]:   compiled code at target/compiled/jaffle_shop/models/intermediate/int_orders_pivoted.sql
[0m20:23:22.777838 [info ] [MainThread]: 
[0m20:23:22.778474 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m20:23:22.779964 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.0486555, "process_in_blocks": "0", "process_kernel_time": 0.321362, "process_mem_max_rss": "231756", "process_out_blocks": "2837", "process_user_time": 2.934702}
[0m20:23:22.780470 [debug] [MainThread]: Command `dbt run` failed at 20:23:22.780382 after 3.05 seconds
[0m20:23:22.780918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98088080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7be7e570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97663c80>]}
[0m20:23:22.781311 [debug] [MainThread]: Flushing usage events
[0m20:23:24.130268 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:24:37.234345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9af0d940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b6835c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ac745c0>]}


============================== 20:24:37.239637 | 16658f59-e438-4509-ba06-2d76bb613c99 ==============================
[0m20:24:37.239637 [info ] [MainThread]: Running with dbt=1.10.13
[0m20:24:37.240065 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'target_path': 'None', 'no_print': 'None', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_format': 'default', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'cache_selected_only': 'False', 'version_check': 'True', 'partial_parse': 'True', 'write_json': 'True', 'use_experimental_parser': 'False', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'empty': 'False', 'indirect_selection': 'eager', 'printer_width': '80', 'use_colors': 'True', 'log_cache_events': 'False', 'static_parser': 'True', 'invocation_command': 'dbt run --select int_orders_pivoted'}
[0m20:24:38.098270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '16658f59-e438-4509-ba06-2d76bb613c99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff853aabd0>]}
[0m20:24:38.134480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '16658f59-e438-4509-ba06-2d76bb613c99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f37a0c0>]}
[0m20:24:38.135174 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m20:24:38.244164 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m20:24:38.354479 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:24:38.355011 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://models/intermediate/int_orders_pivoted.sql
[0m20:24:38.517133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '16658f59-e438-4509-ba06-2d76bb613c99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e52bdd0>]}
[0m20:24:38.657217 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m20:24:38.658656 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m20:24:38.673212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '16658f59-e438-4509-ba06-2d76bb613c99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e593230>]}
[0m20:24:38.673584 [info ] [MainThread]: Found 5 models, 9 data tests, 3 sources, 631 macros
[0m20:24:38.673846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '16658f59-e438-4509-ba06-2d76bb613c99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e6d3500>]}
[0m20:24:38.674808 [info ] [MainThread]: 
[0m20:24:38.675120 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:24:38.675392 [info ] [MainThread]: 
[0m20:24:38.675847 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:24:38.676541 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JAFFLE_SHOP'
[0m20:24:38.711613 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP"
[0m20:24:38.712039 [debug] [ThreadPool]: On list_JAFFLE_SHOP: show terse schemas in database JAFFLE_SHOP
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_JAFFLE_SHOP"} */
[0m20:24:38.712257 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:24:40.936861 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2.224 seconds
[0m20:24:40.944099 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_JAFFLE_SHOP, now list_JAFFLE_SHOP_ANALYTICS)
[0m20:24:40.954902 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP_ANALYTICS"
[0m20:24:40.955275 [debug] [ThreadPool]: On list_JAFFLE_SHOP_ANALYTICS: show objects in JAFFLE_SHOP.ANALYTICS
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_JAFFLE_SHOP_ANALYTICS"} */;
[0m20:24:41.076058 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.120 seconds
[0m20:24:41.079912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '16658f59-e438-4509-ba06-2d76bb613c99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e6d80e0>]}
[0m20:24:41.085425 [debug] [Thread-1 (]: Began running node model.jaffle_shop.int_orders_pivoted
[0m20:24:41.086106 [info ] [Thread-1 (]: 1 of 1 START sql view model ANALYTICS.int_orders_pivoted ....................... [RUN]
[0m20:24:41.086995 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_JAFFLE_SHOP_ANALYTICS, now model.jaffle_shop.int_orders_pivoted)
[0m20:24:41.087469 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.int_orders_pivoted
[0m20:24:41.098079 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.int_orders_pivoted"
[0m20:24:41.099398 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.int_orders_pivoted
[0m20:24:41.129541 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.int_orders_pivoted"
[0m20:24:41.131647 [debug] [Thread-1 (]: Using snowflake connection "model.jaffle_shop.int_orders_pivoted"
[0m20:24:41.132025 [debug] [Thread-1 (]: On model.jaffle_shop.int_orders_pivoted: create or replace   view JAFFLE_SHOP.ANALYTICS.int_orders_pivoted
  
  
  
  
  as (
    with 
completed as (
    select
        p.order_id
        ,p.payment_method
        ,p.amount
    from JAFFLE_SHOP.ANALYTICS.stg_payments as p 
    left join JAFFLE_SHOP.ANALYTICS.stg_orders as o using (order_id)
    where status ='completed'
),
pivoted as (
    select
        order_id,
            sum(case when payment_method = 'bank_transfer' then amount else 0) as bank_transfer_amount,
            sum(case when payment_method = 'credit_card' then amount else 0) as credit_card_amount,
            sum(case when payment_method = 'coupon' then amount else 0) as coupon_amount,
            sum(case when payment_method = 'gift_card' then amount else 0) as gift_card_amount
    from completed
    group by order_id
)
select 
    *
from pivoted
  )
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.int_orders_pivoted"} */;
[0m20:24:42.016872 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bfe328-0305-5ad3-0004-0c260005390a
[0m20:24:42.017889 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 20 at position 77 unexpected ')'.
syntax error line 21 at position 75 unexpected ')'.
syntax error line 22 at position 70 unexpected ')'.
syntax error line 23 at position 73 unexpected ')'.
[0m20:24:42.024459 [debug] [Thread-1 (]: Database Error in model int_orders_pivoted (models/intermediate/int_orders_pivoted.sql)
  001003 (42000): SQL compilation error:
  syntax error line 20 at position 77 unexpected ')'.
  syntax error line 21 at position 75 unexpected ')'.
  syntax error line 22 at position 70 unexpected ')'.
  syntax error line 23 at position 73 unexpected ')'.
  compiled code at target/run/jaffle_shop/models/intermediate/int_orders_pivoted.sql
[0m20:24:42.027751 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '16658f59-e438-4509-ba06-2d76bb613c99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff77f67110>]}
[0m20:24:42.028994 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model ANALYTICS.int_orders_pivoted .............. [[31mERROR[0m in 0.94s]
[0m20:24:42.030166 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.int_orders_pivoted
[0m20:24:42.031196 [debug] [Thread-7 (]: Marking all children of 'model.jaffle_shop.int_orders_pivoted' to be skipped because of status 'error'.  Reason: Database Error in model int_orders_pivoted (models/intermediate/int_orders_pivoted.sql)
  001003 (42000): SQL compilation error:
  syntax error line 20 at position 77 unexpected ')'.
  syntax error line 21 at position 75 unexpected ')'.
  syntax error line 22 at position 70 unexpected ')'.
  syntax error line 23 at position 73 unexpected ')'.
  compiled code at target/run/jaffle_shop/models/intermediate/int_orders_pivoted.sql.
[0m20:24:42.034550 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:24:42.035134 [debug] [MainThread]: Connection 'model.jaffle_shop.int_orders_pivoted' was left open.
[0m20:24:42.035779 [debug] [MainThread]: On model.jaffle_shop.int_orders_pivoted: Close
[0m20:24:42.192305 [info ] [MainThread]: 
[0m20:24:42.194109 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.52 seconds (3.52s).
[0m20:24:42.196479 [debug] [MainThread]: Command end result
[0m20:24:42.250312 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m20:24:42.252382 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m20:24:42.257867 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/target/run_results.json
[0m20:24:42.258155 [info ] [MainThread]: 
[0m20:24:42.258611 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m20:24:42.259138 [info ] [MainThread]: 
[0m20:24:42.259905 [error] [MainThread]: [31mFailure in model int_orders_pivoted (models/intermediate/int_orders_pivoted.sql)[0m
[0m20:24:42.260308 [error] [MainThread]:   Database Error in model int_orders_pivoted (models/intermediate/int_orders_pivoted.sql)
  001003 (42000): SQL compilation error:
  syntax error line 20 at position 77 unexpected ')'.
  syntax error line 21 at position 75 unexpected ')'.
  syntax error line 22 at position 70 unexpected ')'.
  syntax error line 23 at position 73 unexpected ')'.
  compiled code at target/run/jaffle_shop/models/intermediate/int_orders_pivoted.sql
[0m20:24:42.260708 [info ] [MainThread]: 
[0m20:24:42.261079 [info ] [MainThread]:   compiled code at target/compiled/jaffle_shop/models/intermediate/int_orders_pivoted.sql
[0m20:24:42.261333 [info ] [MainThread]: 
[0m20:24:42.261704 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m20:24:42.262854 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 5.05848, "process_in_blocks": "0", "process_kernel_time": 0.546398, "process_mem_max_rss": "233924", "process_out_blocks": "4231", "process_user_time": 3.626464}
[0m20:24:42.263261 [debug] [MainThread]: Command `dbt run` failed at 20:24:42.263198 after 5.06 seconds
[0m20:24:42.263581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a4e0950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ebadfa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9acadfa0>]}
[0m20:24:42.263848 [debug] [MainThread]: Flushing usage events
[0m20:24:43.676288 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:25:06.316612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e4e26c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e4b9160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7dd85bb0>]}


============================== 20:25:06.322565 | 9f928fc2-b99d-4726-9e65-035ec3f5968b ==============================
[0m20:25:06.322565 [info ] [MainThread]: Running with dbt=1.10.13
[0m20:25:06.322983 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'static_parser': 'True', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'log_path': '/opt/airflow/dbt/logs', 'target_path': 'None', 'version_check': 'True', 'introspect': 'True', 'write_json': 'True', 'cache_selected_only': 'False', 'debug': 'False', 'log_format': 'default', 'empty': 'False', 'invocation_command': 'dbt compile --select int_orders_pivoted', 'printer_width': '80', 'warn_error': 'None', 'indirect_selection': 'eager', 'quiet': 'False', 'send_anonymous_usage_stats': 'True'}
[0m20:25:06.886258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9f928fc2-b99d-4726-9e65-035ec3f5968b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e7b1f40>]}
[0m20:25:06.920804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9f928fc2-b99d-4726-9e65-035ec3f5968b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e3a1760>]}
[0m20:25:06.921477 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m20:25:07.008673 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m20:25:07.166337 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:25:07.167188 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://models/intermediate/int_orders_pivoted.sql
[0m20:25:07.414659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9f928fc2-b99d-4726-9e65-035ec3f5968b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6160fa70>]}
[0m20:25:07.587108 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m20:25:07.589045 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m20:25:07.606375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9f928fc2-b99d-4726-9e65-035ec3f5968b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff61675dc0>]}
[0m20:25:07.606901 [info ] [MainThread]: Found 5 models, 9 data tests, 3 sources, 631 macros
[0m20:25:07.607512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9f928fc2-b99d-4726-9e65-035ec3f5968b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff617d0c80>]}
[0m20:25:07.609795 [info ] [MainThread]: 
[0m20:25:07.610536 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:25:07.612180 [info ] [MainThread]: 
[0m20:25:07.613054 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:25:07.616710 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JAFFLE_SHOP_ANALYTICS'
[0m20:25:07.666475 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP_ANALYTICS"
[0m20:25:07.666948 [debug] [ThreadPool]: On list_JAFFLE_SHOP_ANALYTICS: show objects in JAFFLE_SHOP.ANALYTICS
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_JAFFLE_SHOP_ANALYTICS"} */;
[0m20:25:07.667358 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:25:10.482950 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 2.815 seconds
[0m20:25:10.496097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9f928fc2-b99d-4726-9e65-035ec3f5968b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff617b5280>]}
[0m20:25:10.511758 [debug] [Thread-1 (]: Began running node model.jaffle_shop.int_orders_pivoted
[0m20:25:10.513257 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_JAFFLE_SHOP_ANALYTICS, now model.jaffle_shop.int_orders_pivoted)
[0m20:25:10.514265 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.int_orders_pivoted
[0m20:25:10.525086 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.int_orders_pivoted"
[0m20:25:10.527293 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.int_orders_pivoted
[0m20:25:10.529171 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.int_orders_pivoted
[0m20:25:10.532774 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:25:10.533627 [debug] [MainThread]: Connection 'model.jaffle_shop.int_orders_pivoted' was left open.
[0m20:25:10.534349 [debug] [MainThread]: On model.jaffle_shop.int_orders_pivoted: Close
[0m20:25:11.387305 [debug] [MainThread]: Command end result
[0m20:25:11.417915 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m20:25:11.423134 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m20:25:11.430502 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/target/run_results.json
[0m20:25:11.431345 [info ] [MainThread]: Compiled node 'int_orders_pivoted' is:
with 
completed as (
    select
        p.order_id
        ,p.payment_method
        ,p.amount
    from JAFFLE_SHOP.ANALYTICS.stg_payments as p 
    left join JAFFLE_SHOP.ANALYTICS.stg_orders as o using (order_id)
    where status ='completed'
),
pivoted as (
    select
        order_id,
            sum(case when payment_method = 'bank_transfer' then amount else 0) as bank_transfer_amount,
            sum(case when payment_method = 'credit_card' then amount else 0) as credit_card_amount,
            sum(case when payment_method = 'coupon' then amount else 0) as coupon_amount,
            sum(case when payment_method = 'gift_card' then amount else 0) as gift_card_amount
    from completed
    group by 1
)
select 
    *
from pivoted
[0m20:25:11.433082 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 5.15544, "process_in_blocks": "0", "process_kernel_time": 0.471123, "process_mem_max_rss": "232752", "process_out_blocks": "4220", "process_user_time": 3.242022}
[0m20:25:11.433635 [debug] [MainThread]: Command `dbt compile` succeeded at 20:25:11.433553 after 5.16 seconds
[0m20:25:11.434054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e4e3bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d62fb30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d62f1d0>]}
[0m20:25:11.434401 [debug] [MainThread]: Flushing usage events
[0m20:25:12.760228 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:25:18.217876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb31ad220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb25bc7a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4ad7f50>]}


============================== 20:25:18.223147 | 44093905-5b74-4772-a815-455a705927ef ==============================
[0m20:25:18.223147 [info ] [MainThread]: Running with dbt=1.10.13
[0m20:25:18.223546 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'static_parser': 'True', 'debug': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_experimental_parser': 'False', 'warn_error': 'None', 'profiles_dir': '/opt/airflow/dbt', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'quiet': 'False', 'invocation_command': 'dbt run --select int_orders_pivoted', 'empty': 'False', 'indirect_selection': 'eager', 'target_path': 'None', 'no_print': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'log_format': 'default', 'introspect': 'True', 'log_cache_events': 'False', 'use_colors': 'True', 'partial_parse': 'True'}
[0m20:25:18.784542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '44093905-5b74-4772-a815-455a705927ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff982738c0>]}
[0m20:25:18.821877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '44093905-5b74-4772-a815-455a705927ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff968de390>]}
[0m20:25:18.822508 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m20:25:18.897445 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m20:25:19.014821 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:25:19.015201 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:25:19.040871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '44093905-5b74-4772-a815-455a705927ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96664680>]}
[0m20:25:19.362600 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m20:25:19.365284 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m20:25:19.383625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '44093905-5b74-4772-a815-455a705927ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96c3c710>]}
[0m20:25:19.384095 [info ] [MainThread]: Found 5 models, 9 data tests, 3 sources, 631 macros
[0m20:25:19.384483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '44093905-5b74-4772-a815-455a705927ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96a9f8c0>]}
[0m20:25:19.385989 [info ] [MainThread]: 
[0m20:25:19.386372 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:25:19.386646 [info ] [MainThread]: 
[0m20:25:19.387215 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:25:19.388198 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JAFFLE_SHOP'
[0m20:25:19.427643 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP"
[0m20:25:19.428029 [debug] [ThreadPool]: On list_JAFFLE_SHOP: show terse schemas in database JAFFLE_SHOP
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_JAFFLE_SHOP"} */
[0m20:25:19.428241 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:25:20.388024 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.960 seconds
[0m20:25:20.394849 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_JAFFLE_SHOP, now list_JAFFLE_SHOP_ANALYTICS)
[0m20:25:20.405939 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP_ANALYTICS"
[0m20:25:20.406364 [debug] [ThreadPool]: On list_JAFFLE_SHOP_ANALYTICS: show objects in JAFFLE_SHOP.ANALYTICS
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_JAFFLE_SHOP_ANALYTICS"} */;
[0m20:25:20.563143 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.156 seconds
[0m20:25:20.567387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '44093905-5b74-4772-a815-455a705927ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9690c050>]}
[0m20:25:20.573154 [debug] [Thread-1 (]: Began running node model.jaffle_shop.int_orders_pivoted
[0m20:25:20.573828 [info ] [Thread-1 (]: 1 of 1 START sql view model ANALYTICS.int_orders_pivoted ....................... [RUN]
[0m20:25:20.574518 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_JAFFLE_SHOP_ANALYTICS, now model.jaffle_shop.int_orders_pivoted)
[0m20:25:20.575053 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.int_orders_pivoted
[0m20:25:20.584639 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.int_orders_pivoted"
[0m20:25:20.585977 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.int_orders_pivoted
[0m20:25:20.614351 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.int_orders_pivoted"
[0m20:25:20.615866 [debug] [Thread-1 (]: Using snowflake connection "model.jaffle_shop.int_orders_pivoted"
[0m20:25:20.616229 [debug] [Thread-1 (]: On model.jaffle_shop.int_orders_pivoted: create or replace   view JAFFLE_SHOP.ANALYTICS.int_orders_pivoted
  
  
  
  
  as (
    with 
completed as (
    select
        p.order_id
        ,p.payment_method
        ,p.amount
    from JAFFLE_SHOP.ANALYTICS.stg_payments as p 
    left join JAFFLE_SHOP.ANALYTICS.stg_orders as o using (order_id)
    where status ='completed'
),
pivoted as (
    select
        order_id,
            sum(case when payment_method = 'bank_transfer' then amount else 0) as bank_transfer_amount,
            sum(case when payment_method = 'credit_card' then amount else 0) as credit_card_amount,
            sum(case when payment_method = 'coupon' then amount else 0) as coupon_amount,
            sum(case when payment_method = 'gift_card' then amount else 0) as gift_card_amount
    from completed
    group by 1
)
select 
    *
from pivoted
  )
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.int_orders_pivoted"} */;
[0m20:25:21.500756 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bfe329-0305-5acf-0004-0c260004febe
[0m20:25:21.502049 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 20 at position 77 unexpected ')'.
syntax error line 21 at position 75 unexpected ')'.
syntax error line 22 at position 70 unexpected ')'.
syntax error line 23 at position 73 unexpected ')'.
[0m20:25:21.510163 [debug] [Thread-1 (]: Database Error in model int_orders_pivoted (models/intermediate/int_orders_pivoted.sql)
  001003 (42000): SQL compilation error:
  syntax error line 20 at position 77 unexpected ')'.
  syntax error line 21 at position 75 unexpected ')'.
  syntax error line 22 at position 70 unexpected ')'.
  syntax error line 23 at position 73 unexpected ')'.
  compiled code at target/run/jaffle_shop/models/intermediate/int_orders_pivoted.sql
[0m20:25:21.514629 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '44093905-5b74-4772-a815-455a705927ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1fee810>]}
[0m20:25:21.516724 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model ANALYTICS.int_orders_pivoted .............. [[31mERROR[0m in 0.94s]
[0m20:25:21.520713 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.int_orders_pivoted
[0m20:25:21.521990 [debug] [Thread-7 (]: Marking all children of 'model.jaffle_shop.int_orders_pivoted' to be skipped because of status 'error'.  Reason: Database Error in model int_orders_pivoted (models/intermediate/int_orders_pivoted.sql)
  001003 (42000): SQL compilation error:
  syntax error line 20 at position 77 unexpected ')'.
  syntax error line 21 at position 75 unexpected ')'.
  syntax error line 22 at position 70 unexpected ')'.
  syntax error line 23 at position 73 unexpected ')'.
  compiled code at target/run/jaffle_shop/models/intermediate/int_orders_pivoted.sql.
[0m20:25:21.526323 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:25:21.527053 [debug] [MainThread]: Connection 'model.jaffle_shop.int_orders_pivoted' was left open.
[0m20:25:21.527631 [debug] [MainThread]: On model.jaffle_shop.int_orders_pivoted: Close
[0m20:25:21.739701 [info ] [MainThread]: 
[0m20:25:21.740961 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.35 seconds (2.35s).
[0m20:25:21.743109 [debug] [MainThread]: Command end result
[0m20:25:21.802398 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m20:25:21.804709 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m20:25:21.809813 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/target/run_results.json
[0m20:25:21.810134 [info ] [MainThread]: 
[0m20:25:21.810464 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m20:25:21.810914 [info ] [MainThread]: 
[0m20:25:21.811403 [error] [MainThread]: [31mFailure in model int_orders_pivoted (models/intermediate/int_orders_pivoted.sql)[0m
[0m20:25:21.811862 [error] [MainThread]:   Database Error in model int_orders_pivoted (models/intermediate/int_orders_pivoted.sql)
  001003 (42000): SQL compilation error:
  syntax error line 20 at position 77 unexpected ')'.
  syntax error line 21 at position 75 unexpected ')'.
  syntax error line 22 at position 70 unexpected ')'.
  syntax error line 23 at position 73 unexpected ')'.
  compiled code at target/run/jaffle_shop/models/intermediate/int_orders_pivoted.sql
[0m20:25:21.812252 [info ] [MainThread]: 
[0m20:25:21.812716 [info ] [MainThread]:   compiled code at target/compiled/jaffle_shop/models/intermediate/int_orders_pivoted.sql
[0m20:25:21.813528 [info ] [MainThread]: 
[0m20:25:21.814111 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m20:25:21.815376 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.635876, "process_in_blocks": "0", "process_kernel_time": 0.41864, "process_mem_max_rss": "231720", "process_out_blocks": "2837", "process_user_time": 3.293446}
[0m20:25:21.815909 [debug] [MainThread]: Command `dbt run` failed at 20:25:21.815823 after 3.64 seconds
[0m20:25:21.816615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb50f8c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb27f34a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff965fefc0>]}
[0m20:25:21.816985 [debug] [MainThread]: Flushing usage events
[0m20:25:23.360949 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:27:06.875512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0c45940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae5467b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae95b050>]}


============================== 20:27:06.880738 | a5998f1d-f4f5-42c8-b737-5641431ef980 ==============================
[0m20:27:06.880738 [info ] [MainThread]: Running with dbt=1.10.13
[0m20:27:06.881146 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'empty': 'False', 'write_json': 'True', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'log_cache_events': 'False', 'printer_width': '80', 'log_path': '/opt/airflow/dbt/logs', 'introspect': 'True', 'fail_fast': 'False', 'target_path': 'None', 'partial_parse': 'True', 'debug': 'False', 'warn_error': 'None', 'log_format': 'default', 'version_check': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt run --select int_orders_pivoted', 'static_parser': 'True', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True'}
[0m20:27:07.481896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a5998f1d-f4f5-42c8-b737-5641431ef980', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae7ec5f0>]}
[0m20:27:07.516591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a5998f1d-f4f5-42c8-b737-5641431ef980', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff928aa360>]}
[0m20:27:07.517191 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m20:27:07.598749 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m20:27:07.704676 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:27:07.705199 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://models/intermediate/int_orders_pivoted.sql
[0m20:27:07.867301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a5998f1d-f4f5-42c8-b737-5641431ef980', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91fdba40>]}
[0m20:27:08.003935 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m20:27:08.005560 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m20:27:08.019691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a5998f1d-f4f5-42c8-b737-5641431ef980', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92037710>]}
[0m20:27:08.020078 [info ] [MainThread]: Found 5 models, 9 data tests, 3 sources, 631 macros
[0m20:27:08.020358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a5998f1d-f4f5-42c8-b737-5641431ef980', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff920404a0>]}
[0m20:27:08.021399 [info ] [MainThread]: 
[0m20:27:08.021701 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:27:08.022000 [info ] [MainThread]: 
[0m20:27:08.022477 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:27:08.023129 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JAFFLE_SHOP'
[0m20:27:08.052233 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP"
[0m20:27:08.052626 [debug] [ThreadPool]: On list_JAFFLE_SHOP: show terse schemas in database JAFFLE_SHOP
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_JAFFLE_SHOP"} */
[0m20:27:08.052874 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:27:09.093133 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.040 seconds
[0m20:27:09.098861 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_JAFFLE_SHOP, now list_JAFFLE_SHOP_ANALYTICS)
[0m20:27:09.108086 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP_ANALYTICS"
[0m20:27:09.108447 [debug] [ThreadPool]: On list_JAFFLE_SHOP_ANALYTICS: show objects in JAFFLE_SHOP.ANALYTICS
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_JAFFLE_SHOP_ANALYTICS"} */;
[0m20:27:09.258209 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.149 seconds
[0m20:27:09.261778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a5998f1d-f4f5-42c8-b737-5641431ef980', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92071e50>]}
[0m20:27:09.267065 [debug] [Thread-1 (]: Began running node model.jaffle_shop.int_orders_pivoted
[0m20:27:09.267695 [info ] [Thread-1 (]: 1 of 1 START sql view model ANALYTICS.int_orders_pivoted ....................... [RUN]
[0m20:27:09.268353 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_JAFFLE_SHOP_ANALYTICS, now model.jaffle_shop.int_orders_pivoted)
[0m20:27:09.268845 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.int_orders_pivoted
[0m20:27:09.278512 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.int_orders_pivoted"
[0m20:27:09.279550 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.int_orders_pivoted
[0m20:27:09.302358 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.int_orders_pivoted"
[0m20:27:09.303872 [debug] [Thread-1 (]: Using snowflake connection "model.jaffle_shop.int_orders_pivoted"
[0m20:27:09.304219 [debug] [Thread-1 (]: On model.jaffle_shop.int_orders_pivoted: create or replace   view JAFFLE_SHOP.ANALYTICS.int_orders_pivoted
  
  
  
  
  as (
    with 
completed as (
    select
        p.order_id
        ,p.payment_method
        ,p.amount
    from JAFFLE_SHOP.ANALYTICS.stg_payments as p 
    left join JAFFLE_SHOP.ANALYTICS.stg_orders as o using (order_id)
    where status ='completed'
),
pivoted as (
    select
        order_id,
            sum(case when payment_method = 'bank_transfer' then amount else 0 end) as bank_transfer_amount,
            sum(case when payment_method = 'credit_card' then amount else 0 end) as credit_card_amount,
            sum(case when payment_method = 'coupon' then amount else 0 end) as coupon_amount,
            sum(case when payment_method = 'gift_card' then amount else 0 end) as gift_card_amount
    from completed
    group by 1
)
select 
    *
from pivoted
  )
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.int_orders_pivoted"} */;
[0m20:27:10.726501 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.421 seconds
[0m20:27:10.779267 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a5998f1d-f4f5-42c8-b737-5641431ef980', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0ade150>]}
[0m20:27:10.780320 [info ] [Thread-1 (]: 1 of 1 OK created sql view model ANALYTICS.int_orders_pivoted .................. [[32mSUCCESS 1[0m in 1.51s]
[0m20:27:10.781072 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.int_orders_pivoted
[0m20:27:10.784531 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:27:10.785077 [debug] [MainThread]: Connection 'model.jaffle_shop.int_orders_pivoted' was left open.
[0m20:27:10.785345 [debug] [MainThread]: On model.jaffle_shop.int_orders_pivoted: Close
[0m20:27:10.951269 [info ] [MainThread]: 
[0m20:27:10.952054 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.93 seconds (2.93s).
[0m20:27:10.953529 [debug] [MainThread]: Command end result
[0m20:27:10.988121 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m20:27:10.995316 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m20:27:11.004118 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/target/run_results.json
[0m20:27:11.004483 [info ] [MainThread]: 
[0m20:27:11.005159 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:27:11.005492 [info ] [MainThread]: 
[0m20:27:11.005847 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m20:27:11.007786 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.1643925, "process_in_blocks": "0", "process_kernel_time": 0.405542, "process_mem_max_rss": "233196", "process_out_blocks": "4226", "process_user_time": 3.357849}
[0m20:27:11.008346 [debug] [MainThread]: Command `dbt run` succeeded at 20:27:11.008278 after 4.17 seconds
[0m20:27:11.008747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae958860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae7ef8c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf5646b0>]}
[0m20:27:11.009059 [debug] [MainThread]: Flushing usage events
[0m20:27:12.830234 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:45:07.455268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaafe14f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaafa7380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaafa7aa0>]}


============================== 20:45:07.460760 | ac0ee4eb-7c4f-49d8-8359-86dbccb19979 ==============================
[0m20:45:07.460760 [info ] [MainThread]: Running with dbt=1.10.13
[0m20:45:07.461228 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'empty': 'False', 'fail_fast': 'False', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'cache_selected_only': 'False', 'version_check': 'True', 'printer_width': '80', 'no_print': 'None', 'use_colors': 'True', 'debug': 'False', 'log_cache_events': 'False', 'quiet': 'False', 'invocation_command': 'dbt compile --select stg_payments', 'partial_parse': 'True', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/opt/airflow/dbt'}
[0m20:45:08.033485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ac0ee4eb-7c4f-49d8-8359-86dbccb19979', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ef5dca0>]}
[0m20:45:08.068528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ac0ee4eb-7c4f-49d8-8359-86dbccb19979', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaafa7b30>]}
[0m20:45:08.069148 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m20:45:08.148306 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m20:45:08.306975 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 2 files added, 1 files changed.
[0m20:45:08.307447 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://models/marts/core/int_orders_pivoted.sql
[0m20:45:08.307700 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://macros/cent_to_dollars.sql
[0m20:45:08.307899 [debug] [MainThread]: Partial parsing: deleted file: jaffle_shop://models/intermediate/int_orders_pivoted.sql
[0m20:45:08.308140 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://models/staging/stg_payments.sql
[0m20:45:08.513772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ac0ee4eb-7c4f-49d8-8359-86dbccb19979', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e90a930>]}
[0m20:45:08.640337 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m20:45:08.642126 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m20:45:08.657284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ac0ee4eb-7c4f-49d8-8359-86dbccb19979', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e8e0a40>]}
[0m20:45:08.657683 [info ] [MainThread]: Found 5 models, 9 data tests, 3 sources, 632 macros
[0m20:45:08.657944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ac0ee4eb-7c4f-49d8-8359-86dbccb19979', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e9af650>]}
[0m20:45:08.659075 [info ] [MainThread]: 
[0m20:45:08.659450 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:45:08.659714 [info ] [MainThread]: 
[0m20:45:08.660179 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:45:08.663063 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JAFFLE_SHOP_ANALYTICS'
[0m20:45:08.700570 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP_ANALYTICS"
[0m20:45:08.701010 [debug] [ThreadPool]: On list_JAFFLE_SHOP_ANALYTICS: show objects in JAFFLE_SHOP.ANALYTICS
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_JAFFLE_SHOP_ANALYTICS"} */;
[0m20:45:08.701292 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:45:11.545981 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 2.844 seconds
[0m20:45:11.550651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ac0ee4eb-7c4f-49d8-8359-86dbccb19979', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e8e0a40>]}
[0m20:45:11.555816 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_payments
[0m20:45:11.556462 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_JAFFLE_SHOP_ANALYTICS, now model.jaffle_shop.stg_payments)
[0m20:45:11.556813 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_payments
[0m20:45:11.565232 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_payments"
[0m20:45:11.566470 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_payments
[0m20:45:11.568473 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_payments
[0m20:45:11.570105 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:45:11.570510 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_payments' was left open.
[0m20:45:11.570785 [debug] [MainThread]: On model.jaffle_shop.stg_payments: Close
[0m20:45:12.365561 [debug] [MainThread]: Command end result
[0m20:45:12.402876 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m20:45:12.406189 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m20:45:12.424195 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/target/run_results.json
[0m20:45:12.424951 [info ] [MainThread]: Compiled node 'stg_payments' is:
SELECT
        id as payment_id
        ,order_id
        ,payment_method
        ,amount / 100 as amount
    FROM JAFFLE_SHOP.RAW.raw_payments
[0m20:45:12.430580 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 5.0047436, "process_in_blocks": "0", "process_kernel_time": 0.366422, "process_mem_max_rss": "233096", "process_out_blocks": "4220", "process_user_time": 3.139186}
[0m20:45:12.432124 [debug] [MainThread]: Command `dbt compile` succeeded at 20:45:12.432020 after 5.01 seconds
[0m20:45:12.432997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa7e1070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e935cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c45c950>]}
[0m20:45:12.433505 [debug] [MainThread]: Flushing usage events
[0m20:45:13.734138 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:46:14.496164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffadc8d400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad6eee70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffacd45e80>]}


============================== 20:46:14.502713 | e1f87ec1-0e2e-4ad8-a9e4-146cc7f8c83f ==============================
[0m20:46:14.502713 [info ] [MainThread]: Running with dbt=1.10.13
[0m20:46:14.503188 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'log_format': 'default', 'warn_error': 'None', 'empty': 'False', 'static_parser': 'True', 'quiet': 'False', 'invocation_command': 'dbt compile --select stg_payments', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': '/opt/airflow/dbt/logs', 'use_experimental_parser': 'False', 'target_path': 'None', 'printer_width': '80', 'partial_parse': 'True', 'debug': 'False', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'profiles_dir': '/opt/airflow/dbt', 'no_print': 'None', 'version_check': 'True', 'use_colors': 'True'}
[0m20:46:15.287823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e1f87ec1-0e2e-4ad8-a9e4-146cc7f8c83f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaca15040>]}
[0m20:46:15.322812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e1f87ec1-0e2e-4ad8-a9e4-146cc7f8c83f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad6ef320>]}
[0m20:46:15.323435 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m20:46:15.407672 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m20:46:15.513102 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:46:15.513655 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://macros/cent_to_dollars.sql
[0m20:46:15.740383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e1f87ec1-0e2e-4ad8-a9e4-146cc7f8c83f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90b66900>]}
[0m20:46:15.871156 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m20:46:15.872654 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m20:46:15.886697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e1f87ec1-0e2e-4ad8-a9e4-146cc7f8c83f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90bf28a0>]}
[0m20:46:15.887057 [info ] [MainThread]: Found 5 models, 9 data tests, 3 sources, 632 macros
[0m20:46:15.887348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e1f87ec1-0e2e-4ad8-a9e4-146cc7f8c83f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb16ef6b0>]}
[0m20:46:15.888372 [info ] [MainThread]: 
[0m20:46:15.888691 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:46:15.888965 [info ] [MainThread]: 
[0m20:46:15.889398 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:46:15.892110 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JAFFLE_SHOP_ANALYTICS'
[0m20:46:15.932988 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP_ANALYTICS"
[0m20:46:15.933395 [debug] [ThreadPool]: On list_JAFFLE_SHOP_ANALYTICS: show objects in JAFFLE_SHOP.ANALYTICS
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_JAFFLE_SHOP_ANALYTICS"} */;
[0m20:46:15.933665 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:46:18.945255 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 3.011 seconds
[0m20:46:18.950406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e1f87ec1-0e2e-4ad8-a9e4-146cc7f8c83f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac9681d0>]}
[0m20:46:18.956170 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_payments
[0m20:46:18.956869 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_JAFFLE_SHOP_ANALYTICS, now model.jaffle_shop.stg_payments)
[0m20:46:18.957438 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_payments
[0m20:46:18.967658 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_payments"
[0m20:46:18.969309 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_payments
[0m20:46:18.970187 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_payments
[0m20:46:18.971540 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:46:18.971924 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_payments' was left open.
[0m20:46:18.972292 [debug] [MainThread]: On model.jaffle_shop.stg_payments: Close
[0m20:46:19.994965 [debug] [MainThread]: Command end result
[0m20:46:20.046080 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m20:46:20.048261 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m20:46:20.054651 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/target/run_results.json
[0m20:46:20.055048 [info ] [MainThread]: Compiled node 'stg_payments' is:
SELECT
        id as payment_id
        ,order_id
        ,payment_method
        ,ROUND(amount/100,2) as amount
    FROM JAFFLE_SHOP.RAW.raw_payments
[0m20:46:20.056281 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 5.594165, "process_in_blocks": "0", "process_kernel_time": 0.692484, "process_mem_max_rss": "233192", "process_out_blocks": "4219", "process_user_time": 3.281419}
[0m20:46:20.056726 [debug] [MainThread]: Command `dbt compile` succeeded at 20:46:20.056635 after 5.59 seconds
[0m20:46:20.057067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad3bade0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaca8f590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8cdda4e0>]}
[0m20:46:20.057413 [debug] [MainThread]: Flushing usage events
[0m20:46:21.735472 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:47:12.439352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7be85eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b8fcb00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b9e4410>]}


============================== 20:47:12.445751 | 29ca5826-c92a-4c26-beea-7c7e875aa2cd ==============================
[0m20:47:12.445751 [info ] [MainThread]: Running with dbt=1.10.13
[0m20:47:12.446172 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'use_colors': 'True', 'warn_error': 'None', 'invocation_command': 'dbt compile --select stg_payments', 'no_print': 'None', 'profiles_dir': '/opt/airflow/dbt', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'printer_width': '80', 'partial_parse': 'True', 'empty': 'False', 'introspect': 'True', 'quiet': 'False', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': '/opt/airflow/dbt/logs', 'target_path': 'None', 'cache_selected_only': 'False', 'static_parser': 'True', 'indirect_selection': 'eager', 'write_json': 'True', 'debug': 'False'}
[0m20:47:13.117307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '29ca5826-c92a-4c26-beea-7c7e875aa2cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5ff3acf0>]}
[0m20:47:13.152134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '29ca5826-c92a-4c26-beea-7c7e875aa2cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff61efd6d0>]}
[0m20:47:13.152708 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m20:47:13.232993 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m20:47:13.343150 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m20:47:13.343747 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://macros/cent_to_dollars.sql
[0m20:47:13.344049 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://models/staging/stg_payments.sql
[0m20:47:13.514375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '29ca5826-c92a-4c26-beea-7c7e875aa2cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5f39bc80>]}
[0m20:47:13.671191 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m20:47:13.674125 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m20:47:13.695657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '29ca5826-c92a-4c26-beea-7c7e875aa2cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5f3b4230>]}
[0m20:47:13.696127 [info ] [MainThread]: Found 5 models, 9 data tests, 3 sources, 632 macros
[0m20:47:13.696500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '29ca5826-c92a-4c26-beea-7c7e875aa2cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5f3bb4d0>]}
[0m20:47:13.698056 [info ] [MainThread]: 
[0m20:47:13.698607 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:47:13.699045 [info ] [MainThread]: 
[0m20:47:13.699673 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:47:13.703364 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JAFFLE_SHOP_ANALYTICS'
[0m20:47:13.749064 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP_ANALYTICS"
[0m20:47:13.749510 [debug] [ThreadPool]: On list_JAFFLE_SHOP_ANALYTICS: show objects in JAFFLE_SHOP.ANALYTICS
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_JAFFLE_SHOP_ANALYTICS"} */;
[0m20:47:13.749855 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:47:16.567025 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 2.817 seconds
[0m20:47:16.570664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '29ca5826-c92a-4c26-beea-7c7e875aa2cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5f39b110>]}
[0m20:47:16.575911 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_payments
[0m20:47:16.576425 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_JAFFLE_SHOP_ANALYTICS, now model.jaffle_shop.stg_payments)
[0m20:47:16.576955 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_payments
[0m20:47:16.585729 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_payments"
[0m20:47:16.587439 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_payments
[0m20:47:16.588153 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_payments
[0m20:47:16.589387 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:47:16.589691 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_payments' was left open.
[0m20:47:16.590033 [debug] [MainThread]: On model.jaffle_shop.stg_payments: Close
[0m20:47:16.726570 [debug] [MainThread]: Command end result
[0m20:47:16.751440 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m20:47:16.752906 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m20:47:16.757098 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/target/run_results.json
[0m20:47:16.757338 [info ] [MainThread]: Compiled node 'stg_payments' is:
SELECT
    id as payment_id
    ,order_id
    ,payment_method
    ,ROUND(amount/100,decimals) as amount
FROM JAFFLE_SHOP.RAW.raw_payments
[0m20:47:16.758375 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 4.3562737, "process_in_blocks": "0", "process_kernel_time": 0.536977, "process_mem_max_rss": "233296", "process_out_blocks": "4219", "process_user_time": 3.071346}
[0m20:47:16.758770 [debug] [MainThread]: Command `dbt compile` succeeded at 20:47:16.758707 after 4.36 seconds
[0m20:47:16.759070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c08f6b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c08e990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5c6f7800>]}
[0m20:47:16.759311 [debug] [MainThread]: Flushing usage events
[0m20:47:18.003359 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:47:47.965041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa15476e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0d0e930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa19d5940>]}


============================== 20:47:47.972359 | 6e65cd77-fff2-45f6-99dd-011c0007913c ==============================
[0m20:47:47.972359 [info ] [MainThread]: Running with dbt=1.10.13
[0m20:47:47.972826 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'printer_width': '80', 'log_cache_events': 'False', 'version_check': 'True', 'cache_selected_only': 'False', 'use_colors': 'True', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'partial_parse': 'True', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'empty': 'False', 'debug': 'False', 'warn_error': 'None', 'no_print': 'None', 'invocation_command': 'dbt compile --select stg_payments', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'write_json': 'True', 'quiet': 'False', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m20:47:48.618610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6e65cd77-fff2-45f6-99dd-011c0007913c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff853523f0>]}
[0m20:47:48.653201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6e65cd77-fff2-45f6-99dd-011c0007913c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86043c80>]}
[0m20:47:48.653738 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m20:47:48.734268 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m20:47:48.840616 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:47:48.841177 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://macros/cent_to_dollars.sql
[0m20:47:49.001502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6e65cd77-fff2-45f6-99dd-011c0007913c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84c572c0>]}
[0m20:47:49.109199 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m20:47:49.111231 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m20:47:49.130321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6e65cd77-fff2-45f6-99dd-011c0007913c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84b01700>]}
[0m20:47:49.130692 [info ] [MainThread]: Found 5 models, 9 data tests, 3 sources, 632 macros
[0m20:47:49.130981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6e65cd77-fff2-45f6-99dd-011c0007913c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84c57020>]}
[0m20:47:49.132048 [info ] [MainThread]: 
[0m20:47:49.132352 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:47:49.132620 [info ] [MainThread]: 
[0m20:47:49.133034 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:47:49.135708 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JAFFLE_SHOP_ANALYTICS'
[0m20:47:49.171981 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP_ANALYTICS"
[0m20:47:49.172438 [debug] [ThreadPool]: On list_JAFFLE_SHOP_ANALYTICS: show objects in JAFFLE_SHOP.ANALYTICS
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_JAFFLE_SHOP_ANALYTICS"} */;
[0m20:47:49.172695 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:47:52.126515 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 2.953 seconds
[0m20:47:52.131873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6e65cd77-fff2-45f6-99dd-011c0007913c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84ba3710>]}
[0m20:47:52.138350 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_payments
[0m20:47:52.139146 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_JAFFLE_SHOP_ANALYTICS, now model.jaffle_shop.stg_payments)
[0m20:47:52.139766 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_payments
[0m20:47:52.149452 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_payments"
[0m20:47:52.151596 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_payments
[0m20:47:52.152515 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_payments
[0m20:47:52.153826 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:47:52.154218 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_payments' was left open.
[0m20:47:52.154587 [debug] [MainThread]: On model.jaffle_shop.stg_payments: Close
[0m20:47:53.044001 [debug] [MainThread]: Command end result
[0m20:47:53.097745 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m20:47:53.100093 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m20:47:53.105892 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/target/run_results.json
[0m20:47:53.106194 [info ] [MainThread]: Compiled node 'stg_payments' is:
SELECT
    id as payment_id
    ,order_id
    ,payment_method
    ,ROUND(amount/100, 2) as amount
FROM JAFFLE_SHOP.RAW.raw_payments
[0m20:47:53.107729 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 5.1747723, "process_in_blocks": "0", "process_kernel_time": 0.552493, "process_mem_max_rss": "233156", "process_out_blocks": "4219", "process_user_time": 3.174807}
[0m20:47:53.108233 [debug] [MainThread]: Command `dbt compile` succeeded at 20:47:53.108157 after 5.18 seconds
[0m20:47:53.108646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa18e1be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0c940b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa12e5490>]}
[0m20:47:53.109124 [debug] [MainThread]: Flushing usage events
[0m20:47:54.355897 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:18:11.628368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaceb79e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac8d3ec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaceb7d40>]}


============================== 21:18:11.633864 | 0b881056-4061-49ca-bfd4-b540ff64efa1 ==============================
[0m21:18:11.633864 [info ] [MainThread]: Running with dbt=1.10.13
[0m21:18:11.634263 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'no_print': 'None', 'empty': 'False', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt', 'invocation_command': 'dbt compile --select daily_summary_orders', 'introspect': 'True', 'static_parser': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'printer_width': '80', 'partial_parse': 'True', 'version_check': 'True', 'debug': 'False', 'log_format': 'default', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'write_json': 'True', 'target_path': 'None', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'log_path': '/opt/airflow/dbt/logs'}
[0m21:18:12.241089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0b881056-4061-49ca-bfd4-b540ff64efa1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac7ab530>]}
[0m21:18:12.276337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0b881056-4061-49ca-bfd4-b540ff64efa1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff906ff140>]}
[0m21:18:12.277001 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m21:18:12.352287 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m21:18:12.461462 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 3 files added, 0 files changed.
[0m21:18:12.461958 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://macros/_macros_docs.yml
[0m21:18:12.462187 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://models/marts/marketing/daily_summary_orders.sql
[0m21:18:12.462391 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://macros/cents_to_dollars.sql
[0m21:18:12.462677 [debug] [MainThread]: Partial parsing: deleted file: jaffle_shop://macros/cent_to_dollars.sql
[0m21:18:12.697740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0b881056-4061-49ca-bfd4-b540ff64efa1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8fd20830>]}
[0m21:18:12.753928 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m21:18:12.755402 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m21:18:12.769138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0b881056-4061-49ca-bfd4-b540ff64efa1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8fd47c20>]}
[0m21:18:12.769520 [info ] [MainThread]: Found 6 models, 9 data tests, 3 sources, 632 macros
[0m21:18:12.769797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0b881056-4061-49ca-bfd4-b540ff64efa1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff901ea360>]}
[0m21:18:12.770852 [info ] [MainThread]: 
[0m21:18:12.771171 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:18:12.771496 [info ] [MainThread]: 
[0m21:18:12.771996 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:18:12.774739 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JAFFLE_SHOP_ANALYTICS'
[0m21:18:12.812245 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP_ANALYTICS"
[0m21:18:12.812678 [debug] [ThreadPool]: On list_JAFFLE_SHOP_ANALYTICS: show objects in JAFFLE_SHOP.ANALYTICS
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_JAFFLE_SHOP_ANALYTICS"} */;
[0m21:18:12.812945 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:18:15.626816 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 2.814 seconds
[0m21:18:15.632758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0b881056-4061-49ca-bfd4-b540ff64efa1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90a9aba0>]}
[0m21:18:15.640548 [debug] [Thread-1 (]: Began running node model.jaffle_shop.daily_summary_orders
[0m21:18:15.641241 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_JAFFLE_SHOP_ANALYTICS, now model.jaffle_shop.daily_summary_orders)
[0m21:18:15.641821 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.daily_summary_orders
[0m21:18:15.664041 [debug] [Thread-1 (]: Compilation Error in model daily_summary_orders (models/marts/marketing/daily_summary_orders.sql)
  'db_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m21:18:15.664765 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.daily_summary_orders
[0m21:18:15.665387 [debug] [Thread-7 (]: Marking all children of 'model.jaffle_shop.daily_summary_orders' to be skipped because of status 'error'.  Reason: Compilation Error in model daily_summary_orders (models/marts/marketing/daily_summary_orders.sql)
  'db_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m21:18:15.666561 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:18:15.667098 [debug] [MainThread]: Connection 'model.jaffle_shop.daily_summary_orders' was left open.
[0m21:18:15.667450 [debug] [MainThread]: On model.jaffle_shop.daily_summary_orders: Close
[0m21:18:16.741105 [error] [MainThread]: Encountered an error:
Runtime Error
  Compilation Error in model daily_summary_orders (models/marts/marketing/daily_summary_orders.sql)
    'db_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m21:18:16.745094 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": false, "command_wall_clock_time": 5.1459103, "process_in_blocks": "504", "process_kernel_time": 0.524635, "process_mem_max_rss": "232612", "process_out_blocks": "2865", "process_user_time": 3.051326}
[0m21:18:16.746406 [debug] [MainThread]: Command `dbt compile` failed at 21:18:16.746162 after 5.15 seconds
[0m21:18:16.747327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0d5b110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8fd5df10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e91acf0>]}
[0m21:18:16.748194 [debug] [MainThread]: Flushing usage events
[0m21:18:18.048871 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:18:28.126849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad36bfe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad48a1e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad48b0e0>]}


============================== 21:18:28.142354 | 3b765d6b-dcb1-4697-8d5f-5382af2f5071 ==============================
[0m21:18:28.142354 [info ] [MainThread]: Running with dbt=1.10.13
[0m21:18:28.142958 [debug] [MainThread]: running dbt with arguments {'empty': 'None', 'cache_selected_only': 'False', 'fail_fast': 'False', 'invocation_command': 'dbt deps', 'version_check': 'True', 'indirect_selection': 'eager', 'warn_error': 'None', 'printer_width': '80', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'write_json': 'True', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'static_parser': 'True', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_cache_events': 'False'}
[0m21:18:28.223404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3b765d6b-dcb1-4697-8d5f-5382af2f5071', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac4ff650>]}
[0m21:18:28.335977 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-1s7jdijp'
[0m21:18:28.336783 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m21:18:28.515858 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m21:18:28.517117 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json
[0m21:18:28.683670 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json 200
[0m21:18:28.686766 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m21:18:28.864366 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m21:18:28.868996 [info ] [MainThread]: Installing dbt-labs/codegen
[0m21:18:29.261256 [info ] [MainThread]: Installed from version 0.13.1
[0m21:18:29.261946 [info ] [MainThread]: Up to date!
[0m21:18:29.262539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '3b765d6b-dcb1-4697-8d5f-5382af2f5071', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac4fd1c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac4fd580>]}
[0m21:18:29.263018 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m21:18:29.810950 [info ] [MainThread]: Installed from version 1.3.1
[0m21:18:29.811516 [info ] [MainThread]: Up to date!
[0m21:18:29.812148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '3b765d6b-dcb1-4697-8d5f-5382af2f5071', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac4fc860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac43ba10>]}
[0m21:18:29.814047 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 1.7212771, "process_in_blocks": "0", "process_kernel_time": 0.423726, "process_mem_max_rss": "107648", "process_out_blocks": "1030", "process_user_time": 2.075226}
[0m21:18:29.814495 [debug] [MainThread]: Command `dbt deps` succeeded at 21:18:29.814409 after 1.72 seconds
[0m21:18:29.814895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb140b0e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffacddd1c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac6481d0>]}
[0m21:18:29.815140 [debug] [MainThread]: Flushing usage events
[0m21:18:31.164236 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:18:37.774829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e78f860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa087d820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e0a6180>]}


============================== 21:18:37.782084 | 7621a097-74cb-4f9d-ac6d-7e2fb37aca67 ==============================
[0m21:18:37.782084 [info ] [MainThread]: Running with dbt=1.10.13
[0m21:18:37.782997 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'introspect': 'True', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'indirect_selection': 'eager', 'quiet': 'False', 'static_parser': 'True', 'version_check': 'True', 'empty': 'False', 'invocation_command': 'dbt compile --select daily_summary_orders', 'warn_error': 'None', 'profiles_dir': '/opt/airflow/dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_colors': 'True', 'log_format': 'default', 'debug': 'False', 'target_path': 'None', 'partial_parse': 'True', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'no_print': 'None', 'cache_selected_only': 'False', 'log_path': '/opt/airflow/dbt/logs'}
[0m21:18:38.742276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7621a097-74cb-4f9d-ac6d-7e2fb37aca67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81fdd130>]}
[0m21:18:38.793052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7621a097-74cb-4f9d-ac6d-7e2fb37aca67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e811790>]}
[0m21:18:38.794069 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m21:18:38.931155 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m21:18:39.096417 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:18:39.097304 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://models/marts/marketing/daily_summary_orders.sql
[0m21:18:39.488168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7621a097-74cb-4f9d-ac6d-7e2fb37aca67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff818fdd60>]}
[0m21:18:39.651929 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m21:18:39.654138 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m21:18:39.673312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7621a097-74cb-4f9d-ac6d-7e2fb37aca67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81d065d0>]}
[0m21:18:39.673784 [info ] [MainThread]: Found 6 models, 9 data tests, 3 sources, 632 macros
[0m21:18:39.674265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7621a097-74cb-4f9d-ac6d-7e2fb37aca67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff818f5880>]}
[0m21:18:39.675657 [info ] [MainThread]: 
[0m21:18:39.676301 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:18:39.676756 [info ] [MainThread]: 
[0m21:18:39.677296 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:18:39.680606 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JAFFLE_SHOP_ANALYTICS'
[0m21:18:39.733393 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP_ANALYTICS"
[0m21:18:39.734044 [debug] [ThreadPool]: On list_JAFFLE_SHOP_ANALYTICS: show objects in JAFFLE_SHOP.ANALYTICS
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_JAFFLE_SHOP_ANALYTICS"} */;
[0m21:18:39.734495 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:18:42.617716 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 2.883 seconds
[0m21:18:42.623694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7621a097-74cb-4f9d-ac6d-7e2fb37aca67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff818d0890>]}
[0m21:18:42.630134 [debug] [Thread-1 (]: Began running node model.jaffle_shop.daily_summary_orders
[0m21:18:42.630752 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_JAFFLE_SHOP_ANALYTICS, now model.jaffle_shop.daily_summary_orders)
[0m21:18:42.631287 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.daily_summary_orders
[0m21:18:42.640079 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.daily_summary_orders"
[0m21:18:42.641378 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.daily_summary_orders
[0m21:18:42.642039 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.daily_summary_orders
[0m21:18:42.643254 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:18:42.643553 [debug] [MainThread]: Connection 'model.jaffle_shop.daily_summary_orders' was left open.
[0m21:18:42.643860 [debug] [MainThread]: On model.jaffle_shop.daily_summary_orders: Close
[0m21:18:43.569534 [debug] [MainThread]: Command end result
[0m21:18:43.628377 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m21:18:43.630943 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m21:18:43.636625 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/target/run_results.json
[0m21:18:43.636961 [info ] [MainThread]: Compiled node 'daily_summary_orders' is:
select
    md5(cast(coalesce(cast(customer_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(order_date as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as primary_key
    ,customer_id
    ,order_date
    ,count(*) as c
from JAFFLE_SHOP.ANALYTICS.stg_orders
group by 1,2
[0m21:18:43.638768 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 5.952771, "process_in_blocks": "0", "process_kernel_time": 0.651996, "process_mem_max_rss": "233148", "process_out_blocks": "4239", "process_user_time": 4.156857}
[0m21:18:43.639300 [debug] [MainThread]: Command `dbt compile` succeeded at 21:18:43.639208 after 5.95 seconds
[0m21:18:43.639821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e142600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80ea4770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9dace3c0>]}
[0m21:18:43.640155 [debug] [MainThread]: Flushing usage events
[0m21:18:45.192560 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:18:58.493732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87471f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86ffcb00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff874727e0>]}


============================== 21:18:58.500064 | 17f2b6d9-15ef-405c-8ca7-1297561a4070 ==============================
[0m21:18:58.500064 [info ] [MainThread]: Running with dbt=1.10.13
[0m21:18:58.500533 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'printer_width': '80', 'partial_parse': 'True', 'warn_error': 'None', 'write_json': 'True', 'profiles_dir': '/opt/airflow/dbt', 'static_parser': 'True', 'empty': 'False', 'debug': 'False', 'log_format': 'default', 'introspect': 'True', 'use_colors': 'True', 'quiet': 'False', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'invocation_command': 'dbt run --select daily_summary_orders', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None'}
[0m21:18:59.169929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '17f2b6d9-15ef-405c-8ca7-1297561a4070', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87a545c0>]}
[0m21:18:59.208834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '17f2b6d9-15ef-405c-8ca7-1297561a4070', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6b54a300>]}
[0m21:18:59.209604 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m21:18:59.283302 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m21:18:59.395342 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:18:59.395734 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:18:59.422612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '17f2b6d9-15ef-405c-8ca7-1297561a4070', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6b2d4590>]}
[0m21:18:59.480204 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m21:18:59.481886 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m21:18:59.496597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '17f2b6d9-15ef-405c-8ca7-1297561a4070', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6b2d5a30>]}
[0m21:18:59.496970 [info ] [MainThread]: Found 6 models, 9 data tests, 3 sources, 632 macros
[0m21:18:59.497249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '17f2b6d9-15ef-405c-8ca7-1297561a4070', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6ae455e0>]}
[0m21:18:59.498253 [info ] [MainThread]: 
[0m21:18:59.498536 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:18:59.498847 [info ] [MainThread]: 
[0m21:18:59.499306 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:18:59.499966 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JAFFLE_SHOP'
[0m21:18:59.531860 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP"
[0m21:18:59.532235 [debug] [ThreadPool]: On list_JAFFLE_SHOP: show terse schemas in database JAFFLE_SHOP
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_JAFFLE_SHOP"} */
[0m21:18:59.532441 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:19:00.492103 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.959 seconds
[0m21:19:00.500437 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_JAFFLE_SHOP, now list_JAFFLE_SHOP_ANALYTICS)
[0m21:19:00.523237 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP_ANALYTICS"
[0m21:19:00.524321 [debug] [ThreadPool]: On list_JAFFLE_SHOP_ANALYTICS: show objects in JAFFLE_SHOP.ANALYTICS
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_JAFFLE_SHOP_ANALYTICS"} */;
[0m21:19:00.640912 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.116 seconds
[0m21:19:00.643990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '17f2b6d9-15ef-405c-8ca7-1297561a4070', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6aea8290>]}
[0m21:19:00.648612 [debug] [Thread-1 (]: Began running node model.jaffle_shop.daily_summary_orders
[0m21:19:00.649232 [info ] [Thread-1 (]: 1 of 1 START sql table model ANALYTICS.daily_summary_orders .................... [RUN]
[0m21:19:00.650045 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_JAFFLE_SHOP_ANALYTICS, now model.jaffle_shop.daily_summary_orders)
[0m21:19:00.650565 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.daily_summary_orders
[0m21:19:00.674074 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.daily_summary_orders"
[0m21:19:00.676468 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.daily_summary_orders
[0m21:19:00.700960 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.daily_summary_orders"
[0m21:19:00.702248 [debug] [Thread-1 (]: Using snowflake connection "model.jaffle_shop.daily_summary_orders"
[0m21:19:00.702508 [debug] [Thread-1 (]: On model.jaffle_shop.daily_summary_orders: create or replace transient table JAFFLE_SHOP.ANALYTICS.daily_summary_orders
    
    
    
    as (select
    md5(cast(coalesce(cast(customer_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(order_date as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as primary_key
    ,customer_id
    ,order_date
    ,count(*) as c
from JAFFLE_SHOP.ANALYTICS.stg_orders
group by 1,2
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.daily_summary_orders"} */;
[0m21:19:01.778549 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bfe35f-0305-5ad3-0004-0c2600053946
[0m21:19:01.779975 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001104 (42601): SQL compilation error: error line 8 at position 5
'STG_ORDERS.ORDER_DATE' in select clause is neither an aggregate nor in the group by clause.
[0m21:19:01.785875 [debug] [Thread-1 (]: Database Error in model daily_summary_orders (models/marts/marketing/daily_summary_orders.sql)
  001104 (42601): SQL compilation error: error line 8 at position 5
  'STG_ORDERS.ORDER_DATE' in select clause is neither an aggregate nor in the group by clause.
  compiled code at target/run/jaffle_shop/models/marts/marketing/daily_summary_orders.sql
[0m21:19:01.789072 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '17f2b6d9-15ef-405c-8ca7-1297561a4070', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87b94e00>]}
[0m21:19:01.790300 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model ANALYTICS.daily_summary_orders ........... [[31mERROR[0m in 1.14s]
[0m21:19:01.791389 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.daily_summary_orders
[0m21:19:01.792420 [debug] [Thread-7 (]: Marking all children of 'model.jaffle_shop.daily_summary_orders' to be skipped because of status 'error'.  Reason: Database Error in model daily_summary_orders (models/marts/marketing/daily_summary_orders.sql)
  001104 (42601): SQL compilation error: error line 8 at position 5
  'STG_ORDERS.ORDER_DATE' in select clause is neither an aggregate nor in the group by clause.
  compiled code at target/run/jaffle_shop/models/marts/marketing/daily_summary_orders.sql.
[0m21:19:01.795575 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:19:01.796225 [debug] [MainThread]: Connection 'model.jaffle_shop.daily_summary_orders' was left open.
[0m21:19:01.796819 [debug] [MainThread]: On model.jaffle_shop.daily_summary_orders: Close
[0m21:19:01.932545 [info ] [MainThread]: 
[0m21:19:01.933703 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.43 seconds (2.43s).
[0m21:19:01.935262 [debug] [MainThread]: Command end result
[0m21:19:01.976142 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m21:19:01.978031 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m21:19:01.983183 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/target/run_results.json
[0m21:19:01.983582 [info ] [MainThread]: 
[0m21:19:01.984133 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m21:19:01.984587 [info ] [MainThread]: 
[0m21:19:01.984995 [error] [MainThread]: [31mFailure in model daily_summary_orders (models/marts/marketing/daily_summary_orders.sql)[0m
[0m21:19:01.985468 [error] [MainThread]:   Database Error in model daily_summary_orders (models/marts/marketing/daily_summary_orders.sql)
  001104 (42601): SQL compilation error: error line 8 at position 5
  'STG_ORDERS.ORDER_DATE' in select clause is neither an aggregate nor in the group by clause.
  compiled code at target/run/jaffle_shop/models/marts/marketing/daily_summary_orders.sql
[0m21:19:01.986055 [info ] [MainThread]: 
[0m21:19:01.986689 [info ] [MainThread]:   compiled code at target/compiled/jaffle_shop/models/marts/marketing/daily_summary_orders.sql
[0m21:19:01.986945 [info ] [MainThread]: 
[0m21:19:01.987306 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m21:19:01.988461 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.5291903, "process_in_blocks": "0", "process_kernel_time": 0.60404, "process_mem_max_rss": "231864", "process_out_blocks": "2846", "process_user_time": 3.049347}
[0m21:19:01.988957 [debug] [MainThread]: Command `dbt run` failed at 21:19:01.988879 after 3.53 seconds
[0m21:19:01.989289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87f529f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff874727e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87471f40>]}
[0m21:19:01.989561 [debug] [MainThread]: Flushing usage events
[0m21:19:03.234006 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:19:17.057259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffab1b7560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaac25e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffada9f500>]}


============================== 21:19:17.063019 | 2901f186-0f2d-4417-aae7-2fe848cabcd0 ==============================
[0m21:19:17.063019 [info ] [MainThread]: Running with dbt=1.10.13
[0m21:19:17.063499 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'use_colors': 'True', 'write_json': 'True', 'warn_error': 'None', 'static_parser': 'True', 'no_print': 'None', 'introspect': 'True', 'printer_width': '80', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'quiet': 'False', 'version_check': 'True', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'empty': 'False', 'target_path': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --select daily_summary_orders', 'debug': 'False'}
[0m21:19:17.673082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2901f186-0f2d-4417-aae7-2fe848cabcd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90745340>]}
[0m21:19:17.707856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2901f186-0f2d-4417-aae7-2fe848cabcd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f77a0c0>]}
[0m21:19:17.708430 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m21:19:17.785410 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m21:19:17.885252 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:19:17.885725 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://models/marts/marketing/daily_summary_orders.sql
[0m21:19:18.044335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2901f186-0f2d-4417-aae7-2fe848cabcd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e9dde80>]}
[0m21:19:18.154213 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m21:19:18.155614 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m21:19:18.169712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2901f186-0f2d-4417-aae7-2fe848cabcd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ead83e0>]}
[0m21:19:18.170084 [info ] [MainThread]: Found 6 models, 9 data tests, 3 sources, 632 macros
[0m21:19:18.170370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2901f186-0f2d-4417-aae7-2fe848cabcd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ede6960>]}
[0m21:19:18.171385 [info ] [MainThread]: 
[0m21:19:18.171666 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:19:18.171923 [info ] [MainThread]: 
[0m21:19:18.172352 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:19:18.173049 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JAFFLE_SHOP'
[0m21:19:18.203263 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP"
[0m21:19:18.203641 [debug] [ThreadPool]: On list_JAFFLE_SHOP: show terse schemas in database JAFFLE_SHOP
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_JAFFLE_SHOP"} */
[0m21:19:18.203900 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:19:20.923542 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2.720 seconds
[0m21:19:20.928564 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_JAFFLE_SHOP, now list_JAFFLE_SHOP_ANALYTICS)
[0m21:19:20.937796 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP_ANALYTICS"
[0m21:19:20.938221 [debug] [ThreadPool]: On list_JAFFLE_SHOP_ANALYTICS: show objects in JAFFLE_SHOP.ANALYTICS
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_JAFFLE_SHOP_ANALYTICS"} */;
[0m21:19:21.092344 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.154 seconds
[0m21:19:21.095304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2901f186-0f2d-4417-aae7-2fe848cabcd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffab365fa0>]}
[0m21:19:21.099529 [debug] [Thread-1 (]: Began running node model.jaffle_shop.daily_summary_orders
[0m21:19:21.100095 [info ] [Thread-1 (]: 1 of 1 START sql table model ANALYTICS.daily_summary_orders .................... [RUN]
[0m21:19:21.100698 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_JAFFLE_SHOP_ANALYTICS, now model.jaffle_shop.daily_summary_orders)
[0m21:19:21.101089 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.daily_summary_orders
[0m21:19:21.110499 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.daily_summary_orders"
[0m21:19:21.111711 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.daily_summary_orders
[0m21:19:21.132675 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.daily_summary_orders"
[0m21:19:21.133782 [debug] [Thread-1 (]: Using snowflake connection "model.jaffle_shop.daily_summary_orders"
[0m21:19:21.134059 [debug] [Thread-1 (]: On model.jaffle_shop.daily_summary_orders: create or replace transient table JAFFLE_SHOP.ANALYTICS.daily_summary_orders
    
    
    
    as (select
    md5(cast(coalesce(cast(customer_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(order_date as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as primary_key
    ,customer_id
    ,order_date
    ,count(*) as c
from JAFFLE_SHOP.ANALYTICS.stg_orders
group by 1,2,3
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.daily_summary_orders"} */;
[0m21:19:23.287247 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.152 seconds
[0m21:19:23.314294 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2901f186-0f2d-4417-aae7-2fe848cabcd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffab8a0cb0>]}
[0m21:19:23.315267 [info ] [Thread-1 (]: 1 of 1 OK created sql table model ANALYTICS.daily_summary_orders ............... [[32mSUCCESS 1[0m in 2.21s]
[0m21:19:23.316228 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.daily_summary_orders
[0m21:19:23.318319 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:19:23.318782 [debug] [MainThread]: Connection 'model.jaffle_shop.daily_summary_orders' was left open.
[0m21:19:23.319188 [debug] [MainThread]: On model.jaffle_shop.daily_summary_orders: Close
[0m21:19:23.454589 [info ] [MainThread]: 
[0m21:19:23.455949 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.28 seconds (5.28s).
[0m21:19:23.457908 [debug] [MainThread]: Command end result
[0m21:19:23.509333 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m21:19:23.511552 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m21:19:23.516422 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/target/run_results.json
[0m21:19:23.516720 [info ] [MainThread]: 
[0m21:19:23.517228 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:19:23.517657 [info ] [MainThread]: 
[0m21:19:23.518080 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m21:19:23.519460 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.4988074, "process_in_blocks": "0", "process_kernel_time": 0.453414, "process_mem_max_rss": "233160", "process_out_blocks": "4245", "process_user_time": 3.413233}
[0m21:19:23.519983 [debug] [MainThread]: Command `dbt run` succeeded at 21:19:23.519907 after 6.50 seconds
[0m21:19:23.520459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa9f31a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaac9a4e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ec15a90>]}
[0m21:19:23.520860 [debug] [MainThread]: Flushing usage events
[0m21:19:24.906990 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:21:22.471971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d2b3a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d549fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f6d18e0>]}


============================== 21:21:22.478841 | f24e8ff6-8d34-471d-b4f2-ebf7a29fd292 ==============================
[0m21:21:22.478841 [info ] [MainThread]: Running with dbt=1.10.13
[0m21:21:22.479369 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'introspect': 'True', 'debug': 'False', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'fail_fast': 'False', 'write_json': 'True', 'no_print': 'None', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'empty': 'None', 'static_parser': 'True', 'log_path': '/opt/airflow/dbt/logs', 'use_colors': 'True', 'quiet': 'False', 'log_cache_events': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'invocation_command': 'dbt deps'}
[0m21:21:22.574947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f24e8ff6-8d34-471d-b4f2-ebf7a29fd292', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c3eb8f0>]}
[0m21:21:22.588487 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-fnd37_by'
[0m21:21:22.589134 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m21:21:22.759649 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m21:21:22.761956 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json
[0m21:21:22.928035 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json 200
[0m21:21:22.935013 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m21:21:23.101737 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m21:21:23.107283 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/gitlabhq/snowflake_spend.json
[0m21:21:23.484689 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/gitlabhq/snowflake_spend.json 200
[0m21:21:23.509340 [info ] [MainThread]: Updating lock file in file path: /opt/airflow/dbt/package-lock.yml
[0m21:21:23.591760 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-c_lvi9gr'
[0m21:21:23.594698 [info ] [MainThread]: Installing dbt-labs/codegen
[0m21:21:24.018754 [info ] [MainThread]: Installed from version 0.13.1
[0m21:21:24.019431 [info ] [MainThread]: Up to date!
[0m21:21:24.020153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'f24e8ff6-8d34-471d-b4f2-ebf7a29fd292', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c24b4a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c98d700>]}
[0m21:21:24.020630 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m21:21:24.584362 [info ] [MainThread]: Installed from version 1.3.1
[0m21:21:24.585110 [info ] [MainThread]: Up to date!
[0m21:21:24.586057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'f24e8ff6-8d34-471d-b4f2-ebf7a29fd292', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c210ec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c248710>]}
[0m21:21:24.586732 [info ] [MainThread]: Installing gitlabhq/snowflake_spend
[0m21:21:25.146719 [info ] [MainThread]: Installed from version 1.4.0
[0m21:21:25.147775 [info ] [MainThread]: Up to date!
[0m21:21:25.148527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'f24e8ff6-8d34-471d-b4f2-ebf7a29fd292', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c06bfe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c15e090>]}
[0m21:21:25.150757 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 2.7089188, "process_in_blocks": "0", "process_kernel_time": 0.469225, "process_mem_max_rss": "108128", "process_out_blocks": "3295", "process_user_time": 1.744557}
[0m21:21:25.151459 [debug] [MainThread]: Command `dbt deps` succeeded at 21:21:25.151300 after 2.71 seconds
[0m21:21:25.151986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c5a4fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7cc947a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c2eda90>]}
[0m21:21:25.152620 [debug] [MainThread]: Flushing usage events
[0m21:21:26.436557 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:25:19.825657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8a4d970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbb10d730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb90117c0>]}


============================== 21:25:19.831157 | 48f64148-e141-4d2f-a820-b2135716ec0c ==============================
[0m21:25:19.831157 [info ] [MainThread]: Running with dbt=1.10.13
[0m21:25:19.831635 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'write_json': 'True', 'cache_selected_only': 'False', 'static_parser': 'True', 'profiles_dir': '/opt/airflow/dbt', 'target_path': 'None', 'version_check': 'True', 'no_print': 'None', 'log_path': '/opt/airflow/dbt/logs', 'send_anonymous_usage_stats': 'True', 'empty': 'None', 'indirect_selection': 'eager', 'log_format': 'default', 'invocation_command': 'dbt seed', 'use_colors': 'True', 'introspect': 'True', 'printer_width': '80', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'debug': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True'}
[0m21:25:20.412196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '48f64148-e141-4d2f-a820-b2135716ec0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9cc811f0>]}
[0m21:25:20.447914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '48f64148-e141-4d2f-a820-b2135716ec0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ca82210>]}
[0m21:25:20.448790 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m21:25:20.523824 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m21:25:20.524332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '48f64148-e141-4d2f-a820-b2135716ec0c', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c7a9fa0>]}
[0m21:25:20.524766 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m21:25:20.525178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '48f64148-e141-4d2f-a820-b2135716ec0c', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c755070>]}
[0m21:25:20.527175 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m21:25:20.606566 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m21:25:20.607076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '48f64148-e141-4d2f-a820-b2135716ec0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c466510>]}
[0m21:25:21.932953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '48f64148-e141-4d2f-a820-b2135716ec0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b3cc3e0>]}
[0m21:25:22.005368 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m21:25:22.007225 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m21:25:22.025296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '48f64148-e141-4d2f-a820-b2135716ec0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9bb76570>]}
[0m21:25:22.025652 [info ] [MainThread]: Found 10 models, 1 seed, 6 analyses, 19 data tests, 5 sources, 632 macros
[0m21:25:22.026022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '48f64148-e141-4d2f-a820-b2135716ec0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9bb678f0>]}
[0m21:25:22.027491 [info ] [MainThread]: 
[0m21:25:22.027765 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:25:22.028064 [info ] [MainThread]: 
[0m21:25:22.028551 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:25:22.029316 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JAFFLE_SHOP'
[0m21:25:22.057013 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP"
[0m21:25:22.057415 [debug] [ThreadPool]: On list_JAFFLE_SHOP: show terse schemas in database JAFFLE_SHOP
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_JAFFLE_SHOP"} */
[0m21:25:22.057621 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:25:25.036452 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2.978 seconds
[0m21:25:25.051122 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_JAFFLE_SHOP, now list_JAFFLE_SHOP_ANALYTICS)
[0m21:25:25.069682 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP_ANALYTICS"
[0m21:25:25.070340 [debug] [ThreadPool]: On list_JAFFLE_SHOP_ANALYTICS: show objects in JAFFLE_SHOP.ANALYTICS
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_JAFFLE_SHOP_ANALYTICS"} */;
[0m21:25:25.204269 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.133 seconds
[0m21:25:25.210135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '48f64148-e141-4d2f-a820-b2135716ec0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9af17d10>]}
[0m21:25:25.218819 [debug] [Thread-1 (]: Began running node seed.jaffle_shop.snowflake_contract_rates
[0m21:25:25.219844 [info ] [Thread-1 (]: 1 of 1 START seed file ANALYTICS.snowflake_contract_rates ...................... [RUN]
[0m21:25:25.220858 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_JAFFLE_SHOP_ANALYTICS, now seed.jaffle_shop.snowflake_contract_rates)
[0m21:25:25.221646 [debug] [Thread-1 (]: Began compiling node seed.jaffle_shop.snowflake_contract_rates
[0m21:25:25.222292 [debug] [Thread-1 (]: Began executing node seed.jaffle_shop.snowflake_contract_rates
[0m21:25:25.262752 [debug] [Thread-1 (]: Using snowflake connection "seed.jaffle_shop.snowflake_contract_rates"
[0m21:25:25.263276 [debug] [Thread-1 (]: On seed.jaffle_shop.snowflake_contract_rates: create table JAFFLE_SHOP.ANALYTICS.snowflake_contract_rates (effective_date date,rate float8)
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.snowflake_contract_rates"} */
[0m21:25:25.444011 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.180 seconds
[0m21:25:25.457766 [debug] [Thread-1 (]: Using snowflake connection "seed.jaffle_shop.snowflake_contract_rates"
[0m21:25:25.458305 [debug] [Thread-1 (]: On seed.jaffle_shop.snowflake_contract_rates: BEGIN
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.snowflake_contract_rates"} */
[0m21:25:25.568167 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.109 seconds
[0m21:25:25.569570 [debug] [Thread-1 (]: Using snowflake connection "seed.jaffle_shop.snowflake_contract_rates"
[0m21:25:25.570361 [debug] [Thread-1 (]: On seed.jaffle_shop.snowflake_contract_rates: insert into JAFFLE_SHOP.ANALYTICS.snowflake_contract_rates (effective_date, rate) values
            (%s,%s),(%s,%s)
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.snowflake_contract_rates"} */...
[0m21:25:26.307753 [debug] [Thread-1 (]: SQL status: SUCCESS 2 in 0.736 seconds
[0m21:25:26.310238 [debug] [Thread-1 (]: Using snowflake connection "seed.jaffle_shop.snowflake_contract_rates"
[0m21:25:26.311333 [debug] [Thread-1 (]: On seed.jaffle_shop.snowflake_contract_rates: COMMIT
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.snowflake_contract_rates"} */
[0m21:25:26.523216 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.209 seconds
[0m21:25:26.540998 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.jaffle_shop.snowflake_contract_rates"
[0m21:25:26.597168 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '48f64148-e141-4d2f-a820-b2135716ec0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99931a60>]}
[0m21:25:26.597908 [info ] [Thread-1 (]: 1 of 1 OK loaded seed file ANALYTICS.snowflake_contract_rates .................. [[32mINSERT 2[0m in 1.38s]
[0m21:25:26.598663 [debug] [Thread-1 (]: Finished running node seed.jaffle_shop.snowflake_contract_rates
[0m21:25:26.601021 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:25:26.601532 [debug] [MainThread]: Connection 'seed.jaffle_shop.snowflake_contract_rates' was left open.
[0m21:25:26.601887 [debug] [MainThread]: On seed.jaffle_shop.snowflake_contract_rates: Close
[0m21:25:27.408435 [info ] [MainThread]: 
[0m21:25:27.411030 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 5.38 seconds (5.38s).
[0m21:25:27.413836 [debug] [MainThread]: Command end result
[0m21:25:27.488674 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m21:25:27.491169 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m21:25:27.496506 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/target/run_results.json
[0m21:25:27.496958 [info ] [MainThread]: 
[0m21:25:27.497507 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:25:27.497946 [info ] [MainThread]: 
[0m21:25:27.498429 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m21:25:27.499094 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ConfigSourcePathDeprecation: 1 occurrence
- ConfigDataPathDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m21:25:27.500904 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 7.704714, "process_in_blocks": "296", "process_kernel_time": 0.534968, "process_mem_max_rss": "239968", "process_out_blocks": "4652", "process_user_time": 4.399409}
[0m21:25:27.501493 [debug] [MainThread]: Command `dbt seed` succeeded at 21:25:27.501376 after 7.71 seconds
[0m21:25:27.501972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb80cde80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b388fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb88addc0>]}
[0m21:25:27.502356 [debug] [MainThread]: Flushing usage events
[0m21:25:28.865444 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:26:38.871927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83c01d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83312b40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83c00260>]}


============================== 21:26:38.878599 | abdad6bb-056b-4513-9370-e47661b8fc32 ==============================
[0m21:26:38.878599 [info ] [MainThread]: Running with dbt=1.10.13
[0m21:26:38.879021 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'no_print': 'None', 'empty': 'False', 'target_path': 'None', 'printer_width': '80', 'log_path': '/opt/airflow/dbt/logs', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'introspect': 'True', 'static_parser': 'True', 'write_json': 'True', 'use_experimental_parser': 'False', 'log_format': 'default', 'profiles_dir': '/opt/airflow/dbt', 'log_cache_events': 'False', 'invocation_command': 'dbt build', 'version_check': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'indirect_selection': 'eager'}
[0m21:26:39.559871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'abdad6bb-056b-4513-9370-e47661b8fc32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff68b541a0>]}
[0m21:26:39.597066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'abdad6bb-056b-4513-9370-e47661b8fc32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff67a8a2d0>]}
[0m21:26:39.597720 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m21:26:39.684386 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m21:26:39.684828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'abdad6bb-056b-4513-9370-e47661b8fc32', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff677df980>]}
[0m21:26:39.685244 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m21:26:39.685521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'abdad6bb-056b-4513-9370-e47661b8fc32', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff680ff680>]}
[0m21:26:39.687582 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m21:26:39.782788 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m21:26:39.783271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'abdad6bb-056b-4513-9370-e47661b8fc32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff838b5ac0>]}
[0m21:26:41.025299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'abdad6bb-056b-4513-9370-e47661b8fc32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff66b05340>]}
[0m21:26:41.094231 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m21:26:41.096045 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m21:26:41.125518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'abdad6bb-056b-4513-9370-e47661b8fc32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff66ff5580>]}
[0m21:26:41.125914 [info ] [MainThread]: Found 10 models, 1 seed, 6 analyses, 19 data tests, 5 sources, 632 macros
[0m21:26:41.128220 [info ] [MainThread]: 
[0m21:26:41.128598 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:26:41.128883 [info ] [MainThread]: 
[0m21:26:41.129365 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:26:41.132255 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JAFFLE_SHOP'
[0m21:26:41.161882 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP"
[0m21:26:41.162279 [debug] [ThreadPool]: On list_JAFFLE_SHOP: show terse schemas in database JAFFLE_SHOP
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_JAFFLE_SHOP"} */
[0m21:26:41.162486 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:26:43.067074 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.904 seconds
[0m21:26:43.073580 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_JAFFLE_SHOP, now list_JAFFLE_SHOP_ANALYTICS)
[0m21:26:43.093735 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP_ANALYTICS"
[0m21:26:43.094560 [debug] [ThreadPool]: On list_JAFFLE_SHOP_ANALYTICS: show objects in JAFFLE_SHOP.ANALYTICS
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_JAFFLE_SHOP_ANALYTICS"} */;
[0m21:26:43.197494 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.102 seconds
[0m21:26:43.203021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'abdad6bb-056b-4513-9370-e47661b8fc32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff66f9fcb0>]}
[0m21:26:43.212459 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_payments
[0m21:26:43.213134 [debug] [Thread-2 (]: Began running node model.snowflake_spend.snowflake_query_history
[0m21:26:43.213758 [debug] [Thread-3 (]: Began running node model.snowflake_spend.snowflake_warehouse_metering
[0m21:26:43.215220 [debug] [Thread-4 (]: Began running node seed.jaffle_shop.snowflake_contract_rates
[0m21:26:43.214521 [info ] [Thread-1 (]: 1 of 30 START sql view model ANALYTICS.stg_payments ............................ [RUN]
[0m21:26:43.216579 [info ] [Thread-2 (]: 2 of 30 START sql incremental model ANALYTICS.snowflake_query_history .......... [RUN]
[0m21:26:43.217512 [info ] [Thread-3 (]: 3 of 30 START sql view model ANALYTICS.snowflake_warehouse_metering ............ [RUN]
[0m21:26:43.218534 [info ] [Thread-4 (]: 4 of 30 START seed file ANALYTICS.snowflake_contract_rates ..................... [RUN]
[0m21:26:43.221780 [debug] [Thread-4 (]: Acquiring new snowflake connection 'seed.jaffle_shop.snowflake_contract_rates'
[0m21:26:43.220362 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.snowflake_spend.snowflake_query_history'
[0m21:26:43.221121 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.snowflake_spend.snowflake_warehouse_metering'
[0m21:26:43.219492 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_JAFFLE_SHOP_ANALYTICS, now model.jaffle_shop.stg_payments)
[0m21:26:43.222332 [debug] [Thread-4 (]: Began compiling node seed.jaffle_shop.snowflake_contract_rates
[0m21:26:43.222938 [debug] [Thread-2 (]: Began compiling node model.snowflake_spend.snowflake_query_history
[0m21:26:43.223501 [debug] [Thread-3 (]: Began compiling node model.snowflake_spend.snowflake_warehouse_metering
[0m21:26:43.224031 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_payments
[0m21:26:43.224654 [debug] [Thread-4 (]: Began executing node seed.jaffle_shop.snowflake_contract_rates
[0m21:26:43.235929 [debug] [Thread-2 (]: Writing injected SQL for node "model.snowflake_spend.snowflake_query_history"
[0m21:26:43.239202 [debug] [Thread-3 (]: Writing injected SQL for node "model.snowflake_spend.snowflake_warehouse_metering"
[0m21:26:43.242338 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_payments"
[0m21:26:43.272704 [debug] [Thread-4 (]: Using snowflake connection "seed.jaffle_shop.snowflake_contract_rates"
[0m21:26:43.273224 [debug] [Thread-4 (]: On seed.jaffle_shop.snowflake_contract_rates: BEGIN
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.snowflake_contract_rates"} */
[0m21:26:43.273773 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m21:26:43.274260 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_payments
[0m21:26:43.293188 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_payments"
[0m21:26:43.295977 [debug] [Thread-2 (]: Began executing node model.snowflake_spend.snowflake_query_history
[0m21:26:43.326354 [debug] [Thread-2 (]: Writing runtime sql for node "model.snowflake_spend.snowflake_query_history"
[0m21:26:43.326699 [debug] [Thread-3 (]: Began executing node model.snowflake_spend.snowflake_warehouse_metering
[0m21:26:43.328864 [debug] [Thread-3 (]: Writing runtime sql for node "model.snowflake_spend.snowflake_warehouse_metering"
[0m21:26:43.329325 [debug] [Thread-1 (]: Using snowflake connection "model.jaffle_shop.stg_payments"
[0m21:26:43.329953 [debug] [Thread-1 (]: On model.jaffle_shop.stg_payments: create or replace   view JAFFLE_SHOP.ANALYTICS.stg_payments
  
  
  
  
  as (
    SELECT
    id as payment_id
    ,order_id
    ,payment_method
    ,ROUND(amount/100, 2) as amount
FROM JAFFLE_SHOP.RAW.raw_payments
  )
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */;
[0m21:26:43.334577 [debug] [Thread-3 (]: Using snowflake connection "model.snowflake_spend.snowflake_warehouse_metering"
[0m21:26:43.334872 [debug] [Thread-3 (]: On model.snowflake_spend.snowflake_warehouse_metering: create or replace   view JAFFLE_SHOP.ANALYTICS.snowflake_warehouse_metering
  
  
  
  
  as (
    WITH base AS (

	SELECT *
	FROM snowflake.account_usage.warehouse_metering_history

)

SELECT
  warehouse_id,
  warehouse_name,
  start_time,
  end_time,
  credits_used
FROM base
  )
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.snowflake_spend.snowflake_warehouse_metering"} */;
[0m21:26:43.335813 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m21:26:43.336714 [debug] [Thread-2 (]: Using snowflake connection "model.snowflake_spend.snowflake_query_history"
[0m21:26:43.340470 [debug] [Thread-2 (]: On model.snowflake_spend.snowflake_query_history: create or replace transient table JAFFLE_SHOP.ANALYTICS.snowflake_query_history
    
    
    
    as (


WITH source AS (

  SELECT *
  FROM snowflake.account_usage.query_history
  QUALIFY ROW_NUMBER() OVER (PARTITION BY query_id ORDER BY query_id) = 1

), renamed AS (

  SELECT 
    query_id                          AS snowflake_query_id,

    -- Foreign Keys
    database_id                       AS database_id,
    schema_id                         AS schema_id,
    session_id                        AS snowflake_session_id,
    warehouse_id                      AS warehouse_id,

    -- Logical Info
    database_name                     AS database_name,
    query_text                        AS query_text,
    role_name                         AS snowflake_role_name,
    rows_produced                     AS query_result_rows_produced,
    schema_name                       AS schema_name,
    user_name                         AS snowflake_user_name,
    warehouse_name                    AS warehouse_name,

    -- metadata 
    end_time                          AS query_end_time,
    start_time                        AS query_start_time,
    bytes_spilled_to_local_storage    AS query_bytes_spillover_local,
    bytes_spilled_to_remote_storage   AS query_bytes_spillover_remote,
    bytes_scanned                     AS query_bytes_scanned

  FROM source
  
  
)

SELECT * 
FROM renamed
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.snowflake_spend.snowflake_query_history"} */;
[0m21:26:43.342991 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m21:26:43.560040 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.230 seconds
[0m21:26:43.577566 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'abdad6bb-056b-4513-9370-e47661b8fc32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83fccf50>]}
[0m21:26:43.578137 [info ] [Thread-1 (]: 1 of 30 OK created sql view model ANALYTICS.stg_payments ....................... [[32mSUCCESS 1[0m in 0.36s]
[0m21:26:43.578726 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_payments
[0m21:26:43.579125 [debug] [Thread-1 (]: Began running node test.jaffle_shop.source_not_null_jaffle_shop_raw_customers_id.0848441319
[0m21:26:43.579490 [info ] [Thread-1 (]: 5 of 30 START test source_not_null_jaffle_shop_raw_customers_id ................ [RUN]
[0m21:26:43.579899 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_payments, now test.jaffle_shop.source_not_null_jaffle_shop_raw_customers_id.0848441319)
[0m21:26:43.580210 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.source_not_null_jaffle_shop_raw_customers_id.0848441319
[0m21:26:43.585658 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.source_not_null_jaffle_shop_raw_customers_id.0848441319"
[0m21:26:43.587293 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.source_not_null_jaffle_shop_raw_customers_id.0848441319
[0m21:26:43.600779 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_shop.source_not_null_jaffle_shop_raw_customers_id.0848441319"
[0m21:26:43.610441 [debug] [Thread-1 (]: Using snowflake connection "test.jaffle_shop.source_not_null_jaffle_shop_raw_customers_id.0848441319"
[0m21:26:43.610764 [debug] [Thread-1 (]: On test.jaffle_shop.source_not_null_jaffle_shop_raw_customers_id.0848441319: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id
from JAFFLE_SHOP.RAW.raw_customers
where id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.source_not_null_jaffle_shop_raw_customers_id.0848441319"} */
[0m21:26:43.814121 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.540 seconds
[0m21:26:43.815588 [debug] [Thread-4 (]: Using snowflake connection "seed.jaffle_shop.snowflake_contract_rates"
[0m21:26:43.816681 [debug] [Thread-4 (]: On seed.jaffle_shop.snowflake_contract_rates: truncate table "JAFFLE_SHOP"."ANALYTICS"."SNOWFLAKE_CONTRACT_RATES"
  
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.snowflake_contract_rates"} */;
[0m21:26:43.997082 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.386 seconds
[0m21:26:44.005877 [info ] [Thread-1 (]: 5 of 30 PASS source_not_null_jaffle_shop_raw_customers_id ...................... [[32mPASS[0m in 0.43s]
[0m21:26:44.007351 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.source_not_null_jaffle_shop_raw_customers_id.0848441319
[0m21:26:44.008242 [debug] [Thread-1 (]: Began running node test.jaffle_shop.source_not_null_jaffle_shop_raw_orders_id.48f68cd946
[0m21:26:44.009214 [info ] [Thread-1 (]: 6 of 30 START test source_not_null_jaffle_shop_raw_orders_id ................... [RUN]
[0m21:26:44.010340 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.source_not_null_jaffle_shop_raw_customers_id.0848441319, now test.jaffle_shop.source_not_null_jaffle_shop_raw_orders_id.48f68cd946)
[0m21:26:44.011442 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.source_not_null_jaffle_shop_raw_orders_id.48f68cd946
[0m21:26:44.018336 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.source_not_null_jaffle_shop_raw_orders_id.48f68cd946"
[0m21:26:44.020011 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.source_not_null_jaffle_shop_raw_orders_id.48f68cd946
[0m21:26:44.023571 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_shop.source_not_null_jaffle_shop_raw_orders_id.48f68cd946"
[0m21:26:44.025250 [debug] [Thread-1 (]: Using snowflake connection "test.jaffle_shop.source_not_null_jaffle_shop_raw_orders_id.48f68cd946"
[0m21:26:44.025776 [debug] [Thread-1 (]: On test.jaffle_shop.source_not_null_jaffle_shop_raw_orders_id.48f68cd946: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id
from JAFFLE_SHOP.RAW.raw_orders
where id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.source_not_null_jaffle_shop_raw_orders_id.48f68cd946"} */
[0m21:26:44.139414 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01bfe366-0305-5ad3-0004-0c26000539da
[0m21:26:44.140549 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 002003 (02000): SQL compilation error:
Schema 'SNOWFLAKE.ACCOUNT_USAGE' does not exist or not authorized.
[0m21:26:44.145880 [debug] [Thread-2 (]: Database Error in model snowflake_query_history (models/base/snowflake_query_history.sql)
  002003 (02000): SQL compilation error:
  Schema 'SNOWFLAKE.ACCOUNT_USAGE' does not exist or not authorized.
  compiled code at target/run/snowflake_spend/models/base/snowflake_query_history.sql
[0m21:26:44.147327 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'abdad6bb-056b-4513-9370-e47661b8fc32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff66bfba40>]}
[0m21:26:44.148898 [error] [Thread-2 (]: 2 of 30 ERROR creating sql incremental model ANALYTICS.snowflake_query_history . [[31mERROR[0m in 0.93s]
[0m21:26:44.149821 [debug] [Thread-3 (]: Snowflake adapter: Snowflake query id: 01bfe366-0305-5ad3-0004-0c26000539d6
[0m21:26:44.150590 [debug] [Thread-2 (]: Finished running node model.snowflake_spend.snowflake_query_history
[0m21:26:44.151271 [debug] [Thread-3 (]: Snowflake adapter: Snowflake error: 002003 (02000): SQL compilation error:
Schema 'SNOWFLAKE.ACCOUNT_USAGE' does not exist or not authorized.
[0m21:26:44.151987 [debug] [Thread-2 (]: Began running node test.jaffle_shop.source_unique_jaffle_shop_raw_customers_id.0505c14273
[0m21:26:44.152622 [debug] [Thread-7 (]: Marking all children of 'model.snowflake_spend.snowflake_query_history' to be skipped because of status 'error'.  Reason: Database Error in model snowflake_query_history (models/base/snowflake_query_history.sql)
  002003 (02000): SQL compilation error:
  Schema 'SNOWFLAKE.ACCOUNT_USAGE' does not exist or not authorized.
  compiled code at target/run/snowflake_spend/models/base/snowflake_query_history.sql.
[0m21:26:44.156660 [debug] [Thread-3 (]: Database Error in model snowflake_warehouse_metering (models/base/snowflake_warehouse_metering.sql)
  002003 (02000): SQL compilation error:
  Schema 'SNOWFLAKE.ACCOUNT_USAGE' does not exist or not authorized.
  compiled code at target/run/snowflake_spend/models/base/snowflake_warehouse_metering.sql
[0m21:26:44.157198 [info ] [Thread-2 (]: 7 of 30 START test source_unique_jaffle_shop_raw_customers_id .................. [RUN]
[0m21:26:44.159109 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'abdad6bb-056b-4513-9370-e47661b8fc32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff663bb3e0>]}
[0m21:26:44.159858 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.snowflake_spend.snowflake_query_history, now test.jaffle_shop.source_unique_jaffle_shop_raw_customers_id.0505c14273)
[0m21:26:44.160742 [error] [Thread-3 (]: 3 of 30 ERROR creating sql view model ANALYTICS.snowflake_warehouse_metering ... [[31mERROR[0m in 0.94s]
[0m21:26:44.161542 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.source_unique_jaffle_shop_raw_customers_id.0505c14273
[0m21:26:44.162251 [debug] [Thread-3 (]: Finished running node model.snowflake_spend.snowflake_warehouse_metering
[0m21:26:44.170235 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.source_unique_jaffle_shop_raw_customers_id.0505c14273"
[0m21:26:44.170692 [debug] [Thread-3 (]: Began running node test.jaffle_shop.source_unique_jaffle_shop_raw_orders_id.21905c5ae2
[0m21:26:44.171181 [debug] [Thread-7 (]: Marking all children of 'model.snowflake_spend.snowflake_warehouse_metering' to be skipped because of status 'error'.  Reason: Database Error in model snowflake_warehouse_metering (models/base/snowflake_warehouse_metering.sql)
  002003 (02000): SQL compilation error:
  Schema 'SNOWFLAKE.ACCOUNT_USAGE' does not exist or not authorized.
  compiled code at target/run/snowflake_spend/models/base/snowflake_warehouse_metering.sql.
[0m21:26:44.171788 [info ] [Thread-3 (]: 8 of 30 START test source_unique_jaffle_shop_raw_orders_id ..................... [RUN]
[0m21:26:44.172784 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.source_unique_jaffle_shop_raw_customers_id.0505c14273
[0m21:26:44.173217 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.snowflake_spend.snowflake_warehouse_metering, now test.jaffle_shop.source_unique_jaffle_shop_raw_orders_id.21905c5ae2)
[0m21:26:44.178547 [debug] [Thread-3 (]: Began compiling node test.jaffle_shop.source_unique_jaffle_shop_raw_orders_id.21905c5ae2
[0m21:26:44.178056 [debug] [Thread-2 (]: Writing runtime sql for node "test.jaffle_shop.source_unique_jaffle_shop_raw_customers_id.0505c14273"
[0m21:26:44.182187 [debug] [Thread-3 (]: Writing injected SQL for node "test.jaffle_shop.source_unique_jaffle_shop_raw_orders_id.21905c5ae2"
[0m21:26:44.183598 [debug] [Thread-2 (]: Using snowflake connection "test.jaffle_shop.source_unique_jaffle_shop_raw_customers_id.0505c14273"
[0m21:26:44.184548 [debug] [Thread-2 (]: On test.jaffle_shop.source_unique_jaffle_shop_raw_customers_id.0505c14273: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    id as unique_field,
    count(*) as n_records

from JAFFLE_SHOP.RAW.raw_customers
where id is not null
group by id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.source_unique_jaffle_shop_raw_customers_id.0505c14273"} */
[0m21:26:44.184220 [debug] [Thread-3 (]: Began executing node test.jaffle_shop.source_unique_jaffle_shop_raw_orders_id.21905c5ae2
[0m21:26:44.188325 [debug] [Thread-3 (]: Writing runtime sql for node "test.jaffle_shop.source_unique_jaffle_shop_raw_orders_id.21905c5ae2"
[0m21:26:44.189483 [debug] [Thread-3 (]: Using snowflake connection "test.jaffle_shop.source_unique_jaffle_shop_raw_orders_id.21905c5ae2"
[0m21:26:44.189800 [debug] [Thread-3 (]: On test.jaffle_shop.source_unique_jaffle_shop_raw_orders_id.21905c5ae2: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    id as unique_field,
    count(*) as n_records

from JAFFLE_SHOP.RAW.raw_orders
where id is not null
group by id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.source_unique_jaffle_shop_raw_orders_id.21905c5ae2"} */
[0m21:26:44.284001 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.466 seconds
[0m21:26:44.284939 [debug] [Thread-4 (]: Using snowflake connection "seed.jaffle_shop.snowflake_contract_rates"
[0m21:26:44.285512 [debug] [Thread-4 (]: On seed.jaffle_shop.snowflake_contract_rates: COMMIT
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.snowflake_contract_rates"} */
[0m21:26:44.363130 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.336 seconds
[0m21:26:44.368011 [info ] [Thread-1 (]: 6 of 30 PASS source_not_null_jaffle_shop_raw_orders_id ......................... [[32mPASS[0m in 0.36s]
[0m21:26:44.369332 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.source_not_null_jaffle_shop_raw_orders_id.48f68cd946
[0m21:26:44.370191 [debug] [Thread-1 (]: Began running node test.snowflake_spend.not_null_snowflake_query_history_query_end_time.153318a08f
[0m21:26:44.371072 [info ] [Thread-1 (]: 9 of 30 SKIP test not_null_snowflake_query_history_query_end_time .............. [[33mSKIP[0m]
[0m21:26:44.372077 [debug] [Thread-1 (]: Finished running node test.snowflake_spend.not_null_snowflake_query_history_query_end_time.153318a08f
[0m21:26:44.372911 [debug] [Thread-1 (]: Began running node test.snowflake_spend.not_null_snowflake_query_history_query_start_time.38ffdeb96f
[0m21:26:44.373506 [debug] [Thread-7 (]: Marking all children of 'test.snowflake_spend.not_null_snowflake_query_history_query_end_time.153318a08f' to be skipped because of status 'skipped'. 
[0m21:26:44.374247 [info ] [Thread-1 (]: 10 of 30 SKIP test not_null_snowflake_query_history_query_start_time ........... [[33mSKIP[0m]
[0m21:26:44.375404 [debug] [Thread-1 (]: Finished running node test.snowflake_spend.not_null_snowflake_query_history_query_start_time.38ffdeb96f
[0m21:26:44.376045 [debug] [Thread-1 (]: Began running node test.snowflake_spend.not_null_snowflake_query_history_query_text.cf466ed98c
[0m21:26:44.376500 [debug] [Thread-7 (]: Marking all children of 'test.snowflake_spend.not_null_snowflake_query_history_query_start_time.38ffdeb96f' to be skipped because of status 'skipped'. 
[0m21:26:44.377060 [info ] [Thread-1 (]: 11 of 30 SKIP test not_null_snowflake_query_history_query_text ................. [[33mSKIP[0m]
[0m21:26:44.378117 [debug] [Thread-1 (]: Finished running node test.snowflake_spend.not_null_snowflake_query_history_query_text.cf466ed98c
[0m21:26:44.378744 [debug] [Thread-1 (]: Began running node test.snowflake_spend.not_null_snowflake_query_history_snowflake_query_id.9237f60e6c
[0m21:26:44.379706 [info ] [Thread-1 (]: 12 of 30 SKIP test not_null_snowflake_query_history_snowflake_query_id ......... [[33mSKIP[0m]
[0m21:26:44.380407 [debug] [Thread-1 (]: Finished running node test.snowflake_spend.not_null_snowflake_query_history_snowflake_query_id.9237f60e6c
[0m21:26:44.381078 [debug] [Thread-1 (]: Began running node test.snowflake_spend.not_null_snowflake_query_history_snowflake_user_name.41f5f6930e
[0m21:26:44.381679 [info ] [Thread-1 (]: 13 of 30 SKIP test not_null_snowflake_query_history_snowflake_user_name ........ [[33mSKIP[0m]
[0m21:26:44.382354 [debug] [Thread-1 (]: Finished running node test.snowflake_spend.not_null_snowflake_query_history_snowflake_user_name.41f5f6930e
[0m21:26:44.383019 [debug] [Thread-1 (]: Began running node test.snowflake_spend.unique_snowflake_query_history_snowflake_query_id.f8c7902fa0
[0m21:26:44.383616 [info ] [Thread-1 (]: 14 of 30 SKIP test unique_snowflake_query_history_snowflake_query_id ........... [[33mSKIP[0m]
[0m21:26:44.384382 [debug] [Thread-1 (]: Finished running node test.snowflake_spend.unique_snowflake_query_history_snowflake_query_id.f8c7902fa0
[0m21:26:44.379236 [debug] [Thread-7 (]: Marking all children of 'test.snowflake_spend.not_null_snowflake_query_history_query_text.cf466ed98c' to be skipped because of status 'skipped'. 
[0m21:26:44.385151 [debug] [Thread-7 (]: Marking all children of 'test.snowflake_spend.not_null_snowflake_query_history_snowflake_query_id.9237f60e6c' to be skipped because of status 'skipped'. 
[0m21:26:44.385800 [debug] [Thread-7 (]: Marking all children of 'test.snowflake_spend.not_null_snowflake_query_history_snowflake_user_name.41f5f6930e' to be skipped because of status 'skipped'. 
[0m21:26:44.386382 [debug] [Thread-7 (]: Marking all children of 'test.snowflake_spend.unique_snowflake_query_history_snowflake_query_id.f8c7902fa0' to be skipped because of status 'skipped'. 
[0m21:26:44.388222 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.198 seconds
[0m21:26:44.390574 [info ] [Thread-3 (]: 8 of 30 PASS source_unique_jaffle_shop_raw_orders_id ........................... [[32mPASS[0m in 0.22s]
[0m21:26:44.391423 [debug] [Thread-3 (]: Finished running node test.jaffle_shop.source_unique_jaffle_shop_raw_orders_id.21905c5ae2
[0m21:26:44.392295 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_orders
[0m21:26:44.392997 [info ] [Thread-1 (]: 15 of 30 START sql view model ANALYTICS.stg_orders ............................. [RUN]
[0m21:26:44.393715 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.source_not_null_jaffle_shop_raw_orders_id.48f68cd946, now model.jaffle_shop.stg_orders)
[0m21:26:44.394250 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_orders
[0m21:26:44.398260 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_orders"
[0m21:26:44.400026 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_orders
[0m21:26:44.403071 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_orders"
[0m21:26:44.404638 [debug] [Thread-1 (]: Using snowflake connection "model.jaffle_shop.stg_orders"
[0m21:26:44.405075 [debug] [Thread-1 (]: On model.jaffle_shop.stg_orders: create or replace   view JAFFLE_SHOP.ANALYTICS.stg_orders
  
  
  
  
  as (
    SELECT
        id as order_id
        ,user_id as customer_id
        ,order_date
        ,status
    FROM JAFFLE_SHOP.RAW.raw_orders
  )
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */;
[0m21:26:44.492676 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.308 seconds
[0m21:26:44.496660 [info ] [Thread-2 (]: 7 of 30 PASS source_unique_jaffle_shop_raw_customers_id ........................ [[32mPASS[0m in 0.34s]
[0m21:26:44.497723 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.source_unique_jaffle_shop_raw_customers_id.0505c14273
[0m21:26:44.498803 [debug] [Thread-3 (]: Began running node model.jaffle_shop.stg_customers
[0m21:26:44.499668 [info ] [Thread-3 (]: 16 of 30 START sql view model ANALYTICS.stg_customers .......................... [RUN]
[0m21:26:44.500480 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.source_unique_jaffle_shop_raw_orders_id.21905c5ae2, now model.jaffle_shop.stg_customers)
[0m21:26:44.501148 [debug] [Thread-3 (]: Began compiling node model.jaffle_shop.stg_customers
[0m21:26:44.505617 [debug] [Thread-3 (]: Writing injected SQL for node "model.jaffle_shop.stg_customers"
[0m21:26:44.507499 [debug] [Thread-3 (]: Began executing node model.jaffle_shop.stg_customers
[0m21:26:44.510890 [debug] [Thread-3 (]: Writing runtime sql for node "model.jaffle_shop.stg_customers"
[0m21:26:44.512342 [debug] [Thread-3 (]: Using snowflake connection "model.jaffle_shop.stg_customers"
[0m21:26:44.512809 [debug] [Thread-3 (]: On model.jaffle_shop.stg_customers: create or replace   view JAFFLE_SHOP.ANALYTICS.stg_customers
  
  
  
  
  as (
    SELECT
    id as customer_id
    ,first_name
    ,last_name
FROM JAFFLE_SHOP.RAW.raw_customers
  )
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */;
[0m21:26:44.558515 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.153 seconds
[0m21:26:44.561720 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'abdad6bb-056b-4513-9370-e47661b8fc32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff64217b60>]}
[0m21:26:44.562913 [info ] [Thread-1 (]: 15 of 30 OK created sql view model ANALYTICS.stg_orders ........................ [[32mSUCCESS 1[0m in 0.17s]
[0m21:26:44.563815 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_orders
[0m21:26:44.564967 [debug] [Thread-2 (]: Began running node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m21:26:44.565976 [info ] [Thread-2 (]: 17 of 30 START test not_null_stg_orders_order_id ............................... [RUN]
[0m21:26:44.565512 [debug] [Thread-1 (]: Began running node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m21:26:44.566686 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.source_unique_jaffle_shop_raw_customers_id.0505c14273, now test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64)
[0m21:26:44.567430 [info ] [Thread-1 (]: 18 of 30 START test unique_stg_orders_order_id ................................. [RUN]
[0m21:26:44.568167 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m21:26:44.568794 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_orders, now test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a)
[0m21:26:44.574630 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
[0m21:26:44.575284 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m21:26:44.580355 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
[0m21:26:44.581378 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m21:26:44.586549 [debug] [Thread-2 (]: Writing runtime sql for node "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
[0m21:26:44.587319 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m21:26:44.589402 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.303 seconds
[0m21:26:44.592042 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
[0m21:26:44.604454 [debug] [Thread-2 (]: Using snowflake connection "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
[0m21:26:44.606337 [debug] [Thread-4 (]: Using snowflake connection "seed.jaffle_shop.snowflake_contract_rates"
[0m21:26:44.607113 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from JAFFLE_SHOP.ANALYTICS.stg_orders
where order_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"} */
[0m21:26:44.607577 [debug] [Thread-4 (]: On seed.jaffle_shop.snowflake_contract_rates: BEGIN
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.snowflake_contract_rates"} */
[0m21:26:44.608233 [debug] [Thread-1 (]: Using snowflake connection "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
[0m21:26:44.610157 [debug] [Thread-1 (]: On test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_id as unique_field,
    count(*) as n_records

from JAFFLE_SHOP.ANALYTICS.stg_orders
where order_id is not null
group by order_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"} */
[0m21:26:44.722371 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.113 seconds
[0m21:26:44.723524 [debug] [Thread-4 (]: Using snowflake connection "seed.jaffle_shop.snowflake_contract_rates"
[0m21:26:44.724215 [debug] [Thread-4 (]: On seed.jaffle_shop.snowflake_contract_rates: insert into JAFFLE_SHOP.ANALYTICS.snowflake_contract_rates (effective_date, rate) values
            (%s,%s),(%s,%s)
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.snowflake_contract_rates"} */...
[0m21:26:44.742163 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.134 seconds
[0m21:26:44.745305 [info ] [Thread-2 (]: 17 of 30 PASS not_null_stg_orders_order_id ..................................... [[32mPASS[0m in 0.18s]
[0m21:26:44.746331 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m21:26:44.760775 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.150 seconds
[0m21:26:44.763892 [info ] [Thread-1 (]: 18 of 30 PASS unique_stg_orders_order_id ....................................... [[32mPASS[0m in 0.19s]
[0m21:26:44.765007 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m21:26:44.765983 [debug] [Thread-2 (]: Began running node model.jaffle_shop.daily_summary_orders
[0m21:26:44.766453 [debug] [Thread-1 (]: Began running node model.jaffle_shop.int_orders_pivoted
[0m21:26:44.767034 [info ] [Thread-2 (]: 19 of 30 START sql table model ANALYTICS.daily_summary_orders .................. [RUN]
[0m21:26:44.768556 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64, now model.jaffle_shop.daily_summary_orders)
[0m21:26:44.769191 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.daily_summary_orders
[0m21:26:44.767870 [info ] [Thread-1 (]: 20 of 30 START sql table model ANALYTICS.int_orders_pivoted .................... [RUN]
[0m21:26:44.775505 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a, now model.jaffle_shop.int_orders_pivoted)
[0m21:26:44.775994 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.int_orders_pivoted
[0m21:26:44.774712 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.daily_summary_orders"
[0m21:26:44.780779 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.int_orders_pivoted"
[0m21:26:44.782861 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.daily_summary_orders
[0m21:26:44.793435 [debug] [Thread-2 (]: Writing runtime sql for node "model.jaffle_shop.daily_summary_orders"
[0m21:26:44.795124 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.int_orders_pivoted
[0m21:26:44.795958 [debug] [Thread-2 (]: Using snowflake connection "model.jaffle_shop.daily_summary_orders"
[0m21:26:44.798676 [debug] [Thread-2 (]: On model.jaffle_shop.daily_summary_orders: create or replace transient table JAFFLE_SHOP.ANALYTICS.daily_summary_orders
    
    
    
    as (select
    md5(cast(coalesce(cast(customer_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(order_date as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as primary_key
    ,customer_id
    ,order_date
    ,count(*) as c
from JAFFLE_SHOP.ANALYTICS.stg_orders
group by 1,2,3
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.daily_summary_orders"} */;
[0m21:26:44.798259 [debug] [Thread-1 (]:  adapter: Dropping relation "JAFFLE_SHOP"."ANALYTICS"."INT_ORDERS_PIVOTED" because it is a view and target relation JAFFLE_SHOP.ANALYTICS.int_orders_pivoted is of type table.
[0m21:26:44.806328 [debug] [Thread-1 (]: Applying DROP to: "JAFFLE_SHOP"."ANALYTICS"."INT_ORDERS_PIVOTED"
[0m21:26:44.811962 [debug] [Thread-1 (]: Using snowflake connection "model.jaffle_shop.int_orders_pivoted"
[0m21:26:44.812329 [debug] [Thread-1 (]: On model.jaffle_shop.int_orders_pivoted: drop view if exists "JAFFLE_SHOP"."ANALYTICS"."INT_ORDERS_PIVOTED" cascade
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.int_orders_pivoted"} */
[0m21:26:44.849102 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.336 seconds
[0m21:26:44.850796 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'abdad6bb-056b-4513-9370-e47661b8fc32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff66f3c530>]}
[0m21:26:44.851406 [info ] [Thread-3 (]: 16 of 30 OK created sql view model ANALYTICS.stg_customers ..................... [[32mSUCCESS 1[0m in 0.35s]
[0m21:26:44.852061 [debug] [Thread-3 (]: Finished running node model.jaffle_shop.stg_customers
[0m21:26:44.852714 [debug] [Thread-3 (]: Began running node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m21:26:44.853112 [info ] [Thread-3 (]: 21 of 30 START test not_null_stg_customers_customer_id ......................... [RUN]
[0m21:26:44.853577 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_customers, now test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa)
[0m21:26:44.853945 [debug] [Thread-3 (]: Began compiling node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m21:26:44.858678 [debug] [Thread-3 (]: Writing injected SQL for node "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m21:26:44.859494 [debug] [Thread-3 (]: Began executing node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m21:26:44.861380 [debug] [Thread-3 (]: Writing runtime sql for node "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m21:26:44.862308 [debug] [Thread-3 (]: Using snowflake connection "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m21:26:44.862640 [debug] [Thread-3 (]: On test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from JAFFLE_SHOP.ANALYTICS.stg_customers
where customer_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"} */
[0m21:26:44.962485 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.150 seconds
[0m21:26:44.964096 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.int_orders_pivoted"
[0m21:26:44.966805 [debug] [Thread-1 (]: Using snowflake connection "model.jaffle_shop.int_orders_pivoted"
[0m21:26:44.967301 [debug] [Thread-1 (]: On model.jaffle_shop.int_orders_pivoted: create or replace transient table JAFFLE_SHOP.ANALYTICS.int_orders_pivoted
    
    
    
    as (with 
completed as (
    select
        p.order_id
        ,p.payment_method
        ,p.amount
    from JAFFLE_SHOP.ANALYTICS.stg_payments as p 
    left join JAFFLE_SHOP.ANALYTICS.stg_orders as o using (order_id)
    where status ='completed'
),
pivoted as (
    select
        order_id,
            sum(case when payment_method = 'bank_transfer' then amount else 0 end) as bank_transfer_amount,
            sum(case when payment_method = 'credit_card' then amount else 0 end) as credit_card_amount,
            sum(case when payment_method = 'coupon' then amount else 0 end) as coupon_amount,
            sum(case when payment_method = 'gift_card' then amount else 0 end) as gift_card_amount
    from completed
    group by 1
)
select 
    *
from pivoted
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.int_orders_pivoted"} */;
[0m21:26:44.991211 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.128 seconds
[0m21:26:44.993180 [info ] [Thread-3 (]: 21 of 30 PASS not_null_stg_customers_customer_id ............................... [[32mPASS[0m in 0.14s]
[0m21:26:44.993958 [debug] [Thread-3 (]: Finished running node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m21:26:44.994437 [debug] [Thread-3 (]: Began running node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m21:26:44.994904 [info ] [Thread-3 (]: 22 of 30 START test relationships_stg_orders_customer_id__customer_id__ref_stg_customers_  [RUN]
[0m21:26:44.995426 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa, now test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500)
[0m21:26:44.995998 [debug] [Thread-3 (]: Began compiling node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m21:26:45.001059 [debug] [Thread-3 (]: Writing injected SQL for node "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m21:26:45.002288 [debug] [Thread-3 (]: Began executing node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m21:26:45.004574 [debug] [Thread-3 (]: Writing runtime sql for node "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m21:26:45.006026 [debug] [Thread-3 (]: Using snowflake connection "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m21:26:45.006421 [debug] [Thread-3 (]: On test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select customer_id as from_field
    from JAFFLE_SHOP.ANALYTICS.stg_orders
    where customer_id is not null
),

parent as (
    select customer_id as to_field
    from JAFFLE_SHOP.ANALYTICS.stg_customers
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"} */
[0m21:26:45.088951 [debug] [Thread-4 (]: SQL status: SUCCESS 2 in 0.364 seconds
[0m21:26:45.089708 [debug] [Thread-4 (]: Using snowflake connection "seed.jaffle_shop.snowflake_contract_rates"
[0m21:26:45.090281 [debug] [Thread-4 (]: On seed.jaffle_shop.snowflake_contract_rates: COMMIT
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.snowflake_contract_rates"} */
[0m21:26:45.381131 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.290 seconds
[0m21:26:45.394180 [debug] [Thread-4 (]: Writing runtime SQL for node "seed.jaffle_shop.snowflake_contract_rates"
[0m21:26:45.398868 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'abdad6bb-056b-4513-9370-e47661b8fc32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff64128b60>]}
[0m21:26:45.399764 [info ] [Thread-4 (]: 4 of 30 OK loaded seed file ANALYTICS.snowflake_contract_rates ................. [[32mINSERT 2[0m in 2.18s]
[0m21:26:45.400824 [debug] [Thread-4 (]: Finished running node seed.jaffle_shop.snowflake_contract_rates
[0m21:26:45.401621 [debug] [Thread-4 (]: Began running node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m21:26:45.402523 [info ] [Thread-4 (]: 23 of 30 START test unique_stg_customers_customer_id ........................... [RUN]
[0m21:26:45.403414 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly seed.jaffle_shop.snowflake_contract_rates, now test.jaffle_shop.unique_stg_customers_customer_id.c7614daada)
[0m21:26:45.404033 [debug] [Thread-4 (]: Began compiling node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m21:26:45.410638 [debug] [Thread-4 (]: Writing injected SQL for node "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
[0m21:26:45.412088 [debug] [Thread-4 (]: Began executing node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m21:26:45.415906 [debug] [Thread-4 (]: Writing runtime sql for node "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
[0m21:26:45.417476 [debug] [Thread-4 (]: Using snowflake connection "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
[0m21:26:45.417991 [debug] [Thread-4 (]: On test.jaffle_shop.unique_stg_customers_customer_id.c7614daada: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from JAFFLE_SHOP.ANALYTICS.stg_customers
where customer_id is not null
group by customer_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"} */
[0m21:26:45.620551 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.202 seconds
[0m21:26:45.623905 [info ] [Thread-4 (]: 23 of 30 PASS unique_stg_customers_customer_id ................................. [[32mPASS[0m in 0.22s]
[0m21:26:45.625009 [debug] [Thread-4 (]: Finished running node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m21:26:45.625742 [debug] [Thread-4 (]: Began running node model.snowflake_spend.snowflake_amortized_rates
[0m21:26:45.626668 [info ] [Thread-4 (]: 24 of 30 START sql view model ANALYTICS.snowflake_amortized_rates .............. [RUN]
[0m21:26:45.627608 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.unique_stg_customers_customer_id.c7614daada, now model.snowflake_spend.snowflake_amortized_rates)
[0m21:26:45.628283 [debug] [Thread-4 (]: Began compiling node model.snowflake_spend.snowflake_amortized_rates
[0m21:26:45.637416 [debug] [Thread-4 (]: Using snowflake connection "model.snowflake_spend.snowflake_amortized_rates"
[0m21:26:45.638012 [debug] [Thread-4 (]: On model.snowflake_spend.snowflake_amortized_rates: select datediff(
        day,
        to_date('11/01/2009', 'mm/dd/yyyy'),
        dateadd(year, 40, current_date)
        )
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.snowflake_spend.snowflake_amortized_rates"} */
[0m21:26:45.769276 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.130 seconds
[0m21:26:45.775359 [debug] [Thread-4 (]: Writing injected SQL for node "model.snowflake_spend.snowflake_amortized_rates"
[0m21:26:45.778089 [debug] [Thread-4 (]: Began executing node model.snowflake_spend.snowflake_amortized_rates
[0m21:26:45.786379 [debug] [Thread-4 (]: Writing runtime sql for node "model.snowflake_spend.snowflake_amortized_rates"
[0m21:26:45.792986 [debug] [Thread-4 (]: Using snowflake connection "model.snowflake_spend.snowflake_amortized_rates"
[0m21:26:45.793915 [debug] [Thread-4 (]: On model.snowflake_spend.snowflake_amortized_rates: create or replace   view JAFFLE_SHOP.ANALYTICS.snowflake_amortized_rates
  
  
  
  
  as (
    WITH contract_rates AS (

    SELECT *
    FROM JAFFLE_SHOP.ANALYTICS.snowflake_contract_rates

), contract_rate_rework AS (

    SELECT  
      effective_date    AS effective_start_date,
      DATEADD(day, -1, LEAD(effective_date, 1, '2059-01-01') OVER (
          ORDER BY effective_date ASC
        ))              AS effective_end_date,
      rate
    FROM contract_rates

), date_spine AS (

  





with rawdata as (

    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
     + 
    
    p1.generated_number * power(2, 1)
     + 
    
    p2.generated_number * power(2, 2)
     + 
    
    p3.generated_number * power(2, 3)
     + 
    
    p4.generated_number * power(2, 4)
     + 
    
    p5.generated_number * power(2, 5)
     + 
    
    p6.generated_number * power(2, 6)
     + 
    
    p7.generated_number * power(2, 7)
     + 
    
    p8.generated_number * power(2, 8)
     + 
    
    p9.generated_number * power(2, 9)
     + 
    
    p10.generated_number * power(2, 10)
     + 
    
    p11.generated_number * power(2, 11)
     + 
    
    p12.generated_number * power(2, 12)
     + 
    
    p13.generated_number * power(2, 13)
     + 
    
    p14.generated_number * power(2, 14)
    
    
    + 1
    as generated_number

    from

    
    p as p0
     cross join 
    
    p as p1
     cross join 
    
    p as p2
     cross join 
    
    p as p3
     cross join 
    
    p as p4
     cross join 
    
    p as p5
     cross join 
    
    p as p6
     cross join 
    
    p as p7
     cross join 
    
    p as p8
     cross join 
    
    p as p9
     cross join 
    
    p as p10
     cross join 
    
    p as p11
     cross join 
    
    p as p12
     cross join 
    
    p as p13
     cross join 
    
    p as p14
    
    

    )

    select *
    from unioned
    where generated_number <= 20444
    order by generated_number



),

all_periods as (

    select (
        

    dateadd(
        day,
        row_number() over (order by generated_number) - 1,
        to_date('11/01/2009', 'mm/dd/yyyy')
        )


    ) as date_day
    from rawdata

),

filtered as (

    select *
    from all_periods
    where date_day <= dateadd(year, 40, current_date)

)

select * from filtered



), date_details AS (

    SELECT  
      date_day,
      DATE_PART(month, date_day)    AS month_actual,
      DATE_PART(year, date_day)     AS year_actual,
      FIRST_VALUE(date_day) OVER (
          PARTITION BY year_actual, month_actual ORDER BY date_day
        )                           AS first_day_of_month
    FROM date_spine

), rate_amortized AS (

    SELECT 
      contract_rate_rework.*,
      date_details.date_day
    FROM contract_rate_rework
    LEFT JOIN date_details 
      ON date_details.date_day >= contract_rate_rework.effective_start_date
        AND date_details.date_day <= contract_rate_rework.effective_end_date

)

SELECT *
FROM rate_amortized
  )
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.snowflake_spend.snowflake_amortized_rates"} */;
[0m21:26:45.917589 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.910 seconds
[0m21:26:45.923132 [info ] [Thread-3 (]: 22 of 30 PASS relationships_stg_orders_customer_id__customer_id__ref_stg_customers_  [[32mPASS[0m in 0.93s]
[0m21:26:45.924490 [debug] [Thread-3 (]: Finished running node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m21:26:45.926403 [debug] [Thread-3 (]: Began running node model.jaffle_shop.dim_customers
[0m21:26:45.928068 [info ] [Thread-3 (]: 25 of 30 START sql table model ANALYTICS.dim_customers ......................... [RUN]
[0m21:26:45.929499 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500, now model.jaffle_shop.dim_customers)
[0m21:26:45.930512 [debug] [Thread-3 (]: Began compiling node model.jaffle_shop.dim_customers
[0m21:26:45.936237 [debug] [Thread-3 (]: Writing injected SQL for node "model.jaffle_shop.dim_customers"
[0m21:26:45.938764 [debug] [Thread-3 (]: Began executing node model.jaffle_shop.dim_customers
[0m21:26:45.943127 [debug] [Thread-3 (]: Writing runtime sql for node "model.jaffle_shop.dim_customers"
[0m21:26:45.945701 [debug] [Thread-3 (]: Using snowflake connection "model.jaffle_shop.dim_customers"
[0m21:26:45.946303 [debug] [Thread-3 (]: On model.jaffle_shop.dim_customers: create or replace transient table JAFFLE_SHOP.ANALYTICS.dim_customers
    
    
    
    as (with orders_customers as (

    select
        o.customer_id,
        min(o.order_date) as first_order_date,
        max(o.order_date) as last_order_date,
        sum(p.amount) as lifetime_value, 
        count(o.order_id) as number_of_orders
    from JAFFLE_SHOP.ANALYTICS.stg_orders as o
    left join JAFFLE_SHOP.ANALYTICS.stg_payments as p 
        on p.order_id = o.order_id
    group by 1

),
customers as (

    select
        c.customer_id,
        c.first_name,
        c.last_name,
        oc.first_order_date,
        oc.last_order_date,
        coalesce(oc.lifetime_value,0) as lifetime_value,
        coalesce(oc.number_of_orders, 0) as number_of_orders
    from JAFFLE_SHOP.ANALYTICS.stg_customers as c
    left join orders_customers as oc USING(customer_id)

)

select * from customers
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */;
[0m21:26:46.234604 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.435 seconds
[0m21:26:46.238792 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'abdad6bb-056b-4513-9370-e47661b8fc32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff648b0bf0>]}
[0m21:26:46.240168 [info ] [Thread-2 (]: 19 of 30 OK created sql table model ANALYTICS.daily_summary_orders ............. [[32mSUCCESS 1[0m in 1.47s]
[0m21:26:46.241563 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.daily_summary_orders
[0m21:26:46.406126 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.438 seconds
[0m21:26:46.410892 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'abdad6bb-056b-4513-9370-e47661b8fc32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff648b38f0>]}
[0m21:26:46.412234 [info ] [Thread-1 (]: 20 of 30 OK created sql table model ANALYTICS.int_orders_pivoted ............... [[32mSUCCESS 1[0m in 1.64s]
[0m21:26:46.413535 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.int_orders_pivoted
[0m21:26:46.652119 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.857 seconds
[0m21:26:46.654212 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'abdad6bb-056b-4513-9370-e47661b8fc32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5f53b770>]}
[0m21:26:46.654927 [info ] [Thread-4 (]: 24 of 30 OK created sql view model ANALYTICS.snowflake_amortized_rates ......... [[32mSUCCESS 1[0m in 1.03s]
[0m21:26:46.655680 [debug] [Thread-4 (]: Finished running node model.snowflake_spend.snowflake_amortized_rates
[0m21:26:46.656375 [debug] [Thread-2 (]: Began running node test.snowflake_spend.not_null_snowflake_amortized_rates_date_day.43a955e78b
[0m21:26:46.656712 [debug] [Thread-1 (]: Began running node test.snowflake_spend.not_null_snowflake_amortized_rates_effective_start_date.2c8ca54b37
[0m21:26:46.657053 [debug] [Thread-4 (]: Began running node test.snowflake_spend.not_null_snowflake_amortized_rates_rate.9af2fa3886
[0m21:26:46.658454 [info ] [Thread-4 (]: 28 of 30 START test not_null_snowflake_amortized_rates_rate .................... [RUN]
[0m21:26:46.657914 [info ] [Thread-1 (]: 27 of 30 START test not_null_snowflake_amortized_rates_effective_start_date .... [RUN]
[0m21:26:46.657375 [info ] [Thread-2 (]: 26 of 30 START test not_null_snowflake_amortized_rates_date_day ................ [RUN]
[0m21:26:46.658889 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.snowflake_spend.snowflake_amortized_rates, now test.snowflake_spend.not_null_snowflake_amortized_rates_rate.9af2fa3886)
[0m21:26:46.659290 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.int_orders_pivoted, now test.snowflake_spend.not_null_snowflake_amortized_rates_effective_start_date.2c8ca54b37)
[0m21:26:46.659643 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.daily_summary_orders, now test.snowflake_spend.not_null_snowflake_amortized_rates_date_day.43a955e78b)
[0m21:26:46.660028 [debug] [Thread-4 (]: Began compiling node test.snowflake_spend.not_null_snowflake_amortized_rates_rate.9af2fa3886
[0m21:26:46.660417 [debug] [Thread-1 (]: Began compiling node test.snowflake_spend.not_null_snowflake_amortized_rates_effective_start_date.2c8ca54b37
[0m21:26:46.660790 [debug] [Thread-2 (]: Began compiling node test.snowflake_spend.not_null_snowflake_amortized_rates_date_day.43a955e78b
[0m21:26:46.664341 [debug] [Thread-4 (]: Writing injected SQL for node "test.snowflake_spend.not_null_snowflake_amortized_rates_rate.9af2fa3886"
[0m21:26:46.667507 [debug] [Thread-1 (]: Writing injected SQL for node "test.snowflake_spend.not_null_snowflake_amortized_rates_effective_start_date.2c8ca54b37"
[0m21:26:46.670396 [debug] [Thread-2 (]: Writing injected SQL for node "test.snowflake_spend.not_null_snowflake_amortized_rates_date_day.43a955e78b"
[0m21:26:46.672968 [debug] [Thread-1 (]: Began executing node test.snowflake_spend.not_null_snowflake_amortized_rates_effective_start_date.2c8ca54b37
[0m21:26:46.674807 [debug] [Thread-1 (]: Writing runtime sql for node "test.snowflake_spend.not_null_snowflake_amortized_rates_effective_start_date.2c8ca54b37"
[0m21:26:46.675147 [debug] [Thread-2 (]: Began executing node test.snowflake_spend.not_null_snowflake_amortized_rates_date_day.43a955e78b
[0m21:26:46.678001 [debug] [Thread-2 (]: Writing runtime sql for node "test.snowflake_spend.not_null_snowflake_amortized_rates_date_day.43a955e78b"
[0m21:26:46.678513 [debug] [Thread-4 (]: Began executing node test.snowflake_spend.not_null_snowflake_amortized_rates_rate.9af2fa3886
[0m21:26:46.680135 [debug] [Thread-4 (]: Writing runtime sql for node "test.snowflake_spend.not_null_snowflake_amortized_rates_rate.9af2fa3886"
[0m21:26:46.681482 [debug] [Thread-1 (]: Using snowflake connection "test.snowflake_spend.not_null_snowflake_amortized_rates_effective_start_date.2c8ca54b37"
[0m21:26:46.681810 [debug] [Thread-1 (]: On test.snowflake_spend.not_null_snowflake_amortized_rates_effective_start_date.2c8ca54b37: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select effective_start_date
from JAFFLE_SHOP.ANALYTICS.snowflake_amortized_rates
where effective_start_date is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.snowflake_spend.not_null_snowflake_amortized_rates_effective_start_date.2c8ca54b37"} */
[0m21:26:46.682298 [debug] [Thread-4 (]: Using snowflake connection "test.snowflake_spend.not_null_snowflake_amortized_rates_rate.9af2fa3886"
[0m21:26:46.683196 [debug] [Thread-4 (]: On test.snowflake_spend.not_null_snowflake_amortized_rates_rate.9af2fa3886: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select rate
from JAFFLE_SHOP.ANALYTICS.snowflake_amortized_rates
where rate is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.snowflake_spend.not_null_snowflake_amortized_rates_rate.9af2fa3886"} */
[0m21:26:46.683721 [debug] [Thread-2 (]: Using snowflake connection "test.snowflake_spend.not_null_snowflake_amortized_rates_date_day.43a955e78b"
[0m21:26:46.685161 [debug] [Thread-2 (]: On test.snowflake_spend.not_null_snowflake_amortized_rates_date_day.43a955e78b: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select date_day
from JAFFLE_SHOP.ANALYTICS.snowflake_amortized_rates
where date_day is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.snowflake_spend.not_null_snowflake_amortized_rates_date_day.43a955e78b"} */
[0m21:26:46.835362 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.888 seconds
[0m21:26:46.838302 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'abdad6bb-056b-4513-9370-e47661b8fc32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5f524110>]}
[0m21:26:46.839122 [info ] [Thread-3 (]: 25 of 30 OK created sql table model ANALYTICS.dim_customers .................... [[32mSUCCESS 1[0m in 0.91s]
[0m21:26:46.839922 [debug] [Thread-3 (]: Finished running node model.jaffle_shop.dim_customers
[0m21:26:46.840443 [debug] [Thread-3 (]: Began running node test.snowflake_spend.unique_snowflake_amortized_rates_date_day.6a11e4202b
[0m21:26:46.840978 [info ] [Thread-3 (]: 29 of 30 START test unique_snowflake_amortized_rates_date_day .................. [RUN]
[0m21:26:46.841652 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.dim_customers, now test.snowflake_spend.unique_snowflake_amortized_rates_date_day.6a11e4202b)
[0m21:26:46.842305 [debug] [Thread-3 (]: Began compiling node test.snowflake_spend.unique_snowflake_amortized_rates_date_day.6a11e4202b
[0m21:26:46.848823 [debug] [Thread-3 (]: Writing injected SQL for node "test.snowflake_spend.unique_snowflake_amortized_rates_date_day.6a11e4202b"
[0m21:26:46.850650 [debug] [Thread-3 (]: Began executing node test.snowflake_spend.unique_snowflake_amortized_rates_date_day.6a11e4202b
[0m21:26:46.854063 [debug] [Thread-3 (]: Writing runtime sql for node "test.snowflake_spend.unique_snowflake_amortized_rates_date_day.6a11e4202b"
[0m21:26:46.856350 [debug] [Thread-3 (]: Using snowflake connection "test.snowflake_spend.unique_snowflake_amortized_rates_date_day.6a11e4202b"
[0m21:26:46.856881 [debug] [Thread-3 (]: On test.snowflake_spend.unique_snowflake_amortized_rates_date_day.6a11e4202b: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    date_day as unique_field,
    count(*) as n_records

from JAFFLE_SHOP.ANALYTICS.snowflake_amortized_rates
where date_day is not null
group by date_day
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.snowflake_spend.unique_snowflake_amortized_rates_date_day.6a11e4202b"} */
[0m21:26:47.090739 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.408 seconds
[0m21:26:47.095115 [info ] [Thread-1 (]: 27 of 30 PASS not_null_snowflake_amortized_rates_effective_start_date .......... [[32mPASS[0m in 0.44s]
[0m21:26:47.096653 [debug] [Thread-1 (]: Finished running node test.snowflake_spend.not_null_snowflake_amortized_rates_effective_start_date.2c8ca54b37
[0m21:26:47.133524 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.449 seconds
[0m21:26:47.135944 [info ] [Thread-4 (]: 28 of 30 PASS not_null_snowflake_amortized_rates_rate .......................... [[32mPASS[0m in 0.48s]
[0m21:26:47.136797 [debug] [Thread-4 (]: Finished running node test.snowflake_spend.not_null_snowflake_amortized_rates_rate.9af2fa3886
[0m21:26:47.345436 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.488 seconds
[0m21:26:47.350536 [info ] [Thread-3 (]: 29 of 30 PASS unique_snowflake_amortized_rates_date_day ........................ [[32mPASS[0m in 0.51s]
[0m21:26:47.351800 [debug] [Thread-3 (]: Finished running node test.snowflake_spend.unique_snowflake_amortized_rates_date_day.6a11e4202b
[0m21:26:47.382321 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.697 seconds
[0m21:26:47.385782 [info ] [Thread-2 (]: 26 of 30 PASS not_null_snowflake_amortized_rates_date_day ...................... [[32mPASS[0m in 0.73s]
[0m21:26:47.387070 [debug] [Thread-2 (]: Finished running node test.snowflake_spend.not_null_snowflake_amortized_rates_date_day.43a955e78b
[0m21:26:47.389178 [debug] [Thread-1 (]: Began running node model.snowflake_spend.snowflake_warehouse_metering_xf
[0m21:26:47.389987 [info ] [Thread-1 (]: 30 of 30 SKIP relation ANALYTICS.snowflake_warehouse_metering_xf ............... [[33mSKIP[0m]
[0m21:26:47.391141 [debug] [Thread-1 (]: Finished running node model.snowflake_spend.snowflake_warehouse_metering_xf
[0m21:26:47.391923 [debug] [Thread-7 (]: Marking all children of 'model.snowflake_spend.snowflake_warehouse_metering_xf' to be skipped because of status 'skipped'. 
[0m21:26:47.395269 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:26:47.395945 [debug] [MainThread]: Connection 'test.snowflake_spend.not_null_snowflake_amortized_rates_effective_start_date.2c8ca54b37' was left open.
[0m21:26:47.396618 [debug] [MainThread]: On test.snowflake_spend.not_null_snowflake_amortized_rates_effective_start_date.2c8ca54b37: Close
[0m21:26:47.564284 [debug] [MainThread]: Connection 'test.snowflake_spend.not_null_snowflake_amortized_rates_date_day.43a955e78b' was left open.
[0m21:26:47.565835 [debug] [MainThread]: On test.snowflake_spend.not_null_snowflake_amortized_rates_date_day.43a955e78b: Close
[0m21:26:47.747127 [debug] [MainThread]: Connection 'test.snowflake_spend.unique_snowflake_amortized_rates_date_day.6a11e4202b' was left open.
[0m21:26:47.747872 [debug] [MainThread]: On test.snowflake_spend.unique_snowflake_amortized_rates_date_day.6a11e4202b: Close
[0m21:26:47.893976 [debug] [MainThread]: Connection 'test.snowflake_spend.not_null_snowflake_amortized_rates_rate.9af2fa3886' was left open.
[0m21:26:47.895168 [debug] [MainThread]: On test.snowflake_spend.not_null_snowflake_amortized_rates_rate.9af2fa3886: Close
[0m21:26:48.033651 [info ] [MainThread]: 
[0m21:26:48.035132 [info ] [MainThread]: Finished running 1 incremental model, 1 seed, 3 table models, 19 data tests, 6 view models in 0 hours 0 minutes and 6.90 seconds (6.90s).
[0m21:26:48.042659 [debug] [MainThread]: Command end result
[0m21:26:48.101266 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m21:26:48.104552 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m21:26:48.113734 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/target/run_results.json
[0m21:26:48.114310 [info ] [MainThread]: 
[0m21:26:48.114949 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m21:26:48.115460 [info ] [MainThread]: 
[0m21:26:48.116220 [error] [MainThread]: [31mFailure in model snowflake_query_history (models/base/snowflake_query_history.sql)[0m
[0m21:26:48.116913 [error] [MainThread]:   Database Error in model snowflake_query_history (models/base/snowflake_query_history.sql)
  002003 (02000): SQL compilation error:
  Schema 'SNOWFLAKE.ACCOUNT_USAGE' does not exist or not authorized.
  compiled code at target/run/snowflake_spend/models/base/snowflake_query_history.sql
[0m21:26:48.117472 [info ] [MainThread]: 
[0m21:26:48.118156 [info ] [MainThread]:   compiled code at target/compiled/snowflake_spend/models/base/snowflake_query_history.sql
[0m21:26:48.118643 [info ] [MainThread]: 
[0m21:26:48.119107 [error] [MainThread]: [31mFailure in model snowflake_warehouse_metering (models/base/snowflake_warehouse_metering.sql)[0m
[0m21:26:48.119408 [error] [MainThread]:   Database Error in model snowflake_warehouse_metering (models/base/snowflake_warehouse_metering.sql)
  002003 (02000): SQL compilation error:
  Schema 'SNOWFLAKE.ACCOUNT_USAGE' does not exist or not authorized.
  compiled code at target/run/snowflake_spend/models/base/snowflake_warehouse_metering.sql
[0m21:26:48.119644 [info ] [MainThread]: 
[0m21:26:48.119938 [info ] [MainThread]:   compiled code at target/compiled/snowflake_spend/models/base/snowflake_warehouse_metering.sql
[0m21:26:48.120206 [info ] [MainThread]: 
[0m21:26:48.120547 [info ] [MainThread]: Done. PASS=21 WARN=0 ERROR=2 SKIP=7 NO-OP=0 TOTAL=30
[0m21:26:48.121224 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ConfigSourcePathDeprecation: 1 occurrence
- ConfigDataPathDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m21:26:48.122993 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 9.283917, "process_in_blocks": "104", "process_kernel_time": 0.789328, "process_mem_max_rss": "249972", "process_out_blocks": "4910", "process_user_time": 5.049054}
[0m21:26:48.123536 [debug] [MainThread]: Command `dbt build` failed at 21:26:48.123407 after 9.28 seconds
[0m21:26:48.124038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83c00260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff65f5dee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff830e8dd0>]}
[0m21:26:48.124384 [debug] [MainThread]: Flushing usage events
[0m21:26:49.648632 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:33:34.225663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffab0dda00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffabc3bb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffabc3bec0>]}


============================== 21:33:34.231636 | 35dda592-35be-4eec-8aa2-0d47ac203212 ==============================
[0m21:33:34.231636 [info ] [MainThread]: Running with dbt=1.10.13
[0m21:33:34.232210 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'log_path': '/opt/airflow/dbt/logs', 'write_json': 'True', 'partial_parse': 'True', 'debug': 'False', 'invocation_command': 'dbt build --select package:snowflake_spend', 'target_path': 'None', 'printer_width': '80', 'empty': 'False', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'version_check': 'True', 'static_parser': 'True', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True'}
[0m21:33:34.801633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '35dda592-35be-4eec-8aa2-0d47ac203212', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f9829c0>]}
[0m21:33:34.838910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '35dda592-35be-4eec-8aa2-0d47ac203212', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaaef3e60>]}
[0m21:33:34.839674 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m21:33:34.924506 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m21:33:34.924972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '35dda592-35be-4eec-8aa2-0d47ac203212', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f60f0e0>]}
[0m21:33:34.925387 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m21:33:34.925671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '35dda592-35be-4eec-8aa2-0d47ac203212', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8fc42870>]}
[0m21:33:34.927704 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m21:33:35.008585 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m21:33:35.009056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '35dda592-35be-4eec-8aa2-0d47ac203212', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f1688f0>]}
[0m21:33:36.546204 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.jaffle_shop.snowflake_spend
[0m21:33:36.553731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '35dda592-35be-4eec-8aa2-0d47ac203212', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8eb11460>]}
[0m21:33:36.693078 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m21:33:36.695563 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m21:33:36.742741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '35dda592-35be-4eec-8aa2-0d47ac203212', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ebf2c00>]}
[0m21:33:36.743167 [info ] [MainThread]: Found 10 models, 1 seed, 6 analyses, 19 data tests, 5 sources, 632 macros
[0m21:33:36.745097 [info ] [MainThread]: 
[0m21:33:36.745421 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:33:36.745809 [info ] [MainThread]: 
[0m21:33:36.746374 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:33:36.749427 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JAFFLE_SHOP'
[0m21:33:36.786610 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP"
[0m21:33:36.787114 [debug] [ThreadPool]: On list_JAFFLE_SHOP: show terse schemas in database JAFFLE_SHOP
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_JAFFLE_SHOP"} */
[0m21:33:36.787437 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:33:39.570155 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2.783 seconds
[0m21:33:39.573120 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_JAFFLE_SHOP, now list_JAFFLE_SHOP_ANALYTICS)
[0m21:33:39.582603 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP_ANALYTICS"
[0m21:33:39.582971 [debug] [ThreadPool]: On list_JAFFLE_SHOP_ANALYTICS: show objects in JAFFLE_SHOP.ANALYTICS
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_JAFFLE_SHOP_ANALYTICS"} */;
[0m21:33:39.698009 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 0.115 seconds
[0m21:33:39.702712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '35dda592-35be-4eec-8aa2-0d47ac203212', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8db6c590>]}
[0m21:33:39.709167 [debug] [Thread-1 (]: Began running node model.snowflake_spend.snowflake_amortized_rates
[0m21:33:39.709696 [debug] [Thread-2 (]: Began running node model.snowflake_spend.snowflake_query_history
[0m21:33:39.710205 [debug] [Thread-3 (]: Began running node model.snowflake_spend.snowflake_warehouse_metering
[0m21:33:39.710836 [info ] [Thread-1 (]: 1 of 14 START sql view model ANALYTICS.snowflake_amortized_rates ............... [RUN]
[0m21:33:39.711509 [info ] [Thread-2 (]: 2 of 14 START sql incremental model ANALYTICS.snowflake_query_history .......... [RUN]
[0m21:33:39.712309 [info ] [Thread-3 (]: 3 of 14 START sql view model ANALYTICS.snowflake_warehouse_metering ............ [RUN]
[0m21:33:39.713039 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_JAFFLE_SHOP_ANALYTICS, now model.snowflake_spend.snowflake_amortized_rates)
[0m21:33:39.713845 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.snowflake_spend.snowflake_query_history'
[0m21:33:39.714514 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.snowflake_spend.snowflake_warehouse_metering'
[0m21:33:39.715115 [debug] [Thread-1 (]: Began compiling node model.snowflake_spend.snowflake_amortized_rates
[0m21:33:39.715698 [debug] [Thread-2 (]: Began compiling node model.snowflake_spend.snowflake_query_history
[0m21:33:39.716216 [debug] [Thread-3 (]: Began compiling node model.snowflake_spend.snowflake_warehouse_metering
[0m21:33:39.727673 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_spend.snowflake_amortized_rates"
[0m21:33:39.731213 [debug] [Thread-2 (]: Writing injected SQL for node "model.snowflake_spend.snowflake_query_history"
[0m21:33:39.733810 [debug] [Thread-3 (]: Writing injected SQL for node "model.snowflake_spend.snowflake_warehouse_metering"
[0m21:33:39.734233 [debug] [Thread-1 (]: On model.snowflake_spend.snowflake_amortized_rates: select datediff(
        day,
        to_date('11/01/2009', 'mm/dd/yyyy'),
        dateadd(year, 40, current_date)
        )
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.snowflake_spend.snowflake_amortized_rates"} */
[0m21:33:39.736921 [debug] [Thread-2 (]: Began executing node model.snowflake_spend.snowflake_query_history
[0m21:33:39.737295 [debug] [Thread-3 (]: Began executing node model.snowflake_spend.snowflake_warehouse_metering
[0m21:33:39.784240 [debug] [Thread-3 (]: Writing runtime sql for node "model.snowflake_spend.snowflake_warehouse_metering"
[0m21:33:39.790990 [debug] [Thread-2 (]: Writing runtime sql for node "model.snowflake_spend.snowflake_query_history"
[0m21:33:39.793270 [debug] [Thread-2 (]: Using snowflake connection "model.snowflake_spend.snowflake_query_history"
[0m21:33:39.793722 [debug] [Thread-3 (]: Using snowflake connection "model.snowflake_spend.snowflake_warehouse_metering"
[0m21:33:39.793995 [debug] [Thread-2 (]: On model.snowflake_spend.snowflake_query_history: create or replace transient table JAFFLE_SHOP.ANALYTICS.snowflake_query_history
    
    
    
    as (


WITH source AS (

  SELECT *
  FROM snowflake.account_usage.query_history
  QUALIFY ROW_NUMBER() OVER (PARTITION BY query_id ORDER BY query_id) = 1

), renamed AS (

  SELECT 
    query_id                          AS snowflake_query_id,

    -- Foreign Keys
    database_id                       AS database_id,
    schema_id                         AS schema_id,
    session_id                        AS snowflake_session_id,
    warehouse_id                      AS warehouse_id,

    -- Logical Info
    database_name                     AS database_name,
    query_text                        AS query_text,
    role_name                         AS snowflake_role_name,
    rows_produced                     AS query_result_rows_produced,
    schema_name                       AS schema_name,
    user_name                         AS snowflake_user_name,
    warehouse_name                    AS warehouse_name,

    -- metadata 
    end_time                          AS query_end_time,
    start_time                        AS query_start_time,
    bytes_spilled_to_local_storage    AS query_bytes_spillover_local,
    bytes_spilled_to_remote_storage   AS query_bytes_spillover_remote,
    bytes_scanned                     AS query_bytes_scanned

  FROM source
  
  
)

SELECT * 
FROM renamed
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.snowflake_spend.snowflake_query_history"} */;
[0m21:33:39.794345 [debug] [Thread-3 (]: On model.snowflake_spend.snowflake_warehouse_metering: create or replace   view JAFFLE_SHOP.ANALYTICS.snowflake_warehouse_metering
  
  
  
  
  as (
    WITH base AS (

	SELECT *
	FROM snowflake.account_usage.warehouse_metering_history

)

SELECT
  warehouse_id,
  warehouse_name,
  start_time,
  end_time,
  credits_used
FROM base
  )
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.snowflake_spend.snowflake_warehouse_metering"} */;
[0m21:33:39.794684 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m21:33:39.795008 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m21:33:39.827682 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.092 seconds
[0m21:33:39.829578 [debug] [Thread-1 (]: Writing injected SQL for node "model.snowflake_spend.snowflake_amortized_rates"
[0m21:33:39.830747 [debug] [Thread-1 (]: Began executing node model.snowflake_spend.snowflake_amortized_rates
[0m21:33:39.832865 [debug] [Thread-1 (]: Writing runtime sql for node "model.snowflake_spend.snowflake_amortized_rates"
[0m21:33:39.835588 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_spend.snowflake_amortized_rates"
[0m21:33:39.835941 [debug] [Thread-1 (]: On model.snowflake_spend.snowflake_amortized_rates: create or replace   view JAFFLE_SHOP.ANALYTICS.snowflake_amortized_rates
  
  
  
  
  as (
    WITH contract_rates AS (

    SELECT *
    FROM JAFFLE_SHOP.ANALYTICS.snowflake_contract_rates

), contract_rate_rework AS (

    SELECT  
      effective_date    AS effective_start_date,
      DATEADD(day, -1, LEAD(effective_date, 1, '2059-01-01') OVER (
          ORDER BY effective_date ASC
        ))              AS effective_end_date,
      rate
    FROM contract_rates

), date_spine AS (

  





with rawdata as (

    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
     + 
    
    p1.generated_number * power(2, 1)
     + 
    
    p2.generated_number * power(2, 2)
     + 
    
    p3.generated_number * power(2, 3)
     + 
    
    p4.generated_number * power(2, 4)
     + 
    
    p5.generated_number * power(2, 5)
     + 
    
    p6.generated_number * power(2, 6)
     + 
    
    p7.generated_number * power(2, 7)
     + 
    
    p8.generated_number * power(2, 8)
     + 
    
    p9.generated_number * power(2, 9)
     + 
    
    p10.generated_number * power(2, 10)
     + 
    
    p11.generated_number * power(2, 11)
     + 
    
    p12.generated_number * power(2, 12)
     + 
    
    p13.generated_number * power(2, 13)
     + 
    
    p14.generated_number * power(2, 14)
    
    
    + 1
    as generated_number

    from

    
    p as p0
     cross join 
    
    p as p1
     cross join 
    
    p as p2
     cross join 
    
    p as p3
     cross join 
    
    p as p4
     cross join 
    
    p as p5
     cross join 
    
    p as p6
     cross join 
    
    p as p7
     cross join 
    
    p as p8
     cross join 
    
    p as p9
     cross join 
    
    p as p10
     cross join 
    
    p as p11
     cross join 
    
    p as p12
     cross join 
    
    p as p13
     cross join 
    
    p as p14
    
    

    )

    select *
    from unioned
    where generated_number <= 20444
    order by generated_number



),

all_periods as (

    select (
        

    dateadd(
        day,
        row_number() over (order by generated_number) - 1,
        to_date('11/01/2009', 'mm/dd/yyyy')
        )


    ) as date_day
    from rawdata

),

filtered as (

    select *
    from all_periods
    where date_day <= dateadd(year, 40, current_date)

)

select * from filtered



), date_details AS (

    SELECT  
      date_day,
      DATE_PART(month, date_day)    AS month_actual,
      DATE_PART(year, date_day)     AS year_actual,
      FIRST_VALUE(date_day) OVER (
          PARTITION BY year_actual, month_actual ORDER BY date_day
        )                           AS first_day_of_month
    FROM date_spine

), rate_amortized AS (

    SELECT 
      contract_rate_rework.*,
      date_details.date_day
    FROM contract_rate_rework
    LEFT JOIN date_details 
      ON date_details.date_day >= contract_rate_rework.effective_start_date
        AND date_details.date_day <= contract_rate_rework.effective_end_date

)

SELECT *
FROM rate_amortized
  )
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.snowflake_spend.snowflake_amortized_rates"} */;
[0m21:33:40.080201 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.244 seconds
[0m21:33:40.111931 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '35dda592-35be-4eec-8aa2-0d47ac203212', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87fa5f70>]}
[0m21:33:40.113207 [info ] [Thread-1 (]: 1 of 14 OK created sql view model ANALYTICS.snowflake_amortized_rates .......... [[32mSUCCESS 1[0m in 0.40s]
[0m21:33:40.116336 [debug] [Thread-1 (]: Finished running node model.snowflake_spend.snowflake_amortized_rates
[0m21:33:40.118641 [debug] [Thread-4 (]: Began running node test.snowflake_spend.not_null_snowflake_amortized_rates_date_day.43a955e78b
[0m21:33:40.119388 [debug] [Thread-1 (]: Began running node test.snowflake_spend.not_null_snowflake_amortized_rates_effective_start_date.2c8ca54b37
[0m21:33:40.119858 [info ] [Thread-4 (]: 4 of 14 START test not_null_snowflake_amortized_rates_date_day ................. [RUN]
[0m21:33:40.120343 [info ] [Thread-1 (]: 5 of 14 START test not_null_snowflake_amortized_rates_effective_start_date ..... [RUN]
[0m21:33:40.121716 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.snowflake_spend.not_null_snowflake_amortized_rates_date_day.43a955e78b'
[0m21:33:40.122309 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.snowflake_spend.snowflake_amortized_rates, now test.snowflake_spend.not_null_snowflake_amortized_rates_effective_start_date.2c8ca54b37)
[0m21:33:40.123129 [debug] [Thread-4 (]: Began compiling node test.snowflake_spend.not_null_snowflake_amortized_rates_date_day.43a955e78b
[0m21:33:40.123583 [debug] [Thread-1 (]: Began compiling node test.snowflake_spend.not_null_snowflake_amortized_rates_effective_start_date.2c8ca54b37
[0m21:33:40.133021 [debug] [Thread-4 (]: Writing injected SQL for node "test.snowflake_spend.not_null_snowflake_amortized_rates_date_day.43a955e78b"
[0m21:33:40.138079 [debug] [Thread-1 (]: Writing injected SQL for node "test.snowflake_spend.not_null_snowflake_amortized_rates_effective_start_date.2c8ca54b37"
[0m21:33:40.139528 [debug] [Thread-4 (]: Began executing node test.snowflake_spend.not_null_snowflake_amortized_rates_date_day.43a955e78b
[0m21:33:40.139990 [debug] [Thread-1 (]: Began executing node test.snowflake_spend.not_null_snowflake_amortized_rates_effective_start_date.2c8ca54b37
[0m21:33:40.233995 [debug] [Thread-4 (]: Writing runtime sql for node "test.snowflake_spend.not_null_snowflake_amortized_rates_date_day.43a955e78b"
[0m21:33:40.234537 [debug] [Thread-1 (]: Writing runtime sql for node "test.snowflake_spend.not_null_snowflake_amortized_rates_effective_start_date.2c8ca54b37"
[0m21:33:40.235520 [debug] [Thread-4 (]: Using snowflake connection "test.snowflake_spend.not_null_snowflake_amortized_rates_date_day.43a955e78b"
[0m21:33:40.235838 [debug] [Thread-4 (]: On test.snowflake_spend.not_null_snowflake_amortized_rates_date_day.43a955e78b: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select date_day
from JAFFLE_SHOP.ANALYTICS.snowflake_amortized_rates
where date_day is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.snowflake_spend.not_null_snowflake_amortized_rates_date_day.43a955e78b"} */
[0m21:33:40.236143 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m21:33:40.236550 [debug] [Thread-1 (]: Using snowflake connection "test.snowflake_spend.not_null_snowflake_amortized_rates_effective_start_date.2c8ca54b37"
[0m21:33:40.239473 [debug] [Thread-1 (]: On test.snowflake_spend.not_null_snowflake_amortized_rates_effective_start_date.2c8ca54b37: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select effective_start_date
from JAFFLE_SHOP.ANALYTICS.snowflake_amortized_rates
where effective_start_date is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.snowflake_spend.not_null_snowflake_amortized_rates_effective_start_date.2c8ca54b37"} */
[0m21:33:40.262458 [debug] [Thread-3 (]: Snowflake adapter: Snowflake query id: 01bfe36d-0305-5ad3-0004-0c2600053a92
[0m21:33:40.262961 [debug] [Thread-3 (]: Snowflake adapter: Snowflake error: 002003 (02000): SQL compilation error:
Schema 'SNOWFLAKE.ACCOUNT_USAGE' does not exist or not authorized.
[0m21:33:40.266313 [debug] [Thread-3 (]: Database Error in model snowflake_warehouse_metering (models/base/snowflake_warehouse_metering.sql)
  002003 (02000): SQL compilation error:
  Schema 'SNOWFLAKE.ACCOUNT_USAGE' does not exist or not authorized.
  compiled code at target/run/snowflake_spend/models/base/snowflake_warehouse_metering.sql
[0m21:33:40.266788 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '35dda592-35be-4eec-8aa2-0d47ac203212', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87f6c8f0>]}
[0m21:33:40.267247 [error] [Thread-3 (]: 3 of 14 ERROR creating sql view model ANALYTICS.snowflake_warehouse_metering ... [[31mERROR[0m in 0.55s]
[0m21:33:40.267722 [debug] [Thread-3 (]: Finished running node model.snowflake_spend.snowflake_warehouse_metering
[0m21:33:40.268112 [debug] [Thread-3 (]: Began running node test.snowflake_spend.not_null_snowflake_amortized_rates_rate.9af2fa3886
[0m21:33:40.268442 [debug] [Thread-7 (]: Marking all children of 'model.snowflake_spend.snowflake_warehouse_metering' to be skipped because of status 'error'.  Reason: Database Error in model snowflake_warehouse_metering (models/base/snowflake_warehouse_metering.sql)
  002003 (02000): SQL compilation error:
  Schema 'SNOWFLAKE.ACCOUNT_USAGE' does not exist or not authorized.
  compiled code at target/run/snowflake_spend/models/base/snowflake_warehouse_metering.sql.
[0m21:33:40.268735 [info ] [Thread-3 (]: 6 of 14 START test not_null_snowflake_amortized_rates_rate ..................... [RUN]
[0m21:33:40.269547 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.snowflake_spend.snowflake_warehouse_metering, now test.snowflake_spend.not_null_snowflake_amortized_rates_rate.9af2fa3886)
[0m21:33:40.269821 [debug] [Thread-3 (]: Began compiling node test.snowflake_spend.not_null_snowflake_amortized_rates_rate.9af2fa3886
[0m21:33:40.272821 [debug] [Thread-3 (]: Writing injected SQL for node "test.snowflake_spend.not_null_snowflake_amortized_rates_rate.9af2fa3886"
[0m21:33:40.275813 [debug] [Thread-3 (]: Began executing node test.snowflake_spend.not_null_snowflake_amortized_rates_rate.9af2fa3886
[0m21:33:40.278746 [debug] [Thread-3 (]: Writing runtime sql for node "test.snowflake_spend.not_null_snowflake_amortized_rates_rate.9af2fa3886"
[0m21:33:40.280100 [debug] [Thread-3 (]: Using snowflake connection "test.snowflake_spend.not_null_snowflake_amortized_rates_rate.9af2fa3886"
[0m21:33:40.280442 [debug] [Thread-3 (]: On test.snowflake_spend.not_null_snowflake_amortized_rates_rate.9af2fa3886: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select rate
from JAFFLE_SHOP.ANALYTICS.snowflake_amortized_rates
where rate is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.snowflake_spend.not_null_snowflake_amortized_rates_rate.9af2fa3886"} */
[0m21:33:40.423609 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01bfe36d-0305-5ad3-0004-0c2600053a9a
[0m21:33:40.424313 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 002003 (02000): SQL compilation error:
Schema 'SNOWFLAKE.ACCOUNT_USAGE' does not exist or not authorized.
[0m21:33:40.427409 [debug] [Thread-2 (]: Database Error in model snowflake_query_history (models/base/snowflake_query_history.sql)
  002003 (02000): SQL compilation error:
  Schema 'SNOWFLAKE.ACCOUNT_USAGE' does not exist or not authorized.
  compiled code at target/run/snowflake_spend/models/base/snowflake_query_history.sql
[0m21:33:40.427983 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '35dda592-35be-4eec-8aa2-0d47ac203212', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e35a060>]}
[0m21:33:40.428736 [error] [Thread-2 (]: 2 of 14 ERROR creating sql incremental model ANALYTICS.snowflake_query_history . [[31mERROR[0m in 0.71s]
[0m21:33:40.429377 [debug] [Thread-2 (]: Finished running node model.snowflake_spend.snowflake_query_history
[0m21:33:40.429867 [debug] [Thread-2 (]: Began running node test.snowflake_spend.unique_snowflake_amortized_rates_date_day.6a11e4202b
[0m21:33:40.430343 [debug] [Thread-7 (]: Marking all children of 'model.snowflake_spend.snowflake_query_history' to be skipped because of status 'error'.  Reason: Database Error in model snowflake_query_history (models/base/snowflake_query_history.sql)
  002003 (02000): SQL compilation error:
  Schema 'SNOWFLAKE.ACCOUNT_USAGE' does not exist or not authorized.
  compiled code at target/run/snowflake_spend/models/base/snowflake_query_history.sql.
[0m21:33:40.430737 [info ] [Thread-2 (]: 7 of 14 START test unique_snowflake_amortized_rates_date_day ................... [RUN]
[0m21:33:40.431772 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.snowflake_spend.snowflake_query_history, now test.snowflake_spend.unique_snowflake_amortized_rates_date_day.6a11e4202b)
[0m21:33:40.432221 [debug] [Thread-2 (]: Began compiling node test.snowflake_spend.unique_snowflake_amortized_rates_date_day.6a11e4202b
[0m21:33:40.438024 [debug] [Thread-2 (]: Writing injected SQL for node "test.snowflake_spend.unique_snowflake_amortized_rates_date_day.6a11e4202b"
[0m21:33:40.439113 [debug] [Thread-2 (]: Began executing node test.snowflake_spend.unique_snowflake_amortized_rates_date_day.6a11e4202b
[0m21:33:40.442700 [debug] [Thread-2 (]: Writing runtime sql for node "test.snowflake_spend.unique_snowflake_amortized_rates_date_day.6a11e4202b"
[0m21:33:40.444302 [debug] [Thread-2 (]: Using snowflake connection "test.snowflake_spend.unique_snowflake_amortized_rates_date_day.6a11e4202b"
[0m21:33:40.444694 [debug] [Thread-2 (]: On test.snowflake_spend.unique_snowflake_amortized_rates_date_day.6a11e4202b: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    date_day as unique_field,
    count(*) as n_records

from JAFFLE_SHOP.ANALYTICS.snowflake_amortized_rates
where date_day is not null
group by date_day
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.snowflake_spend.unique_snowflake_amortized_rates_date_day.6a11e4202b"} */
[0m21:33:40.939501 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.698 seconds
[0m21:33:40.945534 [info ] [Thread-1 (]: 5 of 14 PASS not_null_snowflake_amortized_rates_effective_start_date ........... [[32mPASS[0m in 0.82s]
[0m21:33:40.946209 [debug] [Thread-1 (]: Finished running node test.snowflake_spend.not_null_snowflake_amortized_rates_effective_start_date.2c8ca54b37
[0m21:33:40.946604 [debug] [Thread-1 (]: Began running node test.snowflake_spend.not_null_snowflake_query_history_query_end_time.153318a08f
[0m21:33:40.948275 [info ] [Thread-1 (]: 8 of 14 SKIP test not_null_snowflake_query_history_query_end_time .............. [[33mSKIP[0m]
[0m21:33:40.949018 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.668 seconds
[0m21:33:40.949355 [debug] [Thread-1 (]: Finished running node test.snowflake_spend.not_null_snowflake_query_history_query_end_time.153318a08f
[0m21:33:40.950946 [info ] [Thread-3 (]: 6 of 14 PASS not_null_snowflake_amortized_rates_rate ........................... [[32mPASS[0m in 0.68s]
[0m21:33:40.951595 [debug] [Thread-1 (]: Began running node test.snowflake_spend.not_null_snowflake_query_history_query_start_time.38ffdeb96f
[0m21:33:40.951888 [debug] [Thread-7 (]: Marking all children of 'test.snowflake_spend.not_null_snowflake_query_history_query_end_time.153318a08f' to be skipped because of status 'skipped'. 
[0m21:33:40.952281 [debug] [Thread-3 (]: Finished running node test.snowflake_spend.not_null_snowflake_amortized_rates_rate.9af2fa3886
[0m21:33:40.952656 [info ] [Thread-1 (]: 9 of 14 SKIP test not_null_snowflake_query_history_query_start_time ............ [[33mSKIP[0m]
[0m21:33:40.953349 [debug] [Thread-3 (]: Began running node test.snowflake_spend.not_null_snowflake_query_history_query_text.cf466ed98c
[0m21:33:40.953722 [debug] [Thread-1 (]: Finished running node test.snowflake_spend.not_null_snowflake_query_history_query_start_time.38ffdeb96f
[0m21:33:40.954065 [info ] [Thread-3 (]: 10 of 14 SKIP test not_null_snowflake_query_history_query_text ................. [[33mSKIP[0m]
[0m21:33:40.954485 [debug] [Thread-1 (]: Began running node test.snowflake_spend.not_null_snowflake_query_history_snowflake_query_id.9237f60e6c
[0m21:33:40.954808 [debug] [Thread-7 (]: Marking all children of 'test.snowflake_spend.not_null_snowflake_query_history_query_start_time.38ffdeb96f' to be skipped because of status 'skipped'. 
[0m21:33:40.955080 [debug] [Thread-3 (]: Finished running node test.snowflake_spend.not_null_snowflake_query_history_query_text.cf466ed98c
[0m21:33:40.955415 [info ] [Thread-1 (]: 11 of 14 SKIP test not_null_snowflake_query_history_snowflake_query_id ......... [[33mSKIP[0m]
[0m21:33:40.956252 [debug] [Thread-3 (]: Began running node test.snowflake_spend.not_null_snowflake_query_history_snowflake_user_name.41f5f6930e
[0m21:33:40.956792 [debug] [Thread-7 (]: Marking all children of 'test.snowflake_spend.not_null_snowflake_query_history_query_text.cf466ed98c' to be skipped because of status 'skipped'. 
[0m21:33:40.957399 [debug] [Thread-1 (]: Finished running node test.snowflake_spend.not_null_snowflake_query_history_snowflake_query_id.9237f60e6c
[0m21:33:40.957820 [info ] [Thread-3 (]: 12 of 14 SKIP test not_null_snowflake_query_history_snowflake_user_name ........ [[33mSKIP[0m]
[0m21:33:40.958912 [debug] [Thread-1 (]: Began running node test.snowflake_spend.unique_snowflake_query_history_snowflake_query_id.f8c7902fa0
[0m21:33:40.959299 [debug] [Thread-7 (]: Marking all children of 'test.snowflake_spend.not_null_snowflake_query_history_snowflake_query_id.9237f60e6c' to be skipped because of status 'skipped'. 
[0m21:33:40.959670 [debug] [Thread-3 (]: Finished running node test.snowflake_spend.not_null_snowflake_query_history_snowflake_user_name.41f5f6930e
[0m21:33:40.960374 [info ] [Thread-1 (]: 13 of 14 SKIP test unique_snowflake_query_history_snowflake_query_id ........... [[33mSKIP[0m]
[0m21:33:40.961768 [debug] [Thread-7 (]: Marking all children of 'test.snowflake_spend.not_null_snowflake_query_history_snowflake_user_name.41f5f6930e' to be skipped because of status 'skipped'. 
[0m21:33:40.962332 [debug] [Thread-1 (]: Finished running node test.snowflake_spend.unique_snowflake_query_history_snowflake_query_id.f8c7902fa0
[0m21:33:40.963077 [debug] [Thread-7 (]: Marking all children of 'test.snowflake_spend.unique_snowflake_query_history_snowflake_query_id.f8c7902fa0' to be skipped because of status 'skipped'. 
[0m21:33:41.102020 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.866 seconds
[0m21:33:41.103869 [info ] [Thread-4 (]: 4 of 14 PASS not_null_snowflake_amortized_rates_date_day ....................... [[32mPASS[0m in 0.98s]
[0m21:33:41.105936 [debug] [Thread-4 (]: Finished running node test.snowflake_spend.not_null_snowflake_amortized_rates_date_day.43a955e78b
[0m21:33:41.150841 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.705 seconds
[0m21:33:41.152462 [info ] [Thread-2 (]: 7 of 14 PASS unique_snowflake_amortized_rates_date_day ......................... [[32mPASS[0m in 0.72s]
[0m21:33:41.153064 [debug] [Thread-2 (]: Finished running node test.snowflake_spend.unique_snowflake_amortized_rates_date_day.6a11e4202b
[0m21:33:41.153677 [debug] [Thread-3 (]: Began running node model.snowflake_spend.snowflake_warehouse_metering_xf
[0m21:33:41.154109 [info ] [Thread-3 (]: 14 of 14 SKIP relation ANALYTICS.snowflake_warehouse_metering_xf ............... [[33mSKIP[0m]
[0m21:33:41.154438 [debug] [Thread-3 (]: Finished running node model.snowflake_spend.snowflake_warehouse_metering_xf
[0m21:33:41.154761 [debug] [Thread-7 (]: Marking all children of 'model.snowflake_spend.snowflake_warehouse_metering_xf' to be skipped because of status 'skipped'. 
[0m21:33:41.156005 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:33:41.156317 [debug] [MainThread]: Connection 'test.snowflake_spend.not_null_snowflake_amortized_rates_effective_start_date.2c8ca54b37' was left open.
[0m21:33:41.156578 [debug] [MainThread]: On test.snowflake_spend.not_null_snowflake_amortized_rates_effective_start_date.2c8ca54b37: Close
[0m21:33:41.901509 [debug] [MainThread]: Connection 'test.snowflake_spend.unique_snowflake_amortized_rates_date_day.6a11e4202b' was left open.
[0m21:33:41.901924 [debug] [MainThread]: On test.snowflake_spend.unique_snowflake_amortized_rates_date_day.6a11e4202b: Close
[0m21:33:42.834867 [debug] [MainThread]: Connection 'test.snowflake_spend.not_null_snowflake_amortized_rates_rate.9af2fa3886' was left open.
[0m21:33:42.835278 [debug] [MainThread]: On test.snowflake_spend.not_null_snowflake_amortized_rates_rate.9af2fa3886: Close
[0m21:33:43.772504 [debug] [MainThread]: Connection 'test.snowflake_spend.not_null_snowflake_amortized_rates_date_day.43a955e78b' was left open.
[0m21:33:43.774223 [debug] [MainThread]: On test.snowflake_spend.not_null_snowflake_amortized_rates_date_day.43a955e78b: Close
[0m21:33:44.572273 [info ] [MainThread]: 
[0m21:33:44.574365 [info ] [MainThread]: Finished running 1 incremental model, 10 data tests, 3 view models in 0 hours 0 minutes and 7.82 seconds (7.82s).
[0m21:33:44.579939 [debug] [MainThread]: Command end result
[0m21:33:44.643207 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m21:33:44.646784 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m21:33:44.653113 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/target/run_results.json
[0m21:33:44.653581 [info ] [MainThread]: 
[0m21:33:44.654122 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m21:33:44.654715 [info ] [MainThread]: 
[0m21:33:44.655693 [error] [MainThread]: [31mFailure in model snowflake_warehouse_metering (models/base/snowflake_warehouse_metering.sql)[0m
[0m21:33:44.656193 [error] [MainThread]:   Database Error in model snowflake_warehouse_metering (models/base/snowflake_warehouse_metering.sql)
  002003 (02000): SQL compilation error:
  Schema 'SNOWFLAKE.ACCOUNT_USAGE' does not exist or not authorized.
  compiled code at target/run/snowflake_spend/models/base/snowflake_warehouse_metering.sql
[0m21:33:44.656493 [info ] [MainThread]: 
[0m21:33:44.656957 [info ] [MainThread]:   compiled code at target/compiled/snowflake_spend/models/base/snowflake_warehouse_metering.sql
[0m21:33:44.657297 [info ] [MainThread]: 
[0m21:33:44.657680 [error] [MainThread]: [31mFailure in model snowflake_query_history (models/base/snowflake_query_history.sql)[0m
[0m21:33:44.657983 [error] [MainThread]:   Database Error in model snowflake_query_history (models/base/snowflake_query_history.sql)
  002003 (02000): SQL compilation error:
  Schema 'SNOWFLAKE.ACCOUNT_USAGE' does not exist or not authorized.
  compiled code at target/run/snowflake_spend/models/base/snowflake_query_history.sql
[0m21:33:44.658258 [info ] [MainThread]: 
[0m21:33:44.658740 [info ] [MainThread]:   compiled code at target/compiled/snowflake_spend/models/base/snowflake_query_history.sql
[0m21:33:44.659128 [info ] [MainThread]: 
[0m21:33:44.659491 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=2 SKIP=7 NO-OP=0 TOTAL=14
[0m21:33:44.660354 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ConfigSourcePathDeprecation: 1 occurrence
- ConfigDataPathDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m21:33:44.662392 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 10.467181, "process_in_blocks": "0", "process_kernel_time": 0.47227, "process_mem_max_rss": "248084", "process_out_blocks": "4772", "process_user_time": 4.854174}
[0m21:33:44.663091 [debug] [MainThread]: Command `dbt build` failed at 21:33:44.662997 after 10.47 seconds
[0m21:33:44.664155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffacca39b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8fd09c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8eb3af30>]}
[0m21:33:44.665300 [debug] [MainThread]: Flushing usage events
[0m21:33:45.955611 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:44:53.566546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0593d40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb163c860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf8db6b0>]}


============================== 21:44:53.572059 | a335ba26-8f66-4ece-b52d-10ff4c4619c5 ==============================
[0m21:44:53.572059 [info ] [MainThread]: Running with dbt=1.10.13
[0m21:44:53.572482 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'use_experimental_parser': 'False', 'write_json': 'True', 'introspect': 'True', 'invocation_command': 'dbt run-operation grant_select', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'empty': 'None', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'profiles_dir': '/opt/airflow/dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'no_print': 'None', 'cache_selected_only': 'False', 'debug': 'False', 'log_format': 'default', 'quiet': 'False', 'static_parser': 'True', 'use_colors': 'True', 'log_cache_events': 'False', 'printer_width': '80', 'warn_error': 'None', 'partial_parse': 'True'}
[0m21:44:54.188068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a335ba26-8f66-4ece-b52d-10ff4c4619c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93d90530>]}
[0m21:44:54.224689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a335ba26-8f66-4ece-b52d-10ff4c4619c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff951763c0>]}
[0m21:44:54.225371 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m21:44:54.303963 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m21:44:54.304464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'a335ba26-8f66-4ece-b52d-10ff4c4619c5', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93c79640>]}
[0m21:44:54.305022 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m21:44:54.305342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'a335ba26-8f66-4ece-b52d-10ff4c4619c5', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffafeb74d0>]}
[0m21:44:54.307464 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m21:44:54.398619 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m21:44:54.399225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a335ba26-8f66-4ece-b52d-10ff4c4619c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9396c890>]}
[0m21:44:55.636720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a335ba26-8f66-4ece-b52d-10ff4c4619c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92fea840>]}
[0m21:44:55.706764 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m21:44:55.708293 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m21:44:55.717637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a335ba26-8f66-4ece-b52d-10ff4c4619c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff937e9310>]}
[0m21:44:55.718030 [info ] [MainThread]: Found 10 models, 1 seed, 6 analyses, 19 data tests, 5 sources, 633 macros
[0m21:44:55.718430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a335ba26-8f66-4ece-b52d-10ff4c4619c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92f07050>]}
[0m21:44:55.719071 [debug] [MainThread]: Acquiring new snowflake connection 'macro_grant_select'
[0m21:44:55.722208 [info ] [MainThread]: Granting select on all and future tables/views in schema ANALYTICS to role SYSADMIN
[0m21:44:55.748381 [debug] [MainThread]: Using snowflake connection "macro_grant_select"
[0m21:44:55.748783 [debug] [MainThread]: On macro_grant_select: grant usage on schema ANALYTICS to role SYSADMIN
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "macro_grant_select"} */;
[0m21:44:55.749030 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:44:57.747470 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.998 seconds
[0m21:44:57.748438 [debug] [MainThread]: Using snowflake connection "macro_grant_select"
[0m21:44:57.749122 [debug] [MainThread]: On macro_grant_select: -- Existing tables and views
  grant select on all tables in schema ANALYTICS to role SYSADMIN
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "macro_grant_select"} */;
[0m21:44:57.904378 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.154 seconds
[0m21:44:57.905753 [debug] [MainThread]: Using snowflake connection "macro_grant_select"
[0m21:44:57.906341 [debug] [MainThread]: On macro_grant_select: grant select on all views in schema ANALYTICS to role SYSADMIN
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "macro_grant_select"} */;
[0m21:44:58.072487 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.165 seconds
[0m21:44:58.073870 [debug] [MainThread]: Using snowflake connection "macro_grant_select"
[0m21:44:58.074646 [debug] [MainThread]: On macro_grant_select: -- Future tables and views
  grant select on future tables in schema ANALYTICS to role SYSADMIN
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "macro_grant_select"} */;
[0m21:44:58.161204 [debug] [MainThread]: Snowflake adapter: Snowflake query id: 01bfe378-0305-5acf-0004-0c2600054072
[0m21:44:58.162399 [debug] [MainThread]: Snowflake adapter: Snowflake error: 003001 (42501): SQL access control error:
Insufficient privileges to operate on schema 'ANALYTICS'.
[0m21:44:58.163419 [debug] [MainThread]: Snowflake adapter: Error running SQL: macro grant_select
[0m21:44:58.164428 [debug] [MainThread]: Snowflake adapter: Rolling back transaction.
[0m21:44:58.165670 [error] [MainThread]: Encountered an error while running operation: Database Error
  003001 (42501): SQL access control error:
  Insufficient privileges to operate on schema 'ANALYTICS'.
[0m21:44:58.171728 [debug] [MainThread]: Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/adapters/snowflake/connections.py", line 320, in exception_handler
    yield
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/adapters/sql/connections.py", line 148, in add_query
    _execute_query_with_retry(
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/adapters/sql/connections.py", line 97, in _execute_query_with_retry
    cursor.execute(sql, bindings)
  File "/home/airflow/.local/lib/python3.12/site-packages/snowflake/connector/cursor.py", line 1134, in execute
    Error.errorhandler_wrapper(self.connection, self, error_class, errvalue)
  File "/home/airflow/.local/lib/python3.12/site-packages/snowflake/connector/errors.py", line 286, in errorhandler_wrapper
    handed_over = Error.hand_to_other_handler(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/snowflake/connector/errors.py", line 341, in hand_to_other_handler
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/home/airflow/.local/lib/python3.12/site-packages/snowflake/connector/errors.py", line 217, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 003001 (42501): SQL access control error:
Insufficient privileges to operate on schema 'ANALYTICS'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/task/run_operation.py", line 64, in run
    self._run_unsafe(package_name, macro_name)
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/task/run_operation.py", line 45, in _run_unsafe
    res = adapter.execute_macro(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/adapters/base/impl.py", line 1294, in execute_macro
    result = macro_function(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt_common/clients/jinja.py", line 427, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt_common/clients/jinja.py", line 395, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 57, in macro
  File "/home/airflow/.local/lib/python3.12/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/clients/jinja.py", line 82, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt_common/clients/jinja.py", line 395, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 33, in macro
  File "/home/airflow/.local/lib/python3.12/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/clients/jinja.py", line 82, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt_common/clients/jinja.py", line 395, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 52, in macro
  File "/home/airflow/.local/lib/python3.12/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt_common/record.py", line 512, in record_replay_wrapper
    return func_to_record(*call_args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/adapters/base/impl.py", line 450, in execute
    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch, limit=limit)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/adapters/snowflake/connections.py", line 520, in execute
    _, cursor = self.add_query(sql, auto_begin)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/adapters/snowflake/connections.py", line 557, in add_query
    connection, cursor = self._add_standard_queries(
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/adapters/snowflake/connections.py", line 616, in _add_standard_queries
    connection, cursor = self.add_standard_query(query, **kwargs)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/adapters/snowflake/connections.py", line 531, in add_standard_query
    return super().add_query(self._add_query_comment(sql), **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/adapters/sql/connections.py", line 131, in add_query
    with self.exception_handler(sql):
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/python/lib/python3.12/contextlib.py", line 158, in __exit__
    self.gen.throw(value)
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/adapters/snowflake/connections.py", line 346, in exception_handler
    raise DbtDatabaseError(msg)
dbt_common.exceptions.base.DbtDatabaseError: Database Error
  003001 (42501): SQL access control error:
  Insufficient privileges to operate on schema 'ANALYTICS'.

[0m21:44:58.183675 [debug] [MainThread]: Wrote artifact RunResultsArtifact to /opt/airflow/dbt/target/run_results.json
[0m21:44:58.184696 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ConfigSourcePathDeprecation: 1 occurrence
- ConfigDataPathDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m21:44:58.186571 [debug] [MainThread]: Resource report: {"command_name": "run-operation", "command_success": false, "command_wall_clock_time": 4.6552515, "process_in_blocks": "32", "process_kernel_time": 0.579717, "process_mem_max_rss": "235288", "process_out_blocks": "3158", "process_user_time": 4.068089}
[0m21:44:58.187367 [debug] [MainThread]: Command `dbt run-operation` failed at 21:44:58.187238 after 4.66 seconds
[0m21:44:58.187920 [debug] [MainThread]: Connection 'macro_grant_select' was left open.
[0m21:44:58.188424 [debug] [MainThread]: On macro_grant_select: Close
[0m21:44:58.993876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffafe4e570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91f9d5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91f5fe30>]}
[0m21:44:58.996085 [debug] [MainThread]: Flushing usage events
[0m21:45:00.239808 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:46:40.743648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93bed640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff958b9520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93a9f9b0>]}


============================== 21:46:40.750181 | 0bf1adb9-8c14-4ef5-897c-c8261e3859f7 ==============================
[0m21:46:40.750181 [info ] [MainThread]: Running with dbt=1.10.13
[0m21:46:40.750750 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'use_colors': 'True', 'cache_selected_only': 'False', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'warn_error': 'None', 'fail_fast': 'False', 'no_print': 'None', 'invocation_command': 'dbt run-operation grant_select', 'write_json': 'True', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True', 'quiet': 'False', 'profiles_dir': '/opt/airflow/dbt', 'empty': 'None', 'send_anonymous_usage_stats': 'True', 'log_path': '/opt/airflow/dbt/logs', 'static_parser': 'True', 'debug': 'False', 'target_path': 'None', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'introspect': 'True'}
[0m21:46:41.422716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0bf1adb9-8c14-4ef5-897c-c8261e3859f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff786445f0>]}
[0m21:46:41.458542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0bf1adb9-8c14-4ef5-897c-c8261e3859f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff798cba10>]}
[0m21:46:41.459190 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m21:46:41.539607 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m21:46:41.540069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '0bf1adb9-8c14-4ef5-897c-c8261e3859f7', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff77244830>]}
[0m21:46:41.540679 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m21:46:41.541011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '0bf1adb9-8c14-4ef5-897c-c8261e3859f7', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8efa4410>]}
[0m21:46:41.543240 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m21:46:41.638298 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m21:46:41.638775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '0bf1adb9-8c14-4ef5-897c-c8261e3859f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d9f3dd0>]}
[0m21:46:42.916897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0bf1adb9-8c14-4ef5-897c-c8261e3859f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff76124e90>]}
[0m21:46:42.987716 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m21:46:42.989314 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m21:46:42.999504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0bf1adb9-8c14-4ef5-897c-c8261e3859f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff765285f0>]}
[0m21:46:42.999926 [info ] [MainThread]: Found 10 models, 1 seed, 6 analyses, 19 data tests, 5 sources, 633 macros
[0m21:46:43.000221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0bf1adb9-8c14-4ef5-897c-c8261e3859f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff75d6dac0>]}
[0m21:46:43.000774 [debug] [MainThread]: Acquiring new snowflake connection 'macro_grant_select'
[0m21:46:43.003785 [info ] [MainThread]: Granting select on all and future tables/views in schema ANALYTICS to role ACCOUNTADMIN
[0m21:46:43.036860 [debug] [MainThread]: Using snowflake connection "macro_grant_select"
[0m21:46:43.044554 [debug] [MainThread]: On macro_grant_select: grant usage on schema ANALYTICS to role ACCOUNTADMIN
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "macro_grant_select"} */;
[0m21:46:43.048582 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:46:45.775001 [debug] [MainThread]: Snowflake adapter: Error running SQL: grant usage on schema ANALYTICS to role ACCOUNTADMIN
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "macro_grant_select"} */;
[0m21:46:45.776433 [debug] [MainThread]: Snowflake adapter: Rolling back transaction.
[0m21:46:45.777438 [debug] [MainThread]: Snowflake adapter: Error running SQL: macro grant_select
[0m21:46:45.778187 [debug] [MainThread]: Snowflake adapter: Rolling back transaction.
[0m21:46:45.779500 [error] [MainThread]: Encountered an error while running operation: Database Error
  250001 (08001): Failed to connect to DB: mqudxat-we87356.snowflakecomputing.com:443. Role 'ACCOUNTADMIN' specified in the connect string is not granted to this user. Contact your local system administrator, or attempt to login with another role, e.g. PUBLIC.
[0m21:46:45.786815 [debug] [MainThread]: Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/adapters/base/connections.py", line 237, in retry_connection
    connection.handle = connect()
                        ^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/adapters/snowflake/connections.py", line 386, in connect
    handle = snowflake.connector.connect(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/snowflake/connector/__init__.py", line 54, in Connect
    return SnowflakeConnection(**kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/snowflake/connector/connection.py", line 588, in __init__
    self.connect(**kwargs)
  File "/home/airflow/.local/lib/python3.12/site-packages/snowflake/connector/connection.py", line 972, in connect
    self.__open_connection()
  File "/home/airflow/.local/lib/python3.12/site-packages/snowflake/connector/connection.py", line 1371, in __open_connection
    self.authenticate_with_retry(self.auth_class)
  File "/home/airflow/.local/lib/python3.12/site-packages/snowflake/connector/connection.py", line 1704, in authenticate_with_retry
    self._authenticate(auth_instance)
  File "/home/airflow/.local/lib/python3.12/site-packages/snowflake/connector/connection.py", line 1736, in _authenticate
    auth.authenticate(
  File "/home/airflow/.local/lib/python3.12/site-packages/snowflake/connector/auth/_auth.py", line 401, in authenticate
    Error.errorhandler_wrapper(
  File "/home/airflow/.local/lib/python3.12/site-packages/snowflake/connector/errors.py", line 286, in errorhandler_wrapper
    handed_over = Error.hand_to_other_handler(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/snowflake/connector/errors.py", line 344, in hand_to_other_handler
    connection.errorhandler(connection, cursor, error_class, error_value)
  File "/home/airflow/.local/lib/python3.12/site-packages/snowflake/connector/errors.py", line 217, in default_errorhandler
    raise error_class(
snowflake.connector.errors.DatabaseError: 250001 (08001): Failed to connect to DB: mqudxat-we87356.snowflakecomputing.com:443. Role 'ACCOUNTADMIN' specified in the connect string is not granted to this user. Contact your local system administrator, or attempt to login with another role, e.g. PUBLIC.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/task/run_operation.py", line 64, in run
    self._run_unsafe(package_name, macro_name)
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/task/run_operation.py", line 45, in _run_unsafe
    res = adapter.execute_macro(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/adapters/base/impl.py", line 1294, in execute_macro
    result = macro_function(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt_common/clients/jinja.py", line 427, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt_common/clients/jinja.py", line 395, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 57, in macro
  File "/home/airflow/.local/lib/python3.12/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/clients/jinja.py", line 82, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt_common/clients/jinja.py", line 395, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 33, in macro
  File "/home/airflow/.local/lib/python3.12/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/clients/jinja.py", line 82, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt_common/clients/jinja.py", line 395, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 52, in macro
  File "/home/airflow/.local/lib/python3.12/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt_common/record.py", line 512, in record_replay_wrapper
    return func_to_record(*call_args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/adapters/base/impl.py", line 450, in execute
    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch, limit=limit)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/adapters/snowflake/connections.py", line 520, in execute
    _, cursor = self.add_query(sql, auto_begin)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/adapters/snowflake/connections.py", line 557, in add_query
    connection, cursor = self._add_standard_queries(
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/adapters/snowflake/connections.py", line 616, in _add_standard_queries
    connection, cursor = self.add_standard_query(query, **kwargs)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/adapters/snowflake/connections.py", line 531, in add_standard_query
    return super().add_query(self._add_query_comment(sql), **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/adapters/sql/connections.py", line 147, in add_query
    cursor = connection.handle.cursor()
             ^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/adapters/contracts/connection.py", line 96, in handle
    self._handle.resolve(self)
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/adapters/contracts/connection.py", line 120, in resolve
    return self.opener(connection)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/adapters/snowflake/connections.py", line 426, in open
    return cls.retry_connection(
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/adapters/base/connections.py", line 267, in retry_connection
    raise FailedToConnectError(str(e))
dbt.adapters.exceptions.connection.FailedToConnectError: Database Error
  250001 (08001): Failed to connect to DB: mqudxat-we87356.snowflakecomputing.com:443. Role 'ACCOUNTADMIN' specified in the connect string is not granted to this user. Contact your local system administrator, or attempt to login with another role, e.g. PUBLIC.

[0m21:46:45.797622 [debug] [MainThread]: Wrote artifact RunResultsArtifact to /opt/airflow/dbt/target/run_results.json
[0m21:46:45.798583 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ConfigSourcePathDeprecation: 1 occurrence
- ConfigDataPathDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m21:46:45.800500 [debug] [MainThread]: Resource report: {"command_name": "run-operation", "command_success": false, "command_wall_clock_time": 5.152552, "process_in_blocks": "0", "process_kernel_time": 0.500451, "process_mem_max_rss": "234956", "process_out_blocks": "3159", "process_user_time": 4.186058}
[0m21:46:45.801345 [debug] [MainThread]: Command `dbt run-operation` failed at 21:46:45.801165 after 5.15 seconds
[0m21:46:45.801938 [debug] [MainThread]: Connection 'macro_grant_select' was left open.
[0m21:46:45.803036 [debug] [MainThread]: On macro_grant_select: No close available on handle
[0m21:46:45.803721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92f5dac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff765285f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff933d9010>]}
[0m21:46:45.804471 [debug] [MainThread]: Flushing usage events
[0m21:46:47.224375 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:47:35.942164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80899430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8060bbc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7fed84d0>]}


============================== 21:47:35.948487 | f0f305a6-3b0e-494a-bb3e-b0deb7f0c356 ==============================
[0m21:47:35.948487 [info ] [MainThread]: Running with dbt=1.10.13
[0m21:47:35.949069 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'warn_error': 'None', 'empty': 'None', 'printer_width': '80', 'no_print': 'None', 'write_json': 'True', 'use_colors': 'True', 'invocation_command': 'dbt run-operation grant_select', 'cache_selected_only': 'False', 'target_path': 'None', 'static_parser': 'True', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': '/opt/airflow/dbt', 'introspect': 'True', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'log_path': '/opt/airflow/dbt/logs', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'log_format': 'default', 'debug': 'False', 'quiet': 'False'}
[0m21:47:36.647731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f0f305a6-3b0e-494a-bb3e-b0deb7f0c356', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff640e45f0>]}
[0m21:47:36.685397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f0f305a6-3b0e-494a-bb3e-b0deb7f0c356', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7fe3eea0>]}
[0m21:47:36.686123 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m21:47:36.764807 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m21:47:36.765215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'f0f305a6-3b0e-494a-bb3e-b0deb7f0c356', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff63c526c0>]}
[0m21:47:36.765655 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m21:47:36.765958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'f0f305a6-3b0e-494a-bb3e-b0deb7f0c356', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff63c526c0>]}
[0m21:47:36.767958 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m21:47:37.041114 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:47:37.041529 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:47:37.082689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f0f305a6-3b0e-494a-bb3e-b0deb7f0c356', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff63cabd70>]}
[0m21:47:37.156891 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m21:47:37.158436 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m21:47:37.167905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f0f305a6-3b0e-494a-bb3e-b0deb7f0c356', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff63af4b60>]}
[0m21:47:37.168311 [info ] [MainThread]: Found 10 models, 1 seed, 6 analyses, 19 data tests, 5 sources, 633 macros
[0m21:47:37.168651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f0f305a6-3b0e-494a-bb3e-b0deb7f0c356', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff63a7deb0>]}
[0m21:47:37.169231 [debug] [MainThread]: Acquiring new snowflake connection 'macro_grant_select'
[0m21:47:37.174434 [info ] [MainThread]: Granting select on all and future tables/views in schema ANALYTICS to role ACCOUNTADMIN
[0m21:47:37.206207 [debug] [MainThread]: Using snowflake connection "macro_grant_select"
[0m21:47:37.206669 [debug] [MainThread]: On macro_grant_select: grant usage on schema ANALYTICS to role ACCOUNTADMIN
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "macro_grant_select"} */;
[0m21:47:37.206949 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:47:40.128603 [debug] [MainThread]: SQL status: SUCCESS 1 in 2.921 seconds
[0m21:47:40.130535 [debug] [MainThread]: Using snowflake connection "macro_grant_select"
[0m21:47:40.132184 [debug] [MainThread]: On macro_grant_select: -- Existing tables and views
  grant select on all tables in schema ANALYTICS to role ACCOUNTADMIN
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "macro_grant_select"} */;
[0m21:47:40.315070 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.181 seconds
[0m21:47:40.316186 [debug] [MainThread]: Using snowflake connection "macro_grant_select"
[0m21:47:40.317228 [debug] [MainThread]: On macro_grant_select: grant select on all views in schema ANALYTICS to role ACCOUNTADMIN
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "macro_grant_select"} */;
[0m21:47:40.475009 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.157 seconds
[0m21:47:40.476178 [debug] [MainThread]: Using snowflake connection "macro_grant_select"
[0m21:47:40.476658 [debug] [MainThread]: On macro_grant_select: -- Future tables and views
  grant select on future tables in schema ANALYTICS to role ACCOUNTADMIN
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "macro_grant_select"} */;
[0m21:47:40.594419 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.117 seconds
[0m21:47:40.595722 [debug] [MainThread]: Using snowflake connection "macro_grant_select"
[0m21:47:40.596351 [debug] [MainThread]: On macro_grant_select: grant select on future views in schema ANALYTICS to role ACCOUNTADMIN
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "macro_grant_select"} */;
[0m21:47:40.694637 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.097 seconds
[0m21:47:40.699335 [info ] [MainThread]: Privileges granted successfully
[0m21:47:40.715930 [debug] [MainThread]: Wrote artifact RunResultsArtifact to /opt/airflow/dbt/target/run_results.json
[0m21:47:40.717220 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ConfigSourcePathDeprecation: 1 occurrence
- ConfigDataPathDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m21:47:40.720945 [debug] [MainThread]: Resource report: {"command_name": "run-operation", "command_success": true, "command_wall_clock_time": 4.8124647, "process_in_blocks": "0", "process_kernel_time": 0.503951, "process_mem_max_rss": "226356", "process_out_blocks": "1651", "process_user_time": 3.197099}
[0m21:47:40.722269 [debug] [MainThread]: Command `dbt run-operation` succeeded at 21:47:40.721879 after 4.81 seconds
[0m21:47:40.723720 [debug] [MainThread]: Connection 'macro_grant_select' was left open.
[0m21:47:40.724537 [debug] [MainThread]: On macro_grant_select: Close
[0m21:47:41.502018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f6dc560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff63af4e60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff63ca99a0>]}
[0m21:47:41.503402 [debug] [MainThread]: Flushing usage events
[0m21:47:42.814910 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:36:02.023068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d1aac90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa004bdd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d3acc50>]}


============================== 08:36:02.031323 | 838f4bd3-0229-4689-b231-df420a0e34fe ==============================
[0m08:36:02.031323 [info ] [MainThread]: Running with dbt=1.11.0-b3
[0m08:36:02.031946 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'introspect': 'True', 'partial_parse': 'True', 'warn_error': 'None', 'log_path': '/app/dbt/logs', 'printer_width': '80', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'quiet': 'False', 'log_cache_events': 'False', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'version_check': 'True', 'use_colors': 'True', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'fail_fast': 'False', 'log_format': 'default', 'debug': 'False', 'empty': 'None', 'profiles_dir': '/app'}
[0m08:36:02.266102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '838f4bd3-0229-4689-b231-df420a0e34fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9cf65b50>]}
[0m08:36:02.282680 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-ethsb7qy'
[0m08:36:02.283079 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m08:36:02.449577 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m08:36:02.451890 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json
[0m08:36:02.554455 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json 200
[0m08:36:02.560943 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m08:36:02.631524 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m08:36:02.649337 [info ] [MainThread]: Updating lock file in file path: /app/dbt/package-lock.yml
[0m08:36:02.766833 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-i2bq7zae'
[0m08:36:02.771071 [info ] [MainThread]: Installing dbt-labs/codegen
[0m08:36:03.198403 [info ] [MainThread]: Installed from version 0.13.1
[0m08:36:03.199195 [info ] [MainThread]: Up to date!
[0m08:36:03.200143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '838f4bd3-0229-4689-b231-df420a0e34fe', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d0a2450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e06ca50>]}
[0m08:36:03.200647 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m08:36:03.640129 [info ] [MainThread]: Installed from version 1.3.1
[0m08:36:03.640537 [info ] [MainThread]: Up to date!
[0m08:36:03.641194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '838f4bd3-0229-4689-b231-df420a0e34fe', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9cff8110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9fb298d0>]}
[0m08:36:03.642870 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 1.6487163, "process_in_blocks": "0", "process_kernel_time": 0.763828, "process_mem_max_rss": "107192", "process_out_blocks": "3119", "process_user_time": 1.438127}
[0m08:36:03.643254 [debug] [MainThread]: Command `dbt deps` succeeded at 08:36:03.643191 after 1.65 seconds
[0m08:36:03.643567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2409610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9cfbe090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9faa8310>]}
[0m08:36:03.643852 [debug] [MainThread]: Flushing usage events
[0m08:36:04.243477 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:36:05.179212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7ba8990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7d54ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7ba9e50>]}


============================== 08:36:05.180908 | b0c21c9b-ee66-4d7a-aad2-e8599be4a4ab ==============================
[0m08:36:05.180908 [info ] [MainThread]: Running with dbt=1.11.0-b3
[0m08:36:05.181371 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'empty': 'None', 'no_print': 'None', 'use_colors': 'True', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': '/app/dbt/logs', 'target_path': 'None', 'quiet': 'False', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'fail_fast': 'False', 'indirect_selection': 'eager', 'version_check': 'True', 'use_experimental_parser': 'False', 'profiles_dir': '/app', 'partial_parse': 'True', 'warn_error': 'None', 'static_parser': 'True', 'printer_width': '80', 'log_cache_events': 'False', 'invocation_command': 'dbt seed', 'log_format': 'default'}
[0m08:36:05.182833 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'jaffle_shop'
[0m08:36:05.183505 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": false, "command_wall_clock_time": 0.030068917, "process_in_blocks": "0", "process_kernel_time": 0.097078, "process_mem_max_rss": "101008", "process_out_blocks": "2", "process_user_time": 0.654532}
[0m08:36:05.183789 [debug] [MainThread]: Command `dbt seed` failed at 08:36:05.183741 after 0.03 seconds
[0m08:36:05.184010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7bb2490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7ba9d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7babc90>]}
[0m08:36:05.184255 [debug] [MainThread]: Flushing usage events
[0m08:36:05.685374 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:26:03.327725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa987a390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac22dd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9878b00>]}


============================== 12:26:03.347370 | 822b205f-e467-48e0-951f-3f04aab4b100 ==============================
[0m12:26:03.347370 [info ] [MainThread]: Running with dbt=1.10.13
[0m12:26:03.347790 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'warn_error': 'None', 'no_print': 'None', 'write_json': 'True', 'log_format': 'default', 'indirect_selection': 'eager', 'log_path': '/app/dbt/logs', 'target_path': 'None', 'fail_fast': 'False', 'invocation_command': 'dbt run', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'empty': 'False', 'use_colors': 'True', 'version_check': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'printer_width': '80', 'introspect': 'True', 'partial_parse': 'True', 'profiles_dir': '/app', 'send_anonymous_usage_stats': 'True'}
[0m12:26:03.349612 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'dev'
[0m12:26:03.351686 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.05892933, "process_in_blocks": "0", "process_kernel_time": 0.294241, "process_mem_max_rss": "99944", "process_out_blocks": "58", "process_user_time": 0.796653}
[0m12:26:03.352015 [debug] [MainThread]: Command `dbt run` failed at 12:26:03.351962 after 0.06 seconds
[0m12:26:03.352225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa4e4f20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9ad4fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa98788c0>]}
[0m12:26:03.352479 [debug] [MainThread]: Flushing usage events
[0m12:26:03.892014 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:28:03.501011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7326ba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb90e0a40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6c08bf0>]}


============================== 12:28:03.504082 | 9d545e39-b4e1-4982-90fa-b2a8b0f58f1e ==============================
[0m12:28:03.504082 [info ] [MainThread]: Running with dbt=1.10.13
[0m12:28:03.504446 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run', 'write_json': 'True', 'use_colors': 'True', 'debug': 'False', 'log_path': '/app/dbt/logs', 'printer_width': '80', 'no_print': 'None', 'empty': 'False', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'static_parser': 'True', 'partial_parse': 'True', 'version_check': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'log_format': 'default', 'quiet': 'False', 'profiles_dir': '/app'}
[0m12:28:03.505948 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'dev'
[0m12:28:03.507378 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.033648416, "process_in_blocks": "0", "process_kernel_time": 0.20123, "process_mem_max_rss": "99060", "process_out_blocks": "2", "process_user_time": 0.690791}
[0m12:28:03.507636 [debug] [MainThread]: Command `dbt run` failed at 12:28:03.507589 after 0.03 seconds
[0m12:28:03.507806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb81a1730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb625fdd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb625fe00>]}
[0m12:28:03.507982 [debug] [MainThread]: Flushing usage events
[0m12:28:04.083454 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:29:43.366181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2ed8fe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb27ca9f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb276c6e0>]}


============================== 12:29:43.369645 | 33b591ec-f1e3-44b7-967a-e27276d1279c ==============================
[0m12:29:43.369645 [info ] [MainThread]: Running with dbt=1.10.13
[0m12:29:43.369979 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'quiet': 'False', 'write_json': 'True', 'empty': 'False', 'invocation_command': 'dbt run', 'log_cache_events': 'False', 'profiles_dir': '/app', 'warn_error': 'None', 'target_path': 'None', 'debug': 'False', 'log_path': '/app/dbt/logs', 'fail_fast': 'False', 'cache_selected_only': 'False', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'printer_width': '80', 'version_check': 'True'}
[0m12:29:43.371478 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'dev'
[0m12:29:43.372168 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.033799917, "process_in_blocks": "0", "process_kernel_time": 0.189981, "process_mem_max_rss": "99060", "process_out_blocks": "2", "process_user_time": 0.697603}
[0m12:29:43.372531 [debug] [MainThread]: Command `dbt run` failed at 12:29:43.372475 after 0.03 seconds
[0m12:29:43.372720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6dfa9f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb27a7950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2057e30>]}
[0m12:29:43.372906 [debug] [MainThread]: Flushing usage events
[0m12:29:43.940294 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:31:00.949678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa46baf90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3bf64b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3566c90>]}


============================== 12:31:00.952609 | 2371b117-77fa-4320-8f8d-e537fa5b910f ==============================
[0m12:31:00.952609 [info ] [MainThread]: Running with dbt=1.10.13
[0m12:31:00.952977 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run --profiles-dir .', 'debug': 'False', 'printer_width': '80', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'cache_selected_only': 'False', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'static_parser': 'True', 'indirect_selection': 'eager', 'warn_error': 'None', 'write_json': 'True', 'empty': 'False', 'log_cache_events': 'False', 'profiles_dir': '.', 'log_path': '/app/dbt/logs', 'partial_parse': 'True', 'introspect': 'True', 'no_print': 'None'}
[0m12:31:00.954559 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'dev'
[0m12:31:00.955277 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.034877125, "process_in_blocks": "0", "process_kernel_time": 0.192613, "process_mem_max_rss": "99304", "process_out_blocks": "2", "process_user_time": 0.698224}
[0m12:31:00.955565 [debug] [MainThread]: Command `dbt run` failed at 12:31:00.955506 after 0.04 seconds
[0m12:31:00.955749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa60b5d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa35fff80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3a1d880>]}
[0m12:31:00.955926 [debug] [MainThread]: Flushing usage events
[0m12:31:01.461364 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:32:45.779748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbb09d070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbb229af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8d74860>]}


============================== 12:32:45.782704 | d53e68e9-a6a5-46e3-9a9d-74b3b5d82853 ==============================
[0m12:32:45.782704 [info ] [MainThread]: Running with dbt=1.10.13
[0m12:32:45.783123 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'use_colors': 'True', 'empty': 'False', 'fail_fast': 'False', 'cache_selected_only': 'False', 'printer_width': '80', 'log_path': '/app/dbt/logs', 'no_print': 'None', 'quiet': 'False', 'indirect_selection': 'eager', 'target_path': 'None', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir .', 'debug': 'False', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'log_format': 'default', 'version_check': 'True', 'log_cache_events': 'False', 'profiles_dir': '.', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m12:32:46.546744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd53e68e9-a6a5-46e3-9a9d-74b3b5d82853', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb721a510>]}
[0m12:32:46.577654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd53e68e9-a6a5-46e3-9a9d-74b3b5d82853', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7596060>]}
[0m12:32:46.578257 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m12:32:46.644450 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m12:32:46.840948 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m12:32:46.841368 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m12:32:46.841827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd53e68e9-a6a5-46e3-9a9d-74b3b5d82853', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8daf530>]}
[0m12:32:47.713531 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.citrus_trade.stg_trade' (models/staging/stg_trade.sql) depends on a source named 'citrus_trade.citrus_ext' which was not found
[0m12:32:47.715023 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.9641724, "process_in_blocks": "0", "process_kernel_time": 0.978161, "process_mem_max_rss": "135884", "process_out_blocks": "93", "process_user_time": 1.781759}
[0m12:32:47.715336 [debug] [MainThread]: Command `dbt run` failed at 12:32:47.715269 after 1.97 seconds
[0m12:32:47.715586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8dd2b70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb68f44a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6bf7d10>]}
[0m12:32:47.715815 [debug] [MainThread]: Flushing usage events
[0m12:32:48.262238 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:35:03.278797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3d02c00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3c49cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4c739b0>]}


============================== 12:35:03.282371 | 619c92b4-73f2-44ba-8e6c-efc03f27bdfa ==============================
[0m12:35:03.282371 [info ] [MainThread]: Running with dbt=1.10.13
[0m12:35:03.282815 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'cache_selected_only': 'False', 'log_cache_events': 'False', 'log_path': '/app/dbt/logs', 'static_parser': 'True', 'indirect_selection': 'eager', 'empty': 'False', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'no_print': 'None', 'use_colors': 'True', 'quiet': 'False', 'version_check': 'True', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/app', 'target_path': 'None', 'write_json': 'True', 'introspect': 'True', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'printer_width': '80'}
[0m12:35:03.284392 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'citrus_trade'
[0m12:35:03.285127 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.035512958, "process_in_blocks": "0", "process_kernel_time": 0.996883, "process_mem_max_rss": "99056", "process_out_blocks": "2", "process_user_time": 0.763677}
[0m12:35:03.285427 [debug] [MainThread]: Command `dbt run` failed at 12:35:03.285369 after 0.04 seconds
[0m12:35:03.285632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7cb29f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7b56d80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2e0a030>]}
[0m12:35:03.285817 [debug] [MainThread]: Flushing usage events
[0m12:35:03.796460 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:35:52.854066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb34e5070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb265e990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2e43e60>]}


============================== 12:35:52.857856 | 9b4c95ea-6024-49a7-badf-04c727cb0662 ==============================
[0m12:35:52.857856 [info ] [MainThread]: Running with dbt=1.10.13
[0m12:35:52.858222 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'invocation_command': 'dbt run --profiles-dir .', 'version_check': 'True', 'quiet': 'False', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'use_colors': 'True', 'fail_fast': 'False', 'target_path': 'None', 'indirect_selection': 'eager', 'printer_width': '80', 'debug': 'False', 'write_json': 'True', 'empty': 'False', 'log_path': '/app/dbt/logs', 'warn_error': 'None', 'static_parser': 'True', 'profiles_dir': '.', 'no_print': 'None', 'cache_selected_only': 'False', 'log_format': 'default', 'introspect': 'True', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m12:35:53.088190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9b4c95ea-6024-49a7-badf-04c727cb0662', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0e89700>]}
[0m12:35:53.120054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9b4c95ea-6024-49a7-badf-04c727cb0662', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb12ce720>]}
[0m12:35:53.120657 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m12:35:53.169509 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m12:35:53.274135 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m12:35:53.274519 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m12:35:53.274875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '9b4c95ea-6024-49a7-badf-04c727cb0662', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2d9f3b0>]}
[0m12:35:54.003508 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.citrus_trade.analytics
[0m12:35:54.008656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9b4c95ea-6024-49a7-badf-04c727cb0662', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0bcea50>]}
[0m12:35:54.053903 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m12:35:54.058655 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m12:35:54.143012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9b4c95ea-6024-49a7-badf-04c727cb0662', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0202270>]}
[0m12:35:54.143356 [info ] [MainThread]: Found 1 model, 1 seed, 1 source, 633 macros
[0m12:35:54.143580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9b4c95ea-6024-49a7-badf-04c727cb0662', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4366990>]}
[0m12:35:54.144497 [info ] [MainThread]: 
[0m12:35:54.144720 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:35:54.144956 [info ] [MainThread]: 
[0m12:35:54.145374 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:35:54.146074 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRHS'
[0m12:35:54.289576 [debug] [ThreadPool]: Using snowflake connection "list_TRHS"
[0m12:35:54.289964 [debug] [ThreadPool]: On list_TRHS: show terse schemas in database TRHS
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS"} */
[0m12:35:54.290152 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:35:57.781804 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 3.491 seconds
[0m12:35:57.787911 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRHS_ANALYTICS'
[0m12:35:57.794824 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRHS, now list_TRHS_staging)
[0m12:35:57.814591 [debug] [ThreadPool]: Using snowflake connection "list_TRHS_ANALYTICS"
[0m12:35:57.815315 [debug] [ThreadPool]: On list_TRHS_ANALYTICS: show objects in TRHS.ANALYTICS
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS_ANALYTICS"} */;
[0m12:35:57.819259 [debug] [ThreadPool]: Using snowflake connection "list_TRHS_staging"
[0m12:35:57.819701 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:35:57.820293 [debug] [ThreadPool]: On list_TRHS_staging: show objects in TRHS.staging
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS_staging"} */;
[0m12:35:57.904062 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.081 seconds
[0m12:35:59.220544 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 1.401 seconds
[0m12:35:59.225390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9b4c95ea-6024-49a7-badf-04c727cb0662', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3438110>]}
[0m12:35:59.243999 [debug] [Thread-1 (]: Began running node model.citrus_trade.stg_trade
[0m12:35:59.244983 [info ] [Thread-1 (]: 1 of 1 START sql table model staging.stg_trade ................................. [RUN]
[0m12:35:59.245867 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_TRHS_ANALYTICS, now model.citrus_trade.stg_trade)
[0m12:35:59.246479 [debug] [Thread-1 (]: Began compiling node model.citrus_trade.stg_trade
[0m12:35:59.256763 [debug] [Thread-1 (]: Writing injected SQL for node "model.citrus_trade.stg_trade"
[0m12:35:59.262803 [debug] [Thread-1 (]: Began executing node model.citrus_trade.stg_trade
[0m12:35:59.289809 [debug] [Thread-1 (]: Writing runtime sql for node "model.citrus_trade.stg_trade"
[0m12:35:59.293934 [debug] [Thread-1 (]: Using snowflake connection "model.citrus_trade.stg_trade"
[0m12:35:59.294261 [debug] [Thread-1 (]: On model.citrus_trade.stg_trade: create or replace transient table TRHS.staging.stg_trade
    
    
    
    as (select
  value:"declarant"::int as declarant,
  value:"declarant_iso"::string as declarant_iso,
  value:"partner"::string as partner,
  value:"partner_iso"::string as partner_iso,
  value:"flow"::int as flow,
  value:"transport_mode"::int as transport_mode,
  value:"period"::int as period,
  value:"hs4"::string as hs4,
  value:"hs4_name"::string as hs4_name,
  value:"hs6"::string as hs6,
  value:"hs6_name"::string as hs6_name,
  value:"value_in_euros"::float as value_in_euros,
  value:"quantity_in_kg"::float as quantity_in_kg
from trhs.staging.citrus_ext
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.stg_trade"} */;
[0m12:35:59.380584 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01c013f3-0105-6933-0000-000420ca6275
[0m12:35:59.381043 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'TRHS.STAGING.CITRUS_EXT' does not exist or not authorized.
[0m12:35:59.385918 [debug] [Thread-1 (]: Database Error in model stg_trade (models/staging/stg_trade.sql)
  002003 (42S02): SQL compilation error:
  Object 'TRHS.STAGING.CITRUS_EXT' does not exist or not authorized.
  compiled code at target/run/citrus_trade/models/staging/stg_trade.sql
[0m12:35:59.388078 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b4c95ea-6024-49a7-badf-04c727cb0662', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb34e7260>]}
[0m12:35:59.388712 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model staging.stg_trade ........................ [[31mERROR[0m in 0.14s]
[0m12:35:59.389365 [debug] [Thread-1 (]: Finished running node model.citrus_trade.stg_trade
[0m12:35:59.389890 [debug] [Thread-7 (]: Marking all children of 'model.citrus_trade.stg_trade' to be skipped because of status 'error'.  Reason: Database Error in model stg_trade (models/staging/stg_trade.sql)
  002003 (42S02): SQL compilation error:
  Object 'TRHS.STAGING.CITRUS_EXT' does not exist or not authorized.
  compiled code at target/run/citrus_trade/models/staging/stg_trade.sql.
[0m12:35:59.391924 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:35:59.392239 [debug] [MainThread]: Connection 'list_TRHS_staging' was left open.
[0m12:35:59.392512 [debug] [MainThread]: On list_TRHS_staging: Close
[0m12:35:59.475429 [debug] [MainThread]: Connection 'model.citrus_trade.stg_trade' was left open.
[0m12:35:59.476097 [debug] [MainThread]: On model.citrus_trade.stg_trade: Close
[0m12:35:59.892732 [info ] [MainThread]: 
[0m12:35:59.893944 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.75 seconds (5.75s).
[0m12:35:59.895851 [debug] [MainThread]: Command end result
[0m12:35:59.946292 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m12:35:59.948597 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m12:35:59.954100 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt/target/run_results.json
[0m12:35:59.954373 [info ] [MainThread]: 
[0m12:35:59.954690 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:35:59.955076 [info ] [MainThread]: 
[0m12:35:59.955407 [error] [MainThread]: [31mFailure in model stg_trade (models/staging/stg_trade.sql)[0m
[0m12:35:59.955670 [error] [MainThread]:   Database Error in model stg_trade (models/staging/stg_trade.sql)
  002003 (42S02): SQL compilation error:
  Object 'TRHS.STAGING.CITRUS_EXT' does not exist or not authorized.
  compiled code at target/run/citrus_trade/models/staging/stg_trade.sql
[0m12:35:59.955876 [info ] [MainThread]: 
[0m12:35:59.956082 [info ] [MainThread]:   compiled code at target/compiled/citrus_trade/models/staging/stg_trade.sql
[0m12:35:59.956247 [info ] [MainThread]: 
[0m12:35:59.956531 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m12:35:59.957558 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 7.1364713, "process_in_blocks": "0", "process_kernel_time": 1.117296, "process_mem_max_rss": "161900", "process_out_blocks": "6654", "process_user_time": 2.359625}
[0m12:35:59.958003 [debug] [MainThread]: Command `dbt run` failed at 12:35:59.957881 after 7.14 seconds
[0m12:35:59.958430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb521db80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb07be570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2b17950>]}
[0m12:35:59.958688 [debug] [MainThread]: Flushing usage events
[0m12:36:00.450751 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:36:25.803545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e3a5b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e3a5ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e2733b0>]}


============================== 12:36:25.807322 | 81a05ce3-9d3b-4d14-8350-7c7068df1531 ==============================
[0m12:36:25.807322 [info ] [MainThread]: Running with dbt=1.10.13
[0m12:36:25.807674 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'fail_fast': 'False', 'version_check': 'True', 'static_parser': 'True', 'use_colors': 'True', 'invocation_command': 'dbt run-operation grant_select', 'no_print': 'None', 'log_format': 'default', 'use_experimental_parser': 'False', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'quiet': 'False', 'indirect_selection': 'eager', 'introspect': 'True', 'target_path': 'None', 'cache_selected_only': 'False', 'partial_parse': 'True', 'printer_width': '80', 'log_cache_events': 'False', 'write_json': 'True', 'empty': 'None', 'log_path': '/app/dbt/logs', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '/app'}
[0m12:36:25.809203 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'citrus_trade'
[0m12:36:25.809919 [debug] [MainThread]: Resource report: {"command_name": "run-operation", "command_success": false, "command_wall_clock_time": 0.034825332, "process_in_blocks": "0", "process_kernel_time": 0.228927, "process_mem_max_rss": "99044", "process_out_blocks": "2", "process_user_time": 0.723771}
[0m12:36:25.810190 [debug] [MainThread]: Command `dbt run-operation` failed at 12:36:25.810135 after 0.04 seconds
[0m12:36:25.810378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7dda76b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e3591c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e358320>]}
[0m12:36:25.810566 [debug] [MainThread]: Flushing usage events
[0m12:36:26.286212 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:38:16.774024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5bc2fc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5394ce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4faffb0>]}


============================== 12:38:16.777905 | bebe9bc5-c0fd-4a8d-9df0-78cdde89f70b ==============================
[0m12:38:16.777905 [info ] [MainThread]: Running with dbt=1.10.13
[0m12:38:16.778363 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'profiles_dir': '.', 'cache_selected_only': 'False', 'printer_width': '80', 'invocation_command': 'dbt debug --profiles-dir .', 'quiet': 'False', 'debug': 'False', 'write_json': 'True', 'empty': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'no_print': 'None', 'version_check': 'True', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_experimental_parser': 'False', 'target_path': 'None', 'warn_error': 'None', 'partial_parse': 'True', 'log_path': '/app/dbt/logs', 'static_parser': 'True', 'indirect_selection': 'eager'}
[0m12:38:16.786256 [info ] [MainThread]: dbt version: 1.10.13
[0m12:38:16.786578 [info ] [MainThread]: python version: 3.12.12
[0m12:38:16.786807 [info ] [MainThread]: python path: /usr/local/bin/python3.12
[0m12:38:16.787009 [info ] [MainThread]: os info: Linux-6.10.14-linuxkit-aarch64-with-glibc2.41
[0m12:38:16.942846 [info ] [MainThread]: Using profiles dir at .
[0m12:38:16.943257 [info ] [MainThread]: Using profiles.yml file at ./profiles.yml
[0m12:38:16.943626 [info ] [MainThread]: Using dbt_project.yml file at /app/dbt/dbt_project.yml
[0m12:38:16.944064 [info ] [MainThread]: adapter type: snowflake
[0m12:38:16.944277 [info ] [MainThread]: adapter version: 1.10.2
[0m12:38:16.998639 [info ] [MainThread]: Configuration:
[0m12:38:16.999042 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m12:38:16.999364 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m12:38:16.999678 [info ] [MainThread]: Required dependencies:
[0m12:38:16.999996 [debug] [MainThread]: Executing "git --help"
[0m12:38:17.048145 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m12:38:17.048548 [debug] [MainThread]: STDERR: "b''"
[0m12:38:17.048700 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m12:38:17.048951 [info ] [MainThread]: Connection:
[0m12:38:17.049332 [info ] [MainThread]:   account: gylobbh-fi81452
[0m12:38:17.049548 [info ] [MainThread]:   user: DBT_USER
[0m12:38:17.049768 [info ] [MainThread]:   database: TRHS
[0m12:38:17.049953 [info ] [MainThread]:   warehouse: COMPUTE_WH
[0m12:38:17.050120 [info ] [MainThread]:   role: SYSADMIN
[0m12:38:17.050328 [info ] [MainThread]:   schema: ANALYTICS
[0m12:38:17.050566 [info ] [MainThread]:   authenticator: None
[0m12:38:17.050818 [info ] [MainThread]:   oauth_client_id: None
[0m12:38:17.051064 [info ] [MainThread]:   query_tag: None
[0m12:38:17.051290 [info ] [MainThread]:   client_session_keep_alive: False
[0m12:38:17.051512 [info ] [MainThread]:   host: None
[0m12:38:17.051729 [info ] [MainThread]:   port: None
[0m12:38:17.051924 [info ] [MainThread]:   proxy_host: None
[0m12:38:17.052104 [info ] [MainThread]:   proxy_port: None
[0m12:38:17.052401 [info ] [MainThread]:   protocol: None
[0m12:38:17.052582 [info ] [MainThread]:   connect_retries: 1
[0m12:38:17.052749 [info ] [MainThread]:   connect_timeout: None
[0m12:38:17.052928 [info ] [MainThread]:   retry_on_database_errors: False
[0m12:38:17.053120 [info ] [MainThread]:   retry_all: False
[0m12:38:17.053301 [info ] [MainThread]:   insecure_mode: False
[0m12:38:17.053475 [info ] [MainThread]:   reuse_connections: True
[0m12:38:17.053622 [info ] [MainThread]:   s3_stage_vpce_dns_name: None
[0m12:38:17.054016 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m12:38:17.091139 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m12:38:17.107392 [debug] [MainThread]: Using snowflake connection "debug"
[0m12:38:17.107689 [debug] [MainThread]: On debug: select 1 as id
[0m12:38:17.107841 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:38:19.998835 [debug] [MainThread]: SQL status: SUCCESS 1 in 2.892 seconds
[0m12:38:20.002148 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m12:38:20.003121 [info ] [MainThread]: [32mAll checks passed![0m
[0m12:38:20.005043 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 3.2641377, "process_in_blocks": "0", "process_kernel_time": 0.33646, "process_mem_max_rss": "144008", "process_out_blocks": "29", "process_user_time": 1.110821}
[0m12:38:20.005913 [debug] [MainThread]: Command `dbt debug` succeeded at 12:38:20.005733 after 3.27 seconds
[0m12:38:20.006499 [debug] [MainThread]: Connection 'debug' was left open.
[0m12:38:20.007118 [debug] [MainThread]: On debug: Close
[0m12:38:20.124218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa98b2a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3430890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa51203b0>]}
[0m12:38:20.125343 [debug] [MainThread]: Flushing usage events
[0m12:38:20.636349 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:40:05.512420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9eebed50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ecacc20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e7d7e30>]}


============================== 12:40:05.515900 | c7e68a62-1c2d-4ba9-a0e3-a7773af7d80f ==============================
[0m12:40:05.515900 [info ] [MainThread]: Running with dbt=1.10.13
[0m12:40:05.516278 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'partial_parse': 'True', 'empty': 'False', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_format': 'default', 'cache_selected_only': 'False', 'write_json': 'True', 'profiles_dir': '.', 'warn_error': 'None', 'use_colors': 'True', 'no_print': 'None', 'fail_fast': 'False', 'introspect': 'True', 'target_path': 'None', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'quiet': 'False', 'debug': 'False', 'log_cache_events': 'False', 'log_path': '/app/dbt/logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run --profiles-dir .'}
[0m12:40:05.747016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c7e68a62-1c2d-4ba9-a0e3-a7773af7d80f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c833800>]}
[0m12:40:05.777583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c7e68a62-1c2d-4ba9-a0e3-a7773af7d80f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ca9cb60>]}
[0m12:40:05.778033 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m12:40:05.827391 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m12:40:05.955115 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:40:05.955409 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:40:05.958426 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.citrus_trade.analytics
[0m12:40:05.976705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c7e68a62-1c2d-4ba9-a0e3-a7773af7d80f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c553380>]}
[0m12:40:06.025544 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m12:40:06.026995 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m12:40:06.035275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c7e68a62-1c2d-4ba9-a0e3-a7773af7d80f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c2c4a10>]}
[0m12:40:06.035531 [info ] [MainThread]: Found 1 model, 1 seed, 1 source, 633 macros
[0m12:40:06.035753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c7e68a62-1c2d-4ba9-a0e3-a7773af7d80f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9cc2eea0>]}
[0m12:40:06.036700 [info ] [MainThread]: 
[0m12:40:06.036984 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:40:06.037326 [info ] [MainThread]: 
[0m12:40:06.037999 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:40:06.038709 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRHS'
[0m12:40:06.063549 [debug] [ThreadPool]: Using snowflake connection "list_TRHS"
[0m12:40:06.063865 [debug] [ThreadPool]: On list_TRHS: show terse schemas in database TRHS
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS"} */
[0m12:40:06.064027 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:40:07.838193 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.774 seconds
[0m12:40:07.844854 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRHS, now list_TRHS_ANALYTICS)
[0m12:40:07.846099 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRHS_staging'
[0m12:40:07.864811 [debug] [ThreadPool]: Using snowflake connection "list_TRHS_ANALYTICS"
[0m12:40:07.868842 [debug] [ThreadPool]: Using snowflake connection "list_TRHS_staging"
[0m12:40:07.869406 [debug] [ThreadPool]: On list_TRHS_ANALYTICS: show objects in TRHS.ANALYTICS
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS_ANALYTICS"} */;
[0m12:40:07.869841 [debug] [ThreadPool]: On list_TRHS_staging: show objects in TRHS.staging
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS_staging"} */;
[0m12:40:07.872163 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:40:07.939802 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.069 seconds
[0m12:40:08.275344 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.403 seconds
[0m12:40:08.279447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c7e68a62-1c2d-4ba9-a0e3-a7773af7d80f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c2b8a40>]}
[0m12:40:08.285937 [debug] [Thread-1 (]: Began running node model.citrus_trade.stg_trade
[0m12:40:08.286715 [info ] [Thread-1 (]: 1 of 1 START sql table model staging.stg_trade ................................. [RUN]
[0m12:40:08.287784 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_TRHS_staging, now model.citrus_trade.stg_trade)
[0m12:40:08.288717 [debug] [Thread-1 (]: Began compiling node model.citrus_trade.stg_trade
[0m12:40:08.300378 [debug] [Thread-1 (]: Writing injected SQL for node "model.citrus_trade.stg_trade"
[0m12:40:08.302497 [debug] [Thread-1 (]: Began executing node model.citrus_trade.stg_trade
[0m12:40:08.331899 [debug] [Thread-1 (]: Writing runtime sql for node "model.citrus_trade.stg_trade"
[0m12:40:08.333809 [debug] [Thread-1 (]: Using snowflake connection "model.citrus_trade.stg_trade"
[0m12:40:08.334193 [debug] [Thread-1 (]: On model.citrus_trade.stg_trade: create or replace transient table TRHS.staging.stg_trade
    
    
    
    as (select
  value:"declarant"::int as declarant,
  value:"declarant_iso"::string as declarant_iso,
  value:"partner"::string as partner,
  value:"partner_iso"::string as partner_iso,
  value:"flow"::int as flow,
  value:"transport_mode"::int as transport_mode,
  value:"period"::int as period,
  value:"hs4"::string as hs4,
  value:"hs4_name"::string as hs4_name,
  value:"hs6"::string as hs6,
  value:"hs6_name"::string as hs6_name,
  value:"value_in_euros"::float as value_in_euros,
  value:"quantity_in_kg"::float as quantity_in_kg
from trhs.staging.citrus_ext
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.stg_trade"} */;
[0m12:40:08.433575 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01c013f8-0105-6933-0000-000420ca6289
[0m12:40:08.434296 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'TRHS.STAGING.CITRUS_EXT' does not exist or not authorized.
[0m12:40:08.438499 [debug] [Thread-1 (]: Database Error in model stg_trade (models/staging/stg_trade.sql)
  002003 (42S02): SQL compilation error:
  Object 'TRHS.STAGING.CITRUS_EXT' does not exist or not authorized.
  compiled code at target/run/citrus_trade/models/staging/stg_trade.sql
[0m12:40:08.440438 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c7e68a62-1c2d-4ba9-a0e3-a7773af7d80f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ecce600>]}
[0m12:40:08.441278 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model staging.stg_trade ........................ [[31mERROR[0m in 0.15s]
[0m12:40:08.442139 [debug] [Thread-1 (]: Finished running node model.citrus_trade.stg_trade
[0m12:40:08.442909 [debug] [Thread-7 (]: Marking all children of 'model.citrus_trade.stg_trade' to be skipped because of status 'error'.  Reason: Database Error in model stg_trade (models/staging/stg_trade.sql)
  002003 (42S02): SQL compilation error:
  Object 'TRHS.STAGING.CITRUS_EXT' does not exist or not authorized.
  compiled code at target/run/citrus_trade/models/staging/stg_trade.sql.
[0m12:40:08.446434 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:40:08.446945 [debug] [MainThread]: Connection 'list_TRHS_ANALYTICS' was left open.
[0m12:40:08.447277 [debug] [MainThread]: On list_TRHS_ANALYTICS: Close
[0m12:40:08.547861 [debug] [MainThread]: Connection 'model.citrus_trade.stg_trade' was left open.
[0m12:40:08.548667 [debug] [MainThread]: On model.citrus_trade.stg_trade: Close
[0m12:40:08.641348 [info ] [MainThread]: 
[0m12:40:08.642886 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.60 seconds (2.60s).
[0m12:40:08.644896 [debug] [MainThread]: Command end result
[0m12:40:08.690865 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m12:40:08.693051 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m12:40:08.697775 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt/target/run_results.json
[0m12:40:08.697987 [info ] [MainThread]: 
[0m12:40:08.698278 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:40:08.698605 [info ] [MainThread]: 
[0m12:40:08.698992 [error] [MainThread]: [31mFailure in model stg_trade (models/staging/stg_trade.sql)[0m
[0m12:40:08.699429 [error] [MainThread]:   Database Error in model stg_trade (models/staging/stg_trade.sql)
  002003 (42S02): SQL compilation error:
  Object 'TRHS.STAGING.CITRUS_EXT' does not exist or not authorized.
  compiled code at target/run/citrus_trade/models/staging/stg_trade.sql
[0m12:40:08.699676 [info ] [MainThread]: 
[0m12:40:08.700027 [info ] [MainThread]:   compiled code at target/compiled/citrus_trade/models/staging/stg_trade.sql
[0m12:40:08.700301 [info ] [MainThread]: 
[0m12:40:08.700577 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m12:40:08.701471 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.2199464, "process_in_blocks": "0", "process_kernel_time": 0.425522, "process_mem_max_rss": "154428", "process_out_blocks": "2694", "process_user_time": 1.457212}
[0m12:40:08.701932 [debug] [MainThread]: Command `dbt run` failed at 12:40:08.701807 after 3.22 seconds
[0m12:40:08.702434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9eae3860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ecf1490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c3a7fb0>]}
[0m12:40:08.702722 [debug] [MainThread]: Flushing usage events
[0m12:40:09.209425 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:41:00.531657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84eab170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff873a96a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84e73410>]}


============================== 12:41:00.535467 | 452c281a-6c8e-45c7-be6d-635463c9df68 ==============================
[0m12:41:00.535467 [info ] [MainThread]: Running with dbt=1.10.13
[0m12:41:00.535851 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run-operation grant_select', 'log_format': 'default', 'log_cache_events': 'False', 'fail_fast': 'False', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'cache_selected_only': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'target_path': 'None', 'no_print': 'None', 'quiet': 'False', 'printer_width': '80', 'empty': 'None', 'profiles_dir': '/app', 'introspect': 'True', 'indirect_selection': 'eager', 'static_parser': 'True', 'log_path': '/app/dbt/logs', 'write_json': 'True', 'version_check': 'True', 'partial_parse': 'True', 'debug': 'False'}
[0m12:41:00.537485 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'citrus_trade'
[0m12:41:00.538223 [debug] [MainThread]: Resource report: {"command_name": "run-operation", "command_success": false, "command_wall_clock_time": 0.038548917, "process_in_blocks": "0", "process_kernel_time": 0.184029, "process_mem_max_rss": "99156", "process_out_blocks": "2", "process_user_time": 0.725116}
[0m12:41:00.538507 [debug] [MainThread]: Command `dbt run-operation` failed at 12:41:00.538452 after 0.04 seconds
[0m12:41:00.538727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84e707a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff847d4aa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8479e660>]}
[0m12:41:00.538964 [debug] [MainThread]: Flushing usage events
[0m12:41:01.044285 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:53:00.402410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff934bf0e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92d5fd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92c44d40>]}


============================== 12:53:00.405938 | d597e73b-3c95-4f98-813a-184c9c19c403 ==============================
[0m12:53:00.405938 [info ] [MainThread]: Running with dbt=1.10.13
[0m12:53:00.406364 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'fail_fast': 'False', 'cache_selected_only': 'False', 'empty': 'False', 'log_cache_events': 'False', 'no_print': 'None', 'log_format': 'default', 'warn_error': 'None', 'profiles_dir': '.', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True', 'target_path': 'None', 'introspect': 'True', 'partial_parse': 'True', 'printer_width': '80', 'invocation_command': 'dbt run --profiles-dir .', 'static_parser': 'True', 'quiet': 'False', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'log_path': '/app/dbt/logs', 'use_experimental_parser': 'False', 'debug': 'False'}
[0m12:53:00.723983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd597e73b-3c95-4f98-813a-184c9c19c403', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90ddc2c0>]}
[0m12:53:00.754563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd597e73b-3c95-4f98-813a-184c9c19c403', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90c980b0>]}
[0m12:53:00.755023 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m12:53:00.805428 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m12:53:00.945550 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:53:00.945830 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:53:00.948700 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.citrus_trade.analytics
[0m12:53:00.967367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd597e73b-3c95-4f98-813a-184c9c19c403', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90a983b0>]}
[0m12:53:01.019554 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m12:53:01.021287 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m12:53:01.037262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd597e73b-3c95-4f98-813a-184c9c19c403', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff908c0f50>]}
[0m12:53:01.037804 [info ] [MainThread]: Found 1 model, 1 seed, 1 source, 633 macros
[0m12:53:01.038056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd597e73b-3c95-4f98-813a-184c9c19c403', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90a99cd0>]}
[0m12:53:01.039110 [info ] [MainThread]: 
[0m12:53:01.039350 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:53:01.039612 [info ] [MainThread]: 
[0m12:53:01.040078 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:53:01.040897 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRHS'
[0m12:53:01.082429 [debug] [ThreadPool]: Using snowflake connection "list_TRHS"
[0m12:53:01.082897 [debug] [ThreadPool]: On list_TRHS: show terse schemas in database TRHS
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS"} */
[0m12:53:01.083102 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:53:03.862740 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2.779 seconds
[0m12:53:03.868570 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRHS, now list_TRHS_staging)
[0m12:53:03.876291 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRHS_ANALYTICS'
[0m12:53:03.895588 [debug] [ThreadPool]: Using snowflake connection "list_TRHS_staging"
[0m12:53:03.900100 [debug] [ThreadPool]: Using snowflake connection "list_TRHS_ANALYTICS"
[0m12:53:03.900429 [debug] [ThreadPool]: On list_TRHS_staging: show objects in TRHS.staging
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS_staging"} */;
[0m12:53:03.900879 [debug] [ThreadPool]: On list_TRHS_ANALYTICS: show objects in TRHS.ANALYTICS
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS_ANALYTICS"} */;
[0m12:53:03.903191 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:53:03.979533 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.078 seconds
[0m12:53:06.287737 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 2.384 seconds
[0m12:53:06.290838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd597e73b-3c95-4f98-813a-184c9c19c403', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9240a9f0>]}
[0m12:53:06.297769 [debug] [Thread-1 (]: Began running node model.citrus_trade.stg_trade
[0m12:53:06.298484 [info ] [Thread-1 (]: 1 of 1 START sql table model staging.stg_trade ................................. [RUN]
[0m12:53:06.299181 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_TRHS_ANALYTICS, now model.citrus_trade.stg_trade)
[0m12:53:06.299807 [debug] [Thread-1 (]: Began compiling node model.citrus_trade.stg_trade
[0m12:53:06.308856 [debug] [Thread-1 (]: Writing injected SQL for node "model.citrus_trade.stg_trade"
[0m12:53:06.310559 [debug] [Thread-1 (]: Began executing node model.citrus_trade.stg_trade
[0m12:53:06.336922 [debug] [Thread-1 (]: Writing runtime sql for node "model.citrus_trade.stg_trade"
[0m12:53:06.338495 [debug] [Thread-1 (]: Using snowflake connection "model.citrus_trade.stg_trade"
[0m12:53:06.338798 [debug] [Thread-1 (]: On model.citrus_trade.stg_trade: create or replace transient table TRHS.staging.stg_trade
    
    
    
    as (select
  value:"declarant"::int as declarant,
  value:"declarant_iso"::string as declarant_iso,
  value:"partner"::string as partner,
  value:"partner_iso"::string as partner_iso,
  value:"flow"::int as flow,
  value:"transport_mode"::int as transport_mode,
  value:"period"::int as period,
  value:"hs4"::string as hs4,
  value:"hs4_name"::string as hs4_name,
  value:"hs6"::string as hs6,
  value:"hs6_name"::string as hs6_name,
  value:"value_in_euros"::float as value_in_euros,
  value:"quantity_in_kg"::float as quantity_in_kg
from trhs.staging.citrus_ext
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.stg_trade"} */;
[0m12:53:06.419393 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01c01405-0105-6933-0000-000420ca6319
[0m12:53:06.419987 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'TRHS.STAGING.CITRUS_EXT' does not exist or not authorized.
[0m12:53:06.423514 [debug] [Thread-1 (]: Database Error in model stg_trade (models/staging/stg_trade.sql)
  002003 (42S02): SQL compilation error:
  Object 'TRHS.STAGING.CITRUS_EXT' does not exist or not authorized.
  compiled code at target/run/citrus_trade/models/staging/stg_trade.sql
[0m12:53:06.425198 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd597e73b-3c95-4f98-813a-184c9c19c403', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d299e80>]}
[0m12:53:06.425852 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model staging.stg_trade ........................ [[31mERROR[0m in 0.12s]
[0m12:53:06.426385 [debug] [Thread-1 (]: Finished running node model.citrus_trade.stg_trade
[0m12:53:06.426940 [debug] [Thread-7 (]: Marking all children of 'model.citrus_trade.stg_trade' to be skipped because of status 'error'.  Reason: Database Error in model stg_trade (models/staging/stg_trade.sql)
  002003 (42S02): SQL compilation error:
  Object 'TRHS.STAGING.CITRUS_EXT' does not exist or not authorized.
  compiled code at target/run/citrus_trade/models/staging/stg_trade.sql.
[0m12:53:06.428880 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:53:06.429184 [debug] [MainThread]: Connection 'list_TRHS_staging' was left open.
[0m12:53:06.429483 [debug] [MainThread]: On list_TRHS_staging: Close
[0m12:53:06.600393 [debug] [MainThread]: Connection 'model.citrus_trade.stg_trade' was left open.
[0m12:53:06.602282 [debug] [MainThread]: On model.citrus_trade.stg_trade: Close
[0m12:53:06.696387 [info ] [MainThread]: 
[0m12:53:06.697783 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.66 seconds (5.66s).
[0m12:53:06.700187 [debug] [MainThread]: Command end result
[0m12:53:06.749732 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m12:53:06.752321 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m12:53:06.757087 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt/target/run_results.json
[0m12:53:06.757375 [info ] [MainThread]: 
[0m12:53:06.757718 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:53:06.757993 [info ] [MainThread]: 
[0m12:53:06.758311 [error] [MainThread]: [31mFailure in model stg_trade (models/staging/stg_trade.sql)[0m
[0m12:53:06.758658 [error] [MainThread]:   Database Error in model stg_trade (models/staging/stg_trade.sql)
  002003 (42S02): SQL compilation error:
  Object 'TRHS.STAGING.CITRUS_EXT' does not exist or not authorized.
  compiled code at target/run/citrus_trade/models/staging/stg_trade.sql
[0m12:53:06.758901 [info ] [MainThread]: 
[0m12:53:06.759283 [info ] [MainThread]:   compiled code at target/compiled/citrus_trade/models/staging/stg_trade.sql
[0m12:53:06.759578 [info ] [MainThread]: 
[0m12:53:06.759982 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m12:53:06.760890 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 6.39443, "process_in_blocks": "0", "process_kernel_time": 0.701975, "process_mem_max_rss": "154164", "process_out_blocks": "2694", "process_user_time": 1.516588}
[0m12:53:06.761280 [debug] [MainThread]: Command `dbt run` failed at 12:53:06.761204 after 6.39 seconds
[0m12:53:06.761641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92930170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92e4b410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff932e95e0>]}
[0m12:53:06.761921 [debug] [MainThread]: Flushing usage events
[0m12:53:07.257470 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:55:47.468809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b45a5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ad08ec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ad08e30>]}


============================== 12:55:47.472755 | 75f35ea8-d609-4698-8405-b5443c5add3a ==============================
[0m12:55:47.472755 [info ] [MainThread]: Running with dbt=1.10.13
[0m12:55:47.473190 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'log_format': 'default', 'write_json': 'True', 'target_path': 'None', 'profiles_dir': '.', 'cache_selected_only': 'False', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'static_parser': 'True', 'debug': 'False', 'warn_error': 'None', 'invocation_command': 'dbt run --profiles-dir .', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/app/dbt/logs', 'printer_width': '80', 'quiet': 'False', 'log_cache_events': 'False', 'use_colors': 'True', 'empty': 'False'}
[0m12:55:47.682065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '75f35ea8-d609-4698-8405-b5443c5add3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff896b1700>]}
[0m12:55:47.712466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '75f35ea8-d609-4698-8405-b5443c5add3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8928aff0>]}
[0m12:55:47.712931 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m12:55:47.760854 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m12:55:47.879252 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:55:47.879526 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:55:47.882392 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.citrus_trade.analytics
[0m12:55:47.901305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '75f35ea8-d609-4698-8405-b5443c5add3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88db9a60>]}
[0m12:55:47.949600 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m12:55:47.951135 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m12:55:47.959266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '75f35ea8-d609-4698-8405-b5443c5add3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff889bca40>]}
[0m12:55:47.959533 [info ] [MainThread]: Found 1 model, 1 seed, 1 source, 633 macros
[0m12:55:47.959740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '75f35ea8-d609-4698-8405-b5443c5add3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88deb6b0>]}
[0m12:55:47.960725 [info ] [MainThread]: 
[0m12:55:47.960956 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:55:47.961278 [info ] [MainThread]: 
[0m12:55:47.961691 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:55:47.962424 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRHS'
[0m12:55:47.986941 [debug] [ThreadPool]: Using snowflake connection "list_TRHS"
[0m12:55:47.987258 [debug] [ThreadPool]: On list_TRHS: show terse schemas in database TRHS
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS"} */
[0m12:55:47.987447 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:58:03.165247 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2.891 seconds
[0m12:58:03.170082 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRHS_staging'
[0m12:58:03.171006 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRHS, now list_TRHS_ANALYTICS)
[0m12:58:03.179020 [debug] [ThreadPool]: Using snowflake connection "list_TRHS_staging"
[0m12:58:03.181166 [debug] [ThreadPool]: Using snowflake connection "list_TRHS_ANALYTICS"
[0m12:58:03.181506 [debug] [ThreadPool]: On list_TRHS_staging: show objects in TRHS.staging
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS_staging"} */;
[0m12:58:03.182227 [debug] [ThreadPool]: On list_TRHS_ANALYTICS: show objects in TRHS.ANALYTICS
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS_ANALYTICS"} */;
[0m12:58:03.182865 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:58:03.259513 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.076 seconds
[0m12:58:05.533732 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 2.351 seconds
[0m12:58:05.541017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '75f35ea8-d609-4698-8405-b5443c5add3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88e4bef0>]}
[0m12:58:05.547989 [debug] [Thread-1 (]: Began running node model.citrus_trade.stg_trade
[0m12:58:05.549012 [info ] [Thread-1 (]: 1 of 1 START sql table model staging.stg_trade ................................. [RUN]
[0m12:58:05.549930 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_TRHS_staging, now model.citrus_trade.stg_trade)
[0m12:58:05.550491 [debug] [Thread-1 (]: Began compiling node model.citrus_trade.stg_trade
[0m12:58:05.561821 [debug] [Thread-1 (]: Writing injected SQL for node "model.citrus_trade.stg_trade"
[0m12:58:05.563526 [debug] [Thread-1 (]: Began executing node model.citrus_trade.stg_trade
[0m12:58:05.594948 [debug] [Thread-1 (]: Writing runtime sql for node "model.citrus_trade.stg_trade"
[0m12:58:05.596596 [debug] [Thread-1 (]: Using snowflake connection "model.citrus_trade.stg_trade"
[0m12:58:05.596973 [debug] [Thread-1 (]: On model.citrus_trade.stg_trade: create or replace transient table TRHS.staging.stg_trade
    
    
    
    as (select
  value:"declarant"::int as declarant,
  value:"declarant_iso"::string as declarant_iso,
  value:"partner"::string as partner,
  value:"partner_iso"::string as partner_iso,
  value:"flow"::int as flow,
  value:"transport_mode"::int as transport_mode,
  value:"period"::int as period,
  value:"hs4"::string as hs4,
  value:"hs4_name"::string as hs4_name,
  value:"hs6"::string as hs6,
  value:"hs6_name"::string as hs6_name,
  value:"value_in_euros"::float as value_in_euros,
  value:"quantity_in_kg"::float as quantity_in_kg
from trhs.staging.citrus_ext
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.stg_trade"} */;
[0m12:58:05.689010 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01c0140a-0105-6933-0000-000420ca6335
[0m12:58:05.689572 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'TRHS.STAGING.CITRUS_EXT' does not exist or not authorized.
[0m12:58:05.693417 [debug] [Thread-1 (]: Database Error in model stg_trade (models/staging/stg_trade.sql)
  002003 (42S02): SQL compilation error:
  Object 'TRHS.STAGING.CITRUS_EXT' does not exist or not authorized.
  compiled code at target/run/citrus_trade/models/staging/stg_trade.sql
[0m12:58:05.695198 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '75f35ea8-d609-4698-8405-b5443c5add3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b3f3a10>]}
[0m12:58:05.695965 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model staging.stg_trade ........................ [[31mERROR[0m in 0.14s]
[0m12:58:05.696668 [debug] [Thread-1 (]: Finished running node model.citrus_trade.stg_trade
[0m12:58:05.697415 [debug] [Thread-7 (]: Marking all children of 'model.citrus_trade.stg_trade' to be skipped because of status 'error'.  Reason: Database Error in model stg_trade (models/staging/stg_trade.sql)
  002003 (42S02): SQL compilation error:
  Object 'TRHS.STAGING.CITRUS_EXT' does not exist or not authorized.
  compiled code at target/run/citrus_trade/models/staging/stg_trade.sql.
[0m12:58:05.700635 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:58:05.700989 [debug] [MainThread]: Connection 'list_TRHS_ANALYTICS' was left open.
[0m12:58:05.701310 [debug] [MainThread]: On list_TRHS_ANALYTICS: Close
[0m12:58:05.799182 [debug] [MainThread]: Connection 'model.citrus_trade.stg_trade' was left open.
[0m12:58:05.800087 [debug] [MainThread]: On model.citrus_trade.stg_trade: Close
[0m12:58:05.904546 [info ] [MainThread]: 
[0m12:58:05.905679 [info ] [MainThread]: Finished running 1 table model in 0 hours 2 minutes and 17.94 seconds (137.94s).
[0m12:58:05.907621 [debug] [MainThread]: Command end result
[0m12:58:05.955901 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m12:58:05.957884 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m12:58:05.962602 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt/target/run_results.json
[0m12:58:05.962859 [info ] [MainThread]: 
[0m12:58:05.963171 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:58:05.963655 [info ] [MainThread]: 
[0m12:58:05.964084 [error] [MainThread]: [31mFailure in model stg_trade (models/staging/stg_trade.sql)[0m
[0m12:58:05.964498 [error] [MainThread]:   Database Error in model stg_trade (models/staging/stg_trade.sql)
  002003 (42S02): SQL compilation error:
  Object 'TRHS.STAGING.CITRUS_EXT' does not exist or not authorized.
  compiled code at target/run/citrus_trade/models/staging/stg_trade.sql
[0m12:58:05.964828 [info ] [MainThread]: 
[0m12:58:05.965168 [info ] [MainThread]:   compiled code at target/compiled/citrus_trade/models/staging/stg_trade.sql
[0m12:58:05.965467 [info ] [MainThread]: 
[0m12:58:05.965809 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m12:58:05.966699 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 6.2496266, "process_in_blocks": "0", "process_kernel_time": 0.491202, "process_mem_max_rss": "154440", "process_out_blocks": "2694", "process_user_time": 1.535515}
[0m12:58:05.967089 [debug] [MainThread]: Command `dbt run` failed at 12:58:05.967023 after 6.25 seconds
[0m12:58:05.967534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8acaba70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff890d3d40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b4197f0>]}
[0m12:58:05.967900 [debug] [MainThread]: Flushing usage events
[0m12:58:06.452965 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:01:25.041601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1cd6870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1cd5bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1f80440>]}


============================== 13:01:25.045036 | 3ad90859-ea74-4d3f-bfcd-8e9acc7c0373 ==============================
[0m13:01:25.045036 [info ] [MainThread]: Running with dbt=1.10.13
[0m13:01:25.045384 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'invocation_command': 'dbt run', 'cache_selected_only': 'False', 'introspect': 'True', 'quiet': 'False', 'printer_width': '80', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'fail_fast': 'False', 'version_check': 'True', 'static_parser': 'True', 'write_json': 'True', 'empty': 'False', 'target_path': 'None', 'indirect_selection': 'eager', 'log_path': '/app/dbt/logs', 'profiles_dir': '/app', 'log_cache_events': 'False', 'debug': 'False', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:01:25.046908 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'citrus_trade'
[0m13:01:25.047536 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.03455975, "process_in_blocks": "0", "process_kernel_time": 0.196975, "process_mem_max_rss": "99064", "process_out_blocks": "2", "process_user_time": 0.723909}
[0m13:01:25.047778 [debug] [MainThread]: Command `dbt run` failed at 13:01:25.047733 after 0.03 seconds
[0m13:01:25.047967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1745af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1c26a20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1508770>]}
[0m13:01:25.048147 [debug] [MainThread]: Flushing usage events
[0m13:01:25.545632 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:01:28.785486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff861d1ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8868db20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff861d2a20>]}


============================== 13:01:28.787611 | 601f8de3-b368-44d4-84cd-758e0989f325 ==============================
[0m13:01:28.787611 [info ] [MainThread]: Running with dbt=1.10.13
[0m13:01:28.787964 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'debug': 'False', 'printer_width': '80', 'cache_selected_only': 'False', 'log_path': '/app/dbt/logs', 'static_parser': 'True', 'warn_error': 'None', 'partial_parse': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'indirect_selection': 'eager', 'quiet': 'False', 'log_cache_events': 'False', 'profiles_dir': '.', 'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'version_check': 'True', 'write_json': 'True', 'invocation_command': 'dbt run --profiles-dir .', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False'}
[0m13:01:28.985257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '601f8de3-b368-44d4-84cd-758e0989f325', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff863573e0>]}
[0m13:01:29.015358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '601f8de3-b368-44d4-84cd-758e0989f325', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85efd880>]}
[0m13:01:29.015800 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m13:01:29.071768 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m13:01:29.162948 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m13:01:29.163319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '601f8de3-b368-44d4-84cd-758e0989f325', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff861af230>]}
[0m13:01:29.820286 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.citrus_trade.analytics
[0m13:01:29.825755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '601f8de3-b368-44d4-84cd-758e0989f325', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83f8deb0>]}
[0m13:01:29.874040 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m13:01:29.875388 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m13:01:29.883289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '601f8de3-b368-44d4-84cd-758e0989f325', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff837a7a40>]}
[0m13:01:29.883550 [info ] [MainThread]: Found 1 model, 1 source, 633 macros
[0m13:01:29.883768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '601f8de3-b368-44d4-84cd-758e0989f325', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83bd6240>]}
[0m13:01:29.884707 [info ] [MainThread]: 
[0m13:01:29.884929 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:01:29.885356 [info ] [MainThread]: 
[0m13:01:29.885840 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:01:29.886506 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRHS'
[0m13:01:29.950204 [debug] [ThreadPool]: Using snowflake connection "list_TRHS"
[0m13:01:29.950529 [debug] [ThreadPool]: On list_TRHS: show terse schemas in database TRHS
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS"} */
[0m13:01:29.950690 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:01:32.525045 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: show terse schemas in database TRHS
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS"} */
[0m13:01:32.526095 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m13:01:32.526831 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_schemas
[0m13:01:32.527297 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m13:01:32.528428 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:01:32.529241 [debug] [MainThread]: Connection 'list_TRHS' was left open.
[0m13:01:32.529741 [debug] [MainThread]: On list_TRHS: No close available on handle
[0m13:01:32.530217 [info ] [MainThread]: 
[0m13:01:32.531101 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 2.64 seconds (2.64s).
[0m13:01:32.532416 [error] [MainThread]: Encountered an error:
Runtime Error
  Database error while listing schemas in database "TRHS"
  Database Error
    250001 (08001): Failed to connect to DB: gylobbh-fi81452.snowflakecomputing.com:443. Role 'ACCOUNTADMIN' specified in the connect string is not granted to this user. Contact your local system administrator, or attempt to login with another role, e.g. PUBLIC.
[0m13:01:32.534582 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.7766747, "process_in_blocks": "0", "process_kernel_time": 0.212906, "process_mem_max_rss": "154332", "process_out_blocks": "2699", "process_user_time": 1.848187}
[0m13:01:32.535520 [debug] [MainThread]: Command `dbt run` failed at 13:01:32.535364 after 3.78 seconds
[0m13:01:32.536188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff861779b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82749e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83f8e390>]}
[0m13:01:32.536790 [debug] [MainThread]: Flushing usage events
[0m13:01:33.027581 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:02:27.316436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85104d40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85321640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff849d0b00>]}


============================== 13:02:27.320041 | 0d842d42-9938-4af9-a1cd-314d034d155c ==============================
[0m13:02:27.320041 [info ] [MainThread]: Running with dbt=1.10.13
[0m13:02:27.320484 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '.', 'use_colors': 'True', 'invocation_command': 'dbt run --profiles-dir .', 'send_anonymous_usage_stats': 'True', 'empty': 'False', 'warn_error': 'None', 'version_check': 'True', 'cache_selected_only': 'False', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'indirect_selection': 'eager', 'log_path': '/app/dbt/logs', 'fail_fast': 'False', 'quiet': 'False', 'printer_width': '80', 'debug': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'write_json': 'True', 'log_cache_events': 'False', 'target_path': 'None', 'static_parser': 'True', 'log_format': 'default'}
[0m13:02:27.535081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0d842d42-9938-4af9-a1cd-314d034d155c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83282450>]}
[0m13:02:27.565274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0d842d42-9938-4af9-a1cd-314d034d155c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff851a7830>]}
[0m13:02:27.565733 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m13:02:27.614848 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m13:02:27.729012 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:02:27.729313 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:02:27.732293 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.citrus_trade.analytics
[0m13:02:27.747053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0d842d42-9938-4af9-a1cd-314d034d155c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff831baff0>]}
[0m13:02:27.795332 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m13:02:27.796725 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m13:02:27.805501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0d842d42-9938-4af9-a1cd-314d034d155c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82d9fe60>]}
[0m13:02:27.805801 [info ] [MainThread]: Found 1 model, 1 source, 633 macros
[0m13:02:27.806064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0d842d42-9938-4af9-a1cd-314d034d155c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82eb2b10>]}
[0m13:02:27.807164 [info ] [MainThread]: 
[0m13:02:27.807448 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:02:27.807801 [info ] [MainThread]: 
[0m13:02:27.808388 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:02:27.809219 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRHS'
[0m13:02:27.833311 [debug] [ThreadPool]: Using snowflake connection "list_TRHS"
[0m13:02:27.833624 [debug] [ThreadPool]: On list_TRHS: show terse schemas in database TRHS
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS"} */
[0m13:02:27.833796 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:02:30.592891 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2.759 seconds
[0m13:02:30.598471 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRHS, now list_TRHS_staging)
[0m13:02:30.617116 [debug] [ThreadPool]: Using snowflake connection "list_TRHS_staging"
[0m13:02:30.617729 [debug] [ThreadPool]: On list_TRHS_staging: show objects in TRHS.staging
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS_staging"} */;
[0m13:02:30.736978 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.119 seconds
[0m13:02:30.743430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0d842d42-9938-4af9-a1cd-314d034d155c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff838c6bd0>]}
[0m13:02:30.747904 [debug] [Thread-1 (]: Began running node model.citrus_trade.stg_trade
[0m13:02:30.748608 [info ] [Thread-1 (]: 1 of 1 START sql table model staging.stg_trade ................................. [RUN]
[0m13:02:30.749385 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_TRHS_staging, now model.citrus_trade.stg_trade)
[0m13:02:30.749916 [debug] [Thread-1 (]: Began compiling node model.citrus_trade.stg_trade
[0m13:02:30.758356 [debug] [Thread-1 (]: Writing injected SQL for node "model.citrus_trade.stg_trade"
[0m13:02:30.759887 [debug] [Thread-1 (]: Began executing node model.citrus_trade.stg_trade
[0m13:02:30.784879 [debug] [Thread-1 (]: Writing runtime sql for node "model.citrus_trade.stg_trade"
[0m13:02:30.786712 [debug] [Thread-1 (]: Using snowflake connection "model.citrus_trade.stg_trade"
[0m13:02:30.787093 [debug] [Thread-1 (]: On model.citrus_trade.stg_trade: create or replace transient table TRHS.staging.stg_trade
    
    
    
    as (select
  value:"declarant"::int as declarant,
  value:"declarant_iso"::string as declarant_iso,
  value:"partner"::string as partner,
  value:"partner_iso"::string as partner_iso,
  value:"flow"::int as flow,
  value:"transport_mode"::int as transport_mode,
  value:"period"::int as period,
  value:"hs4"::string as hs4,
  value:"hs4_name"::string as hs4_name,
  value:"hs6"::string as hs6,
  value:"hs6_name"::string as hs6_name,
  value:"value_in_euros"::float as value_in_euros,
  value:"quantity_in_kg"::float as quantity_in_kg
from trhs.staging.citrus_ext
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.stg_trade"} */;
[0m13:02:31.912623 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.125 seconds
[0m13:02:31.948589 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d842d42-9938-4af9-a1cd-314d034d155c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff871f1820>]}
[0m13:02:31.949687 [info ] [Thread-1 (]: 1 of 1 OK created sql table model staging.stg_trade ............................ [[32mSUCCESS 1[0m in 1.20s]
[0m13:02:31.950521 [debug] [Thread-1 (]: Finished running node model.citrus_trade.stg_trade
[0m13:02:31.952377 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:02:31.952771 [debug] [MainThread]: Connection 'model.citrus_trade.stg_trade' was left open.
[0m13:02:31.953115 [debug] [MainThread]: On model.citrus_trade.stg_trade: Close
[0m13:02:32.054522 [info ] [MainThread]: 
[0m13:02:32.055641 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.25 seconds (4.25s).
[0m13:02:32.057009 [debug] [MainThread]: Command end result
[0m13:02:32.102806 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m13:02:32.104963 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m13:02:32.109695 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt/target/run_results.json
[0m13:02:32.109934 [info ] [MainThread]: 
[0m13:02:32.110240 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:02:32.110628 [info ] [MainThread]: 
[0m13:02:32.111051 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m13:02:32.112028 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.8295107, "process_in_blocks": "0", "process_kernel_time": 0.377374, "process_mem_max_rss": "151948", "process_out_blocks": "2682", "process_user_time": 1.399388}
[0m13:02:32.112446 [debug] [MainThread]: Command `dbt run` succeeded at 13:02:32.112352 after 4.83 seconds
[0m13:02:32.112748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff897faa50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff857f2c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82dac770>]}
[0m13:02:32.113006 [debug] [MainThread]: Flushing usage events
[0m13:02:32.568982 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:03:29.404153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e444b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e4448f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f1e0cb0>]}


============================== 13:03:29.407630 | 13d04d8c-e5a5-48bf-bd32-7fbe027fb319 ==============================
[0m13:03:29.407630 [info ] [MainThread]: Running with dbt=1.10.13
[0m13:03:29.407974 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'log_path': '/app/dbt/logs', 'invocation_command': 'dbt run-operation grant_select', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_experimental_parser': 'False', 'introspect': 'True', 'target_path': 'None', 'write_json': 'True', 'partial_parse': 'True', 'fail_fast': 'False', 'static_parser': 'True', 'use_colors': 'True', 'log_format': 'default', 'quiet': 'False', 'version_check': 'True', 'indirect_selection': 'eager', 'empty': 'None', 'profiles_dir': '/app', 'debug': 'False', 'no_print': 'None', 'log_cache_events': 'False'}
[0m13:03:29.409497 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'citrus_trade'
[0m13:03:29.410179 [debug] [MainThread]: Resource report: {"command_name": "run-operation", "command_success": false, "command_wall_clock_time": 0.034541458, "process_in_blocks": "0", "process_kernel_time": 0.077993, "process_mem_max_rss": "99056", "process_out_blocks": "2", "process_user_time": 0.677941}
[0m13:03:29.410509 [debug] [MainThread]: Command `dbt run-operation` failed at 13:03:29.410440 after 0.04 seconds
[0m13:03:29.410719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90b53f80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e3a8560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e8ae000>]}
[0m13:03:29.410915 [debug] [MainThread]: Flushing usage events
[0m13:03:29.909093 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:03:50.033833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7aee34a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7a5449e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7a545280>]}


============================== 13:03:50.036270 | 4b112598-92f9-4d43-9e31-8c54b1b15e3f ==============================
[0m13:03:50.036270 [info ] [MainThread]: Running with dbt=1.10.13
[0m13:03:50.036590 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'quiet': 'False', 'log_cache_events': 'False', 'target_path': 'None', 'log_path': '/app/dbt/logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'empty': 'False', 'warn_error': 'None', 'version_check': 'True', 'printer_width': '80', 'cache_selected_only': 'False', 'static_parser': 'True', 'use_experimental_parser': 'False', 'use_colors': 'True', 'invocation_command': 'dbt run', 'profiles_dir': '/app', 'log_format': 'default', 'fail_fast': 'False', 'debug': 'False', 'introspect': 'True', 'no_print': 'None', 'indirect_selection': 'eager'}
[0m13:03:50.038095 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'citrus_trade'
[0m13:03:50.038716 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.036383335, "process_in_blocks": "0", "process_kernel_time": 0.131853, "process_mem_max_rss": "99184", "process_out_blocks": "2", "process_user_time": 0.731188}
[0m13:03:50.038969 [debug] [MainThread]: Command `dbt run` failed at 13:03:50.038923 after 0.04 seconds
[0m13:03:50.039140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ab742c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7a263c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7aee02f0>]}
[0m13:03:50.039313 [debug] [MainThread]: Flushing usage events
[0m13:03:50.522243 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:17:46.075166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8ea37d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8ea2090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8ea18d0>]}


============================== 13:17:46.080251 | db235773-0c46-4098-a929-5d9d5bc196e2 ==============================
[0m13:17:46.080251 [info ] [MainThread]: Running with dbt=1.11.0-b3
[0m13:17:46.080837 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'no_print': 'None', 'empty': 'None', 'fail_fast': 'False', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'version_check': 'True', 'log_path': '/app/dbt/logs', 'static_parser': 'True', 'write_json': 'True', 'debug': 'False', 'use_experimental_parser': 'False', 'quiet': 'False', 'cache_selected_only': 'False', 'warn_error': 'None', 'log_format': 'default', 'log_cache_events': 'False', 'profiles_dir': '/app/dbt', 'target_path': 'None', 'introspect': 'True', 'use_colors': 'True'}
[0m13:17:46.161595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'db235773-0c46-4098-a929-5d9d5bc196e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8e7a050>]}
[0m13:17:46.276432 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-ftqibwpl'
[0m13:17:46.277052 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m13:17:46.377299 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m13:17:46.378826 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json
[0m13:17:46.472378 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json 200
[0m13:17:46.475493 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m13:17:46.591490 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m13:17:46.633276 [info ] [MainThread]: Installing dbt-labs/codegen
[0m13:17:47.435518 [info ] [MainThread]: Installed from version 0.13.1
[0m13:17:47.436513 [info ] [MainThread]: Up to date!
[0m13:17:47.438229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'db235773-0c46-4098-a929-5d9d5bc196e2', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8e1cf50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8b75810>]}
[0m13:17:47.439073 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m13:17:47.927149 [info ] [MainThread]: Installed from version 1.3.1
[0m13:17:47.927665 [info ] [MainThread]: Up to date!
[0m13:17:47.928277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'db235773-0c46-4098-a929-5d9d5bc196e2', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8d98490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8da1f50>]}
[0m13:17:47.932554 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 1.8856137, "process_in_blocks": "8", "process_kernel_time": 0.651989, "process_mem_max_rss": "107200", "process_out_blocks": "3118", "process_user_time": 1.285867}
[0m13:17:47.933259 [debug] [MainThread]: Command `dbt deps` succeeded at 13:17:47.933140 after 1.89 seconds
[0m13:17:47.933828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8ed3710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa90d8e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffadfe8a10>]}
[0m13:17:47.934084 [debug] [MainThread]: Flushing usage events
[0m13:17:48.431514 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:17:49.543730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb11f1190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb11f1350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb11f0390>]}


============================== 13:17:49.545738 | 0c50c03c-6aa4-43f4-8d94-19b047f30bfe ==============================
[0m13:17:49.545738 [info ] [MainThread]: Running with dbt=1.11.0-b3
[0m13:17:49.546243 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'empty': 'None', 'no_print': 'None', 'profiles_dir': '/app/dbt', 'partial_parse': 'True', 'debug': 'False', 'version_check': 'True', 'log_path': '/app/dbt/logs', 'fail_fast': 'False', 'log_format': 'default', 'use_colors': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'printer_width': '80', 'log_cache_events': 'False', 'invocation_command': 'dbt seed', 'quiet': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'static_parser': 'True', 'write_json': 'True'}
[0m13:17:50.102417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0c50c03c-6aa4-43f4-8d94-19b047f30bfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffafabd710>]}
[0m13:17:50.135560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0c50c03c-6aa4-43f4-8d94-19b047f30bfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb21ae610>]}
[0m13:17:50.136254 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m13:17:50.209258 [debug] [MainThread]: checksum: e63134dccc1251cfb572caf0e4aa952f030c125ee3634f3bf2c0a2e1bb6ae349, vars: {}, profile: , target: , version: 1.11.0b3
[0m13:17:50.302646 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m13:17:50.303305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '0c50c03c-6aa4-43f4-8d94-19b047f30bfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffafdf7e50>]}
[0m13:17:51.118543 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.citrus_trade.analytics
[0m13:17:51.124517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0c50c03c-6aa4-43f4-8d94-19b047f30bfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1390b50>]}
[0m13:17:51.171562 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m13:17:51.173140 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m13:17:51.189514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0c50c03c-6aa4-43f4-8d94-19b047f30bfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffafc956d0>]}
[0m13:17:51.189853 [info ] [MainThread]: Found 1 model, 1 source, 632 macros
[0m13:17:51.190119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0c50c03c-6aa4-43f4-8d94-19b047f30bfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3c5f350>]}
[0m13:17:51.191047 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m13:17:51.191509 [debug] [MainThread]: Command end result
[0m13:17:51.212189 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m13:17:51.213495 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m13:17:51.215239 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt/target/run_results.json
[0m13:17:51.215419 [info ] [MainThread]: 
[0m13:17:51.215702 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:17:51.215987 [info ] [MainThread]: 
[0m13:17:51.216205 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=0
[0m13:17:51.216921 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 1.7011192, "process_in_blocks": "288", "process_kernel_time": 0.582694, "process_mem_max_rss": "138500", "process_out_blocks": "4204", "process_user_time": 1.925599}
[0m13:17:51.217271 [debug] [MainThread]: Command `dbt seed` succeeded at 13:17:51.217205 after 1.70 seconds
[0m13:17:51.217550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1071590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb62b8a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf62e410>]}
[0m13:17:51.217794 [debug] [MainThread]: Flushing usage events
[0m13:17:51.682811 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:17:52.756530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e3c0790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e6632d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e560a50>]}


============================== 13:17:52.758640 | b4d4c3d0-b599-4f93-a9b1-16056569e3c8 ==============================
[0m13:17:52.758640 [info ] [MainThread]: Running with dbt=1.11.0-b3
[0m13:17:52.759137 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'log_path': '/app/dbt/logs', 'use_colors': 'True', 'log_format': 'default', 'use_experimental_parser': 'False', 'quiet': 'False', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'profiles_dir': '/app/dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'empty': 'False', 'fail_fast': 'False', 'invocation_command': 'dbt run', 'debug': 'False', 'log_cache_events': 'False', 'static_parser': 'True', 'warn_error': 'None', 'partial_parse': 'True', 'printer_width': '80', 'version_check': 'True', 'no_print': 'None'}
[0m13:17:52.991438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b4d4c3d0-b599-4f93-a9b1-16056569e3c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e419cd0>]}
[0m13:17:53.033968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b4d4c3d0-b599-4f93-a9b1-16056569e3c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f37e450>]}
[0m13:17:53.034781 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m13:17:53.090766 [debug] [MainThread]: checksum: e63134dccc1251cfb572caf0e4aa952f030c125ee3634f3bf2c0a2e1bb6ae349, vars: {}, profile: , target: , version: 1.11.0b3
[0m13:17:53.261516 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:17:53.261893 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:17:53.265241 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.citrus_trade.analytics
[0m13:17:53.282100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b4d4c3d0-b599-4f93-a9b1-16056569e3c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c8973d0>]}
[0m13:17:53.344293 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m13:17:53.346069 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m13:17:53.353402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b4d4c3d0-b599-4f93-a9b1-16056569e3c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7cb92e90>]}
[0m13:17:53.353813 [info ] [MainThread]: Found 1 model, 1 source, 632 macros
[0m13:17:53.354110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b4d4c3d0-b599-4f93-a9b1-16056569e3c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7cb4a950>]}
[0m13:17:53.355269 [info ] [MainThread]: 
[0m13:17:53.356031 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:17:53.356808 [info ] [MainThread]: 
[0m13:17:53.357547 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:17:53.358339 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRHS'
[0m13:17:53.441844 [debug] [ThreadPool]: Using snowflake connection "list_TRHS"
[0m13:17:53.442351 [debug] [ThreadPool]: On list_TRHS: show terse schemas in database TRHS
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS"} */
[0m13:17:53.442567 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:17:56.310214 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2.867 seconds
[0m13:17:56.318795 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRHS, now list_TRHS_staging)
[0m13:17:56.339129 [debug] [ThreadPool]: Using snowflake connection "list_TRHS_staging"
[0m13:17:56.339735 [debug] [ThreadPool]: On list_TRHS_staging: show objects in TRHS.staging
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS_staging"} */;
[0m13:17:56.419294 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.079 seconds
[0m13:17:56.425242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b4d4c3d0-b599-4f93-a9b1-16056569e3c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e41aa90>]}
[0m13:17:56.438360 [debug] [Thread-1 (]: Began running node model.citrus_trade.stg_trade
[0m13:17:56.439433 [info ] [Thread-1 (]: 1 of 1 START sql table model staging.stg_trade ................................. [RUN]
[0m13:17:56.440218 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_TRHS_staging, now model.citrus_trade.stg_trade)
[0m13:17:56.440847 [debug] [Thread-1 (]: Began compiling node model.citrus_trade.stg_trade
[0m13:17:56.451487 [debug] [Thread-1 (]: Writing injected SQL for node "model.citrus_trade.stg_trade"
[0m13:17:56.453586 [debug] [Thread-1 (]: Began executing node model.citrus_trade.stg_trade
[0m13:17:56.482629 [debug] [Thread-1 (]: Writing runtime sql for node "model.citrus_trade.stg_trade"
[0m13:17:56.484385 [debug] [Thread-1 (]: Using snowflake connection "model.citrus_trade.stg_trade"
[0m13:17:56.484746 [debug] [Thread-1 (]: On model.citrus_trade.stg_trade: create or replace transient table TRHS.staging.stg_trade
    
    
    
    as (select
  value:"declarant"::int as declarant,
  value:"declarant_iso"::string as declarant_iso,
  value:"partner"::string as partner,
  value:"partner_iso"::string as partner_iso,
  value:"flow"::int as flow,
  value:"transport_mode"::int as transport_mode,
  value:"period"::int as period,
  value:"hs4"::string as hs4,
  value:"hs4_name"::string as hs4_name,
  value:"hs6"::string as hs6,
  value:"hs6_name"::string as hs6_name,
  value:"value_in_euros"::float as value_in_euros,
  value:"quantity_in_kg"::float as quantity_in_kg
from trhs.staging.citrus_ext
    )

/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.stg_trade"} */;
[0m13:17:57.669529 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.184 seconds
[0m13:17:57.709290 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b4d4c3d0-b599-4f93-a9b1-16056569e3c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7908e710>]}
[0m13:17:57.710343 [info ] [Thread-1 (]: 1 of 1 OK created sql table model staging.stg_trade ............................ [[32mSUCCESS 1[0m in 1.27s]
[0m13:17:57.711343 [debug] [Thread-1 (]: Finished running node model.citrus_trade.stg_trade
[0m13:17:57.713679 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:17:57.714114 [debug] [MainThread]: Connection 'model.citrus_trade.stg_trade' was left open.
[0m13:17:57.714558 [debug] [MainThread]: On model.citrus_trade.stg_trade: Close
[0m13:17:57.816789 [info ] [MainThread]: 
[0m13:17:57.817732 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.46 seconds (4.46s).
[0m13:17:57.819014 [debug] [MainThread]: Command end result
[0m13:17:57.929890 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m13:17:57.931249 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m13:17:57.934491 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt/target/run_results.json
[0m13:17:57.934700 [info ] [MainThread]: 
[0m13:17:57.935008 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:17:57.935301 [info ] [MainThread]: 
[0m13:17:57.935626 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m13:17:57.936606 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.209245, "process_in_blocks": "128", "process_kernel_time": 0.572914, "process_mem_max_rss": "158112", "process_out_blocks": "5199", "process_user_time": 1.821971}
[0m13:17:57.936888 [debug] [MainThread]: Command `dbt run` succeeded at 13:17:57.936834 after 5.21 seconds
[0m13:17:57.937119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83429590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff834289d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c835510>]}
[0m13:17:57.937326 [debug] [MainThread]: Flushing usage events
[0m13:17:58.397703 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:17:59.747287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7de0f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8080750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7dd55d0>]}


============================== 13:17:59.749144 | 0d3fc5e5-0915-4731-baa6-7cd1f3b6985f ==============================
[0m13:17:59.749144 [info ] [MainThread]: Running with dbt=1.11.0-b3
[0m13:17:59.749595 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'empty': 'None', 'debug': 'False', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'version_check': 'True', 'invocation_command': 'dbt docs generate', 'warn_error': 'None', 'indirect_selection': 'eager', 'write_json': 'True', 'static_parser': 'True', 'log_format': 'default', 'log_path': '/app/dbt/logs', 'no_print': 'None', 'quiet': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'printer_width': '80', 'profiles_dir': '/app/dbt'}
[0m13:17:59.973568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0d3fc5e5-0915-4731-baa6-7cd1f3b6985f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa68f8050>]}
[0m13:18:00.008537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0d3fc5e5-0915-4731-baa6-7cd1f3b6985f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa686d390>]}
[0m13:18:00.009435 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m13:18:00.064472 [debug] [MainThread]: checksum: e63134dccc1251cfb572caf0e4aa952f030c125ee3634f3bf2c0a2e1bb6ae349, vars: {}, profile: , target: , version: 1.11.0b3
[0m13:18:00.149086 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:18:00.149469 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:18:00.152460 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.citrus_trade.analytics
[0m13:18:00.167559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0d3fc5e5-0915-4731-baa6-7cd1f3b6985f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7e3a3d0>]}
[0m13:18:00.176932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0d3fc5e5-0915-4731-baa6-7cd1f3b6985f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6374d10>]}
[0m13:18:00.177245 [info ] [MainThread]: Found 1 model, 1 source, 632 macros
[0m13:18:00.177486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0d3fc5e5-0915-4731-baa6-7cd1f3b6985f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa63a16d0>]}
[0m13:18:00.178469 [info ] [MainThread]: 
[0m13:18:00.178743 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:18:00.179073 [info ] [MainThread]: 
[0m13:18:00.179500 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:18:00.180645 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRHS_staging'
[0m13:18:00.207370 [debug] [ThreadPool]: Using snowflake connection "list_TRHS_staging"
[0m13:18:00.207741 [debug] [ThreadPool]: On list_TRHS_staging: show objects in TRHS.staging
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS_staging"} */;
[0m13:18:00.207948 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:18:00.689489 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.481 seconds
[0m13:18:00.696096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0d3fc5e5-0915-4731-baa6-7cd1f3b6985f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa66a6150>]}
[0m13:18:00.703891 [debug] [Thread-1 (]: Began running node model.citrus_trade.stg_trade
[0m13:18:00.705656 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_TRHS_staging, now model.citrus_trade.stg_trade)
[0m13:18:00.706610 [debug] [Thread-1 (]: Began compiling node model.citrus_trade.stg_trade
[0m13:18:00.715006 [debug] [Thread-1 (]: Writing injected SQL for node "model.citrus_trade.stg_trade"
[0m13:18:00.716088 [debug] [Thread-1 (]: Began executing node model.citrus_trade.stg_trade
[0m13:18:00.716847 [debug] [Thread-1 (]: Finished running node model.citrus_trade.stg_trade
[0m13:18:00.718282 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:18:00.718700 [debug] [MainThread]: Connection 'model.citrus_trade.stg_trade' was left open.
[0m13:18:00.719018 [debug] [MainThread]: On model.citrus_trade.stg_trade: Close
[0m13:18:00.806956 [debug] [MainThread]: Command end result
[0m13:18:00.884926 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m13:18:00.887176 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m13:18:00.894467 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt/target/run_results.json
[0m13:18:00.914672 [debug] [MainThread]: Acquiring new snowflake connection 'generate_catalog'
[0m13:18:00.915122 [info ] [MainThread]: Building catalog
[0m13:18:00.923998 [debug] [ThreadPool]: Acquiring new snowflake connection 'TRHS.information_schema'
[0m13:18:00.925238 [debug] [ThreadPool]: Acquiring new snowflake connection 'trhs.information_schema'
[0m13:18:00.938899 [debug] [ThreadPool]: Using snowflake connection "TRHS.information_schema"
[0m13:18:00.941812 [debug] [ThreadPool]: Using snowflake connection "trhs.information_schema"
[0m13:18:00.942396 [debug] [ThreadPool]: On TRHS.information_schema: with tables as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",
        case
            when is_dynamic = 'YES' and table_type = 'BASE TABLE' THEN 'DYNAMIC TABLE'
            else table_type
        end as "table_type",
        comment as "table_comment",

        -- note: this is the _role_ that owns the table
        table_owner as "table_owner",

        'Clustering Key' as "stats:clustering_key:label",
        clustering_key as "stats:clustering_key:value",
        'The key used to cluster this table' as "stats:clustering_key:description",
        (clustering_key is not null) as "stats:clustering_key:include",

        'Row Count' as "stats:row_count:label",
        row_count as "stats:row_count:value",
        'An approximate count of rows in this table' as "stats:row_count:description",
        (row_count is not null) as "stats:row_count:include",

        'Approximate Size' as "stats:bytes:label",
        bytes as "stats:bytes:value",
        'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
        (bytes is not null) as "stats:bytes:include",

        'Last Modified' as "stats:last_modified:label",
        to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
        'The timestamp for last update/change' as "stats:last_modified:description",
        (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"
    from TRHS.INFORMATION_SCHEMA.tables
            where (
                (
                    
    "table_schema" ilike 'staging' and upper("table_schema") = upper('staging')

                    and 
    "table_name" ilike 'stg_trade' and upper("table_name") = upper('stg_trade')

                )
            )
        ),
        columns as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",

        column_name as "column_name",
        ordinal_position as "column_index",
        data_type as "column_type",
        comment as "column_comment"
    from TRHS.INFORMATION_SCHEMA.columns
            where (
                (
                    
    "table_schema" ilike 'staging' and upper("table_schema") = upper('staging')

                    and 
    "table_name" ilike 'stg_trade' and upper("table_name") = upper('stg_trade')

                )
            )
        )
        select *
    from tables
    join columns using ("table_database", "table_schema", "table_name")
    order by "column_index"
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "TRHS.information_schema"} */
[0m13:18:00.943309 [debug] [ThreadPool]: On trhs.information_schema: with tables as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",
        case
            when is_dynamic = 'YES' and table_type = 'BASE TABLE' THEN 'DYNAMIC TABLE'
            else table_type
        end as "table_type",
        comment as "table_comment",

        -- note: this is the _role_ that owns the table
        table_owner as "table_owner",

        'Clustering Key' as "stats:clustering_key:label",
        clustering_key as "stats:clustering_key:value",
        'The key used to cluster this table' as "stats:clustering_key:description",
        (clustering_key is not null) as "stats:clustering_key:include",

        'Row Count' as "stats:row_count:label",
        row_count as "stats:row_count:value",
        'An approximate count of rows in this table' as "stats:row_count:description",
        (row_count is not null) as "stats:row_count:include",

        'Approximate Size' as "stats:bytes:label",
        bytes as "stats:bytes:value",
        'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
        (bytes is not null) as "stats:bytes:include",

        'Last Modified' as "stats:last_modified:label",
        to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
        'The timestamp for last update/change' as "stats:last_modified:description",
        (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"
    from trhs.INFORMATION_SCHEMA.tables
            where (
                (
                    
    "table_schema" ilike 'staging' and upper("table_schema") = upper('staging')

                    and 
    "table_name" ilike 'citrus_ext' and upper("table_name") = upper('citrus_ext')

                )
            )
        ),
        columns as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",

        column_name as "column_name",
        ordinal_position as "column_index",
        data_type as "column_type",
        comment as "column_comment"
    from trhs.INFORMATION_SCHEMA.columns
            where (
                (
                    
    "table_schema" ilike 'staging' and upper("table_schema") = upper('staging')

                    and 
    "table_name" ilike 'citrus_ext' and upper("table_name") = upper('citrus_ext')

                )
            )
        )
        select *
    from tables
    join columns using ("table_database", "table_schema", "table_name")
    order by "column_index"
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "trhs.information_schema"} */
[0m13:18:00.944149 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:18:00.945526 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:18:03.023720 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 2.078 seconds
[0m13:18:03.132392 [debug] [ThreadPool]: SQL status: SUCCESS 13 in 2.188 seconds
[0m13:18:03.164090 [debug] [MainThread]: Wrote artifact CatalogArtifact to /app/dbt/target/catalog.json
[0m13:18:03.247213 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m13:18:03.248498 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m13:18:03.248704 [info ] [MainThread]: Catalog written to /app/dbt/target/catalog.json
[0m13:18:03.249410 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 3.5299094, "process_in_blocks": "0", "process_kernel_time": 0.569456, "process_mem_max_rss": "157764", "process_out_blocks": "6031", "process_user_time": 1.506563}
[0m13:18:03.249761 [debug] [MainThread]: Command `dbt docs generate` succeeded at 13:18:03.249704 after 3.53 seconds
[0m13:18:03.250001 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m13:18:03.250216 [debug] [MainThread]: Connection 'TRHS.information_schema' was left open.
[0m13:18:03.250411 [debug] [MainThread]: On TRHS.information_schema: Close
[0m13:18:03.354140 [debug] [MainThread]: Connection 'trhs.information_schema' was left open.
[0m13:18:03.354845 [debug] [MainThread]: On trhs.information_schema: Close
[0m13:18:03.474655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7e45f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6eb7190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa68dd610>]}
[0m13:18:03.475162 [debug] [MainThread]: Flushing usage events
[0m13:18:03.934412 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:18:05.024777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e707ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e6cd3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91609e90>]}


============================== 13:18:05.026675 | 95dc1d8e-e39a-4b31-bddd-34283748dc12 ==============================
[0m13:18:05.026675 [info ] [MainThread]: Running with dbt=1.11.0-b3
[0m13:18:05.027167 [debug] [MainThread]: running dbt with arguments {'log_path': '/app/dbt/logs', 'write_json': 'True', 'invocation_command': 'dbt docs serve --port 5050 --host 0.0.0.0', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'version_check': 'True', 'log_format': 'default', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'use_colors': 'True', 'profiles_dir': '/app/dbt', 'indirect_selection': 'eager', 'warn_error': 'None', 'printer_width': '80', 'target_path': 'None', 'introspect': 'True', 'no_print': 'None', 'quiet': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'static_parser': 'True', 'fail_fast': 'False'}
[0m13:18:05.243363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '95dc1d8e-e39a-4b31-bddd-34283748dc12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d140050>]}
[0m13:18:05.272441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '95dc1d8e-e39a-4b31-bddd-34283748dc12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f66a510>]}
[0m13:18:19.505077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1696c30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb237a720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb16364b0>]}


============================== 13:18:19.511237 | 250a462d-4b17-403a-88c7-b2b194092a40 ==============================
[0m13:18:19.511237 [info ] [MainThread]: Running with dbt=1.10.13
[0m13:18:19.511708 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'profiles_dir': '/app/dbt', 'introspect': 'True', 'invocation_command': 'dbt run', 'partial_parse': 'True', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_format': 'default', 'no_print': 'None', 'quiet': 'False', 'write_json': 'True', 'target_path': 'None', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'version_check': 'True', 'indirect_selection': 'eager', 'warn_error': 'None', 'log_path': '/app/dbt/logs', 'empty': 'False', 'log_cache_events': 'False'}
[0m13:18:19.810217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '250a462d-4b17-403a-88c7-b2b194092a40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffafc51f40>]}
[0m13:18:19.843612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '250a462d-4b17-403a-88c7-b2b194092a40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb00f4ef0>]}
[0m13:18:19.844219 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m13:18:19.899978 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m13:18:19.955097 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m13:18:19.955514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '250a462d-4b17-403a-88c7-b2b194092a40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb17f8ce0>]}
[0m13:18:20.679772 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.citrus_trade.analytics
[0m13:18:20.684974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '250a462d-4b17-403a-88c7-b2b194092a40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaef12720>]}
[0m13:18:20.726849 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m13:18:20.728472 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m13:18:20.751043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '250a462d-4b17-403a-88c7-b2b194092a40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaef13b30>]}
[0m13:18:20.751342 [info ] [MainThread]: Found 1 model, 1 source, 632 macros
[0m13:18:20.751611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '250a462d-4b17-403a-88c7-b2b194092a40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaefdf080>]}
[0m13:18:20.752837 [info ] [MainThread]: 
[0m13:18:20.753070 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:18:20.753297 [info ] [MainThread]: 
[0m13:18:20.753731 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:18:20.756185 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRHS'
[0m13:18:20.809324 [debug] [ThreadPool]: Using snowflake connection "list_TRHS"
[0m13:18:20.809763 [debug] [ThreadPool]: On list_TRHS: show terse schemas in database TRHS
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS"} */
[0m13:18:20.809961 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:18:23.976386 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 3.166 seconds
[0m13:18:23.982372 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRHS, now list_TRHS_staging)
[0m13:18:24.001095 [debug] [ThreadPool]: Using snowflake connection "list_TRHS_staging"
[0m13:18:24.001663 [debug] [ThreadPool]: On list_TRHS_staging: show objects in TRHS.staging
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS_staging"} */;
[0m13:18:24.079412 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.077 seconds
[0m13:18:24.085036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '250a462d-4b17-403a-88c7-b2b194092a40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaef1f1d0>]}
[0m13:18:24.097105 [debug] [Thread-1 (]: Began running node model.citrus_trade.stg_trade
[0m13:18:24.098056 [info ] [Thread-1 (]: 1 of 1 START sql table model staging.stg_trade ................................. [RUN]
[0m13:18:24.098789 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_TRHS_staging, now model.citrus_trade.stg_trade)
[0m13:18:24.099485 [debug] [Thread-1 (]: Began compiling node model.citrus_trade.stg_trade
[0m13:18:24.110528 [debug] [Thread-1 (]: Writing injected SQL for node "model.citrus_trade.stg_trade"
[0m13:18:24.112570 [debug] [Thread-1 (]: Began executing node model.citrus_trade.stg_trade
[0m13:18:24.138101 [debug] [Thread-1 (]: Writing runtime sql for node "model.citrus_trade.stg_trade"
[0m13:18:24.139866 [debug] [Thread-1 (]: Using snowflake connection "model.citrus_trade.stg_trade"
[0m13:18:24.140200 [debug] [Thread-1 (]: On model.citrus_trade.stg_trade: create or replace transient table TRHS.staging.stg_trade
    
    
    
    as (select
  value:"declarant"::int as declarant,
  value:"declarant_iso"::string as declarant_iso,
  value:"partner"::string as partner,
  value:"partner_iso"::string as partner_iso,
  value:"flow"::int as flow,
  value:"transport_mode"::int as transport_mode,
  value:"period"::int as period,
  value:"hs4"::string as hs4,
  value:"hs4_name"::string as hs4_name,
  value:"hs6"::string as hs6,
  value:"hs6_name"::string as hs6_name,
  value:"value_in_euros"::float as value_in_euros,
  value:"quantity_in_kg"::float as quantity_in_kg
from trhs.staging.citrus_ext
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.stg_trade"} */;
[0m13:18:25.032089 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.891 seconds
[0m13:18:25.075268 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '250a462d-4b17-403a-88c7-b2b194092a40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3acdc10>]}
[0m13:18:25.076279 [info ] [Thread-1 (]: 1 of 1 OK created sql table model staging.stg_trade ............................ [[32mSUCCESS 1[0m in 0.97s]
[0m13:18:25.077231 [debug] [Thread-1 (]: Finished running node model.citrus_trade.stg_trade
[0m13:18:25.080409 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:18:25.081021 [debug] [MainThread]: Connection 'model.citrus_trade.stg_trade' was left open.
[0m13:18:25.081399 [debug] [MainThread]: On model.citrus_trade.stg_trade: Close
[0m13:18:25.173082 [info ] [MainThread]: 
[0m13:18:25.173551 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.42 seconds (4.42s).
[0m13:18:25.174737 [debug] [MainThread]: Command end result
[0m13:18:25.204466 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m13:18:25.206538 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m13:18:25.211506 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt/target/run_results.json
[0m13:18:25.211817 [info ] [MainThread]: 
[0m13:18:25.212232 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:18:25.212640 [info ] [MainThread]: 
[0m13:18:25.213093 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m13:18:25.214281 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.7364674, "process_in_blocks": "0", "process_kernel_time": 1.091309, "process_mem_max_rss": "159588", "process_out_blocks": "9945", "process_user_time": 2.490988}
[0m13:18:25.214742 [debug] [MainThread]: Command `dbt run` succeeded at 13:18:25.214630 after 5.74 seconds
[0m13:18:25.215105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb185cd40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb185d520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf263740>]}
[0m13:18:25.215511 [debug] [MainThread]: Flushing usage events
[0m13:18:25.690628 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:18:31.616220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8cde6ba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c8729c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c870c50>]}


============================== 13:18:31.618834 | f45caaf7-7729-447b-be9b-c4c9405e71dd ==============================
[0m13:18:31.618834 [info ] [MainThread]: Running with dbt=1.10.13
[0m13:18:31.619189 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'no_print': 'None', 'log_path': '/app/dbt/logs', 'warn_error': 'None', 'log_cache_events': 'False', 'version_check': 'True', 'profiles_dir': '/app/dbt', 'quiet': 'False', 'partial_parse': 'True', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run', 'fail_fast': 'False', 'introspect': 'True', 'use_experimental_parser': 'False', 'use_colors': 'True', 'target_path': 'None', 'debug': 'False', 'cache_selected_only': 'False', 'write_json': 'True', 'printer_width': '80'}
[0m13:18:31.817536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f45caaf7-7729-447b-be9b-c4c9405e71dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b5409e0>]}
[0m13:18:31.849225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f45caaf7-7729-447b-be9b-c4c9405e71dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b0219d0>]}
[0m13:18:31.849827 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m13:18:31.897464 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m13:18:32.022338 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:18:32.022615 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:18:32.025537 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.citrus_trade.analytics
[0m13:18:32.039390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f45caaf7-7729-447b-be9b-c4c9405e71dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a9e5eb0>]}
[0m13:18:32.088601 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m13:18:32.089966 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m13:18:32.097726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f45caaf7-7729-447b-be9b-c4c9405e71dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a5a3890>]}
[0m13:18:32.097989 [info ] [MainThread]: Found 1 model, 1 source, 632 macros
[0m13:18:32.098194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f45caaf7-7729-447b-be9b-c4c9405e71dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b566930>]}
[0m13:18:32.099149 [info ] [MainThread]: 
[0m13:18:32.099943 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:18:32.100278 [info ] [MainThread]: 
[0m13:18:32.100728 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:18:32.101298 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRHS'
[0m13:18:32.132308 [debug] [ThreadPool]: Using snowflake connection "list_TRHS"
[0m13:18:32.132609 [debug] [ThreadPool]: On list_TRHS: show terse schemas in database TRHS
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS"} */
[0m13:18:32.132772 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:18:32.557365 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.424 seconds
[0m13:18:32.559809 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRHS_staging'
[0m13:18:32.570647 [debug] [ThreadPool]: Using snowflake connection "list_TRHS_staging"
[0m13:18:32.571068 [debug] [ThreadPool]: On list_TRHS_staging: show objects in TRHS.staging
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS_staging"} */;
[0m13:18:32.571303 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:18:32.910566 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.339 seconds
[0m13:18:32.917439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f45caaf7-7729-447b-be9b-c4c9405e71dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ac4a540>]}
[0m13:18:32.923021 [debug] [Thread-1 (]: Began running node model.citrus_trade.stg_trade
[0m13:18:32.924004 [info ] [Thread-1 (]: 1 of 1 START sql table model staging.stg_trade ................................. [RUN]
[0m13:18:32.924925 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_TRHS_staging, now model.citrus_trade.stg_trade)
[0m13:18:32.925663 [debug] [Thread-1 (]: Began compiling node model.citrus_trade.stg_trade
[0m13:18:32.937006 [debug] [Thread-1 (]: Writing injected SQL for node "model.citrus_trade.stg_trade"
[0m13:18:32.938553 [debug] [Thread-1 (]: Began executing node model.citrus_trade.stg_trade
[0m13:18:32.972399 [debug] [Thread-1 (]: Writing runtime sql for node "model.citrus_trade.stg_trade"
[0m13:18:32.973996 [debug] [Thread-1 (]: Using snowflake connection "model.citrus_trade.stg_trade"
[0m13:18:32.974299 [debug] [Thread-1 (]: On model.citrus_trade.stg_trade: create or replace transient table TRHS.staging.stg_trade
    
    
    
    as (select
  value:"declarant"::int as declarant,
  value:"declarant_iso"::string as declarant_iso,
  value:"partner"::string as partner,
  value:"partner_iso"::string as partner_iso,
  value:"flow"::int as flow,
  value:"transport_mode"::int as transport_mode,
  value:"period"::int as period,
  value:"hs4"::string as hs4,
  value:"hs4_name"::string as hs4_name,
  value:"hs6"::string as hs6,
  value:"hs6_name"::string as hs6_name,
  value:"value_in_euros"::float as value_in_euros,
  value:"quantity_in_kg"::float as quantity_in_kg
from trhs.staging.citrus_ext
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.stg_trade"} */;
[0m13:18:33.871315 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.896 seconds
[0m13:18:33.908155 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f45caaf7-7729-447b-be9b-c4c9405e71dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e9855e0>]}
[0m13:18:33.909144 [info ] [Thread-1 (]: 1 of 1 OK created sql table model staging.stg_trade ............................ [[32mSUCCESS 1[0m in 0.98s]
[0m13:18:33.910010 [debug] [Thread-1 (]: Finished running node model.citrus_trade.stg_trade
[0m13:18:33.912017 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:18:33.912356 [debug] [MainThread]: Connection 'list_TRHS' was left open.
[0m13:18:33.912699 [debug] [MainThread]: On list_TRHS: Close
[0m13:18:34.017704 [debug] [MainThread]: Connection 'model.citrus_trade.stg_trade' was left open.
[0m13:18:34.018598 [debug] [MainThread]: On model.citrus_trade.stg_trade: Close
[0m13:18:34.102507 [info ] [MainThread]: 
[0m13:18:34.103848 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.00 seconds (2.00s).
[0m13:18:34.105487 [debug] [MainThread]: Command end result
[0m13:18:34.157505 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m13:18:34.159349 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m13:18:34.164087 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt/target/run_results.json
[0m13:18:34.164342 [info ] [MainThread]: 
[0m13:18:34.164610 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:18:34.165057 [info ] [MainThread]: 
[0m13:18:34.165577 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m13:18:34.166680 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.5780482, "process_in_blocks": "0", "process_kernel_time": 0.291643, "process_mem_max_rss": "153592", "process_out_blocks": "2679", "process_user_time": 1.490175}
[0m13:18:34.167108 [debug] [MainThread]: Command `dbt run` succeeded at 13:18:34.167033 after 2.58 seconds
[0m13:18:34.167390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c515100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8acd3e60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ea5d0d0>]}
[0m13:18:34.167651 [debug] [MainThread]: Flushing usage events
[0m13:18:34.617999 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:41:04.121733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff990c6690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98cb1580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98cb19d0>]}


============================== 13:41:04.127196 | c00bc79c-c74d-4814-9714-050f5be228d6 ==============================
[0m13:41:04.127196 [info ] [MainThread]: Running with dbt=1.10.13
[0m13:41:04.127553 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'introspect': 'True', 'target_path': 'None', 'partial_parse': 'True', 'cache_selected_only': 'False', 'use_colors': 'True', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'warn_error': 'None', 'invocation_command': 'dbt run', 'version_check': 'True', 'static_parser': 'True', 'write_json': 'True', 'empty': 'False', 'debug': 'False', 'printer_width': '80', 'profiles_dir': '/app/dbt', 'no_print': 'None', 'log_cache_events': 'False', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'log_path': '/app/dbt/logs', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager'}
[0m13:41:04.382617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c00bc79c-c74d-4814-9714-050f5be228d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff972349e0>]}
[0m13:41:04.412717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c00bc79c-c74d-4814-9714-050f5be228d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff981807d0>]}
[0m13:41:04.413143 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m13:41:04.467553 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m13:41:04.609794 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m13:41:04.610150 [debug] [MainThread]: Partial parsing: added file: citrus_trade://models/analytics/trade_by_reporter.sql
[0m13:41:04.719074 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.citrus_trade.trade_by_reporter' (models/analytics/trade_by_reporter.sql) depends on a node named 'stg_citrus_trade' which was not found
[0m13:41:04.720734 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.63353044, "process_in_blocks": "0", "process_kernel_time": 1.156726, "process_mem_max_rss": "130736", "process_out_blocks": "4", "process_user_time": 1.472654}
[0m13:41:04.721148 [debug] [MainThread]: Command `dbt run` failed at 13:41:04.721093 after 0.63 seconds
[0m13:41:04.721357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff968c7740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96949100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96587d10>]}
[0m13:41:04.721612 [debug] [MainThread]: Flushing usage events
[0m13:41:11.449230 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:41:34.982511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0833ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb04a9b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2dc5010>]}


============================== 13:41:34.985543 | ab9f677e-d210-4fbb-9a1e-005a069aa557 ==============================
[0m13:41:34.985543 [info ] [MainThread]: Running with dbt=1.10.13
[0m13:41:34.985935 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'use_colors': 'True', 'log_format': 'default', 'static_parser': 'True', 'profiles_dir': '/app/dbt', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'target_path': 'None', 'empty': 'False', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'debug': 'False', 'no_print': 'None', 'printer_width': '80', 'indirect_selection': 'eager', 'log_path': '/app/dbt/logs', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'invocation_command': 'dbt run', 'partial_parse': 'True', 'warn_error': 'None'}
[0m13:41:35.183914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ab9f677e-d210-4fbb-9a1e-005a069aa557', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb022cd70>]}
[0m13:41:35.215483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ab9f677e-d210-4fbb-9a1e-005a069aa557', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf018ef0>]}
[0m13:41:35.216052 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m13:41:35.264311 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m13:41:35.370829 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m13:41:35.371173 [debug] [MainThread]: Partial parsing: added file: citrus_trade://models/analytics/trade_by_reporter.sql
[0m13:41:35.497048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ab9f677e-d210-4fbb-9a1e-005a069aa557', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae813f20>]}
[0m13:41:35.540025 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m13:41:35.541478 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m13:41:35.550435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ab9f677e-d210-4fbb-9a1e-005a069aa557', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae9d03e0>]}
[0m13:41:35.550683 [info ] [MainThread]: Found 2 models, 1 source, 632 macros
[0m13:41:35.550895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ab9f677e-d210-4fbb-9a1e-005a069aa557', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaecbcda0>]}
[0m13:41:35.551906 [info ] [MainThread]: 
[0m13:41:35.552130 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:41:35.552450 [info ] [MainThread]: 
[0m13:41:35.553003 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:41:35.555436 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRHS'
[0m13:41:35.562605 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRHS'
[0m13:41:35.587208 [debug] [ThreadPool]: Using snowflake connection "list_TRHS"
[0m13:41:35.587550 [debug] [ThreadPool]: Using snowflake connection "list_TRHS"
[0m13:41:35.587727 [debug] [ThreadPool]: On list_TRHS: show terse schemas in database TRHS
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS"} */
[0m13:41:35.588004 [debug] [ThreadPool]: On list_TRHS: show terse schemas in database TRHS
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS"} */
[0m13:41:35.588200 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:41:35.588380 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:41:38.531003 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2.943 seconds
[0m13:41:38.531741 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2.943 seconds
[0m13:41:38.534858 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRHS, now list_TRHS_analytics)
[0m13:41:38.542198 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRHS, now list_TRHS_staging)
[0m13:41:38.544017 [debug] [ThreadPool]: Using snowflake connection "list_TRHS_analytics"
[0m13:41:38.545603 [debug] [ThreadPool]: Using snowflake connection "list_TRHS_staging"
[0m13:41:38.545937 [debug] [ThreadPool]: On list_TRHS_analytics: show objects in TRHS.analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS_analytics"} */;
[0m13:41:38.546190 [debug] [ThreadPool]: On list_TRHS_staging: show objects in TRHS.staging
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS_staging"} */;
[0m13:41:38.619319 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.072 seconds
[0m13:41:38.624581 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.078 seconds
[0m13:41:38.626078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ab9f677e-d210-4fbb-9a1e-005a069aa557', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaea9a060>]}
[0m13:41:38.630079 [debug] [Thread-1 (]: Began running node model.citrus_trade.stg_trade
[0m13:41:38.630555 [info ] [Thread-1 (]: 1 of 2 START sql table model staging.stg_trade ................................. [RUN]
[0m13:41:38.631039 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_TRHS_analytics, now model.citrus_trade.stg_trade)
[0m13:41:38.631419 [debug] [Thread-1 (]: Began compiling node model.citrus_trade.stg_trade
[0m13:41:38.637821 [debug] [Thread-1 (]: Writing injected SQL for node "model.citrus_trade.stg_trade"
[0m13:41:38.639353 [debug] [Thread-1 (]: Began executing node model.citrus_trade.stg_trade
[0m13:41:38.660813 [debug] [Thread-1 (]: Writing runtime sql for node "model.citrus_trade.stg_trade"
[0m13:41:38.662083 [debug] [Thread-1 (]: Using snowflake connection "model.citrus_trade.stg_trade"
[0m13:41:38.662341 [debug] [Thread-1 (]: On model.citrus_trade.stg_trade: create or replace transient table TRHS.staging.stg_trade
    
    
    
    as (select
  value:"declarant"::int as declarant,
  value:"declarant_iso"::string as declarant_iso,
  value:"partner"::string as partner,
  value:"partner_iso"::string as partner_iso,
  value:"flow"::int as flow,
  value:"transport_mode"::int as transport_mode,
  value:"period"::int as period,
  value:"hs4"::string as hs4,
  value:"hs4_name"::string as hs4_name,
  value:"hs6"::string as hs6,
  value:"hs6_name"::string as hs6_name,
  value:"value_in_euros"::float as value_in_euros,
  value:"quantity_in_kg"::float as quantity_in_kg
from trhs.staging.citrus_ext
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.stg_trade"} */;
[0m13:41:39.644897 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.982 seconds
[0m13:41:39.674236 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ab9f677e-d210-4fbb-9a1e-005a069aa557', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb12c6420>]}
[0m13:41:39.675163 [info ] [Thread-1 (]: 1 of 2 OK created sql table model staging.stg_trade ............................ [[32mSUCCESS 1[0m in 1.04s]
[0m13:41:39.675646 [debug] [Thread-1 (]: Finished running node model.citrus_trade.stg_trade
[0m13:41:39.676464 [debug] [Thread-3 (]: Began running node model.citrus_trade.trade_by_reporter
[0m13:41:39.676933 [info ] [Thread-3 (]: 2 of 2 START sql table model analytics.trade_by_reporter ....................... [RUN]
[0m13:41:39.677589 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.citrus_trade.trade_by_reporter'
[0m13:41:39.678360 [debug] [Thread-3 (]: Began compiling node model.citrus_trade.trade_by_reporter
[0m13:41:39.681782 [debug] [Thread-3 (]: Writing injected SQL for node "model.citrus_trade.trade_by_reporter"
[0m13:41:39.686449 [debug] [Thread-3 (]: Began executing node model.citrus_trade.trade_by_reporter
[0m13:41:39.689503 [debug] [Thread-3 (]: Writing runtime sql for node "model.citrus_trade.trade_by_reporter"
[0m13:41:39.696724 [debug] [Thread-3 (]: Using snowflake connection "model.citrus_trade.trade_by_reporter"
[0m13:41:39.697360 [debug] [Thread-3 (]: On model.citrus_trade.trade_by_reporter: create or replace transient table TRHS.analytics.trade_by_reporter
    
    
    
    as (select 
    declarant,
    declarant_iso,
    partner,
    partner_iso,
    flow,
    transport_mode,
    period,
    hs6,
    hs6_name,
    sum(value_in_euros) as total_value,
    sum(quantity_in_kg) as total_quantity,
    sum(value_in_euros) / nullif(sum(quantity_in_kg), 0) as price_per_kg
from TRHS.staging.stg_trade
group by 1,2,3,4,5,6,7,8
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.trade_by_reporter"} */;
[0m13:41:39.697722 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:41:41.137346 [debug] [Thread-3 (]: Snowflake adapter: Snowflake query id: 01c01435-0105-6933-0000-000420ca6781
[0m13:41:41.138222 [debug] [Thread-3 (]: Snowflake adapter: Snowflake error: 001104 (42601): SQL compilation error: error line 14 at position 4
'STG_TRADE.HS6_NAME' in select clause is neither an aggregate nor in the group by clause.
[0m13:41:41.143144 [debug] [Thread-3 (]: Database Error in model trade_by_reporter (models/analytics/trade_by_reporter.sql)
  001104 (42601): SQL compilation error: error line 14 at position 4
  'STG_TRADE.HS6_NAME' in select clause is neither an aggregate nor in the group by clause.
  compiled code at target/run/citrus_trade/models/analytics/trade_by_reporter.sql
[0m13:41:41.143629 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ab9f677e-d210-4fbb-9a1e-005a069aa557', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac548560>]}
[0m13:41:41.144011 [error] [Thread-3 (]: 2 of 2 ERROR creating sql table model analytics.trade_by_reporter .............. [[31mERROR[0m in 1.47s]
[0m13:41:41.144319 [debug] [Thread-3 (]: Finished running node model.citrus_trade.trade_by_reporter
[0m13:41:41.144640 [debug] [Thread-7 (]: Marking all children of 'model.citrus_trade.trade_by_reporter' to be skipped because of status 'error'.  Reason: Database Error in model trade_by_reporter (models/analytics/trade_by_reporter.sql)
  001104 (42601): SQL compilation error: error line 14 at position 4
  'STG_TRADE.HS6_NAME' in select clause is neither an aggregate nor in the group by clause.
  compiled code at target/run/citrus_trade/models/analytics/trade_by_reporter.sql.
[0m13:41:41.145934 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:41:41.146125 [debug] [MainThread]: Connection 'list_TRHS_staging' was left open.
[0m13:41:41.146272 [debug] [MainThread]: On list_TRHS_staging: Close
[0m13:41:41.223160 [debug] [MainThread]: Connection 'model.citrus_trade.stg_trade' was left open.
[0m13:41:41.223594 [debug] [MainThread]: On model.citrus_trade.stg_trade: Close
[0m13:41:41.357933 [debug] [MainThread]: Connection 'model.citrus_trade.trade_by_reporter' was left open.
[0m13:41:41.358346 [debug] [MainThread]: On model.citrus_trade.trade_by_reporter: Close
[0m13:41:41.473036 [info ] [MainThread]: 
[0m13:41:41.473551 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 5.92 seconds (5.92s).
[0m13:41:41.474350 [debug] [MainThread]: Command end result
[0m13:41:41.499729 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m13:41:41.501830 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m13:41:41.505793 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt/target/run_results.json
[0m13:41:41.507701 [info ] [MainThread]: 
[0m13:41:41.507958 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:41:41.508217 [info ] [MainThread]: 
[0m13:41:41.508522 [error] [MainThread]: [31mFailure in model trade_by_reporter (models/analytics/trade_by_reporter.sql)[0m
[0m13:41:41.508768 [error] [MainThread]:   Database Error in model trade_by_reporter (models/analytics/trade_by_reporter.sql)
  001104 (42601): SQL compilation error: error line 14 at position 4
  'STG_TRADE.HS6_NAME' in select clause is neither an aggregate nor in the group by clause.
  compiled code at target/run/citrus_trade/models/analytics/trade_by_reporter.sql
[0m13:41:41.508984 [info ] [MainThread]: 
[0m13:41:41.509218 [info ] [MainThread]:   compiled code at target/compiled/citrus_trade/models/analytics/trade_by_reporter.sql
[0m13:41:41.509417 [info ] [MainThread]: 
[0m13:41:41.509740 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=2
[0m13:41:41.510401 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 6.5579615, "process_in_blocks": "0", "process_kernel_time": 0.433869, "process_mem_max_rss": "164544", "process_out_blocks": "4056", "process_user_time": 1.646891}
[0m13:41:41.510659 [debug] [MainThread]: Command `dbt run` failed at 13:41:41.510611 after 6.56 seconds
[0m13:41:41.510975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0a97fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad3ee570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad22a2d0>]}
[0m13:41:41.511196 [debug] [MainThread]: Flushing usage events
[0m13:41:41.987839 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:42:18.553686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa35d6690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2f44b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3ce1160>]}


============================== 13:42:18.556610 | c2c987b2-c43e-4856-8062-e7199ab4b1d8 ==============================
[0m13:42:18.556610 [info ] [MainThread]: Running with dbt=1.10.13
[0m13:42:18.556985 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'version_check': 'True', 'log_cache_events': 'False', 'target_path': 'None', 'write_json': 'True', 'profiles_dir': '/app/dbt', 'debug': 'False', 'partial_parse': 'True', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'log_format': 'default', 'introspect': 'True', 'no_print': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'warn_error': 'None', 'use_colors': 'True', 'printer_width': '80', 'quiet': 'False', 'fail_fast': 'False', 'empty': 'False', 'log_path': '/app/dbt/logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m13:42:18.758997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c2c987b2-c43e-4856-8062-e7199ab4b1d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1bb4ef0>]}
[0m13:42:18.789632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c2c987b2-c43e-4856-8062-e7199ab4b1d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1b8e6c0>]}
[0m13:42:18.790058 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m13:42:18.838566 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m13:42:18.946582 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:42:18.946850 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:42:18.963453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c2c987b2-c43e-4856-8062-e7199ab4b1d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3614b90>]}
[0m13:42:19.008316 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m13:42:19.009655 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m13:42:19.017438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c2c987b2-c43e-4856-8062-e7199ab4b1d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa12a7d40>]}
[0m13:42:19.017695 [info ] [MainThread]: Found 2 models, 1 source, 632 macros
[0m13:42:19.017904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c2c987b2-c43e-4856-8062-e7199ab4b1d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1366630>]}
[0m13:42:19.018881 [info ] [MainThread]: 
[0m13:42:19.019088 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:42:19.019410 [info ] [MainThread]: 
[0m13:42:19.019914 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:42:19.022385 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRHS'
[0m13:42:19.029593 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRHS'
[0m13:42:19.047150 [debug] [ThreadPool]: Using snowflake connection "list_TRHS"
[0m13:42:19.047488 [debug] [ThreadPool]: Using snowflake connection "list_TRHS"
[0m13:42:19.047662 [debug] [ThreadPool]: On list_TRHS: show terse schemas in database TRHS
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS"} */
[0m13:42:19.047894 [debug] [ThreadPool]: On list_TRHS: show terse schemas in database TRHS
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS"} */
[0m13:42:19.048086 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:42:19.048301 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:42:21.844303 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2.796 seconds
[0m13:42:21.846036 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2.798 seconds
[0m13:42:21.852730 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRHS, now list_TRHS_analytics)
[0m13:42:21.860749 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRHS, now list_TRHS_staging)
[0m13:42:21.876752 [debug] [ThreadPool]: Using snowflake connection "list_TRHS_analytics"
[0m13:42:21.880929 [debug] [ThreadPool]: Using snowflake connection "list_TRHS_staging"
[0m13:42:21.881297 [debug] [ThreadPool]: On list_TRHS_analytics: show objects in TRHS.analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS_analytics"} */;
[0m13:42:21.881720 [debug] [ThreadPool]: On list_TRHS_staging: show objects in TRHS.staging
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS_staging"} */;
[0m13:42:21.953418 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.071 seconds
[0m13:42:22.001242 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.117 seconds
[0m13:42:22.006685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c2c987b2-c43e-4856-8062-e7199ab4b1d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa148adb0>]}
[0m13:42:22.012133 [debug] [Thread-1 (]: Began running node model.citrus_trade.stg_trade
[0m13:42:22.013044 [info ] [Thread-1 (]: 1 of 2 START sql table model staging.stg_trade ................................. [RUN]
[0m13:42:22.013860 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_TRHS_staging, now model.citrus_trade.stg_trade)
[0m13:42:22.014626 [debug] [Thread-1 (]: Began compiling node model.citrus_trade.stg_trade
[0m13:42:22.025465 [debug] [Thread-1 (]: Writing injected SQL for node "model.citrus_trade.stg_trade"
[0m13:42:22.026860 [debug] [Thread-1 (]: Began executing node model.citrus_trade.stg_trade
[0m13:42:22.057664 [debug] [Thread-1 (]: Writing runtime sql for node "model.citrus_trade.stg_trade"
[0m13:42:22.059111 [debug] [Thread-1 (]: Using snowflake connection "model.citrus_trade.stg_trade"
[0m13:42:22.059465 [debug] [Thread-1 (]: On model.citrus_trade.stg_trade: create or replace transient table TRHS.staging.stg_trade
    
    
    
    as (select
  value:"declarant"::int as declarant,
  value:"declarant_iso"::string as declarant_iso,
  value:"partner"::string as partner,
  value:"partner_iso"::string as partner_iso,
  value:"flow"::int as flow,
  value:"transport_mode"::int as transport_mode,
  value:"period"::int as period,
  value:"hs4"::string as hs4,
  value:"hs4_name"::string as hs4_name,
  value:"hs6"::string as hs6,
  value:"hs6_name"::string as hs6_name,
  value:"value_in_euros"::float as value_in_euros,
  value:"quantity_in_kg"::float as quantity_in_kg
from trhs.staging.citrus_ext
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.stg_trade"} */;
[0m13:42:22.849466 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.789 seconds
[0m13:42:22.884603 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c2c987b2-c43e-4856-8062-e7199ab4b1d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3cfa3c0>]}
[0m13:42:22.885583 [info ] [Thread-1 (]: 1 of 2 OK created sql table model staging.stg_trade ............................ [[32mSUCCESS 1[0m in 0.87s]
[0m13:42:22.886440 [debug] [Thread-1 (]: Finished running node model.citrus_trade.stg_trade
[0m13:42:22.887500 [debug] [Thread-3 (]: Began running node model.citrus_trade.trade_by_reporter
[0m13:42:22.888085 [info ] [Thread-3 (]: 2 of 2 START sql table model analytics.trade_by_reporter ....................... [RUN]
[0m13:42:22.888883 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.citrus_trade.trade_by_reporter'
[0m13:42:22.889304 [debug] [Thread-3 (]: Began compiling node model.citrus_trade.trade_by_reporter
[0m13:42:22.895110 [debug] [Thread-3 (]: Writing injected SQL for node "model.citrus_trade.trade_by_reporter"
[0m13:42:22.896511 [debug] [Thread-3 (]: Began executing node model.citrus_trade.trade_by_reporter
[0m13:42:22.898870 [debug] [Thread-3 (]: Writing runtime sql for node "model.citrus_trade.trade_by_reporter"
[0m13:42:22.900310 [debug] [Thread-3 (]: Using snowflake connection "model.citrus_trade.trade_by_reporter"
[0m13:42:22.900667 [debug] [Thread-3 (]: On model.citrus_trade.trade_by_reporter: create or replace transient table TRHS.analytics.trade_by_reporter
    
    
    
    as (select 
    declarant,
    declarant_iso,
    partner,
    partner_iso,
    flow,
    transport_mode,
    period,
    hs6,
    hs6_name,
    sum(value_in_euros) as total_value,
    sum(quantity_in_kg) as total_quantity,
    sum(value_in_euros) / nullif(sum(quantity_in_kg), 0) as price_per_kg
from TRHS.staging.stg_trade
group by 1,2,3,4,5,6,7,8
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.trade_by_reporter"} */;
[0m13:42:22.901024 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:42:23.304662 [debug] [Thread-3 (]: Snowflake adapter: Snowflake query id: 01c01436-0105-6933-0000-000420ca6799
[0m13:42:23.305851 [debug] [Thread-3 (]: Snowflake adapter: Snowflake error: 001104 (42601): SQL compilation error: error line 14 at position 4
'STG_TRADE.HS6_NAME' in select clause is neither an aggregate nor in the group by clause.
[0m13:42:23.311451 [debug] [Thread-3 (]: Database Error in model trade_by_reporter (models/analytics/trade_by_reporter.sql)
  001104 (42601): SQL compilation error: error line 14 at position 4
  'STG_TRADE.HS6_NAME' in select clause is neither an aggregate nor in the group by clause.
  compiled code at target/run/citrus_trade/models/analytics/trade_by_reporter.sql
[0m13:42:23.312396 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c2c987b2-c43e-4856-8062-e7199ab4b1d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa13ff320>]}
[0m13:42:23.313506 [error] [Thread-3 (]: 2 of 2 ERROR creating sql table model analytics.trade_by_reporter .............. [[31mERROR[0m in 0.42s]
[0m13:42:23.314664 [debug] [Thread-3 (]: Finished running node model.citrus_trade.trade_by_reporter
[0m13:42:23.315375 [debug] [Thread-7 (]: Marking all children of 'model.citrus_trade.trade_by_reporter' to be skipped because of status 'error'.  Reason: Database Error in model trade_by_reporter (models/analytics/trade_by_reporter.sql)
  001104 (42601): SQL compilation error: error line 14 at position 4
  'STG_TRADE.HS6_NAME' in select clause is neither an aggregate nor in the group by clause.
  compiled code at target/run/citrus_trade/models/analytics/trade_by_reporter.sql.
[0m13:42:23.317554 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:42:23.317904 [debug] [MainThread]: Connection 'list_TRHS_analytics' was left open.
[0m13:42:23.318254 [debug] [MainThread]: On list_TRHS_analytics: Close
[0m13:42:23.408730 [debug] [MainThread]: Connection 'model.citrus_trade.stg_trade' was left open.
[0m13:42:23.409701 [debug] [MainThread]: On model.citrus_trade.stg_trade: Close
[0m13:42:23.502884 [debug] [MainThread]: Connection 'model.citrus_trade.trade_by_reporter' was left open.
[0m13:42:23.504086 [debug] [MainThread]: On model.citrus_trade.trade_by_reporter: Close
[0m13:42:23.607833 [info ] [MainThread]: 
[0m13:42:23.608959 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 4.59 seconds (4.59s).
[0m13:42:23.611360 [debug] [MainThread]: Command end result
[0m13:42:23.655307 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m13:42:23.657441 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m13:42:23.662782 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt/target/run_results.json
[0m13:42:23.663044 [info ] [MainThread]: 
[0m13:42:23.663431 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:42:23.663927 [info ] [MainThread]: 
[0m13:42:23.664337 [error] [MainThread]: [31mFailure in model trade_by_reporter (models/analytics/trade_by_reporter.sql)[0m
[0m13:42:23.664690 [error] [MainThread]:   Database Error in model trade_by_reporter (models/analytics/trade_by_reporter.sql)
  001104 (42601): SQL compilation error: error line 14 at position 4
  'STG_TRADE.HS6_NAME' in select clause is neither an aggregate nor in the group by clause.
  compiled code at target/run/citrus_trade/models/analytics/trade_by_reporter.sql
[0m13:42:23.664992 [info ] [MainThread]: 
[0m13:42:23.665297 [info ] [MainThread]:   compiled code at target/compiled/citrus_trade/models/analytics/trade_by_reporter.sql
[0m13:42:23.665537 [info ] [MainThread]: 
[0m13:42:23.665840 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=2
[0m13:42:23.666819 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 5.167233, "process_in_blocks": "0", "process_kernel_time": 0.337991, "process_mem_max_rss": "161736", "process_out_blocks": "2705", "process_user_time": 1.686948}
[0m13:42:23.667181 [debug] [MainThread]: Command `dbt run` failed at 13:42:23.667087 after 5.17 seconds
[0m13:42:23.667667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2e3d9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2f44aa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa16ef3b0>]}
[0m13:42:23.667973 [debug] [MainThread]: Flushing usage events
[0m13:42:24.206260 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:42:56.556023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1829f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1078200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1079e80>]}


============================== 13:42:56.558726 | e44dacee-5e7d-4feb-ae6e-0134cec85751 ==============================
[0m13:42:56.558726 [info ] [MainThread]: Running with dbt=1.10.13
[0m13:42:56.559117 [debug] [MainThread]: running dbt with arguments {'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'log_cache_events': 'False', 'static_parser': 'True', 'no_print': 'None', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'warn_error': 'None', 'profiles_dir': '/app/dbt', 'invocation_command': 'dbt run', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'target_path': 'None', 'log_path': '/app/dbt/logs', 'write_json': 'True', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'use_colors': 'True', 'debug': 'False', 'log_format': 'default', 'introspect': 'True', 'version_check': 'True'}
[0m13:42:56.759654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e44dacee-5e7d-4feb-ae6e-0134cec85751', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f482e10>]}
[0m13:42:56.790539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e44dacee-5e7d-4feb-ae6e-0134cec85751', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1d7d220>]}
[0m13:42:56.791007 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m13:42:56.842802 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m13:42:56.952181 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:42:56.952585 [debug] [MainThread]: Partial parsing: updated file: citrus_trade://models/analytics/trade_by_reporter.sql
[0m13:42:57.079022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e44dacee-5e7d-4feb-ae6e-0134cec85751', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9edd45f0>]}
[0m13:42:57.121262 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m13:42:57.122569 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m13:42:57.130414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e44dacee-5e7d-4feb-ae6e-0134cec85751', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ee629f0>]}
[0m13:42:57.130679 [info ] [MainThread]: Found 2 models, 1 source, 632 macros
[0m13:42:57.130894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e44dacee-5e7d-4feb-ae6e-0134cec85751', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa093c620>]}
[0m13:42:57.131803 [info ] [MainThread]: 
[0m13:42:57.132010 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:42:57.132268 [info ] [MainThread]: 
[0m13:42:57.132705 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:42:57.135186 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRHS'
[0m13:42:57.140932 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRHS'
[0m13:42:57.158038 [debug] [ThreadPool]: Using snowflake connection "list_TRHS"
[0m13:42:57.158340 [debug] [ThreadPool]: Using snowflake connection "list_TRHS"
[0m13:42:57.158513 [debug] [ThreadPool]: On list_TRHS: show terse schemas in database TRHS
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS"} */
[0m13:42:57.158751 [debug] [ThreadPool]: On list_TRHS: show terse schemas in database TRHS
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS"} */
[0m13:42:57.158951 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:42:57.159146 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:42:57.896158 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.737 seconds
[0m13:42:57.904342 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.745 seconds
[0m13:42:57.908630 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRHS, now list_TRHS_staging)
[0m13:42:57.915138 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRHS, now list_TRHS_analytics)
[0m13:42:57.933332 [debug] [ThreadPool]: Using snowflake connection "list_TRHS_staging"
[0m13:42:57.937143 [debug] [ThreadPool]: Using snowflake connection "list_TRHS_analytics"
[0m13:42:57.937452 [debug] [ThreadPool]: On list_TRHS_staging: show objects in TRHS.staging
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS_staging"} */;
[0m13:42:57.937891 [debug] [ThreadPool]: On list_TRHS_analytics: show objects in TRHS.analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS_analytics"} */;
[0m13:42:58.051184 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.111 seconds
[0m13:42:58.066025 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.128 seconds
[0m13:42:58.071614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e44dacee-5e7d-4feb-ae6e-0134cec85751', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f1c1460>]}
[0m13:42:58.076422 [debug] [Thread-1 (]: Began running node model.citrus_trade.stg_trade
[0m13:42:58.077308 [info ] [Thread-1 (]: 1 of 2 START sql table model staging.stg_trade ................................. [RUN]
[0m13:42:58.078247 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_TRHS_staging, now model.citrus_trade.stg_trade)
[0m13:42:58.078928 [debug] [Thread-1 (]: Began compiling node model.citrus_trade.stg_trade
[0m13:42:58.089478 [debug] [Thread-1 (]: Writing injected SQL for node "model.citrus_trade.stg_trade"
[0m13:42:58.090983 [debug] [Thread-1 (]: Began executing node model.citrus_trade.stg_trade
[0m13:42:58.120714 [debug] [Thread-1 (]: Writing runtime sql for node "model.citrus_trade.stg_trade"
[0m13:42:58.122169 [debug] [Thread-1 (]: Using snowflake connection "model.citrus_trade.stg_trade"
[0m13:42:58.122463 [debug] [Thread-1 (]: On model.citrus_trade.stg_trade: create or replace transient table TRHS.staging.stg_trade
    
    
    
    as (select
  value:"declarant"::int as declarant,
  value:"declarant_iso"::string as declarant_iso,
  value:"partner"::string as partner,
  value:"partner_iso"::string as partner_iso,
  value:"flow"::int as flow,
  value:"transport_mode"::int as transport_mode,
  value:"period"::int as period,
  value:"hs4"::string as hs4,
  value:"hs4_name"::string as hs4_name,
  value:"hs6"::string as hs6,
  value:"hs6_name"::string as hs6_name,
  value:"value_in_euros"::float as value_in_euros,
  value:"quantity_in_kg"::float as quantity_in_kg
from trhs.staging.citrus_ext
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.stg_trade"} */;
[0m13:42:58.905220 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.782 seconds
[0m13:42:58.942389 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e44dacee-5e7d-4feb-ae6e-0134cec85751', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d4a4b30>]}
[0m13:42:58.943396 [info ] [Thread-1 (]: 1 of 2 OK created sql table model staging.stg_trade ............................ [[32mSUCCESS 1[0m in 0.86s]
[0m13:42:58.944017 [debug] [Thread-1 (]: Finished running node model.citrus_trade.stg_trade
[0m13:42:58.945088 [debug] [Thread-3 (]: Began running node model.citrus_trade.trade_by_reporter
[0m13:42:58.945646 [info ] [Thread-3 (]: 2 of 2 START sql table model analytics.trade_by_reporter ....................... [RUN]
[0m13:42:58.946260 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.citrus_trade.trade_by_reporter'
[0m13:42:58.946647 [debug] [Thread-3 (]: Began compiling node model.citrus_trade.trade_by_reporter
[0m13:42:58.950052 [debug] [Thread-3 (]: Writing injected SQL for node "model.citrus_trade.trade_by_reporter"
[0m13:42:58.951331 [debug] [Thread-3 (]: Began executing node model.citrus_trade.trade_by_reporter
[0m13:42:58.953874 [debug] [Thread-3 (]: Writing runtime sql for node "model.citrus_trade.trade_by_reporter"
[0m13:42:58.955147 [debug] [Thread-3 (]: Using snowflake connection "model.citrus_trade.trade_by_reporter"
[0m13:42:58.955461 [debug] [Thread-3 (]: On model.citrus_trade.trade_by_reporter: create or replace transient table TRHS.analytics.trade_by_reporter
    
    
    
    as (select 
    declarant,
    declarant_iso,
    partner,
    partner_iso,
    flow,
    transport_mode,
    period,
    hs6,
    hs6_name,
    sum(value_in_euros) as total_value,
    sum(quantity_in_kg) as total_quantity,
    sum(value_in_euros) / nullif(sum(quantity_in_kg), 0) as price_per_kg
from TRHS.staging.stg_trade
group by 1,2,3,4,5,6,7,8,9
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.trade_by_reporter"} */;
[0m13:42:58.955734 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:42:59.942432 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.986 seconds
[0m13:42:59.947245 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e44dacee-5e7d-4feb-ae6e-0134cec85751', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96bddaf0>]}
[0m13:42:59.949044 [info ] [Thread-3 (]: 2 of 2 OK created sql table model analytics.trade_by_reporter .................. [[32mSUCCESS 1[0m in 1.00s]
[0m13:42:59.950315 [debug] [Thread-3 (]: Finished running node model.citrus_trade.trade_by_reporter
[0m13:42:59.952928 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:42:59.953504 [debug] [MainThread]: Connection 'list_TRHS_analytics' was left open.
[0m13:42:59.954048 [debug] [MainThread]: On list_TRHS_analytics: Close
[0m13:43:00.214674 [debug] [MainThread]: Connection 'model.citrus_trade.stg_trade' was left open.
[0m13:43:00.216408 [debug] [MainThread]: On model.citrus_trade.stg_trade: Close
[0m13:43:00.328968 [debug] [MainThread]: Connection 'model.citrus_trade.trade_by_reporter' was left open.
[0m13:43:00.330249 [debug] [MainThread]: On model.citrus_trade.trade_by_reporter: Close
[0m13:43:00.492674 [info ] [MainThread]: 
[0m13:43:00.493625 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 3.36 seconds (3.36s).
[0m13:43:00.495210 [debug] [MainThread]: Command end result
[0m13:43:00.529233 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m13:43:00.531542 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m13:43:00.537635 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt/target/run_results.json
[0m13:43:00.537943 [info ] [MainThread]: 
[0m13:43:00.538442 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:43:00.539278 [info ] [MainThread]: 
[0m13:43:00.540219 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m13:43:00.542624 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.0182357, "process_in_blocks": "0", "process_kernel_time": 0.291376, "process_mem_max_rss": "159104", "process_out_blocks": "4052", "process_user_time": 1.738214}
[0m13:43:00.544416 [debug] [MainThread]: Command `dbt run` succeeded at 13:43:00.544086 after 4.02 seconds
[0m13:43:00.544969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ede43b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9edd6de0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9fbcedb0>]}
[0m13:43:00.545382 [debug] [MainThread]: Flushing usage events
[0m13:43:01.041045 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:44:05.736664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7adf9640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7adfa1e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7a6d2a50>]}


============================== 13:44:05.739707 | d0324640-2042-4a86-b398-3544da5b37b0 ==============================
[0m13:44:05.739707 [info ] [MainThread]: Running with dbt=1.10.13
[0m13:44:05.740048 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'debug': 'False', 'fail_fast': 'False', 'target_path': 'None', 'use_colors': 'True', 'profiles_dir': '/app/dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True', 'invocation_command': 'dbt run', 'warn_error': 'None', 'log_cache_events': 'False', 'partial_parse': 'True', 'no_print': 'None', 'version_check': 'True', 'quiet': 'False', 'printer_width': '80', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'static_parser': 'True', 'indirect_selection': 'eager', 'log_path': '/app/dbt/logs', 'cache_selected_only': 'False', 'empty': 'False'}
[0m13:44:05.949391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd0324640-2042-4a86-b398-3544da5b37b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff78a9a450>]}
[0m13:44:05.980224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd0324640-2042-4a86-b398-3544da5b37b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff791f19d0>]}
[0m13:44:05.980754 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m13:44:06.032258 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m13:44:06.140099 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:44:06.140500 [debug] [MainThread]: Partial parsing: updated file: citrus_trade://models/analytics/trade_by_reporter.sql
[0m13:44:06.267927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd0324640-2042-4a86-b398-3544da5b37b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7843ecf0>]}
[0m13:44:06.310642 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m13:44:06.312087 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m13:44:06.322250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd0324640-2042-4a86-b398-3544da5b37b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff785fb530>]}
[0m13:44:06.322618 [info ] [MainThread]: Found 2 models, 1 source, 632 macros
[0m13:44:06.322860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd0324640-2042-4a86-b398-3544da5b37b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff784f8620>]}
[0m13:44:06.323849 [info ] [MainThread]: 
[0m13:44:06.324090 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:44:06.324345 [info ] [MainThread]: 
[0m13:44:06.324719 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:44:06.327099 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRHS'
[0m13:44:06.333397 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRHS'
[0m13:44:06.351469 [debug] [ThreadPool]: Using snowflake connection "list_TRHS"
[0m13:44:06.351769 [debug] [ThreadPool]: Using snowflake connection "list_TRHS"
[0m13:44:06.351942 [debug] [ThreadPool]: On list_TRHS: show terse schemas in database TRHS
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS"} */
[0m13:44:06.352183 [debug] [ThreadPool]: On list_TRHS: show terse schemas in database TRHS
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS"} */
[0m13:44:06.352374 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:44:06.352561 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:44:09.248387 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2.896 seconds
[0m13:44:09.250069 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2.897 seconds
[0m13:44:09.256970 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRHS, now list_TRHS_staging)
[0m13:44:09.263528 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRHS, now list_TRHS_analytics)
[0m13:44:09.285178 [debug] [ThreadPool]: Using snowflake connection "list_TRHS_analytics"
[0m13:44:09.285573 [debug] [ThreadPool]: Using snowflake connection "list_TRHS_staging"
[0m13:44:09.285909 [debug] [ThreadPool]: On list_TRHS_analytics: show objects in TRHS.analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS_analytics"} */;
[0m13:44:09.286323 [debug] [ThreadPool]: On list_TRHS_staging: show objects in TRHS.staging
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS_staging"} */;
[0m13:44:09.361178 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.074 seconds
[0m13:44:09.374621 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.087 seconds
[0m13:44:09.379006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd0324640-2042-4a86-b398-3544da5b37b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7a6758e0>]}
[0m13:44:09.384537 [debug] [Thread-1 (]: Began running node model.citrus_trade.stg_trade
[0m13:44:09.385305 [info ] [Thread-1 (]: 1 of 2 START sql table model staging.stg_trade ................................. [RUN]
[0m13:44:09.386543 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_TRHS_staging, now model.citrus_trade.stg_trade)
[0m13:44:09.387063 [debug] [Thread-1 (]: Began compiling node model.citrus_trade.stg_trade
[0m13:44:09.397773 [debug] [Thread-1 (]: Writing injected SQL for node "model.citrus_trade.stg_trade"
[0m13:44:09.399523 [debug] [Thread-1 (]: Began executing node model.citrus_trade.stg_trade
[0m13:44:09.427548 [debug] [Thread-1 (]: Writing runtime sql for node "model.citrus_trade.stg_trade"
[0m13:44:09.429068 [debug] [Thread-1 (]: Using snowflake connection "model.citrus_trade.stg_trade"
[0m13:44:09.429422 [debug] [Thread-1 (]: On model.citrus_trade.stg_trade: create or replace transient table TRHS.staging.stg_trade
    
    
    
    as (select
  value:"declarant"::int as declarant,
  value:"declarant_iso"::string as declarant_iso,
  value:"partner"::string as partner,
  value:"partner_iso"::string as partner_iso,
  value:"flow"::int as flow,
  value:"transport_mode"::int as transport_mode,
  value:"period"::int as period,
  value:"hs4"::string as hs4,
  value:"hs4_name"::string as hs4_name,
  value:"hs6"::string as hs6,
  value:"hs6_name"::string as hs6_name,
  value:"value_in_euros"::float as value_in_euros,
  value:"quantity_in_kg"::float as quantity_in_kg
from trhs.staging.citrus_ext
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.stg_trade"} */;
[0m13:44:10.349992 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.920 seconds
[0m13:44:10.384232 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd0324640-2042-4a86-b398-3544da5b37b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c7857c0>]}
[0m13:44:10.385280 [info ] [Thread-1 (]: 1 of 2 OK created sql table model staging.stg_trade ............................ [[32mSUCCESS 1[0m in 1.00s]
[0m13:44:10.385993 [debug] [Thread-1 (]: Finished running node model.citrus_trade.stg_trade
[0m13:44:10.387099 [debug] [Thread-3 (]: Began running node model.citrus_trade.trade_by_reporter
[0m13:44:10.387637 [info ] [Thread-3 (]: 2 of 2 START sql table model analytics.trade_by_reporter ....................... [RUN]
[0m13:44:10.388327 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.citrus_trade.trade_by_reporter'
[0m13:44:10.388693 [debug] [Thread-3 (]: Began compiling node model.citrus_trade.trade_by_reporter
[0m13:44:10.394399 [debug] [Thread-3 (]: Writing injected SQL for node "model.citrus_trade.trade_by_reporter"
[0m13:44:10.395775 [debug] [Thread-3 (]: Began executing node model.citrus_trade.trade_by_reporter
[0m13:44:10.398200 [debug] [Thread-3 (]: Writing runtime sql for node "model.citrus_trade.trade_by_reporter"
[0m13:44:10.399570 [debug] [Thread-3 (]: Using snowflake connection "model.citrus_trade.trade_by_reporter"
[0m13:44:10.399915 [debug] [Thread-3 (]: On model.citrus_trade.trade_by_reporter: create or replace transient table TRHS.analytics.trade_by_reporter
    
    
    
    as (select 
    declarant,
    declarant_iso,
    partner,
    partner_iso,
    flow,
    transport_mode,
    period,
    hs6,
    hs6_name,
    sum(value_in_euros) as total_value,
    sum(quantity_in_kg) as total_quantity,
    sum(value_in_euros) / nullif(sum(quantity_in_kg), 0) as price_per_kg
from TRHS.staging.stg_trade
group by 1,2,3,4,5,6,7,8
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.trade_by_reporter"} */;
[0m13:44:10.400258 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:44:10.807196 [debug] [Thread-3 (]: Snowflake adapter: Snowflake query id: 01c01438-0105-6933-0000-000420ca69b5
[0m13:44:10.808333 [debug] [Thread-3 (]: Snowflake adapter: Snowflake error: 001104 (42601): SQL compilation error: error line 14 at position 4
'STG_TRADE.HS6_NAME' in select clause is neither an aggregate nor in the group by clause.
[0m13:44:10.814696 [debug] [Thread-3 (]: Database Error in model trade_by_reporter (models/analytics/trade_by_reporter.sql)
  001104 (42601): SQL compilation error: error line 14 at position 4
  'STG_TRADE.HS6_NAME' in select clause is neither an aggregate nor in the group by clause.
  compiled code at target/run/citrus_trade/models/analytics/trade_by_reporter.sql
[0m13:44:10.815846 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd0324640-2042-4a86-b398-3544da5b37b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff74d8c560>]}
[0m13:44:10.817004 [error] [Thread-3 (]: 2 of 2 ERROR creating sql table model analytics.trade_by_reporter .............. [[31mERROR[0m in 0.43s]
[0m13:44:10.818281 [debug] [Thread-3 (]: Finished running node model.citrus_trade.trade_by_reporter
[0m13:44:10.819389 [debug] [Thread-7 (]: Marking all children of 'model.citrus_trade.trade_by_reporter' to be skipped because of status 'error'.  Reason: Database Error in model trade_by_reporter (models/analytics/trade_by_reporter.sql)
  001104 (42601): SQL compilation error: error line 14 at position 4
  'STG_TRADE.HS6_NAME' in select clause is neither an aggregate nor in the group by clause.
  compiled code at target/run/citrus_trade/models/analytics/trade_by_reporter.sql.
[0m13:44:10.822662 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:44:10.823106 [debug] [MainThread]: Connection 'list_TRHS_analytics' was left open.
[0m13:44:10.823616 [debug] [MainThread]: On list_TRHS_analytics: Close
[0m13:44:10.924632 [debug] [MainThread]: Connection 'model.citrus_trade.stg_trade' was left open.
[0m13:44:10.926085 [debug] [MainThread]: On model.citrus_trade.stg_trade: Close
[0m13:44:11.032244 [debug] [MainThread]: Connection 'model.citrus_trade.trade_by_reporter' was left open.
[0m13:44:11.033336 [debug] [MainThread]: On model.citrus_trade.trade_by_reporter: Close
[0m13:44:11.216294 [info ] [MainThread]: 
[0m13:44:11.216707 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 4.89 seconds (4.89s).
[0m13:44:11.217451 [debug] [MainThread]: Command end result
[0m13:44:11.239405 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m13:44:11.240842 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m13:44:11.244498 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt/target/run_results.json
[0m13:44:11.244710 [info ] [MainThread]: 
[0m13:44:11.245018 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:44:11.245348 [info ] [MainThread]: 
[0m13:44:11.245677 [error] [MainThread]: [31mFailure in model trade_by_reporter (models/analytics/trade_by_reporter.sql)[0m
[0m13:44:11.246018 [error] [MainThread]:   Database Error in model trade_by_reporter (models/analytics/trade_by_reporter.sql)
  001104 (42601): SQL compilation error: error line 14 at position 4
  'STG_TRADE.HS6_NAME' in select clause is neither an aggregate nor in the group by clause.
  compiled code at target/run/citrus_trade/models/analytics/trade_by_reporter.sql
[0m13:44:11.246231 [info ] [MainThread]: 
[0m13:44:11.246549 [info ] [MainThread]:   compiled code at target/compiled/citrus_trade/models/analytics/trade_by_reporter.sql
[0m13:44:11.246778 [info ] [MainThread]: 
[0m13:44:11.247026 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=2
[0m13:44:11.247859 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 5.5409303, "process_in_blocks": "0", "process_kernel_time": 0.450107, "process_mem_max_rss": "164148", "process_out_blocks": "4056", "process_user_time": 1.744166}
[0m13:44:11.248198 [debug] [MainThread]: Command `dbt run` failed at 13:44:11.248120 after 5.54 seconds
[0m13:44:11.248435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7a426f00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff791cec90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff78426b70>]}
[0m13:44:11.248648 [debug] [MainThread]: Flushing usage events
[0m13:44:11.739638 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:44:18.955642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff951cf5c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92bc2960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92b33e60>]}


============================== 13:44:18.958643 | d65338f2-96fc-4032-a94b-24e6d108729a ==============================
[0m13:44:18.958643 [info ] [MainThread]: Running with dbt=1.10.13
[0m13:44:18.958982 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '/app/dbt', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'static_parser': 'True', 'log_path': '/app/dbt/logs', 'partial_parse': 'True', 'log_format': 'default', 'printer_width': '80', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True', 'fail_fast': 'False', 'no_print': 'None', 'target_path': 'None', 'cache_selected_only': 'False', 'quiet': 'False', 'warn_error': 'None', 'write_json': 'True', 'empty': 'False', 'use_colors': 'True', 'invocation_command': 'dbt run'}
[0m13:44:19.180993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd65338f2-96fc-4032-a94b-24e6d108729a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92de10d0>]}
[0m13:44:19.212632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd65338f2-96fc-4032-a94b-24e6d108729a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90f06540>]}
[0m13:44:19.213240 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m13:44:19.261773 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m13:44:19.369350 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:44:19.369773 [debug] [MainThread]: Partial parsing: updated file: citrus_trade://models/analytics/trade_by_reporter.sql
[0m13:44:19.499945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd65338f2-96fc-4032-a94b-24e6d108729a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90a8ea50>]}
[0m13:44:19.545057 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m13:44:19.546482 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m13:44:19.554305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd65338f2-96fc-4032-a94b-24e6d108729a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90b0a8a0>]}
[0m13:44:19.554581 [info ] [MainThread]: Found 2 models, 1 source, 632 macros
[0m13:44:19.554759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd65338f2-96fc-4032-a94b-24e6d108729a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90a7c320>]}
[0m13:44:19.555754 [info ] [MainThread]: 
[0m13:44:19.556044 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:44:19.556316 [info ] [MainThread]: 
[0m13:44:19.556728 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:44:19.559479 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRHS'
[0m13:44:19.565553 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRHS'
[0m13:44:19.583821 [debug] [ThreadPool]: Using snowflake connection "list_TRHS"
[0m13:44:19.584131 [debug] [ThreadPool]: Using snowflake connection "list_TRHS"
[0m13:44:19.584321 [debug] [ThreadPool]: On list_TRHS: show terse schemas in database TRHS
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS"} */
[0m13:44:19.584541 [debug] [ThreadPool]: On list_TRHS: show terse schemas in database TRHS
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS"} */
[0m13:44:19.584720 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:44:19.584902 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:44:20.057061 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.472 seconds
[0m13:44:20.996461 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.411 seconds
[0m13:44:21.003052 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRHS, now list_TRHS_staging)
[0m13:44:21.004189 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRHS, now list_TRHS_analytics)
[0m13:44:21.029085 [debug] [ThreadPool]: Using snowflake connection "list_TRHS_staging"
[0m13:44:21.033524 [debug] [ThreadPool]: Using snowflake connection "list_TRHS_analytics"
[0m13:44:21.033897 [debug] [ThreadPool]: On list_TRHS_staging: show objects in TRHS.staging
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS_staging"} */;
[0m13:44:21.034327 [debug] [ThreadPool]: On list_TRHS_analytics: show objects in TRHS.analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS_analytics"} */;
[0m13:44:21.120224 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.085 seconds
[0m13:44:21.148973 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.113 seconds
[0m13:44:21.150432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd65338f2-96fc-4032-a94b-24e6d108729a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94ef9730>]}
[0m13:44:21.153985 [debug] [Thread-1 (]: Began running node model.citrus_trade.stg_trade
[0m13:44:21.154415 [info ] [Thread-1 (]: 1 of 2 START sql table model staging.stg_trade ................................. [RUN]
[0m13:44:21.154732 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_TRHS_staging, now model.citrus_trade.stg_trade)
[0m13:44:21.154972 [debug] [Thread-1 (]: Began compiling node model.citrus_trade.stg_trade
[0m13:44:21.159498 [debug] [Thread-1 (]: Writing injected SQL for node "model.citrus_trade.stg_trade"
[0m13:44:21.160376 [debug] [Thread-1 (]: Began executing node model.citrus_trade.stg_trade
[0m13:44:21.177816 [debug] [Thread-1 (]: Writing runtime sql for node "model.citrus_trade.stg_trade"
[0m13:44:21.179053 [debug] [Thread-1 (]: Using snowflake connection "model.citrus_trade.stg_trade"
[0m13:44:21.179290 [debug] [Thread-1 (]: On model.citrus_trade.stg_trade: create or replace transient table TRHS.staging.stg_trade
    
    
    
    as (select
  value:"declarant"::int as declarant,
  value:"declarant_iso"::string as declarant_iso,
  value:"partner"::string as partner,
  value:"partner_iso"::string as partner_iso,
  value:"flow"::int as flow,
  value:"transport_mode"::int as transport_mode,
  value:"period"::int as period,
  value:"hs4"::string as hs4,
  value:"hs4_name"::string as hs4_name,
  value:"hs6"::string as hs6,
  value:"hs6_name"::string as hs6_name,
  value:"value_in_euros"::float as value_in_euros,
  value:"quantity_in_kg"::float as quantity_in_kg
from trhs.staging.citrus_ext
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.stg_trade"} */;
[0m13:44:21.964842 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.785 seconds
[0m13:44:21.994594 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd65338f2-96fc-4032-a94b-24e6d108729a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94e216d0>]}
[0m13:44:21.995651 [info ] [Thread-1 (]: 1 of 2 OK created sql table model staging.stg_trade ............................ [[32mSUCCESS 1[0m in 0.84s]
[0m13:44:21.996493 [debug] [Thread-1 (]: Finished running node model.citrus_trade.stg_trade
[0m13:44:21.997672 [debug] [Thread-3 (]: Began running node model.citrus_trade.trade_by_reporter
[0m13:44:21.998361 [info ] [Thread-3 (]: 2 of 2 START sql table model analytics.trade_by_reporter ....................... [RUN]
[0m13:44:21.999176 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.citrus_trade.trade_by_reporter'
[0m13:44:21.999625 [debug] [Thread-3 (]: Began compiling node model.citrus_trade.trade_by_reporter
[0m13:44:22.005106 [debug] [Thread-3 (]: Writing injected SQL for node "model.citrus_trade.trade_by_reporter"
[0m13:44:22.006512 [debug] [Thread-3 (]: Began executing node model.citrus_trade.trade_by_reporter
[0m13:44:22.009096 [debug] [Thread-3 (]: Writing runtime sql for node "model.citrus_trade.trade_by_reporter"
[0m13:44:22.010690 [debug] [Thread-3 (]: Using snowflake connection "model.citrus_trade.trade_by_reporter"
[0m13:44:22.011101 [debug] [Thread-3 (]: On model.citrus_trade.trade_by_reporter: create or replace transient table TRHS.analytics.trade_by_reporter
    
    
    
    as (select 
    declarant,
    declarant_iso,
    partner,
    partner_iso,
    flow,
    transport_mode,
    period,
    hs6,
    hs6_name,
    sum(value_in_euros) as total_value,
    sum(quantity_in_kg) as total_quantity,
    sum(value_in_euros) / nullif(sum(quantity_in_kg), 0) as price_per_kg
from TRHS.staging.stg_trade
group by 1,2,3,4,5,6,7,8,9
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.trade_by_reporter"} */;
[0m13:44:22.011514 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:44:23.637749 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.625 seconds
[0m13:44:23.645568 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd65338f2-96fc-4032-a94b-24e6d108729a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f256d50>]}
[0m13:44:23.647477 [info ] [Thread-3 (]: 2 of 2 OK created sql table model analytics.trade_by_reporter .................. [[32mSUCCESS 1[0m in 1.65s]
[0m13:44:23.648592 [debug] [Thread-3 (]: Finished running node model.citrus_trade.trade_by_reporter
[0m13:44:23.651375 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:44:23.651955 [debug] [MainThread]: Connection 'list_TRHS_analytics' was left open.
[0m13:44:23.652541 [debug] [MainThread]: On list_TRHS_analytics: Close
[0m13:44:23.800445 [debug] [MainThread]: Connection 'model.citrus_trade.stg_trade' was left open.
[0m13:44:23.801525 [debug] [MainThread]: On model.citrus_trade.stg_trade: Close
[0m13:44:24.487120 [debug] [MainThread]: Connection 'model.citrus_trade.trade_by_reporter' was left open.
[0m13:44:24.488647 [debug] [MainThread]: On model.citrus_trade.trade_by_reporter: Close
[0m13:44:24.597300 [info ] [MainThread]: 
[0m13:44:24.598916 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 5.04 seconds (5.04s).
[0m13:44:24.600807 [debug] [MainThread]: Command end result
[0m13:44:24.648923 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m13:44:24.651042 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m13:44:24.655841 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt/target/run_results.json
[0m13:44:24.656086 [info ] [MainThread]: 
[0m13:44:24.656384 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:44:24.656782 [info ] [MainThread]: 
[0m13:44:24.657153 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m13:44:24.658063 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.733827, "process_in_blocks": "0", "process_kernel_time": 0.303581, "process_mem_max_rss": "159308", "process_out_blocks": "4052", "process_user_time": 1.735606}
[0m13:44:24.658441 [debug] [MainThread]: Command `dbt run` succeeded at 13:44:24.658363 after 5.73 seconds
[0m13:44:24.658698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92cce690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93420800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff934211c0>]}
[0m13:44:24.658919 [debug] [MainThread]: Flushing usage events
[0m13:44:25.144020 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:45:49.340287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb54abf80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5908bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5890b30>]}


============================== 13:45:49.343552 | 04167d60-1d51-4c8f-b1e7-cdc9fb2622ce ==============================
[0m13:45:49.343552 [info ] [MainThread]: Running with dbt=1.10.13
[0m13:45:49.343898 [debug] [MainThread]: running dbt with arguments {'empty': 'False', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'quiet': 'False', 'partial_parse': 'True', 'write_json': 'True', 'version_check': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'warn_error': 'None', 'profiles_dir': '/app/dbt', 'send_anonymous_usage_stats': 'True', 'invocation_command': 'dbt run', 'no_print': 'None', 'introspect': 'True', 'log_cache_events': 'False', 'debug': 'False', 'cache_selected_only': 'False', 'log_path': '/app/dbt/logs', 'printer_width': '80', 'use_colors': 'True', 'log_format': 'default', 'fail_fast': 'False', 'target_path': 'None'}
[0m13:45:49.555652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '04167d60-1d51-4c8f-b1e7-cdc9fb2622ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb392fa40>]}
[0m13:45:49.588830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '04167d60-1d51-4c8f-b1e7-cdc9fb2622ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3944410>]}
[0m13:45:49.589381 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m13:45:49.640321 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m13:45:49.752414 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:45:49.752842 [debug] [MainThread]: Partial parsing: updated file: citrus_trade://models/analytics/trade_by_reporter.sql
[0m13:45:49.880717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '04167d60-1d51-4c8f-b1e7-cdc9fb2622ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb331b920>]}
[0m13:45:49.922840 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m13:45:49.924250 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m13:45:49.934886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '04167d60-1d51-4c8f-b1e7-cdc9fb2622ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb346a870>]}
[0m13:45:49.935297 [info ] [MainThread]: Found 2 models, 1 source, 632 macros
[0m13:45:49.935553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '04167d60-1d51-4c8f-b1e7-cdc9fb2622ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3317c50>]}
[0m13:45:49.936555 [info ] [MainThread]: 
[0m13:45:49.936805 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:45:49.937056 [info ] [MainThread]: 
[0m13:45:49.937466 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:45:49.940084 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRHS'
[0m13:45:49.946126 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRHS'
[0m13:45:49.965140 [debug] [ThreadPool]: Using snowflake connection "list_TRHS"
[0m13:45:49.965445 [debug] [ThreadPool]: Using snowflake connection "list_TRHS"
[0m13:45:49.965620 [debug] [ThreadPool]: On list_TRHS: show terse schemas in database TRHS
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS"} */
[0m13:45:49.965887 [debug] [ThreadPool]: On list_TRHS: show terse schemas in database TRHS
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS"} */
[0m13:45:49.966082 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:45:49.966277 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:45:51.791858 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.825 seconds
[0m13:45:51.793672 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.827 seconds
[0m13:45:51.801459 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRHS, now list_TRHS_staging)
[0m13:45:51.808339 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRHS, now list_TRHS_analytics)
[0m13:45:51.819188 [debug] [ThreadPool]: Using snowflake connection "list_TRHS_staging"
[0m13:45:51.821816 [debug] [ThreadPool]: Using snowflake connection "list_TRHS_analytics"
[0m13:45:51.822297 [debug] [ThreadPool]: On list_TRHS_staging: show objects in TRHS.staging
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS_staging"} */;
[0m13:45:51.822746 [debug] [ThreadPool]: On list_TRHS_analytics: show objects in TRHS.analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS_analytics"} */;
[0m13:45:51.921208 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.096 seconds
[0m13:45:51.922997 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.100 seconds
[0m13:45:51.929762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '04167d60-1d51-4c8f-b1e7-cdc9fb2622ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb785d730>]}
[0m13:45:51.936481 [debug] [Thread-1 (]: Began running node model.citrus_trade.stg_trade
[0m13:45:51.937276 [info ] [Thread-1 (]: 1 of 2 START sql table model staging.stg_trade ................................. [RUN]
[0m13:45:51.938139 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_TRHS_staging, now model.citrus_trade.stg_trade)
[0m13:45:51.938772 [debug] [Thread-1 (]: Began compiling node model.citrus_trade.stg_trade
[0m13:45:51.949161 [debug] [Thread-1 (]: Writing injected SQL for node "model.citrus_trade.stg_trade"
[0m13:45:51.950974 [debug] [Thread-1 (]: Began executing node model.citrus_trade.stg_trade
[0m13:45:51.979455 [debug] [Thread-1 (]: Writing runtime sql for node "model.citrus_trade.stg_trade"
[0m13:45:51.981031 [debug] [Thread-1 (]: Using snowflake connection "model.citrus_trade.stg_trade"
[0m13:45:51.981381 [debug] [Thread-1 (]: On model.citrus_trade.stg_trade: create or replace transient table TRHS.staging.stg_trade
    
    
    
    as (select
  value:"declarant"::int as declarant,
  value:"declarant_iso"::string as declarant_iso,
  value:"partner"::string as partner,
  value:"partner_iso"::string as partner_iso,
  value:"flow"::int as flow,
  value:"transport_mode"::int as transport_mode,
  value:"period"::int as period,
  value:"hs4"::string as hs4,
  value:"hs4_name"::string as hs4_name,
  value:"hs6"::string as hs6,
  value:"hs6_name"::string as hs6_name,
  value:"value_in_euros"::float as value_in_euros,
  value:"quantity_in_kg"::float as quantity_in_kg
from trhs.staging.citrus_ext
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.stg_trade"} */;
[0m13:45:52.895991 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.914 seconds
[0m13:45:52.932259 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '04167d60-1d51-4c8f-b1e7-cdc9fb2622ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5df6360>]}
[0m13:45:52.933153 [info ] [Thread-1 (]: 1 of 2 OK created sql table model staging.stg_trade ............................ [[32mSUCCESS 1[0m in 0.99s]
[0m13:45:52.933886 [debug] [Thread-1 (]: Finished running node model.citrus_trade.stg_trade
[0m13:45:52.934956 [debug] [Thread-3 (]: Began running node model.citrus_trade.trade_by_reporter
[0m13:45:52.935465 [info ] [Thread-3 (]: 2 of 2 START sql table model analytics.trade_by_reporter ....................... [RUN]
[0m13:45:52.936131 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.citrus_trade.trade_by_reporter'
[0m13:45:52.936548 [debug] [Thread-3 (]: Began compiling node model.citrus_trade.trade_by_reporter
[0m13:45:52.940057 [debug] [Thread-3 (]: Writing injected SQL for node "model.citrus_trade.trade_by_reporter"
[0m13:45:52.942187 [debug] [Thread-3 (]: Began executing node model.citrus_trade.trade_by_reporter
[0m13:45:52.944569 [debug] [Thread-3 (]: Writing runtime sql for node "model.citrus_trade.trade_by_reporter"
[0m13:45:52.945913 [debug] [Thread-3 (]: Using snowflake connection "model.citrus_trade.trade_by_reporter"
[0m13:45:52.946259 [debug] [Thread-3 (]: On model.citrus_trade.trade_by_reporter: create or replace transient table TRHS.analytics.trade_by_reporter
    
    
    
    as (select 
    declarant,
    declarant_iso,
    partner,
    partner_iso,
    flow,
    transport_mode,
    period,
    hs6,
    hs6_name,
    sum(value_in_euros) as total_value,
    sum(quantity_in_kg) as total_quantity,
    sum(value_in_euros) / nullif(sum(quantity_in_kg), 0) as price_per_kg
from TRHS.staging.stg_trade
group by 1,2,3,4,5,6,7,8,9
-- group by 1,2,3,4,5,6,7,8,9
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.trade_by_reporter"} */;
[0m13:45:52.946563 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:45:53.917876 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.971 seconds
[0m13:45:53.922322 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '04167d60-1d51-4c8f-b1e7-cdc9fb2622ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1cb95e0>]}
[0m13:45:53.923489 [info ] [Thread-3 (]: 2 of 2 OK created sql table model analytics.trade_by_reporter .................. [[32mSUCCESS 1[0m in 0.99s]
[0m13:45:53.924254 [debug] [Thread-3 (]: Finished running node model.citrus_trade.trade_by_reporter
[0m13:45:53.926448 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:45:53.926810 [debug] [MainThread]: Connection 'model.citrus_trade.stg_trade' was left open.
[0m13:45:53.927190 [debug] [MainThread]: On model.citrus_trade.stg_trade: Close
[0m13:45:54.056915 [debug] [MainThread]: Connection 'list_TRHS_analytics' was left open.
[0m13:45:54.057907 [debug] [MainThread]: On list_TRHS_analytics: Close
[0m13:45:54.162835 [debug] [MainThread]: Connection 'model.citrus_trade.trade_by_reporter' was left open.
[0m13:45:54.164462 [debug] [MainThread]: On model.citrus_trade.trade_by_reporter: Close
[0m13:45:54.260247 [info ] [MainThread]: 
[0m13:45:54.261468 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 4.32 seconds (4.32s).
[0m13:45:54.263749 [debug] [MainThread]: Command end result
[0m13:45:54.310267 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m13:45:54.312488 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m13:45:54.318025 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt/target/run_results.json
[0m13:45:54.318281 [info ] [MainThread]: 
[0m13:45:54.318708 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:45:54.319191 [info ] [MainThread]: 
[0m13:45:54.319730 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m13:45:54.320800 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.0102544, "process_in_blocks": "0", "process_kernel_time": 0.388996, "process_mem_max_rss": "164680", "process_out_blocks": "4053", "process_user_time": 1.721106}
[0m13:45:54.321179 [debug] [MainThread]: Command `dbt run` succeeded at 13:45:54.321105 after 5.01 seconds
[0m13:45:54.321449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3317fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb56a9580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb9da2900>]}
[0m13:45:54.321697 [debug] [MainThread]: Flushing usage events
[0m13:45:54.829919 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:50:11.365511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96603590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff974270b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97426ff0>]}


============================== 13:50:11.370005 | 0b4ed5ab-22a5-404c-a847-cf2963478197 ==============================
[0m13:50:11.370005 [info ] [MainThread]: Running with dbt=1.10.13
[0m13:50:11.370417 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'target_path': 'None', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'warn_error': 'None', 'profiles_dir': '/app/dbt', 'quiet': 'False', 'log_cache_events': 'False', 'log_path': '/app/dbt/logs', 'use_experimental_parser': 'False', 'debug': 'False', 'log_format': 'default', 'printer_width': '80', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'fail_fast': 'False', 'introspect': 'True', 'write_json': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'use_colors': 'True'}
[0m13:50:11.633278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0b4ed5ab-22a5-404c-a847-cf2963478197', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95096750>]}
[0m13:50:11.664243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0b4ed5ab-22a5-404c-a847-cf2963478197', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff972a9670>]}
[0m13:50:11.664753 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m13:50:11.717181 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m13:50:11.842067 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:50:11.842450 [debug] [MainThread]: Partial parsing: updated file: citrus_trade://models/analytics/trade_by_reporter.sql
[0m13:50:12.135553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0b4ed5ab-22a5-404c-a847-cf2963478197', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9491bbf0>]}
[0m13:50:12.178458 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m13:50:12.179915 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m13:50:12.192294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0b4ed5ab-22a5-404c-a847-cf2963478197', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94b101d0>]}
[0m13:50:12.192573 [info ] [MainThread]: Found 2 models, 1 source, 632 macros
[0m13:50:12.192987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0b4ed5ab-22a5-404c-a847-cf2963478197', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94b13560>]}
[0m13:50:12.194307 [info ] [MainThread]: 
[0m13:50:12.194536 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:50:12.194783 [info ] [MainThread]: 
[0m13:50:12.195195 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:50:12.197687 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRHS'
[0m13:50:12.203990 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRHS'
[0m13:50:12.226980 [debug] [ThreadPool]: Using snowflake connection "list_TRHS"
[0m13:50:12.227297 [debug] [ThreadPool]: Using snowflake connection "list_TRHS"
[0m13:50:12.227478 [debug] [ThreadPool]: On list_TRHS: show terse schemas in database TRHS
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS"} */
[0m13:50:12.227683 [debug] [ThreadPool]: On list_TRHS: show terse schemas in database TRHS
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS"} */
[0m13:50:12.227850 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:50:12.228040 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:50:15.077034 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2.849 seconds
[0m13:50:15.078782 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2.851 seconds
[0m13:50:15.085443 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRHS, now list_TRHS_analytics)
[0m13:50:15.092940 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRHS, now list_TRHS_staging)
[0m13:50:15.109393 [debug] [ThreadPool]: Using snowflake connection "list_TRHS_analytics"
[0m13:50:15.109871 [debug] [ThreadPool]: On list_TRHS_analytics: show objects in TRHS.analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS_analytics"} */;
[0m13:50:15.113541 [debug] [ThreadPool]: Using snowflake connection "list_TRHS_staging"
[0m13:50:15.115460 [debug] [ThreadPool]: On list_TRHS_staging: show objects in TRHS.staging
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS_staging"} */;
[0m13:50:15.188897 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.075 seconds
[0m13:50:15.194962 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.079 seconds
[0m13:50:15.198474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0b4ed5ab-22a5-404c-a847-cf2963478197', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93dcbbf0>]}
[0m13:50:15.203577 [debug] [Thread-1 (]: Began running node model.citrus_trade.stg_trade
[0m13:50:15.204285 [info ] [Thread-1 (]: 1 of 2 START sql table model staging.stg_trade ................................. [RUN]
[0m13:50:15.205262 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_TRHS_staging, now model.citrus_trade.stg_trade)
[0m13:50:15.205700 [debug] [Thread-1 (]: Began compiling node model.citrus_trade.stg_trade
[0m13:50:15.214096 [debug] [Thread-1 (]: Writing injected SQL for node "model.citrus_trade.stg_trade"
[0m13:50:15.215497 [debug] [Thread-1 (]: Began executing node model.citrus_trade.stg_trade
[0m13:50:15.240512 [debug] [Thread-1 (]: Writing runtime sql for node "model.citrus_trade.stg_trade"
[0m13:50:15.241934 [debug] [Thread-1 (]: Using snowflake connection "model.citrus_trade.stg_trade"
[0m13:50:15.242237 [debug] [Thread-1 (]: On model.citrus_trade.stg_trade: create or replace transient table TRHS.staging.stg_trade
    
    
    
    as (select
  value:"declarant"::int as declarant,
  value:"declarant_iso"::string as declarant_iso,
  value:"partner"::string as partner,
  value:"partner_iso"::string as partner_iso,
  value:"flow"::int as flow,
  value:"transport_mode"::int as transport_mode,
  value:"period"::int as period,
  value:"hs4"::string as hs4,
  value:"hs4_name"::string as hs4_name,
  value:"hs6"::string as hs6,
  value:"hs6_name"::string as hs6_name,
  value:"value_in_euros"::float as value_in_euros,
  value:"quantity_in_kg"::float as quantity_in_kg
from trhs.staging.citrus_ext
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.stg_trade"} */;
[0m13:50:15.999063 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.756 seconds
[0m13:50:16.035871 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b4ed5ab-22a5-404c-a847-cf2963478197', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff973f6390>]}
[0m13:50:16.036847 [info ] [Thread-1 (]: 1 of 2 OK created sql table model staging.stg_trade ............................ [[32mSUCCESS 1[0m in 0.83s]
[0m13:50:16.037700 [debug] [Thread-1 (]: Finished running node model.citrus_trade.stg_trade
[0m13:50:16.038644 [debug] [Thread-3 (]: Began running node model.citrus_trade.trade_by_reporter
[0m13:50:16.039304 [info ] [Thread-3 (]: 2 of 2 START sql table model analytics.trade_by_reporter ....................... [RUN]
[0m13:50:16.040126 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.citrus_trade.trade_by_reporter'
[0m13:50:16.040509 [debug] [Thread-3 (]: Began compiling node model.citrus_trade.trade_by_reporter
[0m13:50:16.044028 [debug] [Thread-3 (]: Writing injected SQL for node "model.citrus_trade.trade_by_reporter"
[0m13:50:16.045452 [debug] [Thread-3 (]: Began executing node model.citrus_trade.trade_by_reporter
[0m13:50:16.047917 [debug] [Thread-3 (]: Writing runtime sql for node "model.citrus_trade.trade_by_reporter"
[0m13:50:16.049108 [debug] [Thread-3 (]: Using snowflake connection "model.citrus_trade.trade_by_reporter"
[0m13:50:16.049424 [debug] [Thread-3 (]: On model.citrus_trade.trade_by_reporter: create or replace transient table TRHS.analytics.trade_by_reporter
    
    
    
    as (select 
    declarant,
    declarant_iso,
    partner,
    partner_iso,
    flow,
    transport_mode,
    period,
    hs6,
    hs6_name,
    -- sum(value_in_euros) as total_value,
    -- sum(quantity_in_kg) as total_quantity,
    -- sum(value_in_euros) / nullif(sum(quantity_in_kg), 0) as price_per_kg
from TRHS.staging.stg_trade
-- group by 1,2,3,4,5,6,7,8,9
-- group by 1,2,3,4,5,6,7,8,9
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.trade_by_reporter"} */;
[0m13:50:16.049747 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:50:18.149358 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 2.099 seconds
[0m13:50:18.155739 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b4ed5ab-22a5-404c-a847-cf2963478197', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91da6ed0>]}
[0m13:50:18.157021 [info ] [Thread-3 (]: 2 of 2 OK created sql table model analytics.trade_by_reporter .................. [[32mSUCCESS 1[0m in 2.12s]
[0m13:50:18.158252 [debug] [Thread-3 (]: Finished running node model.citrus_trade.trade_by_reporter
[0m13:50:18.160949 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:50:18.161499 [debug] [MainThread]: Connection 'list_TRHS_analytics' was left open.
[0m13:50:18.162089 [debug] [MainThread]: On list_TRHS_analytics: Close
[0m13:50:18.302868 [debug] [MainThread]: Connection 'model.citrus_trade.stg_trade' was left open.
[0m13:50:18.304355 [debug] [MainThread]: On model.citrus_trade.stg_trade: Close
[0m13:50:18.538530 [debug] [MainThread]: Connection 'model.citrus_trade.trade_by_reporter' was left open.
[0m13:50:18.539692 [debug] [MainThread]: On model.citrus_trade.trade_by_reporter: Close
[0m13:50:18.722977 [info ] [MainThread]: 
[0m13:50:18.723932 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 6.53 seconds (6.53s).
[0m13:50:18.726168 [debug] [MainThread]: Command end result
[0m13:50:18.771561 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m13:50:18.773755 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m13:50:18.779127 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt/target/run_results.json
[0m13:50:18.779381 [info ] [MainThread]: 
[0m13:50:18.779678 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:50:18.779954 [info ] [MainThread]: 
[0m13:50:18.780316 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m13:50:18.781312 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.448945, "process_in_blocks": "0", "process_kernel_time": 0.584544, "process_mem_max_rss": "164416", "process_out_blocks": "4054", "process_user_time": 1.919614}
[0m13:50:18.781662 [debug] [MainThread]: Command `dbt run` succeeded at 13:50:18.781581 after 7.45 seconds
[0m13:50:18.781900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96505fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98de5550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff969fab40>]}
[0m13:50:18.782135 [debug] [MainThread]: Flushing usage events
[0m13:50:20.335667 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:53:28.206756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5712960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7211b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb59c3e60>]}


============================== 13:53:28.211638 | 5d01449f-f2e6-41b8-83fc-babd9735397f ==============================
[0m13:53:28.211638 [info ] [MainThread]: Running with dbt=1.10.13
[0m13:53:28.212181 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'debug': 'False', 'static_parser': 'True', 'no_print': 'None', 'partial_parse': 'True', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': '/app/dbt/logs', 'warn_error': 'None', 'quiet': 'False', 'invocation_command': 'dbt run', 'target_path': 'None', 'write_json': 'True', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'empty': 'False', 'use_colors': 'True', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '/app/dbt', 'printer_width': '80', 'introspect': 'True', 'log_cache_events': 'False', 'fail_fast': 'False'}
[0m13:53:28.421204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5d01449f-f2e6-41b8-83fc-babd9735397f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5205b20>]}
[0m13:53:28.450944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5d01449f-f2e6-41b8-83fc-babd9735397f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb40866c0>]}
[0m13:53:28.451405 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m13:53:28.499350 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m13:53:28.610569 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m13:53:28.611030 [debug] [MainThread]: Partial parsing: updated file: citrus_trade://models/staging/_src_citrus_trade.yml
[0m13:53:28.611237 [debug] [MainThread]: Partial parsing: updated file: citrus_trade://models/staging/stg_trade.sql
[0m13:53:28.790505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5d01449f-f2e6-41b8-83fc-babd9735397f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3a2ef30>]}
[0m13:53:28.831308 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m13:53:28.832635 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m13:53:28.840580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5d01449f-f2e6-41b8-83fc-babd9735397f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb39a1ac0>]}
[0m13:53:28.840844 [info ] [MainThread]: Found 2 models, 1 source, 632 macros
[0m13:53:28.841042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5d01449f-f2e6-41b8-83fc-babd9735397f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3a2edb0>]}
[0m13:53:28.841953 [info ] [MainThread]: 
[0m13:53:28.842183 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:53:28.842559 [info ] [MainThread]: 
[0m13:53:28.843085 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:53:28.845554 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRHS'
[0m13:53:28.852564 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRHS'
[0m13:53:28.869995 [debug] [ThreadPool]: Using snowflake connection "list_TRHS"
[0m13:53:28.870289 [debug] [ThreadPool]: Using snowflake connection "list_TRHS"
[0m13:53:28.870480 [debug] [ThreadPool]: On list_TRHS: show terse schemas in database TRHS
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS"} */
[0m13:53:28.870698 [debug] [ThreadPool]: On list_TRHS: show terse schemas in database TRHS
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS"} */
[0m13:53:28.870878 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:53:28.871060 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:53:31.677367 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2.806 seconds
[0m13:53:31.678886 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2.808 seconds
[0m13:53:31.685853 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRHS, now list_TRHS_analytics)
[0m13:53:31.692753 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRHS, now list_TRHS_staging)
[0m13:53:31.704472 [debug] [ThreadPool]: Using snowflake connection "list_TRHS_analytics"
[0m13:53:31.708374 [debug] [ThreadPool]: Using snowflake connection "list_TRHS_staging"
[0m13:53:31.708875 [debug] [ThreadPool]: On list_TRHS_analytics: show objects in TRHS.analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS_analytics"} */;
[0m13:53:31.709344 [debug] [ThreadPool]: On list_TRHS_staging: show objects in TRHS.staging
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS_staging"} */;
[0m13:53:31.782443 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.073 seconds
[0m13:53:31.818581 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.107 seconds
[0m13:53:31.823909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5d01449f-f2e6-41b8-83fc-babd9735397f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3763920>]}
[0m13:53:31.830200 [debug] [Thread-1 (]: Began running node model.citrus_trade.stg_trade
[0m13:53:31.831168 [info ] [Thread-1 (]: 1 of 2 START sql table model staging.stg_trade ................................. [RUN]
[0m13:53:31.832169 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_TRHS_staging, now model.citrus_trade.stg_trade)
[0m13:53:31.832865 [debug] [Thread-1 (]: Began compiling node model.citrus_trade.stg_trade
[0m13:53:31.843413 [debug] [Thread-1 (]: Writing injected SQL for node "model.citrus_trade.stg_trade"
[0m13:53:31.845123 [debug] [Thread-1 (]: Began executing node model.citrus_trade.stg_trade
[0m13:53:31.874782 [debug] [Thread-1 (]: Writing runtime sql for node "model.citrus_trade.stg_trade"
[0m13:53:31.876377 [debug] [Thread-1 (]: Using snowflake connection "model.citrus_trade.stg_trade"
[0m13:53:31.876703 [debug] [Thread-1 (]: On model.citrus_trade.stg_trade: create or replace transient table TRHS.staging.stg_trade
    
    
    
    as (select
  value:"declarant"::int as declarant,
  value:"declarant_iso"::string as declarant_iso,
  value:"partner"::string as partner,
  value:"partner_iso"::string as partner_iso,
  value:"flow"::int as flow,
  value:"transport_mode"::int as transport_mode,
  value:"period"::int as period,
  value:"hs4"::string as hs4,
  value:"hs4_name"::string as hs4_name,
  value:"hs6"::string as hs6,
  value:"hs6_name"::string as hs6_name,
  value:"value_in_euros"::float as value_in_euros,
  value:"quantity_in_kg"::float as quantity_in_kg
from trhs.staging.citrus_test
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.stg_trade"} */;
[0m13:53:32.718908 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.841 seconds
[0m13:53:32.753339 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d01449f-f2e6-41b8-83fc-babd9735397f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7c21400>]}
[0m13:53:32.754362 [info ] [Thread-1 (]: 1 of 2 OK created sql table model staging.stg_trade ............................ [[32mSUCCESS 1[0m in 0.92s]
[0m13:53:32.755264 [debug] [Thread-1 (]: Finished running node model.citrus_trade.stg_trade
[0m13:53:32.756303 [debug] [Thread-3 (]: Began running node model.citrus_trade.trade_by_reporter
[0m13:53:32.756887 [info ] [Thread-3 (]: 2 of 2 START sql table model analytics.trade_by_reporter ....................... [RUN]
[0m13:53:32.757628 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.citrus_trade.trade_by_reporter'
[0m13:53:32.758080 [debug] [Thread-3 (]: Began compiling node model.citrus_trade.trade_by_reporter
[0m13:53:32.761509 [debug] [Thread-3 (]: Writing injected SQL for node "model.citrus_trade.trade_by_reporter"
[0m13:53:32.763601 [debug] [Thread-3 (]: Began executing node model.citrus_trade.trade_by_reporter
[0m13:53:32.766264 [debug] [Thread-3 (]: Writing runtime sql for node "model.citrus_trade.trade_by_reporter"
[0m13:53:32.767522 [debug] [Thread-3 (]: Using snowflake connection "model.citrus_trade.trade_by_reporter"
[0m13:53:32.767859 [debug] [Thread-3 (]: On model.citrus_trade.trade_by_reporter: create or replace transient table TRHS.analytics.trade_by_reporter
    
    
    
    as (select 
    declarant,
    declarant_iso,
    partner,
    partner_iso,
    flow,
    transport_mode,
    period,
    hs6,
    hs6_name,
    -- sum(value_in_euros) as total_value,
    -- sum(quantity_in_kg) as total_quantity,
    -- sum(value_in_euros) / nullif(sum(quantity_in_kg), 0) as price_per_kg
from TRHS.staging.stg_trade
-- group by 1,2,3,4,5,6,7,8,9
-- group by 1,2,3,4,5,6,7,8,9
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.trade_by_reporter"} */;
[0m13:53:32.768199 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:53:35.791954 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 3.023 seconds
[0m13:53:35.799297 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d01449f-f2e6-41b8-83fc-babd9735397f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1b613d0>]}
[0m13:53:35.800771 [info ] [Thread-3 (]: 2 of 2 OK created sql table model analytics.trade_by_reporter .................. [[32mSUCCESS 1[0m in 3.04s]
[0m13:53:35.802124 [debug] [Thread-3 (]: Finished running node model.citrus_trade.trade_by_reporter
[0m13:53:35.805253 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:53:35.805855 [debug] [MainThread]: Connection 'model.citrus_trade.stg_trade' was left open.
[0m13:53:35.806471 [debug] [MainThread]: On model.citrus_trade.stg_trade: Close
[0m13:53:35.903644 [debug] [MainThread]: Connection 'list_TRHS_analytics' was left open.
[0m13:53:35.905008 [debug] [MainThread]: On list_TRHS_analytics: Close
[0m13:53:36.004003 [debug] [MainThread]: Connection 'model.citrus_trade.trade_by_reporter' was left open.
[0m13:53:36.005427 [debug] [MainThread]: On model.citrus_trade.trade_by_reporter: Close
[0m13:53:36.105884 [info ] [MainThread]: 
[0m13:53:36.107429 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 7.26 seconds (7.26s).
[0m13:53:36.109764 [debug] [MainThread]: Command end result
[0m13:53:36.157506 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m13:53:36.159757 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m13:53:36.164841 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt/target/run_results.json
[0m13:53:36.165092 [info ] [MainThread]: 
[0m13:53:36.165414 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:53:36.165744 [info ] [MainThread]: 
[0m13:53:36.166339 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m13:53:36.167251 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.989219, "process_in_blocks": "0", "process_kernel_time": 0.427562, "process_mem_max_rss": "167160", "process_out_blocks": "4053", "process_user_time": 1.766721}
[0m13:53:36.167683 [debug] [MainThread]: Command `dbt run` succeeded at 13:53:36.167602 after 7.99 seconds
[0m13:53:36.167982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb543c8c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb62207a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3888050>]}
[0m13:53:36.168271 [debug] [MainThread]: Flushing usage events
[0m13:53:36.670447 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:59:57.635135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83afc3e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff843859a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85d5f740>]}


============================== 13:59:57.638581 | 0b1004ea-36db-49b5-812a-9899a23b2b03 ==============================
[0m13:59:57.638581 [info ] [MainThread]: Running with dbt=1.10.13
[0m13:59:57.638945 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'use_experimental_parser': 'False', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_format': 'default', 'printer_width': '80', 'target_path': 'None', 'introspect': 'True', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'no_print': 'None', 'profiles_dir': '/app/dbt', 'log_cache_events': 'False', 'empty': 'False', 'debug': 'False', 'version_check': 'True', 'indirect_selection': 'eager', 'quiet': 'False', 'log_path': '/app/dbt/logs', 'partial_parse': 'True', 'cache_selected_only': 'False', 'invocation_command': 'dbt run', 'fail_fast': 'False'}
[0m13:59:57.851362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0b1004ea-36db-49b5-812a-9899a23b2b03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83980860>]}
[0m13:59:57.881577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0b1004ea-36db-49b5-812a-9899a23b2b03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81f026f0>]}
[0m13:59:57.882001 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m13:59:57.930401 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m13:59:58.051893 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:59:58.052309 [debug] [MainThread]: Partial parsing: updated file: citrus_trade://models/staging/stg_trade.sql
[0m13:59:58.178799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0b1004ea-36db-49b5-812a-9899a23b2b03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81549430>]}
[0m13:59:58.221154 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m13:59:58.222500 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m13:59:58.230678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0b1004ea-36db-49b5-812a-9899a23b2b03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff817c22a0>]}
[0m13:59:58.230936 [info ] [MainThread]: Found 2 models, 1 source, 632 macros
[0m13:59:58.231156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0b1004ea-36db-49b5-812a-9899a23b2b03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81cd75c0>]}
[0m13:59:58.232139 [info ] [MainThread]: 
[0m13:59:58.232375 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:59:58.232595 [info ] [MainThread]: 
[0m13:59:58.232984 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:59:58.236046 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRHS'
[0m13:59:58.243694 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRHS'
[0m13:59:58.265521 [debug] [ThreadPool]: Using snowflake connection "list_TRHS"
[0m13:59:58.266327 [debug] [ThreadPool]: Using snowflake connection "list_TRHS"
[0m13:59:58.266514 [debug] [ThreadPool]: On list_TRHS: show terse schemas in database TRHS
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS"} */
[0m13:59:58.266756 [debug] [ThreadPool]: On list_TRHS: show terse schemas in database TRHS
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS"} */
[0m13:59:58.267016 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:59:58.267274 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:00:01.185853 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2.919 seconds
[0m14:00:01.187061 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2.920 seconds
[0m14:00:01.194104 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRHS, now list_TRHS_staging)
[0m14:00:01.202441 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRHS, now list_TRHS_analytics)
[0m14:00:01.214871 [debug] [ThreadPool]: Using snowflake connection "list_TRHS_analytics"
[0m14:00:01.215741 [debug] [ThreadPool]: Using snowflake connection "list_TRHS_staging"
[0m14:00:01.216093 [debug] [ThreadPool]: On list_TRHS_analytics: show objects in TRHS.analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS_analytics"} */;
[0m14:00:01.216539 [debug] [ThreadPool]: On list_TRHS_staging: show objects in TRHS.staging
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS_staging"} */;
[0m14:00:01.334082 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.117 seconds
[0m14:00:01.343218 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.125 seconds
[0m14:00:01.346653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0b1004ea-36db-49b5-812a-9899a23b2b03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8151c9e0>]}
[0m14:00:01.351419 [debug] [Thread-1 (]: Began running node model.citrus_trade.stg_trade
[0m14:00:01.352124 [info ] [Thread-1 (]: 1 of 2 START sql table model staging.stg_trade ................................. [RUN]
[0m14:00:01.352711 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_TRHS_staging, now model.citrus_trade.stg_trade)
[0m14:00:01.353200 [debug] [Thread-1 (]: Began compiling node model.citrus_trade.stg_trade
[0m14:00:01.363645 [debug] [Thread-1 (]: Writing injected SQL for node "model.citrus_trade.stg_trade"
[0m14:00:01.365927 [debug] [Thread-1 (]: Began executing node model.citrus_trade.stg_trade
[0m14:00:01.397735 [debug] [Thread-1 (]: Writing runtime sql for node "model.citrus_trade.stg_trade"
[0m14:00:01.399210 [debug] [Thread-1 (]: Using snowflake connection "model.citrus_trade.stg_trade"
[0m14:00:01.399577 [debug] [Thread-1 (]: On model.citrus_trade.stg_trade: create or replace transient table TRHS.staging.stg_trade
    
    
    
    as (select
  value:'declarant'::int as declarant
  -- ,
  -- value:"declarant_iso"::string as declarant_iso,
  -- value:"partner"::string as partner,
  -- value:"partner_iso"::string as partner_iso,
  -- value:"flow"::int as flow,
  -- value:"transport_mode"::int as transport_mode,
  -- value:"period"::int as period,
  -- value:"hs4"::string as hs4,
  -- value:"hs4_name"::string as hs4_name,
  -- value:"hs6"::string as hs6,
  -- value:"hs6_name"::string as hs6_name,
  -- value:"value_in_euros"::float as value_in_euros,
  -- value:"quantity_in_kg"::float as quantity_in_kg
from trhs.staging.citrus_test
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.stg_trade"} */;
[0m14:00:01.550127 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01c01448-0105-6933-0000-000420ca7131
[0m14:00:01.550967 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 6 at position 8 unexpected ''declarant''.
[0m14:00:01.556353 [debug] [Thread-1 (]: Database Error in model stg_trade (models/staging/stg_trade.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 8 unexpected ''declarant''.
  compiled code at target/run/citrus_trade/models/staging/stg_trade.sql
[0m14:00:01.559324 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b1004ea-36db-49b5-812a-9899a23b2b03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff78e4f110>]}
[0m14:00:01.560456 [error] [Thread-1 (]: 1 of 2 ERROR creating sql table model staging.stg_trade ........................ [[31mERROR[0m in 0.20s]
[0m14:00:01.561514 [debug] [Thread-1 (]: Finished running node model.citrus_trade.stg_trade
[0m14:00:01.562333 [debug] [Thread-7 (]: Marking all children of 'model.citrus_trade.stg_trade' to be skipped because of status 'error'.  Reason: Database Error in model stg_trade (models/staging/stg_trade.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 8 unexpected ''declarant''.
  compiled code at target/run/citrus_trade/models/staging/stg_trade.sql.
[0m14:00:01.563954 [debug] [Thread-3 (]: Began running node model.citrus_trade.trade_by_reporter
[0m14:00:01.564697 [info ] [Thread-3 (]: 2 of 2 SKIP relation analytics.trade_by_reporter ............................... [[33mSKIP[0m]
[0m14:00:01.565333 [debug] [Thread-3 (]: Finished running node model.citrus_trade.trade_by_reporter
[0m14:00:01.567298 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:00:01.567763 [debug] [MainThread]: Connection 'model.citrus_trade.stg_trade' was left open.
[0m14:00:01.568162 [debug] [MainThread]: On model.citrus_trade.stg_trade: Close
[0m14:00:02.108819 [debug] [MainThread]: Connection 'list_TRHS_analytics' was left open.
[0m14:00:02.109821 [debug] [MainThread]: On list_TRHS_analytics: Close
[0m14:00:02.313568 [info ] [MainThread]: 
[0m14:00:02.315203 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 4.08 seconds (4.08s).
[0m14:00:02.317566 [debug] [MainThread]: Command end result
[0m14:00:02.363847 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m14:00:02.365929 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m14:00:02.371148 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt/target/run_results.json
[0m14:00:02.371400 [info ] [MainThread]: 
[0m14:00:02.371693 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:00:02.371978 [info ] [MainThread]: 
[0m14:00:02.372454 [error] [MainThread]: [31mFailure in model stg_trade (models/staging/stg_trade.sql)[0m
[0m14:00:02.372831 [error] [MainThread]:   Database Error in model stg_trade (models/staging/stg_trade.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 8 unexpected ''declarant''.
  compiled code at target/run/citrus_trade/models/staging/stg_trade.sql
[0m14:00:02.373162 [info ] [MainThread]: 
[0m14:00:02.373551 [info ] [MainThread]:   compiled code at target/compiled/citrus_trade/models/staging/stg_trade.sql
[0m14:00:02.373848 [info ] [MainThread]: 
[0m14:00:02.374259 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 NO-OP=0 TOTAL=2
[0m14:00:02.375169 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 4.771439, "process_in_blocks": "0", "process_kernel_time": 0.419384, "process_mem_max_rss": "158412", "process_out_blocks": "4048", "process_user_time": 1.634575}
[0m14:00:02.375532 [debug] [MainThread]: Command `dbt run` failed at 14:00:02.375461 after 4.77 seconds
[0m14:00:02.375890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87ef2900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff858015b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85d5f740>]}
[0m14:00:02.376280 [debug] [MainThread]: Flushing usage events
[0m14:00:02.869310 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:00:31.706747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7eafad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8097740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb9c023c0>]}


============================== 14:00:31.708983 | 7c61c391-70b3-4893-8a6c-5fda9672890c ==============================
[0m14:00:31.708983 [info ] [MainThread]: Running with dbt=1.10.13
[0m14:00:31.709320 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'no_print': 'None', 'profiles_dir': '/app/dbt', 'use_colors': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'debug': 'False', 'version_check': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'fail_fast': 'False', 'quiet': 'False', 'warn_error': 'None', 'log_format': 'default', 'empty': 'False', 'log_path': '/app/dbt/logs', 'indirect_selection': 'eager', 'static_parser': 'True', 'cache_selected_only': 'False', 'write_json': 'True', 'partial_parse': 'True', 'invocation_command': 'dbt run'}
[0m14:00:31.885519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7c61c391-70b3-4893-8a6c-5fda9672890c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb84b1c70>]}
[0m14:00:31.916124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7c61c391-70b3-4893-8a6c-5fda9672890c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb84b1610>]}
[0m14:00:31.916641 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m14:00:31.967199 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m14:00:32.074711 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:00:32.075101 [debug] [MainThread]: Partial parsing: updated file: citrus_trade://models/staging/stg_trade.sql
[0m14:00:32.197257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7c61c391-70b3-4893-8a6c-5fda9672890c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5b49070>]}
[0m14:00:32.239956 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m14:00:32.241249 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m14:00:32.248168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7c61c391-70b3-4893-8a6c-5fda9672890c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5b01dc0>]}
[0m14:00:32.248437 [info ] [MainThread]: Found 2 models, 1 source, 632 macros
[0m14:00:32.248619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7c61c391-70b3-4893-8a6c-5fda9672890c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5d98710>]}
[0m14:00:32.249548 [info ] [MainThread]: 
[0m14:00:32.249772 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:00:32.249999 [info ] [MainThread]: 
[0m14:00:32.250391 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:00:32.252887 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRHS'
[0m14:00:32.258645 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRHS'
[0m14:00:32.272483 [debug] [ThreadPool]: Using snowflake connection "list_TRHS"
[0m14:00:32.272777 [debug] [ThreadPool]: Using snowflake connection "list_TRHS"
[0m14:00:32.272948 [debug] [ThreadPool]: On list_TRHS: show terse schemas in database TRHS
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS"} */
[0m14:00:32.273249 [debug] [ThreadPool]: On list_TRHS: show terse schemas in database TRHS
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS"} */
[0m14:00:32.273447 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:00:32.273636 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:00:35.204449 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2.930 seconds
[0m14:00:35.211030 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2.937 seconds
[0m14:00:35.216070 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRHS, now list_TRHS_staging)
[0m14:00:35.223108 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRHS, now list_TRHS_analytics)
[0m14:00:35.241319 [debug] [ThreadPool]: Using snowflake connection "list_TRHS_staging"
[0m14:00:35.245060 [debug] [ThreadPool]: Using snowflake connection "list_TRHS_analytics"
[0m14:00:35.245409 [debug] [ThreadPool]: On list_TRHS_staging: show objects in TRHS.staging
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS_staging"} */;
[0m14:00:35.245876 [debug] [ThreadPool]: On list_TRHS_analytics: show objects in TRHS.analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS_analytics"} */;
[0m14:00:35.336373 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.088 seconds
[0m14:00:35.359584 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.113 seconds
[0m14:00:35.364364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7c61c391-70b3-4893-8a6c-5fda9672890c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac22fe30>]}
[0m14:00:35.371914 [debug] [Thread-1 (]: Began running node model.citrus_trade.stg_trade
[0m14:00:35.372833 [info ] [Thread-1 (]: 1 of 2 START sql table model staging.stg_trade ................................. [RUN]
[0m14:00:35.374129 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_TRHS_staging, now model.citrus_trade.stg_trade)
[0m14:00:35.374811 [debug] [Thread-1 (]: Began compiling node model.citrus_trade.stg_trade
[0m14:00:35.384999 [debug] [Thread-1 (]: Writing injected SQL for node "model.citrus_trade.stg_trade"
[0m14:00:35.386479 [debug] [Thread-1 (]: Began executing node model.citrus_trade.stg_trade
[0m14:00:35.415901 [debug] [Thread-1 (]: Writing runtime sql for node "model.citrus_trade.stg_trade"
[0m14:00:35.417160 [debug] [Thread-1 (]: Using snowflake connection "model.citrus_trade.stg_trade"
[0m14:00:35.417512 [debug] [Thread-1 (]: On model.citrus_trade.stg_trade: create or replace transient table TRHS.staging.stg_trade
    
    
    
    as (select
  value:"declarant"::int as declarant,
  value:"declarant_iso"::string as declarant_iso
  -- ,
  -- value:"partner"::string as partner,
  -- value:"partner_iso"::string as partner_iso,
  -- value:"flow"::int as flow,
  -- value:"transport_mode"::int as transport_mode,
  -- value:"period"::int as period,
  -- value:"hs4"::string as hs4,
  -- value:"hs4_name"::string as hs4_name,
  -- value:"hs6"::string as hs6,
  -- value:"hs6_name"::string as hs6_name,
  -- value:"value_in_euros"::float as value_in_euros,
  -- value:"quantity_in_kg"::float as quantity_in_kg
from trhs.staging.citrus_test
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.stg_trade"} */;
[0m14:00:36.147074 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.729 seconds
[0m14:00:36.186130 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c61c391-70b3-4893-8a6c-5fda9672890c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb85fa4b0>]}
[0m14:00:36.187145 [info ] [Thread-1 (]: 1 of 2 OK created sql table model staging.stg_trade ............................ [[32mSUCCESS 1[0m in 0.81s]
[0m14:00:36.187895 [debug] [Thread-1 (]: Finished running node model.citrus_trade.stg_trade
[0m14:00:36.189106 [debug] [Thread-3 (]: Began running node model.citrus_trade.trade_by_reporter
[0m14:00:36.189838 [info ] [Thread-3 (]: 2 of 2 START sql table model analytics.trade_by_reporter ....................... [RUN]
[0m14:00:36.190515 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.citrus_trade.trade_by_reporter'
[0m14:00:36.190933 [debug] [Thread-3 (]: Began compiling node model.citrus_trade.trade_by_reporter
[0m14:00:36.196687 [debug] [Thread-3 (]: Writing injected SQL for node "model.citrus_trade.trade_by_reporter"
[0m14:00:36.198214 [debug] [Thread-3 (]: Began executing node model.citrus_trade.trade_by_reporter
[0m14:00:36.200714 [debug] [Thread-3 (]: Writing runtime sql for node "model.citrus_trade.trade_by_reporter"
[0m14:00:36.201996 [debug] [Thread-3 (]: Using snowflake connection "model.citrus_trade.trade_by_reporter"
[0m14:00:36.202300 [debug] [Thread-3 (]: On model.citrus_trade.trade_by_reporter: create or replace transient table TRHS.analytics.trade_by_reporter
    
    
    
    as (select 
    declarant,
    declarant_iso,
    partner,
    partner_iso,
    flow,
    transport_mode,
    period,
    hs6,
    hs6_name,
    -- sum(value_in_euros) as total_value,
    -- sum(quantity_in_kg) as total_quantity,
    -- sum(value_in_euros) / nullif(sum(quantity_in_kg), 0) as price_per_kg
from TRHS.staging.stg_trade
-- group by 1,2,3,4,5,6,7,8,9
-- group by 1,2,3,4,5,6,7,8,9
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.trade_by_reporter"} */;
[0m14:00:36.202538 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:00:37.652349 [debug] [Thread-3 (]: Snowflake adapter: Snowflake query id: 01c01448-0105-6933-0000-000420ca7149
[0m14:00:37.653472 [debug] [Thread-3 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 8 at position 4
invalid identifier 'PARTNER'
[0m14:00:37.659490 [debug] [Thread-3 (]: Database Error in model trade_by_reporter (models/analytics/trade_by_reporter.sql)
  000904 (42000): SQL compilation error: error line 8 at position 4
  invalid identifier 'PARTNER'
  compiled code at target/run/citrus_trade/models/analytics/trade_by_reporter.sql
[0m14:00:37.660493 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c61c391-70b3-4893-8a6c-5fda9672890c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad349e80>]}
[0m14:00:37.661627 [error] [Thread-3 (]: 2 of 2 ERROR creating sql table model analytics.trade_by_reporter .............. [[31mERROR[0m in 1.47s]
[0m14:00:37.662754 [debug] [Thread-3 (]: Finished running node model.citrus_trade.trade_by_reporter
[0m14:00:37.663651 [debug] [Thread-7 (]: Marking all children of 'model.citrus_trade.trade_by_reporter' to be skipped because of status 'error'.  Reason: Database Error in model trade_by_reporter (models/analytics/trade_by_reporter.sql)
  000904 (42000): SQL compilation error: error line 8 at position 4
  invalid identifier 'PARTNER'
  compiled code at target/run/citrus_trade/models/analytics/trade_by_reporter.sql.
[0m14:00:37.666956 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:00:37.667548 [debug] [MainThread]: Connection 'model.citrus_trade.stg_trade' was left open.
[0m14:00:37.668000 [debug] [MainThread]: On model.citrus_trade.stg_trade: Close
[0m14:00:37.774105 [debug] [MainThread]: Connection 'list_TRHS_analytics' was left open.
[0m14:00:37.775464 [debug] [MainThread]: On list_TRHS_analytics: Close
[0m14:00:37.885303 [debug] [MainThread]: Connection 'model.citrus_trade.trade_by_reporter' was left open.
[0m14:00:37.886379 [debug] [MainThread]: On model.citrus_trade.trade_by_reporter: Close
[0m14:00:37.994213 [info ] [MainThread]: 
[0m14:00:37.995366 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 5.74 seconds (5.74s).
[0m14:00:38.000940 [debug] [MainThread]: Command end result
[0m14:00:38.085467 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m14:00:38.087626 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m14:00:38.092648 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt/target/run_results.json
[0m14:00:38.092942 [info ] [MainThread]: 
[0m14:00:38.093296 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:00:38.093640 [info ] [MainThread]: 
[0m14:00:38.094102 [error] [MainThread]: [31mFailure in model trade_by_reporter (models/analytics/trade_by_reporter.sql)[0m
[0m14:00:38.094470 [error] [MainThread]:   Database Error in model trade_by_reporter (models/analytics/trade_by_reporter.sql)
  000904 (42000): SQL compilation error: error line 8 at position 4
  invalid identifier 'PARTNER'
  compiled code at target/run/citrus_trade/models/analytics/trade_by_reporter.sql
[0m14:00:38.094765 [info ] [MainThread]: 
[0m14:00:38.095116 [info ] [MainThread]:   compiled code at target/compiled/citrus_trade/models/analytics/trade_by_reporter.sql
[0m14:00:38.095433 [info ] [MainThread]: 
[0m14:00:38.095767 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=2
[0m14:00:38.096839 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 6.4178095, "process_in_blocks": "0", "process_kernel_time": 0.232465, "process_mem_max_rss": "164888", "process_out_blocks": "4058", "process_user_time": 1.778513}
[0m14:00:38.097361 [debug] [MainThread]: Command `dbt run` failed at 14:00:38.097174 after 6.42 seconds
[0m14:00:38.097807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7f52120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb69ceb70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7e77020>]}
[0m14:00:38.098141 [debug] [MainThread]: Flushing usage events
[0m14:00:38.573524 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:59:22.076202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a9e2240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c74d7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a30cec0>]}


============================== 11:59:22.087956 | 58128033-c172-4051-adc1-ba37bd412ac1 ==============================
[0m11:59:22.087956 [info ] [MainThread]: Running with dbt=1.10.13
[0m11:59:22.088477 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'empty': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'log_format': 'default', 'introspect': 'True', 'indirect_selection': 'eager', 'static_parser': 'True', 'use_colors': 'True', 'log_path': '/app/dbt/logs', 'debug': 'False', 'printer_width': '80', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'version_check': 'True', 'profiles_dir': '/app/dbt', 'no_print': 'None', 'quiet': 'False', 'write_json': 'True'}
[0m11:59:22.597888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '58128033-c172-4051-adc1-ba37bd412ac1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9854ba10>]}
[0m11:59:22.630072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '58128033-c172-4051-adc1-ba37bd412ac1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff988eb530>]}
[0m11:59:22.630574 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m11:59:22.692102 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m11:59:22.823356 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m11:59:22.823858 [debug] [MainThread]: Partial parsing: updated file: citrus_trade://models/staging/_src_citrus_trade.yml
[0m11:59:22.824075 [debug] [MainThread]: Partial parsing: updated file: citrus_trade://models/staging/stg_trade.sql
[0m11:59:23.014049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '58128033-c172-4051-adc1-ba37bd412ac1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98198410>]}
[0m11:59:23.055898 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m11:59:23.057867 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m11:59:23.071603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '58128033-c172-4051-adc1-ba37bd412ac1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97764b60>]}
[0m11:59:23.071884 [info ] [MainThread]: Found 2 models, 1 source, 632 macros
[0m11:59:23.072093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '58128033-c172-4051-adc1-ba37bd412ac1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97ede870>]}
[0m11:59:23.073064 [info ] [MainThread]: 
[0m11:59:23.073282 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:59:23.073527 [info ] [MainThread]: 
[0m11:59:23.073956 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:59:23.077129 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRHS'
[0m11:59:23.082884 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRHS'
[0m11:59:23.124479 [debug] [ThreadPool]: Using snowflake connection "list_TRHS"
[0m11:59:23.124840 [debug] [ThreadPool]: Using snowflake connection "list_TRHS"
[0m11:59:23.125016 [debug] [ThreadPool]: On list_TRHS: show terse schemas in database TRHS
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS"} */
[0m11:59:23.125228 [debug] [ThreadPool]: On list_TRHS: show terse schemas in database TRHS
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS"} */
[0m11:59:23.125398 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:59:23.125622 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:59:25.971441 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2.846 seconds
[0m11:59:26.013338 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2.888 seconds
[0m11:59:26.019116 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRHS, now list_TRHS_staging)
[0m11:59:26.020104 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRHS, now list_TRHS_analytics)
[0m11:59:26.044663 [debug] [ThreadPool]: Using snowflake connection "list_TRHS_analytics"
[0m11:59:26.046446 [debug] [ThreadPool]: Using snowflake connection "list_TRHS_staging"
[0m11:59:26.046841 [debug] [ThreadPool]: On list_TRHS_analytics: show objects in TRHS.analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS_analytics"} */;
[0m11:59:26.047337 [debug] [ThreadPool]: On list_TRHS_staging: show objects in TRHS.staging
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS_staging"} */;
[0m11:59:26.121183 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.072 seconds
[0m11:59:26.124047 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.076 seconds
[0m11:59:26.125668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '58128033-c172-4051-adc1-ba37bd412ac1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97eb6f30>]}
[0m11:59:26.130825 [debug] [Thread-1 (]: Began running node model.citrus_trade.stg_trade
[0m11:59:26.131541 [info ] [Thread-1 (]: 1 of 2 START sql table model staging.stg_trade ................................. [RUN]
[0m11:59:26.132421 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_TRHS_analytics, now model.citrus_trade.stg_trade)
[0m11:59:26.133058 [debug] [Thread-1 (]: Began compiling node model.citrus_trade.stg_trade
[0m11:59:26.143275 [debug] [Thread-1 (]: Writing injected SQL for node "model.citrus_trade.stg_trade"
[0m11:59:26.146250 [debug] [Thread-1 (]: Began executing node model.citrus_trade.stg_trade
[0m11:59:26.173404 [debug] [Thread-1 (]: Writing runtime sql for node "model.citrus_trade.stg_trade"
[0m11:59:26.175184 [debug] [Thread-1 (]: Using snowflake connection "model.citrus_trade.stg_trade"
[0m11:59:26.175462 [debug] [Thread-1 (]: On model.citrus_trade.stg_trade: create or replace transient table TRHS.staging.stg_trade
    
    
    
    as (select
  value:"declarant"::int as declarant,
  value:"declarant_iso"::string as declarant_iso
  -- ,
  -- value:"partner"::string as partner,
  -- value:"partner_iso"::string as partner_iso,
  -- value:"flow"::int as flow,
  -- value:"transport_mode"::int as transport_mode,
  -- value:"period"::int as period,
  -- value:"hs4"::string as hs4,
  -- value:"hs4_name"::string as hs4_name,
  -- value:"hs6"::string as hs6,
  -- value:"hs6_name"::string as hs6_name,
  -- value:"value_in_euros"::float as value_in_euros,
  -- value:"quantity_in_kg"::float as quantity_in_kg
from trhs.staging.citrus_ext
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.stg_trade"} */;
[0m11:59:27.009697 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.833 seconds
[0m11:59:27.045270 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '58128033-c172-4051-adc1-ba37bd412ac1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c3e5550>]}
[0m11:59:27.046233 [info ] [Thread-1 (]: 1 of 2 OK created sql table model staging.stg_trade ............................ [[32mSUCCESS 1[0m in 0.91s]
[0m11:59:27.047038 [debug] [Thread-1 (]: Finished running node model.citrus_trade.stg_trade
[0m11:59:27.048128 [debug] [Thread-3 (]: Began running node model.citrus_trade.trade_by_reporter
[0m11:59:27.048734 [info ] [Thread-3 (]: 2 of 2 START sql table model analytics.trade_by_reporter ....................... [RUN]
[0m11:59:27.049428 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.citrus_trade.trade_by_reporter'
[0m11:59:27.049836 [debug] [Thread-3 (]: Began compiling node model.citrus_trade.trade_by_reporter
[0m11:59:27.053260 [debug] [Thread-3 (]: Writing injected SQL for node "model.citrus_trade.trade_by_reporter"
[0m11:59:27.055525 [debug] [Thread-3 (]: Began executing node model.citrus_trade.trade_by_reporter
[0m11:59:27.058209 [debug] [Thread-3 (]: Writing runtime sql for node "model.citrus_trade.trade_by_reporter"
[0m11:59:27.059486 [debug] [Thread-3 (]: Using snowflake connection "model.citrus_trade.trade_by_reporter"
[0m11:59:27.059813 [debug] [Thread-3 (]: On model.citrus_trade.trade_by_reporter: create or replace transient table TRHS.analytics.trade_by_reporter
    
    
    
    as (select 
    declarant,
    declarant_iso,
    partner,
    partner_iso,
    flow,
    transport_mode,
    period,
    hs6,
    hs6_name,
    -- sum(value_in_euros) as total_value,
    -- sum(quantity_in_kg) as total_quantity,
    -- sum(value_in_euros) / nullif(sum(quantity_in_kg), 0) as price_per_kg
from TRHS.staging.stg_trade
-- group by 1,2,3,4,5,6,7,8,9
-- group by 1,2,3,4,5,6,7,8,9
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.trade_by_reporter"} */;
[0m11:59:27.060120 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m11:59:28.437751 [debug] [Thread-3 (]: Snowflake adapter: Snowflake query id: 01c0196f-0105-6a36-0000-000420ca91c1
[0m11:59:28.440685 [debug] [Thread-3 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 8 at position 4
invalid identifier 'PARTNER'
[0m11:59:28.447487 [debug] [Thread-3 (]: Database Error in model trade_by_reporter (models/analytics/trade_by_reporter.sql)
  000904 (42000): SQL compilation error: error line 8 at position 4
  invalid identifier 'PARTNER'
  compiled code at target/run/citrus_trade/models/analytics/trade_by_reporter.sql
[0m11:59:28.448371 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '58128033-c172-4051-adc1-ba37bd412ac1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8eb844d0>]}
[0m11:59:28.449426 [error] [Thread-3 (]: 2 of 2 ERROR creating sql table model analytics.trade_by_reporter .............. [[31mERROR[0m in 1.40s]
[0m11:59:28.450417 [debug] [Thread-3 (]: Finished running node model.citrus_trade.trade_by_reporter
[0m11:59:28.451225 [debug] [Thread-7 (]: Marking all children of 'model.citrus_trade.trade_by_reporter' to be skipped because of status 'error'.  Reason: Database Error in model trade_by_reporter (models/analytics/trade_by_reporter.sql)
  000904 (42000): SQL compilation error: error line 8 at position 4
  invalid identifier 'PARTNER'
  compiled code at target/run/citrus_trade/models/analytics/trade_by_reporter.sql.
[0m11:59:28.454375 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:59:28.454848 [debug] [MainThread]: Connection 'list_TRHS_staging' was left open.
[0m11:59:28.455342 [debug] [MainThread]: On list_TRHS_staging: Close
[0m11:59:28.564094 [debug] [MainThread]: Connection 'model.citrus_trade.stg_trade' was left open.
[0m11:59:28.565412 [debug] [MainThread]: On model.citrus_trade.stg_trade: Close
[0m11:59:28.653811 [debug] [MainThread]: Connection 'model.citrus_trade.trade_by_reporter' was left open.
[0m11:59:28.655106 [debug] [MainThread]: On model.citrus_trade.trade_by_reporter: Close
[0m11:59:28.744113 [info ] [MainThread]: 
[0m11:59:28.746073 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 5.67 seconds (5.67s).
[0m11:59:28.748000 [debug] [MainThread]: Command end result
[0m11:59:28.794182 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m11:59:28.796125 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m11:59:28.801546 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt/target/run_results.json
[0m11:59:28.801868 [info ] [MainThread]: 
[0m11:59:28.802295 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m11:59:28.802698 [info ] [MainThread]: 
[0m11:59:28.803311 [error] [MainThread]: [31mFailure in model trade_by_reporter (models/analytics/trade_by_reporter.sql)[0m
[0m11:59:28.803648 [error] [MainThread]:   Database Error in model trade_by_reporter (models/analytics/trade_by_reporter.sql)
  000904 (42000): SQL compilation error: error line 8 at position 4
  invalid identifier 'PARTNER'
  compiled code at target/run/citrus_trade/models/analytics/trade_by_reporter.sql
[0m11:59:28.803852 [info ] [MainThread]: 
[0m11:59:28.804225 [info ] [MainThread]:   compiled code at target/compiled/citrus_trade/models/analytics/trade_by_reporter.sql
[0m11:59:28.804615 [info ] [MainThread]: 
[0m11:59:28.804902 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=2
[0m11:59:28.806066 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 6.769319, "process_in_blocks": "0", "process_kernel_time": 1.261921, "process_mem_max_rss": "166300", "process_out_blocks": "4057", "process_user_time": 1.952386}
[0m11:59:28.806410 [debug] [MainThread]: Command `dbt run` failed at 11:59:28.806340 after 6.77 seconds
[0m11:59:28.806701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a4b7740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a7e8b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98023620>]}
[0m11:59:28.806957 [debug] [MainThread]: Flushing usage events
[0m11:59:29.303764 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:59:51.622918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffadf1b230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad48f9e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffafc67530>]}


============================== 11:59:51.626114 | 5c6a2bfa-49ea-4286-964b-56ed92ed02e8 ==============================
[0m11:59:51.626114 [info ] [MainThread]: Running with dbt=1.10.13
[0m11:59:51.626468 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'target_path': 'None', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'use_experimental_parser': 'False', 'no_print': 'None', 'log_path': '/app/dbt/logs', 'empty': 'False', 'write_json': 'True', 'warn_error': 'None', 'partial_parse': 'True', 'cache_selected_only': 'False', 'fail_fast': 'False', 'version_check': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run', 'use_colors': 'True', 'profiles_dir': '/app/dbt', 'quiet': 'False', 'debug': 'False'}
[0m11:59:51.827777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5c6a2bfa-49ea-4286-964b-56ed92ed02e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffabb96750>]}
[0m11:59:51.858437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5c6a2bfa-49ea-4286-964b-56ed92ed02e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffacf33470>]}
[0m11:59:51.858908 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m11:59:51.908030 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m11:59:52.018354 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:59:52.018724 [debug] [MainThread]: Partial parsing: updated file: citrus_trade://models/analytics/trade_by_reporter.sql
[0m11:59:52.144984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5c6a2bfa-49ea-4286-964b-56ed92ed02e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffab444e00>]}
[0m11:59:52.187553 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m11:59:52.188944 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m11:59:52.197138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5c6a2bfa-49ea-4286-964b-56ed92ed02e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffab354c50>]}
[0m11:59:52.197501 [info ] [MainThread]: Found 2 models, 1 source, 632 macros
[0m11:59:52.197739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5c6a2bfa-49ea-4286-964b-56ed92ed02e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffab510650>]}
[0m11:59:52.198702 [info ] [MainThread]: 
[0m11:59:52.198926 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:59:52.199088 [info ] [MainThread]: 
[0m11:59:52.199450 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:59:52.201767 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRHS'
[0m11:59:52.209106 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRHS'
[0m11:59:52.227357 [debug] [ThreadPool]: Using snowflake connection "list_TRHS"
[0m11:59:52.227654 [debug] [ThreadPool]: Using snowflake connection "list_TRHS"
[0m11:59:52.227825 [debug] [ThreadPool]: On list_TRHS: show terse schemas in database TRHS
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS"} */
[0m11:59:52.228058 [debug] [ThreadPool]: On list_TRHS: show terse schemas in database TRHS
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS"} */
[0m11:59:52.228239 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:59:52.228438 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:59:55.088657 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2.860 seconds
[0m11:59:55.090915 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2.863 seconds
[0m11:59:55.098168 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRHS, now list_TRHS_staging)
[0m11:59:55.105538 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRHS, now list_TRHS_analytics)
[0m11:59:55.116185 [debug] [ThreadPool]: Using snowflake connection "list_TRHS_staging"
[0m11:59:55.119029 [debug] [ThreadPool]: Using snowflake connection "list_TRHS_analytics"
[0m11:59:55.119654 [debug] [ThreadPool]: On list_TRHS_staging: show objects in TRHS.staging
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS_staging"} */;
[0m11:59:55.120212 [debug] [ThreadPool]: On list_TRHS_analytics: show objects in TRHS.analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS_analytics"} */;
[0m11:59:55.202248 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.080 seconds
[0m11:59:55.208398 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.088 seconds
[0m11:59:55.211433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5c6a2bfa-49ea-4286-964b-56ed92ed02e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffab447050>]}
[0m11:59:55.217789 [debug] [Thread-1 (]: Began running node model.citrus_trade.stg_trade
[0m11:59:55.218663 [info ] [Thread-1 (]: 1 of 2 START sql table model staging.stg_trade ................................. [RUN]
[0m11:59:55.220080 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_TRHS_staging, now model.citrus_trade.stg_trade)
[0m11:59:55.220611 [debug] [Thread-1 (]: Began compiling node model.citrus_trade.stg_trade
[0m11:59:55.230764 [debug] [Thread-1 (]: Writing injected SQL for node "model.citrus_trade.stg_trade"
[0m11:59:55.232278 [debug] [Thread-1 (]: Began executing node model.citrus_trade.stg_trade
[0m11:59:55.264981 [debug] [Thread-1 (]: Writing runtime sql for node "model.citrus_trade.stg_trade"
[0m11:59:55.266662 [debug] [Thread-1 (]: Using snowflake connection "model.citrus_trade.stg_trade"
[0m11:59:55.267049 [debug] [Thread-1 (]: On model.citrus_trade.stg_trade: create or replace transient table TRHS.staging.stg_trade
    
    
    
    as (select
  value:"declarant"::int as declarant,
  value:"declarant_iso"::string as declarant_iso
  -- ,
  -- value:"partner"::string as partner,
  -- value:"partner_iso"::string as partner_iso,
  -- value:"flow"::int as flow,
  -- value:"transport_mode"::int as transport_mode,
  -- value:"period"::int as period,
  -- value:"hs4"::string as hs4,
  -- value:"hs4_name"::string as hs4_name,
  -- value:"hs6"::string as hs6,
  -- value:"hs6_name"::string as hs6_name,
  -- value:"value_in_euros"::float as value_in_euros,
  -- value:"quantity_in_kg"::float as quantity_in_kg
from trhs.staging.citrus_ext
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.stg_trade"} */;
[0m11:59:56.039598 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.772 seconds
[0m11:59:56.074757 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c6a2bfa-49ea-4286-964b-56ed92ed02e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffadee6510>]}
[0m11:59:56.075696 [info ] [Thread-1 (]: 1 of 2 OK created sql table model staging.stg_trade ............................ [[32mSUCCESS 1[0m in 0.85s]
[0m11:59:56.076566 [debug] [Thread-1 (]: Finished running node model.citrus_trade.stg_trade
[0m11:59:56.077732 [debug] [Thread-3 (]: Began running node model.citrus_trade.trade_by_reporter
[0m11:59:56.078330 [info ] [Thread-3 (]: 2 of 2 START sql table model analytics.trade_by_reporter ....................... [RUN]
[0m11:59:56.078998 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.citrus_trade.trade_by_reporter'
[0m11:59:56.079384 [debug] [Thread-3 (]: Began compiling node model.citrus_trade.trade_by_reporter
[0m11:59:56.083215 [debug] [Thread-3 (]: Writing injected SQL for node "model.citrus_trade.trade_by_reporter"
[0m11:59:56.084834 [debug] [Thread-3 (]: Began executing node model.citrus_trade.trade_by_reporter
[0m11:59:56.089122 [debug] [Thread-3 (]: Writing runtime sql for node "model.citrus_trade.trade_by_reporter"
[0m11:59:56.090209 [debug] [Thread-3 (]: Using snowflake connection "model.citrus_trade.trade_by_reporter"
[0m11:59:56.090512 [debug] [Thread-3 (]: On model.citrus_trade.trade_by_reporter: create or replace transient table TRHS.analytics.trade_by_reporter
    
    
    
    as (select 
    declarant,
    declarant_iso
    -- partner,
    -- partner_iso,
    -- flow,
    -- transport_mode,
    -- period,
    -- hs6,
    -- hs6_name,
    -- sum(value_in_euros) as total_value,
    -- sum(quantity_in_kg) as total_quantity,
    -- sum(value_in_euros) / nullif(sum(quantity_in_kg), 0) as price_per_kg
from TRHS.staging.stg_trade
-- group by 1,2,3,4,5,6,7,8,9
-- group by 1,2,3,4,5,6,7,8,9
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.trade_by_reporter"} */;
[0m11:59:56.090788 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m11:59:58.067388 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.976 seconds
[0m11:59:58.072497 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c6a2bfa-49ea-4286-964b-56ed92ed02e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9c0c980>]}
[0m11:59:58.073723 [info ] [Thread-3 (]: 2 of 2 OK created sql table model analytics.trade_by_reporter .................. [[32mSUCCESS 1[0m in 1.99s]
[0m11:59:58.076936 [debug] [Thread-3 (]: Finished running node model.citrus_trade.trade_by_reporter
[0m11:59:58.079636 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:59:58.080306 [debug] [MainThread]: Connection 'model.citrus_trade.stg_trade' was left open.
[0m11:59:58.080848 [debug] [MainThread]: On model.citrus_trade.stg_trade: Close
[0m11:59:58.165857 [debug] [MainThread]: Connection 'list_TRHS_analytics' was left open.
[0m11:59:58.167518 [debug] [MainThread]: On list_TRHS_analytics: Close
[0m11:59:58.301317 [debug] [MainThread]: Connection 'model.citrus_trade.trade_by_reporter' was left open.
[0m11:59:58.302607 [debug] [MainThread]: On model.citrus_trade.trade_by_reporter: Close
[0m11:59:58.421706 [info ] [MainThread]: 
[0m11:59:58.423201 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 6.22 seconds (6.22s).
[0m11:59:58.425786 [debug] [MainThread]: Command end result
[0m11:59:58.473430 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m11:59:58.475468 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m11:59:58.480565 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt/target/run_results.json
[0m11:59:58.480817 [info ] [MainThread]: 
[0m11:59:58.481124 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:59:58.481458 [info ] [MainThread]: 
[0m11:59:58.481841 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m11:59:58.482742 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.8901844, "process_in_blocks": "0", "process_kernel_time": 0.585979, "process_mem_max_rss": "159820", "process_out_blocks": "4055", "process_user_time": 1.685571}
[0m11:59:58.483122 [debug] [MainThread]: Command `dbt run` succeeded at 11:59:58.483048 after 6.89 seconds
[0m11:59:58.483378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffafc67530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffacff90a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffabf8e210>]}
[0m11:59:58.483615 [debug] [MainThread]: Flushing usage events
[0m11:59:58.948930 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:07:00.946961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4310d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3f9be60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3e60bf0>]}


============================== 12:07:00.950638 | 881aa2a1-fde0-4ff9-9f86-f06bef6f4cce ==============================
[0m12:07:00.950638 [info ] [MainThread]: Running with dbt=1.10.13
[0m12:07:00.951022 [debug] [MainThread]: running dbt with arguments {'empty': 'False', 'version_check': 'True', 'log_path': '/app/dbt/logs', 'warn_error': 'None', 'introspect': 'True', 'invocation_command': 'dbt run', 'printer_width': '80', 'use_colors': 'True', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'log_format': 'default', 'profiles_dir': '/app/dbt', 'use_experimental_parser': 'False', 'quiet': 'False', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'debug': 'False', 'target_path': 'None', 'write_json': 'True', 'cache_selected_only': 'False', 'partial_parse': 'True'}
[0m12:07:01.181974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '881aa2a1-fde0-4ff9-9f86-f06bef6f4cce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa48603e0>]}
[0m12:07:01.213043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '881aa2a1-fde0-4ff9-9f86-f06bef6f4cce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2a95bb0>]}
[0m12:07:01.213575 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m12:07:01.262537 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m12:07:01.403004 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 0 files added, 1 files changed.
[0m12:07:01.403304 [debug] [MainThread]: Partial parsing: deleted file: citrus_trade://models/analytics/trade_by_reporter.sql
[0m12:07:01.403524 [debug] [MainThread]: Partial parsing: updated file: citrus_trade://models/staging/stg_trade.sql
[0m12:07:01.544628 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.citrus_trade.analytics
[0m12:07:01.552819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '881aa2a1-fde0-4ff9-9f86-f06bef6f4cce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1f44950>]}
[0m12:07:01.596186 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m12:07:01.597593 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m12:07:01.605533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '881aa2a1-fde0-4ff9-9f86-f06bef6f4cce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1f0d670>]}
[0m12:07:01.605775 [info ] [MainThread]: Found 1 model, 1 source, 632 macros
[0m12:07:01.606006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '881aa2a1-fde0-4ff9-9f86-f06bef6f4cce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa211eff0>]}
[0m12:07:01.606948 [info ] [MainThread]: 
[0m12:07:01.607184 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:07:01.607522 [info ] [MainThread]: 
[0m12:07:01.607931 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:07:01.608694 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRHS'
[0m12:07:01.649801 [debug] [ThreadPool]: Using snowflake connection "list_TRHS"
[0m12:07:01.650113 [debug] [ThreadPool]: On list_TRHS: show terse schemas in database TRHS
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS"} */
[0m12:07:01.650258 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:07:04.506457 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2.857 seconds
[0m12:07:04.511903 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRHS_staging'
[0m12:07:04.531313 [debug] [ThreadPool]: Using snowflake connection "list_TRHS_staging"
[0m12:07:04.531846 [debug] [ThreadPool]: On list_TRHS_staging: show objects in TRHS.staging
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS_staging"} */;
[0m12:07:04.532320 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:07:06.960096 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2.427 seconds
[0m12:07:06.966670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '881aa2a1-fde0-4ff9-9f86-f06bef6f4cce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a1ec470>]}
[0m12:07:06.974203 [debug] [Thread-1 (]: Began running node model.citrus_trade.stg_trade
[0m12:07:06.974991 [info ] [Thread-1 (]: 1 of 1 START sql table model staging.stg_trade ................................. [RUN]
[0m12:07:06.975785 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_TRHS_staging, now model.citrus_trade.stg_trade)
[0m12:07:06.976469 [debug] [Thread-1 (]: Began compiling node model.citrus_trade.stg_trade
[0m12:07:06.987042 [debug] [Thread-1 (]: Writing injected SQL for node "model.citrus_trade.stg_trade"
[0m12:07:06.988835 [debug] [Thread-1 (]: Began executing node model.citrus_trade.stg_trade
[0m12:07:07.019850 [debug] [Thread-1 (]: Writing runtime sql for node "model.citrus_trade.stg_trade"
[0m12:07:07.021192 [debug] [Thread-1 (]: Using snowflake connection "model.citrus_trade.stg_trade"
[0m12:07:07.021470 [debug] [Thread-1 (]: On model.citrus_trade.stg_trade: create or replace transient table TRHS.staging.stg_trade
    
    
    
    as (SELECT
  f.value:declarant::int AS declarant,
  f.value:declarant_iso::string AS declarant_iso
FROM trhs.staging.citrus_ext,
     LATERAL FLATTEN(input => value) f
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.stg_trade"} */;
[0m12:07:07.098826 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01c01977-0105-6a36-0000-000420ca926d
[0m12:07:07.099330 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 10 at position 143 unexpected ';'.
[0m12:07:07.102915 [debug] [Thread-1 (]: Database Error in model stg_trade (models/staging/stg_trade.sql)
  001003 (42000): SQL compilation error:
  syntax error line 10 at position 143 unexpected ';'.
  compiled code at target/run/citrus_trade/models/staging/stg_trade.sql
[0m12:07:07.104504 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '881aa2a1-fde0-4ff9-9f86-f06bef6f4cce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa49fe540>]}
[0m12:07:07.105149 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model staging.stg_trade ........................ [[31mERROR[0m in 0.13s]
[0m12:07:07.105812 [debug] [Thread-1 (]: Finished running node model.citrus_trade.stg_trade
[0m12:07:07.106390 [debug] [Thread-7 (]: Marking all children of 'model.citrus_trade.stg_trade' to be skipped because of status 'error'.  Reason: Database Error in model stg_trade (models/staging/stg_trade.sql)
  001003 (42000): SQL compilation error:
  syntax error line 10 at position 143 unexpected ';'.
  compiled code at target/run/citrus_trade/models/staging/stg_trade.sql.
[0m12:07:07.109058 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:07:07.109306 [debug] [MainThread]: Connection 'list_TRHS' was left open.
[0m12:07:07.109521 [debug] [MainThread]: On list_TRHS: Close
[0m12:07:07.200112 [debug] [MainThread]: Connection 'model.citrus_trade.stg_trade' was left open.
[0m12:07:07.200655 [debug] [MainThread]: On model.citrus_trade.stg_trade: Close
[0m12:07:07.292534 [info ] [MainThread]: 
[0m12:07:07.293706 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.68 seconds (5.68s).
[0m12:07:07.295203 [debug] [MainThread]: Command end result
[0m12:07:07.345379 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m12:07:07.347438 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m12:07:07.352222 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt/target/run_results.json
[0m12:07:07.352458 [info ] [MainThread]: 
[0m12:07:07.352768 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:07:07.353135 [info ] [MainThread]: 
[0m12:07:07.353498 [error] [MainThread]: [31mFailure in model stg_trade (models/staging/stg_trade.sql)[0m
[0m12:07:07.353836 [error] [MainThread]:   Database Error in model stg_trade (models/staging/stg_trade.sql)
  001003 (42000): SQL compilation error:
  syntax error line 10 at position 143 unexpected ';'.
  compiled code at target/run/citrus_trade/models/staging/stg_trade.sql
[0m12:07:07.354112 [info ] [MainThread]: 
[0m12:07:07.354447 [info ] [MainThread]:   compiled code at target/compiled/citrus_trade/models/staging/stg_trade.sql
[0m12:07:07.354701 [info ] [MainThread]: 
[0m12:07:07.355086 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m12:07:07.355812 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 6.445232, "process_in_blocks": "0", "process_kernel_time": 0.705649, "process_mem_max_rss": "157256", "process_out_blocks": "4021", "process_user_time": 1.59604}
[0m12:07:07.356322 [debug] [MainThread]: Command `dbt run` failed at 12:07:07.356207 after 6.45 seconds
[0m12:07:07.356742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa49e3ce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa49fe540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1b697c0>]}
[0m12:07:07.357204 [debug] [MainThread]: Flushing usage events
[0m12:07:07.863278 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:07:14.788945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95432390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9143a930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95c7a360>]}


============================== 12:07:14.791049 | 1d34ceb4-4aef-4b2e-a472-0d66b5ac23da ==============================
[0m12:07:14.791049 [info ] [MainThread]: Running with dbt=1.10.13
[0m12:07:14.791340 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'write_json': 'True', 'target_path': 'None', 'log_format': 'default', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'version_check': 'True', 'warn_error': 'None', 'introspect': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'debug': 'False', 'profiles_dir': '/app/dbt', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_experimental_parser': 'False', 'no_print': 'None', 'empty': 'False', 'invocation_command': 'dbt run', 'partial_parse': 'True', 'log_cache_events': 'False', 'log_path': '/app/dbt/logs', 'printer_width': '80'}
[0m12:07:14.976174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1d34ceb4-4aef-4b2e-a472-0d66b5ac23da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93c22300>]}
[0m12:07:15.012572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1d34ceb4-4aef-4b2e-a472-0d66b5ac23da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8fd5e6f0>]}
[0m12:07:15.013244 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m12:07:15.063852 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m12:07:15.172614 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:07:15.173034 [debug] [MainThread]: Partial parsing: updated file: citrus_trade://models/staging/stg_trade.sql
[0m12:07:15.289514 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.citrus_trade.analytics
[0m12:07:15.296204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1d34ceb4-4aef-4b2e-a472-0d66b5ac23da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8fa87dd0>]}
[0m12:07:15.339333 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m12:07:15.340616 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m12:07:15.347534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1d34ceb4-4aef-4b2e-a472-0d66b5ac23da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f7ed8e0>]}
[0m12:07:15.347777 [info ] [MainThread]: Found 1 model, 1 source, 632 macros
[0m12:07:15.347957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1d34ceb4-4aef-4b2e-a472-0d66b5ac23da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f8153d0>]}
[0m12:07:15.348851 [info ] [MainThread]: 
[0m12:07:15.349085 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:07:15.349266 [info ] [MainThread]: 
[0m12:07:15.349685 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:07:15.350314 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRHS'
[0m12:07:15.368642 [debug] [ThreadPool]: Using snowflake connection "list_TRHS"
[0m12:07:15.368934 [debug] [ThreadPool]: On list_TRHS: show terse schemas in database TRHS
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS"} */
[0m12:07:15.369087 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:07:15.733368 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.364 seconds
[0m12:07:15.737686 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRHS_staging'
[0m12:07:15.755821 [debug] [ThreadPool]: Using snowflake connection "list_TRHS_staging"
[0m12:07:15.756314 [debug] [ThreadPool]: On list_TRHS_staging: show objects in TRHS.staging
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS_staging"} */;
[0m12:07:15.756688 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:07:16.057894 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.301 seconds
[0m12:07:16.064978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1d34ceb4-4aef-4b2e-a472-0d66b5ac23da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f816810>]}
[0m12:07:16.072127 [debug] [Thread-1 (]: Began running node model.citrus_trade.stg_trade
[0m12:07:16.073100 [info ] [Thread-1 (]: 1 of 1 START sql table model staging.stg_trade ................................. [RUN]
[0m12:07:16.074016 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_TRHS_staging, now model.citrus_trade.stg_trade)
[0m12:07:16.074635 [debug] [Thread-1 (]: Began compiling node model.citrus_trade.stg_trade
[0m12:07:16.085243 [debug] [Thread-1 (]: Writing injected SQL for node "model.citrus_trade.stg_trade"
[0m12:07:16.086710 [debug] [Thread-1 (]: Began executing node model.citrus_trade.stg_trade
[0m12:07:16.116813 [debug] [Thread-1 (]: Writing runtime sql for node "model.citrus_trade.stg_trade"
[0m12:07:16.118184 [debug] [Thread-1 (]: Using snowflake connection "model.citrus_trade.stg_trade"
[0m12:07:16.118512 [debug] [Thread-1 (]: On model.citrus_trade.stg_trade: create or replace transient table TRHS.staging.stg_trade
    
    
    
    as (SELECT
  f.value:declarant::int AS declarant,
  f.value:declarant_iso::string AS declarant_iso
FROM trhs.staging.citrus_ext,
     LATERAL FLATTEN(input => value) f
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.stg_trade"} */;
[0m12:07:16.853691 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.734 seconds
[0m12:07:16.892233 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1d34ceb4-4aef-4b2e-a472-0d66b5ac23da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93c21490>]}
[0m12:07:16.893049 [info ] [Thread-1 (]: 1 of 1 OK created sql table model staging.stg_trade ............................ [[32mSUCCESS 1[0m in 0.82s]
[0m12:07:16.893718 [debug] [Thread-1 (]: Finished running node model.citrus_trade.stg_trade
[0m12:07:16.895561 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:07:16.895945 [debug] [MainThread]: Connection 'list_TRHS' was left open.
[0m12:07:16.896282 [debug] [MainThread]: On list_TRHS: Close
[0m12:07:16.974833 [debug] [MainThread]: Connection 'model.citrus_trade.stg_trade' was left open.
[0m12:07:16.975711 [debug] [MainThread]: On model.citrus_trade.stg_trade: Close
[0m12:07:17.109350 [info ] [MainThread]: 
[0m12:07:17.110615 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.76 seconds (1.76s).
[0m12:07:17.112081 [debug] [MainThread]: Command end result
[0m12:07:17.155911 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m12:07:17.158005 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m12:07:17.162947 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt/target/run_results.json
[0m12:07:17.163184 [info ] [MainThread]: 
[0m12:07:17.163525 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:07:17.163817 [info ] [MainThread]: 
[0m12:07:17.164119 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m12:07:17.165099 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.4039495, "process_in_blocks": "0", "process_kernel_time": 0.181594, "process_mem_max_rss": "156808", "process_out_blocks": "4019", "process_user_time": 1.571448}
[0m12:07:17.165484 [debug] [MainThread]: Command `dbt run` succeeded at 12:07:17.165411 after 2.40 seconds
[0m12:07:17.165747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91476c30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f8be630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f8be1e0>]}
[0m12:07:17.166004 [debug] [MainThread]: Flushing usage events
[0m12:07:17.618543 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:08:31.613386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9eb12180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9eb106b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9eaf0440>]}


============================== 12:08:31.617729 | b6c98ae7-eb60-4006-bd1d-02a4ce933973 ==============================
[0m12:08:31.617729 [info ] [MainThread]: Running with dbt=1.10.13
[0m12:08:31.618110 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'log_format': 'default', 'log_path': '/app/dbt/logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'debug': 'False', 'target_path': 'None', 'log_cache_events': 'False', 'invocation_command': 'dbt run', 'partial_parse': 'True', 'no_print': 'None', 'use_colors': 'True', 'quiet': 'False', 'write_json': 'True', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'fail_fast': 'False', 'warn_error': 'None', 'printer_width': '80', 'profiles_dir': '/app/dbt', 'indirect_selection': 'eager', 'empty': 'False', 'static_parser': 'True', 'use_experimental_parser': 'False'}
[0m12:08:31.823100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b6c98ae7-eb60-4006-bd1d-02a4ce933973', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9cb9a450>]}
[0m12:08:31.853391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b6c98ae7-eb60-4006-bd1d-02a4ce933973', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9cff5760>]}
[0m12:08:31.853881 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m12:08:31.903351 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m12:08:32.018073 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:08:32.018478 [debug] [MainThread]: Partial parsing: updated file: citrus_trade://models/staging/stg_trade.sql
[0m12:08:32.138462 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.citrus_trade.analytics
[0m12:08:32.145317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b6c98ae7-eb60-4006-bd1d-02a4ce933973', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c41ea50>]}
[0m12:08:32.188471 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m12:08:32.189902 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m12:08:32.197852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b6c98ae7-eb60-4006-bd1d-02a4ce933973', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c301940>]}
[0m12:08:32.198109 [info ] [MainThread]: Found 1 model, 1 source, 632 macros
[0m12:08:32.198302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b6c98ae7-eb60-4006-bd1d-02a4ce933973', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c315490>]}
[0m12:08:32.199263 [info ] [MainThread]: 
[0m12:08:32.199499 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:08:32.199776 [info ] [MainThread]: 
[0m12:08:32.200258 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:08:32.200939 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRHS'
[0m12:08:32.226184 [debug] [ThreadPool]: Using snowflake connection "list_TRHS"
[0m12:08:32.226516 [debug] [ThreadPool]: On list_TRHS: show terse schemas in database TRHS
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS"} */
[0m12:08:32.226671 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:08:34.915573 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2.688 seconds
[0m12:08:34.921474 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRHS_staging'
[0m12:08:34.939686 [debug] [ThreadPool]: Using snowflake connection "list_TRHS_staging"
[0m12:08:34.940288 [debug] [ThreadPool]: On list_TRHS_staging: show objects in TRHS.staging
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS_staging"} */;
[0m12:08:34.940777 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:08:37.312891 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2.372 seconds
[0m12:08:37.319272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b6c98ae7-eb60-4006-bd1d-02a4ce933973', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b334740>]}
[0m12:08:37.328193 [debug] [Thread-1 (]: Began running node model.citrus_trade.stg_trade
[0m12:08:37.328946 [info ] [Thread-1 (]: 1 of 1 START sql table model staging.stg_trade ................................. [RUN]
[0m12:08:37.329676 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_TRHS_staging, now model.citrus_trade.stg_trade)
[0m12:08:37.330217 [debug] [Thread-1 (]: Began compiling node model.citrus_trade.stg_trade
[0m12:08:37.340999 [debug] [Thread-1 (]: Writing injected SQL for node "model.citrus_trade.stg_trade"
[0m12:08:37.342836 [debug] [Thread-1 (]: Began executing node model.citrus_trade.stg_trade
[0m12:08:37.373052 [debug] [Thread-1 (]: Writing runtime sql for node "model.citrus_trade.stg_trade"
[0m12:08:37.374301 [debug] [Thread-1 (]: Using snowflake connection "model.citrus_trade.stg_trade"
[0m12:08:37.374625 [debug] [Thread-1 (]: On model.citrus_trade.stg_trade: create or replace transient table TRHS.staging.stg_trade
    
    
    
    as (SELECT
  f.value:DECLARANT::int AS declarant,
  f.value:DECLARANT_ISO::string AS declarant_iso
FROM trhs.staging.citrus_ext,
     LATERAL FLATTEN(input => value) f
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.stg_trade"} */;
[0m12:08:38.159046 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.783 seconds
[0m12:08:38.197748 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6c98ae7-eb60-4006-bd1d-02a4ce933973', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a7eb2c0>]}
[0m12:08:38.198676 [info ] [Thread-1 (]: 1 of 1 OK created sql table model staging.stg_trade ............................ [[32mSUCCESS 1[0m in 0.87s]
[0m12:08:38.199357 [debug] [Thread-1 (]: Finished running node model.citrus_trade.stg_trade
[0m12:08:38.201181 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:08:38.201543 [debug] [MainThread]: Connection 'list_TRHS' was left open.
[0m12:08:38.201890 [debug] [MainThread]: On list_TRHS: Close
[0m12:08:38.290806 [debug] [MainThread]: Connection 'model.citrus_trade.stg_trade' was left open.
[0m12:08:38.291497 [debug] [MainThread]: On model.citrus_trade.stg_trade: Close
[0m12:08:38.378480 [info ] [MainThread]: 
[0m12:08:38.379740 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 6.18 seconds (6.18s).
[0m12:08:38.381595 [debug] [MainThread]: Command end result
[0m12:08:38.430898 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m12:08:38.432909 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m12:08:38.437954 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt/target/run_results.json
[0m12:08:38.438190 [info ] [MainThread]: 
[0m12:08:38.438497 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:08:38.438760 [info ] [MainThread]: 
[0m12:08:38.439071 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m12:08:38.440029 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.856467, "process_in_blocks": "0", "process_kernel_time": 0.381579, "process_mem_max_rss": "156588", "process_out_blocks": "4019", "process_user_time": 1.576395}
[0m12:08:38.440399 [debug] [MainThread]: Command `dbt run` succeeded at 12:08:38.440326 after 6.86 seconds
[0m12:08:38.440674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e6aa8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c4e5970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9eaf0440>]}
[0m12:08:38.440940 [debug] [MainThread]: Flushing usage events
[0m12:08:38.939246 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:09:39.902344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e44d1f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9cead8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ebe9220>]}


============================== 12:09:39.905574 | 638d43f0-4334-4299-b743-9f9e2e4e2f89 ==============================
[0m12:09:39.905574 [info ] [MainThread]: Running with dbt=1.10.13
[0m12:09:39.905922 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'static_parser': 'True', 'profiles_dir': '/app/dbt', 'use_colors': 'True', 'introspect': 'True', 'debug': 'False', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'log_path': '/app/dbt/logs', 'write_json': 'True', 'use_experimental_parser': 'False', 'warn_error': 'None', 'printer_width': '80', 'cache_selected_only': 'False', 'partial_parse': 'True', 'version_check': 'True', 'indirect_selection': 'eager', 'log_format': 'default', 'invocation_command': 'dbt run', 'log_cache_events': 'False', 'empty': 'False'}
[0m12:09:40.111358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '638d43f0-4334-4299-b743-9f9e2e4e2f89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c13c050>]}
[0m12:09:40.142171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '638d43f0-4334-4299-b743-9f9e2e4e2f89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ac9c650>]}
[0m12:09:40.142643 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m12:09:40.194194 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m12:09:40.311216 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:09:40.311599 [debug] [MainThread]: Partial parsing: updated file: citrus_trade://models/staging/stg_trade.sql
[0m12:09:40.431199 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.citrus_trade.analytics
[0m12:09:40.437986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '638d43f0-4334-4299-b743-9f9e2e4e2f89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a7860f0>]}
[0m12:09:40.482147 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m12:09:40.483742 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m12:09:40.491872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '638d43f0-4334-4299-b743-9f9e2e4e2f89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a509940>]}
[0m12:09:40.492122 [info ] [MainThread]: Found 1 model, 1 source, 632 macros
[0m12:09:40.492332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '638d43f0-4334-4299-b743-9f9e2e4e2f89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a5143e0>]}
[0m12:09:40.493268 [info ] [MainThread]: 
[0m12:09:40.493546 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:09:40.494074 [info ] [MainThread]: 
[0m12:09:40.494562 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:09:40.495583 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRHS'
[0m12:09:40.519294 [debug] [ThreadPool]: Using snowflake connection "list_TRHS"
[0m12:09:40.519603 [debug] [ThreadPool]: On list_TRHS: show terse schemas in database TRHS
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS"} */
[0m12:09:40.519794 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:09:41.130958 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.611 seconds
[0m12:09:41.135858 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRHS_staging'
[0m12:09:41.147467 [debug] [ThreadPool]: Using snowflake connection "list_TRHS_staging"
[0m12:09:41.147880 [debug] [ThreadPool]: On list_TRHS_staging: show objects in TRHS.staging
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS_staging"} */;
[0m12:09:41.148133 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:09:41.546854 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.398 seconds
[0m12:09:41.552936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '638d43f0-4334-4299-b743-9f9e2e4e2f89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a7c8fe0>]}
[0m12:09:41.563368 [debug] [Thread-1 (]: Began running node model.citrus_trade.stg_trade
[0m12:09:41.564901 [info ] [Thread-1 (]: 1 of 1 START sql table model staging.stg_trade ................................. [RUN]
[0m12:09:41.565857 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_TRHS_staging, now model.citrus_trade.stg_trade)
[0m12:09:41.566531 [debug] [Thread-1 (]: Began compiling node model.citrus_trade.stg_trade
[0m12:09:41.576405 [debug] [Thread-1 (]: Writing injected SQL for node "model.citrus_trade.stg_trade"
[0m12:09:41.578536 [debug] [Thread-1 (]: Began executing node model.citrus_trade.stg_trade
[0m12:09:41.607345 [debug] [Thread-1 (]: Writing runtime sql for node "model.citrus_trade.stg_trade"
[0m12:09:41.608649 [debug] [Thread-1 (]: Using snowflake connection "model.citrus_trade.stg_trade"
[0m12:09:41.608988 [debug] [Thread-1 (]: On model.citrus_trade.stg_trade: create or replace transient table TRHS.staging.stg_trade
    
    
    
    as (SELECT
*
FROM trhs.staging.citrus_ext,
     LATERAL FLATTEN(input => value) f
limit 10
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.stg_trade"} */;
[0m12:09:41.693525 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01c01979-0105-6a36-0000-000420ca9309
[0m12:09:41.694103 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002025 (42S21): SQL compilation error:
duplicate column name 'VALUE'
[0m12:09:41.697864 [debug] [Thread-1 (]: Database Error in model stg_trade (models/staging/stg_trade.sql)
  002025 (42S21): SQL compilation error:
  duplicate column name 'VALUE'
  compiled code at target/run/citrus_trade/models/staging/stg_trade.sql
[0m12:09:41.699438 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '638d43f0-4334-4299-b743-9f9e2e4e2f89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d002690>]}
[0m12:09:41.700118 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model staging.stg_trade ........................ [[31mERROR[0m in 0.13s]
[0m12:09:41.700778 [debug] [Thread-1 (]: Finished running node model.citrus_trade.stg_trade
[0m12:09:41.701351 [debug] [Thread-7 (]: Marking all children of 'model.citrus_trade.stg_trade' to be skipped because of status 'error'.  Reason: Database Error in model stg_trade (models/staging/stg_trade.sql)
  002025 (42S21): SQL compilation error:
  duplicate column name 'VALUE'
  compiled code at target/run/citrus_trade/models/staging/stg_trade.sql.
[0m12:09:41.703422 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:09:41.703799 [debug] [MainThread]: Connection 'list_TRHS' was left open.
[0m12:09:41.704073 [debug] [MainThread]: On list_TRHS: Close
[0m12:09:41.781453 [debug] [MainThread]: Connection 'model.citrus_trade.stg_trade' was left open.
[0m12:09:41.782046 [debug] [MainThread]: On model.citrus_trade.stg_trade: Close
[0m12:09:41.862587 [info ] [MainThread]: 
[0m12:09:41.863777 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.37 seconds (1.37s).
[0m12:09:41.865639 [debug] [MainThread]: Command end result
[0m12:09:41.912470 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m12:09:41.914403 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m12:09:41.919181 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt/target/run_results.json
[0m12:09:41.919414 [info ] [MainThread]: 
[0m12:09:41.919732 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:09:41.920143 [info ] [MainThread]: 
[0m12:09:41.920508 [error] [MainThread]: [31mFailure in model stg_trade (models/staging/stg_trade.sql)[0m
[0m12:09:41.921023 [error] [MainThread]:   Database Error in model stg_trade (models/staging/stg_trade.sql)
  002025 (42S21): SQL compilation error:
  duplicate column name 'VALUE'
  compiled code at target/run/citrus_trade/models/staging/stg_trade.sql
[0m12:09:41.921376 [info ] [MainThread]: 
[0m12:09:41.921817 [info ] [MainThread]:   compiled code at target/compiled/citrus_trade/models/staging/stg_trade.sql
[0m12:09:41.922034 [info ] [MainThread]: 
[0m12:09:41.922338 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m12:09:41.923199 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.0505779, "process_in_blocks": "0", "process_kernel_time": 0.365225, "process_mem_max_rss": "157244", "process_out_blocks": "4019", "process_user_time": 1.513078}
[0m12:09:41.923594 [debug] [MainThread]: Command `dbt run` failed at 12:09:41.923508 after 2.05 seconds
[0m12:09:41.923969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c952d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a9ef320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a543560>]}
[0m12:09:41.924352 [debug] [MainThread]: Flushing usage events
[0m12:09:42.380420 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:09:51.905175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8cc29670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d0f8cb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d0fbfe0>]}


============================== 12:09:51.907376 | 152d9d3d-be23-48e7-b7b2-6b0db3b32b78 ==============================
[0m12:09:51.907376 [info ] [MainThread]: Running with dbt=1.10.13
[0m12:09:51.907723 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'log_path': '/app/dbt/logs', 'empty': 'False', 'indirect_selection': 'eager', 'invocation_command': 'dbt run', 'quiet': 'False', 'log_cache_events': 'False', 'introspect': 'True', 'partial_parse': 'True', 'write_json': 'True', 'no_print': 'None', 'target_path': 'None', 'cache_selected_only': 'False', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'warn_error': 'None', 'static_parser': 'True', 'profiles_dir': '/app/dbt', 'printer_width': '80'}
[0m12:09:52.086578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '152d9d3d-be23-48e7-b7b2-6b0db3b32b78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8abbf170>]}
[0m12:09:52.116625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '152d9d3d-be23-48e7-b7b2-6b0db3b32b78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c974410>]}
[0m12:09:52.117072 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m12:09:52.165164 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m12:09:52.270502 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:09:52.270899 [debug] [MainThread]: Partial parsing: updated file: citrus_trade://models/staging/stg_trade.sql
[0m12:09:52.385546 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.citrus_trade.analytics
[0m12:09:52.392310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '152d9d3d-be23-48e7-b7b2-6b0db3b32b78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a64ccb0>]}
[0m12:09:52.434483 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m12:09:52.435733 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m12:09:52.442652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '152d9d3d-be23-48e7-b7b2-6b0db3b32b78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a5f59a0>]}
[0m12:09:52.442915 [info ] [MainThread]: Found 1 model, 1 source, 632 macros
[0m12:09:52.443091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '152d9d3d-be23-48e7-b7b2-6b0db3b32b78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a7434d0>]}
[0m12:09:52.443953 [info ] [MainThread]: 
[0m12:09:52.444201 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:09:52.444450 [info ] [MainThread]: 
[0m12:09:52.445001 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:09:52.445681 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRHS'
[0m12:09:52.463399 [debug] [ThreadPool]: Using snowflake connection "list_TRHS"
[0m12:09:52.463700 [debug] [ThreadPool]: On list_TRHS: show terse schemas in database TRHS
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS"} */
[0m12:09:52.463854 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:09:53.126927 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.663 seconds
[0m12:09:53.132745 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRHS, now list_TRHS_staging)
[0m12:09:53.150466 [debug] [ThreadPool]: Using snowflake connection "list_TRHS_staging"
[0m12:09:53.151102 [debug] [ThreadPool]: On list_TRHS_staging: show objects in TRHS.staging
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS_staging"} */;
[0m12:09:53.250625 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.099 seconds
[0m12:09:53.257065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '152d9d3d-be23-48e7-b7b2-6b0db3b32b78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a622810>]}
[0m12:09:53.263325 [debug] [Thread-1 (]: Began running node model.citrus_trade.stg_trade
[0m12:09:53.264187 [info ] [Thread-1 (]: 1 of 1 START sql table model staging.stg_trade ................................. [RUN]
[0m12:09:53.264934 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_TRHS_staging, now model.citrus_trade.stg_trade)
[0m12:09:53.265652 [debug] [Thread-1 (]: Began compiling node model.citrus_trade.stg_trade
[0m12:09:53.277585 [debug] [Thread-1 (]: Writing injected SQL for node "model.citrus_trade.stg_trade"
[0m12:09:53.279250 [debug] [Thread-1 (]: Began executing node model.citrus_trade.stg_trade
[0m12:09:53.311025 [debug] [Thread-1 (]: Writing runtime sql for node "model.citrus_trade.stg_trade"
[0m12:09:53.312394 [debug] [Thread-1 (]: Using snowflake connection "model.citrus_trade.stg_trade"
[0m12:09:53.312762 [debug] [Thread-1 (]: On model.citrus_trade.stg_trade: create or replace transient table TRHS.staging.stg_trade
    
    
    
    as (SELECT
*
FROM trhs.staging.citrus_ext
limit 10
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.stg_trade"} */;
[0m12:09:54.140139 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.826 seconds
[0m12:09:54.178360 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '152d9d3d-be23-48e7-b7b2-6b0db3b32b78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8eac5700>]}
[0m12:09:54.179227 [info ] [Thread-1 (]: 1 of 1 OK created sql table model staging.stg_trade ............................ [[32mSUCCESS 1[0m in 0.91s]
[0m12:09:54.180135 [debug] [Thread-1 (]: Finished running node model.citrus_trade.stg_trade
[0m12:09:54.182150 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:09:54.182510 [debug] [MainThread]: Connection 'model.citrus_trade.stg_trade' was left open.
[0m12:09:54.182945 [debug] [MainThread]: On model.citrus_trade.stg_trade: Close
[0m12:09:54.296203 [info ] [MainThread]: 
[0m12:09:54.297022 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.85 seconds (1.85s).
[0m12:09:54.298542 [debug] [MainThread]: Command end result
[0m12:09:54.342529 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m12:09:54.344711 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m12:09:54.349764 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt/target/run_results.json
[0m12:09:54.350012 [info ] [MainThread]: 
[0m12:09:54.350302 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:09:54.350540 [info ] [MainThread]: 
[0m12:09:54.350955 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m12:09:54.351835 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.4741597, "process_in_blocks": "0", "process_kernel_time": 0.151308, "process_mem_max_rss": "155112", "process_out_blocks": "4016", "process_user_time": 1.463989}
[0m12:09:54.352217 [debug] [MainThread]: Command `dbt run` succeeded at 12:09:54.352129 after 2.47 seconds
[0m12:09:54.352520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c9d5a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d128830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8aaec950>]}
[0m12:09:54.352804 [debug] [MainThread]: Flushing usage events
[0m12:09:54.806416 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:11:25.715319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa34c08c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa379f830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa38bee70>]}


============================== 12:11:25.720694 | f32fb958-61f6-4a0f-a406-b39d843b3634 ==============================
[0m12:11:25.720694 [info ] [MainThread]: Running with dbt=1.10.13
[0m12:11:25.721060 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'empty': 'False', 'debug': 'False', 'target_path': 'None', 'warn_error': 'None', 'profiles_dir': '/app/dbt', 'static_parser': 'True', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'quiet': 'False', 'fail_fast': 'False', 'indirect_selection': 'eager', 'no_print': 'None', 'partial_parse': 'True', 'log_format': 'default', 'printer_width': '80', 'log_path': '/app/dbt/logs', 'invocation_command': 'dbt run', 'cache_selected_only': 'False', 'use_colors': 'True', 'introspect': 'True'}
[0m12:11:25.967624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f32fb958-61f6-4a0f-a406-b39d843b3634', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa54ae3f0>]}
[0m12:11:25.998793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f32fb958-61f6-4a0f-a406-b39d843b3634', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3ad81d0>]}
[0m12:11:25.999331 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m12:11:26.049580 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m12:11:26.165446 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:11:26.165814 [debug] [MainThread]: Partial parsing: updated file: citrus_trade://models/staging/stg_trade.sql
[0m12:11:26.286013 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.citrus_trade.analytics
[0m12:11:26.292981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f32fb958-61f6-4a0f-a406-b39d843b3634', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1040ce0>]}
[0m12:11:26.340972 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m12:11:26.342364 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m12:11:26.350832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f32fb958-61f6-4a0f-a406-b39d843b3634', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1005b20>]}
[0m12:11:26.351078 [info ] [MainThread]: Found 1 model, 1 source, 632 macros
[0m12:11:26.351295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f32fb958-61f6-4a0f-a406-b39d843b3634', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0f58230>]}
[0m12:11:26.352171 [info ] [MainThread]: 
[0m12:11:26.352409 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:11:26.352844 [info ] [MainThread]: 
[0m12:11:26.353281 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:11:26.354160 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRHS'
[0m12:11:26.377518 [debug] [ThreadPool]: Using snowflake connection "list_TRHS"
[0m12:11:26.377834 [debug] [ThreadPool]: On list_TRHS: show terse schemas in database TRHS
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS"} */
[0m12:11:26.377989 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:11:29.065169 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2.687 seconds
[0m12:11:29.072019 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRHS, now list_TRHS_staging)
[0m12:11:29.090610 [debug] [ThreadPool]: Using snowflake connection "list_TRHS_staging"
[0m12:11:29.091164 [debug] [ThreadPool]: On list_TRHS_staging: show objects in TRHS.staging
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS_staging"} */;
[0m12:11:29.204515 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.113 seconds
[0m12:11:29.207592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f32fb958-61f6-4a0f-a406-b39d843b3634', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1042720>]}
[0m12:11:29.213100 [debug] [Thread-1 (]: Began running node model.citrus_trade.stg_trade
[0m12:11:29.213770 [info ] [Thread-1 (]: 1 of 1 START sql table model staging.stg_trade ................................. [RUN]
[0m12:11:29.214372 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_TRHS_staging, now model.citrus_trade.stg_trade)
[0m12:11:29.214898 [debug] [Thread-1 (]: Began compiling node model.citrus_trade.stg_trade
[0m12:11:29.222810 [debug] [Thread-1 (]: Writing injected SQL for node "model.citrus_trade.stg_trade"
[0m12:11:29.224221 [debug] [Thread-1 (]: Began executing node model.citrus_trade.stg_trade
[0m12:11:29.246724 [debug] [Thread-1 (]: Writing runtime sql for node "model.citrus_trade.stg_trade"
[0m12:11:29.248080 [debug] [Thread-1 (]: Using snowflake connection "model.citrus_trade.stg_trade"
[0m12:11:29.248375 [debug] [Thread-1 (]: On model.citrus_trade.stg_trade: create or replace transient table TRHS.staging.stg_trade
    
    
    
    as (SELECT
  value:DECLARANT::int as declarant,
  value:DECLARANT_ISO::string as declarant_iso
FROM trhs.staging.citrus_ext
limit 10
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.stg_trade"} */;
[0m12:11:30.040806 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.792 seconds
[0m12:11:30.078922 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f32fb958-61f6-4a0f-a406-b39d843b3634', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa54ad490>]}
[0m12:11:30.079864 [info ] [Thread-1 (]: 1 of 1 OK created sql table model staging.stg_trade ............................ [[32mSUCCESS 1[0m in 0.86s]
[0m12:11:30.080627 [debug] [Thread-1 (]: Finished running node model.citrus_trade.stg_trade
[0m12:11:30.082455 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:11:30.082799 [debug] [MainThread]: Connection 'model.citrus_trade.stg_trade' was left open.
[0m12:11:30.083126 [debug] [MainThread]: On model.citrus_trade.stg_trade: Close
[0m12:11:30.209897 [info ] [MainThread]: 
[0m12:11:30.211140 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.86 seconds (3.86s).
[0m12:11:30.212806 [debug] [MainThread]: Command end result
[0m12:11:30.258083 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m12:11:30.260405 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m12:11:30.265294 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt/target/run_results.json
[0m12:11:30.265551 [info ] [MainThread]: 
[0m12:11:30.265859 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:11:30.266200 [info ] [MainThread]: 
[0m12:11:30.266524 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m12:11:30.267666 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.582398, "process_in_blocks": "0", "process_kernel_time": 0.397183, "process_mem_max_rss": "155064", "process_out_blocks": "4018", "process_user_time": 1.572603}
[0m12:11:30.268036 [debug] [MainThread]: Command `dbt run` succeeded at 12:11:30.267967 after 4.58 seconds
[0m12:11:30.268349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3448440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa14e49e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa14e4080>]}
[0m12:11:30.268614 [debug] [MainThread]: Flushing usage events
[0m12:11:30.740874 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:14:49.310084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c7b6c30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e25b560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b738860>]}


============================== 12:14:49.313278 | 33dd9c09-e976-4c55-beef-5dd4c79d435a ==============================
[0m12:14:49.313278 [info ] [MainThread]: Running with dbt=1.10.13
[0m12:14:49.313611 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True', 'log_path': '/app/dbt/logs', 'quiet': 'False', 'no_print': 'None', 'warn_error': 'None', 'introspect': 'True', 'target_path': 'None', 'indirect_selection': 'eager', 'profiles_dir': '/app/dbt', 'empty': 'False', 'printer_width': '80', 'partial_parse': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'log_cache_events': 'False', 'version_check': 'True', 'debug': 'False'}
[0m12:14:49.558730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '33dd9c09-e976-4c55-beef-5dd4c79d435a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7deae450>]}
[0m12:14:49.589002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '33dd9c09-e976-4c55-beef-5dd4c79d435a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7bdce420>]}
[0m12:14:49.589452 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m12:14:49.638864 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m12:14:49.753443 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:14:49.753829 [debug] [MainThread]: Partial parsing: updated file: citrus_trade://models/staging/stg_trade.sql
[0m12:14:49.875531 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.citrus_trade.analytics
[0m12:14:49.882225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '33dd9c09-e976-4c55-beef-5dd4c79d435a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff79b16a50>]}
[0m12:14:49.927179 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m12:14:49.928624 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m12:14:49.941262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '33dd9c09-e976-4c55-beef-5dd4c79d435a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff79a01a90>]}
[0m12:14:49.941557 [info ] [MainThread]: Found 1 model, 1 source, 632 macros
[0m12:14:49.941760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '33dd9c09-e976-4c55-beef-5dd4c79d435a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff79a46570>]}
[0m12:14:49.942671 [info ] [MainThread]: 
[0m12:14:49.942891 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:14:49.943158 [info ] [MainThread]: 
[0m12:14:49.943513 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:14:49.944161 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRHS'
[0m12:14:49.968141 [debug] [ThreadPool]: Using snowflake connection "list_TRHS"
[0m12:14:49.968476 [debug] [ThreadPool]: On list_TRHS: show terse schemas in database TRHS
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS"} */
[0m12:14:49.968653 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:14:51.725684 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.757 seconds
[0m12:14:51.731915 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRHS_staging'
[0m12:14:51.750991 [debug] [ThreadPool]: Using snowflake connection "list_TRHS_staging"
[0m12:14:51.751613 [debug] [ThreadPool]: On list_TRHS_staging: show objects in TRHS.staging
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS_staging"} */;
[0m12:14:51.752044 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:14:52.055493 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.303 seconds
[0m12:14:52.062732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '33dd9c09-e976-4c55-beef-5dd4c79d435a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff781242f0>]}
[0m12:14:52.069695 [debug] [Thread-1 (]: Began running node model.citrus_trade.stg_trade
[0m12:14:52.070586 [info ] [Thread-1 (]: 1 of 1 START sql table model staging.stg_trade ................................. [RUN]
[0m12:14:52.071390 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_TRHS_staging, now model.citrus_trade.stg_trade)
[0m12:14:52.072195 [debug] [Thread-1 (]: Began compiling node model.citrus_trade.stg_trade
[0m12:14:52.083227 [debug] [Thread-1 (]: Writing injected SQL for node "model.citrus_trade.stg_trade"
[0m12:14:52.085232 [debug] [Thread-1 (]: Began executing node model.citrus_trade.stg_trade
[0m12:14:52.114788 [debug] [Thread-1 (]: Writing runtime sql for node "model.citrus_trade.stg_trade"
[0m12:14:52.116450 [debug] [Thread-1 (]: Using snowflake connection "model.citrus_trade.stg_trade"
[0m12:14:52.116789 [debug] [Thread-1 (]: On model.citrus_trade.stg_trade: create or replace transient table TRHS.staging.stg_trade
    
    
    
    as (select
  value:DECLARANT::int as declarant,
  value:DECLARANT_ISO::string as declarant_iso,
  value:PARTNER::string as partner,
  value:PARTNER_ISO::string as partner_iso,
  value:FLOW::int as flow,
  value:TRANSPORT_MODE::int as transport_mode,
  value:PERIOD::int as period,
  value:HS4::string as hs4,
  value:HS4_NAME::string as hs4_name,
  value:HS6::string as hs6,
  value:HS6_NAME::string as hs6_name,
  value:VALUE_IN_EUROS::float as value_in_euros,
  value:QUANTITY_IN_KG::float as quantity_in_kg
from trhs.staging.citrus_ext
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.stg_trade"} */;
[0m12:14:52.820826 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.704 seconds
[0m12:14:52.848435 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '33dd9c09-e976-4c55-beef-5dd4c79d435a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7dead550>]}
[0m12:14:52.849159 [info ] [Thread-1 (]: 1 of 1 OK created sql table model staging.stg_trade ............................ [[32mSUCCESS 1[0m in 0.78s]
[0m12:14:52.849836 [debug] [Thread-1 (]: Finished running node model.citrus_trade.stg_trade
[0m12:14:52.851398 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:14:52.851687 [debug] [MainThread]: Connection 'list_TRHS' was left open.
[0m12:14:52.851989 [debug] [MainThread]: On list_TRHS: Close
[0m12:14:52.950562 [debug] [MainThread]: Connection 'model.citrus_trade.stg_trade' was left open.
[0m12:14:52.951094 [debug] [MainThread]: On model.citrus_trade.stg_trade: Close
[0m12:14:53.055744 [info ] [MainThread]: 
[0m12:14:53.057118 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.11 seconds (3.11s).
[0m12:14:53.058858 [debug] [MainThread]: Command end result
[0m12:14:53.158577 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m12:14:53.160025 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m12:14:53.163602 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt/target/run_results.json
[0m12:14:53.163816 [info ] [MainThread]: 
[0m12:14:53.164138 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:14:53.164435 [info ] [MainThread]: 
[0m12:14:53.164748 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m12:14:53.165855 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.8851879, "process_in_blocks": "0", "process_kernel_time": 0.445919, "process_mem_max_rss": "156728", "process_out_blocks": "4025", "process_user_time": 1.597107}
[0m12:14:53.166194 [debug] [MainThread]: Command `dbt run` succeeded at 12:14:53.166117 after 3.89 seconds
[0m12:14:53.166444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7bda3740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff79afe5a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff79cc3bc0>]}
[0m12:14:53.166644 [debug] [MainThread]: Flushing usage events
[0m12:14:53.651321 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:31:12.607042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffba01b7a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbba4d250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb97183b0>]}


============================== 12:31:12.610580 | 5baf4031-a1b9-4932-986a-d6b60c9ad4ad ==============================
[0m12:31:12.610580 [info ] [MainThread]: Running with dbt=1.10.13
[0m12:31:12.611082 [debug] [MainThread]: running dbt with arguments {'empty': 'False', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True', 'quiet': 'False', 'partial_parse': 'True', 'no_print': 'None', 'static_parser': 'True', 'invocation_command': 'dbt run', 'fail_fast': 'False', 'target_path': 'None', 'printer_width': '80', 'warn_error': 'None', 'use_colors': 'True', 'debug': 'False', 'profiles_dir': '/app/dbt', 'log_path': '/app/dbt/logs', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'introspect': 'True', 'log_format': 'default', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False'}
[0m12:31:12.829601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5baf4031-a1b9-4932-986a-d6b60c9ad4ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7a44200>]}
[0m12:31:12.861571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5baf4031-a1b9-4932-986a-d6b60c9ad4ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7bd3530>]}
[0m12:31:12.862179 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m12:31:12.913068 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m12:31:13.027912 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m12:31:13.028308 [debug] [MainThread]: Partial parsing: added file: citrus_trade://models/analytics/trade_by_reporter.sql
[0m12:31:13.158211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5baf4031-a1b9-4932-986a-d6b60c9ad4ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7694ef0>]}
[0m12:31:13.202017 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m12:31:13.203342 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m12:31:13.211235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5baf4031-a1b9-4932-986a-d6b60c9ad4ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb751f050>]}
[0m12:31:13.211507 [info ] [MainThread]: Found 2 models, 1 source, 632 macros
[0m12:31:13.211725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5baf4031-a1b9-4932-986a-d6b60c9ad4ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb743df70>]}
[0m12:31:13.212795 [info ] [MainThread]: 
[0m12:31:13.213114 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:31:13.213444 [info ] [MainThread]: 
[0m12:31:13.213977 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:31:13.216439 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRHS'
[0m12:31:13.223735 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRHS'
[0m12:31:13.240838 [debug] [ThreadPool]: Using snowflake connection "list_TRHS"
[0m12:31:13.241163 [debug] [ThreadPool]: Using snowflake connection "list_TRHS"
[0m12:31:13.241326 [debug] [ThreadPool]: On list_TRHS: show terse schemas in database TRHS
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS"} */
[0m12:31:13.241550 [debug] [ThreadPool]: On list_TRHS: show terse schemas in database TRHS
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS"} */
[0m12:31:13.241729 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:31:13.241917 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:31:16.031878 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2.790 seconds
[0m12:31:16.033201 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2.791 seconds
[0m12:31:16.039805 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRHS, now list_TRHS_staging)
[0m12:31:16.048149 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRHS, now list_TRHS_analytics)
[0m12:31:16.063654 [debug] [ThreadPool]: Using snowflake connection "list_TRHS_staging"
[0m12:31:16.067993 [debug] [ThreadPool]: Using snowflake connection "list_TRHS_analytics"
[0m12:31:16.068375 [debug] [ThreadPool]: On list_TRHS_staging: show objects in TRHS.staging
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS_staging"} */;
[0m12:31:16.068868 [debug] [ThreadPool]: On list_TRHS_analytics: show objects in TRHS.analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS_analytics"} */;
[0m12:31:16.136154 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.067 seconds
[0m12:31:16.140670 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.070 seconds
[0m12:31:16.143385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5baf4031-a1b9-4932-986a-d6b60c9ad4ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb53c89b0>]}
[0m12:31:16.150080 [debug] [Thread-1 (]: Began running node model.citrus_trade.stg_trade
[0m12:31:16.151190 [info ] [Thread-1 (]: 1 of 2 START sql table model staging.stg_trade ................................. [RUN]
[0m12:31:16.151822 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_TRHS_analytics, now model.citrus_trade.stg_trade)
[0m12:31:16.152424 [debug] [Thread-1 (]: Began compiling node model.citrus_trade.stg_trade
[0m12:31:16.160765 [debug] [Thread-1 (]: Writing injected SQL for node "model.citrus_trade.stg_trade"
[0m12:31:16.162730 [debug] [Thread-1 (]: Began executing node model.citrus_trade.stg_trade
[0m12:31:16.189635 [debug] [Thread-1 (]: Writing runtime sql for node "model.citrus_trade.stg_trade"
[0m12:31:16.191879 [debug] [Thread-1 (]: Using snowflake connection "model.citrus_trade.stg_trade"
[0m12:31:16.192391 [debug] [Thread-1 (]: On model.citrus_trade.stg_trade: create or replace transient table TRHS.staging.stg_trade
    
    
    
    as (select
  value:DECLARANT::int as declarant,
  value:DECLARANT_ISO::string as declarant_iso,
  value:PARTNER::string as partner,
  value:PARTNER_ISO::string as partner_iso,
  value:FLOW::int as flow,
  value:TRANSPORT_MODE::int as transport_mode,
  value:PERIOD::int as period,
  value:HS4::string as hs4,
  value:HS4_NAME::string as hs4_name,
  value:HS6::string as hs6,
  value:HS6_NAME::string as hs6_name,
  value:VALUE_IN_EUROS::float as value_in_euros,
  value:QUANTITY_IN_KG::float as quantity_in_kg
from trhs.staging.citrus_ext
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.stg_trade"} */;
[0m12:31:17.008969 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.816 seconds
[0m12:31:17.049200 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5baf4031-a1b9-4932-986a-d6b60c9ad4ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5343320>]}
[0m12:31:17.049988 [info ] [Thread-1 (]: 1 of 2 OK created sql table model staging.stg_trade ............................ [[32mSUCCESS 1[0m in 0.90s]
[0m12:31:17.050914 [debug] [Thread-1 (]: Finished running node model.citrus_trade.stg_trade
[0m12:31:17.052761 [debug] [Thread-3 (]: Began running node model.citrus_trade.trade_by_reporter
[0m12:31:17.053782 [info ] [Thread-3 (]: 2 of 2 START sql table model analytics.trade_by_reporter ....................... [RUN]
[0m12:31:17.054455 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.citrus_trade.trade_by_reporter'
[0m12:31:17.054754 [debug] [Thread-3 (]: Began compiling node model.citrus_trade.trade_by_reporter
[0m12:31:17.058469 [debug] [Thread-3 (]: Writing injected SQL for node "model.citrus_trade.trade_by_reporter"
[0m12:31:17.060663 [debug] [Thread-3 (]: Began executing node model.citrus_trade.trade_by_reporter
[0m12:31:17.065792 [debug] [Thread-3 (]: Writing runtime sql for node "model.citrus_trade.trade_by_reporter"
[0m12:31:17.068008 [debug] [Thread-3 (]: Using snowflake connection "model.citrus_trade.trade_by_reporter"
[0m12:31:17.068478 [debug] [Thread-3 (]: On model.citrus_trade.trade_by_reporter: create or replace transient table TRHS.analytics.trade_by_reporter
    
    
    
    as (select 
    declarant,
    declarant_iso
    partner,
    partner_iso,
    flow,
    transport_mode,
    period,
    hs6,
    hs6_name,
    sum(value_in_euros) as total_value,
    sum(quantity_in_kg) as total_quantity,
    sum(value_in_euros) / nullif(sum(quantity_in_kg), 0) as price_per_kg
from TRHS.staging.stg_trade
group by 1,2,3,4,5,6,7,8,9
group by 1,2,3,4,5,6,7,8,9
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.trade_by_reporter"} */;
[0m12:31:17.068746 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:31:17.474341 [debug] [Thread-3 (]: Snowflake adapter: Snowflake query id: 01c0198f-0105-6a36-0000-000420ca9401
[0m12:31:17.475579 [debug] [Thread-3 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 20 at position 0 unexpected 'group'.
[0m12:31:17.479193 [debug] [Thread-3 (]: Database Error in model trade_by_reporter (models/analytics/trade_by_reporter.sql)
  001003 (42000): SQL compilation error:
  syntax error line 20 at position 0 unexpected 'group'.
  compiled code at target/run/citrus_trade/models/analytics/trade_by_reporter.sql
[0m12:31:17.480171 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5baf4031-a1b9-4932-986a-d6b60c9ad4ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb533f320>]}
[0m12:31:17.481241 [error] [Thread-3 (]: 2 of 2 ERROR creating sql table model analytics.trade_by_reporter .............. [[31mERROR[0m in 0.43s]
[0m12:31:17.482404 [debug] [Thread-3 (]: Finished running node model.citrus_trade.trade_by_reporter
[0m12:31:17.482959 [debug] [Thread-7 (]: Marking all children of 'model.citrus_trade.trade_by_reporter' to be skipped because of status 'error'.  Reason: Database Error in model trade_by_reporter (models/analytics/trade_by_reporter.sql)
  001003 (42000): SQL compilation error:
  syntax error line 20 at position 0 unexpected 'group'.
  compiled code at target/run/citrus_trade/models/analytics/trade_by_reporter.sql.
[0m12:31:17.484920 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:31:17.485222 [debug] [MainThread]: Connection 'model.citrus_trade.stg_trade' was left open.
[0m12:31:17.485396 [debug] [MainThread]: On model.citrus_trade.stg_trade: Close
[0m12:31:17.585613 [debug] [MainThread]: Connection 'list_TRHS_staging' was left open.
[0m12:31:17.587047 [debug] [MainThread]: On list_TRHS_staging: Close
[0m12:31:17.688178 [debug] [MainThread]: Connection 'model.citrus_trade.trade_by_reporter' was left open.
[0m12:31:17.689567 [debug] [MainThread]: On model.citrus_trade.trade_by_reporter: Close
[0m12:31:17.774310 [info ] [MainThread]: 
[0m12:31:17.775358 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 4.56 seconds (4.56s).
[0m12:31:17.777247 [debug] [MainThread]: Command end result
[0m12:31:17.818112 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m12:31:17.820824 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m12:31:17.826929 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt/target/run_results.json
[0m12:31:17.827214 [info ] [MainThread]: 
[0m12:31:17.827536 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:31:17.827923 [info ] [MainThread]: 
[0m12:31:17.828464 [error] [MainThread]: [31mFailure in model trade_by_reporter (models/analytics/trade_by_reporter.sql)[0m
[0m12:31:17.828892 [error] [MainThread]:   Database Error in model trade_by_reporter (models/analytics/trade_by_reporter.sql)
  001003 (42000): SQL compilation error:
  syntax error line 20 at position 0 unexpected 'group'.
  compiled code at target/run/citrus_trade/models/analytics/trade_by_reporter.sql
[0m12:31:17.829471 [info ] [MainThread]: 
[0m12:31:17.830137 [info ] [MainThread]:   compiled code at target/compiled/citrus_trade/models/analytics/trade_by_reporter.sql
[0m12:31:17.830643 [info ] [MainThread]: 
[0m12:31:17.831194 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=2
[0m12:31:17.832761 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 5.2593923, "process_in_blocks": "0", "process_kernel_time": 0.403897, "process_mem_max_rss": "164256", "process_out_blocks": "4055", "process_user_time": 1.732429}
[0m12:31:17.833200 [debug] [MainThread]: Command `dbt run` failed at 12:31:17.833124 after 5.26 seconds
[0m12:31:17.833558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb9677aa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7983bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7981bb0>]}
[0m12:31:17.833816 [debug] [MainThread]: Flushing usage events
[0m12:31:18.356220 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:32:40.072506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8516a9f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87ce9bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff862090a0>]}


============================== 12:32:40.075852 | c0111cb7-362a-4c32-abfd-87bcc36a41fd ==============================
[0m12:32:40.075852 [info ] [MainThread]: Running with dbt=1.10.13
[0m12:32:40.076208 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'quiet': 'False', 'fail_fast': 'False', 'cache_selected_only': 'False', 'no_print': 'None', 'printer_width': '80', 'log_format': 'default', 'use_colors': 'True', 'profiles_dir': '/app/dbt', 'debug': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'static_parser': 'True', 'introspect': 'True', 'warn_error': 'None', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_path': '/app/dbt/logs'}
[0m12:32:40.300180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c0111cb7-362a-4c32-abfd-87bcc36a41fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85103d70>]}
[0m12:32:40.331090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c0111cb7-362a-4c32-abfd-87bcc36a41fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85910aa0>]}
[0m12:32:40.331546 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m12:32:40.383291 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m12:32:40.495564 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:32:40.495993 [debug] [MainThread]: Partial parsing: updated file: citrus_trade://models/analytics/trade_by_reporter.sql
[0m12:32:40.627281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c0111cb7-362a-4c32-abfd-87bcc36a41fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff834cd850>]}
[0m12:32:40.670579 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m12:32:40.671998 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m12:32:40.680075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c0111cb7-362a-4c32-abfd-87bcc36a41fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff837b9370>]}
[0m12:32:40.680335 [info ] [MainThread]: Found 2 models, 1 source, 632 macros
[0m12:32:40.680546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c0111cb7-362a-4c32-abfd-87bcc36a41fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83547c80>]}
[0m12:32:40.681471 [info ] [MainThread]: 
[0m12:32:40.681794 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:32:40.682375 [info ] [MainThread]: 
[0m12:32:40.682755 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:32:40.685156 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRHS'
[0m12:32:40.691535 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRHS'
[0m12:32:40.710710 [debug] [ThreadPool]: Using snowflake connection "list_TRHS"
[0m12:32:40.711016 [debug] [ThreadPool]: Using snowflake connection "list_TRHS"
[0m12:32:40.711201 [debug] [ThreadPool]: On list_TRHS: show terse schemas in database TRHS
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS"} */
[0m12:32:40.711442 [debug] [ThreadPool]: On list_TRHS: show terse schemas in database TRHS
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS"} */
[0m12:32:40.711631 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:32:40.711825 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:32:42.494871 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.783 seconds
[0m12:32:42.500996 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.789 seconds
[0m12:32:42.505197 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRHS, now list_TRHS_staging)
[0m12:32:42.511711 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRHS, now list_TRHS_analytics)
[0m12:32:42.530946 [debug] [ThreadPool]: Using snowflake connection "list_TRHS_staging"
[0m12:32:42.533695 [debug] [ThreadPool]: Using snowflake connection "list_TRHS_analytics"
[0m12:32:42.534005 [debug] [ThreadPool]: On list_TRHS_staging: show objects in TRHS.staging
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS_staging"} */;
[0m12:32:42.534560 [debug] [ThreadPool]: On list_TRHS_analytics: show objects in TRHS.analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS_analytics"} */;
[0m12:32:42.602532 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.068 seconds
[0m12:32:42.609229 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.073 seconds
[0m12:32:42.611849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c0111cb7-362a-4c32-abfd-87bcc36a41fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83a7c6e0>]}
[0m12:32:42.617077 [debug] [Thread-1 (]: Began running node model.citrus_trade.stg_trade
[0m12:32:42.618154 [info ] [Thread-1 (]: 1 of 2 START sql table model staging.stg_trade ................................. [RUN]
[0m12:32:42.618725 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_TRHS_analytics, now model.citrus_trade.stg_trade)
[0m12:32:42.619282 [debug] [Thread-1 (]: Began compiling node model.citrus_trade.stg_trade
[0m12:32:42.627969 [debug] [Thread-1 (]: Writing injected SQL for node "model.citrus_trade.stg_trade"
[0m12:32:42.629524 [debug] [Thread-1 (]: Began executing node model.citrus_trade.stg_trade
[0m12:32:42.656548 [debug] [Thread-1 (]: Writing runtime sql for node "model.citrus_trade.stg_trade"
[0m12:32:42.658097 [debug] [Thread-1 (]: Using snowflake connection "model.citrus_trade.stg_trade"
[0m12:32:42.658426 [debug] [Thread-1 (]: On model.citrus_trade.stg_trade: create or replace transient table TRHS.staging.stg_trade
    
    
    
    as (select
  value:DECLARANT::int as declarant,
  value:DECLARANT_ISO::string as declarant_iso,
  value:PARTNER::string as partner,
  value:PARTNER_ISO::string as partner_iso,
  value:FLOW::int as flow,
  value:TRANSPORT_MODE::int as transport_mode,
  value:PERIOD::int as period,
  value:HS4::string as hs4,
  value:HS4_NAME::string as hs4_name,
  value:HS6::string as hs6,
  value:HS6_NAME::string as hs6_name,
  value:VALUE_IN_EUROS::float as value_in_euros,
  value:QUANTITY_IN_KG::float as quantity_in_kg
from trhs.staging.citrus_ext
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.stg_trade"} */;
[0m12:32:43.348301 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.689 seconds
[0m12:32:43.380387 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c0111cb7-362a-4c32-abfd-87bcc36a41fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87985670>]}
[0m12:32:43.381346 [info ] [Thread-1 (]: 1 of 2 OK created sql table model staging.stg_trade ............................ [[32mSUCCESS 1[0m in 0.76s]
[0m12:32:43.382664 [debug] [Thread-1 (]: Finished running node model.citrus_trade.stg_trade
[0m12:32:43.383987 [debug] [Thread-3 (]: Began running node model.citrus_trade.trade_by_reporter
[0m12:32:43.384606 [info ] [Thread-3 (]: 2 of 2 START sql table model analytics.trade_by_reporter ....................... [RUN]
[0m12:32:43.385297 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.citrus_trade.trade_by_reporter'
[0m12:32:43.385785 [debug] [Thread-3 (]: Began compiling node model.citrus_trade.trade_by_reporter
[0m12:32:43.389278 [debug] [Thread-3 (]: Writing injected SQL for node "model.citrus_trade.trade_by_reporter"
[0m12:32:43.390768 [debug] [Thread-3 (]: Began executing node model.citrus_trade.trade_by_reporter
[0m12:32:43.393452 [debug] [Thread-3 (]: Writing runtime sql for node "model.citrus_trade.trade_by_reporter"
[0m12:32:43.395645 [debug] [Thread-3 (]: Using snowflake connection "model.citrus_trade.trade_by_reporter"
[0m12:32:43.396091 [debug] [Thread-3 (]: On model.citrus_trade.trade_by_reporter: create or replace transient table TRHS.analytics.trade_by_reporter
    
    
    
    as (select 
    declarant,
    declarant_iso
    partner,
    partner_iso,
    flow,
    transport_mode,
    period,
    hs6,
    hs6_name,
    sum(value_in_euros) as total_value,
    sum(quantity_in_kg) as total_quantity,
    sum(value_in_euros) / nullif(sum(quantity_in_kg), 0) as price_per_kg
from TRHS.staging.stg_trade
group by 1,2,3,4,5,6,7,8,9
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.trade_by_reporter"} */;
[0m12:32:43.396462 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:32:43.701567 [debug] [Thread-3 (]: Snowflake adapter: Snowflake query id: 01c01990-0105-6a36-0000-000420ca9461
[0m12:32:43.702818 [debug] [Thread-3 (]: Snowflake adapter: Snowflake error: 000979 (42601): SQL compilation error:
[TOTAL_VALUE] is not a valid group by expression
[0m12:32:43.709099 [debug] [Thread-3 (]: Database Error in model trade_by_reporter (models/analytics/trade_by_reporter.sql)
  000979 (42601): SQL compilation error:
  [TOTAL_VALUE] is not a valid group by expression
  compiled code at target/run/citrus_trade/models/analytics/trade_by_reporter.sql
[0m12:32:43.710160 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c0111cb7-362a-4c32-abfd-87bcc36a41fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7a1919a0>]}
[0m12:32:43.711307 [error] [Thread-3 (]: 2 of 2 ERROR creating sql table model analytics.trade_by_reporter .............. [[31mERROR[0m in 0.32s]
[0m12:32:43.712377 [debug] [Thread-3 (]: Finished running node model.citrus_trade.trade_by_reporter
[0m12:32:43.713354 [debug] [Thread-7 (]: Marking all children of 'model.citrus_trade.trade_by_reporter' to be skipped because of status 'error'.  Reason: Database Error in model trade_by_reporter (models/analytics/trade_by_reporter.sql)
  000979 (42601): SQL compilation error:
  [TOTAL_VALUE] is not a valid group by expression
  compiled code at target/run/citrus_trade/models/analytics/trade_by_reporter.sql.
[0m12:32:43.716378 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:32:43.716830 [debug] [MainThread]: Connection 'model.citrus_trade.stg_trade' was left open.
[0m12:32:43.717259 [debug] [MainThread]: On model.citrus_trade.stg_trade: Close
[0m12:32:43.798674 [debug] [MainThread]: Connection 'list_TRHS_staging' was left open.
[0m12:32:43.799557 [debug] [MainThread]: On list_TRHS_staging: Close
[0m12:32:43.889625 [debug] [MainThread]: Connection 'model.citrus_trade.trade_by_reporter' was left open.
[0m12:32:43.890441 [debug] [MainThread]: On model.citrus_trade.trade_by_reporter: Close
[0m12:32:43.998796 [info ] [MainThread]: 
[0m12:32:43.999675 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 3.32 seconds (3.32s).
[0m12:32:44.001286 [debug] [MainThread]: Command end result
[0m12:32:44.032129 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m12:32:44.033874 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m12:32:44.038547 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt/target/run_results.json
[0m12:32:44.038816 [info ] [MainThread]: 
[0m12:32:44.039153 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:32:44.039505 [info ] [MainThread]: 
[0m12:32:44.040275 [error] [MainThread]: [31mFailure in model trade_by_reporter (models/analytics/trade_by_reporter.sql)[0m
[0m12:32:44.040604 [error] [MainThread]:   Database Error in model trade_by_reporter (models/analytics/trade_by_reporter.sql)
  000979 (42601): SQL compilation error:
  [TOTAL_VALUE] is not a valid group by expression
  compiled code at target/run/citrus_trade/models/analytics/trade_by_reporter.sql
[0m12:32:44.041102 [info ] [MainThread]: 
[0m12:32:44.041495 [info ] [MainThread]:   compiled code at target/compiled/citrus_trade/models/analytics/trade_by_reporter.sql
[0m12:32:44.041776 [info ] [MainThread]: 
[0m12:32:44.042158 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=2
[0m12:32:44.042990 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 4.0066533, "process_in_blocks": "0", "process_kernel_time": 0.406912, "process_mem_max_rss": "164948", "process_out_blocks": "4054", "process_user_time": 1.704822}
[0m12:32:44.043474 [debug] [MainThread]: Command `dbt run` failed at 12:32:44.043369 after 4.01 seconds
[0m12:32:44.043925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87419bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85139670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff835d32f0>]}
[0m12:32:44.044249 [debug] [MainThread]: Flushing usage events
[0m12:32:44.539464 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:35:29.313517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9cd38b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d5aaed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d0f3e60>]}


============================== 12:35:29.316681 | c576fcda-0724-47c0-a6d8-cdf750a35889 ==============================
[0m12:35:29.316681 [info ] [MainThread]: Running with dbt=1.10.13
[0m12:35:29.317039 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'log_format': 'default', 'debug': 'False', 'no_print': 'None', 'cache_selected_only': 'False', 'static_parser': 'True', 'use_colors': 'True', 'log_path': '/app/dbt/logs', 'write_json': 'True', 'quiet': 'False', 'introspect': 'True', 'version_check': 'True', 'profiles_dir': '/app/dbt', 'indirect_selection': 'eager', 'empty': 'False', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run', 'log_cache_events': 'False', 'warn_error': 'None', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m12:35:29.520440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c576fcda-0724-47c0-a6d8-cdf750a35889', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b8ec200>]}
[0m12:35:29.550810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c576fcda-0724-47c0-a6d8-cdf750a35889', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b556780>]}
[0m12:35:29.551261 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m12:35:29.600643 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m12:35:29.710784 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:35:29.711161 [debug] [MainThread]: Partial parsing: updated file: citrus_trade://models/analytics/trade_by_reporter.sql
[0m12:35:29.848199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c576fcda-0724-47c0-a6d8-cdf750a35889', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b041010>]}
[0m12:35:29.896909 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m12:35:29.898394 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m12:35:29.906596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c576fcda-0724-47c0-a6d8-cdf750a35889', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9af7ef60>]}
[0m12:35:29.906878 [info ] [MainThread]: Found 2 models, 1 source, 632 macros
[0m12:35:29.907099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c576fcda-0724-47c0-a6d8-cdf750a35889', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b02b3b0>]}
[0m12:35:29.907984 [info ] [MainThread]: 
[0m12:35:29.908205 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:35:29.908609 [info ] [MainThread]: 
[0m12:35:29.908995 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:35:29.911537 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRHS'
[0m12:35:29.917323 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRHS'
[0m12:35:29.935298 [debug] [ThreadPool]: Using snowflake connection "list_TRHS"
[0m12:35:29.935604 [debug] [ThreadPool]: Using snowflake connection "list_TRHS"
[0m12:35:29.935773 [debug] [ThreadPool]: On list_TRHS: show terse schemas in database TRHS
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS"} */
[0m12:35:29.935991 [debug] [ThreadPool]: On list_TRHS: show terse schemas in database TRHS
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS"} */
[0m12:35:29.936176 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:35:29.936376 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:35:32.811086 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2.874 seconds
[0m12:35:32.812281 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2.876 seconds
[0m12:35:32.819609 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRHS, now list_TRHS_analytics)
[0m12:35:32.827035 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRHS, now list_TRHS_staging)
[0m12:35:32.839157 [debug] [ThreadPool]: Using snowflake connection "list_TRHS_staging"
[0m12:35:32.841653 [debug] [ThreadPool]: Using snowflake connection "list_TRHS_analytics"
[0m12:35:32.842042 [debug] [ThreadPool]: On list_TRHS_staging: show objects in TRHS.staging
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS_staging"} */;
[0m12:35:32.842492 [debug] [ThreadPool]: On list_TRHS_analytics: show objects in TRHS.analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS_analytics"} */;
[0m12:35:32.917966 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.074 seconds
[0m12:35:32.962774 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.120 seconds
[0m12:35:32.968378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c576fcda-0724-47c0-a6d8-cdf750a35889', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b5786b0>]}
[0m12:35:32.976494 [debug] [Thread-1 (]: Began running node model.citrus_trade.stg_trade
[0m12:35:32.977348 [info ] [Thread-1 (]: 1 of 2 START sql table model staging.stg_trade ................................. [RUN]
[0m12:35:32.977981 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_TRHS_staging, now model.citrus_trade.stg_trade)
[0m12:35:32.978531 [debug] [Thread-1 (]: Began compiling node model.citrus_trade.stg_trade
[0m12:35:32.989299 [debug] [Thread-1 (]: Writing injected SQL for node "model.citrus_trade.stg_trade"
[0m12:35:32.991081 [debug] [Thread-1 (]: Began executing node model.citrus_trade.stg_trade
[0m12:35:33.021631 [debug] [Thread-1 (]: Writing runtime sql for node "model.citrus_trade.stg_trade"
[0m12:35:33.023209 [debug] [Thread-1 (]: Using snowflake connection "model.citrus_trade.stg_trade"
[0m12:35:33.023544 [debug] [Thread-1 (]: On model.citrus_trade.stg_trade: create or replace transient table TRHS.staging.stg_trade
    
    
    
    as (select
  value:DECLARANT::int as declarant,
  value:DECLARANT_ISO::string as declarant_iso,
  value:PARTNER::string as partner,
  value:PARTNER_ISO::string as partner_iso,
  value:FLOW::int as flow,
  value:TRANSPORT_MODE::int as transport_mode,
  value:PERIOD::int as period,
  value:HS4::string as hs4,
  value:HS4_NAME::string as hs4_name,
  value:HS6::string as hs6,
  value:HS6_NAME::string as hs6_name,
  value:VALUE_IN_EUROS::float as value_in_euros,
  value:QUANTITY_IN_KG::float as quantity_in_kg
from trhs.staging.citrus_ext
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.stg_trade"} */;
[0m12:35:33.728778 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.705 seconds
[0m12:35:33.763053 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c576fcda-0724-47c0-a6d8-cdf750a35889', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9dae6570>]}
[0m12:35:33.764088 [info ] [Thread-1 (]: 1 of 2 OK created sql table model staging.stg_trade ............................ [[32mSUCCESS 1[0m in 0.78s]
[0m12:35:33.764911 [debug] [Thread-1 (]: Finished running node model.citrus_trade.stg_trade
[0m12:35:33.765843 [debug] [Thread-3 (]: Began running node model.citrus_trade.trade_by_reporter
[0m12:35:33.766414 [info ] [Thread-3 (]: 2 of 2 START sql table model analytics.trade_by_reporter ....................... [RUN]
[0m12:35:33.767136 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.citrus_trade.trade_by_reporter'
[0m12:35:33.767520 [debug] [Thread-3 (]: Began compiling node model.citrus_trade.trade_by_reporter
[0m12:35:33.770867 [debug] [Thread-3 (]: Writing injected SQL for node "model.citrus_trade.trade_by_reporter"
[0m12:35:33.773036 [debug] [Thread-3 (]: Began executing node model.citrus_trade.trade_by_reporter
[0m12:35:33.775686 [debug] [Thread-3 (]: Writing runtime sql for node "model.citrus_trade.trade_by_reporter"
[0m12:35:33.777299 [debug] [Thread-3 (]: Using snowflake connection "model.citrus_trade.trade_by_reporter"
[0m12:35:33.777617 [debug] [Thread-3 (]: On model.citrus_trade.trade_by_reporter: create or replace transient table TRHS.analytics.trade_by_reporter
    
    
    
    as (select 
    declarant,
    declarant_iso
    partner,
    partner_iso,
    flow,
    transport_mode,
    period,
    hs6,
    hs6_name,
    sum(value_in_euros) as total_value,
    sum(quantity_in_kg) as total_quantity,
    sum(value_in_euros) / nullif(sum(quantity_in_kg), 0) as price_per_kg
from TRHS.staging.stg_trade
group by 1,2,3,4,5,6,7,8
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.trade_by_reporter"} */;
[0m12:35:33.777904 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:35:34.754117 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.975 seconds
[0m12:35:34.759175 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c576fcda-0724-47c0-a6d8-cdf750a35889', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff901903b0>]}
[0m12:35:34.760339 [info ] [Thread-3 (]: 2 of 2 OK created sql table model analytics.trade_by_reporter .................. [[32mSUCCESS 1[0m in 0.99s]
[0m12:35:34.761446 [debug] [Thread-3 (]: Finished running node model.citrus_trade.trade_by_reporter
[0m12:35:34.764013 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:35:34.764659 [debug] [MainThread]: Connection 'list_TRHS_analytics' was left open.
[0m12:35:34.765182 [debug] [MainThread]: On list_TRHS_analytics: Close
[0m12:35:34.866671 [debug] [MainThread]: Connection 'model.citrus_trade.stg_trade' was left open.
[0m12:35:34.867959 [debug] [MainThread]: On model.citrus_trade.stg_trade: Close
[0m12:35:34.980835 [debug] [MainThread]: Connection 'model.citrus_trade.trade_by_reporter' was left open.
[0m12:35:34.982237 [debug] [MainThread]: On model.citrus_trade.trade_by_reporter: Close
[0m12:35:35.063599 [info ] [MainThread]: 
[0m12:35:35.065283 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 5.15 seconds (5.15s).
[0m12:35:35.067843 [debug] [MainThread]: Command end result
[0m12:35:35.112672 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m12:35:35.114716 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m12:35:35.120174 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt/target/run_results.json
[0m12:35:35.120386 [info ] [MainThread]: 
[0m12:35:35.120671 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:35:35.121089 [info ] [MainThread]: 
[0m12:35:35.121450 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m12:35:35.122318 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.8391247, "process_in_blocks": "0", "process_kernel_time": 0.371587, "process_mem_max_rss": "164340", "process_out_blocks": "4051", "process_user_time": 1.767307}
[0m12:35:35.122667 [debug] [MainThread]: Command `dbt run` succeeded at 12:35:35.122602 after 5.84 seconds
[0m12:35:35.122927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d1a2960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b5b4800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9af58d40>]}
[0m12:35:35.123171 [debug] [MainThread]: Flushing usage events
[0m12:35:35.638561 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:30:15.050987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4bab740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4440a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa465e630>]}


============================== 10:30:15.061269 | 2c04698f-87a4-43dc-b893-243af15c3c08 ==============================
[0m10:30:15.061269 [info ] [MainThread]: Running with dbt=1.10.13
[0m10:30:15.061827 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'log_format': 'default', 'target_path': 'None', 'log_path': '/app/dbt/logs', 'version_check': 'True', 'log_cache_events': 'False', 'static_parser': 'True', 'introspect': 'True', 'no_print': 'None', 'invocation_command': 'dbt run', 'indirect_selection': 'eager', 'printer_width': '80', 'partial_parse': 'True', 'profiles_dir': '/app/dbt', 'use_experimental_parser': 'False', 'debug': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'cache_selected_only': 'False', 'empty': 'False', 'write_json': 'True', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'quiet': 'False'}
[0m10:30:15.346461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2c04698f-87a4-43dc-b893-243af15c3c08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2cba450>]}
[0m10:30:15.377555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2c04698f-87a4-43dc-b893-243af15c3c08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa55b7350>]}
[0m10:30:15.378033 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m10:30:15.428877 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m10:30:15.556469 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:30:15.556928 [debug] [MainThread]: Partial parsing: updated file: citrus_trade://models/analytics/trade_by_reporter.sql
[0m10:30:15.691571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2c04698f-87a4-43dc-b893-243af15c3c08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa283f980>]}
[0m10:30:15.734726 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m10:30:15.736696 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m10:30:15.750482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2c04698f-87a4-43dc-b893-243af15c3c08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2664170>]}
[0m10:30:15.750771 [info ] [MainThread]: Found 2 models, 1 source, 632 macros
[0m10:30:15.751038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2c04698f-87a4-43dc-b893-243af15c3c08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa281e5a0>]}
[0m10:30:15.752022 [info ] [MainThread]: 
[0m10:30:15.752241 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:30:15.752446 [info ] [MainThread]: 
[0m10:30:15.752813 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:30:15.755140 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRHS'
[0m10:30:15.761055 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRHS'
[0m10:30:15.789656 [debug] [ThreadPool]: Using snowflake connection "list_TRHS"
[0m10:30:15.789979 [debug] [ThreadPool]: Using snowflake connection "list_TRHS"
[0m10:30:15.790149 [debug] [ThreadPool]: On list_TRHS: show terse schemas in database TRHS
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS"} */
[0m10:30:15.790355 [debug] [ThreadPool]: On list_TRHS: show terse schemas in database TRHS
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS"} */
[0m10:30:15.790527 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:30:15.790715 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:30:19.206198 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 3.415 seconds
[0m10:30:19.291537 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 3.501 seconds
[0m10:30:19.297738 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRHS, now list_TRHS_analytics)
[0m10:30:19.304650 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRHS, now list_TRHS_staging)
[0m10:30:19.328868 [debug] [ThreadPool]: Using snowflake connection "list_TRHS_staging"
[0m10:30:19.323645 [debug] [ThreadPool]: Using snowflake connection "list_TRHS_analytics"
[0m10:30:19.329520 [debug] [ThreadPool]: On list_TRHS_staging: show objects in TRHS.staging
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS_staging"} */;
[0m10:30:19.329914 [debug] [ThreadPool]: On list_TRHS_analytics: show objects in TRHS.analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS_analytics"} */;
[0m10:30:19.443394 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.112 seconds
[0m10:30:19.453001 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.123 seconds
[0m10:30:19.457126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2c04698f-87a4-43dc-b893-243af15c3c08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa28efc50>]}
[0m10:30:19.464612 [debug] [Thread-1 (]: Began running node model.citrus_trade.stg_trade
[0m10:30:19.465434 [info ] [Thread-1 (]: 1 of 2 START sql table model staging.stg_trade ................................. [RUN]
[0m10:30:19.466086 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_TRHS_staging, now model.citrus_trade.stg_trade)
[0m10:30:19.466693 [debug] [Thread-1 (]: Began compiling node model.citrus_trade.stg_trade
[0m10:30:19.477224 [debug] [Thread-1 (]: Writing injected SQL for node "model.citrus_trade.stg_trade"
[0m10:30:19.479457 [debug] [Thread-1 (]: Began executing node model.citrus_trade.stg_trade
[0m10:30:19.508362 [debug] [Thread-1 (]: Writing runtime sql for node "model.citrus_trade.stg_trade"
[0m10:30:19.510410 [debug] [Thread-1 (]: Using snowflake connection "model.citrus_trade.stg_trade"
[0m10:30:19.510760 [debug] [Thread-1 (]: On model.citrus_trade.stg_trade: create or replace transient table TRHS.staging.stg_trade
    
    
    
    as (select
  value:DECLARANT::int as declarant,
  value:DECLARANT_ISO::string as declarant_iso,
  value:PARTNER::string as partner,
  value:PARTNER_ISO::string as partner_iso,
  value:FLOW::int as flow,
  value:TRANSPORT_MODE::int as transport_mode,
  value:PERIOD::int as period,
  value:HS4::string as hs4,
  value:HS4_NAME::string as hs4_name,
  value:HS6::string as hs6,
  value:HS6_NAME::string as hs6_name,
  value:VALUE_IN_EUROS::float as value_in_euros,
  value:QUANTITY_IN_KG::float as quantity_in_kg
from trhs.staging.citrus_ext
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.stg_trade"} */;
[0m10:30:20.842000 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.330 seconds
[0m10:30:20.876557 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2c04698f-87a4-43dc-b893-243af15c3c08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6b515e0>]}
[0m10:30:20.877492 [info ] [Thread-1 (]: 1 of 2 OK created sql table model staging.stg_trade ............................ [[32mSUCCESS 1[0m in 1.41s]
[0m10:30:20.878689 [debug] [Thread-1 (]: Finished running node model.citrus_trade.stg_trade
[0m10:30:20.879930 [debug] [Thread-3 (]: Began running node model.citrus_trade.trade_by_reporter
[0m10:30:20.880551 [info ] [Thread-3 (]: 2 of 2 START sql table model analytics.trade_by_reporter ....................... [RUN]
[0m10:30:20.881199 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.citrus_trade.trade_by_reporter'
[0m10:30:20.881645 [debug] [Thread-3 (]: Began compiling node model.citrus_trade.trade_by_reporter
[0m10:30:20.885477 [debug] [Thread-3 (]: Writing injected SQL for node "model.citrus_trade.trade_by_reporter"
[0m10:30:20.890435 [debug] [Thread-3 (]: Began executing node model.citrus_trade.trade_by_reporter
[0m10:30:20.901056 [debug] [Thread-3 (]: Writing runtime sql for node "model.citrus_trade.trade_by_reporter"
[0m10:30:20.902964 [debug] [Thread-3 (]: Using snowflake connection "model.citrus_trade.trade_by_reporter"
[0m10:30:20.903336 [debug] [Thread-3 (]: On model.citrus_trade.trade_by_reporter: create or replace transient table TRHS.analytics.trade_by_reporter
    
    
    
    as (select 
    declarant,
    declarant_iso,
    partner,
    partner_iso,
    flow,
    transport_mode,
    period,
    hs6,
    hs6_name,
    sum(value_in_euros) as total_value,
    sum(quantity_in_kg) as total_quantity,
    sum(value_in_euros) / nullif(sum(quantity_in_kg), 0) as price_per_kg
from TRHS.staging.stg_trade
group by 1,2,3,4,5,6,7,8
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.trade_by_reporter"} */;
[0m10:30:20.903634 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m10:30:21.291175 [debug] [Thread-3 (]: Snowflake adapter: Snowflake query id: 01c029f6-0105-6cf2-0000-000420cab371
[0m10:30:21.292069 [debug] [Thread-3 (]: Snowflake adapter: Snowflake error: 001104 (42601): SQL compilation error: error line 14 at position 4
'STG_TRADE.HS6_NAME' in select clause is neither an aggregate nor in the group by clause.
[0m10:30:21.306323 [debug] [Thread-3 (]: Database Error in model trade_by_reporter (models/analytics/trade_by_reporter.sql)
  001104 (42601): SQL compilation error: error line 14 at position 4
  'STG_TRADE.HS6_NAME' in select clause is neither an aggregate nor in the group by clause.
  compiled code at target/run/citrus_trade/models/analytics/trade_by_reporter.sql
[0m10:30:21.307093 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2c04698f-87a4-43dc-b893-243af15c3c08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9bf9fb30>]}
[0m10:30:21.311179 [error] [Thread-3 (]: 2 of 2 ERROR creating sql table model analytics.trade_by_reporter .............. [[31mERROR[0m in 0.43s]
[0m10:30:21.311940 [debug] [Thread-3 (]: Finished running node model.citrus_trade.trade_by_reporter
[0m10:30:21.314000 [debug] [Thread-7 (]: Marking all children of 'model.citrus_trade.trade_by_reporter' to be skipped because of status 'error'.  Reason: Database Error in model trade_by_reporter (models/analytics/trade_by_reporter.sql)
  001104 (42601): SQL compilation error: error line 14 at position 4
  'STG_TRADE.HS6_NAME' in select clause is neither an aggregate nor in the group by clause.
  compiled code at target/run/citrus_trade/models/analytics/trade_by_reporter.sql.
[0m10:30:21.316017 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:30:21.316363 [debug] [MainThread]: Connection 'model.citrus_trade.stg_trade' was left open.
[0m10:30:21.316576 [debug] [MainThread]: On model.citrus_trade.stg_trade: Close
[0m10:30:21.465492 [debug] [MainThread]: Connection 'list_TRHS_analytics' was left open.
[0m10:30:21.466536 [debug] [MainThread]: On list_TRHS_analytics: Close
[0m10:30:21.633406 [debug] [MainThread]: Connection 'model.citrus_trade.trade_by_reporter' was left open.
[0m10:30:21.634313 [debug] [MainThread]: On model.citrus_trade.trade_by_reporter: Close
[0m10:30:21.738198 [info ] [MainThread]: 
[0m10:30:21.739507 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 5.98 seconds (5.98s).
[0m10:30:21.741849 [debug] [MainThread]: Command end result
[0m10:30:21.786365 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m10:30:21.788420 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m10:30:21.794249 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt/target/run_results.json
[0m10:30:21.794506 [info ] [MainThread]: 
[0m10:30:21.794830 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m10:30:21.795235 [info ] [MainThread]: 
[0m10:30:21.795694 [error] [MainThread]: [31mFailure in model trade_by_reporter (models/analytics/trade_by_reporter.sql)[0m
[0m10:30:21.796049 [error] [MainThread]:   Database Error in model trade_by_reporter (models/analytics/trade_by_reporter.sql)
  001104 (42601): SQL compilation error: error line 14 at position 4
  'STG_TRADE.HS6_NAME' in select clause is neither an aggregate nor in the group by clause.
  compiled code at target/run/citrus_trade/models/analytics/trade_by_reporter.sql
[0m10:30:21.796353 [info ] [MainThread]: 
[0m10:30:21.796803 [info ] [MainThread]:   compiled code at target/compiled/citrus_trade/models/analytics/trade_by_reporter.sql
[0m10:30:21.797160 [info ] [MainThread]: 
[0m10:30:21.797682 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=2
[0m10:30:21.798921 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 6.784171, "process_in_blocks": "0", "process_kernel_time": 1.049107, "process_mem_max_rss": "167728", "process_out_blocks": "9031", "process_user_time": 2.121306}
[0m10:30:21.799272 [debug] [MainThread]: Command `dbt run` failed at 10:30:21.799201 after 6.78 seconds
[0m10:30:21.799560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4ef15b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa29ba9c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa465e630>]}
[0m10:30:21.799858 [debug] [MainThread]: Flushing usage events
[0m10:30:22.376646 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:30:30.119158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5eba3f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3da7530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3b264b0>]}


============================== 10:30:30.122178 | 7c378ded-78df-41b0-987e-0274c45fa30d ==============================
[0m10:30:30.122178 [info ] [MainThread]: Running with dbt=1.10.13
[0m10:30:30.122619 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'indirect_selection': 'eager', 'write_json': 'True', 'fail_fast': 'False', 'no_print': 'None', 'printer_width': '80', 'introspect': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/app/dbt', 'log_path': '/app/dbt/logs', 'empty': 'False', 'log_format': 'default', 'use_experimental_parser': 'False', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'partial_parse': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_colors': 'True', 'invocation_command': 'dbt run', 'version_check': 'True', 'log_cache_events': 'False', 'warn_error': 'None', 'debug': 'False'}
[0m10:30:30.306655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7c378ded-78df-41b0-987e-0274c45fa30d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1ceb2c0>]}
[0m10:30:30.339881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7c378ded-78df-41b0-987e-0274c45fa30d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb21a6ab0>]}
[0m10:30:30.340555 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m10:30:30.398987 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m10:30:30.510751 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:30:30.511175 [debug] [MainThread]: Partial parsing: updated file: citrus_trade://models/analytics/trade_by_reporter.sql
[0m10:30:30.636343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7c378ded-78df-41b0-987e-0274c45fa30d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb15841d0>]}
[0m10:30:30.679817 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m10:30:30.681181 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m10:30:30.688172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7c378ded-78df-41b0-987e-0274c45fa30d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb153c890>]}
[0m10:30:30.688425 [info ] [MainThread]: Found 2 models, 1 source, 632 macros
[0m10:30:30.688632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7c378ded-78df-41b0-987e-0274c45fa30d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb133f290>]}
[0m10:30:30.689632 [info ] [MainThread]: 
[0m10:30:30.689881 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:30:30.690138 [info ] [MainThread]: 
[0m10:30:30.690612 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:30:30.693291 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRHS'
[0m10:30:30.699550 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRHS'
[0m10:30:30.714359 [debug] [ThreadPool]: Using snowflake connection "list_TRHS"
[0m10:30:30.714665 [debug] [ThreadPool]: Using snowflake connection "list_TRHS"
[0m10:30:30.714835 [debug] [ThreadPool]: On list_TRHS: show terse schemas in database TRHS
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS"} */
[0m10:30:30.715071 [debug] [ThreadPool]: On list_TRHS: show terse schemas in database TRHS
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS"} */
[0m10:30:30.715292 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:30:30.715484 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:30:31.192478 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.477 seconds
[0m10:30:31.193556 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.478 seconds
[0m10:30:31.198566 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRHS, now list_TRHS_staging)
[0m10:30:31.205632 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRHS, now list_TRHS_analytics)
[0m10:30:31.214918 [debug] [ThreadPool]: Using snowflake connection "list_TRHS_analytics"
[0m10:30:31.215484 [debug] [ThreadPool]: Using snowflake connection "list_TRHS_staging"
[0m10:30:31.215760 [debug] [ThreadPool]: On list_TRHS_analytics: show objects in TRHS.analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS_analytics"} */;
[0m10:30:31.216126 [debug] [ThreadPool]: On list_TRHS_staging: show objects in TRHS.staging
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS_staging"} */;
[0m10:30:31.293271 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.076 seconds
[0m10:30:31.312826 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.096 seconds
[0m10:30:31.316315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7c378ded-78df-41b0-987e-0274c45fa30d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1798a40>]}
[0m10:30:31.320987 [debug] [Thread-1 (]: Began running node model.citrus_trade.stg_trade
[0m10:30:31.321774 [info ] [Thread-1 (]: 1 of 2 START sql table model staging.stg_trade ................................. [RUN]
[0m10:30:31.322438 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_TRHS_staging, now model.citrus_trade.stg_trade)
[0m10:30:31.322953 [debug] [Thread-1 (]: Began compiling node model.citrus_trade.stg_trade
[0m10:30:31.332615 [debug] [Thread-1 (]: Writing injected SQL for node "model.citrus_trade.stg_trade"
[0m10:30:31.333959 [debug] [Thread-1 (]: Began executing node model.citrus_trade.stg_trade
[0m10:30:31.362000 [debug] [Thread-1 (]: Writing runtime sql for node "model.citrus_trade.stg_trade"
[0m10:30:31.363487 [debug] [Thread-1 (]: Using snowflake connection "model.citrus_trade.stg_trade"
[0m10:30:31.363760 [debug] [Thread-1 (]: On model.citrus_trade.stg_trade: create or replace transient table TRHS.staging.stg_trade
    
    
    
    as (select
  value:DECLARANT::int as declarant,
  value:DECLARANT_ISO::string as declarant_iso,
  value:PARTNER::string as partner,
  value:PARTNER_ISO::string as partner_iso,
  value:FLOW::int as flow,
  value:TRANSPORT_MODE::int as transport_mode,
  value:PERIOD::int as period,
  value:HS4::string as hs4,
  value:HS4_NAME::string as hs4_name,
  value:HS6::string as hs6,
  value:HS6_NAME::string as hs6_name,
  value:VALUE_IN_EUROS::float as value_in_euros,
  value:QUANTITY_IN_KG::float as quantity_in_kg
from trhs.staging.citrus_ext
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.stg_trade"} */;
[0m10:30:32.413452 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.049 seconds
[0m10:30:32.452153 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c378ded-78df-41b0-987e-0274c45fa30d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffab404d10>]}
[0m10:30:32.453260 [info ] [Thread-1 (]: 1 of 2 OK created sql table model staging.stg_trade ............................ [[32mSUCCESS 1[0m in 1.13s]
[0m10:30:32.454029 [debug] [Thread-1 (]: Finished running node model.citrus_trade.stg_trade
[0m10:30:32.455453 [debug] [Thread-3 (]: Began running node model.citrus_trade.trade_by_reporter
[0m10:30:32.456138 [info ] [Thread-3 (]: 2 of 2 START sql table model analytics.trade_by_reporter ....................... [RUN]
[0m10:30:32.456737 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.citrus_trade.trade_by_reporter'
[0m10:30:32.457197 [debug] [Thread-3 (]: Began compiling node model.citrus_trade.trade_by_reporter
[0m10:30:32.461511 [debug] [Thread-3 (]: Writing injected SQL for node "model.citrus_trade.trade_by_reporter"
[0m10:30:32.462874 [debug] [Thread-3 (]: Began executing node model.citrus_trade.trade_by_reporter
[0m10:30:32.465835 [debug] [Thread-3 (]: Writing runtime sql for node "model.citrus_trade.trade_by_reporter"
[0m10:30:32.467637 [debug] [Thread-3 (]: Using snowflake connection "model.citrus_trade.trade_by_reporter"
[0m10:30:32.468171 [debug] [Thread-3 (]: On model.citrus_trade.trade_by_reporter: create or replace transient table TRHS.analytics.trade_by_reporter
    
    
    
    as (select 
    declarant,
    declarant_iso,
    partner,
    partner_iso,
    flow,
    transport_mode,
    period,
    hs6,
    hs6_name,
    sum(value_in_euros) as total_value,
    sum(quantity_in_kg) as total_quantity,
    sum(value_in_euros) / nullif(sum(quantity_in_kg), 0) as price_per_kg
from TRHS.staging.stg_trade
group by 1,2,3,4,5,6,7,8,9
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.trade_by_reporter"} */;
[0m10:30:32.468492 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m10:30:33.692430 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.224 seconds
[0m10:30:33.694163 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c378ded-78df-41b0-987e-0274c45fa30d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffab4cad80>]}
[0m10:30:33.694590 [info ] [Thread-3 (]: 2 of 2 OK created sql table model analytics.trade_by_reporter .................. [[32mSUCCESS 1[0m in 1.24s]
[0m10:30:33.694972 [debug] [Thread-3 (]: Finished running node model.citrus_trade.trade_by_reporter
[0m10:30:33.696301 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:30:33.696547 [debug] [MainThread]: Connection 'model.citrus_trade.stg_trade' was left open.
[0m10:30:33.696717 [debug] [MainThread]: On model.citrus_trade.stg_trade: Close
[0m10:30:33.862827 [debug] [MainThread]: Connection 'list_TRHS_analytics' was left open.
[0m10:30:33.863229 [debug] [MainThread]: On list_TRHS_analytics: Close
[0m10:30:33.954560 [debug] [MainThread]: Connection 'model.citrus_trade.trade_by_reporter' was left open.
[0m10:30:33.955467 [debug] [MainThread]: On model.citrus_trade.trade_by_reporter: Close
[0m10:30:34.048578 [info ] [MainThread]: 
[0m10:30:34.050598 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 3.36 seconds (3.36s).
[0m10:30:34.052478 [debug] [MainThread]: Command end result
[0m10:30:34.099360 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m10:30:34.101762 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m10:30:34.106912 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt/target/run_results.json
[0m10:30:34.107181 [info ] [MainThread]: 
[0m10:30:34.107481 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:30:34.107877 [info ] [MainThread]: 
[0m10:30:34.108358 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m10:30:34.109343 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.022018, "process_in_blocks": "0", "process_kernel_time": 0.191262, "process_mem_max_rss": "159696", "process_out_blocks": "4052", "process_user_time": 1.663986}
[0m10:30:34.109750 [debug] [MainThread]: Command `dbt run` succeeded at 10:30:34.109654 after 4.02 seconds
[0m10:30:34.110052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3c81a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb17e2b70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb13d62d0>]}
[0m10:30:34.110345 [debug] [MainThread]: Flushing usage events
[0m10:30:34.613792 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:38:46.949709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b5a61b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f0ab710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b174590>]}


============================== 11:38:46.953232 | 69ab816c-aa31-4ab3-ae83-3dcc8517c4a5 ==============================
[0m11:38:46.953232 [info ] [MainThread]: Running with dbt=1.10.13
[0m11:38:46.953636 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run', 'use_experimental_parser': 'False', 'profiles_dir': '/app/dbt', 'partial_parse': 'True', 'log_cache_events': 'False', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'debug': 'False', 'no_print': 'None', 'write_json': 'True', 'warn_error': 'None', 'indirect_selection': 'eager', 'version_check': 'True', 'empty': 'False', 'use_colors': 'True', 'target_path': 'None', 'log_format': 'default', 'log_path': '/app/dbt/logs', 'cache_selected_only': 'False', 'introspect': 'True', 'fail_fast': 'False', 'quiet': 'False', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:38:47.182895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '69ab816c-aa31-4ab3-ae83-3dcc8517c4a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a849df0>]}
[0m11:38:47.216458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '69ab816c-aa31-4ab3-ae83-3dcc8517c4a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8989f740>]}
[0m11:38:47.217015 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m11:38:47.265515 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m11:38:47.392271 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:38:47.392685 [debug] [MainThread]: Partial parsing: updated file: citrus_trade://models/analytics/trade_by_reporter.sql
[0m11:38:47.518974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '69ab816c-aa31-4ab3-ae83-3dcc8517c4a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88e44b30>]}
[0m11:38:47.561565 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m11:38:47.563053 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m11:38:47.571012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '69ab816c-aa31-4ab3-ae83-3dcc8517c4a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff894377d0>]}
[0m11:38:47.571294 [info ] [MainThread]: Found 2 models, 1 source, 632 macros
[0m11:38:47.571521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '69ab816c-aa31-4ab3-ae83-3dcc8517c4a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89791160>]}
[0m11:38:47.572488 [info ] [MainThread]: 
[0m11:38:47.572711 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:38:47.572934 [info ] [MainThread]: 
[0m11:38:47.573464 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:38:47.576109 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRHS'
[0m11:38:47.583439 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRHS'
[0m11:38:47.602227 [debug] [ThreadPool]: Using snowflake connection "list_TRHS"
[0m11:38:47.602572 [debug] [ThreadPool]: Using snowflake connection "list_TRHS"
[0m11:38:47.602746 [debug] [ThreadPool]: On list_TRHS: show terse schemas in database TRHS
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS"} */
[0m11:38:47.602980 [debug] [ThreadPool]: On list_TRHS: show terse schemas in database TRHS
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS"} */
[0m11:38:47.603173 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:38:47.603375 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:38:49.401788 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.798 seconds
[0m11:38:49.436596 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.833 seconds
[0m11:38:49.442718 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRHS, now list_TRHS_analytics)
[0m11:38:49.443811 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRHS, now list_TRHS_staging)
[0m11:38:49.468530 [debug] [ThreadPool]: Using snowflake connection "list_TRHS_analytics"
[0m11:38:49.472955 [debug] [ThreadPool]: Using snowflake connection "list_TRHS_staging"
[0m11:38:49.473308 [debug] [ThreadPool]: On list_TRHS_analytics: show objects in TRHS.analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS_analytics"} */;
[0m11:38:49.473784 [debug] [ThreadPool]: On list_TRHS_staging: show objects in TRHS.staging
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS_staging"} */;
[0m11:38:49.550342 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.076 seconds
[0m11:38:49.555282 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.080 seconds
[0m11:38:49.558919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '69ab816c-aa31-4ab3-ae83-3dcc8517c4a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89362180>]}
[0m11:38:49.564583 [debug] [Thread-1 (]: Began running node model.citrus_trade.stg_trade
[0m11:38:49.565805 [info ] [Thread-1 (]: 1 of 2 START sql table model staging.stg_trade ................................. [RUN]
[0m11:38:49.566711 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_TRHS_analytics, now model.citrus_trade.stg_trade)
[0m11:38:49.567358 [debug] [Thread-1 (]: Began compiling node model.citrus_trade.stg_trade
[0m11:38:49.576266 [debug] [Thread-1 (]: Writing injected SQL for node "model.citrus_trade.stg_trade"
[0m11:38:49.578412 [debug] [Thread-1 (]: Began executing node model.citrus_trade.stg_trade
[0m11:38:49.605698 [debug] [Thread-1 (]: Writing runtime sql for node "model.citrus_trade.stg_trade"
[0m11:38:49.607448 [debug] [Thread-1 (]: Using snowflake connection "model.citrus_trade.stg_trade"
[0m11:38:49.607782 [debug] [Thread-1 (]: On model.citrus_trade.stg_trade: create or replace transient table TRHS.staging.stg_trade
    
    
    
    as (select
  value:DECLARANT::int as declarant,
  value:DECLARANT_ISO::string as declarant_iso,
  value:PARTNER::string as partner,
  value:PARTNER_ISO::string as partner_iso,
  value:FLOW::int as flow,
  value:TRANSPORT_MODE::int as transport_mode,
  value:PERIOD::int as period,
  value:HS4::string as hs4,
  value:HS4_NAME::string as hs4_name,
  value:HS6::string as hs6,
  value:HS6_NAME::string as hs6_name,
  value:VALUE_IN_EUROS::float as value_in_euros,
  value:QUANTITY_IN_KG::float as quantity_in_kg
from trhs.staging.citrus_ext
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.stg_trade"} */;
[0m11:38:50.537661 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.929 seconds
[0m11:38:50.566216 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '69ab816c-aa31-4ab3-ae83-3dcc8517c4a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b8fa450>]}
[0m11:38:50.567088 [info ] [Thread-1 (]: 1 of 2 OK created sql table model staging.stg_trade ............................ [[32mSUCCESS 1[0m in 1.00s]
[0m11:38:50.567838 [debug] [Thread-1 (]: Finished running node model.citrus_trade.stg_trade
[0m11:38:50.568814 [debug] [Thread-3 (]: Began running node model.citrus_trade.trade_by_reporter
[0m11:38:50.569356 [info ] [Thread-3 (]: 2 of 2 START sql table model analytics.trade_by_reporter ....................... [RUN]
[0m11:38:50.570045 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.citrus_trade.trade_by_reporter'
[0m11:38:50.570419 [debug] [Thread-3 (]: Began compiling node model.citrus_trade.trade_by_reporter
[0m11:38:50.574120 [debug] [Thread-3 (]: Writing injected SQL for node "model.citrus_trade.trade_by_reporter"
[0m11:38:50.575810 [debug] [Thread-3 (]: Began executing node model.citrus_trade.trade_by_reporter
[0m11:38:50.578561 [debug] [Thread-3 (]: Writing runtime sql for node "model.citrus_trade.trade_by_reporter"
[0m11:38:50.580605 [debug] [Thread-3 (]: Using snowflake connection "model.citrus_trade.trade_by_reporter"
[0m11:38:50.581018 [debug] [Thread-3 (]: On model.citrus_trade.trade_by_reporter: create or replace transient table TRHS.analytics.trade_by_reporter
    
    
    
    as (with base as (

    select 
        declarant,
        declarant_iso,
        partner,
        partner_iso,
        flow,
        transport_mode,
        period,
        hs6,
        hs6_name,
        sum(value_in_euros) as total_value,
        sum(quantity_in_kg) as total_quantity,
        sum(value_in_euros) / nullif(sum(quantity_in_kg), 0) as value_per_quantity
    from TRHS.staging.stg_trade
    group by 1,2,3,4,5,6,7,8,9

)

select 
    declarant,
    declarant_iso,
    partner,
    partner_iso,
    flow,
    transport_mode,
    period,
    hs6,
    hs6_name,
    metric_type,
    metric_value
from base
unpivot(
    value for metric in (
        total_value,
        total_quantity,
        value_per_quantity
    )
)
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.trade_by_reporter"} */;
[0m11:38:50.581410 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m11:38:50.885304 [debug] [Thread-3 (]: Snowflake adapter: Snowflake query id: 01c02a3a-0105-6cf2-0000-000420cab739
[0m11:38:50.886233 [debug] [Thread-3 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 45 at position 151 unexpected ';'.
[0m11:38:50.891991 [debug] [Thread-3 (]: Database Error in model trade_by_reporter (models/analytics/trade_by_reporter.sql)
  001003 (42000): SQL compilation error:
  syntax error line 45 at position 151 unexpected ';'.
  compiled code at target/run/citrus_trade/models/analytics/trade_by_reporter.sql
[0m11:38:50.892829 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '69ab816c-aa31-4ab3-ae83-3dcc8517c4a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7971bfe0>]}
[0m11:38:50.893529 [error] [Thread-3 (]: 2 of 2 ERROR creating sql table model analytics.trade_by_reporter .............. [[31mERROR[0m in 0.32s]
[0m11:38:50.894270 [debug] [Thread-3 (]: Finished running node model.citrus_trade.trade_by_reporter
[0m11:38:50.894887 [debug] [Thread-7 (]: Marking all children of 'model.citrus_trade.trade_by_reporter' to be skipped because of status 'error'.  Reason: Database Error in model trade_by_reporter (models/analytics/trade_by_reporter.sql)
  001003 (42000): SQL compilation error:
  syntax error line 45 at position 151 unexpected ';'.
  compiled code at target/run/citrus_trade/models/analytics/trade_by_reporter.sql.
[0m11:38:50.896993 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:38:50.897320 [debug] [MainThread]: Connection 'model.citrus_trade.stg_trade' was left open.
[0m11:38:50.897661 [debug] [MainThread]: On model.citrus_trade.stg_trade: Close
[0m11:38:51.030232 [debug] [MainThread]: Connection 'list_TRHS_staging' was left open.
[0m11:38:51.031206 [debug] [MainThread]: On list_TRHS_staging: Close
[0m11:38:51.157575 [debug] [MainThread]: Connection 'model.citrus_trade.trade_by_reporter' was left open.
[0m11:38:51.158700 [debug] [MainThread]: On model.citrus_trade.trade_by_reporter: Close
[0m11:38:51.296793 [info ] [MainThread]: 
[0m11:38:51.297923 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 3.72 seconds (3.72s).
[0m11:38:51.299805 [debug] [MainThread]: Command end result
[0m11:38:51.346203 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m11:38:51.348366 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m11:38:51.354288 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt/target/run_results.json
[0m11:38:51.354609 [info ] [MainThread]: 
[0m11:38:51.354877 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m11:38:51.355200 [info ] [MainThread]: 
[0m11:38:51.355632 [error] [MainThread]: [31mFailure in model trade_by_reporter (models/analytics/trade_by_reporter.sql)[0m
[0m11:38:51.356003 [error] [MainThread]:   Database Error in model trade_by_reporter (models/analytics/trade_by_reporter.sql)
  001003 (42000): SQL compilation error:
  syntax error line 45 at position 151 unexpected ';'.
  compiled code at target/run/citrus_trade/models/analytics/trade_by_reporter.sql
[0m11:38:51.356283 [info ] [MainThread]: 
[0m11:38:51.356647 [info ] [MainThread]:   compiled code at target/compiled/citrus_trade/models/analytics/trade_by_reporter.sql
[0m11:38:51.356944 [info ] [MainThread]: 
[0m11:38:51.357533 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=2
[0m11:38:51.358771 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 4.4445877, "process_in_blocks": "0", "process_kernel_time": 0.466308, "process_mem_max_rss": "164872", "process_out_blocks": "4062", "process_user_time": 1.723315}
[0m11:38:51.359099 [debug] [MainThread]: Command `dbt run` failed at 11:38:51.359037 after 4.45 seconds
[0m11:38:51.359398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f8b2900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8929eab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ae1baa0>]}
[0m11:38:51.359657 [debug] [MainThread]: Flushing usage events
[0m11:38:51.881191 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:39:53.107846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b369e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ad38b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d815940>]}


============================== 11:39:53.111172 | 0d10a3e8-6818-4b30-8491-09a2406ae80a ==============================
[0m11:39:53.111172 [info ] [MainThread]: Running with dbt=1.10.13
[0m11:39:53.111527 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'static_parser': 'True', 'printer_width': '80', 'target_path': 'None', 'version_check': 'True', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'empty': 'False', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': '/app/dbt/logs', 'use_colors': 'True', 'log_format': 'default', 'use_experimental_parser': 'False', 'quiet': 'False', 'fail_fast': 'False', 'log_cache_events': 'False', 'introspect': 'True', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/app/dbt', 'write_json': 'True', 'no_print': 'None'}
[0m11:39:53.340790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0d10a3e8-6818-4b30-8491-09a2406ae80a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b76d520>]}
[0m11:39:53.372455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0d10a3e8-6818-4b30-8491-09a2406ae80a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99853230>]}
[0m11:39:53.373004 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m11:39:53.421955 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m11:39:53.535577 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:39:53.535992 [debug] [MainThread]: Partial parsing: updated file: citrus_trade://models/analytics/trade_by_reporter.sql
[0m11:39:53.665107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0d10a3e8-6818-4b30-8491-09a2406ae80a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99116900>]}
[0m11:39:53.708812 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m11:39:53.710154 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m11:39:53.718212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0d10a3e8-6818-4b30-8491-09a2406ae80a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff992b2a20>]}
[0m11:39:53.718460 [info ] [MainThread]: Found 2 models, 1 source, 632 macros
[0m11:39:53.718680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0d10a3e8-6818-4b30-8491-09a2406ae80a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9927d3a0>]}
[0m11:39:53.719575 [info ] [MainThread]: 
[0m11:39:53.719800 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:39:53.719969 [info ] [MainThread]: 
[0m11:39:53.720390 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:39:53.723031 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRHS'
[0m11:39:53.728999 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRHS'
[0m11:39:53.748914 [debug] [ThreadPool]: Using snowflake connection "list_TRHS"
[0m11:39:53.749220 [debug] [ThreadPool]: Using snowflake connection "list_TRHS"
[0m11:39:53.751187 [debug] [ThreadPool]: On list_TRHS: show terse schemas in database TRHS
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS"} */
[0m11:39:53.751394 [debug] [ThreadPool]: On list_TRHS: show terse schemas in database TRHS
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS"} */
[0m11:39:53.751595 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:39:53.751816 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:39:56.502491 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2.750 seconds
[0m11:39:56.503815 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2.752 seconds
[0m11:39:56.511113 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRHS, now list_TRHS_analytics)
[0m11:39:56.518115 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRHS, now list_TRHS_staging)
[0m11:39:56.535728 [debug] [ThreadPool]: Using snowflake connection "list_TRHS_analytics"
[0m11:39:56.539806 [debug] [ThreadPool]: Using snowflake connection "list_TRHS_staging"
[0m11:39:56.540172 [debug] [ThreadPool]: On list_TRHS_analytics: show objects in TRHS.analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS_analytics"} */;
[0m11:39:56.540616 [debug] [ThreadPool]: On list_TRHS_staging: show objects in TRHS.staging
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS_staging"} */;
[0m11:39:56.629012 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.088 seconds
[0m11:39:56.661930 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.119 seconds
[0m11:39:56.667448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0d10a3e8-6818-4b30-8491-09a2406ae80a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98e8bbf0>]}
[0m11:39:56.673928 [debug] [Thread-1 (]: Began running node model.citrus_trade.stg_trade
[0m11:39:56.675388 [info ] [Thread-1 (]: 1 of 2 START sql table model staging.stg_trade ................................. [RUN]
[0m11:39:56.676332 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_TRHS_staging, now model.citrus_trade.stg_trade)
[0m11:39:56.676991 [debug] [Thread-1 (]: Began compiling node model.citrus_trade.stg_trade
[0m11:39:56.687122 [debug] [Thread-1 (]: Writing injected SQL for node "model.citrus_trade.stg_trade"
[0m11:39:56.689117 [debug] [Thread-1 (]: Began executing node model.citrus_trade.stg_trade
[0m11:39:56.799914 [debug] [Thread-1 (]: Writing runtime sql for node "model.citrus_trade.stg_trade"
[0m11:39:56.801862 [debug] [Thread-1 (]: Using snowflake connection "model.citrus_trade.stg_trade"
[0m11:39:56.802193 [debug] [Thread-1 (]: On model.citrus_trade.stg_trade: create or replace transient table TRHS.staging.stg_trade
    
    
    
    as (select
  value:DECLARANT::int as declarant,
  value:DECLARANT_ISO::string as declarant_iso,
  value:PARTNER::string as partner,
  value:PARTNER_ISO::string as partner_iso,
  value:FLOW::int as flow,
  value:TRANSPORT_MODE::int as transport_mode,
  value:PERIOD::int as period,
  value:HS4::string as hs4,
  value:HS4_NAME::string as hs4_name,
  value:HS6::string as hs6,
  value:HS6_NAME::string as hs6_name,
  value:VALUE_IN_EUROS::float as value_in_euros,
  value:QUANTITY_IN_KG::float as quantity_in_kg
from trhs.staging.citrus_ext
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.stg_trade"} */;
[0m11:39:57.608204 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.805 seconds
[0m11:39:57.642538 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d10a3e8-6818-4b30-8491-09a2406ae80a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d4ad610>]}
[0m11:39:57.643548 [info ] [Thread-1 (]: 1 of 2 OK created sql table model staging.stg_trade ............................ [[32mSUCCESS 1[0m in 0.97s]
[0m11:39:57.644672 [debug] [Thread-1 (]: Finished running node model.citrus_trade.stg_trade
[0m11:39:57.645663 [debug] [Thread-3 (]: Began running node model.citrus_trade.trade_by_reporter
[0m11:39:57.646220 [info ] [Thread-3 (]: 2 of 2 START sql table model analytics.trade_by_reporter ....................... [RUN]
[0m11:39:57.646780 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.citrus_trade.trade_by_reporter'
[0m11:39:57.647187 [debug] [Thread-3 (]: Began compiling node model.citrus_trade.trade_by_reporter
[0m11:39:57.650669 [debug] [Thread-3 (]: Writing injected SQL for node "model.citrus_trade.trade_by_reporter"
[0m11:39:57.652008 [debug] [Thread-3 (]: Began executing node model.citrus_trade.trade_by_reporter
[0m11:39:57.654670 [debug] [Thread-3 (]: Writing runtime sql for node "model.citrus_trade.trade_by_reporter"
[0m11:39:57.656293 [debug] [Thread-3 (]: Using snowflake connection "model.citrus_trade.trade_by_reporter"
[0m11:39:57.656623 [debug] [Thread-3 (]: On model.citrus_trade.trade_by_reporter: create or replace transient table TRHS.analytics.trade_by_reporter
    
    
    
    as (with base as (
    select 
        declarant,
        declarant_iso,
        partner,
        partner_iso,
        flow,
        transport_mode,
        period,
        hs6,
        hs6_name,
        sum(value_in_euros) as total_value,
        sum(quantity_in_kg) as total_quantity,
        sum(value_in_euros) / nullif(sum(quantity_in_kg), 0) as value_per_quantity
    from TRHS.staging.stg_trade
    group by 1,2,3,4,5,6,7,8,9
)
select 
    declarant,
    declarant_iso,
    partner,
    partner_iso,
    flow,
    transport_mode,
    period,
    hs6,
    hs6_name,
    metric_type,
    metric_value
from base
unpivot(
    value for metric in (
        total_value,
        total_quantity,
        value_per_quantity
    )
)
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.trade_by_reporter"} */;
[0m11:39:57.656922 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m11:39:59.108048 [debug] [Thread-3 (]: Snowflake adapter: Snowflake query id: 01c02a3b-0105-6cf2-0000-000420cab76d
[0m11:39:59.110186 [debug] [Thread-3 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 32 at position 4
invalid identifier 'METRIC_TYPE'
[0m11:39:59.116135 [debug] [Thread-3 (]: Database Error in model trade_by_reporter (models/analytics/trade_by_reporter.sql)
  000904 (42000): SQL compilation error: error line 32 at position 4
  invalid identifier 'METRIC_TYPE'
  compiled code at target/run/citrus_trade/models/analytics/trade_by_reporter.sql
[0m11:39:59.117118 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d10a3e8-6818-4b30-8491-09a2406ae80a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff981b9be0>]}
[0m11:39:59.118303 [error] [Thread-3 (]: 2 of 2 ERROR creating sql table model analytics.trade_by_reporter .............. [[31mERROR[0m in 1.47s]
[0m11:39:59.119356 [debug] [Thread-3 (]: Finished running node model.citrus_trade.trade_by_reporter
[0m11:39:59.120341 [debug] [Thread-7 (]: Marking all children of 'model.citrus_trade.trade_by_reporter' to be skipped because of status 'error'.  Reason: Database Error in model trade_by_reporter (models/analytics/trade_by_reporter.sql)
  000904 (42000): SQL compilation error: error line 32 at position 4
  invalid identifier 'METRIC_TYPE'
  compiled code at target/run/citrus_trade/models/analytics/trade_by_reporter.sql.
[0m11:39:59.124076 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:39:59.124564 [debug] [MainThread]: Connection 'list_TRHS_analytics' was left open.
[0m11:39:59.125019 [debug] [MainThread]: On list_TRHS_analytics: Close
[0m11:39:59.277090 [debug] [MainThread]: Connection 'model.citrus_trade.stg_trade' was left open.
[0m11:39:59.277462 [debug] [MainThread]: On model.citrus_trade.stg_trade: Close
[0m11:39:59.376437 [debug] [MainThread]: Connection 'model.citrus_trade.trade_by_reporter' was left open.
[0m11:39:59.377310 [debug] [MainThread]: On model.citrus_trade.trade_by_reporter: Close
[0m11:39:59.550046 [info ] [MainThread]: 
[0m11:39:59.551629 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 5.83 seconds (5.83s).
[0m11:39:59.555833 [debug] [MainThread]: Command end result
[0m11:39:59.601804 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m11:39:59.603914 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m11:39:59.609235 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt/target/run_results.json
[0m11:39:59.609463 [info ] [MainThread]: 
[0m11:39:59.609732 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m11:39:59.610035 [info ] [MainThread]: 
[0m11:39:59.610491 [error] [MainThread]: [31mFailure in model trade_by_reporter (models/analytics/trade_by_reporter.sql)[0m
[0m11:39:59.610870 [error] [MainThread]:   Database Error in model trade_by_reporter (models/analytics/trade_by_reporter.sql)
  000904 (42000): SQL compilation error: error line 32 at position 4
  invalid identifier 'METRIC_TYPE'
  compiled code at target/run/citrus_trade/models/analytics/trade_by_reporter.sql
[0m11:39:59.611137 [info ] [MainThread]: 
[0m11:39:59.611549 [info ] [MainThread]:   compiled code at target/compiled/citrus_trade/models/analytics/trade_by_reporter.sql
[0m11:39:59.611762 [info ] [MainThread]: 
[0m11:39:59.612040 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=2
[0m11:39:59.613012 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 6.541561, "process_in_blocks": "0", "process_kernel_time": 0.409396, "process_mem_max_rss": "164652", "process_out_blocks": "4062", "process_user_time": 1.83451}
[0m11:39:59.613538 [debug] [MainThread]: Command `dbt run` failed at 11:39:59.613370 after 6.54 seconds
[0m11:39:59.613995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b5d2270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9abfdfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ad38b90>]}
[0m11:39:59.614295 [debug] [MainThread]: Flushing usage events
[0m11:40:00.145078 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:40:19.341237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8316e9c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85d59850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8316e480>]}


============================== 11:40:19.349061 | 790d51c5-9f87-4107-a8e6-5c907b924393 ==============================
[0m11:40:19.349061 [info ] [MainThread]: Running with dbt=1.10.13
[0m11:40:19.349422 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'empty': 'False', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': '/app/dbt/logs', 'profiles_dir': '/app/dbt', 'debug': 'False', 'use_experimental_parser': 'False', 'use_colors': 'True', 'cache_selected_only': 'False', 'version_check': 'True', 'introspect': 'True', 'no_print': 'None', 'warn_error': 'None', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'target_path': 'None', 'quiet': 'False', 'fail_fast': 'False', 'partial_parse': 'True', 'write_json': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run'}
[0m11:40:19.568225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '790d51c5-9f87-4107-a8e6-5c907b924393', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81bdf980>]}
[0m11:40:19.599013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '790d51c5-9f87-4107-a8e6-5c907b924393', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8212d370>]}
[0m11:40:19.599464 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m11:40:19.648638 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m11:40:19.760823 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:40:19.761220 [debug] [MainThread]: Partial parsing: updated file: citrus_trade://models/analytics/trade_by_reporter.sql
[0m11:40:19.895213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '790d51c5-9f87-4107-a8e6-5c907b924393', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff815f4d10>]}
[0m11:40:19.938017 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m11:40:19.939331 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m11:40:19.947214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '790d51c5-9f87-4107-a8e6-5c907b924393', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81667b60>]}
[0m11:40:19.947483 [info ] [MainThread]: Found 2 models, 1 source, 632 macros
[0m11:40:19.947699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '790d51c5-9f87-4107-a8e6-5c907b924393', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81564dd0>]}
[0m11:40:19.948706 [info ] [MainThread]: 
[0m11:40:19.948940 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:40:19.949159 [info ] [MainThread]: 
[0m11:40:19.949547 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:40:19.952432 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRHS'
[0m11:40:19.959576 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRHS'
[0m11:40:19.976630 [debug] [ThreadPool]: Using snowflake connection "list_TRHS"
[0m11:40:19.976959 [debug] [ThreadPool]: Using snowflake connection "list_TRHS"
[0m11:40:19.977142 [debug] [ThreadPool]: On list_TRHS: show terse schemas in database TRHS
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS"} */
[0m11:40:19.977367 [debug] [ThreadPool]: On list_TRHS: show terse schemas in database TRHS
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS"} */
[0m11:40:19.977562 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:40:19.977767 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:40:22.774651 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2.797 seconds
[0m11:40:22.775680 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2.798 seconds
[0m11:40:22.782167 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRHS, now list_TRHS_staging)
[0m11:40:22.789269 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRHS, now list_TRHS_analytics)
[0m11:40:22.804597 [debug] [ThreadPool]: Using snowflake connection "list_TRHS_staging"
[0m11:40:22.809382 [debug] [ThreadPool]: Using snowflake connection "list_TRHS_analytics"
[0m11:40:22.809736 [debug] [ThreadPool]: On list_TRHS_staging: show objects in TRHS.staging
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS_staging"} */;
[0m11:40:22.810204 [debug] [ThreadPool]: On list_TRHS_analytics: show objects in TRHS.analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS_analytics"} */;
[0m11:40:22.884032 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.072 seconds
[0m11:40:22.891305 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.081 seconds
[0m11:40:22.894608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '790d51c5-9f87-4107-a8e6-5c907b924393', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff815f48f0>]}
[0m11:40:22.897952 [debug] [Thread-1 (]: Began running node model.citrus_trade.stg_trade
[0m11:40:22.898686 [info ] [Thread-1 (]: 1 of 2 START sql table model staging.stg_trade ................................. [RUN]
[0m11:40:22.899082 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_TRHS_staging, now model.citrus_trade.stg_trade)
[0m11:40:22.899403 [debug] [Thread-1 (]: Began compiling node model.citrus_trade.stg_trade
[0m11:40:22.907165 [debug] [Thread-1 (]: Writing injected SQL for node "model.citrus_trade.stg_trade"
[0m11:40:22.909042 [debug] [Thread-1 (]: Began executing node model.citrus_trade.stg_trade
[0m11:40:22.939764 [debug] [Thread-1 (]: Writing runtime sql for node "model.citrus_trade.stg_trade"
[0m11:40:22.941593 [debug] [Thread-1 (]: Using snowflake connection "model.citrus_trade.stg_trade"
[0m11:40:22.941912 [debug] [Thread-1 (]: On model.citrus_trade.stg_trade: create or replace transient table TRHS.staging.stg_trade
    
    
    
    as (select
  value:DECLARANT::int as declarant,
  value:DECLARANT_ISO::string as declarant_iso,
  value:PARTNER::string as partner,
  value:PARTNER_ISO::string as partner_iso,
  value:FLOW::int as flow,
  value:TRANSPORT_MODE::int as transport_mode,
  value:PERIOD::int as period,
  value:HS4::string as hs4,
  value:HS4_NAME::string as hs4_name,
  value:HS6::string as hs6,
  value:HS6_NAME::string as hs6_name,
  value:VALUE_IN_EUROS::float as value_in_euros,
  value:QUANTITY_IN_KG::float as quantity_in_kg
from trhs.staging.citrus_ext
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.stg_trade"} */;
[0m11:40:23.780737 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.838 seconds
[0m11:40:23.816012 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '790d51c5-9f87-4107-a8e6-5c907b924393', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff859f15b0>]}
[0m11:40:23.817017 [info ] [Thread-1 (]: 1 of 2 OK created sql table model staging.stg_trade ............................ [[32mSUCCESS 1[0m in 0.92s]
[0m11:40:23.818108 [debug] [Thread-1 (]: Finished running node model.citrus_trade.stg_trade
[0m11:40:23.819087 [debug] [Thread-3 (]: Began running node model.citrus_trade.trade_by_reporter
[0m11:40:23.819624 [info ] [Thread-3 (]: 2 of 2 START sql table model analytics.trade_by_reporter ....................... [RUN]
[0m11:40:23.820349 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.citrus_trade.trade_by_reporter'
[0m11:40:23.820778 [debug] [Thread-3 (]: Began compiling node model.citrus_trade.trade_by_reporter
[0m11:40:23.824334 [debug] [Thread-3 (]: Writing injected SQL for node "model.citrus_trade.trade_by_reporter"
[0m11:40:23.825620 [debug] [Thread-3 (]: Began executing node model.citrus_trade.trade_by_reporter
[0m11:40:23.828292 [debug] [Thread-3 (]: Writing runtime sql for node "model.citrus_trade.trade_by_reporter"
[0m11:40:23.829871 [debug] [Thread-3 (]: Using snowflake connection "model.citrus_trade.trade_by_reporter"
[0m11:40:23.830245 [debug] [Thread-3 (]: On model.citrus_trade.trade_by_reporter: create or replace transient table TRHS.analytics.trade_by_reporter
    
    
    
    as (with base as (
    select 
        declarant,
        declarant_iso,
        partner,
        partner_iso,
        flow,
        transport_mode,
        period,
        hs6,
        hs6_name,
        sum(value_in_euros) as total_value,
        sum(quantity_in_kg) as total_quantity,
        sum(value_in_euros) / nullif(sum(quantity_in_kg), 0) as value_per_quantity
    from TRHS.staging.stg_trade
    group by 1,2,3,4,5,6,7,8,9
)
select 
    declarant,
    declarant_iso,
    partner,
    partner_iso,
    flow,
    transport_mode,
    period,
    hs6,
    hs6_name,
    metric_type,
    metric_value
from base
unpivot(
    value for metric_type in (
        total_value,
        total_quantity,
        value_per_quantity
    )
)
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.trade_by_reporter"} */;
[0m11:40:23.830656 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m11:40:25.204257 [debug] [Thread-3 (]: Snowflake adapter: Snowflake query id: 01c02a3c-0105-6cf2-0000-000420cab785
[0m11:40:25.205322 [debug] [Thread-3 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 33 at position 4
invalid identifier 'METRIC_VALUE'
[0m11:40:25.211786 [debug] [Thread-3 (]: Database Error in model trade_by_reporter (models/analytics/trade_by_reporter.sql)
  000904 (42000): SQL compilation error: error line 33 at position 4
  invalid identifier 'METRIC_VALUE'
  compiled code at target/run/citrus_trade/models/analytics/trade_by_reporter.sql
[0m11:40:25.212785 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '790d51c5-9f87-4107-a8e6-5c907b924393', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7abaad80>]}
[0m11:40:25.213980 [error] [Thread-3 (]: 2 of 2 ERROR creating sql table model analytics.trade_by_reporter .............. [[31mERROR[0m in 1.39s]
[0m11:40:25.215002 [debug] [Thread-3 (]: Finished running node model.citrus_trade.trade_by_reporter
[0m11:40:25.215995 [debug] [Thread-7 (]: Marking all children of 'model.citrus_trade.trade_by_reporter' to be skipped because of status 'error'.  Reason: Database Error in model trade_by_reporter (models/analytics/trade_by_reporter.sql)
  000904 (42000): SQL compilation error: error line 33 at position 4
  invalid identifier 'METRIC_VALUE'
  compiled code at target/run/citrus_trade/models/analytics/trade_by_reporter.sql.
[0m11:40:25.219267 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:40:25.219688 [debug] [MainThread]: Connection 'list_TRHS_analytics' was left open.
[0m11:40:25.220188 [debug] [MainThread]: On list_TRHS_analytics: Close
[0m11:40:25.364228 [debug] [MainThread]: Connection 'model.citrus_trade.stg_trade' was left open.
[0m11:40:25.365291 [debug] [MainThread]: On model.citrus_trade.stg_trade: Close
[0m11:40:25.466822 [debug] [MainThread]: Connection 'model.citrus_trade.trade_by_reporter' was left open.
[0m11:40:25.468621 [debug] [MainThread]: On model.citrus_trade.trade_by_reporter: Close
[0m11:40:25.565038 [info ] [MainThread]: 
[0m11:40:25.566075 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 5.62 seconds (5.62s).
[0m11:40:25.568195 [debug] [MainThread]: Command end result
[0m11:40:25.612821 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m11:40:25.614883 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m11:40:25.620098 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt/target/run_results.json
[0m11:40:25.620322 [info ] [MainThread]: 
[0m11:40:25.620610 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m11:40:25.621066 [info ] [MainThread]: 
[0m11:40:25.621424 [error] [MainThread]: [31mFailure in model trade_by_reporter (models/analytics/trade_by_reporter.sql)[0m
[0m11:40:25.621820 [error] [MainThread]:   Database Error in model trade_by_reporter (models/analytics/trade_by_reporter.sql)
  000904 (42000): SQL compilation error: error line 33 at position 4
  invalid identifier 'METRIC_VALUE'
  compiled code at target/run/citrus_trade/models/analytics/trade_by_reporter.sql
[0m11:40:25.622208 [info ] [MainThread]: 
[0m11:40:25.622557 [info ] [MainThread]:   compiled code at target/compiled/citrus_trade/models/analytics/trade_by_reporter.sql
[0m11:40:25.622866 [info ] [MainThread]: 
[0m11:40:25.623184 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=2
[0m11:40:25.624105 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 6.3131366, "process_in_blocks": "0", "process_kernel_time": 0.388704, "process_mem_max_rss": "164816", "process_out_blocks": "4062", "process_user_time": 1.75219}
[0m11:40:25.624481 [debug] [MainThread]: Command `dbt run` failed at 11:40:25.624395 after 6.31 seconds
[0m11:40:25.624909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83871e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84020a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83ea96a0>]}
[0m11:40:25.625221 [debug] [MainThread]: Flushing usage events
[0m11:40:26.143573 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:41:54.516961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4dbe870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3fce630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa43422a0>]}


============================== 11:41:54.520252 | a0486c7e-8834-4bfe-adb7-08e35b451312 ==============================
[0m11:41:54.520252 [info ] [MainThread]: Running with dbt=1.10.13
[0m11:41:54.520603 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'empty': 'False', 'introspect': 'True', 'debug': 'False', 'static_parser': 'True', 'target_path': 'None', 'fail_fast': 'False', 'log_format': 'default', 'printer_width': '80', 'log_path': '/app/dbt/logs', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'use_colors': 'True', 'version_check': 'True', 'quiet': 'False', 'partial_parse': 'True', 'log_cache_events': 'False', 'no_print': 'None', 'cache_selected_only': 'False', 'profiles_dir': '/app/dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run'}
[0m11:41:54.754637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a0486c7e-8834-4bfe-adb7-08e35b451312', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa64b6510>]}
[0m11:41:54.785522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a0486c7e-8834-4bfe-adb7-08e35b451312', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3a916a0>]}
[0m11:41:54.785990 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m11:41:54.836163 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m11:41:54.962505 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:41:54.962944 [debug] [MainThread]: Partial parsing: updated file: citrus_trade://models/analytics/trade_by_reporter.sql
[0m11:41:55.115859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a0486c7e-8834-4bfe-adb7-08e35b451312', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa25c85c0>]}
[0m11:41:55.159548 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m11:41:55.161014 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m11:41:55.169209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a0486c7e-8834-4bfe-adb7-08e35b451312', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1f8e900>]}
[0m11:41:55.169478 [info ] [MainThread]: Found 2 models, 1 source, 632 macros
[0m11:41:55.169669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a0486c7e-8834-4bfe-adb7-08e35b451312', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2046e10>]}
[0m11:41:55.170672 [info ] [MainThread]: 
[0m11:41:55.170909 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:41:55.171463 [info ] [MainThread]: 
[0m11:41:55.171947 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:41:55.174446 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRHS'
[0m11:41:55.180675 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRHS'
[0m11:41:55.201339 [debug] [ThreadPool]: Using snowflake connection "list_TRHS"
[0m11:41:55.201680 [debug] [ThreadPool]: Using snowflake connection "list_TRHS"
[0m11:41:55.201845 [debug] [ThreadPool]: On list_TRHS: show terse schemas in database TRHS
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS"} */
[0m11:41:55.202060 [debug] [ThreadPool]: On list_TRHS: show terse schemas in database TRHS
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS"} */
[0m11:41:55.202240 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:41:55.202462 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:41:57.991125 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2.788 seconds
[0m11:41:57.997257 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2.795 seconds
[0m11:41:58.001291 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRHS, now list_TRHS_analytics)
[0m11:41:58.008868 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRHS, now list_TRHS_staging)
[0m11:41:58.025136 [debug] [ThreadPool]: Using snowflake connection "list_TRHS_analytics"
[0m11:41:58.029242 [debug] [ThreadPool]: Using snowflake connection "list_TRHS_staging"
[0m11:41:58.029612 [debug] [ThreadPool]: On list_TRHS_analytics: show objects in TRHS.analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS_analytics"} */;
[0m11:41:58.030069 [debug] [ThreadPool]: On list_TRHS_staging: show objects in TRHS.staging
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS_staging"} */;
[0m11:41:58.106188 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.076 seconds
[0m11:41:58.110905 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.079 seconds
[0m11:41:58.114515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a0486c7e-8834-4bfe-adb7-08e35b451312', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa658d550>]}
[0m11:41:58.118672 [debug] [Thread-1 (]: Began running node model.citrus_trade.stg_trade
[0m11:41:58.119845 [info ] [Thread-1 (]: 1 of 2 START sql table model staging.stg_trade ................................. [RUN]
[0m11:41:58.120667 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_TRHS_staging, now model.citrus_trade.stg_trade)
[0m11:41:58.121299 [debug] [Thread-1 (]: Began compiling node model.citrus_trade.stg_trade
[0m11:41:58.130359 [debug] [Thread-1 (]: Writing injected SQL for node "model.citrus_trade.stg_trade"
[0m11:41:58.132660 [debug] [Thread-1 (]: Began executing node model.citrus_trade.stg_trade
[0m11:41:58.160201 [debug] [Thread-1 (]: Writing runtime sql for node "model.citrus_trade.stg_trade"
[0m11:41:58.161671 [debug] [Thread-1 (]: Using snowflake connection "model.citrus_trade.stg_trade"
[0m11:41:58.161944 [debug] [Thread-1 (]: On model.citrus_trade.stg_trade: create or replace transient table TRHS.staging.stg_trade
    
    
    
    as (select
  value:DECLARANT::int as declarant,
  value:DECLARANT_ISO::string as declarant_iso,
  value:PARTNER::string as partner,
  value:PARTNER_ISO::string as partner_iso,
  value:FLOW::int as flow,
  value:TRANSPORT_MODE::int as transport_mode,
  value:PERIOD::int as period,
  value:HS4::string as hs4,
  value:HS4_NAME::string as hs4_name,
  value:HS6::string as hs6,
  value:HS6_NAME::string as hs6_name,
  value:VALUE_IN_EUROS::float as value_in_euros,
  value:QUANTITY_IN_KG::float as quantity_in_kg
from trhs.staging.citrus_ext
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.stg_trade"} */;
[0m11:41:59.047387 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.886 seconds
[0m11:41:59.081460 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a0486c7e-8834-4bfe-adb7-08e35b451312', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4afa510>]}
[0m11:41:59.082406 [info ] [Thread-1 (]: 1 of 2 OK created sql table model staging.stg_trade ............................ [[32mSUCCESS 1[0m in 0.96s]
[0m11:41:59.083193 [debug] [Thread-1 (]: Finished running node model.citrus_trade.stg_trade
[0m11:41:59.084206 [debug] [Thread-3 (]: Began running node model.citrus_trade.trade_by_reporter
[0m11:41:59.084959 [info ] [Thread-3 (]: 2 of 2 START sql table model analytics.trade_by_reporter ....................... [RUN]
[0m11:41:59.085515 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.citrus_trade.trade_by_reporter'
[0m11:41:59.085950 [debug] [Thread-3 (]: Began compiling node model.citrus_trade.trade_by_reporter
[0m11:41:59.089312 [debug] [Thread-3 (]: Writing injected SQL for node "model.citrus_trade.trade_by_reporter"
[0m11:41:59.091327 [debug] [Thread-3 (]: Began executing node model.citrus_trade.trade_by_reporter
[0m11:41:59.094081 [debug] [Thread-3 (]: Writing runtime sql for node "model.citrus_trade.trade_by_reporter"
[0m11:41:59.096035 [debug] [Thread-3 (]: Using snowflake connection "model.citrus_trade.trade_by_reporter"
[0m11:41:59.096406 [debug] [Thread-3 (]: On model.citrus_trade.trade_by_reporter: create or replace transient table TRHS.analytics.trade_by_reporter
    
    
    
    as (with base as (
    select 
        declarant,
        declarant_iso,
        partner,
        partner_iso,
        flow,
        transport_mode,
        period,
        hs6,
        hs6_name,
        sum(value_in_euros) as total_value,
        sum(quantity_in_kg) as total_quantity,
        sum(value_in_euros) / nullif(sum(quantity_in_kg), 0) as value_per_quantity
    from TRHS.staging.stg_trade
    group by 1,2,3,4,5,6,7,8,9
)
select 
    declarant,
    declarant_iso,
    partner,
    partner_iso,
    flow,
    transport_mode,
    period,
    hs6,
    hs6_name,
    metric_type,
    metric_value
from base
unpivot(
    metric_value for metric_type in (
        total_value,
        total_quantity,
        value_per_quantity
    )
)
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.trade_by_reporter"} */;
[0m11:41:59.096737 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m11:42:00.088939 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.992 seconds
[0m11:42:00.095857 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a0486c7e-8834-4bfe-adb7-08e35b451312', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9bf68530>]}
[0m11:42:00.097248 [info ] [Thread-3 (]: 2 of 2 OK created sql table model analytics.trade_by_reporter .................. [[32mSUCCESS 1[0m in 1.01s]
[0m11:42:00.098614 [debug] [Thread-3 (]: Finished running node model.citrus_trade.trade_by_reporter
[0m11:42:00.101842 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:42:00.102465 [debug] [MainThread]: Connection 'list_TRHS_analytics' was left open.
[0m11:42:00.103048 [debug] [MainThread]: On list_TRHS_analytics: Close
[0m11:42:00.195405 [debug] [MainThread]: Connection 'model.citrus_trade.stg_trade' was left open.
[0m11:42:00.196487 [debug] [MainThread]: On model.citrus_trade.stg_trade: Close
[0m11:42:00.330137 [debug] [MainThread]: Connection 'model.citrus_trade.trade_by_reporter' was left open.
[0m11:42:00.331392 [debug] [MainThread]: On model.citrus_trade.trade_by_reporter: Close
[0m11:42:00.421799 [info ] [MainThread]: 
[0m11:42:00.423340 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 5.25 seconds (5.25s).
[0m11:42:00.425884 [debug] [MainThread]: Command end result
[0m11:42:00.474889 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m11:42:00.477252 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m11:42:00.482113 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt/target/run_results.json
[0m11:42:00.482346 [info ] [MainThread]: 
[0m11:42:00.482588 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:42:00.482825 [info ] [MainThread]: 
[0m11:42:00.483173 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m11:42:00.484166 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.999036, "process_in_blocks": "0", "process_kernel_time": 0.449577, "process_mem_max_rss": "164136", "process_out_blocks": "4059", "process_user_time": 1.721701}
[0m11:42:00.484590 [debug] [MainThread]: Command `dbt run` succeeded at 11:42:00.484493 after 6.00 seconds
[0m11:42:00.484911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4098c80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4afa510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1fbd700>]}
[0m11:42:00.485160 [debug] [MainThread]: Flushing usage events
[0m11:42:01.020644 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:05:02.473256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa56b7ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa51cba70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa56b5550>]}


============================== 12:05:02.477147 | a74e0774-9fa4-4fba-ba39-dd701f82fd3e ==============================
[0m12:05:02.477147 [info ] [MainThread]: Running with dbt=1.10.13
[0m12:05:02.477651 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'log_format': 'default', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True', 'version_check': 'True', 'invocation_command': 'dbt run', 'log_path': '/app/dbt/logs', 'log_cache_events': 'False', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'fail_fast': 'False', 'static_parser': 'True', 'indirect_selection': 'eager', 'empty': 'False', 'profiles_dir': '/app/dbt', 'partial_parse': 'True', 'introspect': 'True', 'use_colors': 'True', 'debug': 'False', 'use_experimental_parser': 'False', 'printer_width': '80', 'no_print': 'None'}
[0m12:05:02.738087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a74e0774-9fa4-4fba-ba39-dd701f82fd3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa264db20>]}
[0m12:05:02.780584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a74e0774-9fa4-4fba-ba39-dd701f82fd3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa24af6e0>]}
[0m12:05:02.781258 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m12:05:02.863298 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m12:05:02.982716 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:05:02.983026 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:05:03.001767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a74e0774-9fa4-4fba-ba39-dd701f82fd3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1e96450>]}
[0m12:05:03.051079 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m12:05:03.053713 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m12:05:03.064685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a74e0774-9fa4-4fba-ba39-dd701f82fd3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1880920>]}
[0m12:05:03.065025 [info ] [MainThread]: Found 2 models, 1 source, 632 macros
[0m12:05:03.065274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a74e0774-9fa4-4fba-ba39-dd701f82fd3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1d04260>]}
[0m12:05:03.066347 [info ] [MainThread]: 
[0m12:05:03.066568 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:05:03.066803 [info ] [MainThread]: 
[0m12:05:03.067219 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:05:03.069755 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRHS'
[0m12:05:03.077267 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRHS'
[0m12:05:03.096703 [debug] [ThreadPool]: Using snowflake connection "list_TRHS"
[0m12:05:03.097047 [debug] [ThreadPool]: Using snowflake connection "list_TRHS"
[0m12:05:03.097223 [debug] [ThreadPool]: On list_TRHS: show terse schemas in database TRHS
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS"} */
[0m12:05:03.097445 [debug] [ThreadPool]: On list_TRHS: show terse schemas in database TRHS
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS"} */
[0m12:05:03.097629 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:05:03.097812 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:05:04.989528 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.892 seconds
[0m12:05:04.993558 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.895 seconds
[0m12:05:04.999787 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRHS, now list_TRHS_staging)
[0m12:05:05.000530 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRHS, now list_TRHS_analytics)
[0m12:05:05.014620 [debug] [ThreadPool]: Using snowflake connection "list_TRHS_staging"
[0m12:05:05.017497 [debug] [ThreadPool]: Using snowflake connection "list_TRHS_analytics"
[0m12:05:05.018079 [debug] [ThreadPool]: On list_TRHS_staging: show objects in TRHS.staging
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS_staging"} */;
[0m12:05:05.018556 [debug] [ThreadPool]: On list_TRHS_analytics: show objects in TRHS.analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS_analytics"} */;
[0m12:05:05.108984 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.088 seconds
[0m12:05:05.135269 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.116 seconds
[0m12:05:05.139862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a74e0774-9fa4-4fba-ba39-dd701f82fd3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa186ce30>]}
[0m12:05:05.145017 [debug] [Thread-1 (]: Began running node model.citrus_trade.stg_trade
[0m12:05:05.145879 [info ] [Thread-1 (]: 1 of 2 START sql table model staging.stg_trade ................................. [RUN]
[0m12:05:05.146818 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_TRHS_staging, now model.citrus_trade.stg_trade)
[0m12:05:05.147720 [debug] [Thread-1 (]: Began compiling node model.citrus_trade.stg_trade
[0m12:05:05.158289 [debug] [Thread-1 (]: Writing injected SQL for node "model.citrus_trade.stg_trade"
[0m12:05:05.160197 [debug] [Thread-1 (]: Began executing node model.citrus_trade.stg_trade
[0m12:05:05.193574 [debug] [Thread-1 (]: Writing runtime sql for node "model.citrus_trade.stg_trade"
[0m12:05:05.195594 [debug] [Thread-1 (]: Using snowflake connection "model.citrus_trade.stg_trade"
[0m12:05:05.195951 [debug] [Thread-1 (]: On model.citrus_trade.stg_trade: create or replace transient table TRHS.staging.stg_trade
    
    
    
    as (select
  value:DECLARANT::int as declarant,
  value:DECLARANT_ISO::string as declarant_iso,
  value:PARTNER::string as partner,
  value:PARTNER_ISO::string as partner_iso,
  value:FLOW::int as flow,
  value:TRANSPORT_MODE::int as transport_mode,
  value:PERIOD::int as period,
  value:HS4::string as hs4,
  value:HS4_NAME::string as hs4_name,
  value:HS6::string as hs6,
  value:HS6_NAME::string as hs6_name,
  value:VALUE_IN_EUROS::float as value_in_euros,
  value:QUANTITY_IN_KG::float as quantity_in_kg
from trhs.staging.citrus_ext
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.stg_trade"} */;
[0m12:05:06.042100 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.845 seconds
[0m12:05:06.076404 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a74e0774-9fa4-4fba-ba39-dd701f82fd3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ab42660>]}
[0m12:05:06.077367 [info ] [Thread-1 (]: 1 of 2 OK created sql table model staging.stg_trade ............................ [[32mSUCCESS 1[0m in 0.93s]
[0m12:05:06.078265 [debug] [Thread-1 (]: Finished running node model.citrus_trade.stg_trade
[0m12:05:06.079336 [debug] [Thread-3 (]: Began running node model.citrus_trade.trade_by_reporter
[0m12:05:06.079842 [info ] [Thread-3 (]: 2 of 2 START sql table model analytics.trade_by_reporter ....................... [RUN]
[0m12:05:06.080504 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.citrus_trade.trade_by_reporter'
[0m12:05:06.080914 [debug] [Thread-3 (]: Began compiling node model.citrus_trade.trade_by_reporter
[0m12:05:06.086927 [debug] [Thread-3 (]: Writing injected SQL for node "model.citrus_trade.trade_by_reporter"
[0m12:05:06.088355 [debug] [Thread-3 (]: Began executing node model.citrus_trade.trade_by_reporter
[0m12:05:06.090610 [debug] [Thread-3 (]: Writing runtime sql for node "model.citrus_trade.trade_by_reporter"
[0m12:05:06.092311 [debug] [Thread-3 (]: Using snowflake connection "model.citrus_trade.trade_by_reporter"
[0m12:05:06.092643 [debug] [Thread-3 (]: On model.citrus_trade.trade_by_reporter: create or replace transient table TRHS.analytics.trade_by_reporter
    
    
    
    as (with base as (
    select 
        declarant,
        declarant_iso,
        partner,
        partner_iso,
        flow,
        transport_mode,
        period,
        hs6,
        hs6_name,
        sum(value_in_euros) as total_value,
        sum(quantity_in_kg) as total_quantity,
        sum(value_in_euros) / nullif(sum(quantity_in_kg), 0) as value_per_quantity
    from TRHS.staging.stg_trade
    group by 1,2,3,4,5,6,7,8,9
)
select 
    declarant,
    declarant_iso,
    partner,
    partner_iso,
    flow,
    transport_mode,
    period,
    hs6,
    hs6_name,
    metric_type,
    metric_value
from base
unpivot(
    metric_value for metric_type in (
        total_value,
        total_quantity,
        value_per_quantity
    )
)
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.trade_by_reporter"} */;
[0m12:05:06.092976 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:05:07.101796 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.009 seconds
[0m12:05:07.107269 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a74e0774-9fa4-4fba-ba39-dd701f82fd3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ab8b950>]}
[0m12:05:07.109330 [info ] [Thread-3 (]: 2 of 2 OK created sql table model analytics.trade_by_reporter .................. [[32mSUCCESS 1[0m in 1.03s]
[0m12:05:07.110532 [debug] [Thread-3 (]: Finished running node model.citrus_trade.trade_by_reporter
[0m12:05:07.113314 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:05:07.113851 [debug] [MainThread]: Connection 'list_TRHS_analytics' was left open.
[0m12:05:07.114496 [debug] [MainThread]: On list_TRHS_analytics: Close
[0m12:05:07.222241 [debug] [MainThread]: Connection 'model.citrus_trade.stg_trade' was left open.
[0m12:05:07.223135 [debug] [MainThread]: On model.citrus_trade.stg_trade: Close
[0m12:05:07.321304 [debug] [MainThread]: Connection 'model.citrus_trade.trade_by_reporter' was left open.
[0m12:05:07.322353 [debug] [MainThread]: On model.citrus_trade.trade_by_reporter: Close
[0m12:05:07.425389 [info ] [MainThread]: 
[0m12:05:07.426454 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 4.36 seconds (4.36s).
[0m12:05:07.428164 [debug] [MainThread]: Command end result
[0m12:05:07.477413 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m12:05:07.479671 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m12:05:07.484867 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt/target/run_results.json
[0m12:05:07.485162 [info ] [MainThread]: 
[0m12:05:07.485428 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:05:07.485711 [info ] [MainThread]: 
[0m12:05:07.486228 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m12:05:07.487310 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.0457964, "process_in_blocks": "0", "process_kernel_time": 0.46488, "process_mem_max_rss": "163316", "process_out_blocks": "2708", "process_user_time": 1.656829}
[0m12:05:07.487672 [debug] [MainThread]: Command `dbt run` succeeded at 12:05:07.487600 after 5.05 seconds
[0m12:05:07.487981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3aa7650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1888c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1888b30>]}
[0m12:05:07.488273 [debug] [MainThread]: Flushing usage events
[0m12:05:08.046750 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:07:02.690790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8cbc9b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f011a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c538bf0>]}


============================== 12:07:02.694604 | fb882bfb-89e0-4ddd-ad1c-dd8d660aa9ad ==============================
[0m12:07:02.694604 [info ] [MainThread]: Running with dbt=1.10.13
[0m12:07:02.695174 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'introspect': 'True', 'target_path': 'None', 'use_experimental_parser': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'empty': 'False', 'fail_fast': 'False', 'debug': 'False', 'invocation_command': 'dbt run', 'write_json': 'True', 'quiet': 'False', 'log_format': 'default', 'profiles_dir': '/app/dbt', 'printer_width': '80', 'indirect_selection': 'eager', 'partial_parse': 'True', 'warn_error': 'None', 'static_parser': 'True', 'log_path': '/app/dbt/logs', 'use_colors': 'True', 'log_cache_events': 'False'}
[0m12:07:03.029156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fb882bfb-89e0-4ddd-ad1c-dd8d660aa9ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b0ec200>]}
[0m12:07:03.060038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fb882bfb-89e0-4ddd-ad1c-dd8d660aa9ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b096cc0>]}
[0m12:07:03.060504 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m12:07:03.110332 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m12:07:03.224658 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:07:03.225070 [debug] [MainThread]: Partial parsing: updated file: citrus_trade://models/analytics/trade_by_reporter.sql
[0m12:07:03.356866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fb882bfb-89e0-4ddd-ad1c-dd8d660aa9ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8aa7ea50>]}
[0m12:07:03.401336 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m12:07:03.402801 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m12:07:03.412042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fb882bfb-89e0-4ddd-ad1c-dd8d660aa9ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a758080>]}
[0m12:07:03.412339 [info ] [MainThread]: Found 2 models, 1 source, 632 macros
[0m12:07:03.412533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fb882bfb-89e0-4ddd-ad1c-dd8d660aa9ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8aa90710>]}
[0m12:07:03.413479 [info ] [MainThread]: 
[0m12:07:03.413699 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:07:03.413944 [info ] [MainThread]: 
[0m12:07:03.414339 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:07:03.416792 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRHS'
[0m12:07:03.422387 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRHS'
[0m12:07:03.442025 [debug] [ThreadPool]: Using snowflake connection "list_TRHS"
[0m12:07:03.442335 [debug] [ThreadPool]: Using snowflake connection "list_TRHS"
[0m12:07:03.442505 [debug] [ThreadPool]: On list_TRHS: show terse schemas in database TRHS
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS"} */
[0m12:07:03.442725 [debug] [ThreadPool]: On list_TRHS: show terse schemas in database TRHS
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS"} */
[0m12:07:03.442906 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:07:03.443124 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:07:06.183731 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2.741 seconds
[0m12:07:06.185112 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2.742 seconds
[0m12:07:06.192017 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRHS, now list_TRHS_analytics)
[0m12:07:06.199649 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRHS, now list_TRHS_staging)
[0m12:07:06.210200 [debug] [ThreadPool]: Using snowflake connection "list_TRHS_analytics"
[0m12:07:06.212780 [debug] [ThreadPool]: Using snowflake connection "list_TRHS_staging"
[0m12:07:06.213302 [debug] [ThreadPool]: On list_TRHS_analytics: show objects in TRHS.analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS_analytics"} */;
[0m12:07:06.213752 [debug] [ThreadPool]: On list_TRHS_staging: show objects in TRHS.staging
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS_staging"} */;
[0m12:07:06.328156 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.112 seconds
[0m12:07:06.347938 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.134 seconds
[0m12:07:06.351573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fb882bfb-89e0-4ddd-ad1c-dd8d660aa9ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a7b0e00>]}
[0m12:07:06.357259 [debug] [Thread-1 (]: Began running node model.citrus_trade.stg_trade
[0m12:07:06.358111 [info ] [Thread-1 (]: 1 of 2 START sql table model staging.stg_trade ................................. [RUN]
[0m12:07:06.358733 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_TRHS_analytics, now model.citrus_trade.stg_trade)
[0m12:07:06.359361 [debug] [Thread-1 (]: Began compiling node model.citrus_trade.stg_trade
[0m12:07:06.372310 [debug] [Thread-1 (]: Writing injected SQL for node "model.citrus_trade.stg_trade"
[0m12:07:06.374910 [debug] [Thread-1 (]: Began executing node model.citrus_trade.stg_trade
[0m12:07:06.408623 [debug] [Thread-1 (]: Writing runtime sql for node "model.citrus_trade.stg_trade"
[0m12:07:06.410359 [debug] [Thread-1 (]: Using snowflake connection "model.citrus_trade.stg_trade"
[0m12:07:06.410677 [debug] [Thread-1 (]: On model.citrus_trade.stg_trade: create or replace transient table TRHS.staging.stg_trade
    
    
    
    as (select
  value:DECLARANT::int as declarant,
  value:DECLARANT_ISO::string as declarant_iso,
  value:PARTNER::string as partner,
  value:PARTNER_ISO::string as partner_iso,
  value:FLOW::int as flow,
  value:TRANSPORT_MODE::int as transport_mode,
  value:PERIOD::int as period,
  value:HS4::string as hs4,
  value:HS4_NAME::string as hs4_name,
  value:HS6::string as hs6,
  value:HS6_NAME::string as hs6_name,
  value:VALUE_IN_EUROS::float as value_in_euros,
  value:QUANTITY_IN_KG::float as quantity_in_kg
from trhs.staging.citrus_ext
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.stg_trade"} */;
[0m12:07:07.206053 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.795 seconds
[0m12:07:07.235673 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fb882bfb-89e0-4ddd-ad1c-dd8d660aa9ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d2ee5a0>]}
[0m12:07:07.236439 [info ] [Thread-1 (]: 1 of 2 OK created sql table model staging.stg_trade ............................ [[32mSUCCESS 1[0m in 0.88s]
[0m12:07:07.237147 [debug] [Thread-1 (]: Finished running node model.citrus_trade.stg_trade
[0m12:07:07.237948 [debug] [Thread-3 (]: Began running node model.citrus_trade.trade_by_reporter
[0m12:07:07.238436 [info ] [Thread-3 (]: 2 of 2 START sql table model analytics.trade_by_reporter ....................... [RUN]
[0m12:07:07.239148 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.citrus_trade.trade_by_reporter'
[0m12:07:07.239471 [debug] [Thread-3 (]: Began compiling node model.citrus_trade.trade_by_reporter
[0m12:07:07.242392 [debug] [Thread-3 (]: Writing injected SQL for node "model.citrus_trade.trade_by_reporter"
[0m12:07:07.244538 [debug] [Thread-3 (]: Began executing node model.citrus_trade.trade_by_reporter
[0m12:07:07.247158 [debug] [Thread-3 (]: Writing runtime sql for node "model.citrus_trade.trade_by_reporter"
[0m12:07:07.248808 [debug] [Thread-3 (]: Using snowflake connection "model.citrus_trade.trade_by_reporter"
[0m12:07:07.249100 [debug] [Thread-3 (]: On model.citrus_trade.trade_by_reporter: create or replace transient table TRHS.analytics.trade_by_reporter
    
    
    
    as (with base as (
    select 
        declarant,
        declarant_iso,
        partner,
        partner_iso,
        flow,
        transport_mode,
        left(period,4) as year
        period,
        hs6,
        hs6_name,
        sum(value_in_euros) as total_value,
        sum(quantity_in_kg) as total_quantity,
        sum(value_in_euros) / nullif(sum(quantity_in_kg), 0) as value_per_quantity
    from TRHS.staging.stg_trade
    group by 1,2,3,4,5,6,7,8,9,10
)
select 
    declarant,
    declarant_iso,
    partner,
    partner_iso,
    flow,
    transport_mode,
    period,
    hs6,
    hs6_name,
    metric_type,
    metric_value
from base
unpivot(
    metric_value for metric_type in (
        total_value,
        total_quantity,
        value_per_quantity
    )
)
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.trade_by_reporter"} */;
[0m12:07:07.249479 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:07:07.697455 [debug] [Thread-3 (]: Snowflake adapter: Snowflake query id: 01c02a57-0105-6cf2-0000-000420cab939
[0m12:07:07.698552 [debug] [Thread-3 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 14 at position 8 unexpected 'period'.
syntax error line 15 at position 11 unexpected ','.
syntax error line 16 at position 16 unexpected ','.
syntax error line 17 at position 31 unexpected 'total_value'.
syntax error line 18 at position 31 unexpected 'total_quantity'.
syntax error line 19 at position 28 unexpected '/'.
syntax error line 19 at position 37 unexpected 'sum'.
syntax error line 19 at position 56 unexpected ','.
[0m12:07:07.705089 [debug] [Thread-3 (]: Database Error in model trade_by_reporter (models/analytics/trade_by_reporter.sql)
  001003 (42000): SQL compilation error:
  syntax error line 14 at position 8 unexpected 'period'.
  syntax error line 15 at position 11 unexpected ','.
  syntax error line 16 at position 16 unexpected ','.
  syntax error line 17 at position 31 unexpected 'total_value'.
  syntax error line 18 at position 31 unexpected 'total_quantity'.
  syntax error line 19 at position 28 unexpected '/'.
  syntax error line 19 at position 37 unexpected 'sum'.
  syntax error line 19 at position 56 unexpected ','.
  compiled code at target/run/citrus_trade/models/analytics/trade_by_reporter.sql
[0m12:07:07.706423 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fb882bfb-89e0-4ddd-ad1c-dd8d660aa9ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8856f740>]}
[0m12:07:07.707557 [error] [Thread-3 (]: 2 of 2 ERROR creating sql table model analytics.trade_by_reporter .............. [[31mERROR[0m in 0.47s]
[0m12:07:07.708656 [debug] [Thread-3 (]: Finished running node model.citrus_trade.trade_by_reporter
[0m12:07:07.709734 [debug] [Thread-7 (]: Marking all children of 'model.citrus_trade.trade_by_reporter' to be skipped because of status 'error'.  Reason: Database Error in model trade_by_reporter (models/analytics/trade_by_reporter.sql)
  001003 (42000): SQL compilation error:
  syntax error line 14 at position 8 unexpected 'period'.
  syntax error line 15 at position 11 unexpected ','.
  syntax error line 16 at position 16 unexpected ','.
  syntax error line 17 at position 31 unexpected 'total_value'.
  syntax error line 18 at position 31 unexpected 'total_quantity'.
  syntax error line 19 at position 28 unexpected '/'.
  syntax error line 19 at position 37 unexpected 'sum'.
  syntax error line 19 at position 56 unexpected ','.
  compiled code at target/run/citrus_trade/models/analytics/trade_by_reporter.sql.
[0m12:07:07.713114 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:07:07.713553 [debug] [MainThread]: Connection 'list_TRHS_staging' was left open.
[0m12:07:07.714035 [debug] [MainThread]: On list_TRHS_staging: Close
[0m12:07:07.806738 [debug] [MainThread]: Connection 'model.citrus_trade.stg_trade' was left open.
[0m12:07:07.808058 [debug] [MainThread]: On model.citrus_trade.stg_trade: Close
[0m12:07:07.929478 [debug] [MainThread]: Connection 'model.citrus_trade.trade_by_reporter' was left open.
[0m12:07:07.930628 [debug] [MainThread]: On model.citrus_trade.trade_by_reporter: Close
[0m12:07:08.027976 [info ] [MainThread]: 
[0m12:07:08.039300 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 4.61 seconds (4.61s).
[0m12:07:08.045947 [debug] [MainThread]: Command end result
[0m12:07:08.097063 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m12:07:08.098964 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m12:07:08.104252 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt/target/run_results.json
[0m12:07:08.104495 [info ] [MainThread]: 
[0m12:07:08.104769 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:07:08.105175 [info ] [MainThread]: 
[0m12:07:08.105687 [error] [MainThread]: [31mFailure in model trade_by_reporter (models/analytics/trade_by_reporter.sql)[0m
[0m12:07:08.106129 [error] [MainThread]:   Database Error in model trade_by_reporter (models/analytics/trade_by_reporter.sql)
  001003 (42000): SQL compilation error:
  syntax error line 14 at position 8 unexpected 'period'.
  syntax error line 15 at position 11 unexpected ','.
  syntax error line 16 at position 16 unexpected ','.
  syntax error line 17 at position 31 unexpected 'total_value'.
  syntax error line 18 at position 31 unexpected 'total_quantity'.
  syntax error line 19 at position 28 unexpected '/'.
  syntax error line 19 at position 37 unexpected 'sum'.
  syntax error line 19 at position 56 unexpected ','.
  compiled code at target/run/citrus_trade/models/analytics/trade_by_reporter.sql
[0m12:07:08.106503 [info ] [MainThread]: 
[0m12:07:08.107221 [info ] [MainThread]:   compiled code at target/compiled/citrus_trade/models/analytics/trade_by_reporter.sql
[0m12:07:08.107629 [info ] [MainThread]: 
[0m12:07:08.107999 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=2
[0m12:07:08.108868 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 5.454053, "process_in_blocks": "0", "process_kernel_time": 0.432536, "process_mem_max_rss": "159896", "process_out_blocks": "4066", "process_user_time": 1.773499}
[0m12:07:08.109208 [debug] [MainThread]: Command `dbt run` failed at 12:07:08.109143 after 5.45 seconds
[0m12:07:08.109459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8cba16d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a83b470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d2ee5a0>]}
[0m12:07:08.109699 [debug] [MainThread]: Flushing usage events
[0m12:07:08.626454 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:07:44.038007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82fb6900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84a1d940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8414e810>]}


============================== 12:07:44.045346 | c68b85c2-d40e-420f-ba0e-6e1676bf6147 ==============================
[0m12:07:44.045346 [info ] [MainThread]: Running with dbt=1.10.13
[0m12:07:44.046007 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'use_experimental_parser': 'False', 'introspect': 'True', 'log_format': 'default', 'fail_fast': 'False', 'log_path': '/app/dbt/logs', 'no_print': 'None', 'warn_error': 'None', 'target_path': 'None', 'write_json': 'True', 'version_check': 'True', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': '/app/dbt', 'indirect_selection': 'eager', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True', 'empty': 'False', 'cache_selected_only': 'False', 'use_colors': 'True', 'log_cache_events': 'False', 'quiet': 'False', 'static_parser': 'True', 'printer_width': '80'}
[0m12:07:44.262875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c68b85c2-d40e-420f-ba0e-6e1676bf6147', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff807b4b00>]}
[0m12:07:44.294098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c68b85c2-d40e-420f-ba0e-6e1676bf6147', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80d4c680>]}
[0m12:07:44.294650 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m12:07:44.344415 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m12:07:44.456321 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:07:44.456719 [debug] [MainThread]: Partial parsing: updated file: citrus_trade://models/analytics/trade_by_reporter.sql
[0m12:07:44.584792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c68b85c2-d40e-420f-ba0e-6e1676bf6147', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80ba6180>]}
[0m12:07:44.628307 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m12:07:44.629736 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m12:07:44.637938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c68b85c2-d40e-420f-ba0e-6e1676bf6147', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80183ef0>]}
[0m12:07:44.638180 [info ] [MainThread]: Found 2 models, 1 source, 632 macros
[0m12:07:44.638380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c68b85c2-d40e-420f-ba0e-6e1676bf6147', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff804b7b30>]}
[0m12:07:44.639377 [info ] [MainThread]: 
[0m12:07:44.639613 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:07:44.639879 [info ] [MainThread]: 
[0m12:07:44.640393 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:07:44.643034 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRHS'
[0m12:07:44.649299 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRHS'
[0m12:07:44.669880 [debug] [ThreadPool]: Using snowflake connection "list_TRHS"
[0m12:07:44.670247 [debug] [ThreadPool]: Using snowflake connection "list_TRHS"
[0m12:07:44.670439 [debug] [ThreadPool]: On list_TRHS: show terse schemas in database TRHS
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS"} */
[0m12:07:44.670680 [debug] [ThreadPool]: On list_TRHS: show terse schemas in database TRHS
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS"} */
[0m12:07:44.670884 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:07:44.671154 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:07:47.427059 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2.756 seconds
[0m12:07:47.472415 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2.801 seconds
[0m12:07:47.479113 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRHS, now list_TRHS_analytics)
[0m12:07:47.480304 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRHS, now list_TRHS_staging)
[0m12:07:47.506734 [debug] [ThreadPool]: Using snowflake connection "list_TRHS_analytics"
[0m12:07:47.512254 [debug] [ThreadPool]: Using snowflake connection "list_TRHS_staging"
[0m12:07:47.512628 [debug] [ThreadPool]: On list_TRHS_analytics: show objects in TRHS.analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS_analytics"} */;
[0m12:07:47.513163 [debug] [ThreadPool]: On list_TRHS_staging: show objects in TRHS.staging
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS_staging"} */;
[0m12:07:47.586636 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.073 seconds
[0m12:07:47.656179 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.141 seconds
[0m12:07:47.662763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c68b85c2-d40e-420f-ba0e-6e1676bf6147', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff806b54c0>]}
[0m12:07:47.670143 [debug] [Thread-1 (]: Began running node model.citrus_trade.stg_trade
[0m12:07:47.671124 [info ] [Thread-1 (]: 1 of 2 START sql table model staging.stg_trade ................................. [RUN]
[0m12:07:47.672969 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_TRHS_staging, now model.citrus_trade.stg_trade)
[0m12:07:47.673963 [debug] [Thread-1 (]: Began compiling node model.citrus_trade.stg_trade
[0m12:07:47.684555 [debug] [Thread-1 (]: Writing injected SQL for node "model.citrus_trade.stg_trade"
[0m12:07:47.686403 [debug] [Thread-1 (]: Began executing node model.citrus_trade.stg_trade
[0m12:07:47.717820 [debug] [Thread-1 (]: Writing runtime sql for node "model.citrus_trade.stg_trade"
[0m12:07:47.720015 [debug] [Thread-1 (]: Using snowflake connection "model.citrus_trade.stg_trade"
[0m12:07:47.720347 [debug] [Thread-1 (]: On model.citrus_trade.stg_trade: create or replace transient table TRHS.staging.stg_trade
    
    
    
    as (select
  value:DECLARANT::int as declarant,
  value:DECLARANT_ISO::string as declarant_iso,
  value:PARTNER::string as partner,
  value:PARTNER_ISO::string as partner_iso,
  value:FLOW::int as flow,
  value:TRANSPORT_MODE::int as transport_mode,
  value:PERIOD::int as period,
  value:HS4::string as hs4,
  value:HS4_NAME::string as hs4_name,
  value:HS6::string as hs6,
  value:HS6_NAME::string as hs6_name,
  value:VALUE_IN_EUROS::float as value_in_euros,
  value:QUANTITY_IN_KG::float as quantity_in_kg
from trhs.staging.citrus_ext
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.stg_trade"} */;
[0m12:07:48.712894 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.992 seconds
[0m12:07:48.743030 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c68b85c2-d40e-420f-ba0e-6e1676bf6147', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82cf6540>]}
[0m12:07:48.743969 [info ] [Thread-1 (]: 1 of 2 OK created sql table model staging.stg_trade ............................ [[32mSUCCESS 1[0m in 1.07s]
[0m12:07:48.745066 [debug] [Thread-1 (]: Finished running node model.citrus_trade.stg_trade
[0m12:07:48.746159 [debug] [Thread-3 (]: Began running node model.citrus_trade.trade_by_reporter
[0m12:07:48.746872 [info ] [Thread-3 (]: 2 of 2 START sql table model analytics.trade_by_reporter ....................... [RUN]
[0m12:07:48.747607 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.citrus_trade.trade_by_reporter'
[0m12:07:48.748069 [debug] [Thread-3 (]: Began compiling node model.citrus_trade.trade_by_reporter
[0m12:07:48.752318 [debug] [Thread-3 (]: Writing injected SQL for node "model.citrus_trade.trade_by_reporter"
[0m12:07:48.754878 [debug] [Thread-3 (]: Began executing node model.citrus_trade.trade_by_reporter
[0m12:07:48.757650 [debug] [Thread-3 (]: Writing runtime sql for node "model.citrus_trade.trade_by_reporter"
[0m12:07:48.759716 [debug] [Thread-3 (]: Using snowflake connection "model.citrus_trade.trade_by_reporter"
[0m12:07:48.760096 [debug] [Thread-3 (]: On model.citrus_trade.trade_by_reporter: create or replace transient table TRHS.analytics.trade_by_reporter
    
    
    
    as (with base as (
    select 
        declarant,
        declarant_iso,
        partner,
        partner_iso,
        flow,
        transport_mode,
        left(period,4) as year,
        period,
        hs6,
        hs6_name,
        sum(value_in_euros) as total_value,
        sum(quantity_in_kg) as total_quantity,
        sum(value_in_euros) / nullif(sum(quantity_in_kg), 0) as value_per_quantity
    from TRHS.staging.stg_trade
    group by 1,2,3,4,5,6,7,8,9,10
)
select 
    declarant,
    declarant_iso,
    partner,
    partner_iso,
    flow,
    transport_mode,
    year,
    period,
    hs6,
    hs6_name,
    metric_type,
    metric_value
from base
unpivot(
    metric_value for metric_type in (
        total_value,
        total_quantity,
        value_per_quantity
    )
)
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.trade_by_reporter"} */;
[0m12:07:48.760396 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:07:49.889856 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.129 seconds
[0m12:07:49.896269 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c68b85c2-d40e-420f-ba0e-6e1676bf6147', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e16b8c0>]}
[0m12:07:49.897844 [info ] [Thread-3 (]: 2 of 2 OK created sql table model analytics.trade_by_reporter .................. [[32mSUCCESS 1[0m in 1.15s]
[0m12:07:49.899185 [debug] [Thread-3 (]: Finished running node model.citrus_trade.trade_by_reporter
[0m12:07:49.903257 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:07:49.904287 [debug] [MainThread]: Connection 'model.citrus_trade.stg_trade' was left open.
[0m12:07:49.905156 [debug] [MainThread]: On model.citrus_trade.stg_trade: Close
[0m12:07:50.029532 [debug] [MainThread]: Connection 'list_TRHS_analytics' was left open.
[0m12:07:50.030008 [debug] [MainThread]: On list_TRHS_analytics: Close
[0m12:07:50.147789 [debug] [MainThread]: Connection 'model.citrus_trade.trade_by_reporter' was left open.
[0m12:07:50.148640 [debug] [MainThread]: On model.citrus_trade.trade_by_reporter: Close
[0m12:07:50.306076 [info ] [MainThread]: 
[0m12:07:50.307136 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 5.67 seconds (5.67s).
[0m12:07:50.310635 [debug] [MainThread]: Command end result
[0m12:07:50.361617 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m12:07:50.363899 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m12:07:50.370686 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt/target/run_results.json
[0m12:07:50.371038 [info ] [MainThread]: 
[0m12:07:50.371385 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:07:50.371708 [info ] [MainThread]: 
[0m12:07:50.372158 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m12:07:50.373127 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.374191, "process_in_blocks": "0", "process_kernel_time": 0.376461, "process_mem_max_rss": "164964", "process_out_blocks": "4060", "process_user_time": 1.782121}
[0m12:07:50.373534 [debug] [MainThread]: Command `dbt run` succeeded at 12:07:50.373447 after 6.37 seconds
[0m12:07:50.373856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff825c6900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e14fad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff810c6cf0>]}
[0m12:07:50.374129 [debug] [MainThread]: Flushing usage events
[0m12:07:50.844208 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:49:59.505697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9692e270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98dcf530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96a49b80>]}


============================== 12:49:59.509556 | 8596bb9f-7c78-45a9-bf16-c40719ff1a3f ==============================
[0m12:49:59.509556 [info ] [MainThread]: Running with dbt=1.10.13
[0m12:49:59.509991 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '/app/dbt', 'partial_parse': 'True', 'write_json': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'quiet': 'False', 'indirect_selection': 'eager', 'target_path': 'None', 'use_colors': 'True', 'introspect': 'True', 'no_print': 'None', 'use_experimental_parser': 'False', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'fail_fast': 'False', 'cache_selected_only': 'False', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'debug': 'False', 'log_cache_events': 'False', 'empty': 'False', 'log_format': 'default', 'log_path': '/app/dbt/logs'}
[0m12:49:59.734825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8596bb9f-7c78-45a9-bf16-c40719ff1a3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98a224b0>]}
[0m12:49:59.766162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8596bb9f-7c78-45a9-bf16-c40719ff1a3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9504eae0>]}
[0m12:49:59.766715 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m12:49:59.818180 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m12:49:59.931172 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:49:59.931561 [debug] [MainThread]: Partial parsing: updated file: citrus_trade://models/analytics/trade_by_reporter.sql
[0m12:50:00.060407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8596bb9f-7c78-45a9-bf16-c40719ff1a3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff945ecfb0>]}
[0m12:50:00.102854 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m12:50:00.104318 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m12:50:00.112466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8596bb9f-7c78-45a9-bf16-c40719ff1a3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94fe5cd0>]}
[0m12:50:00.112728 [info ] [MainThread]: Found 2 models, 1 source, 632 macros
[0m12:50:00.113040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8596bb9f-7c78-45a9-bf16-c40719ff1a3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9452eed0>]}
[0m12:50:00.114089 [info ] [MainThread]: 
[0m12:50:00.114282 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:50:00.114672 [info ] [MainThread]: 
[0m12:50:00.115322 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:50:00.117732 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRHS'
[0m12:50:00.124072 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRHS'
[0m12:50:00.143612 [debug] [ThreadPool]: Using snowflake connection "list_TRHS"
[0m12:50:00.143927 [debug] [ThreadPool]: Using snowflake connection "list_TRHS"
[0m12:50:00.144096 [debug] [ThreadPool]: On list_TRHS: show terse schemas in database TRHS
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS"} */
[0m12:50:00.144318 [debug] [ThreadPool]: On list_TRHS: show terse schemas in database TRHS
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS"} */
[0m12:50:00.144500 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:50:00.144694 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:50:03.031290 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2.886 seconds
[0m12:50:03.060013 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2.915 seconds
[0m12:50:03.065091 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRHS, now list_TRHS_staging)
[0m12:50:03.073184 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRHS, now list_TRHS_analytics)
[0m12:50:03.093965 [debug] [ThreadPool]: Using snowflake connection "list_TRHS_analytics"
[0m12:50:03.094702 [debug] [ThreadPool]: Using snowflake connection "list_TRHS_staging"
[0m12:50:03.095013 [debug] [ThreadPool]: On list_TRHS_analytics: show objects in TRHS.analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS_analytics"} */;
[0m12:50:03.095411 [debug] [ThreadPool]: On list_TRHS_staging: show objects in TRHS.staging
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS_staging"} */;
[0m12:50:03.208574 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.113 seconds
[0m12:50:03.214122 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.118 seconds
[0m12:50:03.217521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8596bb9f-7c78-45a9-bf16-c40719ff1a3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98af94c0>]}
[0m12:50:03.223841 [debug] [Thread-1 (]: Began running node model.citrus_trade.stg_trade
[0m12:50:03.224662 [info ] [Thread-1 (]: 1 of 2 START sql table model staging.stg_trade ................................. [RUN]
[0m12:50:03.225503 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_TRHS_staging, now model.citrus_trade.stg_trade)
[0m12:50:03.226144 [debug] [Thread-1 (]: Began compiling node model.citrus_trade.stg_trade
[0m12:50:03.236276 [debug] [Thread-1 (]: Writing injected SQL for node "model.citrus_trade.stg_trade"
[0m12:50:03.238644 [debug] [Thread-1 (]: Began executing node model.citrus_trade.stg_trade
[0m12:50:03.269088 [debug] [Thread-1 (]: Writing runtime sql for node "model.citrus_trade.stg_trade"
[0m12:50:03.271263 [debug] [Thread-1 (]: Using snowflake connection "model.citrus_trade.stg_trade"
[0m12:50:03.271616 [debug] [Thread-1 (]: On model.citrus_trade.stg_trade: create or replace transient table TRHS.staging.stg_trade
    
    
    
    as (select
  value:DECLARANT::int as declarant,
  value:DECLARANT_ISO::string as declarant_iso,
  value:PARTNER::string as partner,
  value:PARTNER_ISO::string as partner_iso,
  value:FLOW::int as flow,
  value:TRANSPORT_MODE::int as transport_mode,
  value:PERIOD::int as period,
  value:HS4::string as hs4,
  value:HS4_NAME::string as hs4_name,
  value:HS6::string as hs6,
  value:HS6_NAME::string as hs6_name,
  value:VALUE_IN_EUROS::float as value_in_euros,
  value:QUANTITY_IN_KG::float as quantity_in_kg
from trhs.staging.citrus_ext
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.stg_trade"} */;
[0m12:50:04.314760 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.043 seconds
[0m12:50:04.332628 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8596bb9f-7c78-45a9-bf16-c40719ff1a3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92d2e510>]}
[0m12:50:04.333174 [info ] [Thread-1 (]: 1 of 2 OK created sql table model staging.stg_trade ............................ [[32mSUCCESS 1[0m in 1.11s]
[0m12:50:04.333791 [debug] [Thread-1 (]: Finished running node model.citrus_trade.stg_trade
[0m12:50:04.334684 [debug] [Thread-3 (]: Began running node model.citrus_trade.trade_by_reporter
[0m12:50:04.335181 [info ] [Thread-3 (]: 2 of 2 START sql table model analytics.trade_by_reporter ....................... [RUN]
[0m12:50:04.335757 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.citrus_trade.trade_by_reporter'
[0m12:50:04.336116 [debug] [Thread-3 (]: Began compiling node model.citrus_trade.trade_by_reporter
[0m12:50:04.338600 [debug] [Thread-3 (]: Writing injected SQL for node "model.citrus_trade.trade_by_reporter"
[0m12:50:04.340715 [debug] [Thread-3 (]: Began executing node model.citrus_trade.trade_by_reporter
[0m12:50:04.342635 [debug] [Thread-3 (]: Writing runtime sql for node "model.citrus_trade.trade_by_reporter"
[0m12:50:04.345569 [debug] [Thread-3 (]: Using snowflake connection "model.citrus_trade.trade_by_reporter"
[0m12:50:04.346092 [debug] [Thread-3 (]: On model.citrus_trade.trade_by_reporter: create or replace transient table TRHS.analytics.trade_by_reporter
    
    
    
    as (with base as (
    select 
        declarant,
        declarant_iso,
        partner,
        partner_iso,
        flow,
        transport_mode,
        year(to_date(left(period,4),'YYYY')) as year,
        period,
        hs6,
        hs6_name,
        sum(value_in_euros) as total_value,
        sum(quantity_in_kg) as total_quantity,
        sum(value_in_euros) / nullif(sum(quantity_in_kg), 0) as value_per_quantity
    from TRHS.staging.stg_trade
    group by 1,2,3,4,5,6,7,8,9,10
)
select 
    declarant,
    declarant_iso,
    partner,
    partner_iso,
    flow,
    transport_mode,
    year,
    period,
    hs6,
    hs6_name,
    metric_type,
    metric_value
from base
unpivot(
    metric_value for metric_type in (
        total_value,
        total_quantity,
        value_per_quantity
    )
)
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.trade_by_reporter"} */;
[0m12:50:04.346386 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:50:06.761072 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 2.414 seconds
[0m12:50:06.767248 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8596bb9f-7c78-45a9-bf16-c40719ff1a3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92d488c0>]}
[0m12:50:06.768527 [info ] [Thread-3 (]: 2 of 2 OK created sql table model analytics.trade_by_reporter .................. [[32mSUCCESS 1[0m in 2.43s]
[0m12:50:06.769762 [debug] [Thread-3 (]: Finished running node model.citrus_trade.trade_by_reporter
[0m12:50:06.772568 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:50:06.773136 [debug] [MainThread]: Connection 'model.citrus_trade.stg_trade' was left open.
[0m12:50:06.773866 [debug] [MainThread]: On model.citrus_trade.stg_trade: Close
[0m12:50:06.912862 [debug] [MainThread]: Connection 'list_TRHS_analytics' was left open.
[0m12:50:06.913646 [debug] [MainThread]: On list_TRHS_analytics: Close
[0m12:50:07.008079 [debug] [MainThread]: Connection 'model.citrus_trade.trade_by_reporter' was left open.
[0m12:50:07.008420 [debug] [MainThread]: On model.citrus_trade.trade_by_reporter: Close
[0m12:50:07.166928 [info ] [MainThread]: 
[0m12:50:07.167510 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 7.05 seconds (7.05s).
[0m12:50:07.168701 [debug] [MainThread]: Command end result
[0m12:50:07.204544 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m12:50:07.206296 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m12:50:07.210814 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt/target/run_results.json
[0m12:50:07.211024 [info ] [MainThread]: 
[0m12:50:07.211256 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:50:07.211515 [info ] [MainThread]: 
[0m12:50:07.212046 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m12:50:07.212847 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.74223, "process_in_blocks": "0", "process_kernel_time": 0.430309, "process_mem_max_rss": "165032", "process_out_blocks": "4060", "process_user_time": 1.684036}
[0m12:50:07.213128 [debug] [MainThread]: Command `dbt run` succeeded at 12:50:07.213069 after 7.74 seconds
[0m12:50:07.213358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96c34ce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff970207a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97021190>]}
[0m12:50:07.213567 [debug] [MainThread]: Flushing usage events
[0m12:50:07.800534 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:36:34.715323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa23109b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4a02f00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa29fbc80>]}


============================== 14:36:34.722930 | 357cfa1d-d619-4e95-969e-74f289184dad ==============================
[0m14:36:34.722930 [info ] [MainThread]: Running with dbt=1.10.13
[0m14:36:34.724218 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'cache_selected_only': 'False', 'log_path': '/app/dbt/logs', 'partial_parse': 'True', 'empty': 'False', 'debug': 'False', 'no_print': 'None', 'printer_width': '80', 'use_experimental_parser': 'False', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'indirect_selection': 'eager', 'write_json': 'True', 'quiet': 'False', 'profiles_dir': '/app/dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_cache_events': 'False', 'introspect': 'True', 'invocation_command': 'dbt run'}
[0m14:36:35.258337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '357cfa1d-d619-4e95-969e-74f289184dad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa07549e0>]}
[0m14:36:35.314400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '357cfa1d-d619-4e95-969e-74f289184dad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa285cc80>]}
[0m14:36:35.315306 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m14:36:35.490686 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m14:36:35.650104 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 3 files added, 0 files changed.
[0m14:36:35.650560 [debug] [MainThread]: Partial parsing: added file: citrus_trade://models/visualisation/exporter.sql
[0m14:36:35.650861 [debug] [MainThread]: Partial parsing: added file: citrus_trade://models/visualisation/importer.sql
[0m14:36:35.651106 [debug] [MainThread]: Partial parsing: added file: citrus_trade://models/visualisation/importer_by_year.sql
[0m14:36:35.841763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '357cfa1d-d619-4e95-969e-74f289184dad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa00c4b90>]}
[0m14:36:35.907273 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m14:36:35.909435 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m14:36:35.923025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '357cfa1d-d619-4e95-969e-74f289184dad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ffab020>]}
[0m14:36:35.923900 [info ] [MainThread]: Found 5 models, 1 source, 632 macros
[0m14:36:35.924574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '357cfa1d-d619-4e95-969e-74f289184dad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ff37e60>]}
[0m14:36:35.927481 [info ] [MainThread]: 
[0m14:36:35.928045 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:36:35.928961 [info ] [MainThread]: 
[0m14:36:35.929843 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:36:35.934790 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRHS'
[0m14:36:35.941749 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRHS'
[0m14:36:35.959884 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRHS'
[0m14:36:35.979757 [debug] [ThreadPool]: Using snowflake connection "list_TRHS"
[0m14:36:35.980183 [debug] [ThreadPool]: Using snowflake connection "list_TRHS"
[0m14:36:35.980521 [debug] [ThreadPool]: Using snowflake connection "list_TRHS"
[0m14:36:35.980731 [debug] [ThreadPool]: On list_TRHS: show terse schemas in database TRHS
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS"} */
[0m14:36:35.981003 [debug] [ThreadPool]: On list_TRHS: show terse schemas in database TRHS
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS"} */
[0m14:36:35.981303 [debug] [ThreadPool]: On list_TRHS: show terse schemas in database TRHS
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS"} */
[0m14:36:35.981574 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:36:35.981830 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:36:35.982105 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:36:39.099776 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 3.117 seconds
[0m14:36:39.106616 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 3.125 seconds
[0m14:36:39.113782 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 3.132 seconds
[0m14:36:39.117924 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRHS, now list_TRHS_analytics)
[0m14:36:39.118823 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRHS, now list_TRHS_ANALYTICS)
[0m14:36:39.134211 [debug] [ThreadPool]: Using snowflake connection "list_TRHS_analytics"
[0m14:36:39.134730 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRHS, now list_TRHS_staging)
[0m14:36:39.137244 [debug] [ThreadPool]: Using snowflake connection "list_TRHS_ANALYTICS"
[0m14:36:39.137841 [debug] [ThreadPool]: On list_TRHS_analytics: show objects in TRHS.analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS_analytics"} */;
[0m14:36:39.139859 [debug] [ThreadPool]: Using snowflake connection "list_TRHS_staging"
[0m14:36:39.140267 [debug] [ThreadPool]: On list_TRHS_ANALYTICS: show objects in TRHS.ANALYTICS
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS_ANALYTICS"} */;
[0m14:36:39.141999 [debug] [ThreadPool]: On list_TRHS_staging: show objects in TRHS.staging
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS_staging"} */;
[0m14:36:39.240643 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.097 seconds
[0m14:36:39.243269 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.103 seconds
[0m14:36:39.251338 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.109 seconds
[0m14:36:39.254450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '357cfa1d-d619-4e95-969e-74f289184dad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa44c9670>]}
[0m14:36:39.261447 [debug] [Thread-1 (]: Began running node model.citrus_trade.stg_trade
[0m14:36:39.262143 [info ] [Thread-1 (]: 1 of 5 START sql table model staging.stg_trade ................................. [RUN]
[0m14:36:39.262872 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_TRHS_ANALYTICS, now model.citrus_trade.stg_trade)
[0m14:36:39.263476 [debug] [Thread-1 (]: Began compiling node model.citrus_trade.stg_trade
[0m14:36:39.272683 [debug] [Thread-1 (]: Writing injected SQL for node "model.citrus_trade.stg_trade"
[0m14:36:39.274769 [debug] [Thread-1 (]: Began executing node model.citrus_trade.stg_trade
[0m14:36:39.301508 [debug] [Thread-1 (]: Writing runtime sql for node "model.citrus_trade.stg_trade"
[0m14:36:39.303254 [debug] [Thread-1 (]: Using snowflake connection "model.citrus_trade.stg_trade"
[0m14:36:39.303572 [debug] [Thread-1 (]: On model.citrus_trade.stg_trade: create or replace transient table TRHS.staging.stg_trade
    
    
    
    as (select
  value:DECLARANT::int as declarant,
  value:DECLARANT_ISO::string as declarant_iso,
  value:PARTNER::string as partner,
  value:PARTNER_ISO::string as partner_iso,
  value:FLOW::int as flow,
  value:TRANSPORT_MODE::int as transport_mode,
  value:PERIOD::int as period,
  value:HS4::string as hs4,
  value:HS4_NAME::string as hs4_name,
  value:HS6::string as hs6,
  value:HS6_NAME::string as hs6_name,
  value:VALUE_IN_EUROS::float as value_in_euros,
  value:QUANTITY_IN_KG::float as quantity_in_kg
from trhs.staging.citrus_ext
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.stg_trade"} */;
[0m14:36:40.653592 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.349 seconds
[0m14:36:40.690025 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '357cfa1d-d619-4e95-969e-74f289184dad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa43f1820>]}
[0m14:36:40.691195 [info ] [Thread-1 (]: 1 of 5 OK created sql table model staging.stg_trade ............................ [[32mSUCCESS 1[0m in 1.43s]
[0m14:36:40.692218 [debug] [Thread-1 (]: Finished running node model.citrus_trade.stg_trade
[0m14:36:40.694688 [debug] [Thread-3 (]: Began running node model.citrus_trade.trade_by_reporter
[0m14:36:40.695386 [info ] [Thread-3 (]: 2 of 5 START sql table model analytics.trade_by_reporter ....................... [RUN]
[0m14:36:40.696020 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_TRHS_staging, now model.citrus_trade.trade_by_reporter)
[0m14:36:40.696503 [debug] [Thread-3 (]: Began compiling node model.citrus_trade.trade_by_reporter
[0m14:36:40.704911 [debug] [Thread-3 (]: Writing injected SQL for node "model.citrus_trade.trade_by_reporter"
[0m14:36:40.706985 [debug] [Thread-3 (]: Began executing node model.citrus_trade.trade_by_reporter
[0m14:36:40.709592 [debug] [Thread-3 (]: Writing runtime sql for node "model.citrus_trade.trade_by_reporter"
[0m14:36:40.711427 [debug] [Thread-3 (]: Using snowflake connection "model.citrus_trade.trade_by_reporter"
[0m14:36:40.711762 [debug] [Thread-3 (]: On model.citrus_trade.trade_by_reporter: create or replace transient table TRHS.analytics.trade_by_reporter
    
    
    
    as (with base as (
    select 
        declarant,
        declarant_iso,
        partner,
        partner_iso,
        flow,
        transport_mode,
        year(to_date(left(period,4),'YYYY')) as year,
        period,
        hs6,
        hs6_name,
        sum(value_in_euros) as total_value,
        sum(quantity_in_kg) as total_quantity,
        sum(value_in_euros) / nullif(sum(quantity_in_kg), 0) as value_per_quantity
    from TRHS.staging.stg_trade
    group by 1,2,3,4,5,6,7,8,9,10
)
select 
    declarant,
    declarant_iso,
    partner,
    partner_iso,
    flow,
    transport_mode,
    year,
    period,
    hs6,
    hs6_name,
    metric_type,
    metric_value
from base
unpivot(
    metric_value for metric_type in (
        total_value,
        total_quantity,
        value_per_quantity
    )
)
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.trade_by_reporter"} */;
[0m14:36:41.565476 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.853 seconds
[0m14:36:41.569276 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '357cfa1d-d619-4e95-969e-74f289184dad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff955204a0>]}
[0m14:36:41.570403 [info ] [Thread-3 (]: 2 of 5 OK created sql table model analytics.trade_by_reporter .................. [[32mSUCCESS 1[0m in 0.87s]
[0m14:36:41.571690 [debug] [Thread-3 (]: Finished running node model.citrus_trade.trade_by_reporter
[0m14:36:41.572938 [debug] [Thread-2 (]: Began running node model.citrus_trade.exporter
[0m14:36:41.573452 [debug] [Thread-1 (]: Began running node model.citrus_trade.importer
[0m14:36:41.573955 [info ] [Thread-2 (]: 3 of 5 START sql view model ANALYTICS.exporter ................................. [RUN]
[0m14:36:41.574496 [debug] [Thread-4 (]: Began running node model.citrus_trade.importer_by_year
[0m14:36:41.575097 [info ] [Thread-1 (]: 4 of 5 START sql view model ANALYTICS.importer ................................. [RUN]
[0m14:36:41.575897 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_TRHS_analytics, now model.citrus_trade.exporter)
[0m14:36:41.576581 [info ] [Thread-4 (]: 5 of 5 START sql view model ANALYTICS.importer_by_year ......................... [RUN]
[0m14:36:41.577285 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.citrus_trade.stg_trade, now model.citrus_trade.importer)
[0m14:36:41.578939 [debug] [Thread-1 (]: Began compiling node model.citrus_trade.importer
[0m14:36:41.578445 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.citrus_trade.importer_by_year'
[0m14:36:41.577783 [debug] [Thread-2 (]: Began compiling node model.citrus_trade.exporter
[0m14:36:41.582962 [debug] [Thread-1 (]: Writing injected SQL for node "model.citrus_trade.importer"
[0m14:36:41.583567 [debug] [Thread-4 (]: Began compiling node model.citrus_trade.importer_by_year
[0m14:36:41.586498 [debug] [Thread-2 (]: Writing injected SQL for node "model.citrus_trade.exporter"
[0m14:36:41.591126 [debug] [Thread-4 (]: Writing injected SQL for node "model.citrus_trade.importer_by_year"
[0m14:36:41.595159 [debug] [Thread-2 (]: Began executing node model.citrus_trade.exporter
[0m14:36:41.616960 [debug] [Thread-2 (]: Writing runtime sql for node "model.citrus_trade.exporter"
[0m14:36:41.618783 [debug] [Thread-4 (]: Began executing node model.citrus_trade.importer_by_year
[0m14:36:41.619067 [debug] [Thread-1 (]: Began executing node model.citrus_trade.importer
[0m14:36:41.621219 [debug] [Thread-4 (]: Writing runtime sql for node "model.citrus_trade.importer_by_year"
[0m14:36:41.622987 [debug] [Thread-1 (]: Writing runtime sql for node "model.citrus_trade.importer"
[0m14:36:41.627893 [debug] [Thread-2 (]: Using snowflake connection "model.citrus_trade.exporter"
[0m14:36:41.628400 [debug] [Thread-1 (]: Using snowflake connection "model.citrus_trade.importer"
[0m14:36:41.628637 [debug] [Thread-2 (]: On model.citrus_trade.exporter: create or replace   view TRHS.ANALYTICS.exporter
  
  
  
  
  as (
    select 
    declarant_iso,
    metric_type,
    CASE 
        WHEN 
            metric_type = 'value_by_quantity'
            THEN AVG(metric_value)
        ELSE
            SUM(metric_value)
    END as metric_value
from TRHS.analytics.trade_by_reporter
where flow = 2
  )
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.exporter"} */;
[0m14:36:41.628927 [debug] [Thread-1 (]: On model.citrus_trade.importer: create or replace   view TRHS.ANALYTICS.importer
  
  
  
  
  as (
    select 
    declarant_iso,
    metric_type,
    CASE 
        WHEN 
            metric_type = 'value_by_quantity'
            THEN AVG(metric_value)
        ELSE
            SUM(metric_value)
    END as metric_value
from TRHS.analytics.trade_by_reporter
where flow = 2
  )
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.importer"} */;
[0m14:36:41.629458 [debug] [Thread-4 (]: Using snowflake connection "model.citrus_trade.importer_by_year"
[0m14:36:41.632491 [debug] [Thread-4 (]: On model.citrus_trade.importer_by_year: create or replace   view TRHS.ANALYTICS.importer_by_year
  
  
  
  
  as (
    select 
    declarant_iso,
    year,
    metric_type,
    CASE 
        WHEN 
            metric_type = 'value_by_quantity'
            THEN AVG(metric_value)
        ELSE
            SUM(metric_value)
    END as metric_value
from TRHS.analytics.trade_by_reporter
where flow = 1
  )
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.importer_by_year"} */;
[0m14:36:41.633251 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:36:41.729342 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01c02aec-0105-6cf2-0000-000420cabae9
[0m14:36:41.729820 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01c02aec-0105-6cf2-0000-000420cabaed
[0m14:36:41.730084 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 000979 (42601): SQL compilation error:
[TRADE_BY_REPORTER.DECLARANT_ISO] is not a valid group by expression
[0m14:36:41.730429 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000979 (42601): SQL compilation error:
[TRADE_BY_REPORTER.DECLARANT_ISO] is not a valid group by expression
[0m14:36:41.733695 [debug] [Thread-2 (]: Database Error in model exporter (models/visualisation/exporter.sql)
  000979 (42601): SQL compilation error:
  [TRADE_BY_REPORTER.DECLARANT_ISO] is not a valid group by expression
  compiled code at target/run/citrus_trade/models/visualisation/exporter.sql
[0m14:36:41.735952 [debug] [Thread-1 (]: Database Error in model importer (models/visualisation/importer.sql)
  000979 (42601): SQL compilation error:
  [TRADE_BY_REPORTER.DECLARANT_ISO] is not a valid group by expression
  compiled code at target/run/citrus_trade/models/visualisation/importer.sql
[0m14:36:41.736284 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '357cfa1d-d619-4e95-969e-74f289184dad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c232de0>]}
[0m14:36:41.736602 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '357cfa1d-d619-4e95-969e-74f289184dad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e7f9490>]}
[0m14:36:41.737121 [error] [Thread-2 (]: 3 of 5 ERROR creating sql view model ANALYTICS.exporter ........................ [[31mERROR[0m in 0.16s]
[0m14:36:41.737620 [error] [Thread-1 (]: 4 of 5 ERROR creating sql view model ANALYTICS.importer ........................ [[31mERROR[0m in 0.16s]
[0m14:36:41.738089 [debug] [Thread-2 (]: Finished running node model.citrus_trade.exporter
[0m14:36:41.738469 [debug] [Thread-1 (]: Finished running node model.citrus_trade.importer
[0m14:36:41.738819 [debug] [Thread-7 (]: Marking all children of 'model.citrus_trade.exporter' to be skipped because of status 'error'.  Reason: Database Error in model exporter (models/visualisation/exporter.sql)
  000979 (42601): SQL compilation error:
  [TRADE_BY_REPORTER.DECLARANT_ISO] is not a valid group by expression
  compiled code at target/run/citrus_trade/models/visualisation/exporter.sql.
[0m14:36:41.739630 [debug] [Thread-7 (]: Marking all children of 'model.citrus_trade.importer' to be skipped because of status 'error'.  Reason: Database Error in model importer (models/visualisation/importer.sql)
  000979 (42601): SQL compilation error:
  [TRADE_BY_REPORTER.DECLARANT_ISO] is not a valid group by expression
  compiled code at target/run/citrus_trade/models/visualisation/importer.sql.
[0m14:36:42.005403 [debug] [Thread-4 (]: Snowflake adapter: Snowflake query id: 01c02aec-0105-6cf2-0000-000420cabaf1
[0m14:36:42.006939 [debug] [Thread-4 (]: Snowflake adapter: Snowflake error: 000979 (42601): SQL compilation error:
[TRADE_BY_REPORTER.DECLARANT_ISO] is not a valid group by expression
[0m14:36:42.013432 [debug] [Thread-4 (]: Database Error in model importer_by_year (models/visualisation/importer_by_year.sql)
  000979 (42601): SQL compilation error:
  [TRADE_BY_REPORTER.DECLARANT_ISO] is not a valid group by expression
  compiled code at target/run/citrus_trade/models/visualisation/importer_by_year.sql
[0m14:36:42.014521 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '357cfa1d-d619-4e95-969e-74f289184dad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97a334d0>]}
[0m14:36:42.015617 [error] [Thread-4 (]: 5 of 5 ERROR creating sql view model ANALYTICS.importer_by_year ................ [[31mERROR[0m in 0.44s]
[0m14:36:42.016731 [debug] [Thread-4 (]: Finished running node model.citrus_trade.importer_by_year
[0m14:36:42.017623 [debug] [Thread-7 (]: Marking all children of 'model.citrus_trade.importer_by_year' to be skipped because of status 'error'.  Reason: Database Error in model importer_by_year (models/visualisation/importer_by_year.sql)
  000979 (42601): SQL compilation error:
  [TRADE_BY_REPORTER.DECLARANT_ISO] is not a valid group by expression
  compiled code at target/run/citrus_trade/models/visualisation/importer_by_year.sql.
[0m14:36:42.020250 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:36:42.020712 [debug] [MainThread]: Connection 'model.citrus_trade.importer' was left open.
[0m14:36:42.021189 [debug] [MainThread]: On model.citrus_trade.importer: Close
[0m14:36:42.150843 [debug] [MainThread]: Connection 'model.citrus_trade.exporter' was left open.
[0m14:36:42.153333 [debug] [MainThread]: On model.citrus_trade.exporter: Close
[0m14:36:42.271678 [debug] [MainThread]: Connection 'model.citrus_trade.trade_by_reporter' was left open.
[0m14:36:42.272604 [debug] [MainThread]: On model.citrus_trade.trade_by_reporter: Close
[0m14:36:42.429182 [debug] [MainThread]: Connection 'model.citrus_trade.importer_by_year' was left open.
[0m14:36:42.430447 [debug] [MainThread]: On model.citrus_trade.importer_by_year: Close
[0m14:36:42.597728 [info ] [MainThread]: 
[0m14:36:42.598908 [info ] [MainThread]: Finished running 2 table models, 3 view models in 0 hours 0 minutes and 6.67 seconds (6.67s).
[0m14:36:42.601251 [debug] [MainThread]: Command end result
[0m14:36:42.647826 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m14:36:42.649864 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m14:36:42.655700 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt/target/run_results.json
[0m14:36:42.656043 [info ] [MainThread]: 
[0m14:36:42.656546 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m14:36:42.656963 [info ] [MainThread]: 
[0m14:36:42.657374 [error] [MainThread]: [31mFailure in model exporter (models/visualisation/exporter.sql)[0m
[0m14:36:42.657825 [error] [MainThread]:   Database Error in model exporter (models/visualisation/exporter.sql)
  000979 (42601): SQL compilation error:
  [TRADE_BY_REPORTER.DECLARANT_ISO] is not a valid group by expression
  compiled code at target/run/citrus_trade/models/visualisation/exporter.sql
[0m14:36:42.658414 [info ] [MainThread]: 
[0m14:36:42.658679 [info ] [MainThread]:   compiled code at target/compiled/citrus_trade/models/visualisation/exporter.sql
[0m14:36:42.659009 [info ] [MainThread]: 
[0m14:36:42.659375 [error] [MainThread]: [31mFailure in model importer (models/visualisation/importer.sql)[0m
[0m14:36:42.659743 [error] [MainThread]:   Database Error in model importer (models/visualisation/importer.sql)
  000979 (42601): SQL compilation error:
  [TRADE_BY_REPORTER.DECLARANT_ISO] is not a valid group by expression
  compiled code at target/run/citrus_trade/models/visualisation/importer.sql
[0m14:36:42.660019 [info ] [MainThread]: 
[0m14:36:42.660444 [info ] [MainThread]:   compiled code at target/compiled/citrus_trade/models/visualisation/importer.sql
[0m14:36:42.660699 [info ] [MainThread]: 
[0m14:36:42.661043 [error] [MainThread]: [31mFailure in model importer_by_year (models/visualisation/importer_by_year.sql)[0m
[0m14:36:42.661423 [error] [MainThread]:   Database Error in model importer_by_year (models/visualisation/importer_by_year.sql)
  000979 (42601): SQL compilation error:
  [TRADE_BY_REPORTER.DECLARANT_ISO] is not a valid group by expression
  compiled code at target/run/citrus_trade/models/visualisation/importer_by_year.sql
[0m14:36:42.661756 [info ] [MainThread]: 
[0m14:36:42.662777 [info ] [MainThread]:   compiled code at target/compiled/citrus_trade/models/visualisation/importer_by_year.sql
[0m14:36:42.663386 [info ] [MainThread]: 
[0m14:36:42.663869 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=3 SKIP=0 NO-OP=0 TOTAL=5
[0m14:36:42.665288 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 8.049421, "process_in_blocks": "0", "process_kernel_time": 0.838965, "process_mem_max_rss": "173760", "process_out_blocks": "4140", "process_user_time": 2.906234}
[0m14:36:42.665637 [debug] [MainThread]: Command `dbt run` failed at 14:36:42.665572 after 8.05 seconds
[0m14:36:42.665970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ef7c680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1b02390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e729ac0>]}
[0m14:36:42.666447 [debug] [MainThread]: Flushing usage events
[0m14:36:43.392113 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:37:28.024581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3256330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb177c110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0dd69c0>]}


============================== 14:37:28.028240 | b4f7fe74-8f90-4c40-a752-e300cee53c16 ==============================
[0m14:37:28.028240 [info ] [MainThread]: Running with dbt=1.10.13
[0m14:37:28.028794 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'target_path': 'None', 'printer_width': '80', 'introspect': 'True', 'partial_parse': 'True', 'version_check': 'True', 'warn_error': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True', 'log_path': '/app/dbt/logs', 'debug': 'False', 'use_colors': 'True', 'quiet': 'False', 'static_parser': 'True', 'indirect_selection': 'eager', 'profiles_dir': '/app/dbt', 'fail_fast': 'False', 'write_json': 'True', 'log_format': 'default', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'empty': 'False'}
[0m14:37:28.244630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b4f7fe74-8f90-4c40-a752-e300cee53c16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf037ad0>]}
[0m14:37:28.275081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b4f7fe74-8f90-4c40-a752-e300cee53c16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaefe09e0>]}
[0m14:37:28.275521 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m14:37:28.326139 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m14:37:28.439664 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m14:37:28.440043 [debug] [MainThread]: Partial parsing: updated file: citrus_trade://models/visualisation/importer_by_year.sql
[0m14:37:28.440248 [debug] [MainThread]: Partial parsing: updated file: citrus_trade://models/visualisation/importer.sql
[0m14:37:28.440424 [debug] [MainThread]: Partial parsing: updated file: citrus_trade://models/visualisation/exporter.sql
[0m14:37:28.591423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b4f7fe74-8f90-4c40-a752-e300cee53c16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae9fb4d0>]}
[0m14:37:28.661858 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m14:37:28.663390 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m14:37:28.671987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b4f7fe74-8f90-4c40-a752-e300cee53c16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae9fb410>]}
[0m14:37:28.672263 [info ] [MainThread]: Found 5 models, 1 source, 632 macros
[0m14:37:28.672451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b4f7fe74-8f90-4c40-a752-e300cee53c16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaea3f9b0>]}
[0m14:37:28.673494 [info ] [MainThread]: 
[0m14:37:28.673718 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:37:28.674124 [info ] [MainThread]: 
[0m14:37:28.674733 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:37:28.677286 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRHS'
[0m14:37:28.683531 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRHS'
[0m14:37:28.684971 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRHS'
[0m14:37:28.703300 [debug] [ThreadPool]: Using snowflake connection "list_TRHS"
[0m14:37:28.703600 [debug] [ThreadPool]: Using snowflake connection "list_TRHS"
[0m14:37:28.703806 [debug] [ThreadPool]: Using snowflake connection "list_TRHS"
[0m14:37:28.703953 [debug] [ThreadPool]: On list_TRHS: show terse schemas in database TRHS
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS"} */
[0m14:37:28.704181 [debug] [ThreadPool]: On list_TRHS: show terse schemas in database TRHS
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS"} */
[0m14:37:28.704387 [debug] [ThreadPool]: On list_TRHS: show terse schemas in database TRHS
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS"} */
[0m14:37:28.704617 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:37:28.704813 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:37:28.704998 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:37:31.594717 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.890 seconds
[0m14:37:31.600709 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.895 seconds
[0m14:37:31.602562 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.898 seconds
[0m14:37:31.608830 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRHS, now list_TRHS_analytics)
[0m14:37:31.616896 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRHS, now list_TRHS_ANALYTICS)
[0m14:37:31.621957 [debug] [ThreadPool]: Using snowflake connection "list_TRHS_analytics"
[0m14:37:31.622618 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRHS, now list_TRHS_staging)
[0m14:37:31.624993 [debug] [ThreadPool]: Using snowflake connection "list_TRHS_ANALYTICS"
[0m14:37:31.625563 [debug] [ThreadPool]: On list_TRHS_analytics: show objects in TRHS.analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS_analytics"} */;
[0m14:37:31.627863 [debug] [ThreadPool]: Using snowflake connection "list_TRHS_staging"
[0m14:37:31.628481 [debug] [ThreadPool]: On list_TRHS_ANALYTICS: show objects in TRHS.ANALYTICS
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS_ANALYTICS"} */;
[0m14:37:31.630802 [debug] [ThreadPool]: On list_TRHS_staging: show objects in TRHS.staging
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS_staging"} */;
[0m14:37:31.718392 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.089 seconds
[0m14:37:31.719372 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.088 seconds
[0m14:37:31.722954 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.090 seconds
[0m14:37:31.728743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b4f7fe74-8f90-4c40-a752-e300cee53c16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae885220>]}
[0m14:37:31.735710 [debug] [Thread-1 (]: Began running node model.citrus_trade.stg_trade
[0m14:37:31.736483 [info ] [Thread-1 (]: 1 of 5 START sql table model staging.stg_trade ................................. [RUN]
[0m14:37:31.737292 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_TRHS_staging, now model.citrus_trade.stg_trade)
[0m14:37:31.737959 [debug] [Thread-1 (]: Began compiling node model.citrus_trade.stg_trade
[0m14:37:31.747697 [debug] [Thread-1 (]: Writing injected SQL for node "model.citrus_trade.stg_trade"
[0m14:37:31.749460 [debug] [Thread-1 (]: Began executing node model.citrus_trade.stg_trade
[0m14:37:31.778601 [debug] [Thread-1 (]: Writing runtime sql for node "model.citrus_trade.stg_trade"
[0m14:37:31.780130 [debug] [Thread-1 (]: Using snowflake connection "model.citrus_trade.stg_trade"
[0m14:37:31.780462 [debug] [Thread-1 (]: On model.citrus_trade.stg_trade: create or replace transient table TRHS.staging.stg_trade
    
    
    
    as (select
  value:DECLARANT::int as declarant,
  value:DECLARANT_ISO::string as declarant_iso,
  value:PARTNER::string as partner,
  value:PARTNER_ISO::string as partner_iso,
  value:FLOW::int as flow,
  value:TRANSPORT_MODE::int as transport_mode,
  value:PERIOD::int as period,
  value:HS4::string as hs4,
  value:HS4_NAME::string as hs4_name,
  value:HS6::string as hs6,
  value:HS6_NAME::string as hs6_name,
  value:VALUE_IN_EUROS::float as value_in_euros,
  value:QUANTITY_IN_KG::float as quantity_in_kg
from trhs.staging.citrus_ext
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.stg_trade"} */;
[0m14:37:32.722926 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.942 seconds
[0m14:37:32.762359 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b4f7fe74-8f90-4c40-a752-e300cee53c16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2ef1eb0>]}
[0m14:37:32.763530 [info ] [Thread-1 (]: 1 of 5 OK created sql table model staging.stg_trade ............................ [[32mSUCCESS 1[0m in 1.02s]
[0m14:37:32.764332 [debug] [Thread-1 (]: Finished running node model.citrus_trade.stg_trade
[0m14:37:32.765598 [debug] [Thread-3 (]: Began running node model.citrus_trade.trade_by_reporter
[0m14:37:32.766097 [info ] [Thread-3 (]: 2 of 5 START sql table model analytics.trade_by_reporter ....................... [RUN]
[0m14:37:32.766597 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_TRHS_analytics, now model.citrus_trade.trade_by_reporter)
[0m14:37:32.766881 [debug] [Thread-3 (]: Began compiling node model.citrus_trade.trade_by_reporter
[0m14:37:32.769715 [debug] [Thread-3 (]: Writing injected SQL for node "model.citrus_trade.trade_by_reporter"
[0m14:37:32.771716 [debug] [Thread-3 (]: Began executing node model.citrus_trade.trade_by_reporter
[0m14:37:32.774285 [debug] [Thread-3 (]: Writing runtime sql for node "model.citrus_trade.trade_by_reporter"
[0m14:37:32.776663 [debug] [Thread-3 (]: Using snowflake connection "model.citrus_trade.trade_by_reporter"
[0m14:37:32.777122 [debug] [Thread-3 (]: On model.citrus_trade.trade_by_reporter: create or replace transient table TRHS.analytics.trade_by_reporter
    
    
    
    as (with base as (
    select 
        declarant,
        declarant_iso,
        partner,
        partner_iso,
        flow,
        transport_mode,
        year(to_date(left(period,4),'YYYY')) as year,
        period,
        hs6,
        hs6_name,
        sum(value_in_euros) as total_value,
        sum(quantity_in_kg) as total_quantity,
        sum(value_in_euros) / nullif(sum(quantity_in_kg), 0) as value_per_quantity
    from TRHS.staging.stg_trade
    group by 1,2,3,4,5,6,7,8,9,10
)
select 
    declarant,
    declarant_iso,
    partner,
    partner_iso,
    flow,
    transport_mode,
    year,
    period,
    hs6,
    hs6_name,
    metric_type,
    metric_value
from base
unpivot(
    metric_value for metric_type in (
        total_value,
        total_quantity,
        value_per_quantity
    )
)
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.trade_by_reporter"} */;
[0m14:37:33.535916 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.758 seconds
[0m14:37:33.541694 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b4f7fe74-8f90-4c40-a752-e300cee53c16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac9f0560>]}
[0m14:37:33.543665 [info ] [Thread-3 (]: 2 of 5 OK created sql table model analytics.trade_by_reporter .................. [[32mSUCCESS 1[0m in 0.77s]
[0m14:37:33.545191 [debug] [Thread-3 (]: Finished running node model.citrus_trade.trade_by_reporter
[0m14:37:33.546822 [debug] [Thread-2 (]: Began running node model.citrus_trade.exporter
[0m14:37:33.547557 [debug] [Thread-1 (]: Began running node model.citrus_trade.importer
[0m14:37:33.548239 [info ] [Thread-2 (]: 3 of 5 START sql view model ANALYTICS.exporter ................................. [RUN]
[0m14:37:33.548885 [debug] [Thread-4 (]: Began running node model.citrus_trade.importer_by_year
[0m14:37:33.549648 [info ] [Thread-1 (]: 4 of 5 START sql view model ANALYTICS.importer ................................. [RUN]
[0m14:37:33.550838 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_TRHS_ANALYTICS, now model.citrus_trade.exporter)
[0m14:37:33.551740 [info ] [Thread-4 (]: 5 of 5 START sql view model ANALYTICS.importer_by_year ......................... [RUN]
[0m14:37:33.552698 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.citrus_trade.stg_trade, now model.citrus_trade.importer)
[0m14:37:33.554727 [debug] [Thread-1 (]: Began compiling node model.citrus_trade.importer
[0m14:37:33.554194 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.citrus_trade.importer_by_year'
[0m14:37:33.553343 [debug] [Thread-2 (]: Began compiling node model.citrus_trade.exporter
[0m14:37:33.559132 [debug] [Thread-1 (]: Writing injected SQL for node "model.citrus_trade.importer"
[0m14:37:33.559742 [debug] [Thread-4 (]: Began compiling node model.citrus_trade.importer_by_year
[0m14:37:33.563829 [debug] [Thread-2 (]: Writing injected SQL for node "model.citrus_trade.exporter"
[0m14:37:33.567815 [debug] [Thread-4 (]: Writing injected SQL for node "model.citrus_trade.importer_by_year"
[0m14:37:33.569282 [debug] [Thread-1 (]: Began executing node model.citrus_trade.importer
[0m14:37:33.581408 [debug] [Thread-4 (]: Began executing node model.citrus_trade.importer_by_year
[0m14:37:33.581831 [debug] [Thread-2 (]: Began executing node model.citrus_trade.exporter
[0m14:37:33.592068 [debug] [Thread-1 (]: Writing runtime sql for node "model.citrus_trade.importer"
[0m14:37:33.594464 [debug] [Thread-4 (]: Writing runtime sql for node "model.citrus_trade.importer_by_year"
[0m14:37:33.598076 [debug] [Thread-2 (]: Writing runtime sql for node "model.citrus_trade.exporter"
[0m14:37:33.599739 [debug] [Thread-4 (]: Using snowflake connection "model.citrus_trade.importer_by_year"
[0m14:37:33.600300 [debug] [Thread-1 (]: Using snowflake connection "model.citrus_trade.importer"
[0m14:37:33.601445 [debug] [Thread-1 (]: On model.citrus_trade.importer: create or replace   view TRHS.ANALYTICS.importer
  
  
  
  
  as (
    select 
    declarant_iso,
    metric_type,
    CASE 
        WHEN 
            metric_type = 'value_by_quantity'
            THEN AVG(metric_value)
        ELSE
            SUM(metric_value)
    END as metric_value
from TRHS.analytics.trade_by_reporter
where flow = 1
group by 1,2
  )
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.importer"} */;
[0m14:37:33.601128 [debug] [Thread-2 (]: Using snowflake connection "model.citrus_trade.exporter"
[0m14:37:33.600607 [debug] [Thread-4 (]: On model.citrus_trade.importer_by_year: create or replace   view TRHS.ANALYTICS.importer_by_year
  
  
  
  
  as (
    select 
    declarant_iso,
    year,
    metric_type,
    CASE 
        WHEN 
            metric_type = 'value_by_quantity'
            THEN AVG(metric_value)
        ELSE
            SUM(metric_value)
    END as metric_value
from TRHS.analytics.trade_by_reporter
where flow = 1
group by 1,2,3
  )
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.importer_by_year"} */;
[0m14:37:33.603013 [debug] [Thread-2 (]: On model.citrus_trade.exporter: create or replace   view TRHS.ANALYTICS.exporter
  
  
  
  
  as (
    select 
    declarant_iso,
    metric_type,
    CASE 
        WHEN 
            metric_type = 'value_by_quantity'
            THEN AVG(metric_value)
        ELSE
            SUM(metric_value)
    END as metric_value
from TRHS.analytics.trade_by_reporter
where flow = 2
group by 1,2
  )
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.exporter"} */;
[0m14:37:33.603370 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:37:33.794863 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.193 seconds
[0m14:37:33.797376 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b4f7fe74-8f90-4c40-a752-e300cee53c16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac9949b0>]}
[0m14:37:33.798615 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.195 seconds
[0m14:37:33.799224 [info ] [Thread-1 (]: 4 of 5 OK created sql view model ANALYTICS.importer ............................ [[32mSUCCESS 1[0m in 0.24s]
[0m14:37:33.802030 [debug] [Thread-1 (]: Finished running node model.citrus_trade.importer
[0m14:37:33.801397 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b4f7fe74-8f90-4c40-a752-e300cee53c16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac997320>]}
[0m14:37:33.802889 [info ] [Thread-2 (]: 3 of 5 OK created sql view model ANALYTICS.exporter ............................ [[32mSUCCESS 1[0m in 0.25s]
[0m14:37:33.803719 [debug] [Thread-2 (]: Finished running node model.citrus_trade.exporter
[0m14:37:34.077733 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.474 seconds
[0m14:37:34.082957 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b4f7fe74-8f90-4c40-a752-e300cee53c16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac9e7e30>]}
[0m14:37:34.084319 [info ] [Thread-4 (]: 5 of 5 OK created sql view model ANALYTICS.importer_by_year .................... [[32mSUCCESS 1[0m in 0.53s]
[0m14:37:34.085426 [debug] [Thread-4 (]: Finished running node model.citrus_trade.importer_by_year
[0m14:37:34.087971 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:37:34.088560 [debug] [MainThread]: Connection 'model.citrus_trade.importer' was left open.
[0m14:37:34.089075 [debug] [MainThread]: On model.citrus_trade.importer: Close
[0m14:37:34.365527 [debug] [MainThread]: Connection 'model.citrus_trade.trade_by_reporter' was left open.
[0m14:37:34.367315 [debug] [MainThread]: On model.citrus_trade.trade_by_reporter: Close
[0m14:37:34.465522 [debug] [MainThread]: Connection 'model.citrus_trade.exporter' was left open.
[0m14:37:34.466574 [debug] [MainThread]: On model.citrus_trade.exporter: Close
[0m14:37:34.563025 [debug] [MainThread]: Connection 'model.citrus_trade.importer_by_year' was left open.
[0m14:37:34.564273 [debug] [MainThread]: On model.citrus_trade.importer_by_year: Close
[0m14:37:34.654920 [info ] [MainThread]: 
[0m14:37:34.656092 [info ] [MainThread]: Finished running 2 table models, 3 view models in 0 hours 0 minutes and 5.98 seconds (5.98s).
[0m14:37:34.658718 [debug] [MainThread]: Command end result
[0m14:37:34.703252 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m14:37:34.705261 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m14:37:34.710500 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt/target/run_results.json
[0m14:37:34.710781 [info ] [MainThread]: 
[0m14:37:34.711216 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:37:34.711636 [info ] [MainThread]: 
[0m14:37:34.712203 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=5
[0m14:37:34.713298 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.7197127, "process_in_blocks": "0", "process_kernel_time": 0.473402, "process_mem_max_rss": "172700", "process_out_blocks": "4132", "process_user_time": 1.916826}
[0m14:37:34.713704 [debug] [MainThread]: Command `dbt run` succeeded at 14:37:34.713618 after 6.72 seconds
[0m14:37:34.713984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb060a030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb13ad940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaeb1a6c0>]}
[0m14:37:34.714291 [debug] [MainThread]: Flushing usage events
[0m14:37:35.350115 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:38:05.793667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff988193a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96060bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96c27530>]}


============================== 14:38:05.796984 | cb5c9140-1579-41ef-a1a5-0bbba8e79fa3 ==============================
[0m14:38:05.796984 [info ] [MainThread]: Running with dbt=1.10.13
[0m14:38:05.797352 [debug] [MainThread]: running dbt with arguments {'empty': 'False', 'debug': 'False', 'static_parser': 'True', 'fail_fast': 'False', 'printer_width': '80', 'version_check': 'True', 'indirect_selection': 'eager', 'no_print': 'None', 'log_format': 'default', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'partial_parse': 'True', 'quiet': 'False', 'use_colors': 'True', 'target_path': 'None', 'introspect': 'True', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run', 'profiles_dir': '/app/dbt', 'log_path': '/app/dbt/logs', 'cache_selected_only': 'False', 'use_experimental_parser': 'False'}
[0m14:38:06.028801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cb5c9140-1579-41ef-a1a5-0bbba8e79fa3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff985e6960>]}
[0m14:38:06.061028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cb5c9140-1579-41ef-a1a5-0bbba8e79fa3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9489e6f0>]}
[0m14:38:06.061537 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m14:38:06.115086 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m14:38:06.195317 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m14:38:06.195682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'cb5c9140-1579-41ef-a1a5-0bbba8e79fa3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff964af140>]}
[0m14:38:06.882638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cb5c9140-1579-41ef-a1a5-0bbba8e79fa3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff941d5940>]}
[0m14:38:06.923251 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m14:38:06.924537 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m14:38:06.933250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cb5c9140-1579-41ef-a1a5-0bbba8e79fa3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94083410>]}
[0m14:38:06.933559 [info ] [MainThread]: Found 5 models, 1 source, 632 macros
[0m14:38:06.933811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cb5c9140-1579-41ef-a1a5-0bbba8e79fa3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93dbcce0>]}
[0m14:38:06.934937 [info ] [MainThread]: 
[0m14:38:06.935285 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:38:06.935643 [info ] [MainThread]: 
[0m14:38:06.936321 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:38:06.939365 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRHS'
[0m14:38:06.939883 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRHS'
[0m14:38:06.946548 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRHS'
[0m14:38:06.970149 [debug] [ThreadPool]: Using snowflake connection "list_TRHS"
[0m14:38:06.970478 [debug] [ThreadPool]: Using snowflake connection "list_TRHS"
[0m14:38:06.970705 [debug] [ThreadPool]: Using snowflake connection "list_TRHS"
[0m14:38:06.970866 [debug] [ThreadPool]: On list_TRHS: show terse schemas in database TRHS
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS"} */
[0m14:38:06.971103 [debug] [ThreadPool]: On list_TRHS: show terse schemas in database TRHS
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS"} */
[0m14:38:06.971296 [debug] [ThreadPool]: On list_TRHS: show terse schemas in database TRHS
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS"} */
[0m14:38:06.971460 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:38:06.971661 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:38:06.971843 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:38:10.095997 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 3.124 seconds
[0m14:38:10.097736 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 3.126 seconds
[0m14:38:10.105214 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 3.133 seconds
[0m14:38:10.109636 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRHS, now list_TRHS_analytics)
[0m14:38:10.116660 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRHS, now list_TRHS_staging)
[0m14:38:10.134191 [debug] [ThreadPool]: Using snowflake connection "list_TRHS_analytics"
[0m14:38:10.137358 [debug] [ThreadPool]: Using snowflake connection "list_TRHS_staging"
[0m14:38:10.137826 [debug] [ThreadPool]: On list_TRHS_analytics: show objects in TRHS.analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS_analytics"} */;
[0m14:38:10.138238 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRHS, now list_TRHS_visualisation)
[0m14:38:10.138681 [debug] [ThreadPool]: On list_TRHS_staging: show objects in TRHS.staging
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS_staging"} */;
[0m14:38:10.142448 [debug] [ThreadPool]: Using snowflake connection "list_TRHS_visualisation"
[0m14:38:10.143311 [debug] [ThreadPool]: On list_TRHS_visualisation: show objects in TRHS.visualisation
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS_visualisation"} */;
[0m14:38:10.229055 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.085 seconds
[0m14:38:10.241223 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.098 seconds
[0m14:38:10.251227 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.112 seconds
[0m14:38:10.254823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cb5c9140-1579-41ef-a1a5-0bbba8e79fa3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff940b4d40>]}
[0m14:38:10.260929 [debug] [Thread-1 (]: Began running node model.citrus_trade.stg_trade
[0m14:38:10.261708 [info ] [Thread-1 (]: 1 of 5 START sql table model staging.stg_trade ................................. [RUN]
[0m14:38:10.262501 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_TRHS_analytics, now model.citrus_trade.stg_trade)
[0m14:38:10.263050 [debug] [Thread-1 (]: Began compiling node model.citrus_trade.stg_trade
[0m14:38:10.272607 [debug] [Thread-1 (]: Writing injected SQL for node "model.citrus_trade.stg_trade"
[0m14:38:10.273930 [debug] [Thread-1 (]: Began executing node model.citrus_trade.stg_trade
[0m14:38:10.300204 [debug] [Thread-1 (]: Writing runtime sql for node "model.citrus_trade.stg_trade"
[0m14:38:10.301580 [debug] [Thread-1 (]: Using snowflake connection "model.citrus_trade.stg_trade"
[0m14:38:10.301880 [debug] [Thread-1 (]: On model.citrus_trade.stg_trade: create or replace transient table TRHS.staging.stg_trade
    
    
    
    as (select
  value:DECLARANT::int as declarant,
  value:DECLARANT_ISO::string as declarant_iso,
  value:PARTNER::string as partner,
  value:PARTNER_ISO::string as partner_iso,
  value:FLOW::int as flow,
  value:TRANSPORT_MODE::int as transport_mode,
  value:PERIOD::int as period,
  value:HS4::string as hs4,
  value:HS4_NAME::string as hs4_name,
  value:HS6::string as hs6,
  value:HS6_NAME::string as hs6_name,
  value:VALUE_IN_EUROS::float as value_in_euros,
  value:QUANTITY_IN_KG::float as quantity_in_kg
from trhs.staging.citrus_ext
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.stg_trade"} */;
[0m14:38:11.143537 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.841 seconds
[0m14:38:11.176818 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb5c9140-1579-41ef-a1a5-0bbba8e79fa3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff985e5c10>]}
[0m14:38:11.177730 [info ] [Thread-1 (]: 1 of 5 OK created sql table model staging.stg_trade ............................ [[32mSUCCESS 1[0m in 0.91s]
[0m14:38:11.178514 [debug] [Thread-1 (]: Finished running node model.citrus_trade.stg_trade
[0m14:38:11.179506 [debug] [Thread-3 (]: Began running node model.citrus_trade.trade_by_reporter
[0m14:38:11.180054 [info ] [Thread-3 (]: 2 of 5 START sql table model analytics.trade_by_reporter ....................... [RUN]
[0m14:38:11.180561 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_TRHS_visualisation, now model.citrus_trade.trade_by_reporter)
[0m14:38:11.180988 [debug] [Thread-3 (]: Began compiling node model.citrus_trade.trade_by_reporter
[0m14:38:11.184426 [debug] [Thread-3 (]: Writing injected SQL for node "model.citrus_trade.trade_by_reporter"
[0m14:38:11.185733 [debug] [Thread-3 (]: Began executing node model.citrus_trade.trade_by_reporter
[0m14:38:11.188304 [debug] [Thread-3 (]: Writing runtime sql for node "model.citrus_trade.trade_by_reporter"
[0m14:38:11.191626 [debug] [Thread-3 (]: Using snowflake connection "model.citrus_trade.trade_by_reporter"
[0m14:38:11.191993 [debug] [Thread-3 (]: On model.citrus_trade.trade_by_reporter: create or replace transient table TRHS.analytics.trade_by_reporter
    
    
    
    as (with base as (
    select 
        declarant,
        declarant_iso,
        partner,
        partner_iso,
        flow,
        transport_mode,
        year(to_date(left(period,4),'YYYY')) as year,
        period,
        hs6,
        hs6_name,
        sum(value_in_euros) as total_value,
        sum(quantity_in_kg) as total_quantity,
        sum(value_in_euros) / nullif(sum(quantity_in_kg), 0) as value_per_quantity
    from TRHS.staging.stg_trade
    group by 1,2,3,4,5,6,7,8,9,10
)
select 
    declarant,
    declarant_iso,
    partner,
    partner_iso,
    flow,
    transport_mode,
    year,
    period,
    hs6,
    hs6_name,
    metric_type,
    metric_value
from base
unpivot(
    metric_value for metric_type in (
        total_value,
        total_quantity,
        value_per_quantity
    )
)
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.trade_by_reporter"} */;
[0m14:38:12.149519 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.957 seconds
[0m14:38:12.154708 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb5c9140-1579-41ef-a1a5-0bbba8e79fa3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ab20350>]}
[0m14:38:12.156268 [info ] [Thread-3 (]: 2 of 5 OK created sql table model analytics.trade_by_reporter .................. [[32mSUCCESS 1[0m in 0.97s]
[0m14:38:12.157352 [debug] [Thread-3 (]: Finished running node model.citrus_trade.trade_by_reporter
[0m14:38:12.158947 [debug] [Thread-2 (]: Began running node model.citrus_trade.exporter
[0m14:38:12.159643 [debug] [Thread-1 (]: Began running node model.citrus_trade.importer
[0m14:38:12.160278 [info ] [Thread-2 (]: 3 of 5 START sql view model visualisation.exporter ............................. [RUN]
[0m14:38:12.160867 [debug] [Thread-4 (]: Began running node model.citrus_trade.importer_by_year
[0m14:38:12.161670 [info ] [Thread-1 (]: 4 of 5 START sql view model visualisation.importer ............................. [RUN]
[0m14:38:12.162617 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_TRHS_staging, now model.citrus_trade.exporter)
[0m14:38:12.163604 [info ] [Thread-4 (]: 5 of 5 START sql view model visualisation.importer_by_year ..................... [RUN]
[0m14:38:12.164442 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.citrus_trade.stg_trade, now model.citrus_trade.importer)
[0m14:38:12.165138 [debug] [Thread-2 (]: Began compiling node model.citrus_trade.exporter
[0m14:38:12.165829 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.citrus_trade.importer_by_year'
[0m14:38:12.166352 [debug] [Thread-1 (]: Began compiling node model.citrus_trade.importer
[0m14:38:12.171461 [debug] [Thread-2 (]: Writing injected SQL for node "model.citrus_trade.exporter"
[0m14:38:12.172251 [debug] [Thread-4 (]: Began compiling node model.citrus_trade.importer_by_year
[0m14:38:12.176494 [debug] [Thread-1 (]: Writing injected SQL for node "model.citrus_trade.importer"
[0m14:38:12.180911 [debug] [Thread-4 (]: Writing injected SQL for node "model.citrus_trade.importer_by_year"
[0m14:38:12.182339 [debug] [Thread-2 (]: Began executing node model.citrus_trade.exporter
[0m14:38:12.195457 [debug] [Thread-1 (]: Began executing node model.citrus_trade.importer
[0m14:38:12.201548 [debug] [Thread-4 (]: Began executing node model.citrus_trade.importer_by_year
[0m14:38:12.211261 [debug] [Thread-2 (]: Writing runtime sql for node "model.citrus_trade.exporter"
[0m14:38:12.214206 [debug] [Thread-1 (]: Writing runtime sql for node "model.citrus_trade.importer"
[0m14:38:12.216252 [debug] [Thread-4 (]: Writing runtime sql for node "model.citrus_trade.importer_by_year"
[0m14:38:12.217989 [debug] [Thread-2 (]: Using snowflake connection "model.citrus_trade.exporter"
[0m14:38:12.218375 [debug] [Thread-2 (]: On model.citrus_trade.exporter: create or replace   view TRHS.visualisation.exporter
  
  
  
  
  as (
    select 
    declarant_iso,
    metric_type,
    CASE 
        WHEN 
            metric_type = 'value_by_quantity'
            THEN AVG(metric_value)
        ELSE
            SUM(metric_value)
    END as metric_value
from TRHS.analytics.trade_by_reporter
where flow = 2
group by 1,2
  )
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.exporter"} */;
[0m14:38:12.218892 [debug] [Thread-1 (]: Using snowflake connection "model.citrus_trade.importer"
[0m14:38:12.220715 [debug] [Thread-1 (]: On model.citrus_trade.importer: create or replace   view TRHS.visualisation.importer
  
  
  
  
  as (
    select 
    declarant_iso,
    metric_type,
    CASE 
        WHEN 
            metric_type = 'value_by_quantity'
            THEN AVG(metric_value)
        ELSE
            SUM(metric_value)
    END as metric_value
from TRHS.analytics.trade_by_reporter
where flow = 1
group by 1,2
  )
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.importer"} */;
[0m14:38:12.220505 [debug] [Thread-4 (]: Using snowflake connection "model.citrus_trade.importer_by_year"
[0m14:38:12.221804 [debug] [Thread-4 (]: On model.citrus_trade.importer_by_year: create or replace   view TRHS.visualisation.importer_by_year
  
  
  
  
  as (
    select 
    declarant_iso,
    year,
    metric_type,
    CASE 
        WHEN 
            metric_type = 'value_by_quantity'
            THEN AVG(metric_value)
        ELSE
            SUM(metric_value)
    END as metric_value
from TRHS.analytics.trade_by_reporter
where flow = 1
group by 1,2,3
  )
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.importer_by_year"} */;
[0m14:38:12.222059 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:38:12.448000 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.229 seconds
[0m14:38:12.449822 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb5c9140-1579-41ef-a1a5-0bbba8e79fa3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94626360>]}
[0m14:38:12.450912 [info ] [Thread-2 (]: 3 of 5 OK created sql view model visualisation.exporter ........................ [[32mSUCCESS 1[0m in 0.29s]
[0m14:38:12.452033 [debug] [Thread-2 (]: Finished running node model.citrus_trade.exporter
[0m14:38:12.526311 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.305 seconds
[0m14:38:12.530633 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb5c9140-1579-41ef-a1a5-0bbba8e79fa3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff945e0e60>]}
[0m14:38:12.531923 [info ] [Thread-1 (]: 4 of 5 OK created sql view model visualisation.importer ........................ [[32mSUCCESS 1[0m in 0.37s]
[0m14:38:12.533245 [debug] [Thread-1 (]: Finished running node model.citrus_trade.importer
[0m14:38:12.630493 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.408 seconds
[0m14:38:12.635060 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb5c9140-1579-41ef-a1a5-0bbba8e79fa3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff945e3e30>]}
[0m14:38:12.636635 [info ] [Thread-4 (]: 5 of 5 OK created sql view model visualisation.importer_by_year ................ [[32mSUCCESS 1[0m in 0.47s]
[0m14:38:12.637862 [debug] [Thread-4 (]: Finished running node model.citrus_trade.importer_by_year
[0m14:38:12.640611 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:38:12.641187 [debug] [MainThread]: Connection 'model.citrus_trade.exporter' was left open.
[0m14:38:12.641743 [debug] [MainThread]: On model.citrus_trade.exporter: Close
[0m14:38:12.736936 [debug] [MainThread]: Connection 'model.citrus_trade.trade_by_reporter' was left open.
[0m14:38:12.738059 [debug] [MainThread]: On model.citrus_trade.trade_by_reporter: Close
[0m14:38:12.827361 [debug] [MainThread]: Connection 'model.citrus_trade.importer' was left open.
[0m14:38:12.828834 [debug] [MainThread]: On model.citrus_trade.importer: Close
[0m14:38:12.947043 [debug] [MainThread]: Connection 'model.citrus_trade.importer_by_year' was left open.
[0m14:38:12.947980 [debug] [MainThread]: On model.citrus_trade.importer_by_year: Close
[0m14:38:13.110962 [info ] [MainThread]: 
[0m14:38:13.111568 [info ] [MainThread]: Finished running 2 table models, 3 view models in 0 hours 0 minutes and 6.17 seconds (6.17s).
[0m14:38:13.112542 [debug] [MainThread]: Command end result
[0m14:38:13.135650 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m14:38:13.136958 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m14:38:13.140331 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt/target/run_results.json
[0m14:38:13.140527 [info ] [MainThread]: 
[0m14:38:13.140789 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:38:13.141004 [info ] [MainThread]: 
[0m14:38:13.141353 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=5
[0m14:38:13.142062 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.3777137, "process_in_blocks": "0", "process_kernel_time": 0.582166, "process_mem_max_rss": "174448", "process_out_blocks": "4133", "process_user_time": 2.432297}
[0m14:38:13.142320 [debug] [MainThread]: Command `dbt run` succeeded at 14:38:13.142273 after 7.38 seconds
[0m14:38:13.142514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff964d6480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96d23710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96862480>]}
[0m14:38:13.142707 [debug] [MainThread]: Flushing usage events
[0m14:38:14.108537 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:33:32.979014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a67fe90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a5cab40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a647140>]}


============================== 15:33:32.982457 | c121365d-44f2-4da0-aa25-279885a1d2c3 ==============================
[0m15:33:32.982457 [info ] [MainThread]: Running with dbt=1.10.13
[0m15:33:32.982872 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run', 'log_path': '/app/dbt/logs', 'profiles_dir': '/app/dbt', 'introspect': 'True', 'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True', 'printer_width': '80', 'empty': 'False', 'warn_error': 'None', 'target_path': 'None', 'use_colors': 'True', 'version_check': 'True', 'indirect_selection': 'eager', 'debug': 'False', 'static_parser': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'fail_fast': 'False', 'log_format': 'default', 'quiet': 'False', 'no_print': 'None', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True'}
[0m15:33:33.210470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c121365d-44f2-4da0-aa25-279885a1d2c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88880ec0>]}
[0m15:33:33.240902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c121365d-44f2-4da0-aa25-279885a1d2c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88d99340>]}
[0m15:33:33.241346 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m15:33:33.294388 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m15:33:33.416803 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:33:33.417241 [debug] [MainThread]: Partial parsing: updated file: citrus_trade://models/visualisation/importer_by_year.sql
[0m15:33:33.546523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c121365d-44f2-4da0-aa25-279885a1d2c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88320920>]}
[0m15:33:33.589777 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m15:33:33.591245 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m15:33:33.599955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c121365d-44f2-4da0-aa25-279885a1d2c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88460da0>]}
[0m15:33:33.600229 [info ] [MainThread]: Found 5 models, 1 source, 632 macros
[0m15:33:33.600469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c121365d-44f2-4da0-aa25-279885a1d2c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff884c8f50>]}
[0m15:33:33.601482 [info ] [MainThread]: 
[0m15:33:33.601689 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:33:33.601917 [info ] [MainThread]: 
[0m15:33:33.602270 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:33:33.604863 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRHS'
[0m15:33:33.611051 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRHS'
[0m15:33:33.612762 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRHS'
[0m15:33:33.632928 [debug] [ThreadPool]: Using snowflake connection "list_TRHS"
[0m15:33:33.633243 [debug] [ThreadPool]: Using snowflake connection "list_TRHS"
[0m15:33:33.633459 [debug] [ThreadPool]: Using snowflake connection "list_TRHS"
[0m15:33:33.633610 [debug] [ThreadPool]: On list_TRHS: show terse schemas in database TRHS
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS"} */
[0m15:33:33.633839 [debug] [ThreadPool]: On list_TRHS: show terse schemas in database TRHS
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS"} */
[0m15:33:33.634044 [debug] [ThreadPool]: On list_TRHS: show terse schemas in database TRHS
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS"} */
[0m15:33:33.634241 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:33:33.634432 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:33:33.634618 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:33:36.467139 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: show terse schemas in database TRHS
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS"} */
[0m15:33:36.468066 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m15:33:36.468692 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_schemas
[0m15:33:36.469189 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m15:33:36.509504 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: show terse schemas in database TRHS
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS"} */
[0m15:33:36.510462 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m15:33:36.511148 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_schemas
[0m15:33:36.511661 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m15:33:36.517868 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: show terse schemas in database TRHS
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS"} */
[0m15:33:36.518278 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m15:33:36.518675 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_schemas
[0m15:33:36.519042 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m15:33:36.519915 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:33:36.520390 [debug] [MainThread]: Connection 'list_TRHS' was left open.
[0m15:33:36.520882 [debug] [MainThread]: On list_TRHS: No close available on handle
[0m15:33:36.521305 [debug] [MainThread]: Connection 'list_TRHS' was left open.
[0m15:33:36.521778 [debug] [MainThread]: On list_TRHS: No close available on handle
[0m15:33:36.522172 [debug] [MainThread]: Connection 'list_TRHS' was left open.
[0m15:33:36.522783 [debug] [MainThread]: On list_TRHS: No close available on handle
[0m15:33:36.523130 [info ] [MainThread]: 
[0m15:33:36.523801 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 2.92 seconds (2.92s).
[0m15:33:36.525052 [error] [MainThread]: Encountered an error:
Runtime Error
  Database error while listing schemas in database "TRHS"
  Database Error
    250001 (08001): Failed to connect to DB: gylobbh-fi81452.snowflakecomputing.com:443. Role 'ACCOUNTADMIN' specified in the connect string is not granted to this user. Contact your local system administrator, or attempt to login with another role, e.g. PUBLIC.
[0m15:33:36.526895 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.5829213, "process_in_blocks": "0", "process_kernel_time": 0.492533, "process_mem_max_rss": "171368", "process_out_blocks": "2746", "process_user_time": 1.557171}
[0m15:33:36.527544 [debug] [MainThread]: Command `dbt run` failed at 15:33:36.527418 after 3.58 seconds
[0m15:33:36.528090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ac81850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88151550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff882ef0b0>]}
[0m15:33:36.528654 [debug] [MainThread]: Flushing usage events
[0m15:33:37.227490 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:34:17.888859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac6be900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac3dccb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac67bb00>]}


============================== 15:34:17.891996 | a4a0bc10-139f-4cf1-b20e-fd04d2892a29 ==============================
[0m15:34:17.891996 [info ] [MainThread]: Running with dbt=1.10.13
[0m15:34:17.892417 [debug] [MainThread]: running dbt with arguments {'log_path': '/app/dbt/logs', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'target_path': 'None', 'profiles_dir': '/app/dbt', 'cache_selected_only': 'False', 'log_format': 'default', 'printer_width': '80', 'quiet': 'False', 'empty': 'False', 'version_check': 'True', 'indirect_selection': 'eager', 'use_colors': 'True', 'fail_fast': 'False', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'debug': 'False', 'invocation_command': 'dbt run', 'write_json': 'True', 'introspect': 'True'}
[0m15:34:18.126231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a4a0bc10-139f-4cf1-b20e-fd04d2892a29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa048740>]}
[0m15:34:18.156790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a4a0bc10-139f-4cf1-b20e-fd04d2892a29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa988ef0>]}
[0m15:34:18.157239 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m15:34:18.207303 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m15:34:18.329869 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:34:18.330133 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:34:18.346900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a4a0bc10-139f-4cf1-b20e-fd04d2892a29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad7c3830>]}
[0m15:34:18.394311 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m15:34:18.395873 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m15:34:18.404444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a4a0bc10-139f-4cf1-b20e-fd04d2892a29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa99b0680>]}
[0m15:34:18.404725 [info ] [MainThread]: Found 5 models, 1 source, 632 macros
[0m15:34:18.405014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a4a0bc10-139f-4cf1-b20e-fd04d2892a29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa99a96d0>]}
[0m15:34:18.406241 [info ] [MainThread]: 
[0m15:34:18.406562 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:34:18.406910 [info ] [MainThread]: 
[0m15:34:18.407363 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:34:18.409904 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRHS'
[0m15:34:18.418039 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRHS'
[0m15:34:18.422319 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRHS'
[0m15:34:18.441424 [debug] [ThreadPool]: Using snowflake connection "list_TRHS"
[0m15:34:18.441763 [debug] [ThreadPool]: Using snowflake connection "list_TRHS"
[0m15:34:18.441921 [debug] [ThreadPool]: On list_TRHS: show terse schemas in database TRHS
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS"} */
[0m15:34:18.442116 [debug] [ThreadPool]: Using snowflake connection "list_TRHS"
[0m15:34:18.442319 [debug] [ThreadPool]: On list_TRHS: show terse schemas in database TRHS
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS"} */
[0m15:34:18.442514 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:34:18.442708 [debug] [ThreadPool]: On list_TRHS: show terse schemas in database TRHS
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS"} */
[0m15:34:18.442884 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:34:18.445344 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:34:21.360961 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.918 seconds
[0m15:34:21.397807 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.955 seconds
[0m15:34:21.474839 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 3.029 seconds
[0m15:34:21.481869 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRHS, now list_TRHS_visualisation)
[0m15:34:21.482831 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRHS, now list_TRHS_analytics)
[0m15:34:21.489265 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRHS, now list_TRHS_staging)
[0m15:34:21.501172 [debug] [ThreadPool]: Using snowflake connection "list_TRHS_visualisation"
[0m15:34:21.505204 [debug] [ThreadPool]: Using snowflake connection "list_TRHS_analytics"
[0m15:34:21.507827 [debug] [ThreadPool]: Using snowflake connection "list_TRHS_staging"
[0m15:34:21.508295 [debug] [ThreadPool]: On list_TRHS_visualisation: show objects in TRHS.visualisation
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS_visualisation"} */;
[0m15:34:21.508721 [debug] [ThreadPool]: On list_TRHS_analytics: show objects in TRHS.analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS_analytics"} */;
[0m15:34:21.509130 [debug] [ThreadPool]: On list_TRHS_staging: show objects in TRHS.staging
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS_staging"} */;
[0m15:34:21.600975 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.091 seconds
[0m15:34:21.606317 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.094 seconds
[0m15:34:21.607382 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.096 seconds
[0m15:34:21.613499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a4a0bc10-139f-4cf1-b20e-fd04d2892a29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa09a6f0>]}
[0m15:34:21.620758 [debug] [Thread-1 (]: Began running node model.citrus_trade.stg_trade
[0m15:34:21.621419 [info ] [Thread-1 (]: 1 of 5 START sql table model staging.stg_trade ................................. [RUN]
[0m15:34:21.622028 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_TRHS_analytics, now model.citrus_trade.stg_trade)
[0m15:34:21.622501 [debug] [Thread-1 (]: Began compiling node model.citrus_trade.stg_trade
[0m15:34:21.631533 [debug] [Thread-1 (]: Writing injected SQL for node "model.citrus_trade.stg_trade"
[0m15:34:21.633424 [debug] [Thread-1 (]: Began executing node model.citrus_trade.stg_trade
[0m15:34:21.659070 [debug] [Thread-1 (]: Writing runtime sql for node "model.citrus_trade.stg_trade"
[0m15:34:21.660576 [debug] [Thread-1 (]: Using snowflake connection "model.citrus_trade.stg_trade"
[0m15:34:21.660912 [debug] [Thread-1 (]: On model.citrus_trade.stg_trade: create or replace transient table TRHS.staging.stg_trade
    
    
    
    as (select
  value:DECLARANT::int as declarant,
  value:DECLARANT_ISO::string as declarant_iso,
  value:PARTNER::string as partner,
  value:PARTNER_ISO::string as partner_iso,
  value:FLOW::int as flow,
  value:TRANSPORT_MODE::int as transport_mode,
  value:PERIOD::int as period,
  value:HS4::string as hs4,
  value:HS4_NAME::string as hs4_name,
  value:HS6::string as hs6,
  value:HS6_NAME::string as hs6_name,
  value:VALUE_IN_EUROS::float as value_in_euros,
  value:QUANTITY_IN_KG::float as quantity_in_kg
from trhs.staging.citrus_ext
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.stg_trade"} */;
[0m15:34:22.648030 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.987 seconds
[0m15:34:22.677203 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4a0bc10-139f-4cf1-b20e-fd04d2892a29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffadd513d0>]}
[0m15:34:22.677943 [info ] [Thread-1 (]: 1 of 5 OK created sql table model staging.stg_trade ............................ [[32mSUCCESS 1[0m in 1.05s]
[0m15:34:22.678774 [debug] [Thread-1 (]: Finished running node model.citrus_trade.stg_trade
[0m15:34:22.679730 [debug] [Thread-3 (]: Began running node model.citrus_trade.trade_by_reporter
[0m15:34:22.680272 [info ] [Thread-3 (]: 2 of 5 START sql table model analytics.trade_by_reporter ....................... [RUN]
[0m15:34:22.680829 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_TRHS_visualisation, now model.citrus_trade.trade_by_reporter)
[0m15:34:22.681260 [debug] [Thread-3 (]: Began compiling node model.citrus_trade.trade_by_reporter
[0m15:34:22.687133 [debug] [Thread-3 (]: Writing injected SQL for node "model.citrus_trade.trade_by_reporter"
[0m15:34:22.689801 [debug] [Thread-3 (]: Began executing node model.citrus_trade.trade_by_reporter
[0m15:34:22.692206 [debug] [Thread-3 (]: Writing runtime sql for node "model.citrus_trade.trade_by_reporter"
[0m15:34:22.695161 [debug] [Thread-3 (]: Using snowflake connection "model.citrus_trade.trade_by_reporter"
[0m15:34:22.695732 [debug] [Thread-3 (]: On model.citrus_trade.trade_by_reporter: create or replace transient table TRHS.analytics.trade_by_reporter
    
    
    
    as (with base as (
    select 
        declarant,
        declarant_iso,
        partner,
        partner_iso,
        flow,
        transport_mode,
        year(to_date(left(period,4),'YYYY')) as year,
        period,
        hs6,
        hs6_name,
        sum(value_in_euros) as total_value,
        sum(quantity_in_kg) as total_quantity,
        sum(value_in_euros) / nullif(sum(quantity_in_kg), 0) as value_per_quantity
    from TRHS.staging.stg_trade
    group by 1,2,3,4,5,6,7,8,9,10
)
select 
    declarant,
    declarant_iso,
    partner,
    partner_iso,
    flow,
    transport_mode,
    year,
    period,
    hs6,
    hs6_name,
    metric_type,
    metric_value
from base
unpivot(
    metric_value for metric_type in (
        total_value,
        total_quantity,
        value_per_quantity
    )
)
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.trade_by_reporter"} */;
[0m15:34:23.673144 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.977 seconds
[0m15:34:23.678534 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4a0bc10-139f-4cf1-b20e-fd04d2892a29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa21a5d30>]}
[0m15:34:23.680351 [info ] [Thread-3 (]: 2 of 5 OK created sql table model analytics.trade_by_reporter .................. [[32mSUCCESS 1[0m in 1.00s]
[0m15:34:23.681727 [debug] [Thread-3 (]: Finished running node model.citrus_trade.trade_by_reporter
[0m15:34:23.683170 [debug] [Thread-2 (]: Began running node model.citrus_trade.exporter
[0m15:34:23.683837 [debug] [Thread-1 (]: Began running node model.citrus_trade.importer
[0m15:34:23.684514 [info ] [Thread-2 (]: 3 of 5 START sql view model visualisation.exporter ............................. [RUN]
[0m15:34:23.685347 [debug] [Thread-4 (]: Began running node model.citrus_trade.importer_by_year
[0m15:34:23.686136 [info ] [Thread-1 (]: 4 of 5 START sql view model visualisation.importer ............................. [RUN]
[0m15:34:23.687158 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_TRHS_staging, now model.citrus_trade.exporter)
[0m15:34:23.688567 [info ] [Thread-4 (]: 5 of 5 START sql view model visualisation.importer_by_year ..................... [RUN]
[0m15:34:23.689485 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.citrus_trade.stg_trade, now model.citrus_trade.importer)
[0m15:34:23.690379 [debug] [Thread-2 (]: Began compiling node model.citrus_trade.exporter
[0m15:34:23.691228 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.citrus_trade.importer_by_year'
[0m15:34:23.691793 [debug] [Thread-1 (]: Began compiling node model.citrus_trade.importer
[0m15:34:23.700333 [debug] [Thread-2 (]: Writing injected SQL for node "model.citrus_trade.exporter"
[0m15:34:23.700960 [debug] [Thread-4 (]: Began compiling node model.citrus_trade.importer_by_year
[0m15:34:23.706447 [debug] [Thread-1 (]: Writing injected SQL for node "model.citrus_trade.importer"
[0m15:34:23.710337 [debug] [Thread-4 (]: Writing injected SQL for node "model.citrus_trade.importer_by_year"
[0m15:34:23.712632 [debug] [Thread-2 (]: Began executing node model.citrus_trade.exporter
[0m15:34:23.713086 [debug] [Thread-1 (]: Began executing node model.citrus_trade.importer
[0m15:34:23.736238 [debug] [Thread-2 (]: Writing runtime sql for node "model.citrus_trade.exporter"
[0m15:34:23.738417 [debug] [Thread-1 (]: Writing runtime sql for node "model.citrus_trade.importer"
[0m15:34:23.738733 [debug] [Thread-4 (]: Began executing node model.citrus_trade.importer_by_year
[0m15:34:23.741509 [debug] [Thread-4 (]: Writing runtime sql for node "model.citrus_trade.importer_by_year"
[0m15:34:23.742556 [debug] [Thread-2 (]: Using snowflake connection "model.citrus_trade.exporter"
[0m15:34:23.743190 [debug] [Thread-1 (]: Using snowflake connection "model.citrus_trade.importer"
[0m15:34:23.743458 [debug] [Thread-2 (]: On model.citrus_trade.exporter: create or replace   view TRHS.visualisation.exporter
  
  
  
  
  as (
    select 
    declarant_iso,
    metric_type,
    CASE 
        WHEN 
            metric_type = 'value_by_quantity'
            THEN AVG(metric_value)
        ELSE
            SUM(metric_value)
    END as metric_value
from TRHS.analytics.trade_by_reporter
where flow = 2
group by 1,2
  )
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.exporter"} */;
[0m15:34:23.743969 [debug] [Thread-4 (]: Using snowflake connection "model.citrus_trade.importer_by_year"
[0m15:34:23.744163 [debug] [Thread-1 (]: On model.citrus_trade.importer: create or replace   view TRHS.visualisation.importer
  
  
  
  
  as (
    select 
    declarant_iso,
    metric_type,
    CASE 
        WHEN 
            metric_type = 'value_by_quantity'
            THEN AVG(metric_value)
        ELSE
            SUM(metric_value)
    END as metric_value
from TRHS.analytics.trade_by_reporter
where flow = 1
group by 1,2
  )
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.importer"} */;
[0m15:34:23.745771 [debug] [Thread-4 (]: On model.citrus_trade.importer_by_year: create or replace   view TRHS.visualisation.importer_by_year
  
  
  
  
  as (
    select 
    declarant_iso,
    year,
    metric_type,
    CASE 
        WHEN 
            metric_type = 'value_per_quantity'
            THEN AVG(metric_value)
        ELSE
            SUM(metric_value)
    END as metric_value
from TRHS.analytics.trade_by_reporter
where flow = 1
group by 1,2,3
  )
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.importer_by_year"} */;
[0m15:34:23.747023 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:34:24.001864 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.256 seconds
[0m15:34:24.005394 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4a0bc10-139f-4cf1-b20e-fd04d2892a29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0d631d0>]}
[0m15:34:24.006856 [info ] [Thread-1 (]: 4 of 5 OK created sql view model visualisation.importer ........................ [[32mSUCCESS 1[0m in 0.32s]
[0m15:34:24.010336 [debug] [Thread-1 (]: Finished running node model.citrus_trade.importer
[0m15:34:24.034107 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.289 seconds
[0m15:34:24.037053 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4a0bc10-139f-4cf1-b20e-fd04d2892a29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0d7f350>]}
[0m15:34:24.037823 [info ] [Thread-2 (]: 3 of 5 OK created sql view model visualisation.exporter ........................ [[32mSUCCESS 1[0m in 0.35s]
[0m15:34:24.038522 [debug] [Thread-2 (]: Finished running node model.citrus_trade.exporter
[0m15:34:24.206800 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.459 seconds
[0m15:34:24.211229 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4a0bc10-139f-4cf1-b20e-fd04d2892a29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2195fd0>]}
[0m15:34:24.212090 [info ] [Thread-4 (]: 5 of 5 OK created sql view model visualisation.importer_by_year ................ [[32mSUCCESS 1[0m in 0.52s]
[0m15:34:24.212969 [debug] [Thread-4 (]: Finished running node model.citrus_trade.importer_by_year
[0m15:34:24.215388 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:34:24.215941 [debug] [MainThread]: Connection 'model.citrus_trade.importer' was left open.
[0m15:34:24.216333 [debug] [MainThread]: On model.citrus_trade.importer: Close
[0m15:34:24.358722 [debug] [MainThread]: Connection 'model.citrus_trade.exporter' was left open.
[0m15:34:24.359542 [debug] [MainThread]: On model.citrus_trade.exporter: Close
[0m15:34:24.513682 [debug] [MainThread]: Connection 'model.citrus_trade.trade_by_reporter' was left open.
[0m15:34:24.514780 [debug] [MainThread]: On model.citrus_trade.trade_by_reporter: Close
[0m15:34:24.624639 [debug] [MainThread]: Connection 'model.citrus_trade.importer_by_year' was left open.
[0m15:34:24.625474 [debug] [MainThread]: On model.citrus_trade.importer_by_year: Close
[0m15:34:24.724556 [info ] [MainThread]: 
[0m15:34:24.725585 [info ] [MainThread]: Finished running 2 table models, 3 view models in 0 hours 0 minutes and 6.32 seconds (6.32s).
[0m15:34:24.727963 [debug] [MainThread]: Command end result
[0m15:34:24.775297 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m15:34:24.777216 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m15:34:24.782920 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt/target/run_results.json
[0m15:34:24.783176 [info ] [MainThread]: 
[0m15:34:24.783444 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:34:24.783657 [info ] [MainThread]: 
[0m15:34:24.784122 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=5
[0m15:34:24.785166 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.930456, "process_in_blocks": "0", "process_kernel_time": 0.511464, "process_mem_max_rss": "163992", "process_out_blocks": "2770", "process_user_time": 1.766878}
[0m15:34:24.785579 [debug] [MainThread]: Command `dbt run` succeeded at 15:34:24.785507 after 6.93 seconds
[0m15:34:24.785861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae0b96d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffab6486e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac4251c0>]}
[0m15:34:24.786104 [debug] [MainThread]: Flushing usage events
[0m15:34:25.281926 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:32:46.746807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9bc97e60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c4aca70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c4afda0>]}


============================== 16:32:46.750156 | 258c63d3-28cf-4197-bb0b-423b07829a7f ==============================
[0m16:32:46.750156 [info ] [MainThread]: Running with dbt=1.10.13
[0m16:32:46.750508 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'fail_fast': 'False', 'target_path': 'None', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'version_check': 'True', 'profiles_dir': '/app/dbt', 'log_path': '/app/dbt/logs', 'partial_parse': 'True', 'debug': 'False', 'log_format': 'default', 'use_experimental_parser': 'False', 'printer_width': '80', 'indirect_selection': 'eager', 'quiet': 'False', 'warn_error': 'None', 'no_print': 'None', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'empty': 'False', 'write_json': 'True', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m16:32:46.982755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '258c63d3-28cf-4197-bb0b-423b07829a7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b6d3260>]}
[0m16:32:47.013174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '258c63d3-28cf-4197-bb0b-423b07829a7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a8a69f0>]}
[0m16:32:47.013678 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m16:32:47.068503 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m16:32:47.189353 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:32:47.189749 [debug] [MainThread]: Partial parsing: updated file: citrus_trade://models/visualisation/importer.sql
[0m16:32:47.319959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '258c63d3-28cf-4197-bb0b-423b07829a7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9995c560>]}
[0m16:32:47.363943 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m16:32:47.366220 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m16:32:47.380057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '258c63d3-28cf-4197-bb0b-423b07829a7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99b448c0>]}
[0m16:32:47.380350 [info ] [MainThread]: Found 5 models, 1 source, 632 macros
[0m16:32:47.380598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '258c63d3-28cf-4197-bb0b-423b07829a7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99b5d100>]}
[0m16:32:47.381561 [info ] [MainThread]: 
[0m16:32:47.381769 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:32:47.381976 [info ] [MainThread]: 
[0m16:32:47.382369 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:32:47.384795 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRHS'
[0m16:32:47.391295 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRHS'
[0m16:32:47.393856 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRHS'
[0m16:32:47.414788 [debug] [ThreadPool]: Using snowflake connection "list_TRHS"
[0m16:32:47.415121 [debug] [ThreadPool]: Using snowflake connection "list_TRHS"
[0m16:32:47.415274 [debug] [ThreadPool]: On list_TRHS: show terse schemas in database TRHS
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS"} */
[0m16:32:47.415461 [debug] [ThreadPool]: Using snowflake connection "list_TRHS"
[0m16:32:47.415676 [debug] [ThreadPool]: On list_TRHS: show terse schemas in database TRHS
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS"} */
[0m16:32:47.415867 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:32:47.416043 [debug] [ThreadPool]: On list_TRHS: show terse schemas in database TRHS
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS"} */
[0m16:32:47.416210 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:32:47.418588 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:32:48.306675 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.891 seconds
[0m16:32:48.307736 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.889 seconds
[0m16:32:48.310642 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.894 seconds
[0m16:32:48.316466 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRHS, now list_TRHS_analytics)
[0m16:32:48.323038 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRHS, now list_TRHS_visualisation)
[0m16:32:48.329538 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRHS, now list_TRHS_staging)
[0m16:32:48.334512 [debug] [ThreadPool]: Using snowflake connection "list_TRHS_analytics"
[0m16:32:48.337190 [debug] [ThreadPool]: Using snowflake connection "list_TRHS_visualisation"
[0m16:32:48.339813 [debug] [ThreadPool]: Using snowflake connection "list_TRHS_staging"
[0m16:32:48.340218 [debug] [ThreadPool]: On list_TRHS_analytics: show objects in TRHS.analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS_analytics"} */;
[0m16:32:48.340573 [debug] [ThreadPool]: On list_TRHS_visualisation: show objects in TRHS.visualisation
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS_visualisation"} */;
[0m16:32:48.341015 [debug] [ThreadPool]: On list_TRHS_staging: show objects in TRHS.staging
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS_staging"} */;
[0m16:32:48.421800 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.080 seconds
[0m16:32:48.423555 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.079 seconds
[0m16:32:48.452357 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.109 seconds
[0m16:32:48.456057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '258c63d3-28cf-4197-bb0b-423b07829a7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff903d2120>]}
[0m16:32:48.462075 [debug] [Thread-1 (]: Began running node model.citrus_trade.stg_trade
[0m16:32:48.462815 [info ] [Thread-1 (]: 1 of 5 START sql table model staging.stg_trade ................................. [RUN]
[0m16:32:48.463535 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_TRHS_visualisation, now model.citrus_trade.stg_trade)
[0m16:32:48.464091 [debug] [Thread-1 (]: Began compiling node model.citrus_trade.stg_trade
[0m16:32:48.473769 [debug] [Thread-1 (]: Writing injected SQL for node "model.citrus_trade.stg_trade"
[0m16:32:48.476021 [debug] [Thread-1 (]: Began executing node model.citrus_trade.stg_trade
[0m16:32:48.504588 [debug] [Thread-1 (]: Writing runtime sql for node "model.citrus_trade.stg_trade"
[0m16:32:48.506562 [debug] [Thread-1 (]: Using snowflake connection "model.citrus_trade.stg_trade"
[0m16:32:48.506898 [debug] [Thread-1 (]: On model.citrus_trade.stg_trade: create or replace transient table TRHS.staging.stg_trade
    
    
    
    as (select
  value:DECLARANT::int as declarant,
  value:DECLARANT_ISO::string as declarant_iso,
  value:PARTNER::string as partner,
  value:PARTNER_ISO::string as partner_iso,
  value:FLOW::int as flow,
  value:TRANSPORT_MODE::int as transport_mode,
  value:PERIOD::int as period,
  value:HS4::string as hs4,
  value:HS4_NAME::string as hs4_name,
  value:HS6::string as hs6,
  value:HS6_NAME::string as hs6_name,
  value:VALUE_IN_EUROS::float as value_in_euros,
  value:QUANTITY_IN_KG::float as quantity_in_kg
from trhs.staging.citrus_ext
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.stg_trade"} */;
[0m16:32:49.472373 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.965 seconds
[0m16:32:49.504607 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '258c63d3-28cf-4197-bb0b-423b07829a7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9de1d940>]}
[0m16:32:49.505646 [info ] [Thread-1 (]: 1 of 5 OK created sql table model staging.stg_trade ............................ [[32mSUCCESS 1[0m in 1.04s]
[0m16:32:49.506460 [debug] [Thread-1 (]: Finished running node model.citrus_trade.stg_trade
[0m16:32:49.507803 [debug] [Thread-3 (]: Began running node model.citrus_trade.trade_by_reporter
[0m16:32:49.508495 [info ] [Thread-3 (]: 2 of 5 START sql table model analytics.trade_by_reporter ....................... [RUN]
[0m16:32:49.509099 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_TRHS_analytics, now model.citrus_trade.trade_by_reporter)
[0m16:32:49.509676 [debug] [Thread-3 (]: Began compiling node model.citrus_trade.trade_by_reporter
[0m16:32:49.515027 [debug] [Thread-3 (]: Writing injected SQL for node "model.citrus_trade.trade_by_reporter"
[0m16:32:49.517524 [debug] [Thread-3 (]: Began executing node model.citrus_trade.trade_by_reporter
[0m16:32:49.522373 [debug] [Thread-3 (]: Writing runtime sql for node "model.citrus_trade.trade_by_reporter"
[0m16:32:49.524861 [debug] [Thread-3 (]: Using snowflake connection "model.citrus_trade.trade_by_reporter"
[0m16:32:49.525274 [debug] [Thread-3 (]: On model.citrus_trade.trade_by_reporter: create or replace transient table TRHS.analytics.trade_by_reporter
    
    
    
    as (with base as (
    select 
        declarant,
        declarant_iso,
        partner,
        partner_iso,
        flow,
        transport_mode,
        year(to_date(left(period,4),'YYYY')) as year,
        period,
        hs6,
        hs6_name,
        sum(value_in_euros) as total_value,
        sum(quantity_in_kg) as total_quantity,
        sum(value_in_euros) / nullif(sum(quantity_in_kg), 0) as value_per_quantity
    from TRHS.staging.stg_trade
    group by 1,2,3,4,5,6,7,8,9,10
)
select 
    declarant,
    declarant_iso,
    partner,
    partner_iso,
    flow,
    transport_mode,
    year,
    period,
    hs6,
    hs6_name,
    metric_type,
    metric_value
from base
unpivot(
    metric_value for metric_type in (
        total_value,
        total_quantity,
        value_per_quantity
    )
)
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.trade_by_reporter"} */;
[0m16:32:50.338115 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.812 seconds
[0m16:32:50.342556 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '258c63d3-28cf-4197-bb0b-423b07829a7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8754f770>]}
[0m16:32:50.343807 [info ] [Thread-3 (]: 2 of 5 OK created sql table model analytics.trade_by_reporter .................. [[32mSUCCESS 1[0m in 0.83s]
[0m16:32:50.344870 [debug] [Thread-3 (]: Finished running node model.citrus_trade.trade_by_reporter
[0m16:32:50.346222 [debug] [Thread-2 (]: Began running node model.citrus_trade.exporter
[0m16:32:50.346777 [debug] [Thread-1 (]: Began running node model.citrus_trade.importer
[0m16:32:50.347389 [info ] [Thread-2 (]: 3 of 5 START sql view model visualisation.exporter ............................. [RUN]
[0m16:32:50.348029 [debug] [Thread-4 (]: Began running node model.citrus_trade.importer_by_year
[0m16:32:50.348679 [info ] [Thread-1 (]: 4 of 5 START sql view model visualisation.importer ............................. [RUN]
[0m16:32:50.349571 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_TRHS_staging, now model.citrus_trade.exporter)
[0m16:32:50.350268 [info ] [Thread-4 (]: 5 of 5 START sql view model visualisation.importer_by_year ..................... [RUN]
[0m16:32:50.350913 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.citrus_trade.stg_trade, now model.citrus_trade.importer)
[0m16:32:50.351446 [debug] [Thread-2 (]: Began compiling node model.citrus_trade.exporter
[0m16:32:50.352058 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.citrus_trade.importer_by_year'
[0m16:32:50.352532 [debug] [Thread-1 (]: Began compiling node model.citrus_trade.importer
[0m16:32:50.356996 [debug] [Thread-2 (]: Writing injected SQL for node "model.citrus_trade.exporter"
[0m16:32:50.357562 [debug] [Thread-4 (]: Began compiling node model.citrus_trade.importer_by_year
[0m16:32:50.361730 [debug] [Thread-1 (]: Writing injected SQL for node "model.citrus_trade.importer"
[0m16:32:50.366748 [debug] [Thread-4 (]: Writing injected SQL for node "model.citrus_trade.importer_by_year"
[0m16:32:50.369532 [debug] [Thread-2 (]: Began executing node model.citrus_trade.exporter
[0m16:32:50.376074 [debug] [Thread-1 (]: Began executing node model.citrus_trade.importer
[0m16:32:50.388871 [debug] [Thread-4 (]: Began executing node model.citrus_trade.importer_by_year
[0m16:32:50.400787 [debug] [Thread-1 (]: Writing runtime sql for node "model.citrus_trade.importer"
[0m16:32:50.403027 [debug] [Thread-4 (]: Writing runtime sql for node "model.citrus_trade.importer_by_year"
[0m16:32:50.407690 [debug] [Thread-2 (]: Writing runtime sql for node "model.citrus_trade.exporter"
[0m16:32:50.409466 [debug] [Thread-1 (]: Using snowflake connection "model.citrus_trade.importer"
[0m16:32:50.409990 [debug] [Thread-4 (]: Using snowflake connection "model.citrus_trade.importer_by_year"
[0m16:32:50.410494 [debug] [Thread-2 (]: Using snowflake connection "model.citrus_trade.exporter"
[0m16:32:50.410709 [debug] [Thread-1 (]: On model.citrus_trade.importer: create or replace   view TRHS.visualisation.importer
  
  
  
  
  as (
    select 
    declarant_iso,
    metric_type,
    CASE 
        WHEN 
            lower(metric_type) = 'value_per_quantity'
            
            THEN AVG(metric_value)
        ELSE
            SUM(metric_value)
    END as metric_value
from TRHS.analytics.trade_by_reporter
where flow = 1
group by 1,2
  )
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.importer"} */;
[0m16:32:50.411023 [debug] [Thread-4 (]: On model.citrus_trade.importer_by_year: create or replace   view TRHS.visualisation.importer_by_year
  
  
  
  
  as (
    select 
    declarant_iso,
    year,
    metric_type,
    CASE 
        WHEN 
            metric_type = 'value_per_quantity'
            THEN AVG(metric_value)
        ELSE
            SUM(metric_value)
    END as metric_value
from TRHS.analytics.trade_by_reporter
where flow = 1
group by 1,2,3
  )
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.importer_by_year"} */;
[0m16:32:50.411338 [debug] [Thread-2 (]: On model.citrus_trade.exporter: create or replace   view TRHS.visualisation.exporter
  
  
  
  
  as (
    select 
    declarant_iso,
    metric_type,
    CASE 
        WHEN 
            metric_type = 'value_by_quantity'
            THEN AVG(metric_value)
        ELSE
            SUM(metric_value)
    END as metric_value
from TRHS.analytics.trade_by_reporter
where flow = 2
group by 1,2
  )
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.exporter"} */;
[0m16:32:50.412695 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:32:50.592521 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.181 seconds
[0m16:32:50.595231 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '258c63d3-28cf-4197-bb0b-423b07829a7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff875b7ce0>]}
[0m16:32:50.595970 [info ] [Thread-1 (]: 4 of 5 OK created sql view model visualisation.importer ........................ [[32mSUCCESS 1[0m in 0.24s]
[0m16:32:50.597045 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.184 seconds
[0m16:32:50.597581 [debug] [Thread-1 (]: Finished running node model.citrus_trade.importer
[0m16:32:50.599403 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '258c63d3-28cf-4197-bb0b-423b07829a7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff875b47a0>]}
[0m16:32:50.600112 [info ] [Thread-2 (]: 3 of 5 OK created sql view model visualisation.exporter ........................ [[32mSUCCESS 1[0m in 0.25s]
[0m16:32:50.600578 [debug] [Thread-2 (]: Finished running node model.citrus_trade.exporter
[0m16:32:50.912741 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.500 seconds
[0m16:32:50.918403 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '258c63d3-28cf-4197-bb0b-423b07829a7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff842dd280>]}
[0m16:32:50.919375 [info ] [Thread-4 (]: 5 of 5 OK created sql view model visualisation.importer_by_year ................ [[32mSUCCESS 1[0m in 0.57s]
[0m16:32:50.920272 [debug] [Thread-4 (]: Finished running node model.citrus_trade.importer_by_year
[0m16:32:50.922075 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:32:50.922455 [debug] [MainThread]: Connection 'model.citrus_trade.exporter' was left open.
[0m16:32:50.922994 [debug] [MainThread]: On model.citrus_trade.exporter: Close
[0m16:32:51.091533 [debug] [MainThread]: Connection 'model.citrus_trade.trade_by_reporter' was left open.
[0m16:32:51.092566 [debug] [MainThread]: On model.citrus_trade.trade_by_reporter: Close
[0m16:32:51.205224 [debug] [MainThread]: Connection 'model.citrus_trade.importer' was left open.
[0m16:32:51.206141 [debug] [MainThread]: On model.citrus_trade.importer: Close
[0m16:32:51.320210 [debug] [MainThread]: Connection 'model.citrus_trade.importer_by_year' was left open.
[0m16:32:51.321728 [debug] [MainThread]: On model.citrus_trade.importer_by_year: Close
[0m16:32:51.417627 [info ] [MainThread]: 
[0m16:32:51.418454 [info ] [MainThread]: Finished running 2 table models, 3 view models in 0 hours 0 minutes and 4.04 seconds (4.04s).
[0m16:32:51.420374 [debug] [MainThread]: Command end result
[0m16:32:51.497859 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m16:32:51.500336 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m16:32:51.507098 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt/target/run_results.json
[0m16:32:51.507523 [info ] [MainThread]: 
[0m16:32:51.508049 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:32:51.508638 [info ] [MainThread]: 
[0m16:32:51.509345 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=5
[0m16:32:51.510430 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.796377, "process_in_blocks": "0", "process_kernel_time": 0.547728, "process_mem_max_rss": "173988", "process_out_blocks": "4135", "process_user_time": 1.899463}
[0m16:32:51.511272 [debug] [MainThread]: Command `dbt run` succeeded at 16:32:51.511200 after 4.80 seconds
[0m16:32:51.511547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c4f09b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c4f13a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c379850>]}
[0m16:32:51.511975 [debug] [MainThread]: Flushing usage events
[0m16:32:52.202958 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:23:42.297163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f471940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f2ba270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f048380>]}


============================== 21:23:42.304430 | b44a835b-e91d-417f-af78-767a066d02ef ==============================
[0m21:23:42.304430 [info ] [MainThread]: Running with dbt=1.10.13
[0m21:23:42.304951 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'version_check': 'True', 'profiles_dir': '/app/dbt', 'use_experimental_parser': 'False', 'debug': 'False', 'fail_fast': 'False', 'warn_error': 'None', 'empty': 'False', 'cache_selected_only': 'False', 'invocation_command': 'dbt run', 'log_cache_events': 'False', 'introspect': 'True', 'quiet': 'False', 'write_json': 'True', 'partial_parse': 'True', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'log_path': '/app/dbt/logs', 'log_format': 'default', 'indirect_selection': 'eager', 'use_colors': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m21:23:42.607593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b44a835b-e91d-417f-af78-767a066d02ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d184b30>]}
[0m21:23:42.639800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b44a835b-e91d-417f-af78-767a066d02ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e691880>]}
[0m21:23:42.640372 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m21:23:42.694556 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m21:23:42.820687 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 4 files changed.
[0m21:23:42.821083 [debug] [MainThread]: Partial parsing: updated file: citrus_trade://models/visualisation/exporter.sql
[0m21:23:42.821322 [debug] [MainThread]: Partial parsing: updated file: citrus_trade://models/analytics/trade_by_reporter.sql
[0m21:23:42.821505 [debug] [MainThread]: Partial parsing: updated file: citrus_trade://models/visualisation/importer.sql
[0m21:23:42.821673 [debug] [MainThread]: Partial parsing: updated file: citrus_trade://models/visualisation/importer_by_year.sql
[0m21:23:42.959858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b44a835b-e91d-417f-af78-767a066d02ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d15a090>]}
[0m21:23:43.017874 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m21:23:43.019743 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m21:23:43.033304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b44a835b-e91d-417f-af78-767a066d02ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c913170>]}
[0m21:23:43.033585 [info ] [MainThread]: Found 5 models, 1 source, 632 macros
[0m21:23:43.033795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b44a835b-e91d-417f-af78-767a066d02ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7cd017c0>]}
[0m21:23:43.034953 [info ] [MainThread]: 
[0m21:23:43.035168 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:23:43.035444 [info ] [MainThread]: 
[0m21:23:43.035849 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:23:43.039028 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRHS'
[0m21:23:43.044597 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRHS'
[0m21:23:43.048603 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRHS'
[0m21:23:43.085300 [debug] [ThreadPool]: Using snowflake connection "list_TRHS"
[0m21:23:43.085648 [debug] [ThreadPool]: Using snowflake connection "list_TRHS"
[0m21:23:43.085913 [debug] [ThreadPool]: Using snowflake connection "list_TRHS"
[0m21:23:43.086070 [debug] [ThreadPool]: On list_TRHS: show terse schemas in database TRHS
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS"} */
[0m21:23:43.086287 [debug] [ThreadPool]: On list_TRHS: show terse schemas in database TRHS
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS"} */
[0m21:23:43.086465 [debug] [ThreadPool]: On list_TRHS: show terse schemas in database TRHS
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS"} */
[0m21:23:43.086633 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:23:43.086829 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:23:43.086994 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:23:46.100212 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 3.013 seconds
[0m21:23:46.101783 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 3.015 seconds
[0m21:23:46.108162 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 3.021 seconds
[0m21:23:46.112460 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRHS, now list_TRHS_staging)
[0m21:23:46.118474 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRHS, now list_TRHS_analytics)
[0m21:23:46.135150 [debug] [ThreadPool]: Using snowflake connection "list_TRHS_staging"
[0m21:23:46.138380 [debug] [ThreadPool]: Using snowflake connection "list_TRHS_analytics"
[0m21:23:46.138814 [debug] [ThreadPool]: On list_TRHS_staging: show objects in TRHS.staging
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS_staging"} */;
[0m21:23:46.139257 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRHS, now list_TRHS_visualisation)
[0m21:23:46.139671 [debug] [ThreadPool]: On list_TRHS_analytics: show objects in TRHS.analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS_analytics"} */;
[0m21:23:46.143492 [debug] [ThreadPool]: Using snowflake connection "list_TRHS_visualisation"
[0m21:23:46.144358 [debug] [ThreadPool]: On list_TRHS_visualisation: show objects in TRHS.visualisation
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS_visualisation"} */;
[0m21:23:46.226764 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.087 seconds
[0m21:23:46.233232 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.089 seconds
[0m21:23:46.242266 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.097 seconds
[0m21:23:46.245389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b44a835b-e91d-417f-af78-767a066d02ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c9670b0>]}
[0m21:23:46.250393 [debug] [Thread-1 (]: Began running node model.citrus_trade.stg_trade
[0m21:23:46.251072 [info ] [Thread-1 (]: 1 of 5 START sql table model staging.stg_trade ................................. [RUN]
[0m21:23:46.251704 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_TRHS_visualisation, now model.citrus_trade.stg_trade)
[0m21:23:46.252215 [debug] [Thread-1 (]: Began compiling node model.citrus_trade.stg_trade
[0m21:23:46.261393 [debug] [Thread-1 (]: Writing injected SQL for node "model.citrus_trade.stg_trade"
[0m21:23:46.263069 [debug] [Thread-1 (]: Began executing node model.citrus_trade.stg_trade
[0m21:23:46.288796 [debug] [Thread-1 (]: Writing runtime sql for node "model.citrus_trade.stg_trade"
[0m21:23:46.290546 [debug] [Thread-1 (]: Using snowflake connection "model.citrus_trade.stg_trade"
[0m21:23:46.290807 [debug] [Thread-1 (]: On model.citrus_trade.stg_trade: create or replace transient table TRHS.staging.stg_trade
    
    
    
    as (select
  value:DECLARANT::int as declarant,
  value:DECLARANT_ISO::string as declarant_iso,
  value:PARTNER::string as partner,
  value:PARTNER_ISO::string as partner_iso,
  value:FLOW::int as flow,
  value:TRANSPORT_MODE::int as transport_mode,
  value:PERIOD::int as period,
  value:HS4::string as hs4,
  value:HS4_NAME::string as hs4_name,
  value:HS6::string as hs6,
  value:HS6_NAME::string as hs6_name,
  value:VALUE_IN_EUROS::float as value_in_euros,
  value:QUANTITY_IN_KG::float as quantity_in_kg
from trhs.staging.citrus_ext
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.stg_trade"} */;
[0m21:23:47.263959 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.972 seconds
[0m21:23:47.298989 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b44a835b-e91d-417f-af78-767a066d02ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff810ad5e0>]}
[0m21:23:47.300040 [info ] [Thread-1 (]: 1 of 5 OK created sql table model staging.stg_trade ............................ [[32mSUCCESS 1[0m in 1.05s]
[0m21:23:47.301003 [debug] [Thread-1 (]: Finished running node model.citrus_trade.stg_trade
[0m21:23:47.302163 [debug] [Thread-3 (]: Began running node model.citrus_trade.trade_by_reporter
[0m21:23:47.302874 [info ] [Thread-3 (]: 2 of 5 START sql table model analytics.trade_by_reporter ....................... [RUN]
[0m21:23:47.303364 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_TRHS_staging, now model.citrus_trade.trade_by_reporter)
[0m21:23:47.303852 [debug] [Thread-3 (]: Began compiling node model.citrus_trade.trade_by_reporter
[0m21:23:47.307533 [debug] [Thread-3 (]: Writing injected SQL for node "model.citrus_trade.trade_by_reporter"
[0m21:23:47.310723 [debug] [Thread-3 (]: Began executing node model.citrus_trade.trade_by_reporter
[0m21:23:47.315022 [debug] [Thread-3 (]: Writing runtime sql for node "model.citrus_trade.trade_by_reporter"
[0m21:23:47.316915 [debug] [Thread-3 (]: Using snowflake connection "model.citrus_trade.trade_by_reporter"
[0m21:23:47.317302 [debug] [Thread-3 (]: On model.citrus_trade.trade_by_reporter: create or replace transient table TRHS.analytics.trade_by_reporter
    
    
    
    as (select 
    declarant,
    declarant_iso,
    partner,
    partner_iso,
    flow,
    transport_mode,
    year(to_date(left(period,4),'YYYY')) as year,
    period,
    hs6,
    hs6_name,
    sum(value_in_euros) as total_value,
    sum(quantity_in_kg) as total_quantity
from TRHS.staging.stg_trade
group by 1,2,3,4,5,6,7,8,9,10
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.trade_by_reporter"} */;
[0m21:23:48.043574 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.725 seconds
[0m21:23:48.049408 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b44a835b-e91d-417f-af78-767a066d02ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff780aa270>]}
[0m21:23:48.050679 [info ] [Thread-3 (]: 2 of 5 OK created sql table model analytics.trade_by_reporter .................. [[32mSUCCESS 1[0m in 0.75s]
[0m21:23:48.051960 [debug] [Thread-3 (]: Finished running node model.citrus_trade.trade_by_reporter
[0m21:23:48.053653 [debug] [Thread-2 (]: Began running node model.citrus_trade.exporter
[0m21:23:48.054478 [debug] [Thread-1 (]: Began running node model.citrus_trade.importer
[0m21:23:48.055070 [debug] [Thread-4 (]: Began running node model.citrus_trade.importer_by_year
[0m21:23:48.055878 [info ] [Thread-2 (]: 3 of 5 START sql view model visualisation.exporter ............................. [RUN]
[0m21:23:48.057034 [info ] [Thread-1 (]: 4 of 5 START sql view model visualisation.importer ............................. [RUN]
[0m21:23:48.058194 [info ] [Thread-4 (]: 5 of 5 START sql view model visualisation.importer_by_year ..................... [RUN]
[0m21:23:48.059074 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_TRHS_analytics, now model.citrus_trade.exporter)
[0m21:23:48.060879 [debug] [Thread-2 (]: Began compiling node model.citrus_trade.exporter
[0m21:23:48.060355 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.citrus_trade.importer_by_year'
[0m21:23:48.059682 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.citrus_trade.stg_trade, now model.citrus_trade.importer)
[0m21:23:48.064938 [debug] [Thread-2 (]: Writing injected SQL for node "model.citrus_trade.exporter"
[0m21:23:48.065555 [debug] [Thread-4 (]: Began compiling node model.citrus_trade.importer_by_year
[0m21:23:48.066106 [debug] [Thread-1 (]: Began compiling node model.citrus_trade.importer
[0m21:23:48.069977 [debug] [Thread-4 (]: Writing injected SQL for node "model.citrus_trade.importer_by_year"
[0m21:23:48.073360 [debug] [Thread-1 (]: Writing injected SQL for node "model.citrus_trade.importer"
[0m21:23:48.074863 [debug] [Thread-2 (]: Began executing node model.citrus_trade.exporter
[0m21:23:48.087347 [debug] [Thread-1 (]: Began executing node model.citrus_trade.importer
[0m21:23:48.104354 [debug] [Thread-2 (]: Writing runtime sql for node "model.citrus_trade.exporter"
[0m21:23:48.104636 [debug] [Thread-4 (]: Began executing node model.citrus_trade.importer_by_year
[0m21:23:48.104955 [debug] [Thread-1 (]: Writing runtime sql for node "model.citrus_trade.importer"
[0m21:23:48.106974 [debug] [Thread-4 (]: Writing runtime sql for node "model.citrus_trade.importer_by_year"
[0m21:23:48.108653 [debug] [Thread-2 (]: Using snowflake connection "model.citrus_trade.exporter"
[0m21:23:48.109003 [debug] [Thread-2 (]: On model.citrus_trade.exporter: create or replace   view TRHS.visualisation.exporter
  
  
  
  
  as (
    with base as (
    select
        declarant_iso,
        sum(total_value) as total_value
        sum(total_quantity) as total_quantity
        sum(total_value)/nullif(sum(total_quantity),0) as value_per_quantity
    from TRHS.analytics.trade_by_reporter
    where flow = 2
    group_by 1 
)

    select 
        declarant,
        metric_type,
        metric_value
    from base
    unpivot(
        metric_value for metric_type in (
            total_value,
            total_quantity,
            value_per_quantity
        )
    )
  )
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.exporter"} */;
[0m21:23:48.109667 [debug] [Thread-1 (]: Using snowflake connection "model.citrus_trade.importer"
[0m21:23:48.110783 [debug] [Thread-4 (]: Using snowflake connection "model.citrus_trade.importer_by_year"
[0m21:23:48.112010 [debug] [Thread-4 (]: On model.citrus_trade.importer_by_year: create or replace   view TRHS.visualisation.importer_by_year
  
  
  
  
  as (
    with base as (
    select
        declarant_iso,
        year,
        sum(total_value) as total_value
        sum(total_quantity) as total_quantity
        sum(total_value)/nullif(sum(total_quantity),0) as value_per_quantity
    from TRHS.analytics.trade_by_reporter
    where flow = 1
    group_by 112
)

    select 
        declarant,
        year,
        metric_type,
        metric_value
    from base
    unpivot(
        metric_value for metric_type in (
            total_value,
            total_quantity,
            value_per_quantity
        )
    )
  )
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.importer_by_year"} */;
[0m21:23:48.112286 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m21:23:48.111035 [debug] [Thread-1 (]: On model.citrus_trade.importer: create or replace   view TRHS.visualisation.importer
  
  
  
  
  as (
    with base as (
    select
        declarant_iso,
        sum(total_value) as total_value
        sum(total_quantity) as total_quantity
        sum(total_value)/nullif(sum(total_quantity),0) as value_per_quantity
    from TRHS.analytics.trade_by_reporter
    where flow = 1
    group_by 1 
)

    select 
        declarant,
        metric_type,
        metric_value
    from base
    unpivot(
        metric_value for metric_type in (
            total_value,
            total_quantity,
            value_per_quantity
        )
    )
  )
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.importer"} */;
[0m21:23:48.221332 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01c02c83-0105-6cf2-0000-000420cacab5
[0m21:23:48.222139 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 11 at position 8 unexpected 'sum'.
syntax error line 11 at position 12 unexpected 'total_quantity'.
syntax error line 11 at position 28 unexpected 'as'.
[0m21:23:48.222543 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01c02c83-0105-6cf2-0000-000420cacab1
[0m21:23:48.225522 [debug] [Thread-1 (]: Database Error in model importer (models/visualisation/importer.sql)
  001003 (42000): SQL compilation error:
  syntax error line 11 at position 8 unexpected 'sum'.
  syntax error line 11 at position 12 unexpected 'total_quantity'.
  syntax error line 11 at position 28 unexpected 'as'.
  compiled code at target/run/citrus_trade/models/visualisation/importer.sql
[0m21:23:48.225799 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 11 at position 8 unexpected 'sum'.
syntax error line 11 at position 12 unexpected 'total_quantity'.
syntax error line 11 at position 28 unexpected 'as'.
[0m21:23:48.226160 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b44a835b-e91d-417f-af78-767a066d02ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff709d3770>]}
[0m21:23:48.228401 [debug] [Thread-2 (]: Database Error in model exporter (models/visualisation/exporter.sql)
  001003 (42000): SQL compilation error:
  syntax error line 11 at position 8 unexpected 'sum'.
  syntax error line 11 at position 12 unexpected 'total_quantity'.
  syntax error line 11 at position 28 unexpected 'as'.
  compiled code at target/run/citrus_trade/models/visualisation/exporter.sql
[0m21:23:48.228809 [error] [Thread-1 (]: 4 of 5 ERROR creating sql view model visualisation.importer .................... [[31mERROR[0m in 0.17s]
[0m21:23:48.229219 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b44a835b-e91d-417f-af78-767a066d02ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff78087aa0>]}
[0m21:23:48.229613 [debug] [Thread-1 (]: Finished running node model.citrus_trade.importer
[0m21:23:48.229999 [error] [Thread-2 (]: 3 of 5 ERROR creating sql view model visualisation.exporter .................... [[31mERROR[0m in 0.17s]
[0m21:23:48.230455 [debug] [Thread-7 (]: Marking all children of 'model.citrus_trade.importer' to be skipped because of status 'error'.  Reason: Database Error in model importer (models/visualisation/importer.sql)
  001003 (42000): SQL compilation error:
  syntax error line 11 at position 8 unexpected 'sum'.
  syntax error line 11 at position 12 unexpected 'total_quantity'.
  syntax error line 11 at position 28 unexpected 'as'.
  compiled code at target/run/citrus_trade/models/visualisation/importer.sql.
[0m21:23:48.230846 [debug] [Thread-2 (]: Finished running node model.citrus_trade.exporter
[0m21:23:48.231735 [debug] [Thread-7 (]: Marking all children of 'model.citrus_trade.exporter' to be skipped because of status 'error'.  Reason: Database Error in model exporter (models/visualisation/exporter.sql)
  001003 (42000): SQL compilation error:
  syntax error line 11 at position 8 unexpected 'sum'.
  syntax error line 11 at position 12 unexpected 'total_quantity'.
  syntax error line 11 at position 28 unexpected 'as'.
  compiled code at target/run/citrus_trade/models/visualisation/exporter.sql.
[0m21:23:48.459841 [debug] [Thread-4 (]: Snowflake adapter: Snowflake query id: 01c02c83-0105-6cf2-0000-000420cacab9
[0m21:23:48.461329 [debug] [Thread-4 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 12 at position 8 unexpected 'sum'.
syntax error line 12 at position 12 unexpected 'total_quantity'.
syntax error line 12 at position 28 unexpected 'as'.
[0m21:23:48.467515 [debug] [Thread-4 (]: Database Error in model importer_by_year (models/visualisation/importer_by_year.sql)
  001003 (42000): SQL compilation error:
  syntax error line 12 at position 8 unexpected 'sum'.
  syntax error line 12 at position 12 unexpected 'total_quantity'.
  syntax error line 12 at position 28 unexpected 'as'.
  compiled code at target/run/citrus_trade/models/visualisation/importer_by_year.sql
[0m21:23:48.468595 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b44a835b-e91d-417f-af78-767a066d02ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff709ba690>]}
[0m21:23:48.469692 [error] [Thread-4 (]: 5 of 5 ERROR creating sql view model visualisation.importer_by_year ............ [[31mERROR[0m in 0.41s]
[0m21:23:48.470996 [debug] [Thread-4 (]: Finished running node model.citrus_trade.importer_by_year
[0m21:23:48.471842 [debug] [Thread-7 (]: Marking all children of 'model.citrus_trade.importer_by_year' to be skipped because of status 'error'.  Reason: Database Error in model importer_by_year (models/visualisation/importer_by_year.sql)
  001003 (42000): SQL compilation error:
  syntax error line 12 at position 8 unexpected 'sum'.
  syntax error line 12 at position 12 unexpected 'total_quantity'.
  syntax error line 12 at position 28 unexpected 'as'.
  compiled code at target/run/citrus_trade/models/visualisation/importer_by_year.sql.
[0m21:23:48.474581 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:23:48.475182 [debug] [MainThread]: Connection 'model.citrus_trade.exporter' was left open.
[0m21:23:48.475711 [debug] [MainThread]: On model.citrus_trade.exporter: Close
[0m21:23:48.568995 [debug] [MainThread]: Connection 'model.citrus_trade.trade_by_reporter' was left open.
[0m21:23:48.570653 [debug] [MainThread]: On model.citrus_trade.trade_by_reporter: Close
[0m21:23:48.673002 [debug] [MainThread]: Connection 'model.citrus_trade.importer' was left open.
[0m21:23:48.673743 [debug] [MainThread]: On model.citrus_trade.importer: Close
[0m21:23:48.757572 [debug] [MainThread]: Connection 'model.citrus_trade.importer_by_year' was left open.
[0m21:23:48.758684 [debug] [MainThread]: On model.citrus_trade.importer_by_year: Close
[0m21:23:48.877650 [info ] [MainThread]: 
[0m21:23:48.879071 [info ] [MainThread]: Finished running 2 table models, 3 view models in 0 hours 0 minutes and 5.84 seconds (5.84s).
[0m21:23:48.882201 [debug] [MainThread]: Command end result
[0m21:23:48.944168 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m21:23:48.945875 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m21:23:48.950379 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt/target/run_results.json
[0m21:23:48.950578 [info ] [MainThread]: 
[0m21:23:48.950841 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m21:23:48.951152 [info ] [MainThread]: 
[0m21:23:48.951419 [error] [MainThread]: [31mFailure in model importer (models/visualisation/importer.sql)[0m
[0m21:23:48.951708 [error] [MainThread]:   Database Error in model importer (models/visualisation/importer.sql)
  001003 (42000): SQL compilation error:
  syntax error line 11 at position 8 unexpected 'sum'.
  syntax error line 11 at position 12 unexpected 'total_quantity'.
  syntax error line 11 at position 28 unexpected 'as'.
  compiled code at target/run/citrus_trade/models/visualisation/importer.sql
[0m21:23:48.951931 [info ] [MainThread]: 
[0m21:23:48.952314 [info ] [MainThread]:   compiled code at target/compiled/citrus_trade/models/visualisation/importer.sql
[0m21:23:48.952508 [info ] [MainThread]: 
[0m21:23:48.952833 [error] [MainThread]: [31mFailure in model exporter (models/visualisation/exporter.sql)[0m
[0m21:23:48.953164 [error] [MainThread]:   Database Error in model exporter (models/visualisation/exporter.sql)
  001003 (42000): SQL compilation error:
  syntax error line 11 at position 8 unexpected 'sum'.
  syntax error line 11 at position 12 unexpected 'total_quantity'.
  syntax error line 11 at position 28 unexpected 'as'.
  compiled code at target/run/citrus_trade/models/visualisation/exporter.sql
[0m21:23:48.953402 [info ] [MainThread]: 
[0m21:23:48.953660 [info ] [MainThread]:   compiled code at target/compiled/citrus_trade/models/visualisation/exporter.sql
[0m21:23:48.953913 [info ] [MainThread]: 
[0m21:23:48.954291 [error] [MainThread]: [31mFailure in model importer_by_year (models/visualisation/importer_by_year.sql)[0m
[0m21:23:48.954618 [error] [MainThread]:   Database Error in model importer_by_year (models/visualisation/importer_by_year.sql)
  001003 (42000): SQL compilation error:
  syntax error line 12 at position 8 unexpected 'sum'.
  syntax error line 12 at position 12 unexpected 'total_quantity'.
  syntax error line 12 at position 28 unexpected 'as'.
  compiled code at target/run/citrus_trade/models/visualisation/importer_by_year.sql
[0m21:23:48.954906 [info ] [MainThread]: 
[0m21:23:48.955525 [info ] [MainThread]:   compiled code at target/compiled/citrus_trade/models/visualisation/importer_by_year.sql
[0m21:23:48.955872 [info ] [MainThread]: 
[0m21:23:48.956166 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=3 SKIP=0 NO-OP=0 TOTAL=5
[0m21:23:48.956955 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 6.692394, "process_in_blocks": "0", "process_kernel_time": 1.049627, "process_mem_max_rss": "172580", "process_out_blocks": "4151", "process_user_time": 2.005683}
[0m21:23:48.957239 [debug] [MainThread]: Command `dbt run` failed at 21:23:48.957179 after 6.69 seconds
[0m21:23:48.957471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80b41340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7efa7560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7cdc79e0>]}
[0m21:23:48.957674 [debug] [MainThread]: Flushing usage events
[0m21:23:49.590730 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:24:50.048800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e3e0c80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d9d4680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e3e00e0>]}


============================== 21:24:50.052013 | f98ca873-1273-4654-a606-0e64cc8705cc ==============================
[0m21:24:50.052013 [info ] [MainThread]: Running with dbt=1.10.13
[0m21:24:50.052379 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'invocation_command': 'dbt run', 'log_format': 'default', 'log_cache_events': 'False', 'fail_fast': 'False', 'write_json': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': '/app/dbt', 'version_check': 'True', 'log_path': '/app/dbt/logs', 'indirect_selection': 'eager', 'warn_error': 'None', 'partial_parse': 'True', 'empty': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'target_path': 'None', 'introspect': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'printer_width': '80', 'cache_selected_only': 'False'}
[0m21:24:50.261389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f98ca873-1273-4654-a606-0e64cc8705cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8bdbfef0>]}
[0m21:24:50.292227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f98ca873-1273-4654-a606-0e64cc8705cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c5bbec0>]}
[0m21:24:50.292713 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m21:24:50.340389 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m21:24:50.453704 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m21:24:50.454127 [debug] [MainThread]: Partial parsing: updated file: citrus_trade://models/visualisation/exporter.sql
[0m21:24:50.454380 [debug] [MainThread]: Partial parsing: updated file: citrus_trade://models/visualisation/importer.sql
[0m21:24:50.454577 [debug] [MainThread]: Partial parsing: updated file: citrus_trade://models/visualisation/importer_by_year.sql
[0m21:24:50.583503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f98ca873-1273-4654-a606-0e64cc8705cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ba5ee40>]}
[0m21:24:50.638623 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m21:24:50.639961 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m21:24:50.648303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f98ca873-1273-4654-a606-0e64cc8705cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b89d520>]}
[0m21:24:50.648559 [info ] [MainThread]: Found 5 models, 1 source, 632 macros
[0m21:24:50.648781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f98ca873-1273-4654-a606-0e64cc8705cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b9ef110>]}
[0m21:24:50.650000 [info ] [MainThread]: 
[0m21:24:50.650240 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:24:50.650652 [info ] [MainThread]: 
[0m21:24:50.651187 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:24:50.653902 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRHS'
[0m21:24:50.659819 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRHS'
[0m21:24:50.665220 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRHS'
[0m21:24:50.684614 [debug] [ThreadPool]: Using snowflake connection "list_TRHS"
[0m21:24:50.684945 [debug] [ThreadPool]: Using snowflake connection "list_TRHS"
[0m21:24:50.685174 [debug] [ThreadPool]: Using snowflake connection "list_TRHS"
[0m21:24:50.685304 [debug] [ThreadPool]: On list_TRHS: show terse schemas in database TRHS
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS"} */
[0m21:24:50.685530 [debug] [ThreadPool]: On list_TRHS: show terse schemas in database TRHS
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS"} */
[0m21:24:50.685762 [debug] [ThreadPool]: On list_TRHS: show terse schemas in database TRHS
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS"} */
[0m21:24:50.685964 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:24:50.686138 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:24:50.686307 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:24:53.539372 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.853 seconds
[0m21:24:53.540883 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.855 seconds
[0m21:24:53.552119 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.866 seconds
[0m21:24:53.553840 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRHS, now list_TRHS_visualisation)
[0m21:24:53.554178 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRHS, now list_TRHS_staging)
[0m21:24:53.561750 [debug] [ThreadPool]: Using snowflake connection "list_TRHS_visualisation"
[0m21:24:53.563646 [debug] [ThreadPool]: Using snowflake connection "list_TRHS_staging"
[0m21:24:53.563976 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRHS, now list_TRHS_analytics)
[0m21:24:53.564238 [debug] [ThreadPool]: On list_TRHS_visualisation: show objects in TRHS.visualisation
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS_visualisation"} */;
[0m21:24:53.564442 [debug] [ThreadPool]: On list_TRHS_staging: show objects in TRHS.staging
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS_staging"} */;
[0m21:24:53.565701 [debug] [ThreadPool]: Using snowflake connection "list_TRHS_analytics"
[0m21:24:53.567469 [debug] [ThreadPool]: On list_TRHS_analytics: show objects in TRHS.analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS_analytics"} */;
[0m21:24:53.651276 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.085 seconds
[0m21:24:53.662226 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.095 seconds
[0m21:24:53.662955 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.095 seconds
[0m21:24:53.667490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f98ca873-1273-4654-a606-0e64cc8705cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b53bcb0>]}
[0m21:24:53.671717 [debug] [Thread-1 (]: Began running node model.citrus_trade.stg_trade
[0m21:24:53.672198 [info ] [Thread-1 (]: 1 of 5 START sql table model staging.stg_trade ................................. [RUN]
[0m21:24:53.672694 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_TRHS_analytics, now model.citrus_trade.stg_trade)
[0m21:24:53.673079 [debug] [Thread-1 (]: Began compiling node model.citrus_trade.stg_trade
[0m21:24:53.679985 [debug] [Thread-1 (]: Writing injected SQL for node "model.citrus_trade.stg_trade"
[0m21:24:53.681263 [debug] [Thread-1 (]: Began executing node model.citrus_trade.stg_trade
[0m21:24:53.703297 [debug] [Thread-1 (]: Writing runtime sql for node "model.citrus_trade.stg_trade"
[0m21:24:53.704854 [debug] [Thread-1 (]: Using snowflake connection "model.citrus_trade.stg_trade"
[0m21:24:53.705116 [debug] [Thread-1 (]: On model.citrus_trade.stg_trade: create or replace transient table TRHS.staging.stg_trade
    
    
    
    as (select
  value:DECLARANT::int as declarant,
  value:DECLARANT_ISO::string as declarant_iso,
  value:PARTNER::string as partner,
  value:PARTNER_ISO::string as partner_iso,
  value:FLOW::int as flow,
  value:TRANSPORT_MODE::int as transport_mode,
  value:PERIOD::int as period,
  value:HS4::string as hs4,
  value:HS4_NAME::string as hs4_name,
  value:HS6::string as hs6,
  value:HS6_NAME::string as hs6_name,
  value:VALUE_IN_EUROS::float as value_in_euros,
  value:QUANTITY_IN_KG::float as quantity_in_kg
from trhs.staging.citrus_ext
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.stg_trade"} */;
[0m21:24:54.450262 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.744 seconds
[0m21:24:54.483394 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f98ca873-1273-4654-a606-0e64cc8705cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8fde57c0>]}
[0m21:24:54.484331 [info ] [Thread-1 (]: 1 of 5 OK created sql table model staging.stg_trade ............................ [[32mSUCCESS 1[0m in 0.81s]
[0m21:24:54.485130 [debug] [Thread-1 (]: Finished running node model.citrus_trade.stg_trade
[0m21:24:54.486219 [debug] [Thread-3 (]: Began running node model.citrus_trade.trade_by_reporter
[0m21:24:54.486774 [info ] [Thread-3 (]: 2 of 5 START sql table model analytics.trade_by_reporter ....................... [RUN]
[0m21:24:54.487286 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_TRHS_visualisation, now model.citrus_trade.trade_by_reporter)
[0m21:24:54.487725 [debug] [Thread-3 (]: Began compiling node model.citrus_trade.trade_by_reporter
[0m21:24:54.493391 [debug] [Thread-3 (]: Writing injected SQL for node "model.citrus_trade.trade_by_reporter"
[0m21:24:54.495325 [debug] [Thread-3 (]: Began executing node model.citrus_trade.trade_by_reporter
[0m21:24:54.497748 [debug] [Thread-3 (]: Writing runtime sql for node "model.citrus_trade.trade_by_reporter"
[0m21:24:54.498989 [debug] [Thread-3 (]: Using snowflake connection "model.citrus_trade.trade_by_reporter"
[0m21:24:54.499288 [debug] [Thread-3 (]: On model.citrus_trade.trade_by_reporter: create or replace transient table TRHS.analytics.trade_by_reporter
    
    
    
    as (select 
    declarant,
    declarant_iso,
    partner,
    partner_iso,
    flow,
    transport_mode,
    year(to_date(left(period,4),'YYYY')) as year,
    period,
    hs6,
    hs6_name,
    sum(value_in_euros) as total_value,
    sum(quantity_in_kg) as total_quantity
from TRHS.staging.stg_trade
group by 1,2,3,4,5,6,7,8,9,10
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.trade_by_reporter"} */;
[0m21:24:55.217901 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.718 seconds
[0m21:24:55.223606 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f98ca873-1273-4654-a606-0e64cc8705cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff807e1820>]}
[0m21:24:55.225002 [info ] [Thread-3 (]: 2 of 5 OK created sql table model analytics.trade_by_reporter .................. [[32mSUCCESS 1[0m in 0.74s]
[0m21:24:55.226098 [debug] [Thread-3 (]: Finished running node model.citrus_trade.trade_by_reporter
[0m21:24:55.227731 [debug] [Thread-2 (]: Began running node model.citrus_trade.exporter
[0m21:24:55.228329 [debug] [Thread-1 (]: Began running node model.citrus_trade.importer
[0m21:24:55.228853 [debug] [Thread-4 (]: Began running node model.citrus_trade.importer_by_year
[0m21:24:55.229513 [info ] [Thread-2 (]: 3 of 5 START sql view model visualisation.exporter ............................. [RUN]
[0m21:24:55.230490 [info ] [Thread-1 (]: 4 of 5 START sql view model visualisation.importer ............................. [RUN]
[0m21:24:55.231553 [info ] [Thread-4 (]: 5 of 5 START sql view model visualisation.importer_by_year ..................... [RUN]
[0m21:24:55.232547 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_TRHS_staging, now model.citrus_trade.exporter)
[0m21:24:55.233246 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.citrus_trade.stg_trade, now model.citrus_trade.importer)
[0m21:24:55.233915 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.citrus_trade.importer_by_year'
[0m21:24:55.234410 [debug] [Thread-2 (]: Began compiling node model.citrus_trade.exporter
[0m21:24:55.234892 [debug] [Thread-1 (]: Began compiling node model.citrus_trade.importer
[0m21:24:55.235362 [debug] [Thread-4 (]: Began compiling node model.citrus_trade.importer_by_year
[0m21:24:55.239506 [debug] [Thread-2 (]: Writing injected SQL for node "model.citrus_trade.exporter"
[0m21:24:55.246132 [debug] [Thread-1 (]: Writing injected SQL for node "model.citrus_trade.importer"
[0m21:24:55.249102 [debug] [Thread-4 (]: Writing injected SQL for node "model.citrus_trade.importer_by_year"
[0m21:24:55.251876 [debug] [Thread-2 (]: Began executing node model.citrus_trade.exporter
[0m21:24:55.259098 [debug] [Thread-1 (]: Began executing node model.citrus_trade.importer
[0m21:24:55.265915 [debug] [Thread-4 (]: Began executing node model.citrus_trade.importer_by_year
[0m21:24:55.277096 [debug] [Thread-1 (]: Writing runtime sql for node "model.citrus_trade.importer"
[0m21:24:55.277919 [debug] [Thread-2 (]: Writing runtime sql for node "model.citrus_trade.exporter"
[0m21:24:55.279908 [debug] [Thread-4 (]: Writing runtime sql for node "model.citrus_trade.importer_by_year"
[0m21:24:55.281598 [debug] [Thread-1 (]: Using snowflake connection "model.citrus_trade.importer"
[0m21:24:55.282001 [debug] [Thread-1 (]: On model.citrus_trade.importer: create or replace   view TRHS.visualisation.importer
  
  
  
  
  as (
    with base as (
    select
        declarant_iso,
        sum(total_value) as total_value,
        sum(total_quantity) as total_quantity,
        sum(total_value)/nullif(sum(total_quantity),0) as value_per_quantity
    from TRHS.analytics.trade_by_reporter
    where flow = 1
    group_by 1 
)

    select 
        declarant,
        metric_type,
        metric_value
    from base
    unpivot(
        metric_value for metric_type in (
            total_value,
            total_quantity,
            value_per_quantity
        )
    )
  )
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.importer"} */;
[0m21:24:55.282750 [debug] [Thread-2 (]: Using snowflake connection "model.citrus_trade.exporter"
[0m21:24:55.283409 [debug] [Thread-4 (]: Using snowflake connection "model.citrus_trade.importer_by_year"
[0m21:24:55.284770 [debug] [Thread-2 (]: On model.citrus_trade.exporter: create or replace   view TRHS.visualisation.exporter
  
  
  
  
  as (
    with base as (
    select
        declarant_iso,
        sum(total_value) as total_value,
        sum(total_quantity) as total_quantity,
        sum(total_value)/nullif(sum(total_quantity),0) as value_per_quantity
    from TRHS.analytics.trade_by_reporter
    where flow = 2
    group_by 1 
)

    select 
        declarant,
        metric_type,
        metric_value
    from base
    unpivot(
        metric_value for metric_type in (
            total_value,
            total_quantity,
            value_per_quantity
        )
    )
  )
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.exporter"} */;
[0m21:24:55.285111 [debug] [Thread-4 (]: On model.citrus_trade.importer_by_year: create or replace   view TRHS.visualisation.importer_by_year
  
  
  
  
  as (
    with base as (
    select
        declarant_iso,
        year,
        sum(total_value) as total_value,
        sum(total_quantity) as total_quantity,
        sum(total_value)/nullif(sum(total_quantity),0) as value_per_quantity
    from TRHS.analytics.trade_by_reporter
    where flow = 1
    group_by 112
)

    select 
        declarant,
        year,
        metric_type,
        metric_value
    from base
    unpivot(
        metric_value for metric_type in (
            total_value,
            total_quantity,
            value_per_quantity
        )
    )
  )
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.importer_by_year"} */;
[0m21:24:55.286442 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m21:24:55.352714 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01c02c84-0105-6cf2-0000-000420cacae1
[0m21:24:55.353039 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 15 at position 4 unexpected 'group_by'.
syntax error line 18 at position 4 unexpected 'select'.
[0m21:24:55.355389 [debug] [Thread-2 (]: Database Error in model exporter (models/visualisation/exporter.sql)
  001003 (42000): SQL compilation error:
  syntax error line 15 at position 4 unexpected 'group_by'.
  syntax error line 18 at position 4 unexpected 'select'.
  compiled code at target/run/citrus_trade/models/visualisation/exporter.sql
[0m21:24:55.355725 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f98ca873-1273-4654-a606-0e64cc8705cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88502450>]}
[0m21:24:55.356096 [error] [Thread-2 (]: 3 of 5 ERROR creating sql view model visualisation.exporter .................... [[31mERROR[0m in 0.12s]
[0m21:24:55.356480 [debug] [Thread-2 (]: Finished running node model.citrus_trade.exporter
[0m21:24:55.356876 [debug] [Thread-7 (]: Marking all children of 'model.citrus_trade.exporter' to be skipped because of status 'error'.  Reason: Database Error in model exporter (models/visualisation/exporter.sql)
  001003 (42000): SQL compilation error:
  syntax error line 15 at position 4 unexpected 'group_by'.
  syntax error line 18 at position 4 unexpected 'select'.
  compiled code at target/run/citrus_trade/models/visualisation/exporter.sql.
[0m21:24:55.372629 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01c02c84-0105-6cf2-0000-000420cacadd
[0m21:24:55.373013 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 15 at position 4 unexpected 'group_by'.
syntax error line 18 at position 4 unexpected 'select'.
[0m21:24:55.375374 [debug] [Thread-1 (]: Database Error in model importer (models/visualisation/importer.sql)
  001003 (42000): SQL compilation error:
  syntax error line 15 at position 4 unexpected 'group_by'.
  syntax error line 18 at position 4 unexpected 'select'.
  compiled code at target/run/citrus_trade/models/visualisation/importer.sql
[0m21:24:55.375752 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f98ca873-1273-4654-a606-0e64cc8705cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff807dc8c0>]}
[0m21:24:55.376207 [error] [Thread-1 (]: 4 of 5 ERROR creating sql view model visualisation.importer .................... [[31mERROR[0m in 0.14s]
[0m21:24:55.376575 [debug] [Thread-1 (]: Finished running node model.citrus_trade.importer
[0m21:24:55.376945 [debug] [Thread-7 (]: Marking all children of 'model.citrus_trade.importer' to be skipped because of status 'error'.  Reason: Database Error in model importer (models/visualisation/importer.sql)
  001003 (42000): SQL compilation error:
  syntax error line 15 at position 4 unexpected 'group_by'.
  syntax error line 18 at position 4 unexpected 'select'.
  compiled code at target/run/citrus_trade/models/visualisation/importer.sql.
[0m21:24:55.710892 [debug] [Thread-4 (]: Snowflake adapter: Snowflake query id: 01c02c84-0105-6cf2-0000-000420cacae5
[0m21:24:55.717387 [debug] [Thread-4 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 16 at position 4 unexpected 'group_by'.
syntax error line 19 at position 4 unexpected 'select'.
[0m21:24:55.756009 [debug] [Thread-4 (]: Database Error in model importer_by_year (models/visualisation/importer_by_year.sql)
  001003 (42000): SQL compilation error:
  syntax error line 16 at position 4 unexpected 'group_by'.
  syntax error line 19 at position 4 unexpected 'select'.
  compiled code at target/run/citrus_trade/models/visualisation/importer_by_year.sql
[0m21:24:55.779078 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f98ca873-1273-4654-a606-0e64cc8705cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83142c00>]}
[0m21:24:55.786805 [error] [Thread-4 (]: 5 of 5 ERROR creating sql view model visualisation.importer_by_year ............ [[31mERROR[0m in 0.54s]
[0m21:24:55.792607 [debug] [Thread-4 (]: Finished running node model.citrus_trade.importer_by_year
[0m21:24:55.797311 [debug] [Thread-7 (]: Marking all children of 'model.citrus_trade.importer_by_year' to be skipped because of status 'error'.  Reason: Database Error in model importer_by_year (models/visualisation/importer_by_year.sql)
  001003 (42000): SQL compilation error:
  syntax error line 16 at position 4 unexpected 'group_by'.
  syntax error line 19 at position 4 unexpected 'select'.
  compiled code at target/run/citrus_trade/models/visualisation/importer_by_year.sql.
[0m21:24:55.809000 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:24:55.809727 [debug] [MainThread]: Connection 'model.citrus_trade.exporter' was left open.
[0m21:24:55.810169 [debug] [MainThread]: On model.citrus_trade.exporter: Close
[0m21:24:55.930262 [debug] [MainThread]: Connection 'model.citrus_trade.importer' was left open.
[0m21:24:55.931071 [debug] [MainThread]: On model.citrus_trade.importer: Close
[0m21:24:56.023597 [debug] [MainThread]: Connection 'model.citrus_trade.trade_by_reporter' was left open.
[0m21:24:56.024536 [debug] [MainThread]: On model.citrus_trade.trade_by_reporter: Close
[0m21:24:56.148445 [debug] [MainThread]: Connection 'model.citrus_trade.importer_by_year' was left open.
[0m21:24:56.149521 [debug] [MainThread]: On model.citrus_trade.importer_by_year: Close
[0m21:24:56.243864 [info ] [MainThread]: 
[0m21:24:56.244530 [info ] [MainThread]: Finished running 2 table models, 3 view models in 0 hours 0 minutes and 5.59 seconds (5.59s).
[0m21:24:56.246069 [debug] [MainThread]: Command end result
[0m21:24:56.299134 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m21:24:56.301481 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m21:24:56.306769 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt/target/run_results.json
[0m21:24:56.306964 [info ] [MainThread]: 
[0m21:24:56.307263 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m21:24:56.307620 [info ] [MainThread]: 
[0m21:24:56.308011 [error] [MainThread]: [31mFailure in model exporter (models/visualisation/exporter.sql)[0m
[0m21:24:56.308291 [error] [MainThread]:   Database Error in model exporter (models/visualisation/exporter.sql)
  001003 (42000): SQL compilation error:
  syntax error line 15 at position 4 unexpected 'group_by'.
  syntax error line 18 at position 4 unexpected 'select'.
  compiled code at target/run/citrus_trade/models/visualisation/exporter.sql
[0m21:24:56.308527 [info ] [MainThread]: 
[0m21:24:56.308811 [info ] [MainThread]:   compiled code at target/compiled/citrus_trade/models/visualisation/exporter.sql
[0m21:24:56.309012 [info ] [MainThread]: 
[0m21:24:56.309271 [error] [MainThread]: [31mFailure in model importer (models/visualisation/importer.sql)[0m
[0m21:24:56.309570 [error] [MainThread]:   Database Error in model importer (models/visualisation/importer.sql)
  001003 (42000): SQL compilation error:
  syntax error line 15 at position 4 unexpected 'group_by'.
  syntax error line 18 at position 4 unexpected 'select'.
  compiled code at target/run/citrus_trade/models/visualisation/importer.sql
[0m21:24:56.309872 [info ] [MainThread]: 
[0m21:24:56.310169 [info ] [MainThread]:   compiled code at target/compiled/citrus_trade/models/visualisation/importer.sql
[0m21:24:56.310550 [info ] [MainThread]: 
[0m21:24:56.310935 [error] [MainThread]: [31mFailure in model importer_by_year (models/visualisation/importer_by_year.sql)[0m
[0m21:24:56.311598 [error] [MainThread]:   Database Error in model importer_by_year (models/visualisation/importer_by_year.sql)
  001003 (42000): SQL compilation error:
  syntax error line 16 at position 4 unexpected 'group_by'.
  syntax error line 19 at position 4 unexpected 'select'.
  compiled code at target/run/citrus_trade/models/visualisation/importer_by_year.sql
[0m21:24:56.311827 [info ] [MainThread]: 
[0m21:24:56.312125 [info ] [MainThread]:   compiled code at target/compiled/citrus_trade/models/visualisation/importer_by_year.sql
[0m21:24:56.312312 [info ] [MainThread]: 
[0m21:24:56.312591 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=3 SKIP=0 NO-OP=0 TOTAL=5
[0m21:24:56.313790 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 6.295316, "process_in_blocks": "0", "process_kernel_time": 0.543516, "process_mem_max_rss": "173520", "process_out_blocks": "4149", "process_user_time": 1.951671}
[0m21:24:56.314107 [debug] [MainThread]: Command `dbt run` failed at 21:24:56.314039 after 6.30 seconds
[0m21:24:56.314397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8dc743b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f4243e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff923fa900>]}
[0m21:24:56.315315 [debug] [MainThread]: Flushing usage events
[0m21:24:56.900198 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:25:53.222342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8582fbf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86affa40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87e8a3f0>]}


============================== 21:25:53.225883 | 2822f52c-9245-4cfe-910b-8f8c7ba098ca ==============================
[0m21:25:53.225883 [info ] [MainThread]: Running with dbt=1.10.13
[0m21:25:53.226280 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'printer_width': '80', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_cache_events': 'False', 'version_check': 'True', 'log_path': '/app/dbt/logs', 'fail_fast': 'False', 'no_print': 'None', 'empty': 'False', 'use_experimental_parser': 'False', 'write_json': 'True', 'partial_parse': 'True', 'static_parser': 'True', 'target_path': 'None', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'log_format': 'default', 'warn_error': 'None', 'use_colors': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'profiles_dir': '/app/dbt'}
[0m21:25:53.444940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2822f52c-9245-4cfe-910b-8f8c7ba098ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85d02450>]}
[0m21:25:53.483902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2822f52c-9245-4cfe-910b-8f8c7ba098ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83a5cb60>]}
[0m21:25:53.484767 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m21:25:53.561068 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m21:25:53.677415 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m21:25:53.677800 [debug] [MainThread]: Partial parsing: updated file: citrus_trade://models/visualisation/importer_by_year.sql
[0m21:25:53.677995 [debug] [MainThread]: Partial parsing: updated file: citrus_trade://models/visualisation/importer.sql
[0m21:25:53.678169 [debug] [MainThread]: Partial parsing: updated file: citrus_trade://models/visualisation/exporter.sql
[0m21:25:53.805771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2822f52c-9245-4cfe-910b-8f8c7ba098ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84e3c4d0>]}
[0m21:25:53.861957 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m21:25:53.863288 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m21:25:53.871623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2822f52c-9245-4cfe-910b-8f8c7ba098ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff834a5430>]}
[0m21:25:53.871872 [info ] [MainThread]: Found 5 models, 1 source, 632 macros
[0m21:25:53.872079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2822f52c-9245-4cfe-910b-8f8c7ba098ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82f691c0>]}
[0m21:25:53.873125 [info ] [MainThread]: 
[0m21:25:53.873361 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:25:53.873607 [info ] [MainThread]: 
[0m21:25:53.874297 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:25:53.876938 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRHS'
[0m21:25:53.882560 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRHS'
[0m21:25:53.884459 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRHS'
[0m21:25:53.905331 [debug] [ThreadPool]: Using snowflake connection "list_TRHS"
[0m21:25:53.905654 [debug] [ThreadPool]: Using snowflake connection "list_TRHS"
[0m21:25:53.905822 [debug] [ThreadPool]: On list_TRHS: show terse schemas in database TRHS
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS"} */
[0m21:25:53.906022 [debug] [ThreadPool]: Using snowflake connection "list_TRHS"
[0m21:25:53.906235 [debug] [ThreadPool]: On list_TRHS: show terse schemas in database TRHS
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS"} */
[0m21:25:53.906442 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:25:53.906620 [debug] [ThreadPool]: On list_TRHS: show terse schemas in database TRHS
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS"} */
[0m21:25:53.906820 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:25:53.909348 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:25:56.741005 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.831 seconds
[0m21:25:56.834402 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.927 seconds
[0m21:25:56.880764 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.974 seconds
[0m21:25:56.886462 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRHS, now list_TRHS_staging)
[0m21:25:56.886964 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRHS, now list_TRHS_analytics)
[0m21:25:56.893807 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRHS, now list_TRHS_visualisation)
[0m21:25:56.896309 [debug] [ThreadPool]: Using snowflake connection "list_TRHS_staging"
[0m21:25:56.900049 [debug] [ThreadPool]: On list_TRHS_staging: show objects in TRHS.staging
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS_staging"} */;
[0m21:25:56.899797 [debug] [ThreadPool]: Using snowflake connection "list_TRHS_visualisation"
[0m21:25:56.897783 [debug] [ThreadPool]: Using snowflake connection "list_TRHS_analytics"
[0m21:25:56.901159 [debug] [ThreadPool]: On list_TRHS_visualisation: show objects in TRHS.visualisation
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS_visualisation"} */;
[0m21:25:56.901467 [debug] [ThreadPool]: On list_TRHS_analytics: show objects in TRHS.analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS_analytics"} */;
[0m21:25:57.005700 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.105 seconds
[0m21:25:57.007551 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.105 seconds
[0m21:25:57.026743 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.125 seconds
[0m21:25:57.030270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2822f52c-9245-4cfe-910b-8f8c7ba098ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83480140>]}
[0m21:25:57.035734 [debug] [Thread-1 (]: Began running node model.citrus_trade.stg_trade
[0m21:25:57.036517 [info ] [Thread-1 (]: 1 of 5 START sql table model staging.stg_trade ................................. [RUN]
[0m21:25:57.037392 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_TRHS_visualisation, now model.citrus_trade.stg_trade)
[0m21:25:57.038084 [debug] [Thread-1 (]: Began compiling node model.citrus_trade.stg_trade
[0m21:25:57.049852 [debug] [Thread-1 (]: Writing injected SQL for node "model.citrus_trade.stg_trade"
[0m21:25:57.051447 [debug] [Thread-1 (]: Began executing node model.citrus_trade.stg_trade
[0m21:25:57.081352 [debug] [Thread-1 (]: Writing runtime sql for node "model.citrus_trade.stg_trade"
[0m21:25:57.082966 [debug] [Thread-1 (]: Using snowflake connection "model.citrus_trade.stg_trade"
[0m21:25:57.083324 [debug] [Thread-1 (]: On model.citrus_trade.stg_trade: create or replace transient table TRHS.staging.stg_trade
    
    
    
    as (select
  value:DECLARANT::int as declarant,
  value:DECLARANT_ISO::string as declarant_iso,
  value:PARTNER::string as partner,
  value:PARTNER_ISO::string as partner_iso,
  value:FLOW::int as flow,
  value:TRANSPORT_MODE::int as transport_mode,
  value:PERIOD::int as period,
  value:HS4::string as hs4,
  value:HS4_NAME::string as hs4_name,
  value:HS6::string as hs6,
  value:HS6_NAME::string as hs6_name,
  value:VALUE_IN_EUROS::float as value_in_euros,
  value:QUANTITY_IN_KG::float as quantity_in_kg
from trhs.staging.citrus_ext
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.stg_trade"} */;
[0m21:25:57.885489 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.801 seconds
[0m21:25:57.915336 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2822f52c-9245-4cfe-910b-8f8c7ba098ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b59f1a0>]}
[0m21:25:57.916346 [info ] [Thread-1 (]: 1 of 5 OK created sql table model staging.stg_trade ............................ [[32mSUCCESS 1[0m in 0.88s]
[0m21:25:57.917286 [debug] [Thread-1 (]: Finished running node model.citrus_trade.stg_trade
[0m21:25:57.918614 [debug] [Thread-3 (]: Began running node model.citrus_trade.trade_by_reporter
[0m21:25:57.919122 [info ] [Thread-3 (]: 2 of 5 START sql table model analytics.trade_by_reporter ....................... [RUN]
[0m21:25:57.919842 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_TRHS_staging, now model.citrus_trade.trade_by_reporter)
[0m21:25:57.920313 [debug] [Thread-3 (]: Began compiling node model.citrus_trade.trade_by_reporter
[0m21:25:57.926774 [debug] [Thread-3 (]: Writing injected SQL for node "model.citrus_trade.trade_by_reporter"
[0m21:25:57.928677 [debug] [Thread-3 (]: Began executing node model.citrus_trade.trade_by_reporter
[0m21:25:57.932080 [debug] [Thread-3 (]: Writing runtime sql for node "model.citrus_trade.trade_by_reporter"
[0m21:25:57.933941 [debug] [Thread-3 (]: Using snowflake connection "model.citrus_trade.trade_by_reporter"
[0m21:25:57.934337 [debug] [Thread-3 (]: On model.citrus_trade.trade_by_reporter: create or replace transient table TRHS.analytics.trade_by_reporter
    
    
    
    as (select 
    declarant,
    declarant_iso,
    partner,
    partner_iso,
    flow,
    transport_mode,
    year(to_date(left(period,4),'YYYY')) as year,
    period,
    hs6,
    hs6_name,
    sum(value_in_euros) as total_value,
    sum(quantity_in_kg) as total_quantity
from TRHS.staging.stg_trade
group by 1,2,3,4,5,6,7,8,9,10
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.trade_by_reporter"} */;
[0m21:25:58.607570 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.671 seconds
[0m21:25:58.613577 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2822f52c-9245-4cfe-910b-8f8c7ba098ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff801b2120>]}
[0m21:25:58.616144 [info ] [Thread-3 (]: 2 of 5 OK created sql table model analytics.trade_by_reporter .................. [[32mSUCCESS 1[0m in 0.69s]
[0m21:25:58.618245 [debug] [Thread-3 (]: Finished running node model.citrus_trade.trade_by_reporter
[0m21:25:58.619813 [debug] [Thread-2 (]: Began running node model.citrus_trade.exporter
[0m21:25:58.620549 [info ] [Thread-2 (]: 3 of 5 START sql view model visualisation.exporter ............................. [RUN]
[0m21:25:58.620222 [debug] [Thread-1 (]: Began running node model.citrus_trade.importer
[0m21:25:58.623657 [info ] [Thread-1 (]: 4 of 5 START sql view model visualisation.importer ............................. [RUN]
[0m21:25:58.622236 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_TRHS_analytics, now model.citrus_trade.exporter)
[0m21:25:58.621012 [debug] [Thread-4 (]: Began running node model.citrus_trade.importer_by_year
[0m21:25:58.624266 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.citrus_trade.stg_trade, now model.citrus_trade.importer)
[0m21:25:58.625288 [debug] [Thread-2 (]: Began compiling node model.citrus_trade.exporter
[0m21:25:58.625857 [info ] [Thread-4 (]: 5 of 5 START sql view model visualisation.importer_by_year ..................... [RUN]
[0m21:25:58.626221 [debug] [Thread-1 (]: Began compiling node model.citrus_trade.importer
[0m21:25:58.631163 [debug] [Thread-2 (]: Writing injected SQL for node "model.citrus_trade.exporter"
[0m21:25:58.633385 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.citrus_trade.importer_by_year'
[0m21:25:58.641486 [debug] [Thread-1 (]: Writing injected SQL for node "model.citrus_trade.importer"
[0m21:25:58.642547 [debug] [Thread-4 (]: Began compiling node model.citrus_trade.importer_by_year
[0m21:25:58.645544 [debug] [Thread-4 (]: Writing injected SQL for node "model.citrus_trade.importer_by_year"
[0m21:25:58.646058 [debug] [Thread-2 (]: Began executing node model.citrus_trade.exporter
[0m21:25:58.662456 [debug] [Thread-1 (]: Began executing node model.citrus_trade.importer
[0m21:25:58.669434 [debug] [Thread-2 (]: Writing runtime sql for node "model.citrus_trade.exporter"
[0m21:25:58.671491 [debug] [Thread-1 (]: Writing runtime sql for node "model.citrus_trade.importer"
[0m21:25:58.671990 [debug] [Thread-4 (]: Began executing node model.citrus_trade.importer_by_year
[0m21:25:58.674469 [debug] [Thread-4 (]: Writing runtime sql for node "model.citrus_trade.importer_by_year"
[0m21:25:58.675762 [debug] [Thread-2 (]: Using snowflake connection "model.citrus_trade.exporter"
[0m21:25:58.676546 [debug] [Thread-1 (]: Using snowflake connection "model.citrus_trade.importer"
[0m21:25:58.676969 [debug] [Thread-2 (]: On model.citrus_trade.exporter: create or replace   view TRHS.visualisation.exporter
  
  
  
  
  as (
    with base as (
    select
        declarant_iso,
        sum(total_value) as total_value,
        sum(total_quantity) as total_quantity,
        sum(total_value)/nullif(sum(total_quantity),0) as value_per_quantity
    from TRHS.analytics.trade_by_reporter
    where flow = 2
    group by 1 
)

    select 
        declarant,
        metric_type,
        metric_value
    from base
    unpivot(
        metric_value for metric_type in (
            total_value,
            total_quantity,
            value_per_quantity
        )
    )
  )
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.exporter"} */;
[0m21:25:58.677290 [debug] [Thread-1 (]: On model.citrus_trade.importer: create or replace   view TRHS.visualisation.importer
  
  
  
  
  as (
    with base as (
    select
        declarant_iso,
        sum(total_value) as total_value,
        sum(total_quantity) as total_quantity,
        sum(total_value)/nullif(sum(total_quantity),0) as value_per_quantity
    from TRHS.analytics.trade_by_reporter
    where flow = 1
    group by 1 
)

    select 
        declarant,
        metric_type,
        metric_value
    from base
    unpivot(
        metric_value for metric_type in (
            total_value,
            total_quantity,
            value_per_quantity
        )
    )
  )
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.importer"} */;
[0m21:25:58.677910 [debug] [Thread-4 (]: Using snowflake connection "model.citrus_trade.importer_by_year"
[0m21:25:58.683622 [debug] [Thread-4 (]: On model.citrus_trade.importer_by_year: create or replace   view TRHS.visualisation.importer_by_year
  
  
  
  
  as (
    with base as (
    select
        declarant_iso,
        year,
        sum(total_value) as total_value,
        sum(total_quantity) as total_quantity,
        sum(total_value)/nullif(sum(total_quantity),0) as value_per_quantity
    from TRHS.analytics.trade_by_reporter
    where flow = 1
    group by 1,2
)

    select 
        declarant,
        year,
        metric_type,
        metric_value
    from base
    unpivot(
        metric_value for metric_type in (
            total_value,
            total_quantity,
            value_per_quantity
        )
    )
  )
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.importer_by_year"} */;
[0m21:25:58.685215 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m21:25:58.759647 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01c02c85-0105-6cf2-0000-000420cacb15
[0m21:25:58.760085 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 19 at position 8
invalid identifier 'DECLARANT'
[0m21:25:58.762992 [debug] [Thread-1 (]: Database Error in model importer (models/visualisation/importer.sql)
  000904 (42000): SQL compilation error: error line 19 at position 8
  invalid identifier 'DECLARANT'
  compiled code at target/run/citrus_trade/models/visualisation/importer.sql
[0m21:25:58.763395 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2822f52c-9245-4cfe-910b-8f8c7ba098ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b59dac0>]}
[0m21:25:58.763852 [error] [Thread-1 (]: 4 of 5 ERROR creating sql view model visualisation.importer .................... [[31mERROR[0m in 0.14s]
[0m21:25:58.764337 [debug] [Thread-1 (]: Finished running node model.citrus_trade.importer
[0m21:25:58.764884 [debug] [Thread-7 (]: Marking all children of 'model.citrus_trade.importer' to be skipped because of status 'error'.  Reason: Database Error in model importer (models/visualisation/importer.sql)
  000904 (42000): SQL compilation error: error line 19 at position 8
  invalid identifier 'DECLARANT'
  compiled code at target/run/citrus_trade/models/visualisation/importer.sql.
[0m21:25:58.794526 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01c02c85-0105-6cf2-0000-000420cacb19
[0m21:25:58.794943 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 19 at position 8
invalid identifier 'DECLARANT'
[0m21:25:58.797200 [debug] [Thread-2 (]: Database Error in model exporter (models/visualisation/exporter.sql)
  000904 (42000): SQL compilation error: error line 19 at position 8
  invalid identifier 'DECLARANT'
  compiled code at target/run/citrus_trade/models/visualisation/exporter.sql
[0m21:25:58.797634 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2822f52c-9245-4cfe-910b-8f8c7ba098ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8012c260>]}
[0m21:25:58.798130 [error] [Thread-2 (]: 3 of 5 ERROR creating sql view model visualisation.exporter .................... [[31mERROR[0m in 0.18s]
[0m21:25:58.798619 [debug] [Thread-2 (]: Finished running node model.citrus_trade.exporter
[0m21:25:58.799154 [debug] [Thread-7 (]: Marking all children of 'model.citrus_trade.exporter' to be skipped because of status 'error'.  Reason: Database Error in model exporter (models/visualisation/exporter.sql)
  000904 (42000): SQL compilation error: error line 19 at position 8
  invalid identifier 'DECLARANT'
  compiled code at target/run/citrus_trade/models/visualisation/exporter.sql.
[0m21:25:59.078806 [debug] [Thread-4 (]: Snowflake adapter: Snowflake query id: 01c02c85-0105-6cf2-0000-000420cacb1d
[0m21:25:59.080286 [debug] [Thread-4 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 20 at position 8
invalid identifier 'DECLARANT'
[0m21:25:59.087639 [debug] [Thread-4 (]: Database Error in model importer_by_year (models/visualisation/importer_by_year.sql)
  000904 (42000): SQL compilation error: error line 20 at position 8
  invalid identifier 'DECLARANT'
  compiled code at target/run/citrus_trade/models/visualisation/importer_by_year.sql
[0m21:25:59.088767 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2822f52c-9245-4cfe-910b-8f8c7ba098ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80159e80>]}
[0m21:25:59.089895 [error] [Thread-4 (]: 5 of 5 ERROR creating sql view model visualisation.importer_by_year ............ [[31mERROR[0m in 0.46s]
[0m21:25:59.091100 [debug] [Thread-4 (]: Finished running node model.citrus_trade.importer_by_year
[0m21:25:59.092018 [debug] [Thread-7 (]: Marking all children of 'model.citrus_trade.importer_by_year' to be skipped because of status 'error'.  Reason: Database Error in model importer_by_year (models/visualisation/importer_by_year.sql)
  000904 (42000): SQL compilation error: error line 20 at position 8
  invalid identifier 'DECLARANT'
  compiled code at target/run/citrus_trade/models/visualisation/importer_by_year.sql.
[0m21:25:59.095127 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:25:59.095816 [debug] [MainThread]: Connection 'model.citrus_trade.trade_by_reporter' was left open.
[0m21:25:59.096349 [debug] [MainThread]: On model.citrus_trade.trade_by_reporter: Close
[0m21:25:59.189861 [debug] [MainThread]: Connection 'model.citrus_trade.exporter' was left open.
[0m21:25:59.191041 [debug] [MainThread]: On model.citrus_trade.exporter: Close
[0m21:25:59.302277 [debug] [MainThread]: Connection 'model.citrus_trade.importer' was left open.
[0m21:25:59.302790 [debug] [MainThread]: On model.citrus_trade.importer: Close
[0m21:25:59.402630 [debug] [MainThread]: Connection 'model.citrus_trade.importer_by_year' was left open.
[0m21:25:59.403728 [debug] [MainThread]: On model.citrus_trade.importer_by_year: Close
[0m21:25:59.529982 [info ] [MainThread]: 
[0m21:25:59.531482 [info ] [MainThread]: Finished running 2 table models, 3 view models in 0 hours 0 minutes and 5.66 seconds (5.66s).
[0m21:25:59.534462 [debug] [MainThread]: Command end result
[0m21:25:59.591098 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m21:25:59.593873 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m21:25:59.599156 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt/target/run_results.json
[0m21:25:59.599388 [info ] [MainThread]: 
[0m21:25:59.599639 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m21:25:59.599985 [info ] [MainThread]: 
[0m21:25:59.600337 [error] [MainThread]: [31mFailure in model importer (models/visualisation/importer.sql)[0m
[0m21:25:59.600627 [error] [MainThread]:   Database Error in model importer (models/visualisation/importer.sql)
  000904 (42000): SQL compilation error: error line 19 at position 8
  invalid identifier 'DECLARANT'
  compiled code at target/run/citrus_trade/models/visualisation/importer.sql
[0m21:25:59.600877 [info ] [MainThread]: 
[0m21:25:59.601304 [info ] [MainThread]:   compiled code at target/compiled/citrus_trade/models/visualisation/importer.sql
[0m21:25:59.601541 [info ] [MainThread]: 
[0m21:25:59.601817 [error] [MainThread]: [31mFailure in model exporter (models/visualisation/exporter.sql)[0m
[0m21:25:59.602356 [error] [MainThread]:   Database Error in model exporter (models/visualisation/exporter.sql)
  000904 (42000): SQL compilation error: error line 19 at position 8
  invalid identifier 'DECLARANT'
  compiled code at target/run/citrus_trade/models/visualisation/exporter.sql
[0m21:25:59.602726 [info ] [MainThread]: 
[0m21:25:59.603135 [info ] [MainThread]:   compiled code at target/compiled/citrus_trade/models/visualisation/exporter.sql
[0m21:25:59.603487 [info ] [MainThread]: 
[0m21:25:59.603790 [error] [MainThread]: [31mFailure in model importer_by_year (models/visualisation/importer_by_year.sql)[0m
[0m21:25:59.604062 [error] [MainThread]:   Database Error in model importer_by_year (models/visualisation/importer_by_year.sql)
  000904 (42000): SQL compilation error: error line 20 at position 8
  invalid identifier 'DECLARANT'
  compiled code at target/run/citrus_trade/models/visualisation/importer_by_year.sql
[0m21:25:59.604327 [info ] [MainThread]: 
[0m21:25:59.604651 [info ] [MainThread]:   compiled code at target/compiled/citrus_trade/models/visualisation/importer_by_year.sql
[0m21:25:59.604870 [info ] [MainThread]: 
[0m21:25:59.605161 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=3 SKIP=0 NO-OP=0 TOTAL=5
[0m21:25:59.606577 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 6.4169717, "process_in_blocks": "0", "process_kernel_time": 0.539967, "process_mem_max_rss": "167472", "process_out_blocks": "4148", "process_user_time": 1.935137}
[0m21:25:59.607068 [debug] [MainThread]: Command `dbt run` failed at 21:25:59.606986 after 6.42 seconds
[0m21:25:59.607474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8557aff0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8374d580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff855d6930>]}
[0m21:25:59.607742 [debug] [MainThread]: Flushing usage events
[0m21:26:00.262178 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:28:02.900173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8eb10b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f141af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90d94e90>]}


============================== 21:28:02.903531 | d59bab27-8ab7-4688-a391-6174c07deaa5 ==============================
[0m21:28:02.903531 [info ] [MainThread]: Running with dbt=1.10.13
[0m21:28:02.903875 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'log_path': '/app/dbt/logs', 'partial_parse': 'True', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'use_colors': 'True', 'empty': 'False', 'no_print': 'None', 'static_parser': 'True', 'invocation_command': 'dbt run', 'warn_error': 'None', 'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'fail_fast': 'False', 'log_format': 'default', 'write_json': 'True', 'target_path': 'None', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '/app/dbt'}
[0m21:28:03.125720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd59bab27-8ab7-4688-a391-6174c07deaa5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d219af0>]}
[0m21:28:03.157313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd59bab27-8ab7-4688-a391-6174c07deaa5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d026ae0>]}
[0m21:28:03.157924 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m21:28:03.204578 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m21:28:03.323118 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m21:28:03.323536 [debug] [MainThread]: Partial parsing: updated file: citrus_trade://models/visualisation/exporter.sql
[0m21:28:03.323744 [debug] [MainThread]: Partial parsing: updated file: citrus_trade://models/visualisation/importer.sql
[0m21:28:03.323943 [debug] [MainThread]: Partial parsing: updated file: citrus_trade://models/visualisation/importer_by_year.sql
[0m21:28:03.450870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd59bab27-8ab7-4688-a391-6174c07deaa5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c851c40>]}
[0m21:28:03.517774 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m21:28:03.524765 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m21:28:03.542566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd59bab27-8ab7-4688-a391-6174c07deaa5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c74d820>]}
[0m21:28:03.543052 [info ] [MainThread]: Found 5 models, 1 source, 632 macros
[0m21:28:03.543327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd59bab27-8ab7-4688-a391-6174c07deaa5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c7b0e00>]}
[0m21:28:03.544647 [info ] [MainThread]: 
[0m21:28:03.545027 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:28:03.545497 [info ] [MainThread]: 
[0m21:28:03.545963 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:28:03.549310 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRHS'
[0m21:28:03.555346 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRHS'
[0m21:28:03.562372 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRHS'
[0m21:28:03.588155 [debug] [ThreadPool]: Using snowflake connection "list_TRHS"
[0m21:28:03.589758 [debug] [ThreadPool]: On list_TRHS: show terse schemas in database TRHS
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS"} */
[0m21:28:03.589409 [debug] [ThreadPool]: Using snowflake connection "list_TRHS"
[0m21:28:03.594681 [debug] [ThreadPool]: On list_TRHS: show terse schemas in database TRHS
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS"} */
[0m21:28:03.595757 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:28:03.589011 [debug] [ThreadPool]: Using snowflake connection "list_TRHS"
[0m21:28:03.591390 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:28:03.599053 [debug] [ThreadPool]: On list_TRHS: show terse schemas in database TRHS
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS"} */
[0m21:28:03.600718 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:28:05.607059 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.006 seconds
[0m21:28:05.627963 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.036 seconds
[0m21:28:05.632122 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.036 seconds
[0m21:28:05.636747 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRHS, now list_TRHS_staging)
[0m21:28:05.643621 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRHS, now list_TRHS_visualisation)
[0m21:28:05.661330 [debug] [ThreadPool]: Using snowflake connection "list_TRHS_staging"
[0m21:28:05.666747 [debug] [ThreadPool]: Using snowflake connection "list_TRHS_visualisation"
[0m21:28:05.667501 [debug] [ThreadPool]: On list_TRHS_staging: show objects in TRHS.staging
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS_staging"} */;
[0m21:28:05.668034 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRHS, now list_TRHS_analytics)
[0m21:28:05.668583 [debug] [ThreadPool]: On list_TRHS_visualisation: show objects in TRHS.visualisation
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS_visualisation"} */;
[0m21:28:05.673133 [debug] [ThreadPool]: Using snowflake connection "list_TRHS_analytics"
[0m21:28:05.674253 [debug] [ThreadPool]: On list_TRHS_analytics: show objects in TRHS.analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS_analytics"} */;
[0m21:28:05.797850 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.129 seconds
[0m21:28:05.799661 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.124 seconds
[0m21:28:05.813101 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.139 seconds
[0m21:28:05.817173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd59bab27-8ab7-4688-a391-6174c07deaa5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c8d7890>]}
[0m21:28:05.823733 [debug] [Thread-1 (]: Began running node model.citrus_trade.stg_trade
[0m21:28:05.824513 [info ] [Thread-1 (]: 1 of 5 START sql table model staging.stg_trade ................................. [RUN]
[0m21:28:05.825325 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_TRHS_visualisation, now model.citrus_trade.stg_trade)
[0m21:28:05.826038 [debug] [Thread-1 (]: Began compiling node model.citrus_trade.stg_trade
[0m21:28:05.835790 [debug] [Thread-1 (]: Writing injected SQL for node "model.citrus_trade.stg_trade"
[0m21:28:05.837550 [debug] [Thread-1 (]: Began executing node model.citrus_trade.stg_trade
[0m21:28:05.864844 [debug] [Thread-1 (]: Writing runtime sql for node "model.citrus_trade.stg_trade"
[0m21:28:05.866362 [debug] [Thread-1 (]: Using snowflake connection "model.citrus_trade.stg_trade"
[0m21:28:05.866631 [debug] [Thread-1 (]: On model.citrus_trade.stg_trade: create or replace transient table TRHS.staging.stg_trade
    
    
    
    as (select
  value:DECLARANT::int as declarant,
  value:DECLARANT_ISO::string as declarant_iso,
  value:PARTNER::string as partner,
  value:PARTNER_ISO::string as partner_iso,
  value:FLOW::int as flow,
  value:TRANSPORT_MODE::int as transport_mode,
  value:PERIOD::int as period,
  value:HS4::string as hs4,
  value:HS4_NAME::string as hs4_name,
  value:HS6::string as hs6,
  value:HS6_NAME::string as hs6_name,
  value:VALUE_IN_EUROS::float as value_in_euros,
  value:QUANTITY_IN_KG::float as quantity_in_kg
from trhs.staging.citrus_ext
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.stg_trade"} */;
[0m21:28:06.614285 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.747 seconds
[0m21:28:06.650888 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd59bab27-8ab7-4688-a391-6174c07deaa5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80d26180>]}
[0m21:28:06.652012 [info ] [Thread-1 (]: 1 of 5 OK created sql table model staging.stg_trade ............................ [[32mSUCCESS 1[0m in 0.82s]
[0m21:28:06.652914 [debug] [Thread-1 (]: Finished running node model.citrus_trade.stg_trade
[0m21:28:06.654138 [debug] [Thread-3 (]: Began running node model.citrus_trade.trade_by_reporter
[0m21:28:06.654673 [info ] [Thread-3 (]: 2 of 5 START sql table model analytics.trade_by_reporter ....................... [RUN]
[0m21:28:06.655202 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_TRHS_staging, now model.citrus_trade.trade_by_reporter)
[0m21:28:06.655622 [debug] [Thread-3 (]: Began compiling node model.citrus_trade.trade_by_reporter
[0m21:28:06.661664 [debug] [Thread-3 (]: Writing injected SQL for node "model.citrus_trade.trade_by_reporter"
[0m21:28:06.663743 [debug] [Thread-3 (]: Began executing node model.citrus_trade.trade_by_reporter
[0m21:28:06.666324 [debug] [Thread-3 (]: Writing runtime sql for node "model.citrus_trade.trade_by_reporter"
[0m21:28:06.667676 [debug] [Thread-3 (]: Using snowflake connection "model.citrus_trade.trade_by_reporter"
[0m21:28:06.668049 [debug] [Thread-3 (]: On model.citrus_trade.trade_by_reporter: create or replace transient table TRHS.analytics.trade_by_reporter
    
    
    
    as (select 
    declarant,
    declarant_iso,
    partner,
    partner_iso,
    flow,
    transport_mode,
    year(to_date(left(period,4),'YYYY')) as year,
    period,
    hs6,
    hs6_name,
    sum(value_in_euros) as total_value,
    sum(quantity_in_kg) as total_quantity
from TRHS.staging.stg_trade
group by 1,2,3,4,5,6,7,8,9,10
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.trade_by_reporter"} */;
[0m21:28:07.318889 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.650 seconds
[0m21:28:07.323061 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd59bab27-8ab7-4688-a391-6174c07deaa5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89dad130>]}
[0m21:28:07.324219 [info ] [Thread-3 (]: 2 of 5 OK created sql table model analytics.trade_by_reporter .................. [[32mSUCCESS 1[0m in 0.67s]
[0m21:28:07.325883 [debug] [Thread-3 (]: Finished running node model.citrus_trade.trade_by_reporter
[0m21:28:07.327306 [debug] [Thread-2 (]: Began running node model.citrus_trade.exporter
[0m21:28:07.327841 [debug] [Thread-1 (]: Began running node model.citrus_trade.importer
[0m21:28:07.328418 [info ] [Thread-2 (]: 3 of 5 START sql view model visualisation.exporter ............................. [RUN]
[0m21:28:07.329094 [debug] [Thread-4 (]: Began running node model.citrus_trade.importer_by_year
[0m21:28:07.329787 [info ] [Thread-1 (]: 4 of 5 START sql view model visualisation.importer ............................. [RUN]
[0m21:28:07.330644 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_TRHS_analytics, now model.citrus_trade.exporter)
[0m21:28:07.331927 [info ] [Thread-4 (]: 5 of 5 START sql view model visualisation.importer_by_year ..................... [RUN]
[0m21:28:07.332625 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.citrus_trade.stg_trade, now model.citrus_trade.importer)
[0m21:28:07.334726 [debug] [Thread-1 (]: Began compiling node model.citrus_trade.importer
[0m21:28:07.334118 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.citrus_trade.importer_by_year'
[0m21:28:07.333355 [debug] [Thread-2 (]: Began compiling node model.citrus_trade.exporter
[0m21:28:07.341335 [debug] [Thread-1 (]: Writing injected SQL for node "model.citrus_trade.importer"
[0m21:28:07.342092 [debug] [Thread-4 (]: Began compiling node model.citrus_trade.importer_by_year
[0m21:28:07.345675 [debug] [Thread-2 (]: Writing injected SQL for node "model.citrus_trade.exporter"
[0m21:28:07.350753 [debug] [Thread-4 (]: Writing injected SQL for node "model.citrus_trade.importer_by_year"
[0m21:28:07.352150 [debug] [Thread-1 (]: Began executing node model.citrus_trade.importer
[0m21:28:07.372958 [debug] [Thread-1 (]: Writing runtime sql for node "model.citrus_trade.importer"
[0m21:28:07.373337 [debug] [Thread-2 (]: Began executing node model.citrus_trade.exporter
[0m21:28:07.373645 [debug] [Thread-4 (]: Began executing node model.citrus_trade.importer_by_year
[0m21:28:07.376346 [debug] [Thread-2 (]: Writing runtime sql for node "model.citrus_trade.exporter"
[0m21:28:07.378450 [debug] [Thread-4 (]: Writing runtime sql for node "model.citrus_trade.importer_by_year"
[0m21:28:07.379759 [debug] [Thread-1 (]: Using snowflake connection "model.citrus_trade.importer"
[0m21:28:07.380380 [debug] [Thread-1 (]: On model.citrus_trade.importer: create or replace   view TRHS.visualisation.importer
  
  
  
  
  as (
    with base as (
    select
        declarant_iso,
        sum(total_value) as total_value,
        sum(total_quantity) as total_quantity,
        sum(total_value)/nullif(sum(total_quantity),0) as value_per_quantity
    from TRHS.analytics.trade_by_reporter
    where flow = 1
    group by 1 
)

    select 
        declarant_iso,
        metric_type,
        metric_value
    from base
    unpivot(
        metric_value for metric_type in (
            total_value,
            total_quantity,
            value_per_quantity
        )
    )
  )
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.importer"} */;
[0m21:28:07.382086 [debug] [Thread-4 (]: Using snowflake connection "model.citrus_trade.importer_by_year"
[0m21:28:07.383628 [debug] [Thread-4 (]: On model.citrus_trade.importer_by_year: create or replace   view TRHS.visualisation.importer_by_year
  
  
  
  
  as (
    with base as (
    select
        declarant_iso,
        year,
        sum(total_value) as total_value,
        sum(total_quantity) as total_quantity,
        sum(total_value)/nullif(sum(total_quantity),0) as value_per_quantity
    from TRHS.analytics.trade_by_reporter
    where flow = 1
    group by 1,2
)

    select 
        declarant_iso,
        year,
        metric_type,
        metric_value
    from base
    unpivot(
        metric_value for metric_type in (
            total_value,
            total_quantity,
            value_per_quantity
        )
    )
  )
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.importer_by_year"} */;
[0m21:28:07.384224 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m21:28:07.383091 [debug] [Thread-2 (]: Using snowflake connection "model.citrus_trade.exporter"
[0m21:28:07.387780 [debug] [Thread-2 (]: On model.citrus_trade.exporter: create or replace   view TRHS.visualisation.exporter
  
  
  
  
  as (
    with base as (
    select
        declarant_iso,
        sum(total_value) as total_value,
        sum(total_quantity) as total_quantity,
        sum(total_value)/nullif(sum(total_quantity),0) as value_per_quantity
    from TRHS.analytics.trade_by_reporter
    where flow = 2
    group by 1 
)

    select 
        declarant_iso,
        metric_type,
        metric_value
    from base
    unpivot(
        metric_value for metric_type in (
            total_value,
            total_quantity,
            value_per_quantity
        )
    )
  )
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.exporter"} */;
[0m21:28:07.568395 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.187 seconds
[0m21:28:07.570914 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd59bab27-8ab7-4688-a391-6174c07deaa5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89dd8500>]}
[0m21:28:07.572107 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.183 seconds
[0m21:28:07.572706 [info ] [Thread-1 (]: 4 of 5 OK created sql view model visualisation.importer ........................ [[32mSUCCESS 1[0m in 0.24s]
[0m21:28:07.574732 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd59bab27-8ab7-4688-a391-6174c07deaa5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80d47f80>]}
[0m21:28:07.575353 [debug] [Thread-1 (]: Finished running node model.citrus_trade.importer
[0m21:28:07.575963 [info ] [Thread-2 (]: 3 of 5 OK created sql view model visualisation.exporter ........................ [[32mSUCCESS 1[0m in 0.24s]
[0m21:28:07.576869 [debug] [Thread-2 (]: Finished running node model.citrus_trade.exporter
[0m21:28:07.847972 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.464 seconds
[0m21:28:07.852148 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd59bab27-8ab7-4688-a391-6174c07deaa5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80d247d0>]}
[0m21:28:07.853642 [info ] [Thread-4 (]: 5 of 5 OK created sql view model visualisation.importer_by_year ................ [[32mSUCCESS 1[0m in 0.52s]
[0m21:28:07.855299 [debug] [Thread-4 (]: Finished running node model.citrus_trade.importer_by_year
[0m21:28:07.858338 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:28:07.858947 [debug] [MainThread]: Connection 'model.citrus_trade.importer' was left open.
[0m21:28:07.859548 [debug] [MainThread]: On model.citrus_trade.importer: Close
[0m21:28:07.959230 [debug] [MainThread]: Connection 'model.citrus_trade.exporter' was left open.
[0m21:28:07.960313 [debug] [MainThread]: On model.citrus_trade.exporter: Close
[0m21:28:08.070817 [debug] [MainThread]: Connection 'model.citrus_trade.trade_by_reporter' was left open.
[0m21:28:08.072097 [debug] [MainThread]: On model.citrus_trade.trade_by_reporter: Close
[0m21:28:08.164961 [debug] [MainThread]: Connection 'model.citrus_trade.importer_by_year' was left open.
[0m21:28:08.166190 [debug] [MainThread]: On model.citrus_trade.importer_by_year: Close
[0m21:28:08.293759 [info ] [MainThread]: 
[0m21:28:08.295724 [info ] [MainThread]: Finished running 2 table models, 3 view models in 0 hours 0 minutes and 4.75 seconds (4.75s).
[0m21:28:08.298332 [debug] [MainThread]: Command end result
[0m21:28:08.366778 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m21:28:08.368490 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m21:28:08.372664 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt/target/run_results.json
[0m21:28:08.372876 [info ] [MainThread]: 
[0m21:28:08.373105 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:28:08.373341 [info ] [MainThread]: 
[0m21:28:08.373706 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=5
[0m21:28:08.374436 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.5061216, "process_in_blocks": "0", "process_kernel_time": 0.583831, "process_mem_max_rss": "172876", "process_out_blocks": "4138", "process_user_time": 2.057925}
[0m21:28:08.374759 [debug] [MainThread]: Command `dbt run` succeeded at 21:28:08.374686 after 5.51 seconds
[0m21:28:08.375022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8eef1820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ca47aa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90d94e90>]}
[0m21:28:08.375238 [debug] [MainThread]: Flushing usage events
[0m21:28:09.115802 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:35:56.510559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa61fbc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa97d87d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa61f4a0>]}


============================== 21:35:56.513948 | b4fb8476-7aeb-48db-a760-40b3bd544b4a ==============================
[0m21:35:56.513948 [info ] [MainThread]: Running with dbt=1.10.13
[0m21:35:56.514340 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'indirect_selection': 'eager', 'log_path': '/app/dbt/logs', 'profiles_dir': '/app/dbt', 'fail_fast': 'False', 'empty': 'False', 'static_parser': 'True', 'log_cache_events': 'False', 'version_check': 'True', 'target_path': 'None', 'log_format': 'default', 'partial_parse': 'True', 'quiet': 'False', 'introspect': 'True', 'use_colors': 'True', 'no_print': 'None', 'cache_selected_only': 'False', 'invocation_command': 'dbt run', 'printer_width': '80', 'warn_error': 'None', 'debug': 'False', 'use_experimental_parser': 'False'}
[0m21:35:56.740317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b4fb8476-7aeb-48db-a760-40b3bd544b4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7f90c50>]}
[0m21:35:56.771373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b4fb8476-7aeb-48db-a760-40b3bd544b4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa95874a0>]}
[0m21:35:56.771919 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m21:35:56.821184 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m21:35:56.938879 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m21:35:56.939297 [debug] [MainThread]: Partial parsing: updated file: citrus_trade://models/visualisation/importer.sql
[0m21:35:56.939490 [debug] [MainThread]: Partial parsing: updated file: citrus_trade://models/visualisation/importer_by_year.sql
[0m21:35:56.939662 [debug] [MainThread]: Partial parsing: updated file: citrus_trade://models/visualisation/exporter.sql
[0m21:35:57.069929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b4fb8476-7aeb-48db-a760-40b3bd544b4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7bc66c0>]}
[0m21:35:57.125083 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m21:35:57.126556 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m21:35:57.135610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b4fb8476-7aeb-48db-a760-40b3bd544b4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7d7ea50>]}
[0m21:35:57.135975 [info ] [MainThread]: Found 5 models, 1 source, 632 macros
[0m21:35:57.136241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b4fb8476-7aeb-48db-a760-40b3bd544b4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7bd4260>]}
[0m21:35:57.137392 [info ] [MainThread]: 
[0m21:35:57.137645 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:35:57.138022 [info ] [MainThread]: 
[0m21:35:57.138457 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:35:57.141050 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRHS'
[0m21:35:57.147448 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRHS'
[0m21:35:57.150149 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRHS'
[0m21:35:57.168494 [debug] [ThreadPool]: Using snowflake connection "list_TRHS"
[0m21:35:57.168929 [debug] [ThreadPool]: Using snowflake connection "list_TRHS"
[0m21:35:57.169154 [debug] [ThreadPool]: Using snowflake connection "list_TRHS"
[0m21:35:57.169348 [debug] [ThreadPool]: On list_TRHS: show terse schemas in database TRHS
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS"} */
[0m21:35:57.169764 [debug] [ThreadPool]: On list_TRHS: show terse schemas in database TRHS
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS"} */
[0m21:35:57.170012 [debug] [ThreadPool]: On list_TRHS: show terse schemas in database TRHS
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS"} */
[0m21:35:57.170255 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:35:57.170454 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:35:57.170665 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:36:00.113499 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.942 seconds
[0m21:36:00.140637 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.970 seconds
[0m21:36:00.943857 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 3.773 seconds
[0m21:36:00.953109 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRHS, now list_TRHS_staging)
[0m21:36:00.954284 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRHS, now list_TRHS_analytics)
[0m21:36:00.966605 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRHS, now list_TRHS_visualisation)
[0m21:36:00.974049 [debug] [ThreadPool]: Using snowflake connection "list_TRHS_staging"
[0m21:36:00.978255 [debug] [ThreadPool]: Using snowflake connection "list_TRHS_analytics"
[0m21:36:00.980759 [debug] [ThreadPool]: Using snowflake connection "list_TRHS_visualisation"
[0m21:36:00.981149 [debug] [ThreadPool]: On list_TRHS_staging: show objects in TRHS.staging
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS_staging"} */;
[0m21:36:00.981548 [debug] [ThreadPool]: On list_TRHS_analytics: show objects in TRHS.analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS_analytics"} */;
[0m21:36:00.981968 [debug] [ThreadPool]: On list_TRHS_visualisation: show objects in TRHS.visualisation
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS_visualisation"} */;
[0m21:36:01.069670 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.087 seconds
[0m21:36:01.076314 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.092 seconds
[0m21:36:01.080690 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.096 seconds
[0m21:36:01.083842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b4fb8476-7aeb-48db-a760-40b3bd544b4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac0c91f0>]}
[0m21:36:01.090470 [debug] [Thread-1 (]: Began running node model.citrus_trade.stg_trade
[0m21:36:01.091226 [info ] [Thread-1 (]: 1 of 5 START sql table model staging.stg_trade ................................. [RUN]
[0m21:36:01.091958 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_TRHS_visualisation, now model.citrus_trade.stg_trade)
[0m21:36:01.092710 [debug] [Thread-1 (]: Began compiling node model.citrus_trade.stg_trade
[0m21:36:01.102564 [debug] [Thread-1 (]: Writing injected SQL for node "model.citrus_trade.stg_trade"
[0m21:36:01.104299 [debug] [Thread-1 (]: Began executing node model.citrus_trade.stg_trade
[0m21:36:01.129915 [debug] [Thread-1 (]: Writing runtime sql for node "model.citrus_trade.stg_trade"
[0m21:36:01.131434 [debug] [Thread-1 (]: Using snowflake connection "model.citrus_trade.stg_trade"
[0m21:36:01.131726 [debug] [Thread-1 (]: On model.citrus_trade.stg_trade: create or replace transient table TRHS.staging.stg_trade
    
    
    
    as (select
  value:DECLARANT::int as declarant,
  value:DECLARANT_ISO::string as declarant_iso,
  value:PARTNER::string as partner,
  value:PARTNER_ISO::string as partner_iso,
  value:FLOW::int as flow,
  value:TRANSPORT_MODE::int as transport_mode,
  value:PERIOD::int as period,
  value:HS4::string as hs4,
  value:HS4_NAME::string as hs4_name,
  value:HS6::string as hs6,
  value:HS6_NAME::string as hs6_name,
  value:VALUE_IN_EUROS::float as value_in_euros,
  value:QUANTITY_IN_KG::float as quantity_in_kg
from trhs.staging.citrus_ext
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.stg_trade"} */;
[0m21:36:02.017760 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.885 seconds
[0m21:36:02.059182 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b4fb8476-7aeb-48db-a760-40b3bd544b4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffabff1520>]}
[0m21:36:02.060681 [info ] [Thread-1 (]: 1 of 5 OK created sql table model staging.stg_trade ............................ [[32mSUCCESS 1[0m in 0.97s]
[0m21:36:02.061810 [debug] [Thread-1 (]: Finished running node model.citrus_trade.stg_trade
[0m21:36:02.063475 [debug] [Thread-3 (]: Began running node model.citrus_trade.trade_by_reporter
[0m21:36:02.064049 [info ] [Thread-3 (]: 2 of 5 START sql table model analytics.trade_by_reporter ....................... [RUN]
[0m21:36:02.064634 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_TRHS_staging, now model.citrus_trade.trade_by_reporter)
[0m21:36:02.065079 [debug] [Thread-3 (]: Began compiling node model.citrus_trade.trade_by_reporter
[0m21:36:02.072393 [debug] [Thread-3 (]: Writing injected SQL for node "model.citrus_trade.trade_by_reporter"
[0m21:36:02.075574 [debug] [Thread-3 (]: Began executing node model.citrus_trade.trade_by_reporter
[0m21:36:02.079020 [debug] [Thread-3 (]: Writing runtime sql for node "model.citrus_trade.trade_by_reporter"
[0m21:36:02.080562 [debug] [Thread-3 (]: Using snowflake connection "model.citrus_trade.trade_by_reporter"
[0m21:36:02.080940 [debug] [Thread-3 (]: On model.citrus_trade.trade_by_reporter: create or replace transient table TRHS.analytics.trade_by_reporter
    
    
    
    as (select 
    declarant,
    declarant_iso,
    partner,
    partner_iso,
    flow,
    transport_mode,
    year(to_date(left(period,4),'YYYY')) as year,
    period,
    hs6,
    hs6_name,
    sum(value_in_euros) as total_value,
    sum(quantity_in_kg) as total_quantity
from TRHS.staging.stg_trade
group by 1,2,3,4,5,6,7,8,9,10
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.trade_by_reporter"} */;
[0m21:36:02.713438 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.632 seconds
[0m21:36:02.719601 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b4fb8476-7aeb-48db-a760-40b3bd544b4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4bd42f0>]}
[0m21:36:02.721253 [info ] [Thread-3 (]: 2 of 5 OK created sql table model analytics.trade_by_reporter .................. [[32mSUCCESS 1[0m in 0.65s]
[0m21:36:02.722405 [debug] [Thread-3 (]: Finished running node model.citrus_trade.trade_by_reporter
[0m21:36:02.724662 [debug] [Thread-2 (]: Began running node model.citrus_trade.exporter
[0m21:36:02.725438 [debug] [Thread-1 (]: Began running node model.citrus_trade.importer
[0m21:36:02.726247 [info ] [Thread-2 (]: 3 of 5 START sql view model visualisation.exporter ............................. [RUN]
[0m21:36:02.726949 [debug] [Thread-4 (]: Began running node model.citrus_trade.importer_by_year
[0m21:36:02.727725 [info ] [Thread-1 (]: 4 of 5 START sql view model visualisation.importer ............................. [RUN]
[0m21:36:02.728804 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_TRHS_analytics, now model.citrus_trade.exporter)
[0m21:36:02.729735 [info ] [Thread-4 (]: 5 of 5 START sql view model visualisation.importer_by_year ..................... [RUN]
[0m21:36:02.730540 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.citrus_trade.stg_trade, now model.citrus_trade.importer)
[0m21:36:02.731156 [debug] [Thread-2 (]: Began compiling node model.citrus_trade.exporter
[0m21:36:02.731892 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.citrus_trade.importer_by_year'
[0m21:36:02.732458 [debug] [Thread-1 (]: Began compiling node model.citrus_trade.importer
[0m21:36:02.736839 [debug] [Thread-2 (]: Writing injected SQL for node "model.citrus_trade.exporter"
[0m21:36:02.737562 [debug] [Thread-4 (]: Began compiling node model.citrus_trade.importer_by_year
[0m21:36:02.744014 [debug] [Thread-1 (]: Writing injected SQL for node "model.citrus_trade.importer"
[0m21:36:02.747771 [debug] [Thread-4 (]: Writing injected SQL for node "model.citrus_trade.importer_by_year"
[0m21:36:02.749206 [debug] [Thread-2 (]: Began executing node model.citrus_trade.exporter
[0m21:36:02.761351 [debug] [Thread-1 (]: Began executing node model.citrus_trade.importer
[0m21:36:02.761685 [debug] [Thread-4 (]: Began executing node model.citrus_trade.importer_by_year
[0m21:36:02.772610 [debug] [Thread-2 (]: Writing runtime sql for node "model.citrus_trade.exporter"
[0m21:36:02.774989 [debug] [Thread-1 (]: Writing runtime sql for node "model.citrus_trade.importer"
[0m21:36:02.777104 [debug] [Thread-4 (]: Writing runtime sql for node "model.citrus_trade.importer_by_year"
[0m21:36:02.778730 [debug] [Thread-2 (]: Using snowflake connection "model.citrus_trade.exporter"
[0m21:36:02.779108 [debug] [Thread-2 (]: On model.citrus_trade.exporter: create or replace   view TRHS.visualisation.exporter
  
  
  
  
  as (
    select
    declarant_iso,
    sum(total_value) as total_value,
    sum(total_quantity) as total_quantity,
    sum(total_value)/nullif(sum(total_quantity),0) as value_per_quantity
from TRHS.analytics.trade_by_reporter
where flow = 2
group by 1
  )
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.exporter"} */;
[0m21:36:02.779616 [debug] [Thread-1 (]: Using snowflake connection "model.citrus_trade.importer"
[0m21:36:02.780137 [debug] [Thread-4 (]: Using snowflake connection "model.citrus_trade.importer_by_year"
[0m21:36:02.781796 [debug] [Thread-4 (]: On model.citrus_trade.importer_by_year: create or replace   view TRHS.visualisation.importer_by_year
  
  
  
  
  as (
    select
    declarant_iso,
    year,
    sum(total_value) as total_value,
    sum(total_quantity) as total_quantity,
    sum(total_value)/nullif(sum(total_quantity),0) as value_per_quantity
from TRHS.analytics.trade_by_reporter
where flow = 1
group by 1,2
  )
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.importer_by_year"} */;
[0m21:36:02.782114 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m21:36:02.781415 [debug] [Thread-1 (]: On model.citrus_trade.importer: create or replace   view TRHS.visualisation.importer
  
  
  
  
  as (
    select
    declarant_iso,
    sum(total_value) as total_value,
    sum(total_quantity) as total_quantity,
    sum(total_value)/nullif(sum(total_quantity),0) as value_per_quantity
from TRHS.analytics.trade_by_reporter
where flow = 1
group by 1
  )
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.importer"} */;
[0m21:36:03.021397 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.241 seconds
[0m21:36:03.024363 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b4fb8476-7aeb-48db-a760-40b3bd544b4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ebb6450>]}
[0m21:36:03.025335 [info ] [Thread-2 (]: 3 of 5 OK created sql view model visualisation.exporter ........................ [[32mSUCCESS 1[0m in 0.30s]
[0m21:36:03.026539 [debug] [Thread-2 (]: Finished running node model.citrus_trade.exporter
[0m21:36:03.027859 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.237 seconds
[0m21:36:03.030103 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b4fb8476-7aeb-48db-a760-40b3bd544b4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4bc8560>]}
[0m21:36:03.030766 [info ] [Thread-1 (]: 4 of 5 OK created sql view model visualisation.importer ........................ [[32mSUCCESS 1[0m in 0.30s]
[0m21:36:03.031421 [debug] [Thread-1 (]: Finished running node model.citrus_trade.importer
[0m21:36:03.268643 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.486 seconds
[0m21:36:03.273423 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b4fb8476-7aeb-48db-a760-40b3bd544b4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9eb5abd0>]}
[0m21:36:03.275040 [info ] [Thread-4 (]: 5 of 5 OK created sql view model visualisation.importer_by_year ................ [[32mSUCCESS 1[0m in 0.54s]
[0m21:36:03.276436 [debug] [Thread-4 (]: Finished running node model.citrus_trade.importer_by_year
[0m21:36:03.279922 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:36:03.280744 [debug] [MainThread]: Connection 'model.citrus_trade.trade_by_reporter' was left open.
[0m21:36:03.281397 [debug] [MainThread]: On model.citrus_trade.trade_by_reporter: Close
[0m21:36:03.371450 [debug] [MainThread]: Connection 'model.citrus_trade.importer' was left open.
[0m21:36:03.372597 [debug] [MainThread]: On model.citrus_trade.importer: Close
[0m21:36:03.532637 [debug] [MainThread]: Connection 'model.citrus_trade.exporter' was left open.
[0m21:36:03.533399 [debug] [MainThread]: On model.citrus_trade.exporter: Close
[0m21:36:03.632274 [debug] [MainThread]: Connection 'model.citrus_trade.importer_by_year' was left open.
[0m21:36:03.633246 [debug] [MainThread]: On model.citrus_trade.importer_by_year: Close
[0m21:36:03.780733 [info ] [MainThread]: 
[0m21:36:03.781186 [info ] [MainThread]: Finished running 2 table models, 3 view models in 0 hours 0 minutes and 6.64 seconds (6.64s).
[0m21:36:03.782068 [debug] [MainThread]: Command end result
[0m21:36:03.821436 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m21:36:03.823480 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m21:36:03.827572 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt/target/run_results.json
[0m21:36:03.827752 [info ] [MainThread]: 
[0m21:36:03.827991 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:36:03.828245 [info ] [MainThread]: 
[0m21:36:03.828551 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=5
[0m21:36:03.829818 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.3505554, "process_in_blocks": "0", "process_kernel_time": 0.486963, "process_mem_max_rss": "173320", "process_out_blocks": "4121", "process_user_time": 2.023398}
[0m21:36:03.830218 [debug] [MainThread]: Command `dbt run` succeeded at 21:36:03.830148 after 7.35 seconds
[0m21:36:03.830522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac354350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa61c4a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7d7dd30>]}
[0m21:36:03.830734 [debug] [MainThread]: Flushing usage events
[0m21:36:04.526301 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:45:48.603974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88510bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff884d5be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff884d6960>]}


============================== 11:45:48.614746 | f1e9acfd-0507-4fcb-853c-031485513020 ==============================
[0m11:45:48.614746 [info ] [MainThread]: Running with dbt=1.10.13
[0m11:45:48.615169 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'log_path': '/app/dbt/logs', 'static_parser': 'True', 'use_colors': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'debug': 'False', 'use_experimental_parser': 'False', 'introspect': 'True', 'empty': 'False', 'warn_error': 'None', 'printer_width': '80', 'log_cache_events': 'False', 'target_path': 'None', 'quiet': 'False', 'partial_parse': 'True', 'fail_fast': 'False', 'cache_selected_only': 'False', 'write_json': 'True', 'profiles_dir': '/app/dbt', 'log_format': 'default', 'no_print': 'None'}
[0m11:45:48.906529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f1e9acfd-0507-4fcb-853c-031485513020', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86ccf080>]}
[0m11:45:48.937948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f1e9acfd-0507-4fcb-853c-031485513020', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88510b60>]}
[0m11:45:48.938421 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m11:45:48.994762 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m11:45:49.081493 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m11:45:49.081870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f1e9acfd-0507-4fcb-853c-031485513020', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86319310>]}
[0m11:45:49.745514 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.citrus_trade.import_by_year' (models/analytics/import_by_year.sql) depends on a node named 'trade_by_reporter' which was not found
[0m11:45:49.747178 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.1770626, "process_in_blocks": "0", "process_kernel_time": 0.5681, "process_mem_max_rss": "133100", "process_out_blocks": "5", "process_user_time": 1.7013}
[0m11:45:49.747486 [debug] [MainThread]: Command `dbt run` failed at 11:45:49.747415 after 1.18 seconds
[0m11:45:49.747745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8837f0b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8624a420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88fb66f0>]}
[0m11:45:49.747956 [debug] [MainThread]: Flushing usage events
[0m11:45:51.041648 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:46:12.441699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff982089b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff981ca690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff981c9970>]}


============================== 11:46:12.443688 | 4cb00e83-8d0c-4eec-be7c-bb7d66e6bd74 ==============================
[0m11:46:12.443688 [info ] [MainThread]: Running with dbt=1.10.13
[0m11:46:12.443982 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '/app/dbt', 'printer_width': '80', 'debug': 'False', 'static_parser': 'True', 'version_check': 'True', 'log_format': 'default', 'introspect': 'True', 'cache_selected_only': 'False', 'no_print': 'None', 'partial_parse': 'True', 'indirect_selection': 'eager', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'use_experimental_parser': 'False', 'target_path': 'None', 'log_path': '/app/dbt/logs', 'use_colors': 'True', 'quiet': 'False', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'empty': 'False', 'log_cache_events': 'False', 'fail_fast': 'False'}
[0m11:46:12.625377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4cb00e83-8d0c-4eec-be7c-bb7d66e6bd74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a2ae4b0>]}
[0m11:46:12.655180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4cb00e83-8d0c-4eec-be7c-bb7d66e6bd74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9666f6e0>]}
[0m11:46:12.655605 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m11:46:12.702244 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m11:46:12.781287 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m11:46:12.781646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '4cb00e83-8d0c-4eec-be7c-bb7d66e6bd74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96011460>]}
[0m11:46:13.491039 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.citrus_trade.visualisation
[0m11:46:13.496336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4cb00e83-8d0c-4eec-be7c-bb7d66e6bd74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95eaf200>]}
[0m11:46:13.537092 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m11:46:13.538493 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m11:46:13.550429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4cb00e83-8d0c-4eec-be7c-bb7d66e6bd74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95318470>]}
[0m11:46:13.550717 [info ] [MainThread]: Found 4 models, 1 source, 632 macros
[0m11:46:13.550933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4cb00e83-8d0c-4eec-be7c-bb7d66e6bd74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95721730>]}
[0m11:46:13.551909 [info ] [MainThread]: 
[0m11:46:13.552134 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:46:13.552345 [info ] [MainThread]: 
[0m11:46:13.552730 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:46:13.555406 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRHS'
[0m11:46:13.561739 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRHS'
[0m11:46:13.586932 [debug] [ThreadPool]: Using snowflake connection "list_TRHS"
[0m11:46:13.587248 [debug] [ThreadPool]: Using snowflake connection "list_TRHS"
[0m11:46:13.587415 [debug] [ThreadPool]: On list_TRHS: show terse schemas in database TRHS
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS"} */
[0m11:46:13.587615 [debug] [ThreadPool]: On list_TRHS: show terse schemas in database TRHS
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS"} */
[0m11:46:13.587782 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:46:13.587972 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:46:18.369815 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 4.781 seconds
[0m11:46:18.384637 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 4.797 seconds
[0m11:46:18.389211 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRHS, now list_TRHS_staging)
[0m11:46:18.396201 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRHS, now list_TRHS_analytics)
[0m11:46:18.415245 [debug] [ThreadPool]: Using snowflake connection "list_TRHS_staging"
[0m11:46:18.415776 [debug] [ThreadPool]: On list_TRHS_staging: show objects in TRHS.staging
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS_staging"} */;
[0m11:46:18.420787 [debug] [ThreadPool]: Using snowflake connection "list_TRHS_analytics"
[0m11:46:18.422519 [debug] [ThreadPool]: On list_TRHS_analytics: show objects in TRHS.analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS_analytics"} */;
[0m11:46:18.531048 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.110 seconds
[0m11:46:18.546679 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.124 seconds
[0m11:46:18.550519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4cb00e83-8d0c-4eec-be7c-bb7d66e6bd74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95f3ec00>]}
[0m11:46:18.557041 [debug] [Thread-1 (]: Began running node model.citrus_trade.stg_trade
[0m11:46:18.557854 [info ] [Thread-1 (]: 1 of 4 START sql table model staging.stg_trade ................................. [RUN]
[0m11:46:18.558620 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_TRHS_analytics, now model.citrus_trade.stg_trade)
[0m11:46:18.559411 [debug] [Thread-1 (]: Began compiling node model.citrus_trade.stg_trade
[0m11:46:18.568055 [debug] [Thread-1 (]: Writing injected SQL for node "model.citrus_trade.stg_trade"
[0m11:46:18.570004 [debug] [Thread-1 (]: Began executing node model.citrus_trade.stg_trade
[0m11:46:18.594722 [debug] [Thread-1 (]: Writing runtime sql for node "model.citrus_trade.stg_trade"
[0m11:46:18.596672 [debug] [Thread-1 (]: Using snowflake connection "model.citrus_trade.stg_trade"
[0m11:46:18.596975 [debug] [Thread-1 (]: On model.citrus_trade.stg_trade: create or replace transient table TRHS.staging.stg_trade
    
    
    
    as (select
  value:DECLARANT::int as declarant,
  value:DECLARANT_ISO::string as declarant_iso,
  value:PARTNER::string as partner,
  value:PARTNER_ISO::string as partner_iso,
  value:FLOW::int as flow,
  value:TRANSPORT_MODE::int as transport_mode,
  value:PERIOD::int as period,
  value:HS4::string as hs4,
  value:HS4_NAME::string as hs4_name,
  value:HS6::string as hs6,
  value:HS6_NAME::string as hs6_name,
  value:VALUE_IN_EUROS::float as value_in_euros,
  value:QUANTITY_IN_KG::float as quantity_in_kg
from trhs.staging.citrus_ext
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.stg_trade"} */;
[0m11:46:20.661036 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.063 seconds
[0m11:46:20.696835 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4cb00e83-8d0c-4eec-be7c-bb7d66e6bd74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a2ad700>]}
[0m11:46:20.697899 [info ] [Thread-1 (]: 1 of 4 OK created sql table model staging.stg_trade ............................ [[32mSUCCESS 1[0m in 2.14s]
[0m11:46:20.699290 [debug] [Thread-1 (]: Finished running node model.citrus_trade.stg_trade
[0m11:46:20.700386 [debug] [Thread-3 (]: Began running node model.citrus_trade.trade_by_declarant
[0m11:46:20.701031 [info ] [Thread-3 (]: 2 of 4 START sql table model analytics.trade_by_declarant ...................... [RUN]
[0m11:46:20.701691 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.citrus_trade.trade_by_declarant'
[0m11:46:20.702142 [debug] [Thread-3 (]: Began compiling node model.citrus_trade.trade_by_declarant
[0m11:46:20.705814 [debug] [Thread-3 (]: Writing injected SQL for node "model.citrus_trade.trade_by_declarant"
[0m11:46:20.708477 [debug] [Thread-3 (]: Began executing node model.citrus_trade.trade_by_declarant
[0m11:46:20.711058 [debug] [Thread-3 (]: Writing runtime sql for node "model.citrus_trade.trade_by_declarant"
[0m11:46:20.713150 [debug] [Thread-3 (]: Using snowflake connection "model.citrus_trade.trade_by_declarant"
[0m11:46:20.713498 [debug] [Thread-3 (]: On model.citrus_trade.trade_by_declarant: create or replace transient table TRHS.analytics.trade_by_declarant
    
    
    
    as (select 
    declarant,
    declarant_iso,
    partner,
    partner_iso,
    flow,
    transport_mode,
    year(to_date(left(period,4),'YYYY')) as year,
    period,
    hs6,
    hs6_name,
    sum(value_in_euros) as value,
    sum(quantity_in_kg) as quantity
from TRHS.staging.stg_trade
group by 1,2,3,4,5,6,7,8,9,10
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.trade_by_declarant"} */;
[0m11:46:20.713846 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m11:46:22.519821 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.806 seconds
[0m11:46:22.524728 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4cb00e83-8d0c-4eec-be7c-bb7d66e6bd74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e724c50>]}
[0m11:46:22.526340 [info ] [Thread-3 (]: 2 of 4 OK created sql table model analytics.trade_by_declarant ................. [[32mSUCCESS 1[0m in 1.82s]
[0m11:46:22.527965 [debug] [Thread-3 (]: Finished running node model.citrus_trade.trade_by_declarant
[0m11:46:22.529143 [debug] [Thread-2 (]: Began running node model.citrus_trade.import_by_year
[0m11:46:22.529620 [debug] [Thread-1 (]: Began running node model.citrus_trade.import_export_2022
[0m11:46:22.530110 [info ] [Thread-2 (]: 3 of 4 START sql table model analytics.import_by_year .......................... [RUN]
[0m11:46:22.531601 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_TRHS_staging, now model.citrus_trade.import_by_year)
[0m11:46:22.532047 [debug] [Thread-2 (]: Began compiling node model.citrus_trade.import_by_year
[0m11:46:22.530862 [info ] [Thread-1 (]: 4 of 4 START sql table model analytics.import_export_2022 ...................... [RUN]
[0m11:46:22.539246 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.citrus_trade.stg_trade, now model.citrus_trade.import_export_2022)
[0m11:46:22.539757 [debug] [Thread-1 (]: Began compiling node model.citrus_trade.import_export_2022
[0m11:46:22.538590 [debug] [Thread-2 (]: Writing injected SQL for node "model.citrus_trade.import_by_year"
[0m11:46:22.543552 [debug] [Thread-1 (]: Writing injected SQL for node "model.citrus_trade.import_export_2022"
[0m11:46:22.546767 [debug] [Thread-2 (]: Began executing node model.citrus_trade.import_by_year
[0m11:46:22.550623 [debug] [Thread-2 (]: Writing runtime sql for node "model.citrus_trade.import_by_year"
[0m11:46:22.551006 [debug] [Thread-1 (]: Began executing node model.citrus_trade.import_export_2022
[0m11:46:22.553951 [debug] [Thread-1 (]: Writing runtime sql for node "model.citrus_trade.import_export_2022"
[0m11:46:22.557860 [debug] [Thread-2 (]: Using snowflake connection "model.citrus_trade.import_by_year"
[0m11:46:22.559094 [debug] [Thread-1 (]: Using snowflake connection "model.citrus_trade.import_export_2022"
[0m11:46:22.559533 [debug] [Thread-2 (]: On model.citrus_trade.import_by_year: create or replace transient table TRHS.analytics.import_by_year
    
    
    
    as (select
    declarant_iso,
    year,
    sum(total_value) as total_value,
    sum(total_quantity) as total_quantity,
    sum(total_value)/nullif(sum(total_quantity),0) as value_per_quantity
from TRHS.analytics.trade_by_declarant
where flow = 1
and hs6 = '080510'
group by 1,2
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.import_by_year"} */;
[0m11:46:22.560068 [debug] [Thread-1 (]: On model.citrus_trade.import_export_2022: create or replace transient table TRHS.analytics.import_export_2022
    
    
    
    as (select
    declarant_iso,
    flow,
    sum(value) over(partition by declarant_iso, flow) as total_value,
    sum(quantity) over(partition by declarant_iso, flow) as total_quantity,
    total_value/nullif(total_quantity,0) as value_per_quantity
from TRHS.analytics.trade_by_declarant
where hs6 = '080510'
group by 1
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.import_export_2022"} */;
[0m11:46:22.662282 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01c02fe2-0105-6ef9-0000-000420caeb95
[0m11:46:22.663053 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 8 at position 8
invalid identifier 'TOTAL_VALUE'
[0m11:46:22.669391 [debug] [Thread-2 (]: Database Error in model import_by_year (models/analytics/import_by_year.sql)
  000904 (42000): SQL compilation error: error line 8 at position 8
  invalid identifier 'TOTAL_VALUE'
  compiled code at target/run/citrus_trade/models/analytics/import_by_year.sql
[0m11:46:22.670202 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4cb00e83-8d0c-4eec-be7c-bb7d66e6bd74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e704800>]}
[0m11:46:22.671116 [error] [Thread-2 (]: 3 of 4 ERROR creating sql table model analytics.import_by_year ................. [[31mERROR[0m in 0.14s]
[0m11:46:22.671809 [debug] [Thread-2 (]: Finished running node model.citrus_trade.import_by_year
[0m11:46:22.673432 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01c02fe2-0105-6ef9-0000-000420caeb99
[0m11:46:22.674110 [debug] [Thread-7 (]: Marking all children of 'model.citrus_trade.import_by_year' to be skipped because of status 'error'.  Reason: Database Error in model import_by_year (models/analytics/import_by_year.sql)
  000904 (42000): SQL compilation error: error line 8 at position 8
  invalid identifier 'TOTAL_VALUE'
  compiled code at target/run/citrus_trade/models/analytics/import_by_year.sql.
[0m11:46:22.674598 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000979 (42601): SQL compilation error:
[TRADE_BY_DECLARANT.VALUE] is not a valid group by expression
[0m11:46:22.679540 [debug] [Thread-1 (]: Database Error in model import_export_2022 (models/analytics/import_export_2022.sql)
  000979 (42601): SQL compilation error:
  [TRADE_BY_DECLARANT.VALUE] is not a valid group by expression
  compiled code at target/run/citrus_trade/models/analytics/import_export_2022.sql
[0m11:46:22.680116 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4cb00e83-8d0c-4eec-be7c-bb7d66e6bd74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e704440>]}
[0m11:46:22.680903 [error] [Thread-1 (]: 4 of 4 ERROR creating sql table model analytics.import_export_2022 ............. [[31mERROR[0m in 0.14s]
[0m11:46:22.681769 [debug] [Thread-1 (]: Finished running node model.citrus_trade.import_export_2022
[0m11:46:22.682465 [debug] [Thread-7 (]: Marking all children of 'model.citrus_trade.import_export_2022' to be skipped because of status 'error'.  Reason: Database Error in model import_export_2022 (models/analytics/import_export_2022.sql)
  000979 (42601): SQL compilation error:
  [TRADE_BY_DECLARANT.VALUE] is not a valid group by expression
  compiled code at target/run/citrus_trade/models/analytics/import_export_2022.sql.
[0m11:46:22.684150 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:46:22.684515 [debug] [MainThread]: Connection 'model.citrus_trade.import_by_year' was left open.
[0m11:46:22.684864 [debug] [MainThread]: On model.citrus_trade.import_by_year: Close
[0m11:46:22.806945 [debug] [MainThread]: Connection 'model.citrus_trade.import_export_2022' was left open.
[0m11:46:22.808349 [debug] [MainThread]: On model.citrus_trade.import_export_2022: Close
[0m11:46:22.949535 [debug] [MainThread]: Connection 'model.citrus_trade.trade_by_declarant' was left open.
[0m11:46:22.950947 [debug] [MainThread]: On model.citrus_trade.trade_by_declarant: Close
[0m11:46:23.091687 [info ] [MainThread]: 
[0m11:46:23.092900 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 9.54 seconds (9.54s).
[0m11:46:23.095873 [debug] [MainThread]: Command end result
[0m11:46:23.140886 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m11:46:23.142938 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m11:46:23.148402 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt/target/run_results.json
[0m11:46:23.148736 [info ] [MainThread]: 
[0m11:46:23.149054 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m11:46:23.149469 [info ] [MainThread]: 
[0m11:46:23.149805 [error] [MainThread]: [31mFailure in model import_by_year (models/analytics/import_by_year.sql)[0m
[0m11:46:23.150211 [error] [MainThread]:   Database Error in model import_by_year (models/analytics/import_by_year.sql)
  000904 (42000): SQL compilation error: error line 8 at position 8
  invalid identifier 'TOTAL_VALUE'
  compiled code at target/run/citrus_trade/models/analytics/import_by_year.sql
[0m11:46:23.150591 [info ] [MainThread]: 
[0m11:46:23.151083 [info ] [MainThread]:   compiled code at target/compiled/citrus_trade/models/analytics/import_by_year.sql
[0m11:46:23.151353 [info ] [MainThread]: 
[0m11:46:23.151721 [error] [MainThread]: [31mFailure in model import_export_2022 (models/analytics/import_export_2022.sql)[0m
[0m11:46:23.152331 [error] [MainThread]:   Database Error in model import_export_2022 (models/analytics/import_export_2022.sql)
  000979 (42601): SQL compilation error:
  [TRADE_BY_DECLARANT.VALUE] is not a valid group by expression
  compiled code at target/run/citrus_trade/models/analytics/import_export_2022.sql
[0m11:46:23.152670 [info ] [MainThread]: 
[0m11:46:23.153252 [info ] [MainThread]:   compiled code at target/compiled/citrus_trade/models/analytics/import_export_2022.sql
[0m11:46:23.153641 [info ] [MainThread]: 
[0m11:46:23.154173 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=2 SKIP=0 NO-OP=0 TOTAL=4
[0m11:46:23.155271 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 10.742899, "process_in_blocks": "0", "process_kernel_time": 0.993311, "process_mem_max_rss": "169280", "process_out_blocks": "9082", "process_user_time": 2.933163}
[0m11:46:23.155622 [debug] [MainThread]: Command `dbt run` failed at 11:46:23.155554 after 10.74 seconds
[0m11:46:23.155889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff984d6cf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95ecd670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95bc0b00>]}
[0m11:46:23.156134 [debug] [MainThread]: Flushing usage events
[0m11:46:24.399393 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:47:18.136367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8d73080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffab0854f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8d72f30>]}


============================== 11:47:18.138637 | 5f353ab6-7eaf-4bb2-b363-10509e65bf81 ==============================
[0m11:47:18.138637 [info ] [MainThread]: Running with dbt=1.10.13
[0m11:47:18.139010 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'debug': 'False', 'log_cache_events': 'False', 'log_path': '/app/dbt/logs', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'quiet': 'False', 'static_parser': 'True', 'use_experimental_parser': 'False', 'warn_error': 'None', 'write_json': 'True', 'cache_selected_only': 'False', 'empty': 'False', 'printer_width': '80', 'use_colors': 'True', 'no_print': 'None', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'log_format': 'default', 'partial_parse': 'True', 'profiles_dir': '/app/dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m11:47:18.313533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5f353ab6-7eaf-4bb2-b363-10509e65bf81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa77b5520>]}
[0m11:47:18.343357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5f353ab6-7eaf-4bb2-b363-10509e65bf81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6f5e7e0>]}
[0m11:47:18.343763 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m11:47:18.390911 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m11:47:18.510587 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:47:18.510997 [debug] [MainThread]: Partial parsing: updated file: citrus_trade://models/analytics/import_by_year.sql
[0m11:47:18.635822 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.citrus_trade.visualisation
[0m11:47:18.642863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5f353ab6-7eaf-4bb2-b363-10509e65bf81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa67d3e60>]}
[0m11:47:18.685926 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m11:47:18.687269 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m11:47:18.694609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5f353ab6-7eaf-4bb2-b363-10509e65bf81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6b612e0>]}
[0m11:47:18.694863 [info ] [MainThread]: Found 4 models, 1 source, 632 macros
[0m11:47:18.695073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5f353ab6-7eaf-4bb2-b363-10509e65bf81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6bf0380>]}
[0m11:47:18.696049 [info ] [MainThread]: 
[0m11:47:18.696277 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:47:18.696494 [info ] [MainThread]: 
[0m11:47:18.696842 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:47:18.699409 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRHS'
[0m11:47:18.705463 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRHS'
[0m11:47:18.721393 [debug] [ThreadPool]: Using snowflake connection "list_TRHS"
[0m11:47:18.721709 [debug] [ThreadPool]: Using snowflake connection "list_TRHS"
[0m11:47:18.721835 [debug] [ThreadPool]: On list_TRHS: show terse schemas in database TRHS
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS"} */
[0m11:47:18.722029 [debug] [ThreadPool]: On list_TRHS: show terse schemas in database TRHS
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS"} */
[0m11:47:18.722244 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:47:18.722422 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:47:22.262850 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 3.539 seconds
[0m11:47:22.299502 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 3.577 seconds
[0m11:47:22.304946 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRHS, now list_TRHS_staging)
[0m11:47:22.305930 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRHS, now list_TRHS_analytics)
[0m11:47:22.324416 [debug] [ThreadPool]: Using snowflake connection "list_TRHS_staging"
[0m11:47:22.327007 [debug] [ThreadPool]: Using snowflake connection "list_TRHS_analytics"
[0m11:47:22.327498 [debug] [ThreadPool]: On list_TRHS_staging: show objects in TRHS.staging
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS_staging"} */;
[0m11:47:22.327907 [debug] [ThreadPool]: On list_TRHS_analytics: show objects in TRHS.analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS_analytics"} */;
[0m11:47:22.477356 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.149 seconds
[0m11:47:22.493620 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.164 seconds
[0m11:47:22.498185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5f353ab6-7eaf-4bb2-b363-10509e65bf81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6b41d60>]}
[0m11:47:22.505262 [debug] [Thread-1 (]: Began running node model.citrus_trade.stg_trade
[0m11:47:22.505991 [info ] [Thread-1 (]: 1 of 4 START sql table model staging.stg_trade ................................. [RUN]
[0m11:47:22.506626 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_TRHS_analytics, now model.citrus_trade.stg_trade)
[0m11:47:22.507222 [debug] [Thread-1 (]: Began compiling node model.citrus_trade.stg_trade
[0m11:47:22.519442 [debug] [Thread-1 (]: Writing injected SQL for node "model.citrus_trade.stg_trade"
[0m11:47:22.521413 [debug] [Thread-1 (]: Began executing node model.citrus_trade.stg_trade
[0m11:47:22.552797 [debug] [Thread-1 (]: Writing runtime sql for node "model.citrus_trade.stg_trade"
[0m11:47:22.554742 [debug] [Thread-1 (]: Using snowflake connection "model.citrus_trade.stg_trade"
[0m11:47:22.555049 [debug] [Thread-1 (]: On model.citrus_trade.stg_trade: create or replace transient table TRHS.staging.stg_trade
    
    
    
    as (select
  value:DECLARANT::int as declarant,
  value:DECLARANT_ISO::string as declarant_iso,
  value:PARTNER::string as partner,
  value:PARTNER_ISO::string as partner_iso,
  value:FLOW::int as flow,
  value:TRANSPORT_MODE::int as transport_mode,
  value:PERIOD::int as period,
  value:HS4::string as hs4,
  value:HS4_NAME::string as hs4_name,
  value:HS6::string as hs6,
  value:HS6_NAME::string as hs6_name,
  value:VALUE_IN_EUROS::float as value_in_euros,
  value:QUANTITY_IN_KG::float as quantity_in_kg
from trhs.staging.citrus_ext
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.stg_trade"} */;
[0m11:47:23.431178 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.876 seconds
[0m11:47:23.446143 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f353ab6-7eaf-4bb2-b363-10509e65bf81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa444d280>]}
[0m11:47:23.446794 [info ] [Thread-1 (]: 1 of 4 OK created sql table model staging.stg_trade ............................ [[32mSUCCESS 1[0m in 0.94s]
[0m11:47:23.447262 [debug] [Thread-1 (]: Finished running node model.citrus_trade.stg_trade
[0m11:47:23.447959 [debug] [Thread-3 (]: Began running node model.citrus_trade.trade_by_declarant
[0m11:47:23.448337 [info ] [Thread-3 (]: 2 of 4 START sql table model analytics.trade_by_declarant ...................... [RUN]
[0m11:47:23.448861 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.citrus_trade.trade_by_declarant'
[0m11:47:23.449132 [debug] [Thread-3 (]: Began compiling node model.citrus_trade.trade_by_declarant
[0m11:47:23.453026 [debug] [Thread-3 (]: Writing injected SQL for node "model.citrus_trade.trade_by_declarant"
[0m11:47:23.454099 [debug] [Thread-3 (]: Began executing node model.citrus_trade.trade_by_declarant
[0m11:47:23.455889 [debug] [Thread-3 (]: Writing runtime sql for node "model.citrus_trade.trade_by_declarant"
[0m11:47:23.457159 [debug] [Thread-3 (]: Using snowflake connection "model.citrus_trade.trade_by_declarant"
[0m11:47:23.457462 [debug] [Thread-3 (]: On model.citrus_trade.trade_by_declarant: create or replace transient table TRHS.analytics.trade_by_declarant
    
    
    
    as (select 
    declarant,
    declarant_iso,
    partner,
    partner_iso,
    flow,
    transport_mode,
    year(to_date(left(period,4),'YYYY')) as year,
    period,
    hs6,
    hs6_name,
    sum(value_in_euros) as value,
    sum(quantity_in_kg) as quantity
from TRHS.staging.stg_trade
group by 1,2,3,4,5,6,7,8,9,10
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.trade_by_declarant"} */;
[0m11:47:23.457709 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m11:47:25.420518 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.962 seconds
[0m11:47:25.427871 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f353ab6-7eaf-4bb2-b363-10509e65bf81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa539a6c0>]}
[0m11:47:25.428865 [info ] [Thread-3 (]: 2 of 4 OK created sql table model analytics.trade_by_declarant ................. [[32mSUCCESS 1[0m in 1.98s]
[0m11:47:25.429649 [debug] [Thread-3 (]: Finished running node model.citrus_trade.trade_by_declarant
[0m11:47:25.431213 [debug] [Thread-2 (]: Began running node model.citrus_trade.import_by_year
[0m11:47:25.431628 [debug] [Thread-1 (]: Began running node model.citrus_trade.import_export_2022
[0m11:47:25.432170 [info ] [Thread-2 (]: 3 of 4 START sql table model analytics.import_by_year .......................... [RUN]
[0m11:47:25.432838 [info ] [Thread-1 (]: 4 of 4 START sql table model analytics.import_export_2022 ...................... [RUN]
[0m11:47:25.433409 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_TRHS_staging, now model.citrus_trade.import_by_year)
[0m11:47:25.433816 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.citrus_trade.stg_trade, now model.citrus_trade.import_export_2022)
[0m11:47:25.434180 [debug] [Thread-2 (]: Began compiling node model.citrus_trade.import_by_year
[0m11:47:25.434519 [debug] [Thread-1 (]: Began compiling node model.citrus_trade.import_export_2022
[0m11:47:25.438823 [debug] [Thread-2 (]: Writing injected SQL for node "model.citrus_trade.import_by_year"
[0m11:47:25.441281 [debug] [Thread-1 (]: Writing injected SQL for node "model.citrus_trade.import_export_2022"
[0m11:47:25.442995 [debug] [Thread-2 (]: Began executing node model.citrus_trade.import_by_year
[0m11:47:25.446633 [debug] [Thread-2 (]: Writing runtime sql for node "model.citrus_trade.import_by_year"
[0m11:47:25.446914 [debug] [Thread-1 (]: Began executing node model.citrus_trade.import_export_2022
[0m11:47:25.449080 [debug] [Thread-1 (]: Writing runtime sql for node "model.citrus_trade.import_export_2022"
[0m11:47:25.450916 [debug] [Thread-2 (]: Using snowflake connection "model.citrus_trade.import_by_year"
[0m11:47:25.451386 [debug] [Thread-2 (]: On model.citrus_trade.import_by_year: create or replace transient table TRHS.analytics.import_by_year
    
    
    
    as (select
    declarant_iso,
    year,
    sum(value) as total_value,
    sum(quantity) as total_quantity,
    total_value/nullif(total_quantity,0) as value_per_quantity
from TRHS.analytics.trade_by_declarant
where flow = 1
and hs6 = '080510'
group by 1,2
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.import_by_year"} */;
[0m11:47:25.452503 [debug] [Thread-1 (]: Using snowflake connection "model.citrus_trade.import_export_2022"
[0m11:47:25.454253 [debug] [Thread-1 (]: On model.citrus_trade.import_export_2022: create or replace transient table TRHS.analytics.import_export_2022
    
    
    
    as (select
    declarant_iso,
    flow,
    sum(value) over(partition by declarant_iso, flow) as total_value,
    sum(quantity) over(partition by declarant_iso, flow) as total_quantity,
    total_value/nullif(total_quantity,0) as value_per_quantity
from TRHS.analytics.trade_by_declarant
where hs6 = '080510'
group by 1
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.import_export_2022"} */;
[0m11:47:25.603003 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01c02fe3-0105-6ef9-0000-000420caebb9
[0m11:47:25.603846 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000979 (42601): SQL compilation error:
[TRADE_BY_DECLARANT.VALUE] is not a valid group by expression
[0m11:47:25.609658 [debug] [Thread-1 (]: Database Error in model import_export_2022 (models/analytics/import_export_2022.sql)
  000979 (42601): SQL compilation error:
  [TRADE_BY_DECLARANT.VALUE] is not a valid group by expression
  compiled code at target/run/citrus_trade/models/analytics/import_export_2022.sql
[0m11:47:25.610638 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f353ab6-7eaf-4bb2-b363-10509e65bf81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa53a3cb0>]}
[0m11:47:25.611585 [error] [Thread-1 (]: 4 of 4 ERROR creating sql table model analytics.import_export_2022 ............. [[31mERROR[0m in 0.18s]
[0m11:47:25.612562 [debug] [Thread-1 (]: Finished running node model.citrus_trade.import_export_2022
[0m11:47:25.613516 [debug] [Thread-7 (]: Marking all children of 'model.citrus_trade.import_export_2022' to be skipped because of status 'error'.  Reason: Database Error in model import_export_2022 (models/analytics/import_export_2022.sql)
  000979 (42601): SQL compilation error:
  [TRADE_BY_DECLARANT.VALUE] is not a valid group by expression
  compiled code at target/run/citrus_trade/models/analytics/import_export_2022.sql.
[0m11:47:26.191355 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.739 seconds
[0m11:47:26.193481 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f353ab6-7eaf-4bb2-b363-10509e65bf81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ffa7e90>]}
[0m11:47:26.194059 [info ] [Thread-2 (]: 3 of 4 OK created sql table model analytics.import_by_year ..................... [[32mSUCCESS 1[0m in 0.76s]
[0m11:47:26.194598 [debug] [Thread-2 (]: Finished running node model.citrus_trade.import_by_year
[0m11:47:26.196252 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:47:26.196540 [debug] [MainThread]: Connection 'model.citrus_trade.import_by_year' was left open.
[0m11:47:26.196824 [debug] [MainThread]: On model.citrus_trade.import_by_year: Close
[0m11:47:26.345411 [debug] [MainThread]: Connection 'model.citrus_trade.import_export_2022' was left open.
[0m11:47:26.346277 [debug] [MainThread]: On model.citrus_trade.import_export_2022: Close
[0m11:47:26.490052 [debug] [MainThread]: Connection 'model.citrus_trade.trade_by_declarant' was left open.
[0m11:47:26.491144 [debug] [MainThread]: On model.citrus_trade.trade_by_declarant: Close
[0m11:47:26.624696 [info ] [MainThread]: 
[0m11:47:26.625782 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 7.93 seconds (7.93s).
[0m11:47:26.628171 [debug] [MainThread]: Command end result
[0m11:47:26.676004 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m11:47:26.679155 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m11:47:26.685936 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt/target/run_results.json
[0m11:47:26.686230 [info ] [MainThread]: 
[0m11:47:26.686531 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m11:47:26.686899 [info ] [MainThread]: 
[0m11:47:26.687264 [error] [MainThread]: [31mFailure in model import_export_2022 (models/analytics/import_export_2022.sql)[0m
[0m11:47:26.687690 [error] [MainThread]:   Database Error in model import_export_2022 (models/analytics/import_export_2022.sql)
  000979 (42601): SQL compilation error:
  [TRADE_BY_DECLARANT.VALUE] is not a valid group by expression
  compiled code at target/run/citrus_trade/models/analytics/import_export_2022.sql
[0m11:47:26.687881 [info ] [MainThread]: 
[0m11:47:26.688188 [info ] [MainThread]:   compiled code at target/compiled/citrus_trade/models/analytics/import_export_2022.sql
[0m11:47:26.688464 [info ] [MainThread]: 
[0m11:47:26.688898 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=4
[0m11:47:26.690110 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 8.581846, "process_in_blocks": "0", "process_kernel_time": 0.215606, "process_mem_max_rss": "165420", "process_out_blocks": "4103", "process_user_time": 1.712763}
[0m11:47:26.690511 [debug] [MainThread]: Command `dbt run` failed at 11:47:26.690443 after 8.58 seconds
[0m11:47:26.690812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad4b2900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6e784d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa53f7380>]}
[0m11:47:26.691048 [debug] [MainThread]: Flushing usage events
[0m11:47:27.978978 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:47:40.157377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8edc69c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e4e0f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e4e0ec0>]}


============================== 11:47:40.159720 | 1cdce045-59bc-401f-b819-aac004b97be5 ==============================
[0m11:47:40.159720 [info ] [MainThread]: Running with dbt=1.10.13
[0m11:47:40.160044 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'log_cache_events': 'False', 'empty': 'False', 'no_print': 'None', 'static_parser': 'True', 'debug': 'False', 'fail_fast': 'False', 'version_check': 'True', 'invocation_command': 'dbt run', 'printer_width': '80', 'use_experimental_parser': 'False', 'introspect': 'True', 'log_format': 'default', 'log_path': '/app/dbt/logs', 'use_colors': 'True', 'indirect_selection': 'eager', 'quiet': 'False', 'target_path': 'None', 'cache_selected_only': 'False', 'write_json': 'True', 'profiles_dir': '/app/dbt'}
[0m11:47:40.346565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1cdce045-59bc-401f-b819-aac004b97be5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c8832c0>]}
[0m11:47:40.378451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1cdce045-59bc-401f-b819-aac004b97be5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c8d6120>]}
[0m11:47:40.379171 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m11:47:40.429640 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m11:47:40.540802 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:47:40.541265 [debug] [MainThread]: Partial parsing: updated file: citrus_trade://models/analytics/import_export_2022.sql
[0m11:47:40.661411 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.citrus_trade.visualisation
[0m11:47:40.668250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1cdce045-59bc-401f-b819-aac004b97be5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c11c470>]}
[0m11:47:40.710824 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m11:47:40.712165 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m11:47:40.720208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1cdce045-59bc-401f-b819-aac004b97be5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c3f5190>]}
[0m11:47:40.720447 [info ] [MainThread]: Found 4 models, 1 source, 632 macros
[0m11:47:40.720649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1cdce045-59bc-401f-b819-aac004b97be5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c2dd700>]}
[0m11:47:40.721669 [info ] [MainThread]: 
[0m11:47:40.721958 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:47:40.722357 [info ] [MainThread]: 
[0m11:47:40.722920 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:47:40.725484 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRHS'
[0m11:47:40.731415 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRHS'
[0m11:47:40.747585 [debug] [ThreadPool]: Using snowflake connection "list_TRHS"
[0m11:47:40.747889 [debug] [ThreadPool]: Using snowflake connection "list_TRHS"
[0m11:47:40.748058 [debug] [ThreadPool]: On list_TRHS: show terse schemas in database TRHS
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS"} */
[0m11:47:40.748293 [debug] [ThreadPool]: On list_TRHS: show terse schemas in database TRHS
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS"} */
[0m11:47:40.748488 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:47:40.748684 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:47:42.406657 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.658 seconds
[0m11:47:42.408225 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.659 seconds
[0m11:47:42.416064 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRHS, now list_TRHS_staging)
[0m11:47:42.423725 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRHS, now list_TRHS_analytics)
[0m11:47:42.441856 [debug] [ThreadPool]: Using snowflake connection "list_TRHS_staging"
[0m11:47:42.445128 [debug] [ThreadPool]: Using snowflake connection "list_TRHS_analytics"
[0m11:47:42.445446 [debug] [ThreadPool]: On list_TRHS_staging: show objects in TRHS.staging
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS_staging"} */;
[0m11:47:42.445880 [debug] [ThreadPool]: On list_TRHS_analytics: show objects in TRHS.analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS_analytics"} */;
[0m11:47:42.551030 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.103 seconds
[0m11:47:42.568260 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.122 seconds
[0m11:47:42.571181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1cdce045-59bc-401f-b819-aac004b97be5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ea30320>]}
[0m11:47:42.575959 [debug] [Thread-1 (]: Began running node model.citrus_trade.stg_trade
[0m11:47:42.576564 [info ] [Thread-1 (]: 1 of 4 START sql table model staging.stg_trade ................................. [RUN]
[0m11:47:42.577157 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_TRHS_staging, now model.citrus_trade.stg_trade)
[0m11:47:42.577570 [debug] [Thread-1 (]: Began compiling node model.citrus_trade.stg_trade
[0m11:47:42.584226 [debug] [Thread-1 (]: Writing injected SQL for node "model.citrus_trade.stg_trade"
[0m11:47:42.585430 [debug] [Thread-1 (]: Began executing node model.citrus_trade.stg_trade
[0m11:47:42.608815 [debug] [Thread-1 (]: Writing runtime sql for node "model.citrus_trade.stg_trade"
[0m11:47:42.610911 [debug] [Thread-1 (]: Using snowflake connection "model.citrus_trade.stg_trade"
[0m11:47:42.611320 [debug] [Thread-1 (]: On model.citrus_trade.stg_trade: create or replace transient table TRHS.staging.stg_trade
    
    
    
    as (select
  value:DECLARANT::int as declarant,
  value:DECLARANT_ISO::string as declarant_iso,
  value:PARTNER::string as partner,
  value:PARTNER_ISO::string as partner_iso,
  value:FLOW::int as flow,
  value:TRANSPORT_MODE::int as transport_mode,
  value:PERIOD::int as period,
  value:HS4::string as hs4,
  value:HS4_NAME::string as hs4_name,
  value:HS6::string as hs6,
  value:HS6_NAME::string as hs6_name,
  value:VALUE_IN_EUROS::float as value_in_euros,
  value:QUANTITY_IN_KG::float as quantity_in_kg
from trhs.staging.citrus_ext
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.stg_trade"} */;
[0m11:47:43.421015 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.809 seconds
[0m11:47:43.438545 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1cdce045-59bc-401f-b819-aac004b97be5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ebcec60>]}
[0m11:47:43.439176 [info ] [Thread-1 (]: 1 of 4 OK created sql table model staging.stg_trade ............................ [[32mSUCCESS 1[0m in 0.86s]
[0m11:47:43.439635 [debug] [Thread-1 (]: Finished running node model.citrus_trade.stg_trade
[0m11:47:43.440447 [debug] [Thread-3 (]: Began running node model.citrus_trade.trade_by_declarant
[0m11:47:43.440796 [info ] [Thread-3 (]: 2 of 4 START sql table model analytics.trade_by_declarant ...................... [RUN]
[0m11:47:43.441288 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.citrus_trade.trade_by_declarant'
[0m11:47:43.441545 [debug] [Thread-3 (]: Began compiling node model.citrus_trade.trade_by_declarant
[0m11:47:43.445726 [debug] [Thread-3 (]: Writing injected SQL for node "model.citrus_trade.trade_by_declarant"
[0m11:47:43.447001 [debug] [Thread-3 (]: Began executing node model.citrus_trade.trade_by_declarant
[0m11:47:43.449103 [debug] [Thread-3 (]: Writing runtime sql for node "model.citrus_trade.trade_by_declarant"
[0m11:47:43.450394 [debug] [Thread-3 (]: Using snowflake connection "model.citrus_trade.trade_by_declarant"
[0m11:47:43.451038 [debug] [Thread-3 (]: On model.citrus_trade.trade_by_declarant: create or replace transient table TRHS.analytics.trade_by_declarant
    
    
    
    as (select 
    declarant,
    declarant_iso,
    partner,
    partner_iso,
    flow,
    transport_mode,
    year(to_date(left(period,4),'YYYY')) as year,
    period,
    hs6,
    hs6_name,
    sum(value_in_euros) as value,
    sum(quantity_in_kg) as quantity
from TRHS.staging.stg_trade
group by 1,2,3,4,5,6,7,8,9,10
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.trade_by_declarant"} */;
[0m11:47:43.451573 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m11:47:47.397363 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 3.945 seconds
[0m11:47:47.403448 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1cdce045-59bc-401f-b819-aac004b97be5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8adfe9f0>]}
[0m11:47:47.405003 [info ] [Thread-3 (]: 2 of 4 OK created sql table model analytics.trade_by_declarant ................. [[32mSUCCESS 1[0m in 3.96s]
[0m11:47:47.406217 [debug] [Thread-3 (]: Finished running node model.citrus_trade.trade_by_declarant
[0m11:47:47.407871 [debug] [Thread-2 (]: Began running node model.citrus_trade.import_by_year
[0m11:47:47.408501 [debug] [Thread-1 (]: Began running node model.citrus_trade.import_export_2022
[0m11:47:47.409365 [info ] [Thread-2 (]: 3 of 4 START sql table model analytics.import_by_year .......................... [RUN]
[0m11:47:47.411520 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_TRHS_analytics, now model.citrus_trade.import_by_year)
[0m11:47:47.412250 [debug] [Thread-2 (]: Began compiling node model.citrus_trade.import_by_year
[0m11:47:47.410534 [info ] [Thread-1 (]: 4 of 4 START sql table model analytics.import_export_2022 ...................... [RUN]
[0m11:47:47.417368 [debug] [Thread-2 (]: Writing injected SQL for node "model.citrus_trade.import_by_year"
[0m11:47:47.417967 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.citrus_trade.stg_trade, now model.citrus_trade.import_export_2022)
[0m11:47:47.418800 [debug] [Thread-1 (]: Began compiling node model.citrus_trade.import_export_2022
[0m11:47:47.422671 [debug] [Thread-1 (]: Writing injected SQL for node "model.citrus_trade.import_export_2022"
[0m11:47:47.423529 [debug] [Thread-2 (]: Began executing node model.citrus_trade.import_by_year
[0m11:47:47.426589 [debug] [Thread-2 (]: Writing runtime sql for node "model.citrus_trade.import_by_year"
[0m11:47:47.427623 [debug] [Thread-1 (]: Began executing node model.citrus_trade.import_export_2022
[0m11:47:47.433116 [debug] [Thread-1 (]: Writing runtime sql for node "model.citrus_trade.import_export_2022"
[0m11:47:47.434243 [debug] [Thread-2 (]: Using snowflake connection "model.citrus_trade.import_by_year"
[0m11:47:47.434745 [debug] [Thread-2 (]: On model.citrus_trade.import_by_year: create or replace transient table TRHS.analytics.import_by_year
    
    
    
    as (select
    declarant_iso,
    year,
    sum(value) as total_value,
    sum(quantity) as total_quantity,
    total_value/nullif(total_quantity,0) as value_per_quantity
from TRHS.analytics.trade_by_declarant
where flow = 1
and hs6 = '080510'
group by 1,2
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.import_by_year"} */;
[0m11:47:47.437143 [debug] [Thread-1 (]: Using snowflake connection "model.citrus_trade.import_export_2022"
[0m11:47:47.437503 [debug] [Thread-1 (]: On model.citrus_trade.import_export_2022: create or replace transient table TRHS.analytics.import_export_2022
    
    
    
    as (select
    declarant_iso,
    flow,
    sum(value) over(partition by declarant_iso, flow) as total_value,
    sum(quantity) over(partition by declarant_iso, flow) as total_quantity,
    total_value/nullif(total_quantity,0) as value_per_quantity
from TRHS.analytics.trade_by_declarant
where hs6 = '080510'
group by 1,2
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.import_export_2022"} */;
[0m11:47:47.554729 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01c02fe3-0105-6ef9-0000-000420caebd5
[0m11:47:47.555839 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000979 (42601): SQL compilation error:
[TRADE_BY_DECLARANT.VALUE] is not a valid group by expression
[0m11:47:47.561740 [debug] [Thread-1 (]: Database Error in model import_export_2022 (models/analytics/import_export_2022.sql)
  000979 (42601): SQL compilation error:
  [TRADE_BY_DECLARANT.VALUE] is not a valid group by expression
  compiled code at target/run/citrus_trade/models/analytics/import_export_2022.sql
[0m11:47:47.562536 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1cdce045-59bc-401f-b819-aac004b97be5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89bd9760>]}
[0m11:47:47.563711 [error] [Thread-1 (]: 4 of 4 ERROR creating sql table model analytics.import_export_2022 ............. [[31mERROR[0m in 0.14s]
[0m11:47:47.564576 [debug] [Thread-1 (]: Finished running node model.citrus_trade.import_export_2022
[0m11:47:47.565515 [debug] [Thread-7 (]: Marking all children of 'model.citrus_trade.import_export_2022' to be skipped because of status 'error'.  Reason: Database Error in model import_export_2022 (models/analytics/import_export_2022.sql)
  000979 (42601): SQL compilation error:
  [TRADE_BY_DECLARANT.VALUE] is not a valid group by expression
  compiled code at target/run/citrus_trade/models/analytics/import_export_2022.sql.
[0m11:47:48.216412 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.781 seconds
[0m11:47:48.223131 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1cdce045-59bc-401f-b819-aac004b97be5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89bd9520>]}
[0m11:47:48.224398 [info ] [Thread-2 (]: 3 of 4 OK created sql table model analytics.import_by_year ..................... [[32mSUCCESS 1[0m in 0.81s]
[0m11:47:48.225454 [debug] [Thread-2 (]: Finished running node model.citrus_trade.import_by_year
[0m11:47:48.228062 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:47:48.228620 [debug] [MainThread]: Connection 'model.citrus_trade.import_by_year' was left open.
[0m11:47:48.229213 [debug] [MainThread]: On model.citrus_trade.import_by_year: Close
[0m11:47:48.376797 [debug] [MainThread]: Connection 'model.citrus_trade.import_export_2022' was left open.
[0m11:47:48.377719 [debug] [MainThread]: On model.citrus_trade.import_export_2022: Close
[0m11:47:48.536839 [debug] [MainThread]: Connection 'model.citrus_trade.trade_by_declarant' was left open.
[0m11:47:48.537661 [debug] [MainThread]: On model.citrus_trade.trade_by_declarant: Close
[0m11:47:48.674450 [info ] [MainThread]: 
[0m11:47:48.675554 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 7.95 seconds (7.95s).
[0m11:47:48.678039 [debug] [MainThread]: Command end result
[0m11:47:48.723584 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m11:47:48.725697 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m11:47:48.731478 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt/target/run_results.json
[0m11:47:48.731731 [info ] [MainThread]: 
[0m11:47:48.732068 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m11:47:48.732357 [info ] [MainThread]: 
[0m11:47:48.732783 [error] [MainThread]: [31mFailure in model import_export_2022 (models/analytics/import_export_2022.sql)[0m
[0m11:47:48.733149 [error] [MainThread]:   Database Error in model import_export_2022 (models/analytics/import_export_2022.sql)
  000979 (42601): SQL compilation error:
  [TRADE_BY_DECLARANT.VALUE] is not a valid group by expression
  compiled code at target/run/citrus_trade/models/analytics/import_export_2022.sql
[0m11:47:48.733539 [info ] [MainThread]: 
[0m11:47:48.733854 [info ] [MainThread]:   compiled code at target/compiled/citrus_trade/models/analytics/import_export_2022.sql
[0m11:47:48.734154 [info ] [MainThread]: 
[0m11:47:48.734613 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=4
[0m11:47:48.735884 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 8.606976, "process_in_blocks": "0", "process_kernel_time": 0.239513, "process_mem_max_rss": "165112", "process_out_blocks": "4103", "process_user_time": 1.757104}
[0m11:47:48.736254 [debug] [MainThread]: Command `dbt run` failed at 11:47:48.736180 after 8.61 seconds
[0m11:47:48.736546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e483fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c1f13a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92af2900>]}
[0m11:47:48.736825 [debug] [MainThread]: Flushing usage events
[0m11:47:49.972332 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:48:20.736240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa43ce630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4016630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4372510>]}


============================== 11:48:20.738294 | eb04d9fd-e170-42f1-9754-9e99dd7b78ac ==============================
[0m11:48:20.738294 [info ] [MainThread]: Running with dbt=1.10.13
[0m11:48:20.738621 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run', 'static_parser': 'True', 'empty': 'False', 'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'log_cache_events': 'False', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_format': 'default', 'warn_error': 'None', 'quiet': 'False', 'debug': 'False', 'profiles_dir': '/app/dbt', 'partial_parse': 'True', 'target_path': 'None', 'introspect': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'log_path': '/app/dbt/logs', 'version_check': 'True', 'use_experimental_parser': 'False', 'printer_width': '80', 'fail_fast': 'False', 'indirect_selection': 'eager'}
[0m11:48:20.919005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'eb04d9fd-e170-42f1-9754-9e99dd7b78ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2573f80>]}
[0m11:48:20.948903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'eb04d9fd-e170-42f1-9754-9e99dd7b78ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3b3b4a0>]}
[0m11:48:20.949333 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m11:48:21.000588 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m11:48:21.111905 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:48:21.112287 [debug] [MainThread]: Partial parsing: updated file: citrus_trade://models/analytics/import_export_2022.sql
[0m11:48:21.234104 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.citrus_trade.visualisation
[0m11:48:21.241088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'eb04d9fd-e170-42f1-9754-9e99dd7b78ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1dd3e60>]}
[0m11:48:21.286728 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m11:48:21.288168 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m11:48:21.295427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'eb04d9fd-e170-42f1-9754-9e99dd7b78ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa220fd40>]}
[0m11:48:21.295774 [info ] [MainThread]: Found 4 models, 1 source, 632 macros
[0m11:48:21.296005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eb04d9fd-e170-42f1-9754-9e99dd7b78ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1dd3e00>]}
[0m11:48:21.297025 [info ] [MainThread]: 
[0m11:48:21.297303 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:48:21.297763 [info ] [MainThread]: 
[0m11:48:21.298260 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:48:21.300822 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRHS'
[0m11:48:21.306944 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRHS'
[0m11:48:21.348126 [debug] [ThreadPool]: Using snowflake connection "list_TRHS"
[0m11:48:21.348441 [debug] [ThreadPool]: Using snowflake connection "list_TRHS"
[0m11:48:21.348618 [debug] [ThreadPool]: On list_TRHS: show terse schemas in database TRHS
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS"} */
[0m11:48:21.348822 [debug] [ThreadPool]: On list_TRHS: show terse schemas in database TRHS
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS"} */
[0m11:48:21.348992 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:48:21.349180 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:48:24.950590 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 3.601 seconds
[0m11:48:24.952388 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 3.603 seconds
[0m11:48:24.959701 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRHS, now list_TRHS_staging)
[0m11:48:24.966686 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRHS, now list_TRHS_analytics)
[0m11:48:24.984841 [debug] [ThreadPool]: Using snowflake connection "list_TRHS_staging"
[0m11:48:24.987985 [debug] [ThreadPool]: Using snowflake connection "list_TRHS_analytics"
[0m11:48:24.988370 [debug] [ThreadPool]: On list_TRHS_staging: show objects in TRHS.staging
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS_staging"} */;
[0m11:48:24.988803 [debug] [ThreadPool]: On list_TRHS_analytics: show objects in TRHS.analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS_analytics"} */;
[0m11:48:25.092738 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.102 seconds
[0m11:48:25.094604 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.105 seconds
[0m11:48:25.103158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eb04d9fd-e170-42f1-9754-9e99dd7b78ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1dce0f0>]}
[0m11:48:25.110350 [debug] [Thread-1 (]: Began running node model.citrus_trade.stg_trade
[0m11:48:25.111115 [info ] [Thread-1 (]: 1 of 4 START sql table model staging.stg_trade ................................. [RUN]
[0m11:48:25.111786 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_TRHS_staging, now model.citrus_trade.stg_trade)
[0m11:48:25.112412 [debug] [Thread-1 (]: Began compiling node model.citrus_trade.stg_trade
[0m11:48:25.121619 [debug] [Thread-1 (]: Writing injected SQL for node "model.citrus_trade.stg_trade"
[0m11:48:25.123286 [debug] [Thread-1 (]: Began executing node model.citrus_trade.stg_trade
[0m11:48:25.150989 [debug] [Thread-1 (]: Writing runtime sql for node "model.citrus_trade.stg_trade"
[0m11:48:25.152503 [debug] [Thread-1 (]: Using snowflake connection "model.citrus_trade.stg_trade"
[0m11:48:25.152832 [debug] [Thread-1 (]: On model.citrus_trade.stg_trade: create or replace transient table TRHS.staging.stg_trade
    
    
    
    as (select
  value:DECLARANT::int as declarant,
  value:DECLARANT_ISO::string as declarant_iso,
  value:PARTNER::string as partner,
  value:PARTNER_ISO::string as partner_iso,
  value:FLOW::int as flow,
  value:TRANSPORT_MODE::int as transport_mode,
  value:PERIOD::int as period,
  value:HS4::string as hs4,
  value:HS4_NAME::string as hs4_name,
  value:HS6::string as hs6,
  value:HS6_NAME::string as hs6_name,
  value:VALUE_IN_EUROS::float as value_in_euros,
  value:QUANTITY_IN_KG::float as quantity_in_kg
from trhs.staging.citrus_ext
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.stg_trade"} */;
[0m11:48:26.099191 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.946 seconds
[0m11:48:26.115811 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb04d9fd-e170-42f1-9754-9e99dd7b78ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4af6390>]}
[0m11:48:26.116375 [info ] [Thread-1 (]: 1 of 4 OK created sql table model staging.stg_trade ............................ [[32mSUCCESS 1[0m in 1.00s]
[0m11:48:26.116757 [debug] [Thread-1 (]: Finished running node model.citrus_trade.stg_trade
[0m11:48:26.117540 [debug] [Thread-3 (]: Began running node model.citrus_trade.trade_by_declarant
[0m11:48:26.117924 [info ] [Thread-3 (]: 2 of 4 START sql table model analytics.trade_by_declarant ...................... [RUN]
[0m11:48:26.118423 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.citrus_trade.trade_by_declarant'
[0m11:48:26.118887 [debug] [Thread-3 (]: Began compiling node model.citrus_trade.trade_by_declarant
[0m11:48:26.122978 [debug] [Thread-3 (]: Writing injected SQL for node "model.citrus_trade.trade_by_declarant"
[0m11:48:26.124138 [debug] [Thread-3 (]: Began executing node model.citrus_trade.trade_by_declarant
[0m11:48:26.126107 [debug] [Thread-3 (]: Writing runtime sql for node "model.citrus_trade.trade_by_declarant"
[0m11:48:26.127491 [debug] [Thread-3 (]: Using snowflake connection "model.citrus_trade.trade_by_declarant"
[0m11:48:26.127764 [debug] [Thread-3 (]: On model.citrus_trade.trade_by_declarant: create or replace transient table TRHS.analytics.trade_by_declarant
    
    
    
    as (select 
    declarant,
    declarant_iso,
    partner,
    partner_iso,
    flow,
    transport_mode,
    year(to_date(left(period,4),'YYYY')) as year,
    period,
    hs6,
    hs6_name,
    sum(value_in_euros) as value,
    sum(quantity_in_kg) as quantity
from TRHS.staging.stg_trade
group by 1,2,3,4,5,6,7,8,9,10
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.trade_by_declarant"} */;
[0m11:48:26.127964 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m11:48:28.251764 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 2.124 seconds
[0m11:48:28.256527 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb04d9fd-e170-42f1-9754-9e99dd7b78ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99cb10a0>]}
[0m11:48:28.257721 [info ] [Thread-3 (]: 2 of 4 OK created sql table model analytics.trade_by_declarant ................. [[32mSUCCESS 1[0m in 2.14s]
[0m11:48:28.258997 [debug] [Thread-3 (]: Finished running node model.citrus_trade.trade_by_declarant
[0m11:48:28.260787 [debug] [Thread-2 (]: Began running node model.citrus_trade.import_by_year
[0m11:48:28.261365 [debug] [Thread-1 (]: Began running node model.citrus_trade.import_export_2022
[0m11:48:28.261977 [info ] [Thread-2 (]: 3 of 4 START sql table model analytics.import_by_year .......................... [RUN]
[0m11:48:28.263839 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_TRHS_analytics, now model.citrus_trade.import_by_year)
[0m11:48:28.262862 [info ] [Thread-1 (]: 4 of 4 START sql table model analytics.import_export_2022 ...................... [RUN]
[0m11:48:28.265824 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.citrus_trade.stg_trade, now model.citrus_trade.import_export_2022)
[0m11:48:28.266359 [debug] [Thread-1 (]: Began compiling node model.citrus_trade.import_export_2022
[0m11:48:28.264643 [debug] [Thread-2 (]: Began compiling node model.citrus_trade.import_by_year
[0m11:48:28.270928 [debug] [Thread-1 (]: Writing injected SQL for node "model.citrus_trade.import_export_2022"
[0m11:48:28.274607 [debug] [Thread-2 (]: Writing injected SQL for node "model.citrus_trade.import_by_year"
[0m11:48:28.276330 [debug] [Thread-1 (]: Began executing node model.citrus_trade.import_export_2022
[0m11:48:28.279471 [debug] [Thread-1 (]: Writing runtime sql for node "model.citrus_trade.import_export_2022"
[0m11:48:28.279894 [debug] [Thread-2 (]: Began executing node model.citrus_trade.import_by_year
[0m11:48:28.284521 [debug] [Thread-2 (]: Writing runtime sql for node "model.citrus_trade.import_by_year"
[0m11:48:28.286028 [debug] [Thread-1 (]: Using snowflake connection "model.citrus_trade.import_export_2022"
[0m11:48:28.286436 [debug] [Thread-1 (]: On model.citrus_trade.import_export_2022: create or replace transient table TRHS.analytics.import_export_2022
    
    
    
    as (select
    declarant_iso,
    flow,
    sum(value) over(partition by declarant_iso, flow) as total_value,
    sum(quantity) over(partition by declarant_iso, flow) as total_quantity,
    total_value/nullif(total_quantity,0) as value_per_quantity
from TRHS.analytics.trade_by_declarant
where hs6 = '080510'
group by 1,2,value,quantity
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.import_export_2022"} */;
[0m11:48:28.287195 [debug] [Thread-2 (]: Using snowflake connection "model.citrus_trade.import_by_year"
[0m11:48:28.288131 [debug] [Thread-2 (]: On model.citrus_trade.import_by_year: create or replace transient table TRHS.analytics.import_by_year
    
    
    
    as (select
    declarant_iso,
    year,
    sum(value) as total_value,
    sum(quantity) as total_quantity,
    total_value/nullif(total_quantity,0) as value_per_quantity
from TRHS.analytics.trade_by_declarant
where flow = 1
and hs6 = '080510'
group by 1,2
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.import_by_year"} */;
[0m11:48:28.970348 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.682 seconds
[0m11:48:28.973142 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.684 seconds
[0m11:48:28.980414 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb04d9fd-e170-42f1-9754-9e99dd7b78ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9bf68e00>]}
[0m11:48:28.981524 [info ] [Thread-2 (]: 3 of 4 OK created sql table model analytics.import_by_year ..................... [[32mSUCCESS 1[0m in 0.72s]
[0m11:48:28.977041 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb04d9fd-e170-42f1-9754-9e99dd7b78ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9bf8dee0>]}
[0m11:48:28.982524 [debug] [Thread-2 (]: Finished running node model.citrus_trade.import_by_year
[0m11:48:28.983532 [info ] [Thread-1 (]: 4 of 4 OK created sql table model analytics.import_export_2022 ................. [[32mSUCCESS 1[0m in 0.71s]
[0m11:48:28.984858 [debug] [Thread-1 (]: Finished running node model.citrus_trade.import_export_2022
[0m11:48:28.987086 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:48:28.987578 [debug] [MainThread]: Connection 'model.citrus_trade.import_export_2022' was left open.
[0m11:48:28.988001 [debug] [MainThread]: On model.citrus_trade.import_export_2022: Close
[0m11:48:29.156659 [debug] [MainThread]: Connection 'model.citrus_trade.import_by_year' was left open.
[0m11:48:29.157864 [debug] [MainThread]: On model.citrus_trade.import_by_year: Close
[0m11:48:29.372006 [debug] [MainThread]: Connection 'model.citrus_trade.trade_by_declarant' was left open.
[0m11:48:29.373170 [debug] [MainThread]: On model.citrus_trade.trade_by_declarant: Close
[0m11:48:29.543361 [info ] [MainThread]: 
[0m11:48:29.544626 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 8.24 seconds (8.24s).
[0m11:48:29.547188 [debug] [MainThread]: Command end result
[0m11:48:29.592319 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m11:48:29.594257 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m11:48:29.600021 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt/target/run_results.json
[0m11:48:29.600279 [info ] [MainThread]: 
[0m11:48:29.600633 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:48:29.600990 [info ] [MainThread]: 
[0m11:48:29.601315 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m11:48:29.602123 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.894871, "process_in_blocks": "0", "process_kernel_time": 0.315639, "process_mem_max_rss": "164608", "process_out_blocks": "4100", "process_user_time": 1.722947}
[0m11:48:29.602526 [debug] [MainThread]: Command `dbt run` succeeded at 11:48:29.602455 after 8.90 seconds
[0m11:48:29.602814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4adeb70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4016630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99cb3f50>]}
[0m11:48:29.603116 [debug] [MainThread]: Flushing usage events
[0m11:48:30.869008 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:48:57.501317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0db6a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa03a3bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9fc603b0>]}


============================== 11:48:57.503313 | c9a3b7a5-8f00-44b0-844f-f68235eb9ffc ==============================
[0m11:48:57.503313 [info ] [MainThread]: Running with dbt=1.10.13
[0m11:48:57.503606 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'log_path': '/app/dbt/logs', 'no_print': 'None', 'empty': 'False', 'debug': 'False', 'quiet': 'False', 'log_format': 'default', 'use_experimental_parser': 'False', 'static_parser': 'True', 'log_cache_events': 'False', 'write_json': 'True', 'use_colors': 'True', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'partial_parse': 'True', 'invocation_command': 'dbt run', 'version_check': 'True', 'profiles_dir': '/app/dbt', 'introspect': 'True'}
[0m11:48:57.676106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c9a3b7a5-8f00-44b0-844f-f68235eb9ffc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e80cef0>]}
[0m11:48:57.705708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c9a3b7a5-8f00-44b0-844f-f68235eb9ffc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e9dfc50>]}
[0m11:48:57.706116 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m11:48:57.752987 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m11:48:57.864786 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:48:57.865153 [debug] [MainThread]: Partial parsing: updated file: citrus_trade://models/analytics/import_export_2022.sql
[0m11:48:57.982978 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.citrus_trade.visualisation
[0m11:48:57.989653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c9a3b7a5-8f00-44b0-844f-f68235eb9ffc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ddcbf50>]}
[0m11:48:58.032061 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m11:48:58.033356 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m11:48:58.040821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c9a3b7a5-8f00-44b0-844f-f68235eb9ffc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e2f3350>]}
[0m11:48:58.041074 [info ] [MainThread]: Found 4 models, 1 source, 632 macros
[0m11:48:58.041247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c9a3b7a5-8f00-44b0-844f-f68235eb9ffc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e293f80>]}
[0m11:48:58.042212 [info ] [MainThread]: 
[0m11:48:58.042434 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:48:58.042630 [info ] [MainThread]: 
[0m11:48:58.043005 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:48:58.045647 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRHS'
[0m11:48:58.052433 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRHS'
[0m11:48:58.064567 [debug] [ThreadPool]: Using snowflake connection "list_TRHS"
[0m11:48:58.064851 [debug] [ThreadPool]: Using snowflake connection "list_TRHS"
[0m11:48:58.065021 [debug] [ThreadPool]: On list_TRHS: show terse schemas in database TRHS
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS"} */
[0m11:48:58.065242 [debug] [ThreadPool]: On list_TRHS: show terse schemas in database TRHS
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS"} */
[0m11:48:58.065427 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:48:58.065621 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:49:00.838776 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.773 seconds
[0m11:49:00.861173 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.796 seconds
[0m11:49:00.865581 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRHS, now list_TRHS_analytics)
[0m11:49:00.866346 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRHS, now list_TRHS_staging)
[0m11:49:00.880759 [debug] [ThreadPool]: Using snowflake connection "list_TRHS_analytics"
[0m11:49:00.883896 [debug] [ThreadPool]: Using snowflake connection "list_TRHS_staging"
[0m11:49:00.884479 [debug] [ThreadPool]: On list_TRHS_analytics: show objects in TRHS.analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS_analytics"} */;
[0m11:49:00.884957 [debug] [ThreadPool]: On list_TRHS_staging: show objects in TRHS.staging
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS_staging"} */;
[0m11:49:00.991430 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.106 seconds
[0m11:49:00.999281 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.112 seconds
[0m11:49:01.002946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c9a3b7a5-8f00-44b0-844f-f68235eb9ffc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d5cb620>]}
[0m11:49:01.009486 [debug] [Thread-1 (]: Began running node model.citrus_trade.stg_trade
[0m11:49:01.010370 [info ] [Thread-1 (]: 1 of 4 START sql table model staging.stg_trade ................................. [RUN]
[0m11:49:01.011752 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_TRHS_staging, now model.citrus_trade.stg_trade)
[0m11:49:01.012630 [debug] [Thread-1 (]: Began compiling node model.citrus_trade.stg_trade
[0m11:49:01.023165 [debug] [Thread-1 (]: Writing injected SQL for node "model.citrus_trade.stg_trade"
[0m11:49:01.024864 [debug] [Thread-1 (]: Began executing node model.citrus_trade.stg_trade
[0m11:49:01.054612 [debug] [Thread-1 (]: Writing runtime sql for node "model.citrus_trade.stg_trade"
[0m11:49:01.056334 [debug] [Thread-1 (]: Using snowflake connection "model.citrus_trade.stg_trade"
[0m11:49:01.056681 [debug] [Thread-1 (]: On model.citrus_trade.stg_trade: create or replace transient table TRHS.staging.stg_trade
    
    
    
    as (select
  value:DECLARANT::int as declarant,
  value:DECLARANT_ISO::string as declarant_iso,
  value:PARTNER::string as partner,
  value:PARTNER_ISO::string as partner_iso,
  value:FLOW::int as flow,
  value:TRANSPORT_MODE::int as transport_mode,
  value:PERIOD::int as period,
  value:HS4::string as hs4,
  value:HS4_NAME::string as hs4_name,
  value:HS6::string as hs6,
  value:HS6_NAME::string as hs6_name,
  value:VALUE_IN_EUROS::float as value_in_euros,
  value:QUANTITY_IN_KG::float as quantity_in_kg
from trhs.staging.citrus_ext
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.stg_trade"} */;
[0m11:49:02.077662 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.020 seconds
[0m11:49:02.112473 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c9a3b7a5-8f00-44b0-844f-f68235eb9ffc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0aee5a0>]}
[0m11:49:02.113469 [info ] [Thread-1 (]: 1 of 4 OK created sql table model staging.stg_trade ............................ [[32mSUCCESS 1[0m in 1.10s]
[0m11:49:02.114188 [debug] [Thread-1 (]: Finished running node model.citrus_trade.stg_trade
[0m11:49:02.115144 [debug] [Thread-3 (]: Began running node model.citrus_trade.trade_by_declarant
[0m11:49:02.115817 [info ] [Thread-3 (]: 2 of 4 START sql table model analytics.trade_by_declarant ...................... [RUN]
[0m11:49:02.116462 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.citrus_trade.trade_by_declarant'
[0m11:49:02.116923 [debug] [Thread-3 (]: Began compiling node model.citrus_trade.trade_by_declarant
[0m11:49:02.124427 [debug] [Thread-3 (]: Writing injected SQL for node "model.citrus_trade.trade_by_declarant"
[0m11:49:02.125911 [debug] [Thread-3 (]: Began executing node model.citrus_trade.trade_by_declarant
[0m11:49:02.128503 [debug] [Thread-3 (]: Writing runtime sql for node "model.citrus_trade.trade_by_declarant"
[0m11:49:02.129874 [debug] [Thread-3 (]: Using snowflake connection "model.citrus_trade.trade_by_declarant"
[0m11:49:02.130197 [debug] [Thread-3 (]: On model.citrus_trade.trade_by_declarant: create or replace transient table TRHS.analytics.trade_by_declarant
    
    
    
    as (select 
    declarant,
    declarant_iso,
    partner,
    partner_iso,
    flow,
    transport_mode,
    year(to_date(left(period,4),'YYYY')) as year,
    period,
    hs6,
    hs6_name,
    sum(value_in_euros) as value,
    sum(quantity_in_kg) as quantity
from TRHS.staging.stg_trade
group by 1,2,3,4,5,6,7,8,9,10
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.trade_by_declarant"} */;
[0m11:49:02.130458 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m11:49:03.888344 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.757 seconds
[0m11:49:03.894305 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c9a3b7a5-8f00-44b0-844f-f68235eb9ffc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c383170>]}
[0m11:49:03.895583 [info ] [Thread-3 (]: 2 of 4 OK created sql table model analytics.trade_by_declarant ................. [[32mSUCCESS 1[0m in 1.78s]
[0m11:49:03.896991 [debug] [Thread-3 (]: Finished running node model.citrus_trade.trade_by_declarant
[0m11:49:03.898527 [debug] [Thread-2 (]: Began running node model.citrus_trade.import_by_year
[0m11:49:03.899182 [debug] [Thread-1 (]: Began running node model.citrus_trade.import_export_2022
[0m11:49:03.899846 [info ] [Thread-2 (]: 3 of 4 START sql table model analytics.import_by_year .......................... [RUN]
[0m11:49:03.900902 [info ] [Thread-1 (]: 4 of 4 START sql table model analytics.import_export_2022 ...................... [RUN]
[0m11:49:03.902609 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.citrus_trade.stg_trade, now model.citrus_trade.import_export_2022)
[0m11:49:03.903171 [debug] [Thread-1 (]: Began compiling node model.citrus_trade.import_export_2022
[0m11:49:03.901875 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_TRHS_analytics, now model.citrus_trade.import_by_year)
[0m11:49:03.908531 [debug] [Thread-2 (]: Began compiling node model.citrus_trade.import_by_year
[0m11:49:03.908004 [debug] [Thread-1 (]: Writing injected SQL for node "model.citrus_trade.import_export_2022"
[0m11:49:03.912190 [debug] [Thread-2 (]: Writing injected SQL for node "model.citrus_trade.import_by_year"
[0m11:49:03.914129 [debug] [Thread-1 (]: Began executing node model.citrus_trade.import_export_2022
[0m11:49:03.917402 [debug] [Thread-1 (]: Writing runtime sql for node "model.citrus_trade.import_export_2022"
[0m11:49:03.917815 [debug] [Thread-2 (]: Began executing node model.citrus_trade.import_by_year
[0m11:49:03.920591 [debug] [Thread-2 (]: Writing runtime sql for node "model.citrus_trade.import_by_year"
[0m11:49:03.922056 [debug] [Thread-1 (]: Using snowflake connection "model.citrus_trade.import_export_2022"
[0m11:49:03.922511 [debug] [Thread-1 (]: On model.citrus_trade.import_export_2022: create or replace transient table TRHS.analytics.import_export_2022
    
    
    
    as (select
    declarant_iso,
    flow,
    sum(value) over(partition by declarant_iso, flow) as total_value,
    sum(quantity) over(partition by declarant_iso, flow) as total_quantity,
    total_value/nullif(total_quantity,0) as value_per_quantity
from TRHS.analytics.trade_by_declarant
where hs6 = '080510'
group by 
    declarant_iso,
    flow,
    value,
    quantity
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.import_export_2022"} */;
[0m11:49:03.923535 [debug] [Thread-2 (]: Using snowflake connection "model.citrus_trade.import_by_year"
[0m11:49:03.924949 [debug] [Thread-2 (]: On model.citrus_trade.import_by_year: create or replace transient table TRHS.analytics.import_by_year
    
    
    
    as (select
    declarant_iso,
    year,
    sum(value) as total_value,
    sum(quantity) as total_quantity,
    total_value/nullif(total_quantity,0) as value_per_quantity
from TRHS.analytics.trade_by_declarant
where flow = 1
and hs6 = '080510'
group by 1,2
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.import_by_year"} */;
[0m11:49:04.706856 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.779 seconds
[0m11:49:04.711296 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c9a3b7a5-8f00-44b0-844f-f68235eb9ffc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97fb1af0>]}
[0m11:49:04.712384 [info ] [Thread-2 (]: 3 of 4 OK created sql table model analytics.import_by_year ..................... [[32mSUCCESS 1[0m in 0.81s]
[0m11:49:04.708496 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.786 seconds
[0m11:49:04.713325 [debug] [Thread-2 (]: Finished running node model.citrus_trade.import_by_year
[0m11:49:04.715669 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c9a3b7a5-8f00-44b0-844f-f68235eb9ffc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97f28170>]}
[0m11:49:04.716834 [info ] [Thread-1 (]: 4 of 4 OK created sql table model analytics.import_export_2022 ................. [[32mSUCCESS 1[0m in 0.81s]
[0m11:49:04.717838 [debug] [Thread-1 (]: Finished running node model.citrus_trade.import_export_2022
[0m11:49:04.719938 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:49:04.720380 [debug] [MainThread]: Connection 'model.citrus_trade.import_by_year' was left open.
[0m11:49:04.720841 [debug] [MainThread]: On model.citrus_trade.import_by_year: Close
[0m11:49:04.883098 [debug] [MainThread]: Connection 'model.citrus_trade.import_export_2022' was left open.
[0m11:49:04.883542 [debug] [MainThread]: On model.citrus_trade.import_export_2022: Close
[0m11:49:05.051786 [debug] [MainThread]: Connection 'model.citrus_trade.trade_by_declarant' was left open.
[0m11:49:05.052626 [debug] [MainThread]: On model.citrus_trade.trade_by_declarant: Close
[0m11:49:05.178327 [info ] [MainThread]: 
[0m11:49:05.179308 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 7.14 seconds (7.14s).
[0m11:49:05.181591 [debug] [MainThread]: Command end result
[0m11:49:05.218806 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m11:49:05.221255 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m11:49:05.227620 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt/target/run_results.json
[0m11:49:05.227935 [info ] [MainThread]: 
[0m11:49:05.228237 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:49:05.228514 [info ] [MainThread]: 
[0m11:49:05.229314 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m11:49:05.230646 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.757152, "process_in_blocks": "0", "process_kernel_time": 0.204292, "process_mem_max_rss": "165220", "process_out_blocks": "4101", "process_user_time": 1.667389}
[0m11:49:05.231100 [debug] [MainThread]: Command `dbt run` succeeded at 11:49:05.231024 after 7.76 seconds
[0m11:49:05.231527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa49fa900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d1cbaa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e1398b0>]}
[0m11:49:05.231891 [debug] [MainThread]: Flushing usage events
[0m11:49:06.487187 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:10:59.764907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0e00d40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa14d61b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3b6a3c0>]}


============================== 12:10:59.768216 | 7fe53dd0-d92d-45f6-a2b0-3e04ebe6752f ==============================
[0m12:10:59.768216 [info ] [MainThread]: Running with dbt=1.10.13
[0m12:10:59.768646 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '/app/dbt', 'indirect_selection': 'eager', 'empty': 'False', 'debug': 'False', 'static_parser': 'True', 'version_check': 'True', 'log_path': '/app/dbt/logs', 'invocation_command': 'dbt run', 'cache_selected_only': 'False', 'no_print': 'None', 'introspect': 'True', 'warn_error': 'None', 'printer_width': '80', 'use_experimental_parser': 'False', 'use_colors': 'True', 'quiet': 'False', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'log_format': 'default', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_cache_events': 'False', 'partial_parse': 'True'}
[0m12:11:00.009573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7fe53dd0-d92d-45f6-a2b0-3e04ebe6752f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f7e4200>]}
[0m12:11:00.044146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7fe53dd0-d92d-45f6-a2b0-3e04ebe6752f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9efd4410>]}
[0m12:11:00.044808 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m12:11:00.093314 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m12:11:00.217718 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 0 files changed.
[0m12:11:00.218141 [debug] [MainThread]: Partial parsing: added file: citrus_trade://models/analytics/growth_score.sql
[0m12:11:00.218320 [debug] [MainThread]: Partial parsing: added file: citrus_trade://models/analytics/score_2022.sql
[0m12:11:00.312429 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.citrus_trade.growth_score' (models/analytics/growth_score.sql) depends on a node named 'importer_by_year' which was not found
[0m12:11:00.314785 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.5804739, "process_in_blocks": "0", "process_kernel_time": 0.253002, "process_mem_max_rss": "130784", "process_out_blocks": "5", "process_user_time": 1.177357}
[0m12:11:00.315264 [debug] [MainThread]: Command `dbt run` failed at 12:11:00.315192 after 0.58 seconds
[0m12:11:00.315502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0dc5cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ee90050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ead7350>]}
[0m12:11:00.315703 [debug] [MainThread]: Flushing usage events
[0m12:11:01.607554 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:12:04.293171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b9be930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b32f140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a941130>]}


============================== 12:12:04.295770 | 16cad764-6bf9-48a3-b0b6-2324c03c6552 ==============================
[0m12:12:04.295770 [info ] [MainThread]: Running with dbt=1.10.13
[0m12:12:04.296124 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'empty': 'False', 'use_colors': 'True', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'static_parser': 'True', 'write_json': 'True', 'debug': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': '/app/dbt', 'quiet': 'False', 'printer_width': '80', 'log_format': 'default', 'log_path': '/app/dbt/logs', 'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'use_experimental_parser': 'False', 'invocation_command': 'dbt run', 'target_path': 'None', 'partial_parse': 'True', 'no_print': 'None', 'log_cache_events': 'False', 'warn_error': 'None', 'version_check': 'True'}
[0m12:12:04.491694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '16cad764-6bf9-48a3-b0b6-2324c03c6552', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d1265a0>]}
[0m12:12:04.522228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '16cad764-6bf9-48a3-b0b6-2324c03c6552', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89499b20>]}
[0m12:12:04.522734 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m12:12:04.571350 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m12:12:04.686777 [debug] [MainThread]: Partial parsing enabled: 2 files deleted, 4 files added, 0 files changed.
[0m12:12:04.687130 [debug] [MainThread]: Partial parsing: added file: citrus_trade://models/analytics/growth_score.sql
[0m12:12:04.687323 [debug] [MainThread]: Partial parsing: added file: citrus_trade://models/analytics/score_2022.sql
[0m12:12:04.687494 [debug] [MainThread]: Partial parsing: added file: citrus_trade://models/analytics/imports_exports_2022.sql
[0m12:12:04.687637 [debug] [MainThread]: Partial parsing: added file: citrus_trade://models/analytics/imports_by_year.sql
[0m12:12:04.687766 [debug] [MainThread]: Partial parsing: deleted file: citrus_trade://models/analytics/import_export_2022.sql
[0m12:12:04.687885 [debug] [MainThread]: Partial parsing: deleted file: citrus_trade://models/analytics/import_by_year.sql
[0m12:12:04.788299 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.citrus_trade.score_2022' (models/analytics/score_2022.sql) depends on a node named 'import_export_2022' which was not found
[0m12:12:04.790436 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.5262506, "process_in_blocks": "0", "process_kernel_time": 0.167698, "process_mem_max_rss": "131036", "process_out_blocks": "6", "process_user_time": 1.195848}
[0m12:12:04.790817 [debug] [MainThread]: Command `dbt run` failed at 12:12:04.790758 after 0.53 seconds
[0m12:12:04.791031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ad7faa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88ecbd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88d917c0>]}
[0m12:12:04.791219 [debug] [MainThread]: Flushing usage events
[0m12:12:06.171604 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:12:21.662034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9eca56a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e54e630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e3116d0>]}


============================== 12:12:21.664025 | 1def9033-7338-4f8c-9a86-9a5e9d6d8c4f ==============================
[0m12:12:21.664025 [info ] [MainThread]: Running with dbt=1.10.13
[0m12:12:21.664315 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'empty': 'False', 'log_cache_events': 'False', 'target_path': 'None', 'quiet': 'False', 'log_path': '/app/dbt/logs', 'partial_parse': 'True', 'use_colors': 'True', 'version_check': 'True', 'printer_width': '80', 'cache_selected_only': 'False', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'profiles_dir': '/app/dbt', 'debug': 'False', 'invocation_command': 'dbt run', 'introspect': 'True', 'no_print': 'None', 'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'write_json': 'True', 'indirect_selection': 'eager'}
[0m12:12:21.840451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1def9033-7338-4f8c-9a86-9a5e9d6d8c4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9cc6c200>]}
[0m12:12:21.870742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1def9033-7338-4f8c-9a86-9a5e9d6d8c4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9cc861e0>]}
[0m12:12:21.871186 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m12:12:21.917603 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m12:12:22.030836 [debug] [MainThread]: Partial parsing enabled: 2 files deleted, 4 files added, 0 files changed.
[0m12:12:22.031209 [debug] [MainThread]: Partial parsing: added file: citrus_trade://models/analytics/growth_score.sql
[0m12:12:22.031417 [debug] [MainThread]: Partial parsing: added file: citrus_trade://models/analytics/imports_exports_2022.sql
[0m12:12:22.031578 [debug] [MainThread]: Partial parsing: added file: citrus_trade://models/analytics/imports_by_year.sql
[0m12:12:22.031722 [debug] [MainThread]: Partial parsing: added file: citrus_trade://models/analytics/score_2022.sql
[0m12:12:22.031850 [debug] [MainThread]: Partial parsing: deleted file: citrus_trade://models/analytics/import_by_year.sql
[0m12:12:22.031971 [debug] [MainThread]: Partial parsing: deleted file: citrus_trade://models/analytics/import_export_2022.sql
[0m12:12:22.161245 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.citrus_trade.visualisation
[0m12:12:22.168972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1def9033-7338-4f8c-9a86-9a5e9d6d8c4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c3a7a40>]}
[0m12:12:22.213216 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m12:12:22.214727 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m12:12:22.223021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1def9033-7338-4f8c-9a86-9a5e9d6d8c4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c4e8230>]}
[0m12:12:22.223270 [info ] [MainThread]: Found 6 models, 1 source, 632 macros
[0m12:12:22.223446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1def9033-7338-4f8c-9a86-9a5e9d6d8c4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c34be00>]}
[0m12:12:22.224456 [info ] [MainThread]: 
[0m12:12:22.224682 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:12:22.225244 [info ] [MainThread]: 
[0m12:12:22.226628 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:12:22.229238 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRHS'
[0m12:12:22.235338 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRHS'
[0m12:12:22.252813 [debug] [ThreadPool]: Using snowflake connection "list_TRHS"
[0m12:12:22.253113 [debug] [ThreadPool]: Using snowflake connection "list_TRHS"
[0m12:12:22.253285 [debug] [ThreadPool]: On list_TRHS: show terse schemas in database TRHS
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS"} */
[0m12:12:22.253520 [debug] [ThreadPool]: On list_TRHS: show terse schemas in database TRHS
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS"} */
[0m12:12:22.253728 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:12:22.253926 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:12:24.832081 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.578 seconds
[0m12:12:24.843091 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.589 seconds
[0m12:12:24.847648 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRHS, now list_TRHS_staging)
[0m12:12:24.855306 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRHS, now list_TRHS_analytics)
[0m12:12:24.872045 [debug] [ThreadPool]: Using snowflake connection "list_TRHS_staging"
[0m12:12:24.876176 [debug] [ThreadPool]: Using snowflake connection "list_TRHS_analytics"
[0m12:12:24.876491 [debug] [ThreadPool]: On list_TRHS_staging: show objects in TRHS.staging
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS_staging"} */;
[0m12:12:24.876913 [debug] [ThreadPool]: On list_TRHS_analytics: show objects in TRHS.analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS_analytics"} */;
[0m12:12:25.002295 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.123 seconds
[0m12:12:25.031640 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.154 seconds
[0m12:12:25.069046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1def9033-7338-4f8c-9a86-9a5e9d6d8c4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa08296a0>]}
[0m12:12:25.152322 [debug] [Thread-1 (]: Began running node model.citrus_trade.stg_trade
[0m12:12:25.154070 [info ] [Thread-1 (]: 1 of 6 START sql table model staging.stg_trade ................................. [RUN]
[0m12:12:25.156862 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_TRHS_staging, now model.citrus_trade.stg_trade)
[0m12:12:25.160120 [debug] [Thread-1 (]: Began compiling node model.citrus_trade.stg_trade
[0m12:12:25.177951 [debug] [Thread-1 (]: Writing injected SQL for node "model.citrus_trade.stg_trade"
[0m12:12:25.179503 [debug] [Thread-1 (]: Began executing node model.citrus_trade.stg_trade
[0m12:12:25.277593 [debug] [Thread-1 (]: Writing runtime sql for node "model.citrus_trade.stg_trade"
[0m12:12:25.280345 [debug] [Thread-1 (]: Using snowflake connection "model.citrus_trade.stg_trade"
[0m12:12:25.280833 [debug] [Thread-1 (]: On model.citrus_trade.stg_trade: create or replace transient table TRHS.staging.stg_trade
    
    
    
    as (select
  value:DECLARANT::int as declarant,
  value:DECLARANT_ISO::string as declarant_iso,
  value:PARTNER::string as partner,
  value:PARTNER_ISO::string as partner_iso,
  value:FLOW::int as flow,
  value:TRANSPORT_MODE::int as transport_mode,
  value:PERIOD::int as period,
  value:HS4::string as hs4,
  value:HS4_NAME::string as hs4_name,
  value:HS6::string as hs6,
  value:HS6_NAME::string as hs6_name,
  value:VALUE_IN_EUROS::float as value_in_euros,
  value:QUANTITY_IN_KG::float as quantity_in_kg
from trhs.staging.citrus_ext
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.stg_trade"} */;
[0m12:12:26.145756 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.864 seconds
[0m12:12:26.180772 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1def9033-7338-4f8c-9a86-9a5e9d6d8c4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9edf2ba0>]}
[0m12:12:26.181699 [info ] [Thread-1 (]: 1 of 6 OK created sql table model staging.stg_trade ............................ [[32mSUCCESS 1[0m in 1.02s]
[0m12:12:26.182696 [debug] [Thread-1 (]: Finished running node model.citrus_trade.stg_trade
[0m12:12:26.183810 [debug] [Thread-3 (]: Began running node model.citrus_trade.trade_by_declarant
[0m12:12:26.184435 [info ] [Thread-3 (]: 2 of 6 START sql table model analytics.trade_by_declarant ...................... [RUN]
[0m12:12:26.185100 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.citrus_trade.trade_by_declarant'
[0m12:12:26.185472 [debug] [Thread-3 (]: Began compiling node model.citrus_trade.trade_by_declarant
[0m12:12:26.191536 [debug] [Thread-3 (]: Writing injected SQL for node "model.citrus_trade.trade_by_declarant"
[0m12:12:26.193768 [debug] [Thread-3 (]: Began executing node model.citrus_trade.trade_by_declarant
[0m12:12:26.196169 [debug] [Thread-3 (]: Writing runtime sql for node "model.citrus_trade.trade_by_declarant"
[0m12:12:26.197799 [debug] [Thread-3 (]: Using snowflake connection "model.citrus_trade.trade_by_declarant"
[0m12:12:26.198187 [debug] [Thread-3 (]: On model.citrus_trade.trade_by_declarant: create or replace transient table TRHS.analytics.trade_by_declarant
    
    
    
    as (select 
    declarant,
    declarant_iso,
    partner,
    partner_iso,
    flow,
    transport_mode,
    year(to_date(left(period,4),'YYYY')) as year,
    period,
    hs6,
    hs6_name,
    sum(value_in_euros) as value,
    sum(quantity_in_kg) as quantity
from TRHS.staging.stg_trade
group by 1,2,3,4,5,6,7,8,9,10
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.trade_by_declarant"} */;
[0m12:12:26.198515 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:12:28.024248 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.825 seconds
[0m12:12:28.028871 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1def9033-7338-4f8c-9a86-9a5e9d6d8c4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b7c66f0>]}
[0m12:12:28.030348 [info ] [Thread-3 (]: 2 of 6 OK created sql table model analytics.trade_by_declarant ................. [[32mSUCCESS 1[0m in 1.84s]
[0m12:12:28.031662 [debug] [Thread-3 (]: Finished running node model.citrus_trade.trade_by_declarant
[0m12:12:28.033465 [debug] [Thread-2 (]: Began running node model.citrus_trade.imports_by_year
[0m12:12:28.034215 [debug] [Thread-1 (]: Began running node model.citrus_trade.imports_exports_2022
[0m12:12:28.034881 [info ] [Thread-2 (]: 3 of 6 START sql table model analytics.imports_by_year ......................... [RUN]
[0m12:12:28.035832 [info ] [Thread-1 (]: 4 of 6 START sql table model analytics.imports_exports_2022 .................... [RUN]
[0m12:12:28.037574 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.citrus_trade.stg_trade, now model.citrus_trade.imports_exports_2022)
[0m12:12:28.038269 [debug] [Thread-1 (]: Began compiling node model.citrus_trade.imports_exports_2022
[0m12:12:28.036851 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_TRHS_analytics, now model.citrus_trade.imports_by_year)
[0m12:12:28.044173 [debug] [Thread-2 (]: Began compiling node model.citrus_trade.imports_by_year
[0m12:12:28.043589 [debug] [Thread-1 (]: Writing injected SQL for node "model.citrus_trade.imports_exports_2022"
[0m12:12:28.048260 [debug] [Thread-2 (]: Writing injected SQL for node "model.citrus_trade.imports_by_year"
[0m12:12:28.052641 [debug] [Thread-1 (]: Began executing node model.citrus_trade.imports_exports_2022
[0m12:12:28.057689 [debug] [Thread-1 (]: Writing runtime sql for node "model.citrus_trade.imports_exports_2022"
[0m12:12:28.058088 [debug] [Thread-2 (]: Began executing node model.citrus_trade.imports_by_year
[0m12:12:28.062322 [debug] [Thread-2 (]: Writing runtime sql for node "model.citrus_trade.imports_by_year"
[0m12:12:28.064909 [debug] [Thread-1 (]: Using snowflake connection "model.citrus_trade.imports_exports_2022"
[0m12:12:28.065378 [debug] [Thread-1 (]: On model.citrus_trade.imports_exports_2022: create or replace transient table TRHS.analytics.imports_exports_2022
    
    
    
    as (select
    declarant_iso,
    flow,
    sum(value) over(partition by declarant_iso, flow) as total_value,
    sum(quantity) over(partition by declarant_iso, flow) as total_quantity,
    total_value/nullif(total_quantity,0) as value_per_quantity
from TRHS.analytics.trade_by_declarant
where hs6 = '080510'
group by 
    declarant_iso,
    flow,
    value,
    quantity
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.imports_exports_2022"} */;
[0m12:12:28.067735 [debug] [Thread-2 (]: Using snowflake connection "model.citrus_trade.imports_by_year"
[0m12:12:28.068124 [debug] [Thread-2 (]: On model.citrus_trade.imports_by_year: create or replace transient table TRHS.analytics.imports_by_year
    
    
    
    as (select
    declarant_iso,
    year,
    sum(value) as total_value,
    sum(quantity) as total_quantity,
    total_value/nullif(total_quantity,0) as value_per_quantity
from TRHS.analytics.trade_by_declarant
where flow = 1
and hs6 = '080510'
group by 1,2
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.imports_by_year"} */;
[0m12:12:28.792072 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.723 seconds
[0m12:12:28.794906 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.729 seconds
[0m12:12:28.802777 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1def9033-7338-4f8c-9a86-9a5e9d6d8c4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c45f530>]}
[0m12:12:28.799519 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1def9033-7338-4f8c-9a86-9a5e9d6d8c4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a36bf80>]}
[0m12:12:28.803915 [info ] [Thread-1 (]: 4 of 6 OK created sql table model analytics.imports_exports_2022 ............... [[32mSUCCESS 1[0m in 0.77s]
[0m12:12:28.805132 [info ] [Thread-2 (]: 3 of 6 OK created sql table model analytics.imports_by_year .................... [[32mSUCCESS 1[0m in 0.76s]
[0m12:12:28.807046 [debug] [Thread-2 (]: Finished running node model.citrus_trade.imports_by_year
[0m12:12:28.806369 [debug] [Thread-1 (]: Finished running node model.citrus_trade.imports_exports_2022
[0m12:12:28.808062 [debug] [Thread-1 (]: Began running node model.citrus_trade.growth_score
[0m12:12:28.808761 [info ] [Thread-1 (]: 5 of 6 START sql table model analytics.growth_score ............................ [RUN]
[0m12:12:28.809492 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.citrus_trade.imports_exports_2022, now model.citrus_trade.growth_score)
[0m12:12:28.810078 [debug] [Thread-4 (]: Began running node model.citrus_trade.score_2022
[0m12:12:28.810509 [debug] [Thread-1 (]: Began compiling node model.citrus_trade.growth_score
[0m12:12:28.811199 [info ] [Thread-4 (]: 6 of 6 START sql table model analytics.score_2022 .............................. [RUN]
[0m12:12:28.816122 [debug] [Thread-1 (]: Writing injected SQL for node "model.citrus_trade.growth_score"
[0m12:12:28.816894 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.citrus_trade.score_2022'
[0m12:12:28.817723 [debug] [Thread-4 (]: Began compiling node model.citrus_trade.score_2022
[0m12:12:28.821749 [debug] [Thread-4 (]: Writing injected SQL for node "model.citrus_trade.score_2022"
[0m12:12:28.822610 [debug] [Thread-1 (]: Began executing node model.citrus_trade.growth_score
[0m12:12:28.825652 [debug] [Thread-1 (]: Writing runtime sql for node "model.citrus_trade.growth_score"
[0m12:12:28.828450 [debug] [Thread-4 (]: Began executing node model.citrus_trade.score_2022
[0m12:12:28.831142 [debug] [Thread-4 (]: Writing runtime sql for node "model.citrus_trade.score_2022"
[0m12:12:28.834107 [debug] [Thread-1 (]: Using snowflake connection "model.citrus_trade.growth_score"
[0m12:12:28.835265 [debug] [Thread-1 (]: On model.citrus_trade.growth_score: create or replace transient table TRHS.analytics.growth_score
    
    
    
    as (with 
    previous_year AS (
        select 
            declarant_iso,
            year,
            lag(total_value,1) over(partition by declarant_iso order by year) previous_year_value,
            total_value,
            first_value(total_value) over(partition by declarant_iso order by year) as first_year_value,
            last_value(total_value) over(partition by declarant_iso order by year) as last_year_value
        from TRHS.analytics.imports_by_year
    ),
    growth_speed AS (
        select 
            declarant_iso,
            year,
            first_year_value,
            last_year_value,
            (last_year_value - first_year_value)/first_year_value as growth_overall,
            previous_year_value,
            total_value,
            (total_value - previous_year_value)/total_value * 100 as growth_speed 
        from previous_year
    ),
    previous_year_growth_speed AS (
        select 
            declarant_iso,
            year,
            first_year_value,
            last_year_value,
            growth_overall,
            previous_year_value,
            total_value as current_value,
            growth_speed,
            lag(growth_speed,1) over(partition by declarant_iso order by year) previous_year_growth_speed,
        from growth_speed
        order by 1,2
    ),
    base AS (
        select 
            declarant_iso,
            year,
            first_year_value,
            last_year_value,
            growth_overall,
            previous_year_value,
            current_value,
            previous_year_growth_speed,
            growth_speed,
            growth_speed - previous_year_growth_speed as growth_acceleration,
            avg(growth_acceleration) over(partition by declarant_iso) as avg_acceleration
        from previous_year_growth_speed
    ),
    ok as (
        select 
            declarant_iso,
            year,
            first_year_value,
            last_year_value,
            growth_overall,
            (growth_overall - min(growth_overall) OVER())/(max(growth_overall) OVER() - min(growth_overall) OVER()) as growth_overall_norm,
            previous_year_value,
            current_value,
            -- previous_year_growth_speed,
            growth_speed,
            growth_acceleration,
            avg_acceleration,
            (avg_acceleration - min(avg_acceleration) OVER())/(max(avg_acceleration) OVER() - min(avg_acceleration) OVER()) as avg_acceleration_norm
        from base 
    )
    select 
        declarant_iso,
        year,
        current_value,
        growth_overall,
        growth_overall_norm,
        avg_acceleration,
        avg_acceleration_norm,
        growth_overall_norm * avg_acceleration_norm as growth_score
    from ok 
    order by growth_score DESC, declarant_iso, year asc
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.growth_score"} */;
[0m12:12:28.838781 [debug] [Thread-4 (]: Using snowflake connection "model.citrus_trade.score_2022"
[0m12:12:28.839108 [debug] [Thread-4 (]: On model.citrus_trade.score_2022: create or replace transient table TRHS.analytics.score_2022
    
    
    
    as (select distinct 
    declarant_iso,
    total_value,
    total_quantity,
    value_per_quantity,
    (total_value - min(total_value) over())/((max(total_value) over())-(min(total_value) over())) as score_value,
    (total_quantity - min(total_quantity) over())/((max(total_quantity) over())-(min(total_quantity) over())) as score_quantity,
    (value_per_quantity - min(value_per_quantity) over())/((max(value_per_quantity) over())-(min(value_per_quantity) over())) as score_price
from TRHS.analytics.imports_exports_2022
where flow = 1
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.score_2022"} */;
[0m12:12:28.839370 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:12:28.932455 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01c02ffc-0105-6ef9-0000-000420caef69
[0m12:12:28.933094 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 85 at position 146 unexpected ';'.
[0m12:12:28.935899 [debug] [Thread-1 (]: Database Error in model growth_score (models/analytics/growth_score.sql)
  001003 (42000): SQL compilation error:
  syntax error line 85 at position 146 unexpected ';'.
  compiled code at target/run/citrus_trade/models/analytics/growth_score.sql
[0m12:12:28.936384 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1def9033-7338-4f8c-9a86-9a5e9d6d8c4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a307140>]}
[0m12:12:28.936974 [error] [Thread-1 (]: 5 of 6 ERROR creating sql table model analytics.growth_score ................... [[31mERROR[0m in 0.13s]
[0m12:12:28.937437 [debug] [Thread-1 (]: Finished running node model.citrus_trade.growth_score
[0m12:12:28.937840 [debug] [Thread-7 (]: Marking all children of 'model.citrus_trade.growth_score' to be skipped because of status 'error'.  Reason: Database Error in model growth_score (models/analytics/growth_score.sql)
  001003 (42000): SQL compilation error:
  syntax error line 85 at position 146 unexpected ';'.
  compiled code at target/run/citrus_trade/models/analytics/growth_score.sql.
[0m12:12:30.575347 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.735 seconds
[0m12:12:30.580295 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1def9033-7338-4f8c-9a86-9a5e9d6d8c4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99968560>]}
[0m12:12:30.581102 [info ] [Thread-4 (]: 6 of 6 OK created sql table model analytics.score_2022 ......................... [[32mSUCCESS 1[0m in 1.76s]
[0m12:12:30.581961 [debug] [Thread-4 (]: Finished running node model.citrus_trade.score_2022
[0m12:12:30.584547 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:12:30.584936 [debug] [MainThread]: Connection 'model.citrus_trade.imports_by_year' was left open.
[0m12:12:30.585239 [debug] [MainThread]: On model.citrus_trade.imports_by_year: Close
[0m12:12:30.749319 [debug] [MainThread]: Connection 'model.citrus_trade.growth_score' was left open.
[0m12:12:30.750110 [debug] [MainThread]: On model.citrus_trade.growth_score: Close
[0m12:12:30.912507 [debug] [MainThread]: Connection 'model.citrus_trade.trade_by_declarant' was left open.
[0m12:12:30.913415 [debug] [MainThread]: On model.citrus_trade.trade_by_declarant: Close
[0m12:12:31.066667 [debug] [MainThread]: Connection 'model.citrus_trade.score_2022' was left open.
[0m12:12:31.067970 [debug] [MainThread]: On model.citrus_trade.score_2022: Close
[0m12:12:31.209750 [info ] [MainThread]: 
[0m12:12:31.212515 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 8.98 seconds (8.98s).
[0m12:12:31.215906 [debug] [MainThread]: Command end result
[0m12:12:31.266012 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m12:12:31.268605 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m12:12:31.274750 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt/target/run_results.json
[0m12:12:31.275004 [info ] [MainThread]: 
[0m12:12:31.275260 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:12:31.275501 [info ] [MainThread]: 
[0m12:12:31.275858 [error] [MainThread]: [31mFailure in model growth_score (models/analytics/growth_score.sql)[0m
[0m12:12:31.276178 [error] [MainThread]:   Database Error in model growth_score (models/analytics/growth_score.sql)
  001003 (42000): SQL compilation error:
  syntax error line 85 at position 146 unexpected ';'.
  compiled code at target/run/citrus_trade/models/analytics/growth_score.sql
[0m12:12:31.276384 [info ] [MainThread]: 
[0m12:12:31.276919 [info ] [MainThread]:   compiled code at target/compiled/citrus_trade/models/analytics/growth_score.sql
[0m12:12:31.277368 [info ] [MainThread]: 
[0m12:12:31.277861 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=6
[0m12:12:31.279268 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 9.644625, "process_in_blocks": "0", "process_kernel_time": 0.291535, "process_mem_max_rss": "167448", "process_out_blocks": "4200", "process_user_time": 2.068615}
[0m12:12:31.279658 [debug] [MainThread]: Command `dbt run` failed at 12:12:31.279591 after 9.65 seconds
[0m12:12:31.279960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ee1ef30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c4f0b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ebe2180>]}
[0m12:12:31.280239 [debug] [MainThread]: Flushing usage events
[0m12:12:32.536133 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:12:51.258348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88927140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87e67d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff887b1520>]}


============================== 12:12:51.263695 | f8b9f96b-6aa1-4209-ac47-8902b073dd0a ==============================
[0m12:12:51.263695 [info ] [MainThread]: Running with dbt=1.10.13
[0m12:12:51.264172 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'fail_fast': 'False', 'introspect': 'True', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'debug': 'False', 'log_cache_events': 'False', 'profiles_dir': '/app/dbt', 'log_format': 'default', 'static_parser': 'True', 'warn_error': 'None', 'invocation_command': 'dbt run', 'write_json': 'True', 'partial_parse': 'True', 'log_path': '/app/dbt/logs', 'version_check': 'True', 'printer_width': '80', 'target_path': 'None', 'no_print': 'None'}
[0m12:12:51.471400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f8b9f96b-6aa1-4209-ac47-8902b073dd0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8667ab10>]}
[0m12:12:51.503035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f8b9f96b-6aa1-4209-ac47-8902b073dd0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff865d9e80>]}
[0m12:12:51.503564 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m12:12:51.551491 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m12:12:51.663817 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:12:51.664521 [debug] [MainThread]: Partial parsing: updated file: citrus_trade://models/analytics/growth_score.sql
[0m12:12:51.785799 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.citrus_trade.visualisation
[0m12:12:51.792970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f8b9f96b-6aa1-4209-ac47-8902b073dd0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85eae6f0>]}
[0m12:12:51.836940 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m12:12:51.838626 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m12:12:51.847934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f8b9f96b-6aa1-4209-ac47-8902b073dd0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff860fdaf0>]}
[0m12:12:51.848239 [info ] [MainThread]: Found 6 models, 1 source, 632 macros
[0m12:12:51.848496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f8b9f96b-6aa1-4209-ac47-8902b073dd0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85b77c20>]}
[0m12:12:51.849880 [info ] [MainThread]: 
[0m12:12:51.850145 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:12:51.850387 [info ] [MainThread]: 
[0m12:12:51.850799 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:12:51.853534 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRHS'
[0m12:12:51.859289 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRHS'
[0m12:12:51.877920 [debug] [ThreadPool]: Using snowflake connection "list_TRHS"
[0m12:12:51.878298 [debug] [ThreadPool]: Using snowflake connection "list_TRHS"
[0m12:12:51.878471 [debug] [ThreadPool]: On list_TRHS: show terse schemas in database TRHS
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS"} */
[0m12:12:51.878690 [debug] [ThreadPool]: On list_TRHS: show terse schemas in database TRHS
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS"} */
[0m12:12:51.878875 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:12:51.879087 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:12:55.473605 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 3.595 seconds
[0m12:12:55.476006 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 3.597 seconds
[0m12:12:55.484795 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRHS, now list_TRHS_analytics)
[0m12:12:55.492537 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRHS, now list_TRHS_staging)
[0m12:12:55.509136 [debug] [ThreadPool]: Using snowflake connection "list_TRHS_analytics"
[0m12:12:55.512986 [debug] [ThreadPool]: Using snowflake connection "list_TRHS_staging"
[0m12:12:55.513344 [debug] [ThreadPool]: On list_TRHS_analytics: show objects in TRHS.analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS_analytics"} */;
[0m12:12:55.513803 [debug] [ThreadPool]: On list_TRHS_staging: show objects in TRHS.staging
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS_staging"} */;
[0m12:12:55.681273 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.165 seconds
[0m12:12:55.749572 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.235 seconds
[0m12:12:55.757511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f8b9f96b-6aa1-4209-ac47-8902b073dd0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85b49430>]}
[0m12:12:55.766649 [debug] [Thread-1 (]: Began running node model.citrus_trade.stg_trade
[0m12:12:55.767478 [info ] [Thread-1 (]: 1 of 6 START sql table model staging.stg_trade ................................. [RUN]
[0m12:12:55.768199 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_TRHS_analytics, now model.citrus_trade.stg_trade)
[0m12:12:55.768832 [debug] [Thread-1 (]: Began compiling node model.citrus_trade.stg_trade
[0m12:12:55.779189 [debug] [Thread-1 (]: Writing injected SQL for node "model.citrus_trade.stg_trade"
[0m12:12:55.780777 [debug] [Thread-1 (]: Began executing node model.citrus_trade.stg_trade
[0m12:12:55.810070 [debug] [Thread-1 (]: Writing runtime sql for node "model.citrus_trade.stg_trade"
[0m12:12:55.811640 [debug] [Thread-1 (]: Using snowflake connection "model.citrus_trade.stg_trade"
[0m12:12:55.811977 [debug] [Thread-1 (]: On model.citrus_trade.stg_trade: create or replace transient table TRHS.staging.stg_trade
    
    
    
    as (select
  value:DECLARANT::int as declarant,
  value:DECLARANT_ISO::string as declarant_iso,
  value:PARTNER::string as partner,
  value:PARTNER_ISO::string as partner_iso,
  value:FLOW::int as flow,
  value:TRANSPORT_MODE::int as transport_mode,
  value:PERIOD::int as period,
  value:HS4::string as hs4,
  value:HS4_NAME::string as hs4_name,
  value:HS6::string as hs6,
  value:HS6_NAME::string as hs6_name,
  value:VALUE_IN_EUROS::float as value_in_euros,
  value:QUANTITY_IN_KG::float as quantity_in_kg
from trhs.staging.citrus_ext
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.stg_trade"} */;
[0m12:12:56.743453 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.931 seconds
[0m12:12:56.756702 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f8b9f96b-6aa1-4209-ac47-8902b073dd0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88902570>]}
[0m12:12:56.757128 [info ] [Thread-1 (]: 1 of 6 OK created sql table model staging.stg_trade ............................ [[32mSUCCESS 1[0m in 0.99s]
[0m12:12:56.757562 [debug] [Thread-1 (]: Finished running node model.citrus_trade.stg_trade
[0m12:12:56.758234 [debug] [Thread-3 (]: Began running node model.citrus_trade.trade_by_declarant
[0m12:12:56.758544 [info ] [Thread-3 (]: 2 of 6 START sql table model analytics.trade_by_declarant ...................... [RUN]
[0m12:12:56.758935 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.citrus_trade.trade_by_declarant'
[0m12:12:56.759164 [debug] [Thread-3 (]: Began compiling node model.citrus_trade.trade_by_declarant
[0m12:12:56.762338 [debug] [Thread-3 (]: Writing injected SQL for node "model.citrus_trade.trade_by_declarant"
[0m12:12:56.763173 [debug] [Thread-3 (]: Began executing node model.citrus_trade.trade_by_declarant
[0m12:12:56.764617 [debug] [Thread-3 (]: Writing runtime sql for node "model.citrus_trade.trade_by_declarant"
[0m12:12:56.765498 [debug] [Thread-3 (]: Using snowflake connection "model.citrus_trade.trade_by_declarant"
[0m12:12:56.765699 [debug] [Thread-3 (]: On model.citrus_trade.trade_by_declarant: create or replace transient table TRHS.analytics.trade_by_declarant
    
    
    
    as (select 
    declarant,
    declarant_iso,
    partner,
    partner_iso,
    flow,
    transport_mode,
    year(to_date(left(period,4),'YYYY')) as year,
    period,
    hs6,
    hs6_name,
    sum(value_in_euros) as value,
    sum(quantity_in_kg) as quantity
from TRHS.staging.stg_trade
group by 1,2,3,4,5,6,7,8,9,10
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.trade_by_declarant"} */;
[0m12:12:56.765937 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:12:58.807375 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 2.041 seconds
[0m12:12:58.813319 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f8b9f96b-6aa1-4209-ac47-8902b073dd0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84146000>]}
[0m12:12:58.815341 [info ] [Thread-3 (]: 2 of 6 OK created sql table model analytics.trade_by_declarant ................. [[32mSUCCESS 1[0m in 2.05s]
[0m12:12:58.816552 [debug] [Thread-3 (]: Finished running node model.citrus_trade.trade_by_declarant
[0m12:12:58.818115 [debug] [Thread-2 (]: Began running node model.citrus_trade.imports_by_year
[0m12:12:58.818792 [debug] [Thread-1 (]: Began running node model.citrus_trade.imports_exports_2022
[0m12:12:58.819454 [info ] [Thread-2 (]: 3 of 6 START sql table model analytics.imports_by_year ......................... [RUN]
[0m12:12:58.820540 [info ] [Thread-1 (]: 4 of 6 START sql table model analytics.imports_exports_2022 .................... [RUN]
[0m12:12:58.822267 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.citrus_trade.stg_trade, now model.citrus_trade.imports_exports_2022)
[0m12:12:58.822922 [debug] [Thread-1 (]: Began compiling node model.citrus_trade.imports_exports_2022
[0m12:12:58.821586 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_TRHS_staging, now model.citrus_trade.imports_by_year)
[0m12:12:58.828455 [debug] [Thread-2 (]: Began compiling node model.citrus_trade.imports_by_year
[0m12:12:58.827899 [debug] [Thread-1 (]: Writing injected SQL for node "model.citrus_trade.imports_exports_2022"
[0m12:12:58.832136 [debug] [Thread-2 (]: Writing injected SQL for node "model.citrus_trade.imports_by_year"
[0m12:12:58.834252 [debug] [Thread-1 (]: Began executing node model.citrus_trade.imports_exports_2022
[0m12:12:58.837961 [debug] [Thread-1 (]: Writing runtime sql for node "model.citrus_trade.imports_exports_2022"
[0m12:12:58.838356 [debug] [Thread-2 (]: Began executing node model.citrus_trade.imports_by_year
[0m12:12:58.841149 [debug] [Thread-2 (]: Writing runtime sql for node "model.citrus_trade.imports_by_year"
[0m12:12:58.843281 [debug] [Thread-1 (]: Using snowflake connection "model.citrus_trade.imports_exports_2022"
[0m12:12:58.843968 [debug] [Thread-1 (]: On model.citrus_trade.imports_exports_2022: create or replace transient table TRHS.analytics.imports_exports_2022
    
    
    
    as (select
    declarant_iso,
    flow,
    sum(value) over(partition by declarant_iso, flow) as total_value,
    sum(quantity) over(partition by declarant_iso, flow) as total_quantity,
    total_value/nullif(total_quantity,0) as value_per_quantity
from TRHS.analytics.trade_by_declarant
where hs6 = '080510'
group by 
    declarant_iso,
    flow,
    value,
    quantity
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.imports_exports_2022"} */;
[0m12:12:58.844913 [debug] [Thread-2 (]: Using snowflake connection "model.citrus_trade.imports_by_year"
[0m12:12:58.847003 [debug] [Thread-2 (]: On model.citrus_trade.imports_by_year: create or replace transient table TRHS.analytics.imports_by_year
    
    
    
    as (select
    declarant_iso,
    year,
    sum(value) as total_value,
    sum(quantity) as total_quantity,
    total_value/nullif(total_quantity,0) as value_per_quantity
from TRHS.analytics.trade_by_declarant
where flow = 1
and hs6 = '080510'
group by 1,2
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.imports_by_year"} */;
[0m12:12:59.615706 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.770 seconds
[0m12:12:59.617377 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.770 seconds
[0m12:12:59.624734 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f8b9f96b-6aa1-4209-ac47-8902b073dd0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff841868a0>]}
[0m12:12:59.625858 [info ] [Thread-2 (]: 3 of 6 OK created sql table model analytics.imports_by_year .................... [[32mSUCCESS 1[0m in 0.80s]
[0m12:12:59.621588 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f8b9f96b-6aa1-4209-ac47-8902b073dd0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ff89b20>]}
[0m12:12:59.626878 [debug] [Thread-2 (]: Finished running node model.citrus_trade.imports_by_year
[0m12:12:59.627908 [info ] [Thread-1 (]: 4 of 6 OK created sql table model analytics.imports_exports_2022 ............... [[32mSUCCESS 1[0m in 0.80s]
[0m12:12:59.629377 [debug] [Thread-1 (]: Finished running node model.citrus_trade.imports_exports_2022
[0m12:12:59.630074 [debug] [Thread-3 (]: Began running node model.citrus_trade.growth_score
[0m12:12:59.631158 [info ] [Thread-3 (]: 5 of 6 START sql table model analytics.growth_score ............................ [RUN]
[0m12:12:59.631748 [debug] [Thread-2 (]: Began running node model.citrus_trade.score_2022
[0m12:12:59.632413 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.citrus_trade.trade_by_declarant, now model.citrus_trade.growth_score)
[0m12:12:59.633081 [info ] [Thread-2 (]: 6 of 6 START sql table model analytics.score_2022 .............................. [RUN]
[0m12:12:59.633770 [debug] [Thread-3 (]: Began compiling node model.citrus_trade.growth_score
[0m12:12:59.634300 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.citrus_trade.imports_by_year, now model.citrus_trade.score_2022)
[0m12:12:59.640891 [debug] [Thread-3 (]: Writing injected SQL for node "model.citrus_trade.growth_score"
[0m12:12:59.641626 [debug] [Thread-2 (]: Began compiling node model.citrus_trade.score_2022
[0m12:12:59.645165 [debug] [Thread-2 (]: Writing injected SQL for node "model.citrus_trade.score_2022"
[0m12:12:59.646297 [debug] [Thread-3 (]: Began executing node model.citrus_trade.growth_score
[0m12:12:59.649479 [debug] [Thread-3 (]: Writing runtime sql for node "model.citrus_trade.growth_score"
[0m12:12:59.650175 [debug] [Thread-2 (]: Began executing node model.citrus_trade.score_2022
[0m12:12:59.653298 [debug] [Thread-2 (]: Writing runtime sql for node "model.citrus_trade.score_2022"
[0m12:12:59.657009 [debug] [Thread-3 (]: Using snowflake connection "model.citrus_trade.growth_score"
[0m12:12:59.657774 [debug] [Thread-3 (]: On model.citrus_trade.growth_score: create or replace transient table TRHS.analytics.growth_score
    
    
    
    as (with 
    previous_year AS (
        select 
            declarant_iso,
            year,
            lag(total_value,1) over(partition by declarant_iso order by year) previous_year_value,
            total_value,
            first_value(total_value) over(partition by declarant_iso order by year) as first_year_value,
            last_value(total_value) over(partition by declarant_iso order by year) as last_year_value
        from TRHS.analytics.imports_by_year
    ),
    growth_speed AS (
        select 
            declarant_iso,
            year,
            first_year_value,
            last_year_value,
            (last_year_value - first_year_value)/first_year_value as growth_overall,
            previous_year_value,
            total_value,
            (total_value - previous_year_value)/total_value * 100 as growth_speed 
        from previous_year
    ),
    previous_year_growth_speed AS (
        select 
            declarant_iso,
            year,
            first_year_value,
            last_year_value,
            growth_overall,
            previous_year_value,
            total_value as current_value,
            growth_speed,
            lag(growth_speed,1) over(partition by declarant_iso order by year) previous_year_growth_speed,
        from growth_speed
        order by 1,2
    ),
    base AS (
        select 
            declarant_iso,
            year,
            first_year_value,
            last_year_value,
            growth_overall,
            previous_year_value,
            current_value,
            previous_year_growth_speed,
            growth_speed,
            growth_speed - previous_year_growth_speed as growth_acceleration,
            avg(growth_acceleration) over(partition by declarant_iso) as avg_acceleration
        from previous_year_growth_speed
    ),
    ok as (
        select 
            declarant_iso,
            year,
            first_year_value,
            last_year_value,
            growth_overall,
            (growth_overall - min(growth_overall) OVER())/(max(growth_overall) OVER() - min(growth_overall) OVER()) as growth_overall_norm,
            previous_year_value,
            current_value,
            -- previous_year_growth_speed,
            growth_speed,
            growth_acceleration,
            avg_acceleration,
            (avg_acceleration - min(avg_acceleration) OVER())/(max(avg_acceleration) OVER() - min(avg_acceleration) OVER()) as avg_acceleration_norm
        from base 
    )
    select 
        declarant_iso,
        year,
        current_value,
        growth_overall,
        growth_overall_norm,
        avg_acceleration,
        avg_acceleration_norm,
        growth_overall_norm * avg_acceleration_norm as growth_score
    from ok
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.growth_score"} */;
[0m12:12:59.660466 [debug] [Thread-2 (]: Using snowflake connection "model.citrus_trade.score_2022"
[0m12:12:59.661079 [debug] [Thread-2 (]: On model.citrus_trade.score_2022: create or replace transient table TRHS.analytics.score_2022
    
    
    
    as (select distinct 
    declarant_iso,
    total_value,
    total_quantity,
    value_per_quantity,
    (total_value - min(total_value) over())/((max(total_value) over())-(min(total_value) over())) as score_value,
    (total_quantity - min(total_quantity) over())/((max(total_quantity) over())-(min(total_quantity) over())) as score_quantity,
    (value_per_quantity - min(value_per_quantity) over())/((max(value_per_quantity) over())-(min(value_per_quantity) over())) as score_price
from TRHS.analytics.imports_exports_2022
where flow = 1
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.score_2022"} */;
[0m12:13:00.434268 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.775 seconds
[0m12:13:00.436294 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.775 seconds
[0m12:13:00.444670 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f8b9f96b-6aa1-4209-ac47-8902b073dd0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ff4e1e0>]}
[0m12:13:00.441673 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f8b9f96b-6aa1-4209-ac47-8902b073dd0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8418bbc0>]}
[0m12:13:00.446112 [info ] [Thread-2 (]: 6 of 6 OK created sql table model analytics.score_2022 ......................... [[32mSUCCESS 1[0m in 0.81s]
[0m12:13:00.448104 [info ] [Thread-3 (]: 5 of 6 OK created sql table model analytics.growth_score ....................... [[32mSUCCESS 1[0m in 0.81s]
[0m12:13:00.449714 [debug] [Thread-2 (]: Finished running node model.citrus_trade.score_2022
[0m12:13:00.450506 [debug] [Thread-3 (]: Finished running node model.citrus_trade.growth_score
[0m12:13:00.453953 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:13:00.454597 [debug] [MainThread]: Connection 'model.citrus_trade.score_2022' was left open.
[0m12:13:00.455068 [debug] [MainThread]: On model.citrus_trade.score_2022: Close
[0m12:13:00.650216 [debug] [MainThread]: Connection 'model.citrus_trade.imports_exports_2022' was left open.
[0m12:13:00.651304 [debug] [MainThread]: On model.citrus_trade.imports_exports_2022: Close
[0m12:13:00.793830 [debug] [MainThread]: Connection 'model.citrus_trade.growth_score' was left open.
[0m12:13:00.795198 [debug] [MainThread]: On model.citrus_trade.growth_score: Close
[0m12:13:00.970737 [info ] [MainThread]: 
[0m12:13:00.971546 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 9.12 seconds (9.12s).
[0m12:13:00.974446 [debug] [MainThread]: Command end result
[0m12:13:01.029318 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m12:13:01.031612 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m12:13:01.037474 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt/target/run_results.json
[0m12:13:01.037773 [info ] [MainThread]: 
[0m12:13:01.038126 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:13:01.038498 [info ] [MainThread]: 
[0m12:13:01.038850 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=6
[0m12:13:01.040817 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.812395, "process_in_blocks": "0", "process_kernel_time": 0.3723, "process_mem_max_rss": "165064", "process_out_blocks": "4197", "process_user_time": 1.845403}
[0m12:13:01.041495 [debug] [MainThread]: Command `dbt run` succeeded at 12:13:01.041297 after 9.81 seconds
[0m12:13:01.042532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85ede420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff881d5b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff881d68a0>]}
[0m12:13:01.042964 [debug] [MainThread]: Flushing usage events
[0m12:13:02.367644 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:39:51.947666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa632e060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9ffacc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa66d8440>]}


============================== 12:39:51.951894 | 48343d21-a61a-4d4d-ba29-bbbf50c7ba10 ==============================
[0m12:39:51.951894 [info ] [MainThread]: Running with dbt=1.10.13
[0m12:39:51.952304 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'target_path': 'None', 'printer_width': '80', 'indirect_selection': 'eager', 'version_check': 'True', 'use_colors': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'no_print': 'None', 'debug': 'False', 'fail_fast': 'False', 'cache_selected_only': 'False', 'warn_error': 'None', 'use_experimental_parser': 'False', 'write_json': 'True', 'log_path': '/app/dbt/logs', 'profiles_dir': '/app/dbt', 'empty': 'False', 'introspect': 'True', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run', 'log_cache_events': 'False'}
[0m12:39:52.169746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '48343d21-a61a-4d4d-ba29-bbbf50c7ba10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa417bce0>]}
[0m12:39:52.200334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '48343d21-a61a-4d4d-ba29-bbbf50c7ba10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa42dc050>]}
[0m12:39:52.200805 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m12:39:52.251653 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m12:39:52.368412 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:39:52.368823 [debug] [MainThread]: Partial parsing: updated file: citrus_trade://models/analytics/growth_score.sql
[0m12:39:52.489398 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.citrus_trade.visualisation
[0m12:39:52.496088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '48343d21-a61a-4d4d-ba29-bbbf50c7ba10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3d092b0>]}
[0m12:39:52.539899 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m12:39:52.541328 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m12:39:52.549810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '48343d21-a61a-4d4d-ba29-bbbf50c7ba10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3ff9580>]}
[0m12:39:52.550090 [info ] [MainThread]: Found 6 models, 1 source, 632 macros
[0m12:39:52.550298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '48343d21-a61a-4d4d-ba29-bbbf50c7ba10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3d00fb0>]}
[0m12:39:52.551372 [info ] [MainThread]: 
[0m12:39:52.551633 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:39:52.551978 [info ] [MainThread]: 
[0m12:39:52.552474 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:39:52.555166 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRHS'
[0m12:39:52.560840 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRHS'
[0m12:39:52.580894 [debug] [ThreadPool]: Using snowflake connection "list_TRHS"
[0m12:39:52.581236 [debug] [ThreadPool]: Using snowflake connection "list_TRHS"
[0m12:39:52.581423 [debug] [ThreadPool]: On list_TRHS: show terse schemas in database TRHS
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS"} */
[0m12:39:52.581681 [debug] [ThreadPool]: On list_TRHS: show terse schemas in database TRHS
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS"} */
[0m12:39:52.581880 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:39:52.582103 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:39:54.190933 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.609 seconds
[0m12:39:54.196376 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.614 seconds
[0m12:39:54.200822 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRHS, now list_TRHS_staging)
[0m12:39:54.201846 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRHS, now list_TRHS_analytics)
[0m12:39:54.224291 [debug] [ThreadPool]: Using snowflake connection "list_TRHS_staging"
[0m12:39:54.228523 [debug] [ThreadPool]: Using snowflake connection "list_TRHS_analytics"
[0m12:39:54.228841 [debug] [ThreadPool]: On list_TRHS_staging: show objects in TRHS.staging
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS_staging"} */;
[0m12:39:54.229311 [debug] [ThreadPool]: On list_TRHS_analytics: show objects in TRHS.analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS_analytics"} */;
[0m12:39:54.382713 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.151 seconds
[0m12:39:54.384559 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.155 seconds
[0m12:39:54.395132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '48343d21-a61a-4d4d-ba29-bbbf50c7ba10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4280440>]}
[0m12:39:54.401824 [debug] [Thread-1 (]: Began running node model.citrus_trade.stg_trade
[0m12:39:54.402601 [info ] [Thread-1 (]: 1 of 6 START sql table model staging.stg_trade ................................. [RUN]
[0m12:39:54.403259 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_TRHS_staging, now model.citrus_trade.stg_trade)
[0m12:39:54.403884 [debug] [Thread-1 (]: Began compiling node model.citrus_trade.stg_trade
[0m12:39:54.413493 [debug] [Thread-1 (]: Writing injected SQL for node "model.citrus_trade.stg_trade"
[0m12:39:54.415310 [debug] [Thread-1 (]: Began executing node model.citrus_trade.stg_trade
[0m12:39:54.444206 [debug] [Thread-1 (]: Writing runtime sql for node "model.citrus_trade.stg_trade"
[0m12:39:54.447081 [debug] [Thread-1 (]: Using snowflake connection "model.citrus_trade.stg_trade"
[0m12:39:54.447528 [debug] [Thread-1 (]: On model.citrus_trade.stg_trade: create or replace transient table TRHS.staging.stg_trade
    
    
    
    as (select
  value:DECLARANT::int as declarant,
  value:DECLARANT_ISO::string as declarant_iso,
  value:PARTNER::string as partner,
  value:PARTNER_ISO::string as partner_iso,
  value:FLOW::int as flow,
  value:TRANSPORT_MODE::int as transport_mode,
  value:PERIOD::int as period,
  value:HS4::string as hs4,
  value:HS4_NAME::string as hs4_name,
  value:HS6::string as hs6,
  value:HS6_NAME::string as hs6_name,
  value:VALUE_IN_EUROS::float as value_in_euros,
  value:QUANTITY_IN_KG::float as quantity_in_kg
from trhs.staging.citrus_ext
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.stg_trade"} */;
[0m12:39:55.590588 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.142 seconds
[0m12:39:55.624224 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '48343d21-a61a-4d4d-ba29-bbbf50c7ba10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6806b70>]}
[0m12:39:55.625119 [info ] [Thread-1 (]: 1 of 6 OK created sql table model staging.stg_trade ............................ [[32mSUCCESS 1[0m in 1.22s]
[0m12:39:55.625911 [debug] [Thread-1 (]: Finished running node model.citrus_trade.stg_trade
[0m12:39:55.627061 [debug] [Thread-3 (]: Began running node model.citrus_trade.trade_by_declarant
[0m12:39:55.627624 [info ] [Thread-3 (]: 2 of 6 START sql table model analytics.trade_by_declarant ...................... [RUN]
[0m12:39:55.628248 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.citrus_trade.trade_by_declarant'
[0m12:39:55.628631 [debug] [Thread-3 (]: Began compiling node model.citrus_trade.trade_by_declarant
[0m12:39:55.634245 [debug] [Thread-3 (]: Writing injected SQL for node "model.citrus_trade.trade_by_declarant"
[0m12:39:55.636526 [debug] [Thread-3 (]: Began executing node model.citrus_trade.trade_by_declarant
[0m12:39:55.639020 [debug] [Thread-3 (]: Writing runtime sql for node "model.citrus_trade.trade_by_declarant"
[0m12:39:55.640658 [debug] [Thread-3 (]: Using snowflake connection "model.citrus_trade.trade_by_declarant"
[0m12:39:55.640999 [debug] [Thread-3 (]: On model.citrus_trade.trade_by_declarant: create or replace transient table TRHS.analytics.trade_by_declarant
    
    
    
    as (select 
    declarant,
    declarant_iso,
    partner,
    partner_iso,
    flow,
    transport_mode,
    year(to_date(left(period,4),'YYYY')) as year,
    period,
    hs6,
    hs6_name,
    sum(value_in_euros) as value,
    sum(quantity_in_kg) as quantity
from TRHS.staging.stg_trade
group by 1,2,3,4,5,6,7,8,9,10
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.trade_by_declarant"} */;
[0m12:39:55.641371 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:39:57.638373 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.997 seconds
[0m12:39:57.643032 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '48343d21-a61a-4d4d-ba29-bbbf50c7ba10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa29ac620>]}
[0m12:39:57.644232 [info ] [Thread-3 (]: 2 of 6 OK created sql table model analytics.trade_by_declarant ................. [[32mSUCCESS 1[0m in 2.01s]
[0m12:39:57.645382 [debug] [Thread-3 (]: Finished running node model.citrus_trade.trade_by_declarant
[0m12:39:57.646956 [debug] [Thread-2 (]: Began running node model.citrus_trade.imports_by_year
[0m12:39:57.647583 [debug] [Thread-1 (]: Began running node model.citrus_trade.imports_exports_2022
[0m12:39:57.648200 [info ] [Thread-2 (]: 3 of 6 START sql table model analytics.imports_by_year ......................... [RUN]
[0m12:39:57.649302 [info ] [Thread-1 (]: 4 of 6 START sql table model analytics.imports_exports_2022 .................... [RUN]
[0m12:39:57.650978 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.citrus_trade.stg_trade, now model.citrus_trade.imports_exports_2022)
[0m12:39:57.651606 [debug] [Thread-1 (]: Began compiling node model.citrus_trade.imports_exports_2022
[0m12:39:57.650234 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_TRHS_analytics, now model.citrus_trade.imports_by_year)
[0m12:39:57.657203 [debug] [Thread-2 (]: Began compiling node model.citrus_trade.imports_by_year
[0m12:39:57.656676 [debug] [Thread-1 (]: Writing injected SQL for node "model.citrus_trade.imports_exports_2022"
[0m12:39:57.660925 [debug] [Thread-2 (]: Writing injected SQL for node "model.citrus_trade.imports_by_year"
[0m12:39:57.663542 [debug] [Thread-1 (]: Began executing node model.citrus_trade.imports_exports_2022
[0m12:39:57.667247 [debug] [Thread-1 (]: Writing runtime sql for node "model.citrus_trade.imports_exports_2022"
[0m12:39:57.667839 [debug] [Thread-2 (]: Began executing node model.citrus_trade.imports_by_year
[0m12:39:57.670790 [debug] [Thread-2 (]: Writing runtime sql for node "model.citrus_trade.imports_by_year"
[0m12:39:57.672281 [debug] [Thread-1 (]: Using snowflake connection "model.citrus_trade.imports_exports_2022"
[0m12:39:57.672739 [debug] [Thread-1 (]: On model.citrus_trade.imports_exports_2022: create or replace transient table TRHS.analytics.imports_exports_2022
    
    
    
    as (select
    declarant_iso,
    flow,
    sum(value) over(partition by declarant_iso, flow) as total_value,
    sum(quantity) over(partition by declarant_iso, flow) as total_quantity,
    total_value/nullif(total_quantity,0) as value_per_quantity
from TRHS.analytics.trade_by_declarant
where hs6 = '080510'
group by 
    declarant_iso,
    flow,
    value,
    quantity
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.imports_exports_2022"} */;
[0m12:39:57.675348 [debug] [Thread-2 (]: Using snowflake connection "model.citrus_trade.imports_by_year"
[0m12:39:57.675841 [debug] [Thread-2 (]: On model.citrus_trade.imports_by_year: create or replace transient table TRHS.analytics.imports_by_year
    
    
    
    as (select
    declarant_iso,
    year,
    sum(value) as total_value,
    sum(quantity) as total_quantity,
    total_value/nullif(total_quantity,0) as value_per_quantity
from TRHS.analytics.trade_by_declarant
where flow = 1
and hs6 = '080510'
group by 1,2
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.imports_by_year"} */;
[0m12:39:58.315196 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.639 seconds
[0m12:39:58.320495 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '48343d21-a61a-4d4d-ba29-bbbf50c7ba10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1dbe1b0>]}
[0m12:39:58.321659 [info ] [Thread-2 (]: 3 of 6 OK created sql table model analytics.imports_by_year .................... [[32mSUCCESS 1[0m in 0.67s]
[0m12:39:58.322742 [debug] [Thread-2 (]: Finished running node model.citrus_trade.imports_by_year
[0m12:39:58.323940 [debug] [Thread-3 (]: Began running node model.citrus_trade.growth_score
[0m12:39:58.324753 [info ] [Thread-3 (]: 5 of 6 START sql table model analytics.growth_score ............................ [RUN]
[0m12:39:58.325525 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.citrus_trade.trade_by_declarant, now model.citrus_trade.growth_score)
[0m12:39:58.326182 [debug] [Thread-3 (]: Began compiling node model.citrus_trade.growth_score
[0m12:39:58.333386 [debug] [Thread-3 (]: Writing injected SQL for node "model.citrus_trade.growth_score"
[0m12:39:58.335043 [debug] [Thread-3 (]: Began executing node model.citrus_trade.growth_score
[0m12:39:58.338540 [debug] [Thread-3 (]: Writing runtime sql for node "model.citrus_trade.growth_score"
[0m12:39:58.343127 [debug] [Thread-3 (]: Using snowflake connection "model.citrus_trade.growth_score"
[0m12:39:58.343693 [debug] [Thread-3 (]: On model.citrus_trade.growth_score: create or replace transient table TRHS.analytics.growth_score
    
    
    
    as (with 
    previous_year AS (
        select 
            declarant_iso,
            year,
            lag(total_value,1) over(partition by declarant_iso order by year) previous_year_value,
            total_value,
            first_value(total_value) over(partition by declarant_iso order by year) as first_year_value,
            last_value(total_value) over(partition by declarant_iso order by year) as last_year_value
        from TRHS.analytics.imports_by_year
    ),
    growth_speed AS (
        select 
            declarant_iso,
            year,
            first_year_value,
            last_year_value,
            (last_year_value - first_year_value)/first_year_value as growth_overall,
            previous_year_value,
            total_value,
            (total_value - previous_year_value)/total_value * 100 as growth_speed 
        from previous_year
    ),
    previous_year_growth_speed AS (
        select 
            declarant_iso,
            year,
            first_year_value,
            last_year_value,
            growth_overall,
            previous_year_value,
            total_value as current_value,
            growth_speed,
            lag(growth_speed,1) over(partition by declarant_iso order by year) previous_year_growth_speed,
        from growth_speed
        order by 1,2
    ),
    base AS (
        select 
            declarant_iso,
            year,
            first_year_value,
            last_year_value,
            growth_overall,
            previous_year_value,
            current_value,
            previous_year_growth_speed,
            growth_speed,
            growth_speed - previous_year_growth_speed as growth_acceleration,
            avg(growth_acceleration) over(partition by declarant_iso) as avg_acceleration
        from previous_year_growth_speed
    ),
    ok as (
        select 
            declarant_iso,
            year,
            first_year_value,
            last_year_value,
            growth_overall,
            (growth_overall - min(growth_overall) OVER())/(max(growth_overall) OVER() - min(growth_overall) OVER()) as growth_overall_norm,
            previous_year_value,
            current_value,
            -- previous_year_growth_speed,
            growth_speed,
            growth_acceleration,
            avg_acceleration,
            (avg_acceleration - min(avg_acceleration) OVER())/(max(avg_acceleration) OVER() - min(avg_acceleration) OVER()) as avg_acceleration_norm
        from base 
    )
    select 
        declarant_iso,
        year,
        current_value,
        growth_speed,
        growth_acceleration,
        growth_overall,
        growth_overall_norm,
        avg_acceleration,
        avg_acceleration_norm,
        growth_overall_norm * avg_acceleration_norm as growth_score
    from ok
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.growth_score"} */;
[0m12:39:58.356453 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.683 seconds
[0m12:39:58.358578 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '48343d21-a61a-4d4d-ba29-bbbf50c7ba10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa07c73b0>]}
[0m12:39:58.359272 [info ] [Thread-1 (]: 4 of 6 OK created sql table model analytics.imports_exports_2022 ............... [[32mSUCCESS 1[0m in 0.71s]
[0m12:39:58.359940 [debug] [Thread-1 (]: Finished running node model.citrus_trade.imports_exports_2022
[0m12:39:58.360715 [debug] [Thread-2 (]: Began running node model.citrus_trade.score_2022
[0m12:39:58.361236 [info ] [Thread-2 (]: 6 of 6 START sql table model analytics.score_2022 .............................. [RUN]
[0m12:39:58.361718 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.citrus_trade.imports_by_year, now model.citrus_trade.score_2022)
[0m12:39:58.362159 [debug] [Thread-2 (]: Began compiling node model.citrus_trade.score_2022
[0m12:39:58.365144 [debug] [Thread-2 (]: Writing injected SQL for node "model.citrus_trade.score_2022"
[0m12:39:58.366338 [debug] [Thread-2 (]: Began executing node model.citrus_trade.score_2022
[0m12:39:58.368916 [debug] [Thread-2 (]: Writing runtime sql for node "model.citrus_trade.score_2022"
[0m12:39:58.370394 [debug] [Thread-2 (]: Using snowflake connection "model.citrus_trade.score_2022"
[0m12:39:58.370849 [debug] [Thread-2 (]: On model.citrus_trade.score_2022: create or replace transient table TRHS.analytics.score_2022
    
    
    
    as (select distinct 
    declarant_iso,
    total_value,
    total_quantity,
    value_per_quantity,
    (total_value - min(total_value) over())/((max(total_value) over())-(min(total_value) over())) as score_value,
    (total_quantity - min(total_quantity) over())/((max(total_quantity) over())-(min(total_quantity) over())) as score_quantity,
    (value_per_quantity - min(value_per_quantity) over())/((max(value_per_quantity) over())-(min(value_per_quantity) over())) as score_price
from TRHS.analytics.imports_exports_2022
where flow = 1
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.score_2022"} */;
[0m12:39:59.338108 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.966 seconds
[0m12:39:59.343265 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '48343d21-a61a-4d4d-ba29-bbbf50c7ba10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa079a420>]}
[0m12:39:59.344765 [info ] [Thread-2 (]: 6 of 6 OK created sql table model analytics.score_2022 ......................... [[32mSUCCESS 1[0m in 0.98s]
[0m12:39:59.345920 [debug] [Thread-2 (]: Finished running node model.citrus_trade.score_2022
[0m12:39:59.430602 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.086 seconds
[0m12:39:59.435462 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '48343d21-a61a-4d4d-ba29-bbbf50c7ba10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1dcb7a0>]}
[0m12:39:59.436944 [info ] [Thread-3 (]: 5 of 6 OK created sql table model analytics.growth_score ....................... [[32mSUCCESS 1[0m in 1.11s]
[0m12:39:59.438166 [debug] [Thread-3 (]: Finished running node model.citrus_trade.growth_score
[0m12:39:59.440983 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:39:59.441581 [debug] [MainThread]: Connection 'model.citrus_trade.score_2022' was left open.
[0m12:39:59.442154 [debug] [MainThread]: On model.citrus_trade.score_2022: Close
[0m12:39:59.580116 [debug] [MainThread]: Connection 'model.citrus_trade.imports_exports_2022' was left open.
[0m12:39:59.581534 [debug] [MainThread]: On model.citrus_trade.imports_exports_2022: Close
[0m12:39:59.731638 [debug] [MainThread]: Connection 'model.citrus_trade.growth_score' was left open.
[0m12:39:59.732732 [debug] [MainThread]: On model.citrus_trade.growth_score: Close
[0m12:39:59.879779 [info ] [MainThread]: 
[0m12:39:59.881186 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 7.33 seconds (7.33s).
[0m12:39:59.884803 [debug] [MainThread]: Command end result
[0m12:39:59.930309 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m12:39:59.932289 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m12:39:59.937731 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt/target/run_results.json
[0m12:39:59.937961 [info ] [MainThread]: 
[0m12:39:59.938222 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:39:59.938480 [info ] [MainThread]: 
[0m12:39:59.939008 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=6
[0m12:39:59.939895 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.029311, "process_in_blocks": "0", "process_kernel_time": 0.423832, "process_mem_max_rss": "164940", "process_out_blocks": "4197", "process_user_time": 1.79701}
[0m12:39:59.940218 [debug] [MainThread]: Command `dbt run` succeeded at 12:39:59.940154 after 8.03 seconds
[0m12:39:59.940478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa64c0e60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6806b70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0747f20>]}
[0m12:39:59.940755 [debug] [MainThread]: Flushing usage events
[0m12:40:01.229396 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:53:00.481371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82a91a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82a90440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff824c8bf0>]}


============================== 12:53:00.485160 | 8460b5c3-1520-47be-bdc9-e5b0817be5d7 ==============================
[0m12:53:00.485160 [info ] [MainThread]: Running with dbt=1.10.13
[0m12:53:00.485535 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'warn_error': 'None', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'debug': 'False', 'use_experimental_parser': 'False', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'empty': 'False', 'log_cache_events': 'False', 'printer_width': '80', 'version_check': 'True', 'static_parser': 'True', 'quiet': 'False', 'log_path': '/app/dbt/logs', 'profiles_dir': '/app/dbt', 'introspect': 'True', 'use_colors': 'True', 'write_json': 'True', 'indirect_selection': 'eager', 'no_print': 'None', 'partial_parse': 'True'}
[0m12:53:00.698358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8460b5c3-1520-47be-bdc9-e5b0817be5d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84952570>]}
[0m12:53:00.728969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8460b5c3-1520-47be-bdc9-e5b0817be5d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80a5a630>]}
[0m12:53:00.729413 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m12:53:00.780173 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m12:53:00.898760 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:53:00.899151 [debug] [MainThread]: Partial parsing: updated file: citrus_trade://models/analytics/growth_score.sql
[0m12:53:01.019314 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.citrus_trade.visualisation
[0m12:53:01.026281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8460b5c3-1520-47be-bdc9-e5b0817be5d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80500e00>]}
[0m12:53:01.069317 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m12:53:01.070890 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m12:53:01.079232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8460b5c3-1520-47be-bdc9-e5b0817be5d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff804a9a90>]}
[0m12:53:01.079500 [info ] [MainThread]: Found 6 models, 1 source, 632 macros
[0m12:53:01.079704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8460b5c3-1520-47be-bdc9-e5b0817be5d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80662150>]}
[0m12:53:01.080813 [info ] [MainThread]: 
[0m12:53:01.081029 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:53:01.081385 [info ] [MainThread]: 
[0m12:53:01.081996 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:53:01.084718 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRHS'
[0m12:53:01.085146 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRHS'
[0m12:53:01.111807 [debug] [ThreadPool]: Using snowflake connection "list_TRHS"
[0m12:53:01.112167 [debug] [ThreadPool]: Using snowflake connection "list_TRHS"
[0m12:53:01.112358 [debug] [ThreadPool]: On list_TRHS: show terse schemas in database TRHS
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS"} */
[0m12:53:01.112588 [debug] [ThreadPool]: On list_TRHS: show terse schemas in database TRHS
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS"} */
[0m12:53:01.112795 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:53:01.113004 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:53:04.837259 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 3.724 seconds
[0m12:53:04.837909 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 3.725 seconds
[0m12:53:04.841295 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRHS, now list_TRHS_staging)
[0m12:53:04.841714 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRHS, now list_TRHS_analytics)
[0m12:53:04.850066 [debug] [ThreadPool]: Using snowflake connection "list_TRHS_staging"
[0m12:53:04.852754 [debug] [ThreadPool]: Using snowflake connection "list_TRHS_analytics"
[0m12:53:04.853196 [debug] [ThreadPool]: On list_TRHS_staging: show objects in TRHS.staging
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS_staging"} */;
[0m12:53:04.853489 [debug] [ThreadPool]: On list_TRHS_analytics: show objects in TRHS.analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS_analytics"} */;
[0m12:53:04.956645 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.103 seconds
[0m12:53:04.959314 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.105 seconds
[0m12:53:04.961701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8460b5c3-1520-47be-bdc9-e5b0817be5d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff804b8230>]}
[0m12:53:04.965072 [debug] [Thread-1 (]: Began running node model.citrus_trade.stg_trade
[0m12:53:04.965630 [info ] [Thread-1 (]: 1 of 6 START sql table model staging.stg_trade ................................. [RUN]
[0m12:53:04.966076 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_TRHS_analytics, now model.citrus_trade.stg_trade)
[0m12:53:04.966387 [debug] [Thread-1 (]: Began compiling node model.citrus_trade.stg_trade
[0m12:53:04.971413 [debug] [Thread-1 (]: Writing injected SQL for node "model.citrus_trade.stg_trade"
[0m12:53:04.972705 [debug] [Thread-1 (]: Began executing node model.citrus_trade.stg_trade
[0m12:53:04.991155 [debug] [Thread-1 (]: Writing runtime sql for node "model.citrus_trade.stg_trade"
[0m12:53:04.992660 [debug] [Thread-1 (]: Using snowflake connection "model.citrus_trade.stg_trade"
[0m12:53:04.992905 [debug] [Thread-1 (]: On model.citrus_trade.stg_trade: create or replace transient table TRHS.staging.stg_trade
    
    
    
    as (select
  value:DECLARANT::int as declarant,
  value:DECLARANT_ISO::string as declarant_iso,
  value:PARTNER::string as partner,
  value:PARTNER_ISO::string as partner_iso,
  value:FLOW::int as flow,
  value:TRANSPORT_MODE::int as transport_mode,
  value:PERIOD::int as period,
  value:HS4::string as hs4,
  value:HS4_NAME::string as hs4_name,
  value:HS6::string as hs6,
  value:HS6_NAME::string as hs6_name,
  value:VALUE_IN_EUROS::float as value_in_euros,
  value:QUANTITY_IN_KG::float as quantity_in_kg
from trhs.staging.citrus_ext
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.stg_trade"} */;
[0m12:53:05.967367 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.974 seconds
[0m12:53:06.002005 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8460b5c3-1520-47be-bdc9-e5b0817be5d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84951730>]}
[0m12:53:06.003024 [info ] [Thread-1 (]: 1 of 6 OK created sql table model staging.stg_trade ............................ [[32mSUCCESS 1[0m in 1.03s]
[0m12:53:06.003820 [debug] [Thread-1 (]: Finished running node model.citrus_trade.stg_trade
[0m12:53:06.004942 [debug] [Thread-3 (]: Began running node model.citrus_trade.trade_by_declarant
[0m12:53:06.005590 [info ] [Thread-3 (]: 2 of 6 START sql table model analytics.trade_by_declarant ...................... [RUN]
[0m12:53:06.006369 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.citrus_trade.trade_by_declarant'
[0m12:53:06.006836 [debug] [Thread-3 (]: Began compiling node model.citrus_trade.trade_by_declarant
[0m12:53:06.012856 [debug] [Thread-3 (]: Writing injected SQL for node "model.citrus_trade.trade_by_declarant"
[0m12:53:06.014874 [debug] [Thread-3 (]: Began executing node model.citrus_trade.trade_by_declarant
[0m12:53:06.017473 [debug] [Thread-3 (]: Writing runtime sql for node "model.citrus_trade.trade_by_declarant"
[0m12:53:06.019176 [debug] [Thread-3 (]: Using snowflake connection "model.citrus_trade.trade_by_declarant"
[0m12:53:06.019498 [debug] [Thread-3 (]: On model.citrus_trade.trade_by_declarant: create or replace transient table TRHS.analytics.trade_by_declarant
    
    
    
    as (select 
    declarant,
    declarant_iso,
    partner,
    partner_iso,
    flow,
    transport_mode,
    year(to_date(left(period,4),'YYYY')) as year,
    period,
    hs6,
    hs6_name,
    sum(value_in_euros) as value,
    sum(quantity_in_kg) as quantity
from TRHS.staging.stg_trade
group by 1,2,3,4,5,6,7,8,9,10
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.trade_by_declarant"} */;
[0m12:53:06.019795 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:53:07.908096 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.888 seconds
[0m12:53:07.912028 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8460b5c3-1520-47be-bdc9-e5b0817be5d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f1cbbf0>]}
[0m12:53:07.913116 [info ] [Thread-3 (]: 2 of 6 OK created sql table model analytics.trade_by_declarant ................. [[32mSUCCESS 1[0m in 1.91s]
[0m12:53:07.914061 [debug] [Thread-3 (]: Finished running node model.citrus_trade.trade_by_declarant
[0m12:53:07.915263 [debug] [Thread-2 (]: Began running node model.citrus_trade.imports_by_year
[0m12:53:07.915834 [debug] [Thread-1 (]: Began running node model.citrus_trade.imports_exports_2022
[0m12:53:07.916430 [info ] [Thread-2 (]: 3 of 6 START sql table model analytics.imports_by_year ......................... [RUN]
[0m12:53:07.917341 [info ] [Thread-1 (]: 4 of 6 START sql table model analytics.imports_exports_2022 .................... [RUN]
[0m12:53:07.918704 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.citrus_trade.stg_trade, now model.citrus_trade.imports_exports_2022)
[0m12:53:07.919241 [debug] [Thread-1 (]: Began compiling node model.citrus_trade.imports_exports_2022
[0m12:53:07.918053 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_TRHS_staging, now model.citrus_trade.imports_by_year)
[0m12:53:07.924312 [debug] [Thread-2 (]: Began compiling node model.citrus_trade.imports_by_year
[0m12:53:07.923864 [debug] [Thread-1 (]: Writing injected SQL for node "model.citrus_trade.imports_exports_2022"
[0m12:53:07.927923 [debug] [Thread-2 (]: Writing injected SQL for node "model.citrus_trade.imports_by_year"
[0m12:53:07.929872 [debug] [Thread-1 (]: Began executing node model.citrus_trade.imports_exports_2022
[0m12:53:07.933585 [debug] [Thread-1 (]: Writing runtime sql for node "model.citrus_trade.imports_exports_2022"
[0m12:53:07.930597 [debug] [Thread-2 (]: Began executing node model.citrus_trade.imports_by_year
[0m12:53:07.937540 [debug] [Thread-2 (]: Writing runtime sql for node "model.citrus_trade.imports_by_year"
[0m12:53:07.939131 [debug] [Thread-1 (]: Using snowflake connection "model.citrus_trade.imports_exports_2022"
[0m12:53:07.939531 [debug] [Thread-1 (]: On model.citrus_trade.imports_exports_2022: create or replace transient table TRHS.analytics.imports_exports_2022
    
    
    
    as (select
    declarant_iso,
    flow,
    sum(value) over(partition by declarant_iso, flow) as total_value,
    sum(quantity) over(partition by declarant_iso, flow) as total_quantity,
    total_value/nullif(total_quantity,0) as value_per_quantity
from TRHS.analytics.trade_by_declarant
where hs6 = '080510'
group by 
    declarant_iso,
    flow,
    value,
    quantity
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.imports_exports_2022"} */;
[0m12:53:07.940475 [debug] [Thread-2 (]: Using snowflake connection "model.citrus_trade.imports_by_year"
[0m12:53:07.942372 [debug] [Thread-2 (]: On model.citrus_trade.imports_by_year: create or replace transient table TRHS.analytics.imports_by_year
    
    
    
    as (select
    declarant_iso,
    year,
    sum(value) as total_value,
    sum(quantity) as total_quantity,
    total_value/nullif(total_quantity,0) as value_per_quantity
from TRHS.analytics.trade_by_declarant
where flow = 1
and hs6 = '080510'
group by 1,2
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.imports_by_year"} */;
[0m12:53:08.689952 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.749 seconds
[0m12:53:08.693914 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8460b5c3-1520-47be-bdc9-e5b0817be5d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d56d3a0>]}
[0m12:53:08.694981 [info ] [Thread-1 (]: 4 of 6 OK created sql table model analytics.imports_exports_2022 ............... [[32mSUCCESS 1[0m in 0.78s]
[0m12:53:08.696057 [debug] [Thread-1 (]: Finished running node model.citrus_trade.imports_exports_2022
[0m12:53:08.697612 [debug] [Thread-3 (]: Began running node model.citrus_trade.score_2022
[0m12:53:08.698478 [info ] [Thread-3 (]: 5 of 6 START sql table model analytics.score_2022 .............................. [RUN]
[0m12:53:08.699133 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.citrus_trade.trade_by_declarant, now model.citrus_trade.score_2022)
[0m12:53:08.699705 [debug] [Thread-3 (]: Began compiling node model.citrus_trade.score_2022
[0m12:53:08.704316 [debug] [Thread-3 (]: Writing injected SQL for node "model.citrus_trade.score_2022"
[0m12:53:08.706964 [debug] [Thread-3 (]: Began executing node model.citrus_trade.score_2022
[0m12:53:08.711091 [debug] [Thread-3 (]: Writing runtime sql for node "model.citrus_trade.score_2022"
[0m12:53:08.712732 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.770 seconds
[0m12:53:08.715122 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8460b5c3-1520-47be-bdc9-e5b0817be5d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f1870b0>]}
[0m12:53:08.715894 [info ] [Thread-2 (]: 3 of 6 OK created sql table model analytics.imports_by_year .................... [[32mSUCCESS 1[0m in 0.80s]
[0m12:53:08.716685 [debug] [Thread-2 (]: Finished running node model.citrus_trade.imports_by_year
[0m12:53:08.718624 [debug] [Thread-3 (]: Using snowflake connection "model.citrus_trade.score_2022"
[0m12:53:08.719411 [debug] [Thread-3 (]: On model.citrus_trade.score_2022: create or replace transient table TRHS.analytics.score_2022
    
    
    
    as (select distinct 
    declarant_iso,
    total_value,
    total_quantity,
    value_per_quantity,
    (total_value - min(total_value) over())/((max(total_value) over())-(min(total_value) over())) as score_value,
    (total_quantity - min(total_quantity) over())/((max(total_quantity) over())-(min(total_quantity) over())) as score_quantity,
    (value_per_quantity - min(value_per_quantity) over())/((max(value_per_quantity) over())-(min(value_per_quantity) over())) as score_price
from TRHS.analytics.imports_exports_2022
where flow = 1
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.score_2022"} */;
[0m12:53:08.719906 [debug] [Thread-1 (]: Began running node model.citrus_trade.growth_score
[0m12:53:08.722866 [info ] [Thread-1 (]: 6 of 6 START sql table model analytics.growth_score ............................ [RUN]
[0m12:53:08.724058 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.citrus_trade.imports_exports_2022, now model.citrus_trade.growth_score)
[0m12:53:08.724802 [debug] [Thread-1 (]: Began compiling node model.citrus_trade.growth_score
[0m12:53:08.730924 [debug] [Thread-1 (]: Writing injected SQL for node "model.citrus_trade.growth_score"
[0m12:53:08.732794 [debug] [Thread-1 (]: Began executing node model.citrus_trade.growth_score
[0m12:53:08.735654 [debug] [Thread-1 (]: Writing runtime sql for node "model.citrus_trade.growth_score"
[0m12:53:08.739562 [debug] [Thread-1 (]: Using snowflake connection "model.citrus_trade.growth_score"
[0m12:53:08.740175 [debug] [Thread-1 (]: On model.citrus_trade.growth_score: create or replace transient table TRHS.analytics.growth_score
    
    
    
    as (with 
    previous_year AS (
        select 
            declarant_iso,
            year,
            lag(total_value,1) over(partition by declarant_iso order by year) previous_year_value,
            total_value,
            first_value(total_value) over(partition by declarant_iso order by year) as first_year_value,
            last_value(total_value) over(partition by declarant_iso order by year) as last_year_value
        from TRHS.analytics.imports_by_year
    ),
    growth_speed AS (
        select 
            declarant_iso,
            year,
            first_year_value,
            last_year_value,
            last_year_value/first_year_value as growth_overall,
            previous_year_value,
            total_value,
            (total_value - previous_year_value)/total_value * 100 as growth_speed 
        from previous_year
    ),
    previous_year_growth_speed AS (
        select 
            declarant_iso,
            year,
            first_year_value,
            last_year_value,
            growth_overall,
            previous_year_value,
            total_value as current_value,
            growth_speed,
            lag(growth_speed,1) over(partition by declarant_iso order by year) previous_year_growth_speed,
        from growth_speed
        order by 1,2
    ),
    base AS (
        select 
            declarant_iso,
            year,
            first_year_value,
            last_year_value,
            growth_overall,
            previous_year_value,
            current_value,
            previous_year_growth_speed,
            growth_speed,
            growth_speed - previous_year_growth_speed as growth_acceleration,
            avg(growth_acceleration) over(partition by declarant_iso) as avg_acceleration
        from previous_year_growth_speed
    ),
    ok as (
        select 
            declarant_iso,
            year,
            first_year_value,
            last_year_value,
            growth_overall,
            (growth_overall - min(growth_overall) OVER())/(max(growth_overall) OVER() - min(growth_overall) OVER()) as growth_overall_norm,
            previous_year_value,
            current_value,
            -- previous_year_growth_speed,
            growth_speed,
            growth_acceleration,
            avg_acceleration,
            (avg_acceleration - min(avg_acceleration) OVER())/(max(avg_acceleration) OVER() - min(avg_acceleration) OVER()) as avg_acceleration_norm
        from base 
    )
    select 
        declarant_iso,
        year,
        current_value,
        growth_speed,
        growth_acceleration,
        growth_overall,
        growth_overall_norm,
        avg_acceleration,
        avg_acceleration_norm,
        growth_overall_norm * avg_acceleration_norm as growth_score
    from ok
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.growth_score"} */;
[0m12:53:09.548998 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.828 seconds
[0m12:53:09.554141 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8460b5c3-1520-47be-bdc9-e5b0817be5d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7df73800>]}
[0m12:53:09.555571 [info ] [Thread-3 (]: 5 of 6 OK created sql table model analytics.score_2022 ......................... [[32mSUCCESS 1[0m in 0.85s]
[0m12:53:09.556954 [debug] [Thread-3 (]: Finished running node model.citrus_trade.score_2022
[0m12:53:09.567663 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.827 seconds
[0m12:53:09.571051 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8460b5c3-1520-47be-bdc9-e5b0817be5d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d561940>]}
[0m12:53:09.572136 [info ] [Thread-1 (]: 6 of 6 OK created sql table model analytics.growth_score ....................... [[32mSUCCESS 1[0m in 0.85s]
[0m12:53:09.573468 [debug] [Thread-1 (]: Finished running node model.citrus_trade.growth_score
[0m12:53:09.576509 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:53:09.577171 [debug] [MainThread]: Connection 'model.citrus_trade.growth_score' was left open.
[0m12:53:09.577715 [debug] [MainThread]: On model.citrus_trade.growth_score: Close
[0m12:53:09.706955 [debug] [MainThread]: Connection 'model.citrus_trade.imports_by_year' was left open.
[0m12:53:09.707960 [debug] [MainThread]: On model.citrus_trade.imports_by_year: Close
[0m12:53:09.844903 [debug] [MainThread]: Connection 'model.citrus_trade.score_2022' was left open.
[0m12:53:09.846295 [debug] [MainThread]: On model.citrus_trade.score_2022: Close
[0m12:53:09.974063 [info ] [MainThread]: 
[0m12:53:09.975095 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 8.89 seconds (8.89s).
[0m12:53:09.978025 [debug] [MainThread]: Command end result
[0m12:53:10.023857 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m12:53:10.025854 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m12:53:10.031082 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt/target/run_results.json
[0m12:53:10.031301 [info ] [MainThread]: 
[0m12:53:10.031598 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:53:10.032113 [info ] [MainThread]: 
[0m12:53:10.032473 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=6
[0m12:53:10.033453 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.585331, "process_in_blocks": "0", "process_kernel_time": 0.459478, "process_mem_max_rss": "164848", "process_out_blocks": "4197", "process_user_time": 1.837912}
[0m12:53:10.033829 [debug] [MainThread]: Command `dbt run` succeeded at 12:53:10.033741 after 9.59 seconds
[0m12:53:10.034088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82fdc6e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80a21f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff824c8bf0>]}
[0m12:53:10.034335 [debug] [MainThread]: Flushing usage events
[0m12:53:11.337882 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:07:32.372046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa13ad820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0dafdd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0daf9b0>]}


============================== 13:07:32.375193 | 9e5f9ea5-37c0-4b37-bf3a-61824225aca2 ==============================
[0m13:07:32.375193 [info ] [MainThread]: Running with dbt=1.10.13
[0m13:07:32.375563 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'log_format': 'default', 'warn_error': 'None', 'debug': 'False', 'log_cache_events': 'False', 'no_print': 'None', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'printer_width': '80', 'use_colors': 'True', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'empty': 'False', 'indirect_selection': 'eager', 'introspect': 'True', 'partial_parse': 'True', 'profiles_dir': '/app/dbt', 'log_path': '/app/dbt/logs', 'write_json': 'True'}
[0m13:07:32.629223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9e5f9ea5-37c0-4b37-bf3a-61824225aca2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f1db2c0>]}
[0m13:07:32.660053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9e5f9ea5-37c0-4b37-bf3a-61824225aca2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f558860>]}
[0m13:07:32.660553 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m13:07:32.712186 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m13:07:32.826849 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 3 files changed.
[0m13:07:32.827215 [debug] [MainThread]: Partial parsing: added file: citrus_trade://models/analytics/trade_by_hs.sql
[0m13:07:32.827470 [debug] [MainThread]: Partial parsing: updated file: citrus_trade://models/analytics/imports_exports_2022.sql
[0m13:07:32.827667 [debug] [MainThread]: Partial parsing: updated file: citrus_trade://models/analytics/growth_score.sql
[0m13:07:32.827850 [debug] [MainThread]: Partial parsing: updated file: citrus_trade://models/analytics/imports_by_year.sql
[0m13:07:32.952056 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.citrus_trade.visualisation
[0m13:07:32.958859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9e5f9ea5-37c0-4b37-bf3a-61824225aca2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e712810>]}
[0m13:07:33.003398 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m13:07:33.004997 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m13:07:33.025225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9e5f9ea5-37c0-4b37-bf3a-61824225aca2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9eb266c0>]}
[0m13:07:33.025573 [info ] [MainThread]: Found 7 models, 1 source, 632 macros
[0m13:07:33.028766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9e5f9ea5-37c0-4b37-bf3a-61824225aca2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ebd3c50>]}
[0m13:07:33.031014 [info ] [MainThread]: 
[0m13:07:33.033772 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:07:33.034078 [info ] [MainThread]: 
[0m13:07:33.034497 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:07:33.037689 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRHS'
[0m13:07:33.044190 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRHS'
[0m13:07:33.063294 [debug] [ThreadPool]: Using snowflake connection "list_TRHS"
[0m13:07:33.063597 [debug] [ThreadPool]: Using snowflake connection "list_TRHS"
[0m13:07:33.063805 [debug] [ThreadPool]: On list_TRHS: show terse schemas in database TRHS
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS"} */
[0m13:07:33.064030 [debug] [ThreadPool]: On list_TRHS: show terse schemas in database TRHS
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS"} */
[0m13:07:33.064252 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:07:33.064504 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:07:35.717894 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.653 seconds
[0m13:07:35.731498 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.667 seconds
[0m13:07:35.736434 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRHS, now list_TRHS_analytics)
[0m13:07:35.737359 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRHS, now list_TRHS_staging)
[0m13:07:35.755582 [debug] [ThreadPool]: Using snowflake connection "list_TRHS_analytics"
[0m13:07:35.758199 [debug] [ThreadPool]: Using snowflake connection "list_TRHS_staging"
[0m13:07:35.758691 [debug] [ThreadPool]: On list_TRHS_analytics: show objects in TRHS.analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS_analytics"} */;
[0m13:07:35.759179 [debug] [ThreadPool]: On list_TRHS_staging: show objects in TRHS.staging
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS_staging"} */;
[0m13:07:35.878322 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.118 seconds
[0m13:07:35.891664 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.130 seconds
[0m13:07:35.895835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9e5f9ea5-37c0-4b37-bf3a-61824225aca2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ef86f60>]}
[0m13:07:35.903732 [debug] [Thread-1 (]: Began running node model.citrus_trade.stg_trade
[0m13:07:35.904905 [info ] [Thread-1 (]: 1 of 7 START sql table model staging.stg_trade ................................. [RUN]
[0m13:07:35.905534 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_TRHS_staging, now model.citrus_trade.stg_trade)
[0m13:07:35.906052 [debug] [Thread-1 (]: Began compiling node model.citrus_trade.stg_trade
[0m13:07:35.915914 [debug] [Thread-1 (]: Writing injected SQL for node "model.citrus_trade.stg_trade"
[0m13:07:35.917700 [debug] [Thread-1 (]: Began executing node model.citrus_trade.stg_trade
[0m13:07:35.947388 [debug] [Thread-1 (]: Writing runtime sql for node "model.citrus_trade.stg_trade"
[0m13:07:35.949349 [debug] [Thread-1 (]: Using snowflake connection "model.citrus_trade.stg_trade"
[0m13:07:35.949663 [debug] [Thread-1 (]: On model.citrus_trade.stg_trade: create or replace transient table TRHS.staging.stg_trade
    
    
    
    as (select
  value:DECLARANT::int as declarant,
  value:DECLARANT_ISO::string as declarant_iso,
  value:PARTNER::string as partner,
  value:PARTNER_ISO::string as partner_iso,
  value:FLOW::int as flow,
  value:TRANSPORT_MODE::int as transport_mode,
  value:PERIOD::int as period,
  value:HS4::string as hs4,
  value:HS4_NAME::string as hs4_name,
  value:HS6::string as hs6,
  value:HS6_NAME::string as hs6_name,
  value:VALUE_IN_EUROS::float as value_in_euros,
  value:QUANTITY_IN_KG::float as quantity_in_kg
from trhs.staging.citrus_ext
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.stg_trade"} */;
[0m13:07:36.851223 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.901 seconds
[0m13:07:36.885169 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9e5f9ea5-37c0-4b37-bf3a-61824225aca2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2ef1df0>]}
[0m13:07:36.886190 [info ] [Thread-1 (]: 1 of 7 OK created sql table model staging.stg_trade ............................ [[32mSUCCESS 1[0m in 0.98s]
[0m13:07:36.887100 [debug] [Thread-1 (]: Finished running node model.citrus_trade.stg_trade
[0m13:07:36.888133 [debug] [Thread-3 (]: Began running node model.citrus_trade.trade_by_declarant
[0m13:07:36.888720 [info ] [Thread-3 (]: 2 of 7 START sql table model analytics.trade_by_declarant ...................... [RUN]
[0m13:07:36.889354 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.citrus_trade.trade_by_declarant'
[0m13:07:36.889716 [debug] [Thread-3 (]: Began compiling node model.citrus_trade.trade_by_declarant
[0m13:07:36.895507 [debug] [Thread-3 (]: Writing injected SQL for node "model.citrus_trade.trade_by_declarant"
[0m13:07:36.897034 [debug] [Thread-3 (]: Began executing node model.citrus_trade.trade_by_declarant
[0m13:07:36.899467 [debug] [Thread-3 (]: Writing runtime sql for node "model.citrus_trade.trade_by_declarant"
[0m13:07:36.900998 [debug] [Thread-3 (]: Using snowflake connection "model.citrus_trade.trade_by_declarant"
[0m13:07:36.901345 [debug] [Thread-3 (]: On model.citrus_trade.trade_by_declarant: create or replace transient table TRHS.analytics.trade_by_declarant
    
    
    
    as (select 
    declarant,
    declarant_iso,
    partner,
    partner_iso,
    flow,
    transport_mode,
    year(to_date(left(period,4),'YYYY')) as year,
    period,
    hs6,
    hs6_name,
    sum(value_in_euros) as value,
    sum(quantity_in_kg) as quantity
from TRHS.staging.stg_trade
group by 1,2,3,4,5,6,7,8,9,10
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.trade_by_declarant"} */;
[0m13:07:36.901670 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:07:39.243549 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 2.342 seconds
[0m13:07:39.247816 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9e5f9ea5-37c0-4b37-bf3a-61824225aca2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c4b78f0>]}
[0m13:07:39.249231 [info ] [Thread-3 (]: 2 of 7 OK created sql table model analytics.trade_by_declarant ................. [[32mSUCCESS 1[0m in 2.36s]
[0m13:07:39.250820 [debug] [Thread-3 (]: Finished running node model.citrus_trade.trade_by_declarant
[0m13:07:39.252382 [debug] [Thread-2 (]: Began running node model.citrus_trade.trade_by_hs
[0m13:07:39.253056 [info ] [Thread-2 (]: 3 of 7 START sql table model analytics.trade_by_hs ............................. [RUN]
[0m13:07:39.253598 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_TRHS_analytics, now model.citrus_trade.trade_by_hs)
[0m13:07:39.253959 [debug] [Thread-2 (]: Began compiling node model.citrus_trade.trade_by_hs
[0m13:07:39.257444 [debug] [Thread-2 (]: Writing injected SQL for node "model.citrus_trade.trade_by_hs"
[0m13:07:39.259930 [debug] [Thread-2 (]: Began executing node model.citrus_trade.trade_by_hs
[0m13:07:39.262272 [debug] [Thread-2 (]: Writing runtime sql for node "model.citrus_trade.trade_by_hs"
[0m13:07:39.263826 [debug] [Thread-2 (]: Using snowflake connection "model.citrus_trade.trade_by_hs"
[0m13:07:39.264170 [debug] [Thread-2 (]: On model.citrus_trade.trade_by_hs: create or replace transient table TRHS.analytics.trade_by_hs
    
    
    
    as (select
    *
from TRHS.analytics.trade_by_declarant
where hs6 = '080510'
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.trade_by_hs"} */;
[0m13:07:40.247637 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.983 seconds
[0m13:07:40.250851 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9e5f9ea5-37c0-4b37-bf3a-61824225aca2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c47b290>]}
[0m13:07:40.252092 [info ] [Thread-2 (]: 3 of 7 OK created sql table model analytics.trade_by_hs ........................ [[32mSUCCESS 1[0m in 1.00s]
[0m13:07:40.253669 [debug] [Thread-2 (]: Finished running node model.citrus_trade.trade_by_hs
[0m13:07:40.255076 [debug] [Thread-4 (]: Began running node model.citrus_trade.imports_by_year
[0m13:07:40.255387 [debug] [Thread-3 (]: Began running node model.citrus_trade.imports_exports_2022
[0m13:07:40.255694 [info ] [Thread-4 (]: 4 of 7 START sql table model analytics.imports_by_year ......................... [RUN]
[0m13:07:40.256833 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.citrus_trade.imports_by_year'
[0m13:07:40.257089 [debug] [Thread-4 (]: Began compiling node model.citrus_trade.imports_by_year
[0m13:07:40.256177 [info ] [Thread-3 (]: 5 of 7 START sql table model analytics.imports_exports_2022 .................... [RUN]
[0m13:07:40.260276 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.citrus_trade.trade_by_declarant, now model.citrus_trade.imports_exports_2022)
[0m13:07:40.260536 [debug] [Thread-3 (]: Began compiling node model.citrus_trade.imports_exports_2022
[0m13:07:40.259901 [debug] [Thread-4 (]: Writing injected SQL for node "model.citrus_trade.imports_by_year"
[0m13:07:40.262069 [debug] [Thread-3 (]: Writing injected SQL for node "model.citrus_trade.imports_exports_2022"
[0m13:07:40.262796 [debug] [Thread-4 (]: Began executing node model.citrus_trade.imports_by_year
[0m13:07:40.264481 [debug] [Thread-4 (]: Writing runtime sql for node "model.citrus_trade.imports_by_year"
[0m13:07:40.264742 [debug] [Thread-3 (]: Began executing node model.citrus_trade.imports_exports_2022
[0m13:07:40.266577 [debug] [Thread-3 (]: Writing runtime sql for node "model.citrus_trade.imports_exports_2022"
[0m13:07:40.267511 [debug] [Thread-4 (]: Using snowflake connection "model.citrus_trade.imports_by_year"
[0m13:07:40.267809 [debug] [Thread-4 (]: On model.citrus_trade.imports_by_year: create or replace transient table TRHS.analytics.imports_by_year
    
    
    
    as (select
    declarant_iso,
    year,
    sum(value) as total_value,
    sum(quantity) as total_quantity,
    total_value/nullif(total_quantity,0) as value_per_quantity
from TRHS.analytics.trade_by_hs
where flow = 1
group by 1,2
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.imports_by_year"} */;
[0m13:07:40.268075 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:07:40.268589 [debug] [Thread-3 (]: Using snowflake connection "model.citrus_trade.imports_exports_2022"
[0m13:07:40.271420 [debug] [Thread-3 (]: On model.citrus_trade.imports_exports_2022: create or replace transient table TRHS.analytics.imports_exports_2022
    
    
    
    as (select
    declarant_iso,
    flow,
    sum(value) over(partition by declarant_iso, flow) as total_value,
    sum(quantity) over(partition by declarant_iso, flow) as total_quantity,
    total_value/nullif(total_quantity,0) as value_per_quantity
from TRHS.analytics.trade_by_hs
group by 
    declarant_iso,
    flow,
    value,
    quantity
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.imports_exports_2022"} */;
[0m13:07:41.007450 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.734 seconds
[0m13:07:41.011943 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9e5f9ea5-37c0-4b37-bf3a-61824225aca2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c22bd10>]}
[0m13:07:41.013610 [info ] [Thread-3 (]: 5 of 7 OK created sql table model analytics.imports_exports_2022 ............... [[32mSUCCESS 1[0m in 0.75s]
[0m13:07:41.014729 [debug] [Thread-3 (]: Finished running node model.citrus_trade.imports_exports_2022
[0m13:07:41.016281 [debug] [Thread-2 (]: Began running node model.citrus_trade.score_2022
[0m13:07:41.017143 [info ] [Thread-2 (]: 6 of 7 START sql table model analytics.score_2022 .............................. [RUN]
[0m13:07:41.018681 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.citrus_trade.trade_by_hs, now model.citrus_trade.score_2022)
[0m13:07:41.019229 [debug] [Thread-2 (]: Began compiling node model.citrus_trade.score_2022
[0m13:07:41.024640 [debug] [Thread-2 (]: Writing injected SQL for node "model.citrus_trade.score_2022"
[0m13:07:41.026749 [debug] [Thread-2 (]: Began executing node model.citrus_trade.score_2022
[0m13:07:41.031949 [debug] [Thread-2 (]: Writing runtime sql for node "model.citrus_trade.score_2022"
[0m13:07:41.035451 [debug] [Thread-2 (]: Using snowflake connection "model.citrus_trade.score_2022"
[0m13:07:41.037717 [debug] [Thread-2 (]: On model.citrus_trade.score_2022: create or replace transient table TRHS.analytics.score_2022
    
    
    
    as (select distinct 
    declarant_iso,
    total_value,
    total_quantity,
    value_per_quantity,
    (total_value - min(total_value) over())/((max(total_value) over())-(min(total_value) over())) as score_value,
    (total_quantity - min(total_quantity) over())/((max(total_quantity) over())-(min(total_quantity) over())) as score_quantity,
    (value_per_quantity - min(value_per_quantity) over())/((max(value_per_quantity) over())-(min(value_per_quantity) over())) as score_price
from TRHS.analytics.imports_exports_2022
where flow = 1
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.score_2022"} */;
[0m13:07:41.866867 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.828 seconds
[0m13:07:41.871033 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9e5f9ea5-37c0-4b37-bf3a-61824225aca2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c1f2360>]}
[0m13:07:41.872219 [info ] [Thread-2 (]: 6 of 7 OK created sql table model analytics.score_2022 ......................... [[32mSUCCESS 1[0m in 0.85s]
[0m13:07:41.874619 [debug] [Thread-2 (]: Finished running node model.citrus_trade.score_2022
[0m13:07:42.162950 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.895 seconds
[0m13:07:42.166564 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9e5f9ea5-37c0-4b37-bf3a-61824225aca2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c1ddbb0>]}
[0m13:07:42.167359 [info ] [Thread-4 (]: 4 of 7 OK created sql table model analytics.imports_by_year .................... [[32mSUCCESS 1[0m in 1.91s]
[0m13:07:42.168159 [debug] [Thread-4 (]: Finished running node model.citrus_trade.imports_by_year
[0m13:07:42.168857 [debug] [Thread-3 (]: Began running node model.citrus_trade.growth_score
[0m13:07:42.169237 [info ] [Thread-3 (]: 7 of 7 START sql table model analytics.growth_score ............................ [RUN]
[0m13:07:42.169563 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.citrus_trade.imports_exports_2022, now model.citrus_trade.growth_score)
[0m13:07:42.169874 [debug] [Thread-3 (]: Began compiling node model.citrus_trade.growth_score
[0m13:07:42.172172 [debug] [Thread-3 (]: Writing injected SQL for node "model.citrus_trade.growth_score"
[0m13:07:42.173040 [debug] [Thread-3 (]: Began executing node model.citrus_trade.growth_score
[0m13:07:42.175864 [debug] [Thread-3 (]: Writing runtime sql for node "model.citrus_trade.growth_score"
[0m13:07:42.178021 [debug] [Thread-3 (]: Using snowflake connection "model.citrus_trade.growth_score"
[0m13:07:42.178319 [debug] [Thread-3 (]: On model.citrus_trade.growth_score: create or replace transient table TRHS.analytics.growth_score
    
    
    
    as (with 
    previous_year AS (
        select 
            declarant_iso,
            year,
            lag(total_value,1) over(partition by declarant_iso order by year) previous_year_value,
            total_value,
            first_value(total_value) over(partition by declarant_iso order by year) as first_year_value,
            last_value(total_value) over(partition by declarant_iso order by year) as last_year_value
        from TRHS.analytics.imports_by_year
    ),
    growth_speed AS (
        select 
            declarant_iso,
            year,
            first_year_value,
            last_year_value,
            last_year_value/nullif(first_year_value,0) as growth_overall,
            previous_year_value,
            total_value,
            (total_value - previous_year_value)/total_value * 100 as growth_speed 
        from previous_year
    ),
    previous_year_growth_speed AS (
        select 
            declarant_iso,
            year,
            first_year_value,
            last_year_value,
            growth_overall,
            previous_year_value,
            total_value as current_value,
            growth_speed,
            lag(growth_speed,1) over(partition by declarant_iso order by year) previous_year_growth_speed,
        from growth_speed
        order by 1,2
    ),
    base AS (
        select 
            declarant_iso,
            year,
            first_year_value,
            last_year_value,
            growth_overall,
            previous_year_value,
            current_value,
            previous_year_growth_speed,
            growth_speed,
            growth_speed - previous_year_growth_speed as growth_acceleration,
            avg(growth_acceleration) over(partition by declarant_iso) as avg_acceleration
        from previous_year_growth_speed
    ),
    ok as (
        select 
            declarant_iso,
            year,
            first_year_value,
            last_year_value,
            growth_overall,
            (growth_overall - min(growth_overall) OVER())/(max(growth_overall) OVER() - min(growth_overall) OVER()) as growth_overall_norm,
            previous_year_value,
            current_value,
            -- previous_year_growth_speed,
            growth_speed,
            growth_acceleration,
            avg_acceleration,
            (avg_acceleration - min(avg_acceleration) OVER())/(max(avg_acceleration) OVER() - min(avg_acceleration) OVER()) as avg_acceleration_norm
        from base 
    )
    select 
        declarant_iso,
        year,
        current_value,
        growth_speed,
        growth_acceleration,
        growth_overall,
        growth_overall_norm,
        avg_acceleration,
        avg_acceleration_norm,
        growth_overall_norm * avg_acceleration_norm as growth_score
    from ok
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.growth_score"} */;
[0m13:07:43.160921 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.982 seconds
[0m13:07:43.166448 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9e5f9ea5-37c0-4b37-bf3a-61824225aca2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c1dfc80>]}
[0m13:07:43.167138 [info ] [Thread-3 (]: 7 of 7 OK created sql table model analytics.growth_score ....................... [[32mSUCCESS 1[0m in 1.00s]
[0m13:07:43.167802 [debug] [Thread-3 (]: Finished running node model.citrus_trade.growth_score
[0m13:07:43.170299 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:07:43.170648 [debug] [MainThread]: Connection 'model.citrus_trade.score_2022' was left open.
[0m13:07:43.170860 [debug] [MainThread]: On model.citrus_trade.score_2022: Close
[0m13:07:43.303877 [debug] [MainThread]: Connection 'model.citrus_trade.stg_trade' was left open.
[0m13:07:43.305189 [debug] [MainThread]: On model.citrus_trade.stg_trade: Close
[0m13:07:43.463226 [debug] [MainThread]: Connection 'model.citrus_trade.growth_score' was left open.
[0m13:07:43.464392 [debug] [MainThread]: On model.citrus_trade.growth_score: Close
[0m13:07:43.589730 [debug] [MainThread]: Connection 'model.citrus_trade.imports_by_year' was left open.
[0m13:07:43.590960 [debug] [MainThread]: On model.citrus_trade.imports_by_year: Close
[0m13:07:43.736270 [info ] [MainThread]: 
[0m13:07:43.737752 [info ] [MainThread]: Finished running 7 table models in 0 hours 0 minutes and 10.70 seconds (10.70s).
[0m13:07:43.741445 [debug] [MainThread]: Command end result
[0m13:07:43.897497 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/target/manifest.json
[0m13:07:43.900102 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/target/semantic_manifest.json
[0m13:07:43.905798 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt/target/run_results.json
[0m13:07:43.906039 [info ] [MainThread]: 
[0m13:07:43.906364 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:07:43.906597 [info ] [MainThread]: 
[0m13:07:43.907013 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=7
[0m13:07:43.908736 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.569225, "process_in_blocks": "0", "process_kernel_time": 0.458196, "process_mem_max_rss": "166580", "process_out_blocks": "4215", "process_user_time": 1.922213}
[0m13:07:43.909542 [debug] [MainThread]: Command `dbt run` succeeded at 13:07:43.909363 after 11.57 seconds
[0m13:07:43.910062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa14e20f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa14e3f20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa14e3c80>]}
[0m13:07:43.910456 [debug] [MainThread]: Flushing usage events
[0m13:07:45.284408 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:09:25.309527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0076490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb03750d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaff6b250>]}


============================== 19:09:25.320177 | 028de6a0-df15-45c3-855c-439d090b8f2f ==============================
[0m19:09:25.320177 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m19:09:25.320810 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'warn_error': 'None', 'profiles_dir': '/opt/airflow/dbt', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'use_colors': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_cache_events': 'False', 'partial_parse': 'True', 'write_json': 'True', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt deps', 'empty': 'None', 'printer_width': '80', 'debug': 'False', 'no_print': 'None', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'indirect_selection': 'eager', 'use_experimental_parser': 'False'}
[0m19:09:25.405908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '028de6a0-df15-45c3-855c-439d090b8f2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffafe4e590>]}
[0m19:09:25.546757 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-myrtgg45'
[0m19:09:25.547853 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m19:09:25.714415 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m19:09:25.715924 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json
[0m19:09:25.810540 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json 200
[0m19:09:25.814521 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m19:09:25.896758 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m19:09:25.902249 [info ] [MainThread]: Installing dbt-labs/codegen
[0m19:09:26.180541 [info ] [MainThread]: Installed from version 0.13.1
[0m19:09:26.180975 [info ] [MainThread]: Up to date!
[0m19:09:26.181430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '028de6a0-df15-45c3-855c-439d090b8f2f', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb004ef50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffafe95590>]}
[0m19:09:26.181773 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m19:09:26.644381 [info ] [MainThread]: Installed from version 1.3.1
[0m19:09:26.645657 [info ] [MainThread]: Updated version available: 1.3.2
[0m19:09:26.646124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '028de6a0-df15-45c3-855c-439d090b8f2f', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0075d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0019050>]}
[0m19:09:26.646576 [info ] [MainThread]: 
[0m19:09:26.646919 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m19:09:26.648165 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 1.3765941, "process_in_blocks": "0", "process_kernel_time": 1.35139, "process_mem_max_rss": "107184", "process_out_blocks": "3119", "process_user_time": 1.342238}
[0m19:09:26.648740 [debug] [MainThread]: Command `dbt deps` succeeded at 19:09:26.648631 after 1.38 seconds
[0m19:09:26.649115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0077850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb023f790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffafe7e090>]}
[0m19:09:26.649354 [debug] [MainThread]: Flushing usage events
[0m19:09:27.142606 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:09:28.275442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff808da390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff808da310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff808d9d10>]}


============================== 19:09:28.277218 | ae341a02-3926-4216-bb71-e4f5df4f1a66 ==============================
[0m19:09:28.277218 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m19:09:28.277786 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt seed', 'log_cache_events': 'False', 'version_check': 'True', 'static_parser': 'True', 'introspect': 'True', 'empty': 'None', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'log_format': 'default', 'indirect_selection': 'eager', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/opt/airflow/dbt', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'debug': 'False', 'use_colors': 'True', 'target_path': 'None', 'no_print': 'None', 'write_json': 'True', 'quiet': 'False', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m19:09:28.739228 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m19:09:28.739859 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m19:09:28.740083 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m19:09:29.059646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ae341a02-3926-4216-bb71-e4f5df4f1a66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f1cc9d0>]}
[0m19:09:29.108998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ae341a02-3926-4216-bb71-e4f5df4f1a66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff818aa6d0>]}
[0m19:09:29.110051 [info ] [MainThread]: Registered adapter: snowflake=1.10.3
[0m19:09:29.240656 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m19:09:29.361483 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m19:09:29.362075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ae341a02-3926-4216-bb71-e4f5df4f1a66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff818c53d0>]}
[0m19:09:30.397138 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.citrus_trade.visualisation
[0m19:09:30.403849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ae341a02-3926-4216-bb71-e4f5df4f1a66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff818b8950>]}
[0m19:09:30.537534 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m19:09:30.539966 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m19:09:30.557953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ae341a02-3926-4216-bb71-e4f5df4f1a66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7eccfed0>]}
[0m19:09:30.558418 [info ] [MainThread]: Found 7 models, 1 source, 636 macros
[0m19:09:30.558880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ae341a02-3926-4216-bb71-e4f5df4f1a66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ebcbf10>]}
[0m19:09:30.560962 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m19:09:30.562416 [debug] [MainThread]: Command end result
[0m19:09:30.611742 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m19:09:30.613647 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m19:09:30.616033 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/target/run_results.json
[0m19:09:30.616342 [info ] [MainThread]: 
[0m19:09:30.616751 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:09:30.617585 [info ] [MainThread]: 
[0m19:09:30.617935 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=0
[0m19:09:30.619345 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 2.3720343, "process_in_blocks": "0", "process_kernel_time": 0.714545, "process_mem_max_rss": "139288", "process_out_blocks": "4340", "process_user_time": 2.43343}
[0m19:09:30.619717 [debug] [MainThread]: Command `dbt seed` succeeded at 19:09:30.619655 after 2.37 seconds
[0m19:09:30.620038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8093e7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80a81110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7eac1e10>]}
[0m19:09:30.620317 [debug] [MainThread]: Flushing usage events
[0m19:09:31.083834 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:09:33.028455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa74e6ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa778fad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa778d090>]}


============================== 19:09:33.031368 | b394527e-b890-4e82-aecb-2a4190ef6591 ==============================
[0m19:09:33.031368 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m19:09:33.032156 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'use_colors': 'True', 'warn_error': 'None', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'quiet': 'False', 'write_json': 'True', 'invocation_command': 'dbt run', 'no_print': 'None', 'log_cache_events': 'False', 'printer_width': '80', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'empty': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'profiles_dir': '/opt/airflow/dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True'}
[0m19:09:33.361534 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m19:09:33.362043 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m19:09:33.362351 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m19:09:33.534214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b394527e-b890-4e82-aecb-2a4190ef6591', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5c6b9d0>]}
[0m19:09:33.570229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b394527e-b890-4e82-aecb-2a4190ef6591', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa84a2810>]}
[0m19:09:33.570869 [info ] [MainThread]: Registered adapter: snowflake=1.10.3
[0m19:09:33.644300 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m19:09:33.816175 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:09:33.816581 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:09:33.820735 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.citrus_trade.visualisation
[0m19:09:33.844788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b394527e-b890-4e82-aecb-2a4190ef6591', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5b3a050>]}
[0m19:09:33.926365 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m19:09:33.930708 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m19:09:33.942957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b394527e-b890-4e82-aecb-2a4190ef6591', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa599e690>]}
[0m19:09:33.943794 [info ] [MainThread]: Found 7 models, 1 source, 636 macros
[0m19:09:33.944143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b394527e-b890-4e82-aecb-2a4190ef6591', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5c2f910>]}
[0m19:09:33.945653 [info ] [MainThread]: 
[0m19:09:33.946224 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:09:33.946962 [info ] [MainThread]: 
[0m19:09:33.947672 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:09:33.951391 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRHS'
[0m19:09:33.952145 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRHS'
[0m19:09:34.038795 [debug] [ThreadPool]: Using snowflake connection "list_TRHS"
[0m19:09:34.039218 [debug] [ThreadPool]: Using snowflake connection "list_TRHS"
[0m19:09:34.039555 [debug] [ThreadPool]: On list_TRHS: show terse schemas in database TRHS
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS"} */
[0m19:09:34.039822 [debug] [ThreadPool]: On list_TRHS: show terse schemas in database TRHS
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS"} */
[0m19:09:34.040153 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:09:34.040416 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:09:35.474163 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.434 seconds
[0m19:09:35.546498 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.506 seconds
[0m19:09:35.548993 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRHS, now list_TRHS_analytics)
[0m19:09:35.549391 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRHS, now list_TRHS_staging)
[0m19:09:35.557725 [debug] [ThreadPool]: Using snowflake connection "list_TRHS_analytics"
[0m19:09:35.559387 [debug] [ThreadPool]: Using snowflake connection "list_TRHS_staging"
[0m19:09:35.559741 [debug] [ThreadPool]: On list_TRHS_analytics: show objects in TRHS.analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS_analytics"} */;
[0m19:09:35.560049 [debug] [ThreadPool]: On list_TRHS_staging: show objects in TRHS.staging
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS_staging"} */;
[0m19:09:35.653062 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.092 seconds
[0m19:09:35.673999 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 0.114 seconds
[0m19:09:35.677305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b394527e-b890-4e82-aecb-2a4190ef6591', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5f85750>]}
[0m19:09:35.687381 [debug] [Thread-1 (]: Began running node model.citrus_trade.stg_trade
[0m19:09:35.688507 [info ] [Thread-1 (]: 1 of 7 START sql table model staging.stg_trade ................................. [RUN]
[0m19:09:35.689377 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_TRHS_analytics, now model.citrus_trade.stg_trade)
[0m19:09:35.689907 [debug] [Thread-1 (]: Began compiling node model.citrus_trade.stg_trade
[0m19:09:35.698194 [debug] [Thread-1 (]: Writing injected SQL for node "model.citrus_trade.stg_trade"
[0m19:09:35.700644 [debug] [Thread-1 (]: Began executing node model.citrus_trade.stg_trade
[0m19:09:35.726451 [debug] [Thread-1 (]: Writing runtime sql for node "model.citrus_trade.stg_trade"
[0m19:09:35.728664 [debug] [Thread-1 (]: Using snowflake connection "model.citrus_trade.stg_trade"
[0m19:09:35.729192 [debug] [Thread-1 (]: On model.citrus_trade.stg_trade: create or replace transient table TRHS.staging.stg_trade
    
    
    
    as (select
  value:DECLARANT::int as declarant,
  value:DECLARANT_ISO::string as declarant_iso,
  value:PARTNER::string as partner,
  value:PARTNER_ISO::string as partner_iso,
  value:FLOW::int as flow,
  value:TRANSPORT_MODE::int as transport_mode,
  value:PERIOD::int as period,
  value:HS4::string as hs4,
  value:HS4_NAME::string as hs4_name,
  value:HS6::string as hs6,
  value:HS6_NAME::string as hs6_name,
  value:VALUE_IN_EUROS::float as value_in_euros,
  value:QUANTITY_IN_KG::float as quantity_in_kg
from trhs.staging.citrus_ext
    )

/* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.stg_trade"} */;
[0m19:09:37.247803 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.517 seconds
[0m19:09:37.269458 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b394527e-b890-4e82-aecb-2a4190ef6591', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa42e7c90>]}
[0m19:09:37.270300 [info ] [Thread-1 (]: 1 of 7 OK created sql table model staging.stg_trade ............................ [[32mSUCCESS 1[0m in 1.58s]
[0m19:09:37.270964 [debug] [Thread-1 (]: Finished running node model.citrus_trade.stg_trade
[0m19:09:37.272498 [debug] [Thread-3 (]: Began running node model.citrus_trade.trade_by_declarant
[0m19:09:37.272865 [info ] [Thread-3 (]: 2 of 7 START sql table model analytics.trade_by_declarant ...................... [RUN]
[0m19:09:37.273381 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.citrus_trade.trade_by_declarant'
[0m19:09:37.273648 [debug] [Thread-3 (]: Began compiling node model.citrus_trade.trade_by_declarant
[0m19:09:37.281115 [debug] [Thread-3 (]: Writing injected SQL for node "model.citrus_trade.trade_by_declarant"
[0m19:09:37.284767 [debug] [Thread-3 (]: Began executing node model.citrus_trade.trade_by_declarant
[0m19:09:37.286962 [debug] [Thread-3 (]: Writing runtime sql for node "model.citrus_trade.trade_by_declarant"
[0m19:09:37.288068 [debug] [Thread-3 (]: Using snowflake connection "model.citrus_trade.trade_by_declarant"
[0m19:09:37.288338 [debug] [Thread-3 (]: On model.citrus_trade.trade_by_declarant: create or replace transient table TRHS.analytics.trade_by_declarant
    
    
    
    as (select 
    declarant,
    declarant_iso,
    partner,
    partner_iso,
    flow,
    transport_mode,
    year(to_date(left(period,4),'YYYY')) as year,
    period,
    hs6,
    hs6_name,
    sum(value_in_euros) as value,
    sum(quantity_in_kg) as quantity
from TRHS.staging.stg_trade
group by 1,2,3,4,5,6,7,8,9,10
    )

/* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.trade_by_declarant"} */;
[0m19:09:37.288574 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m19:09:38.275669 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.987 seconds
[0m19:09:38.278344 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b394527e-b890-4e82-aecb-2a4190ef6591', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa40cb390>]}
[0m19:09:38.278917 [info ] [Thread-3 (]: 2 of 7 OK created sql table model analytics.trade_by_declarant ................. [[32mSUCCESS 1[0m in 1.00s]
[0m19:09:38.279546 [debug] [Thread-3 (]: Finished running node model.citrus_trade.trade_by_declarant
[0m19:09:38.280515 [debug] [Thread-2 (]: Began running node model.citrus_trade.trade_by_hs
[0m19:09:38.280925 [info ] [Thread-2 (]: 3 of 7 START sql table model analytics.trade_by_hs ............................. [RUN]
[0m19:09:38.281418 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_TRHS_staging, now model.citrus_trade.trade_by_hs)
[0m19:09:38.281686 [debug] [Thread-2 (]: Began compiling node model.citrus_trade.trade_by_hs
[0m19:09:38.285015 [debug] [Thread-2 (]: Writing injected SQL for node "model.citrus_trade.trade_by_hs"
[0m19:09:38.285957 [debug] [Thread-2 (]: Began executing node model.citrus_trade.trade_by_hs
[0m19:09:38.288256 [debug] [Thread-2 (]: Writing runtime sql for node "model.citrus_trade.trade_by_hs"
[0m19:09:38.289049 [debug] [Thread-2 (]: Using snowflake connection "model.citrus_trade.trade_by_hs"
[0m19:09:38.289310 [debug] [Thread-2 (]: On model.citrus_trade.trade_by_hs: create or replace transient table TRHS.analytics.trade_by_hs
    
    
    
    as (select
    *
from TRHS.analytics.trade_by_declarant
where hs6 = '080510'
    )

/* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.trade_by_hs"} */;
[0m19:09:39.118637 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.829 seconds
[0m19:09:39.127668 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b394527e-b890-4e82-aecb-2a4190ef6591', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa41d99d0>]}
[0m19:09:39.128133 [info ] [Thread-2 (]: 3 of 7 OK created sql table model analytics.trade_by_hs ........................ [[32mSUCCESS 1[0m in 0.85s]
[0m19:09:39.128578 [debug] [Thread-2 (]: Finished running node model.citrus_trade.trade_by_hs
[0m19:09:39.129225 [debug] [Thread-4 (]: Began running node model.citrus_trade.imports_by_year
[0m19:09:39.129450 [debug] [Thread-3 (]: Began running node model.citrus_trade.imports_exports_2022
[0m19:09:39.129771 [info ] [Thread-4 (]: 4 of 7 START sql table model analytics.imports_by_year ......................... [RUN]
[0m19:09:39.130159 [info ] [Thread-3 (]: 5 of 7 START sql table model analytics.imports_exports_2022 .................... [RUN]
[0m19:09:39.130610 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.citrus_trade.imports_by_year'
[0m19:09:39.130968 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.citrus_trade.trade_by_declarant, now model.citrus_trade.imports_exports_2022)
[0m19:09:39.131258 [debug] [Thread-4 (]: Began compiling node model.citrus_trade.imports_by_year
[0m19:09:39.131569 [debug] [Thread-3 (]: Began compiling node model.citrus_trade.imports_exports_2022
[0m19:09:39.135246 [debug] [Thread-4 (]: Writing injected SQL for node "model.citrus_trade.imports_by_year"
[0m19:09:39.137072 [debug] [Thread-3 (]: Writing injected SQL for node "model.citrus_trade.imports_exports_2022"
[0m19:09:39.137924 [debug] [Thread-4 (]: Began executing node model.citrus_trade.imports_by_year
[0m19:09:39.139595 [debug] [Thread-4 (]: Writing runtime sql for node "model.citrus_trade.imports_by_year"
[0m19:09:39.139875 [debug] [Thread-3 (]: Began executing node model.citrus_trade.imports_exports_2022
[0m19:09:39.141614 [debug] [Thread-3 (]: Writing runtime sql for node "model.citrus_trade.imports_exports_2022"
[0m19:09:39.142385 [debug] [Thread-4 (]: Using snowflake connection "model.citrus_trade.imports_by_year"
[0m19:09:39.142673 [debug] [Thread-4 (]: On model.citrus_trade.imports_by_year: create or replace transient table TRHS.analytics.imports_by_year
    
    
    
    as (select
    declarant_iso,
    year,
    sum(value) as total_value,
    sum(quantity) as total_quantity,
    total_value/nullif(total_quantity,0) as value_per_quantity
from TRHS.analytics.trade_by_hs
where flow = 1
group by 1,2
    )

/* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.imports_by_year"} */;
[0m19:09:39.143416 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m19:09:39.143240 [debug] [Thread-3 (]: Using snowflake connection "model.citrus_trade.imports_exports_2022"
[0m19:09:39.149536 [debug] [Thread-3 (]: On model.citrus_trade.imports_exports_2022: create or replace transient table TRHS.analytics.imports_exports_2022
    
    
    
    as (select
    declarant_iso,
    flow,
    sum(value) over(partition by declarant_iso, flow) as total_value,
    sum(quantity) over(partition by declarant_iso, flow) as total_quantity,
    total_value/nullif(total_quantity,0) as value_per_quantity
from TRHS.analytics.trade_by_hs
group by 
    declarant_iso,
    flow,
    value,
    quantity
    )

/* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.imports_exports_2022"} */;
[0m19:09:39.764400 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.613 seconds
[0m19:09:39.765961 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b394527e-b890-4e82-aecb-2a4190ef6591', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa41fd710>]}
[0m19:09:39.766413 [info ] [Thread-3 (]: 5 of 7 OK created sql table model analytics.imports_exports_2022 ............... [[32mSUCCESS 1[0m in 0.63s]
[0m19:09:39.766923 [debug] [Thread-3 (]: Finished running node model.citrus_trade.imports_exports_2022
[0m19:09:39.767471 [debug] [Thread-2 (]: Began running node model.citrus_trade.score_2022
[0m19:09:39.767785 [info ] [Thread-2 (]: 6 of 7 START sql table model analytics.score_2022 .............................. [RUN]
[0m19:09:39.768237 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.citrus_trade.trade_by_hs, now model.citrus_trade.score_2022)
[0m19:09:39.768520 [debug] [Thread-2 (]: Began compiling node model.citrus_trade.score_2022
[0m19:09:39.770658 [debug] [Thread-2 (]: Writing injected SQL for node "model.citrus_trade.score_2022"
[0m19:09:39.771464 [debug] [Thread-2 (]: Began executing node model.citrus_trade.score_2022
[0m19:09:39.773225 [debug] [Thread-2 (]: Writing runtime sql for node "model.citrus_trade.score_2022"
[0m19:09:39.774225 [debug] [Thread-2 (]: Using snowflake connection "model.citrus_trade.score_2022"
[0m19:09:39.774510 [debug] [Thread-2 (]: On model.citrus_trade.score_2022: create or replace transient table TRHS.analytics.score_2022
    
    
    
    as (select distinct 
    declarant_iso,
    total_value,
    total_quantity,
    value_per_quantity,
    (total_value - min(total_value) over())/((max(total_value) over())-(min(total_value) over())) as score_value,
    (total_quantity - min(total_quantity) over())/((max(total_quantity) over())-(min(total_quantity) over())) as score_quantity,
    (value_per_quantity - min(value_per_quantity) over())/((max(value_per_quantity) over())-(min(value_per_quantity) over())) as score_price
from TRHS.analytics.imports_exports_2022
where flow = 1
    )

/* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.score_2022"} */;
[0m19:09:39.895175 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.752 seconds
[0m19:09:39.896631 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b394527e-b890-4e82-aecb-2a4190ef6591', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa59733d0>]}
[0m19:09:39.897039 [info ] [Thread-4 (]: 4 of 7 OK created sql table model analytics.imports_by_year .................... [[32mSUCCESS 1[0m in 0.77s]
[0m19:09:39.897452 [debug] [Thread-4 (]: Finished running node model.citrus_trade.imports_by_year
[0m19:09:39.897955 [debug] [Thread-3 (]: Began running node model.citrus_trade.growth_score
[0m19:09:39.898259 [info ] [Thread-3 (]: 7 of 7 START sql table model analytics.growth_score ............................ [RUN]
[0m19:09:39.898642 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.citrus_trade.imports_exports_2022, now model.citrus_trade.growth_score)
[0m19:09:39.898900 [debug] [Thread-3 (]: Began compiling node model.citrus_trade.growth_score
[0m19:09:39.900869 [debug] [Thread-3 (]: Writing injected SQL for node "model.citrus_trade.growth_score"
[0m19:09:39.901621 [debug] [Thread-3 (]: Began executing node model.citrus_trade.growth_score
[0m19:09:39.903230 [debug] [Thread-3 (]: Writing runtime sql for node "model.citrus_trade.growth_score"
[0m19:09:39.905236 [debug] [Thread-3 (]: Using snowflake connection "model.citrus_trade.growth_score"
[0m19:09:39.905541 [debug] [Thread-3 (]: On model.citrus_trade.growth_score: create or replace transient table TRHS.analytics.growth_score
    
    
    
    as (with 
    previous_year AS (
        select 
            declarant_iso,
            year,
            lag(total_value,1) over(partition by declarant_iso order by year) previous_year_value,
            total_value,
            first_value(total_value) over(partition by declarant_iso order by year) as first_year_value,
            last_value(total_value) over(partition by declarant_iso order by year) as last_year_value
        from TRHS.analytics.imports_by_year
    ),
    growth_speed AS (
        select 
            declarant_iso,
            year,
            first_year_value,
            last_year_value,
            last_year_value/nullif(first_year_value,0) as growth_overall,
            previous_year_value,
            total_value,
            (total_value - previous_year_value)/total_value * 100 as growth_speed 
        from previous_year
    ),
    previous_year_growth_speed AS (
        select 
            declarant_iso,
            year,
            first_year_value,
            last_year_value,
            growth_overall,
            previous_year_value,
            total_value as current_value,
            growth_speed,
            lag(growth_speed,1) over(partition by declarant_iso order by year) previous_year_growth_speed,
        from growth_speed
        order by 1,2
    ),
    base AS (
        select 
            declarant_iso,
            year,
            first_year_value,
            last_year_value,
            growth_overall,
            previous_year_value,
            current_value,
            previous_year_growth_speed,
            growth_speed,
            growth_speed - previous_year_growth_speed as growth_acceleration,
            avg(growth_acceleration) over(partition by declarant_iso) as avg_acceleration
        from previous_year_growth_speed
    ),
    ok as (
        select 
            declarant_iso,
            year,
            first_year_value,
            last_year_value,
            growth_overall,
            (growth_overall - min(growth_overall) OVER())/(max(growth_overall) OVER() - min(growth_overall) OVER()) as growth_overall_norm,
            previous_year_value,
            current_value,
            -- previous_year_growth_speed,
            growth_speed,
            growth_acceleration,
            avg_acceleration,
            (avg_acceleration - min(avg_acceleration) OVER())/(max(avg_acceleration) OVER() - min(avg_acceleration) OVER()) as avg_acceleration_norm
        from base 
    )
    select 
        declarant_iso,
        year,
        current_value,
        growth_speed,
        growth_acceleration,
        growth_overall,
        growth_overall_norm,
        avg_acceleration,
        avg_acceleration_norm,
        growth_overall_norm * avg_acceleration_norm as growth_score
    from ok
    )

/* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.growth_score"} */;
[0m19:09:40.499752 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.725 seconds
[0m19:09:40.501443 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b394527e-b890-4e82-aecb-2a4190ef6591', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ff6a590>]}
[0m19:09:40.501859 [info ] [Thread-2 (]: 6 of 7 OK created sql table model analytics.score_2022 ......................... [[32mSUCCESS 1[0m in 0.73s]
[0m19:09:40.502368 [debug] [Thread-2 (]: Finished running node model.citrus_trade.score_2022
[0m19:09:40.648361 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.742 seconds
[0m19:09:40.650104 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b394527e-b890-4e82-aecb-2a4190ef6591', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ff6b750>]}
[0m19:09:40.650642 [info ] [Thread-3 (]: 7 of 7 OK created sql table model analytics.growth_score ....................... [[32mSUCCESS 1[0m in 0.75s]
[0m19:09:40.651074 [debug] [Thread-3 (]: Finished running node model.citrus_trade.growth_score
[0m19:09:40.652883 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:09:40.653142 [debug] [MainThread]: Connection 'model.citrus_trade.stg_trade' was left open.
[0m19:09:40.653385 [debug] [MainThread]: On model.citrus_trade.stg_trade: Close
[0m19:09:40.756063 [debug] [MainThread]: Connection 'model.citrus_trade.score_2022' was left open.
[0m19:09:40.756581 [debug] [MainThread]: On model.citrus_trade.score_2022: Close
[0m19:09:40.830208 [debug] [MainThread]: Connection 'model.citrus_trade.growth_score' was left open.
[0m19:09:40.830588 [debug] [MainThread]: On model.citrus_trade.growth_score: Close
[0m19:09:40.906001 [debug] [MainThread]: Connection 'model.citrus_trade.imports_by_year' was left open.
[0m19:09:40.906394 [debug] [MainThread]: On model.citrus_trade.imports_by_year: Close
[0m19:09:40.982697 [info ] [MainThread]: 
[0m19:09:40.983431 [info ] [MainThread]: Finished running 7 table models in 0 hours 0 minutes and 7.04 seconds (7.04s).
[0m19:09:40.984979 [debug] [MainThread]: Command end result
[0m19:09:41.017842 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m19:09:41.020695 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m19:09:41.025696 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/target/run_results.json
[0m19:09:41.025961 [info ] [MainThread]: 
[0m19:09:41.026359 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:09:41.026711 [info ] [MainThread]: 
[0m19:09:41.027069 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=7
[0m19:09:41.028682 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.045987, "process_in_blocks": "0", "process_kernel_time": 1.331252, "process_mem_max_rss": "158740", "process_out_blocks": "6551", "process_user_time": 2.4246}
[0m19:09:41.029334 [debug] [MainThread]: Command `dbt run` succeeded at 19:09:41.029218 after 8.05 seconds
[0m19:09:41.029916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac609690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7680a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5c2a4d0>]}
[0m19:09:41.030200 [debug] [MainThread]: Flushing usage events
[0m19:09:41.612056 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:09:43.133245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e6dc1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e878990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e8792d0>]}


============================== 19:09:43.136386 | 3cb85d6f-dff9-456b-9718-6d086987074b ==============================
[0m19:09:43.136386 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m19:09:43.136844 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'write_json': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'empty': 'None', 'fail_fast': 'False', 'version_check': 'True', 'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'warn_error': 'None', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'invocation_command': 'dbt docs generate', 'indirect_selection': 'eager', 'no_print': 'None', 'log_format': 'default', 'target_path': 'None', 'log_path': '/opt/airflow/dbt/logs', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'use_colors': 'True'}
[0m19:09:43.287304 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m19:09:43.287954 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m19:09:43.288238 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m19:09:43.475222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3cb85d6f-dff9-456b-9718-6d086987074b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d04c710>]}
[0m19:09:43.511050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3cb85d6f-dff9-456b-9718-6d086987074b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f6a28d0>]}
[0m19:09:43.511741 [info ] [MainThread]: Registered adapter: snowflake=1.10.3
[0m19:09:43.565447 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m19:09:43.649517 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:09:43.649866 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:09:43.653279 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.citrus_trade.visualisation
[0m19:09:43.673701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3cb85d6f-dff9-456b-9718-6d086987074b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d016b10>]}
[0m19:09:43.683846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3cb85d6f-dff9-456b-9718-6d086987074b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8cc981d0>]}
[0m19:09:43.684252 [info ] [MainThread]: Found 7 models, 1 source, 636 macros
[0m19:09:43.684586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3cb85d6f-dff9-456b-9718-6d086987074b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8cca8a90>]}
[0m19:09:43.686063 [info ] [MainThread]: 
[0m19:09:43.686494 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:09:43.686793 [info ] [MainThread]: 
[0m19:09:43.687436 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:09:43.690820 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRHS_staging'
[0m19:09:43.691551 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRHS_analytics'
[0m19:09:43.729230 [debug] [ThreadPool]: Using snowflake connection "list_TRHS_staging"
[0m19:09:43.729592 [debug] [ThreadPool]: Using snowflake connection "list_TRHS_analytics"
[0m19:09:43.729901 [debug] [ThreadPool]: On list_TRHS_staging: show objects in TRHS.staging
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS_staging"} */;
[0m19:09:43.730226 [debug] [ThreadPool]: On list_TRHS_analytics: show objects in TRHS.analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS_analytics"} */;
[0m19:09:43.730504 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:09:43.730791 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:09:44.160414 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.430 seconds
[0m19:09:44.168541 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 0.438 seconds
[0m19:09:44.171423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3cb85d6f-dff9-456b-9718-6d086987074b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e57d350>]}
[0m19:09:44.174007 [debug] [Thread-1 (]: Began running node model.citrus_trade.stg_trade
[0m19:09:44.174544 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_TRHS_analytics, now model.citrus_trade.stg_trade)
[0m19:09:44.174823 [debug] [Thread-1 (]: Began compiling node model.citrus_trade.stg_trade
[0m19:09:44.180323 [debug] [Thread-1 (]: Writing injected SQL for node "model.citrus_trade.stg_trade"
[0m19:09:44.181353 [debug] [Thread-1 (]: Began executing node model.citrus_trade.stg_trade
[0m19:09:44.181863 [debug] [Thread-1 (]: Finished running node model.citrus_trade.stg_trade
[0m19:09:44.182527 [debug] [Thread-3 (]: Began running node model.citrus_trade.trade_by_declarant
[0m19:09:44.182972 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.citrus_trade.trade_by_declarant'
[0m19:09:44.183258 [debug] [Thread-3 (]: Began compiling node model.citrus_trade.trade_by_declarant
[0m19:09:44.187311 [debug] [Thread-3 (]: Writing injected SQL for node "model.citrus_trade.trade_by_declarant"
[0m19:09:44.188184 [debug] [Thread-3 (]: Began executing node model.citrus_trade.trade_by_declarant
[0m19:09:44.188630 [debug] [Thread-3 (]: Finished running node model.citrus_trade.trade_by_declarant
[0m19:09:44.189119 [debug] [Thread-2 (]: Began running node model.citrus_trade.trade_by_hs
[0m19:09:44.189557 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_TRHS_staging, now model.citrus_trade.trade_by_hs)
[0m19:09:44.189806 [debug] [Thread-2 (]: Began compiling node model.citrus_trade.trade_by_hs
[0m19:09:44.192067 [debug] [Thread-2 (]: Writing injected SQL for node "model.citrus_trade.trade_by_hs"
[0m19:09:44.193679 [debug] [Thread-2 (]: Began executing node model.citrus_trade.trade_by_hs
[0m19:09:44.194431 [debug] [Thread-2 (]: Finished running node model.citrus_trade.trade_by_hs
[0m19:09:44.195088 [debug] [Thread-4 (]: Began running node model.citrus_trade.imports_by_year
[0m19:09:44.195317 [debug] [Thread-3 (]: Began running node model.citrus_trade.imports_exports_2022
[0m19:09:44.195748 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.citrus_trade.imports_by_year'
[0m19:09:44.196428 [debug] [Thread-4 (]: Began compiling node model.citrus_trade.imports_by_year
[0m19:09:44.196157 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.citrus_trade.trade_by_declarant, now model.citrus_trade.imports_exports_2022)
[0m19:09:44.198888 [debug] [Thread-3 (]: Began compiling node model.citrus_trade.imports_exports_2022
[0m19:09:44.200843 [debug] [Thread-3 (]: Writing injected SQL for node "model.citrus_trade.imports_exports_2022"
[0m19:09:44.198492 [debug] [Thread-4 (]: Writing injected SQL for node "model.citrus_trade.imports_by_year"
[0m19:09:44.201644 [debug] [Thread-3 (]: Began executing node model.citrus_trade.imports_exports_2022
[0m19:09:44.202029 [debug] [Thread-3 (]: Finished running node model.citrus_trade.imports_exports_2022
[0m19:09:44.202173 [debug] [Thread-4 (]: Began executing node model.citrus_trade.imports_by_year
[0m19:09:44.202582 [debug] [Thread-2 (]: Began running node model.citrus_trade.score_2022
[0m19:09:44.202880 [debug] [Thread-4 (]: Finished running node model.citrus_trade.imports_by_year
[0m19:09:44.203180 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.citrus_trade.trade_by_hs, now model.citrus_trade.score_2022)
[0m19:09:44.203595 [debug] [Thread-3 (]: Began running node model.citrus_trade.growth_score
[0m19:09:44.203827 [debug] [Thread-2 (]: Began compiling node model.citrus_trade.score_2022
[0m19:09:44.204084 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.citrus_trade.imports_exports_2022, now model.citrus_trade.growth_score)
[0m19:09:44.206210 [debug] [Thread-2 (]: Writing injected SQL for node "model.citrus_trade.score_2022"
[0m19:09:44.206504 [debug] [Thread-3 (]: Began compiling node model.citrus_trade.growth_score
[0m19:09:44.208764 [debug] [Thread-3 (]: Writing injected SQL for node "model.citrus_trade.growth_score"
[0m19:09:44.209320 [debug] [Thread-2 (]: Began executing node model.citrus_trade.score_2022
[0m19:09:44.209752 [debug] [Thread-2 (]: Finished running node model.citrus_trade.score_2022
[0m19:09:44.209924 [debug] [Thread-3 (]: Began executing node model.citrus_trade.growth_score
[0m19:09:44.210454 [debug] [Thread-3 (]: Finished running node model.citrus_trade.growth_score
[0m19:09:44.212663 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:09:44.212915 [debug] [MainThread]: Connection 'model.citrus_trade.score_2022' was left open.
[0m19:09:44.213099 [debug] [MainThread]: On model.citrus_trade.score_2022: Close
[0m19:09:44.298482 [debug] [MainThread]: Connection 'model.citrus_trade.stg_trade' was left open.
[0m19:09:44.298896 [debug] [MainThread]: On model.citrus_trade.stg_trade: Close
[0m19:09:44.396118 [debug] [MainThread]: Connection 'model.citrus_trade.growth_score' was properly closed.
[0m19:09:44.396484 [debug] [MainThread]: Connection 'model.citrus_trade.imports_by_year' was properly closed.
[0m19:09:44.397214 [debug] [MainThread]: Command end result
[0m19:09:44.465473 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m19:09:44.466968 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m19:09:44.471093 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/target/run_results.json
[0m19:09:44.495699 [debug] [MainThread]: Acquiring new snowflake connection 'generate_catalog'
[0m19:09:44.496051 [info ] [MainThread]: Building catalog
[0m19:09:44.501913 [debug] [ThreadPool]: Acquiring new snowflake connection 'TRHS.information_schema'
[0m19:09:44.502362 [debug] [ThreadPool]: Acquiring new snowflake connection 'trhs.information_schema'
[0m19:09:44.511175 [debug] [ThreadPool]: Using snowflake connection "TRHS.information_schema"
[0m19:09:44.513450 [debug] [ThreadPool]: Using snowflake connection "trhs.information_schema"
[0m19:09:44.513950 [debug] [ThreadPool]: On TRHS.information_schema: with tables as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",
        case
            when is_dynamic = 'YES' and table_type = 'BASE TABLE' THEN 'DYNAMIC TABLE'
            else table_type
        end as "table_type",
        comment as "table_comment",

        -- note: this is the _role_ that owns the table
        table_owner as "table_owner",

        'Clustering Key' as "stats:clustering_key:label",
        clustering_key as "stats:clustering_key:value",
        'The key used to cluster this table' as "stats:clustering_key:description",
        (clustering_key is not null) as "stats:clustering_key:include",

        'Row Count' as "stats:row_count:label",
        row_count as "stats:row_count:value",
        'An approximate count of rows in this table' as "stats:row_count:description",
        (row_count is not null) as "stats:row_count:include",

        'Approximate Size' as "stats:bytes:label",
        bytes as "stats:bytes:value",
        'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
        (bytes is not null) as "stats:bytes:include",

        'Last Modified' as "stats:last_modified:label",
        to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
        'The timestamp for last update/change' as "stats:last_modified:description",
        (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"
    from TRHS.INFORMATION_SCHEMA.tables
            where (
                (
                    
    "table_schema" ilike 'analytics' and upper("table_schema") = upper('analytics')

                    and 
    "table_name" ilike 'score_2022' and upper("table_name") = upper('score_2022')

                )
             or 
                (
                    
    "table_schema" ilike 'analytics' and upper("table_schema") = upper('analytics')

                    and 
    "table_name" ilike 'growth_score' and upper("table_name") = upper('growth_score')

                )
             or 
                (
                    
    "table_schema" ilike 'analytics' and upper("table_schema") = upper('analytics')

                    and 
    "table_name" ilike 'trade_by_hs' and upper("table_name") = upper('trade_by_hs')

                )
             or 
                (
                    
    "table_schema" ilike 'analytics' and upper("table_schema") = upper('analytics')

                    and 
    "table_name" ilike 'imports_exports_2022' and upper("table_name") = upper('imports_exports_2022')

                )
             or 
                (
                    
    "table_schema" ilike 'analytics' and upper("table_schema") = upper('analytics')

                    and 
    "table_name" ilike 'imports_by_year' and upper("table_name") = upper('imports_by_year')

                )
             or 
                (
                    
    "table_schema" ilike 'staging' and upper("table_schema") = upper('staging')

                    and 
    "table_name" ilike 'stg_trade' and upper("table_name") = upper('stg_trade')

                )
             or 
                (
                    
    "table_schema" ilike 'analytics' and upper("table_schema") = upper('analytics')

                    and 
    "table_name" ilike 'trade_by_declarant' and upper("table_name") = upper('trade_by_declarant')

                )
            )
        ),
        columns as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",

        column_name as "column_name",
        ordinal_position as "column_index",
        data_type as "column_type",
        comment as "column_comment"
    from TRHS.INFORMATION_SCHEMA.columns
            where (
                (
                    
    "table_schema" ilike 'analytics' and upper("table_schema") = upper('analytics')

                    and 
    "table_name" ilike 'score_2022' and upper("table_name") = upper('score_2022')

                )
             or 
                (
                    
    "table_schema" ilike 'analytics' and upper("table_schema") = upper('analytics')

                    and 
    "table_name" ilike 'growth_score' and upper("table_name") = upper('growth_score')

                )
             or 
                (
                    
    "table_schema" ilike 'analytics' and upper("table_schema") = upper('analytics')

                    and 
    "table_name" ilike 'trade_by_hs' and upper("table_name") = upper('trade_by_hs')

                )
             or 
                (
                    
    "table_schema" ilike 'analytics' and upper("table_schema") = upper('analytics')

                    and 
    "table_name" ilike 'imports_exports_2022' and upper("table_name") = upper('imports_exports_2022')

                )
             or 
                (
                    
    "table_schema" ilike 'analytics' and upper("table_schema") = upper('analytics')

                    and 
    "table_name" ilike 'imports_by_year' and upper("table_name") = upper('imports_by_year')

                )
             or 
                (
                    
    "table_schema" ilike 'staging' and upper("table_schema") = upper('staging')

                    and 
    "table_name" ilike 'stg_trade' and upper("table_name") = upper('stg_trade')

                )
             or 
                (
                    
    "table_schema" ilike 'analytics' and upper("table_schema") = upper('analytics')

                    and 
    "table_name" ilike 'trade_by_declarant' and upper("table_name") = upper('trade_by_declarant')

                )
            )
        )
        select *
    from tables
    join columns using ("table_database", "table_schema", "table_name")
    order by "column_index"
/* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "TRHS.information_schema"} */
[0m19:09:44.514482 [debug] [ThreadPool]: On trhs.information_schema: with tables as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",
        case
            when is_dynamic = 'YES' and table_type = 'BASE TABLE' THEN 'DYNAMIC TABLE'
            else table_type
        end as "table_type",
        comment as "table_comment",

        -- note: this is the _role_ that owns the table
        table_owner as "table_owner",

        'Clustering Key' as "stats:clustering_key:label",
        clustering_key as "stats:clustering_key:value",
        'The key used to cluster this table' as "stats:clustering_key:description",
        (clustering_key is not null) as "stats:clustering_key:include",

        'Row Count' as "stats:row_count:label",
        row_count as "stats:row_count:value",
        'An approximate count of rows in this table' as "stats:row_count:description",
        (row_count is not null) as "stats:row_count:include",

        'Approximate Size' as "stats:bytes:label",
        bytes as "stats:bytes:value",
        'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
        (bytes is not null) as "stats:bytes:include",

        'Last Modified' as "stats:last_modified:label",
        to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
        'The timestamp for last update/change' as "stats:last_modified:description",
        (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"
    from trhs.INFORMATION_SCHEMA.tables
            where (
                (
                    
    "table_schema" ilike 'staging' and upper("table_schema") = upper('staging')

                    and 
    "table_name" ilike 'citrus_ext' and upper("table_name") = upper('citrus_ext')

                )
            )
        ),
        columns as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",

        column_name as "column_name",
        ordinal_position as "column_index",
        data_type as "column_type",
        comment as "column_comment"
    from trhs.INFORMATION_SCHEMA.columns
            where (
                (
                    
    "table_schema" ilike 'staging' and upper("table_schema") = upper('staging')

                    and 
    "table_name" ilike 'citrus_ext' and upper("table_name") = upper('citrus_ext')

                )
            )
        )
        select *
    from tables
    join columns using ("table_database", "table_schema", "table_name")
    order by "column_index"
/* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "trhs.information_schema"} */
[0m19:09:44.514839 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:09:44.515128 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:09:46.640403 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 2.125 seconds
[0m19:09:48.662304 [debug] [ThreadPool]: SQL status: SUCCESS 64 in 4.147 seconds
[0m19:09:48.700294 [debug] [MainThread]: Wrote artifact CatalogArtifact to /opt/airflow/dbt/target/catalog.json
[0m19:09:48.739776 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m19:09:48.743816 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m19:09:48.744625 [info ] [MainThread]: Catalog written to /opt/airflow/dbt/target/catalog.json
[0m19:09:48.756710 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 5.6608925, "process_in_blocks": "0", "process_kernel_time": 0.34342, "process_mem_max_rss": "152988", "process_out_blocks": "6207", "process_user_time": 1.823969}
[0m19:09:48.757853 [debug] [MainThread]: Command `dbt docs generate` succeeded at 19:09:48.757673 after 5.66 seconds
[0m19:09:48.758705 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m19:09:48.758991 [debug] [MainThread]: Connection 'TRHS.information_schema' was left open.
[0m19:09:48.759325 [debug] [MainThread]: On TRHS.information_schema: Close
[0m19:09:48.844068 [debug] [MainThread]: Connection 'trhs.information_schema' was left open.
[0m19:09:48.844508 [debug] [MainThread]: On trhs.information_schema: Close
[0m19:09:49.051637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e6df550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e743250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8cb5a4d0>]}
[0m19:09:49.112101 [debug] [MainThread]: Flushing usage events
[0m19:09:49.625429 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:09:50.876841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff819ee790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff819eda50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff819ec590>]}


============================== 19:09:50.879114 | d5278994-bf31-4aab-9fd2-9de31f903d95 ==============================
[0m19:09:50.879114 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m19:09:50.879634 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True', 'cache_selected_only': 'False', 'quiet': 'False', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'write_json': 'True', 'invocation_command': 'dbt docs serve --port 5050 --host 0.0.0.0', 'log_path': '/opt/airflow/dbt/logs', 'use_colors': 'True', 'empty': 'None', 'indirect_selection': 'eager', 'no_print': 'None', 'target_path': 'None', 'printer_width': '80', 'profiles_dir': '/opt/airflow/dbt', 'partial_parse': 'True', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'static_parser': 'True'}
[0m19:09:51.051105 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m19:09:51.052007 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m19:09:51.052374 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m19:09:51.241653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd5278994-bf31-4aab-9fd2-9de31f903d95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80308990>]}
[0m19:09:51.273586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd5278994-bf31-4aab-9fd2-9de31f903d95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff829b2bd0>]}
[0m19:26:50.656273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa19eeab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa426fad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1f28b30>]}


============================== 19:26:50.663786 | 8dd072aa-5b93-4837-803d-b83256923c1c ==============================
[0m19:26:50.663786 [info ] [MainThread]: Running with dbt=1.10.13
[0m19:26:50.664305 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'debug': 'False', 'introspect': 'True', 'log_cache_events': 'False', 'fail_fast': 'False', 'empty': 'False', 'use_colors': 'True', 'write_json': 'True', 'invocation_command': 'dbt run', 'quiet': 'False', 'warn_error': 'None', 'printer_width': '80', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'version_check': 'True', 'indirect_selection': 'eager', 'profiles_dir': '/opt/airflow/dbt', 'cache_selected_only': 'False', 'target_path': 'None', 'log_path': '/opt/airflow/dbt/logs'}
[0m19:26:50.976477 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m19:26:50.976977 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m19:26:50.977204 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m19:26:51.098412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8dd072aa-5b93-4837-803d-b83256923c1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9fbf25a0>]}
[0m19:26:51.137543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8dd072aa-5b93-4837-803d-b83256923c1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1aa2d50>]}
[0m19:26:51.138284 [info ] [MainThread]: Registered adapter: snowflake=1.10.3
[0m19:26:51.225714 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m19:26:51.284788 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m19:26:51.285176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '8dd072aa-5b93-4837-803d-b83256923c1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1adc890>]}
[0m19:26:52.064465 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.citrus_trade.visualisation
[0m19:26:52.071852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8dd072aa-5b93-4837-803d-b83256923c1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f6f1970>]}
[0m19:26:52.116896 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m19:26:52.120389 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m19:26:52.148480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8dd072aa-5b93-4837-803d-b83256923c1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f6b3e90>]}
[0m19:26:52.148795 [info ] [MainThread]: Found 7 models, 1 source, 636 macros
[0m19:26:52.149028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8dd072aa-5b93-4837-803d-b83256923c1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f72f830>]}
[0m19:26:52.150096 [info ] [MainThread]: 
[0m19:26:52.150325 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:26:52.150580 [info ] [MainThread]: 
[0m19:26:52.150990 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:26:52.154071 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRHS'
[0m19:26:52.160243 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRHS'
[0m19:26:52.233360 [debug] [ThreadPool]: Using snowflake connection "list_TRHS"
[0m19:26:52.233727 [debug] [ThreadPool]: Using snowflake connection "list_TRHS"
[0m19:26:52.233899 [debug] [ThreadPool]: On list_TRHS: show terse schemas in database TRHS
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS"} */
[0m19:26:52.234177 [debug] [ThreadPool]: On list_TRHS: show terse schemas in database TRHS
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS"} */
[0m19:26:52.234411 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:26:52.234620 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:26:53.748815 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.514 seconds
[0m19:26:53.795561 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.561 seconds
[0m19:26:53.802423 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRHS, now list_TRHS_staging)
[0m19:26:53.809479 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRHS, now list_TRHS_analytics)
[0m19:26:53.831906 [debug] [ThreadPool]: Using snowflake connection "list_TRHS_analytics"
[0m19:26:53.832594 [debug] [ThreadPool]: Using snowflake connection "list_TRHS_staging"
[0m19:26:53.832896 [debug] [ThreadPool]: On list_TRHS_analytics: show objects in TRHS.analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS_analytics"} */;
[0m19:26:53.833328 [debug] [ThreadPool]: On list_TRHS_staging: show objects in TRHS.staging
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS_staging"} */;
[0m19:26:53.913227 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 0.079 seconds
[0m19:26:53.937188 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.103 seconds
[0m19:26:53.940534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8dd072aa-5b93-4837-803d-b83256923c1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f739e20>]}
[0m19:26:53.949729 [debug] [Thread-1 (]: Began running node model.citrus_trade.stg_trade
[0m19:26:53.950337 [info ] [Thread-1 (]: 1 of 7 START sql table model staging.stg_trade ................................. [RUN]
[0m19:26:53.950908 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_TRHS_staging, now model.citrus_trade.stg_trade)
[0m19:26:53.951386 [debug] [Thread-1 (]: Began compiling node model.citrus_trade.stg_trade
[0m19:26:53.959219 [debug] [Thread-1 (]: Writing injected SQL for node "model.citrus_trade.stg_trade"
[0m19:26:53.960630 [debug] [Thread-1 (]: Began executing node model.citrus_trade.stg_trade
[0m19:26:53.987072 [debug] [Thread-1 (]: Writing runtime sql for node "model.citrus_trade.stg_trade"
[0m19:26:53.988969 [debug] [Thread-1 (]: Using snowflake connection "model.citrus_trade.stg_trade"
[0m19:26:53.989260 [debug] [Thread-1 (]: On model.citrus_trade.stg_trade: create or replace transient table TRHS.staging.stg_trade
    
    
    
    as (select
  value:DECLARANT::int as declarant,
  value:DECLARANT_ISO::string as declarant_iso,
  value:PARTNER::string as partner,
  value:PARTNER_ISO::string as partner_iso,
  value:FLOW::int as flow,
  value:TRANSPORT_MODE::int as transport_mode,
  value:PERIOD::int as period,
  value:HS4::string as hs4,
  value:HS4_NAME::string as hs4_name,
  value:HS6::string as hs6,
  value:HS6_NAME::string as hs6_name,
  value:VALUE_IN_EUROS::float as value_in_euros,
  value:QUANTITY_IN_KG::float as quantity_in_kg
from trhs.staging.citrus_ext
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.stg_trade"} */;
[0m19:26:55.359959 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.370 seconds
[0m19:26:55.392614 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8dd072aa-5b93-4837-803d-b83256923c1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9df299a0>]}
[0m19:26:55.393318 [info ] [Thread-1 (]: 1 of 7 OK created sql table model staging.stg_trade ............................ [[32mSUCCESS 1[0m in 1.44s]
[0m19:26:55.394148 [debug] [Thread-1 (]: Finished running node model.citrus_trade.stg_trade
[0m19:26:55.395304 [debug] [Thread-3 (]: Began running node model.citrus_trade.trade_by_declarant
[0m19:26:55.395822 [info ] [Thread-3 (]: 2 of 7 START sql table model analytics.trade_by_declarant ...................... [RUN]
[0m19:26:55.396483 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.citrus_trade.trade_by_declarant'
[0m19:26:55.396865 [debug] [Thread-3 (]: Began compiling node model.citrus_trade.trade_by_declarant
[0m19:26:55.400661 [debug] [Thread-3 (]: Writing injected SQL for node "model.citrus_trade.trade_by_declarant"
[0m19:26:55.402409 [debug] [Thread-3 (]: Began executing node model.citrus_trade.trade_by_declarant
[0m19:26:55.404780 [debug] [Thread-3 (]: Writing runtime sql for node "model.citrus_trade.trade_by_declarant"
[0m19:26:55.406370 [debug] [Thread-3 (]: Using snowflake connection "model.citrus_trade.trade_by_declarant"
[0m19:26:55.406756 [debug] [Thread-3 (]: On model.citrus_trade.trade_by_declarant: create or replace transient table TRHS.analytics.trade_by_declarant
    
    
    
    as (select 
    declarant,
    declarant_iso,
    partner,
    partner_iso,
    flow,
    transport_mode,
    year(to_date(left(period,4),'YYYY')) as year,
    period,
    hs6,
    hs6_name,
    sum(value_in_euros) as value,
    sum(quantity_in_kg) as quantity
from TRHS.staging.stg_trade
group by 1,2,3,4,5,6,7,8,9,10
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.trade_by_declarant"} */;
[0m19:26:55.407091 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m19:26:56.422740 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.016 seconds
[0m19:26:56.426129 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8dd072aa-5b93-4837-803d-b83256923c1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f711490>]}
[0m19:26:56.426946 [info ] [Thread-3 (]: 2 of 7 OK created sql table model analytics.trade_by_declarant ................. [[32mSUCCESS 1[0m in 1.03s]
[0m19:26:56.427637 [debug] [Thread-3 (]: Finished running node model.citrus_trade.trade_by_declarant
[0m19:26:56.429056 [debug] [Thread-2 (]: Began running node model.citrus_trade.trade_by_hs
[0m19:26:56.429983 [info ] [Thread-2 (]: 3 of 7 START sql table model analytics.trade_by_hs ............................. [RUN]
[0m19:26:56.430556 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_TRHS_analytics, now model.citrus_trade.trade_by_hs)
[0m19:26:56.431221 [debug] [Thread-2 (]: Began compiling node model.citrus_trade.trade_by_hs
[0m19:26:56.439572 [debug] [Thread-2 (]: Writing injected SQL for node "model.citrus_trade.trade_by_hs"
[0m19:26:56.441305 [debug] [Thread-2 (]: Began executing node model.citrus_trade.trade_by_hs
[0m19:26:56.445918 [debug] [Thread-2 (]: Writing runtime sql for node "model.citrus_trade.trade_by_hs"
[0m19:26:56.447457 [debug] [Thread-2 (]: Using snowflake connection "model.citrus_trade.trade_by_hs"
[0m19:26:56.447729 [debug] [Thread-2 (]: On model.citrus_trade.trade_by_hs: create or replace transient table TRHS.analytics.trade_by_hs
    
    
    
    as (select
    *
from TRHS.analytics.trade_by_declarant
where hs6 = '080510'
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.trade_by_hs"} */;
[0m19:26:57.187439 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.739 seconds
[0m19:26:57.194532 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8dd072aa-5b93-4837-803d-b83256923c1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ffca930>]}
[0m19:26:57.196083 [info ] [Thread-2 (]: 3 of 7 OK created sql table model analytics.trade_by_hs ........................ [[32mSUCCESS 1[0m in 0.76s]
[0m19:26:57.197979 [debug] [Thread-2 (]: Finished running node model.citrus_trade.trade_by_hs
[0m19:26:57.200380 [debug] [Thread-4 (]: Began running node model.citrus_trade.imports_by_year
[0m19:26:57.201187 [debug] [Thread-3 (]: Began running node model.citrus_trade.imports_exports_2022
[0m19:26:57.201893 [info ] [Thread-4 (]: 4 of 7 START sql table model analytics.imports_by_year ......................... [RUN]
[0m19:26:57.203618 [info ] [Thread-3 (]: 5 of 7 START sql table model analytics.imports_exports_2022 .................... [RUN]
[0m19:26:57.206783 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.citrus_trade.trade_by_declarant, now model.citrus_trade.imports_exports_2022)
[0m19:26:57.207295 [debug] [Thread-3 (]: Began compiling node model.citrus_trade.imports_exports_2022
[0m19:26:57.206200 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.citrus_trade.imports_by_year'
[0m19:26:57.214250 [debug] [Thread-3 (]: Writing injected SQL for node "model.citrus_trade.imports_exports_2022"
[0m19:26:57.214956 [debug] [Thread-4 (]: Began compiling node model.citrus_trade.imports_by_year
[0m19:26:57.222610 [debug] [Thread-4 (]: Writing injected SQL for node "model.citrus_trade.imports_by_year"
[0m19:26:57.224023 [debug] [Thread-3 (]: Began executing node model.citrus_trade.imports_exports_2022
[0m19:26:57.227543 [debug] [Thread-3 (]: Writing runtime sql for node "model.citrus_trade.imports_exports_2022"
[0m19:26:57.229645 [debug] [Thread-4 (]: Began executing node model.citrus_trade.imports_by_year
[0m19:26:57.234060 [debug] [Thread-4 (]: Writing runtime sql for node "model.citrus_trade.imports_by_year"
[0m19:26:57.235527 [debug] [Thread-3 (]: Using snowflake connection "model.citrus_trade.imports_exports_2022"
[0m19:26:57.235897 [debug] [Thread-3 (]: On model.citrus_trade.imports_exports_2022: create or replace transient table TRHS.analytics.imports_exports_2022
    
    
    
    as (select
    declarant_iso,
    flow,
    sum(value) over(partition by declarant_iso, flow) as total_value,
    sum(quantity) over(partition by declarant_iso, flow) as total_quantity,
    total_value/nullif(total_quantity,0) as value_per_quantity
from TRHS.analytics.trade_by_hs
group by 
    declarant_iso,
    flow,
    value,
    quantity
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.imports_exports_2022"} */;
[0m19:26:57.239108 [debug] [Thread-4 (]: Using snowflake connection "model.citrus_trade.imports_by_year"
[0m19:26:57.239418 [debug] [Thread-4 (]: On model.citrus_trade.imports_by_year: create or replace transient table TRHS.analytics.imports_by_year
    
    
    
    as (select
    declarant_iso,
    year,
    sum(value) as total_value,
    sum(quantity) as total_quantity,
    total_value/nullif(total_quantity,0) as value_per_quantity
from TRHS.analytics.trade_by_hs
where flow = 1
group by 1,2
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.imports_by_year"} */;
[0m19:26:57.239678 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m19:26:57.858891 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.622 seconds
[0m19:26:57.865420 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8dd072aa-5b93-4837-803d-b83256923c1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9fba5eb0>]}
[0m19:26:57.866871 [info ] [Thread-3 (]: 5 of 7 OK created sql table model analytics.imports_exports_2022 ............... [[32mSUCCESS 1[0m in 0.66s]
[0m19:26:57.868173 [debug] [Thread-3 (]: Finished running node model.citrus_trade.imports_exports_2022
[0m19:26:57.869516 [debug] [Thread-2 (]: Began running node model.citrus_trade.score_2022
[0m19:26:57.870424 [info ] [Thread-2 (]: 6 of 7 START sql table model analytics.score_2022 .............................. [RUN]
[0m19:26:57.871641 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.citrus_trade.trade_by_hs, now model.citrus_trade.score_2022)
[0m19:26:57.872422 [debug] [Thread-2 (]: Began compiling node model.citrus_trade.score_2022
[0m19:26:57.877659 [debug] [Thread-2 (]: Writing injected SQL for node "model.citrus_trade.score_2022"
[0m19:26:57.880124 [debug] [Thread-2 (]: Began executing node model.citrus_trade.score_2022
[0m19:26:57.884098 [debug] [Thread-2 (]: Writing runtime sql for node "model.citrus_trade.score_2022"
[0m19:26:57.887085 [debug] [Thread-2 (]: Using snowflake connection "model.citrus_trade.score_2022"
[0m19:26:57.887562 [debug] [Thread-2 (]: On model.citrus_trade.score_2022: create or replace transient table TRHS.analytics.score_2022
    
    
    
    as (select distinct 
    declarant_iso,
    total_value,
    total_quantity,
    value_per_quantity,
    (total_value - min(total_value) over())/((max(total_value) over())-(min(total_value) over())) as score_value,
    (total_quantity - min(total_quantity) over())/((max(total_quantity) over())-(min(total_quantity) over())) as score_quantity,
    (value_per_quantity - min(value_per_quantity) over())/((max(value_per_quantity) over())-(min(value_per_quantity) over())) as score_price
from TRHS.analytics.imports_exports_2022
where flow = 1
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.score_2022"} */;
[0m19:26:57.961682 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.722 seconds
[0m19:26:57.965286 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8dd072aa-5b93-4837-803d-b83256923c1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f9042f0>]}
[0m19:26:57.966354 [info ] [Thread-4 (]: 4 of 7 OK created sql table model analytics.imports_by_year .................... [[32mSUCCESS 1[0m in 0.76s]
[0m19:26:57.967353 [debug] [Thread-4 (]: Finished running node model.citrus_trade.imports_by_year
[0m19:26:57.968463 [debug] [Thread-3 (]: Began running node model.citrus_trade.growth_score
[0m19:26:57.969264 [info ] [Thread-3 (]: 7 of 7 START sql table model analytics.growth_score ............................ [RUN]
[0m19:26:57.970148 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.citrus_trade.imports_exports_2022, now model.citrus_trade.growth_score)
[0m19:26:57.971072 [debug] [Thread-3 (]: Began compiling node model.citrus_trade.growth_score
[0m19:26:57.975974 [debug] [Thread-3 (]: Writing injected SQL for node "model.citrus_trade.growth_score"
[0m19:26:57.977670 [debug] [Thread-3 (]: Began executing node model.citrus_trade.growth_score
[0m19:26:57.981259 [debug] [Thread-3 (]: Writing runtime sql for node "model.citrus_trade.growth_score"
[0m19:26:57.988982 [debug] [Thread-3 (]: Using snowflake connection "model.citrus_trade.growth_score"
[0m19:26:57.990642 [debug] [Thread-3 (]: On model.citrus_trade.growth_score: create or replace transient table TRHS.analytics.growth_score
    
    
    
    as (with 
    previous_year AS (
        select 
            declarant_iso,
            year,
            lag(total_value,1) over(partition by declarant_iso order by year) previous_year_value,
            total_value,
            first_value(total_value) over(partition by declarant_iso order by year) as first_year_value,
            last_value(total_value) over(partition by declarant_iso order by year) as last_year_value
        from TRHS.analytics.imports_by_year
    ),
    growth_speed AS (
        select 
            declarant_iso,
            year,
            first_year_value,
            last_year_value,
            last_year_value/nullif(first_year_value,0) as growth_overall,
            previous_year_value,
            total_value,
            (total_value - previous_year_value)/total_value * 100 as growth_speed 
        from previous_year
    ),
    previous_year_growth_speed AS (
        select 
            declarant_iso,
            year,
            first_year_value,
            last_year_value,
            growth_overall,
            previous_year_value,
            total_value as current_value,
            growth_speed,
            lag(growth_speed,1) over(partition by declarant_iso order by year) previous_year_growth_speed,
        from growth_speed
        order by 1,2
    ),
    base AS (
        select 
            declarant_iso,
            year,
            first_year_value,
            last_year_value,
            growth_overall,
            previous_year_value,
            current_value,
            previous_year_growth_speed,
            growth_speed,
            growth_speed - previous_year_growth_speed as growth_acceleration,
            avg(growth_acceleration) over(partition by declarant_iso) as avg_acceleration
        from previous_year_growth_speed
    ),
    ok as (
        select 
            declarant_iso,
            year,
            first_year_value,
            last_year_value,
            growth_overall,
            (growth_overall - min(growth_overall) OVER())/(max(growth_overall) OVER() - min(growth_overall) OVER()) as growth_overall_norm,
            previous_year_value,
            current_value,
            -- previous_year_growth_speed,
            growth_speed,
            growth_acceleration,
            avg_acceleration,
            (avg_acceleration - min(avg_acceleration) OVER())/(max(avg_acceleration) OVER() - min(avg_acceleration) OVER()) as avg_acceleration_norm
        from base 
    )
    select 
        declarant_iso,
        year,
        current_value,
        growth_speed,
        growth_acceleration,
        growth_overall,
        growth_overall_norm,
        avg_acceleration,
        avg_acceleration_norm,
        growth_overall_norm * avg_acceleration_norm as growth_score
    from ok
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.growth_score"} */;
[0m19:26:58.471637 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.583 seconds
[0m19:26:58.476743 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8dd072aa-5b93-4837-803d-b83256923c1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f3270b0>]}
[0m19:26:58.477869 [info ] [Thread-2 (]: 6 of 7 OK created sql table model analytics.score_2022 ......................... [[32mSUCCESS 1[0m in 0.61s]
[0m19:26:58.478711 [debug] [Thread-2 (]: Finished running node model.citrus_trade.score_2022
[0m19:26:58.666630 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.675 seconds
[0m19:26:58.671036 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8dd072aa-5b93-4837-803d-b83256923c1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f7bb950>]}
[0m19:26:58.672486 [info ] [Thread-3 (]: 7 of 7 OK created sql table model analytics.growth_score ....................... [[32mSUCCESS 1[0m in 0.70s]
[0m19:26:58.673794 [debug] [Thread-3 (]: Finished running node model.citrus_trade.growth_score
[0m19:26:58.677352 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:26:58.677881 [debug] [MainThread]: Connection 'model.citrus_trade.stg_trade' was left open.
[0m19:26:58.678384 [debug] [MainThread]: On model.citrus_trade.stg_trade: Close
[0m19:26:58.793380 [debug] [MainThread]: Connection 'model.citrus_trade.score_2022' was left open.
[0m19:26:58.795067 [debug] [MainThread]: On model.citrus_trade.score_2022: Close
[0m19:26:58.880907 [debug] [MainThread]: Connection 'model.citrus_trade.growth_score' was left open.
[0m19:26:58.881778 [debug] [MainThread]: On model.citrus_trade.growth_score: Close
[0m19:26:58.976766 [debug] [MainThread]: Connection 'model.citrus_trade.imports_by_year' was left open.
[0m19:26:58.977853 [debug] [MainThread]: On model.citrus_trade.imports_by_year: Close
[0m19:26:59.061688 [info ] [MainThread]: 
[0m19:26:59.063408 [info ] [MainThread]: Finished running 7 table models in 0 hours 0 minutes and 6.91 seconds (6.91s).
[0m19:26:59.068187 [debug] [MainThread]: Command end result
[0m19:26:59.124564 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m19:26:59.127607 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m19:26:59.133327 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/target/run_results.json
[0m19:26:59.133640 [info ] [MainThread]: 
[0m19:26:59.134092 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:26:59.134472 [info ] [MainThread]: 
[0m19:26:59.134839 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=7
[0m19:26:59.136331 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.519519, "process_in_blocks": "107080", "process_kernel_time": 1.073449, "process_mem_max_rss": "158604", "process_out_blocks": "11333", "process_user_time": 3.247795}
[0m19:26:59.136766 [debug] [MainThread]: Command `dbt run` succeeded at 19:26:59.136699 after 8.52 seconds
[0m19:26:59.137108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9df3a420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9df3a3c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9df48980>]}
[0m19:26:59.137360 [debug] [MainThread]: Flushing usage events
[0m19:26:59.815861 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:30:31.094951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9efdad50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e077150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e077ad0>]}


============================== 19:30:31.100083 | e73dd885-d944-4dda-99d3-ef1489b1bce9 ==============================
[0m19:30:31.100083 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m19:30:31.100570 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'printer_width': '80', 'static_parser': 'True', 'fail_fast': 'False', 'introspect': 'True', 'write_json': 'True', 'profiles_dir': '/opt/airflow/dbt', 'indirect_selection': 'eager', 'log_path': '/opt/airflow/dbt/logs', 'no_print': 'None', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'log_format': 'default', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'use_experimental_parser': 'False', 'quiet': 'False', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'empty': 'None'}
[0m19:30:31.198641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e73dd885-d944-4dda-99d3-ef1489b1bce9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9de931d0>]}
[0m19:30:31.308330 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-sqjmqhw7'
[0m19:30:31.309434 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m19:30:31.468240 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m19:30:31.469886 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json
[0m19:30:31.819798 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json 200
[0m19:30:31.826105 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m19:30:31.899804 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m19:30:31.909199 [info ] [MainThread]: Installing dbt-labs/codegen
[0m19:30:32.295367 [info ] [MainThread]: Installed from version 0.13.1
[0m19:30:32.296022 [info ] [MainThread]: Up to date!
[0m19:30:32.297006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'e73dd885-d944-4dda-99d3-ef1489b1bce9', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e018490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9df27f50>]}
[0m19:30:32.297403 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m19:30:32.866684 [info ] [MainThread]: Installed from version 1.3.1
[0m19:30:32.868305 [info ] [MainThread]: Updated version available: 1.3.2
[0m19:30:32.871759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'e73dd885-d944-4dda-99d3-ef1489b1bce9', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e018f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9de7f510>]}
[0m19:30:32.886325 [info ] [MainThread]: 
[0m19:30:32.895684 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m19:30:32.931511 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 1.8657802, "process_in_blocks": "6352", "process_kernel_time": 0.639366, "process_mem_max_rss": "106828", "process_out_blocks": "3119", "process_user_time": 1.290911}
[0m19:30:32.934310 [debug] [MainThread]: Command `dbt deps` succeeded at 19:30:32.934083 after 1.87 seconds
[0m19:30:32.935102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9df6bbd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e28dc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9efda5d0>]}
[0m19:30:32.935502 [debug] [MainThread]: Flushing usage events
[0m19:30:33.886614 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:30:35.726572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80b91010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff808eb510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff808ea7d0>]}


============================== 19:30:35.729511 | 35e872ad-26d2-4d5c-93d5-0f1eda65bb41 ==============================
[0m19:30:35.729511 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m19:30:35.730137 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'log_path': '/opt/airflow/dbt/logs', 'printer_width': '80', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'debug': 'False', 'log_cache_events': 'False', 'empty': 'None', 'no_print': 'None', 'use_colors': 'True', 'indirect_selection': 'eager', 'profiles_dir': '/opt/airflow/dbt', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_format': 'default', 'invocation_command': 'dbt seed', 'version_check': 'True', 'warn_error': 'None', 'target_path': 'None', 'static_parser': 'True', 'introspect': 'True', 'fail_fast': 'False'}
[0m19:30:36.135999 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m19:30:36.137050 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m19:30:36.138118 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m19:30:36.327430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '35e872ad-26d2-4d5c-93d5-0f1eda65bb41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff808f5c50>]}
[0m19:30:36.366072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '35e872ad-26d2-4d5c-93d5-0f1eda65bb41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff818ae6d0>]}
[0m19:30:36.366978 [info ] [MainThread]: Registered adapter: snowflake=1.10.3
[0m19:30:36.441194 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m19:30:36.513720 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m19:30:36.514311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '35e872ad-26d2-4d5c-93d5-0f1eda65bb41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff818c9390>]}
[0m19:30:37.454215 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.citrus_trade.visualisation
[0m19:30:37.461539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '35e872ad-26d2-4d5c-93d5-0f1eda65bb41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ed0a590>]}
[0m19:30:37.514702 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m19:30:37.517050 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m19:30:37.537789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '35e872ad-26d2-4d5c-93d5-0f1eda65bb41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7edccb90>]}
[0m19:30:37.538272 [info ] [MainThread]: Found 7 models, 1 source, 636 macros
[0m19:30:37.538683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '35e872ad-26d2-4d5c-93d5-0f1eda65bb41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ef872d0>]}
[0m19:30:37.539944 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m19:30:37.540585 [debug] [MainThread]: Command end result
[0m19:30:37.564513 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m19:30:37.565908 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m19:30:37.568055 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/target/run_results.json
[0m19:30:37.568261 [info ] [MainThread]: 
[0m19:30:37.568622 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:30:37.568971 [info ] [MainThread]: 
[0m19:30:37.569335 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=0
[0m19:30:37.570236 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 1.8780713, "process_in_blocks": "17768", "process_kernel_time": 0.626841, "process_mem_max_rss": "139160", "process_out_blocks": "4340", "process_user_time": 2.555036}
[0m19:30:37.570577 [debug] [MainThread]: Command `dbt seed` succeeded at 19:30:37.570518 after 1.88 seconds
[0m19:30:37.570867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff817fe310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85950950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85950990>]}
[0m19:30:37.571163 [debug] [MainThread]: Flushing usage events
[0m19:30:38.057911 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:30:39.231640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9fabe110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9fabe210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9fabe010>]}


============================== 19:30:39.233997 | 0c6ec735-acb7-4c90-9eb8-64175fb6851e ==============================
[0m19:30:39.233997 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m19:30:39.234566 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_format': 'default', 'invocation_command': 'dbt run', 'use_colors': 'True', 'printer_width': '80', 'version_check': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'write_json': 'True', 'use_experimental_parser': 'False', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '/opt/airflow/dbt', 'introspect': 'True', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'fail_fast': 'False', 'partial_parse': 'True', 'empty': 'False', 'log_path': '/opt/airflow/dbt/logs', 'static_parser': 'True', 'quiet': 'False', 'target_path': 'None', 'debug': 'False', 'no_print': 'None'}
[0m19:30:39.476784 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m19:30:39.477491 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m19:30:39.477727 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m19:30:39.659482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0c6ec735-acb7-4c90-9eb8-64175fb6851e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e3eac10>]}
[0m19:30:39.697548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0c6ec735-acb7-4c90-9eb8-64175fb6851e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e585c90>]}
[0m19:30:39.698238 [info ] [MainThread]: Registered adapter: snowflake=1.10.3
[0m19:30:39.762038 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m19:30:39.848785 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:30:39.849256 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:30:39.853302 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.citrus_trade.visualisation
[0m19:30:39.871053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0c6ec735-acb7-4c90-9eb8-64175fb6851e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9dfbaf10>]}
[0m19:30:39.987385 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m19:30:39.993505 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m19:30:40.017053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0c6ec735-acb7-4c90-9eb8-64175fb6851e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9dfaef10>]}
[0m19:30:40.017793 [info ] [MainThread]: Found 7 models, 1 source, 636 macros
[0m19:30:40.018887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0c6ec735-acb7-4c90-9eb8-64175fb6851e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e0b68d0>]}
[0m19:30:40.020812 [info ] [MainThread]: 
[0m19:30:40.022962 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:30:40.026229 [info ] [MainThread]: 
[0m19:30:40.028147 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:30:40.033723 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRHS'
[0m19:30:40.034696 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRHS'
[0m19:30:40.189961 [debug] [ThreadPool]: Using snowflake connection "list_TRHS"
[0m19:30:40.190559 [debug] [ThreadPool]: Using snowflake connection "list_TRHS"
[0m19:30:40.191124 [debug] [ThreadPool]: On list_TRHS: show terse schemas in database TRHS
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS"} */
[0m19:30:40.192377 [debug] [ThreadPool]: On list_TRHS: show terse schemas in database TRHS
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS"} */
[0m19:30:40.193425 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:30:40.193748 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:30:41.877748 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.684 seconds
[0m19:30:41.891805 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.698 seconds
[0m19:30:41.894239 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRHS, now list_TRHS_analytics)
[0m19:30:41.894649 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRHS, now list_TRHS_staging)
[0m19:30:41.903484 [debug] [ThreadPool]: Using snowflake connection "list_TRHS_analytics"
[0m19:30:41.905144 [debug] [ThreadPool]: Using snowflake connection "list_TRHS_staging"
[0m19:30:41.905460 [debug] [ThreadPool]: On list_TRHS_analytics: show objects in TRHS.analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS_analytics"} */;
[0m19:30:41.905784 [debug] [ThreadPool]: On list_TRHS_staging: show objects in TRHS.staging
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS_staging"} */;
[0m19:30:42.003104 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 0.097 seconds
[0m19:30:42.021767 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.115 seconds
[0m19:30:42.023627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0c6ec735-acb7-4c90-9eb8-64175fb6851e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d32d7d0>]}
[0m19:30:42.029499 [debug] [Thread-1 (]: Began running node model.citrus_trade.stg_trade
[0m19:30:42.030004 [info ] [Thread-1 (]: 1 of 7 START sql table model staging.stg_trade ................................. [RUN]
[0m19:30:42.030529 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_TRHS_staging, now model.citrus_trade.stg_trade)
[0m19:30:42.030907 [debug] [Thread-1 (]: Began compiling node model.citrus_trade.stg_trade
[0m19:30:42.036114 [debug] [Thread-1 (]: Writing injected SQL for node "model.citrus_trade.stg_trade"
[0m19:30:42.037187 [debug] [Thread-1 (]: Began executing node model.citrus_trade.stg_trade
[0m19:30:42.059966 [debug] [Thread-1 (]: Writing runtime sql for node "model.citrus_trade.stg_trade"
[0m19:30:42.061725 [debug] [Thread-1 (]: Using snowflake connection "model.citrus_trade.stg_trade"
[0m19:30:42.062039 [debug] [Thread-1 (]: On model.citrus_trade.stg_trade: create or replace transient table TRHS.staging.stg_trade
    
    
    
    as (select
  value:DECLARANT::int as declarant,
  value:DECLARANT_ISO::string as declarant_iso,
  value:PARTNER::string as partner,
  value:PARTNER_ISO::string as partner_iso,
  value:FLOW::int as flow,
  value:TRANSPORT_MODE::int as transport_mode,
  value:PERIOD::int as period,
  value:HS4::string as hs4,
  value:HS4_NAME::string as hs4_name,
  value:HS6::string as hs6,
  value:HS6_NAME::string as hs6_name,
  value:VALUE_IN_EUROS::float as value_in_euros,
  value:QUANTITY_IN_KG::float as quantity_in_kg
from trhs.staging.citrus_ext
    )

/* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.stg_trade"} */;
[0m19:30:42.834731 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.772 seconds
[0m19:30:42.854994 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c6ec735-acb7-4c90-9eb8-64175fb6851e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e099e50>]}
[0m19:30:42.855794 [info ] [Thread-1 (]: 1 of 7 OK created sql table model staging.stg_trade ............................ [[32mSUCCESS 1[0m in 0.82s]
[0m19:30:42.856465 [debug] [Thread-1 (]: Finished running node model.citrus_trade.stg_trade
[0m19:30:42.857608 [debug] [Thread-3 (]: Began running node model.citrus_trade.trade_by_declarant
[0m19:30:42.858113 [info ] [Thread-3 (]: 2 of 7 START sql table model analytics.trade_by_declarant ...................... [RUN]
[0m19:30:42.858833 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.citrus_trade.trade_by_declarant'
[0m19:30:42.859213 [debug] [Thread-3 (]: Began compiling node model.citrus_trade.trade_by_declarant
[0m19:30:42.863704 [debug] [Thread-3 (]: Writing injected SQL for node "model.citrus_trade.trade_by_declarant"
[0m19:30:42.865192 [debug] [Thread-3 (]: Began executing node model.citrus_trade.trade_by_declarant
[0m19:30:42.867604 [debug] [Thread-3 (]: Writing runtime sql for node "model.citrus_trade.trade_by_declarant"
[0m19:30:42.873426 [debug] [Thread-3 (]: Using snowflake connection "model.citrus_trade.trade_by_declarant"
[0m19:30:42.875576 [debug] [Thread-3 (]: On model.citrus_trade.trade_by_declarant: create or replace transient table TRHS.analytics.trade_by_declarant
    
    
    
    as (select 
    declarant,
    declarant_iso,
    partner,
    partner_iso,
    flow,
    transport_mode,
    year(to_date(left(period,4),'YYYY')) as year,
    period,
    hs6,
    hs6_name,
    sum(value_in_euros) as value,
    sum(quantity_in_kg) as quantity
from TRHS.staging.stg_trade
group by 1,2,3,4,5,6,7,8,9,10
    )

/* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.trade_by_declarant"} */;
[0m19:30:42.879148 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m19:30:43.950828 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.072 seconds
[0m19:30:43.955950 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c6ec735-acb7-4c90-9eb8-64175fb6851e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa245df50>]}
[0m19:30:43.957222 [info ] [Thread-3 (]: 2 of 7 OK created sql table model analytics.trade_by_declarant ................. [[32mSUCCESS 1[0m in 1.10s]
[0m19:30:43.958091 [debug] [Thread-3 (]: Finished running node model.citrus_trade.trade_by_declarant
[0m19:30:43.959403 [debug] [Thread-2 (]: Began running node model.citrus_trade.trade_by_hs
[0m19:30:43.959975 [info ] [Thread-2 (]: 3 of 7 START sql table model analytics.trade_by_hs ............................. [RUN]
[0m19:30:43.960533 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_TRHS_analytics, now model.citrus_trade.trade_by_hs)
[0m19:30:43.960892 [debug] [Thread-2 (]: Began compiling node model.citrus_trade.trade_by_hs
[0m19:30:43.965426 [debug] [Thread-2 (]: Writing injected SQL for node "model.citrus_trade.trade_by_hs"
[0m19:30:43.967538 [debug] [Thread-2 (]: Began executing node model.citrus_trade.trade_by_hs
[0m19:30:43.970186 [debug] [Thread-2 (]: Writing runtime sql for node "model.citrus_trade.trade_by_hs"
[0m19:30:43.971916 [debug] [Thread-2 (]: Using snowflake connection "model.citrus_trade.trade_by_hs"
[0m19:30:43.972296 [debug] [Thread-2 (]: On model.citrus_trade.trade_by_hs: create or replace transient table TRHS.analytics.trade_by_hs
    
    
    
    as (select
    *
from TRHS.analytics.trade_by_declarant
where hs6 = '080510'
    )

/* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.trade_by_hs"} */;
[0m19:30:44.621385 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.648 seconds
[0m19:30:44.631172 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c6ec735-acb7-4c90-9eb8-64175fb6851e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c734890>]}
[0m19:30:44.632489 [info ] [Thread-2 (]: 3 of 7 OK created sql table model analytics.trade_by_hs ........................ [[32mSUCCESS 1[0m in 0.67s]
[0m19:30:44.633115 [debug] [Thread-2 (]: Finished running node model.citrus_trade.trade_by_hs
[0m19:30:44.634278 [debug] [Thread-4 (]: Began running node model.citrus_trade.imports_by_year
[0m19:30:44.635051 [info ] [Thread-4 (]: 4 of 7 START sql table model analytics.imports_by_year ......................... [RUN]
[0m19:30:44.635989 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.citrus_trade.imports_by_year'
[0m19:30:44.636424 [debug] [Thread-4 (]: Began compiling node model.citrus_trade.imports_by_year
[0m19:30:44.634634 [debug] [Thread-3 (]: Began running node model.citrus_trade.imports_exports_2022
[0m19:30:44.642437 [info ] [Thread-3 (]: 5 of 7 START sql table model analytics.imports_exports_2022 .................... [RUN]
[0m19:30:44.642887 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.citrus_trade.trade_by_declarant, now model.citrus_trade.imports_exports_2022)
[0m19:30:44.643478 [debug] [Thread-3 (]: Began compiling node model.citrus_trade.imports_exports_2022
[0m19:30:44.645804 [debug] [Thread-3 (]: Writing injected SQL for node "model.citrus_trade.imports_exports_2022"
[0m19:30:44.641832 [debug] [Thread-4 (]: Writing injected SQL for node "model.citrus_trade.imports_by_year"
[0m19:30:44.647168 [debug] [Thread-3 (]: Began executing node model.citrus_trade.imports_exports_2022
[0m19:30:44.649230 [debug] [Thread-3 (]: Writing runtime sql for node "model.citrus_trade.imports_exports_2022"
[0m19:30:44.649525 [debug] [Thread-4 (]: Began executing node model.citrus_trade.imports_by_year
[0m19:30:44.652170 [debug] [Thread-4 (]: Writing runtime sql for node "model.citrus_trade.imports_by_year"
[0m19:30:44.653231 [debug] [Thread-3 (]: Using snowflake connection "model.citrus_trade.imports_exports_2022"
[0m19:30:44.653597 [debug] [Thread-3 (]: On model.citrus_trade.imports_exports_2022: create or replace transient table TRHS.analytics.imports_exports_2022
    
    
    
    as (select
    declarant_iso,
    flow,
    sum(value) over(partition by declarant_iso, flow) as total_value,
    sum(quantity) over(partition by declarant_iso, flow) as total_quantity,
    total_value/nullif(total_quantity,0) as value_per_quantity
from TRHS.analytics.trade_by_hs
group by 
    declarant_iso,
    flow,
    value,
    quantity
    )

/* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.imports_exports_2022"} */;
[0m19:30:44.654282 [debug] [Thread-4 (]: Using snowflake connection "model.citrus_trade.imports_by_year"
[0m19:30:44.656042 [debug] [Thread-4 (]: On model.citrus_trade.imports_by_year: create or replace transient table TRHS.analytics.imports_by_year
    
    
    
    as (select
    declarant_iso,
    year,
    sum(value) as total_value,
    sum(quantity) as total_quantity,
    total_value/nullif(total_quantity,0) as value_per_quantity
from TRHS.analytics.trade_by_hs
where flow = 1
group by 1,2
    )

/* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.imports_by_year"} */;
[0m19:30:44.656441 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m19:30:45.384884 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.730 seconds
[0m19:30:45.386516 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c6ec735-acb7-4c90-9eb8-64175fb6851e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c6b7110>]}
[0m19:30:45.387044 [info ] [Thread-3 (]: 5 of 7 OK created sql table model analytics.imports_exports_2022 ............... [[32mSUCCESS 1[0m in 0.74s]
[0m19:30:45.387481 [debug] [Thread-3 (]: Finished running node model.citrus_trade.imports_exports_2022
[0m19:30:45.388045 [debug] [Thread-2 (]: Began running node model.citrus_trade.score_2022
[0m19:30:45.388374 [info ] [Thread-2 (]: 6 of 7 START sql table model analytics.score_2022 .............................. [RUN]
[0m19:30:45.388755 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.citrus_trade.trade_by_hs, now model.citrus_trade.score_2022)
[0m19:30:45.389062 [debug] [Thread-2 (]: Began compiling node model.citrus_trade.score_2022
[0m19:30:45.391341 [debug] [Thread-2 (]: Writing injected SQL for node "model.citrus_trade.score_2022"
[0m19:30:45.392884 [debug] [Thread-2 (]: Began executing node model.citrus_trade.score_2022
[0m19:30:45.394630 [debug] [Thread-2 (]: Writing runtime sql for node "model.citrus_trade.score_2022"
[0m19:30:45.395843 [debug] [Thread-2 (]: Using snowflake connection "model.citrus_trade.score_2022"
[0m19:30:45.396131 [debug] [Thread-2 (]: On model.citrus_trade.score_2022: create or replace transient table TRHS.analytics.score_2022
    
    
    
    as (select distinct 
    declarant_iso,
    total_value,
    total_quantity,
    value_per_quantity,
    (total_value - min(total_value) over())/((max(total_value) over())-(min(total_value) over())) as score_value,
    (total_quantity - min(total_quantity) over())/((max(total_quantity) over())-(min(total_quantity) over())) as score_quantity,
    (value_per_quantity - min(value_per_quantity) over())/((max(value_per_quantity) over())-(min(value_per_quantity) over())) as score_price
from TRHS.analytics.imports_exports_2022
where flow = 1
    )

/* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.score_2022"} */;
[0m19:30:45.608325 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.951 seconds
[0m19:30:45.609911 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c6ec735-acb7-4c90-9eb8-64175fb6851e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c6b7c90>]}
[0m19:30:45.610353 [info ] [Thread-4 (]: 4 of 7 OK created sql table model analytics.imports_by_year .................... [[32mSUCCESS 1[0m in 0.97s]
[0m19:30:45.610792 [debug] [Thread-4 (]: Finished running node model.citrus_trade.imports_by_year
[0m19:30:45.611289 [debug] [Thread-3 (]: Began running node model.citrus_trade.growth_score
[0m19:30:45.611614 [info ] [Thread-3 (]: 7 of 7 START sql table model analytics.growth_score ............................ [RUN]
[0m19:30:45.611967 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.citrus_trade.imports_exports_2022, now model.citrus_trade.growth_score)
[0m19:30:45.612221 [debug] [Thread-3 (]: Began compiling node model.citrus_trade.growth_score
[0m19:30:45.614250 [debug] [Thread-3 (]: Writing injected SQL for node "model.citrus_trade.growth_score"
[0m19:30:45.615060 [debug] [Thread-3 (]: Began executing node model.citrus_trade.growth_score
[0m19:30:45.616686 [debug] [Thread-3 (]: Writing runtime sql for node "model.citrus_trade.growth_score"
[0m19:30:45.618955 [debug] [Thread-3 (]: Using snowflake connection "model.citrus_trade.growth_score"
[0m19:30:45.619281 [debug] [Thread-3 (]: On model.citrus_trade.growth_score: create or replace transient table TRHS.analytics.growth_score
    
    
    
    as (with 
    previous_year AS (
        select 
            declarant_iso,
            year,
            lag(total_value,1) over(partition by declarant_iso order by year) previous_year_value,
            total_value,
            first_value(total_value) over(partition by declarant_iso order by year) as first_year_value,
            last_value(total_value) over(partition by declarant_iso order by year) as last_year_value
        from TRHS.analytics.imports_by_year
    ),
    growth_speed AS (
        select 
            declarant_iso,
            year,
            first_year_value,
            last_year_value,
            last_year_value/nullif(first_year_value,0) as growth_overall,
            previous_year_value,
            total_value,
            (total_value - previous_year_value)/total_value * 100 as growth_speed 
        from previous_year
    ),
    previous_year_growth_speed AS (
        select 
            declarant_iso,
            year,
            first_year_value,
            last_year_value,
            growth_overall,
            previous_year_value,
            total_value as current_value,
            growth_speed,
            lag(growth_speed,1) over(partition by declarant_iso order by year) previous_year_growth_speed,
        from growth_speed
        order by 1,2
    ),
    base AS (
        select 
            declarant_iso,
            year,
            first_year_value,
            last_year_value,
            growth_overall,
            previous_year_value,
            current_value,
            previous_year_growth_speed,
            growth_speed,
            growth_speed - previous_year_growth_speed as growth_acceleration,
            avg(growth_acceleration) over(partition by declarant_iso) as avg_acceleration
        from previous_year_growth_speed
    ),
    ok as (
        select 
            declarant_iso,
            year,
            first_year_value,
            last_year_value,
            growth_overall,
            (growth_overall - min(growth_overall) OVER())/(max(growth_overall) OVER() - min(growth_overall) OVER()) as growth_overall_norm,
            previous_year_value,
            current_value,
            -- previous_year_growth_speed,
            growth_speed,
            growth_acceleration,
            avg_acceleration,
            (avg_acceleration - min(avg_acceleration) OVER())/(max(avg_acceleration) OVER() - min(avg_acceleration) OVER()) as avg_acceleration_norm
        from base 
    )
    select 
        declarant_iso,
        year,
        current_value,
        growth_speed,
        growth_acceleration,
        growth_overall,
        growth_overall_norm,
        avg_acceleration,
        avg_acceleration_norm,
        growth_overall_norm * avg_acceleration_norm as growth_score
    from ok
    )

/* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.growth_score"} */;
[0m19:30:46.101163 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.705 seconds
[0m19:30:46.102714 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c6ec735-acb7-4c90-9eb8-64175fb6851e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c578810>]}
[0m19:30:46.103886 [info ] [Thread-2 (]: 6 of 7 OK created sql table model analytics.score_2022 ......................... [[32mSUCCESS 1[0m in 0.71s]
[0m19:30:46.107178 [debug] [Thread-2 (]: Finished running node model.citrus_trade.score_2022
[0m19:30:46.408116 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.788 seconds
[0m19:30:46.409693 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c6ec735-acb7-4c90-9eb8-64175fb6851e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c573390>]}
[0m19:30:46.410225 [info ] [Thread-3 (]: 7 of 7 OK created sql table model analytics.growth_score ....................... [[32mSUCCESS 1[0m in 0.80s]
[0m19:30:46.410669 [debug] [Thread-3 (]: Finished running node model.citrus_trade.growth_score
[0m19:30:46.414757 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:30:46.415232 [debug] [MainThread]: Connection 'model.citrus_trade.stg_trade' was left open.
[0m19:30:46.415489 [debug] [MainThread]: On model.citrus_trade.stg_trade: Close
[0m19:30:46.522027 [debug] [MainThread]: Connection 'model.citrus_trade.score_2022' was left open.
[0m19:30:46.522483 [debug] [MainThread]: On model.citrus_trade.score_2022: Close
[0m19:30:46.628651 [debug] [MainThread]: Connection 'model.citrus_trade.growth_score' was left open.
[0m19:30:46.629079 [debug] [MainThread]: On model.citrus_trade.growth_score: Close
[0m19:30:46.725457 [debug] [MainThread]: Connection 'model.citrus_trade.imports_by_year' was left open.
[0m19:30:46.727088 [debug] [MainThread]: On model.citrus_trade.imports_by_year: Close
[0m19:30:46.850515 [info ] [MainThread]: 
[0m19:30:46.852182 [info ] [MainThread]: Finished running 7 table models in 0 hours 0 minutes and 6.82 seconds (6.82s).
[0m19:30:46.853214 [debug] [MainThread]: Command end result
[0m19:30:46.898975 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m19:30:46.902150 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m19:30:46.908320 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/target/run_results.json
[0m19:30:46.908625 [info ] [MainThread]: 
[0m19:30:46.909019 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:30:46.909410 [info ] [MainThread]: 
[0m19:30:46.909756 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=7
[0m19:30:46.912017 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.711951, "process_in_blocks": "7032", "process_kernel_time": 0.73162, "process_mem_max_rss": "157380", "process_out_blocks": "7879", "process_user_time": 2.273929}
[0m19:30:46.914199 [debug] [MainThread]: Command `dbt run` succeeded at 19:30:46.913439 after 7.71 seconds
[0m19:30:46.917197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9fb21e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4ab93d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4ab9250>]}
[0m19:30:46.918350 [debug] [MainThread]: Flushing usage events
[0m19:30:47.599153 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:30:49.129033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b0df510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b0dfa10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b0df4d0>]}


============================== 19:30:49.131270 | 03d5c186-cb36-4c3b-9325-3074b585bf20 ==============================
[0m19:30:49.131270 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m19:30:49.131741 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'profiles_dir': '/opt/airflow/dbt', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'empty': 'None', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'warn_error': 'None', 'cache_selected_only': 'False', 'introspect': 'True', 'printer_width': '80', 'use_colors': 'True', 'partial_parse': 'True', 'quiet': 'False', 'log_format': 'default', 'log_path': '/opt/airflow/dbt/logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'debug': 'False', 'invocation_command': 'dbt docs generate', 'version_check': 'True', 'static_parser': 'True', 'write_json': 'True'}
[0m19:30:49.286697 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m19:30:49.287197 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m19:30:49.287417 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m19:30:49.446369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '03d5c186-cb36-4c3b-9325-3074b585bf20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b0f4450>]}
[0m19:30:49.481264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '03d5c186-cb36-4c3b-9325-3074b585bf20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c0aa890>]}
[0m19:30:49.481988 [info ] [MainThread]: Registered adapter: snowflake=1.10.3
[0m19:30:49.545779 [debug] [MainThread]: checksum: 57e51233fb2305050a86c940b93938a4d3a51a7b95f45f76840a20ffa12695aa, vars: {}, profile: , target: , version: 1.11.0b4
[0m19:30:49.650389 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:30:49.650882 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:30:49.655192 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.citrus_trade.visualisation
[0m19:30:49.674183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '03d5c186-cb36-4c3b-9325-3074b585bf20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89753910>]}
[0m19:30:49.685266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '03d5c186-cb36-4c3b-9325-3074b585bf20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89708090>]}
[0m19:30:49.685678 [info ] [MainThread]: Found 7 models, 1 source, 636 macros
[0m19:30:49.686017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '03d5c186-cb36-4c3b-9325-3074b585bf20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89604050>]}
[0m19:30:49.687400 [info ] [MainThread]: 
[0m19:30:49.687809 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:30:49.688306 [info ] [MainThread]: 
[0m19:30:49.688724 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:30:49.691776 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRHS_staging'
[0m19:30:49.692324 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRHS_analytics'
[0m19:30:49.735495 [debug] [ThreadPool]: Using snowflake connection "list_TRHS_staging"
[0m19:30:49.735846 [debug] [ThreadPool]: Using snowflake connection "list_TRHS_analytics"
[0m19:30:49.736157 [debug] [ThreadPool]: On list_TRHS_staging: show objects in TRHS.staging
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS_staging"} */;
[0m19:30:49.736458 [debug] [ThreadPool]: On list_TRHS_analytics: show objects in TRHS.analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS_analytics"} */;
[0m19:30:49.736711 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:30:49.736978 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:30:50.146322 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.410 seconds
[0m19:30:50.184752 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 0.447 seconds
[0m19:30:50.194525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '03d5c186-cb36-4c3b-9325-3074b585bf20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff896b6010>]}
[0m19:30:50.204809 [debug] [Thread-1 (]: Began running node model.citrus_trade.stg_trade
[0m19:30:50.205597 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_TRHS_staging, now model.citrus_trade.stg_trade)
[0m19:30:50.205972 [debug] [Thread-1 (]: Began compiling node model.citrus_trade.stg_trade
[0m19:30:50.220350 [debug] [Thread-1 (]: Writing injected SQL for node "model.citrus_trade.stg_trade"
[0m19:30:50.222341 [debug] [Thread-1 (]: Began executing node model.citrus_trade.stg_trade
[0m19:30:50.223186 [debug] [Thread-1 (]: Finished running node model.citrus_trade.stg_trade
[0m19:30:50.224277 [debug] [Thread-3 (]: Began running node model.citrus_trade.trade_by_declarant
[0m19:30:50.224844 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.citrus_trade.trade_by_declarant'
[0m19:30:50.225402 [debug] [Thread-3 (]: Began compiling node model.citrus_trade.trade_by_declarant
[0m19:30:50.230919 [debug] [Thread-3 (]: Writing injected SQL for node "model.citrus_trade.trade_by_declarant"
[0m19:30:50.233391 [debug] [Thread-3 (]: Began executing node model.citrus_trade.trade_by_declarant
[0m19:30:50.235736 [debug] [Thread-3 (]: Finished running node model.citrus_trade.trade_by_declarant
[0m19:30:50.238328 [debug] [Thread-2 (]: Began running node model.citrus_trade.trade_by_hs
[0m19:30:50.239297 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_TRHS_analytics, now model.citrus_trade.trade_by_hs)
[0m19:30:50.240011 [debug] [Thread-2 (]: Began compiling node model.citrus_trade.trade_by_hs
[0m19:30:50.251401 [debug] [Thread-2 (]: Writing injected SQL for node "model.citrus_trade.trade_by_hs"
[0m19:30:50.268622 [debug] [Thread-2 (]: Began executing node model.citrus_trade.trade_by_hs
[0m19:30:50.272498 [debug] [Thread-2 (]: Finished running node model.citrus_trade.trade_by_hs
[0m19:30:50.277505 [debug] [Thread-4 (]: Began running node model.citrus_trade.imports_by_year
[0m19:30:50.278671 [debug] [Thread-3 (]: Began running node model.citrus_trade.imports_exports_2022
[0m19:30:50.281079 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.citrus_trade.imports_by_year'
[0m19:30:50.293449 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.citrus_trade.trade_by_declarant, now model.citrus_trade.imports_exports_2022)
[0m19:30:50.295844 [debug] [Thread-4 (]: Began compiling node model.citrus_trade.imports_by_year
[0m19:30:50.298841 [debug] [Thread-3 (]: Began compiling node model.citrus_trade.imports_exports_2022
[0m19:30:50.306137 [debug] [Thread-3 (]: Writing injected SQL for node "model.citrus_trade.imports_exports_2022"
[0m19:30:50.304102 [debug] [Thread-4 (]: Writing injected SQL for node "model.citrus_trade.imports_by_year"
[0m19:30:50.307201 [debug] [Thread-3 (]: Began executing node model.citrus_trade.imports_exports_2022
[0m19:30:50.307915 [debug] [Thread-3 (]: Finished running node model.citrus_trade.imports_exports_2022
[0m19:30:50.308117 [debug] [Thread-4 (]: Began executing node model.citrus_trade.imports_by_year
[0m19:30:50.308640 [debug] [Thread-2 (]: Began running node model.citrus_trade.score_2022
[0m19:30:50.309033 [debug] [Thread-4 (]: Finished running node model.citrus_trade.imports_by_year
[0m19:30:50.309338 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.citrus_trade.trade_by_hs, now model.citrus_trade.score_2022)
[0m19:30:50.309760 [debug] [Thread-3 (]: Began running node model.citrus_trade.growth_score
[0m19:30:50.309978 [debug] [Thread-2 (]: Began compiling node model.citrus_trade.score_2022
[0m19:30:50.310245 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.citrus_trade.imports_exports_2022, now model.citrus_trade.growth_score)
[0m19:30:50.312122 [debug] [Thread-2 (]: Writing injected SQL for node "model.citrus_trade.score_2022"
[0m19:30:50.312380 [debug] [Thread-3 (]: Began compiling node model.citrus_trade.growth_score
[0m19:30:50.315912 [debug] [Thread-3 (]: Writing injected SQL for node "model.citrus_trade.growth_score"
[0m19:30:50.316590 [debug] [Thread-2 (]: Began executing node model.citrus_trade.score_2022
[0m19:30:50.317168 [debug] [Thread-2 (]: Finished running node model.citrus_trade.score_2022
[0m19:30:50.317359 [debug] [Thread-3 (]: Began executing node model.citrus_trade.growth_score
[0m19:30:50.317881 [debug] [Thread-3 (]: Finished running node model.citrus_trade.growth_score
[0m19:30:50.319228 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:30:50.319618 [debug] [MainThread]: Connection 'model.citrus_trade.stg_trade' was left open.
[0m19:30:50.319892 [debug] [MainThread]: On model.citrus_trade.stg_trade: Close
[0m19:30:50.496329 [debug] [MainThread]: Connection 'model.citrus_trade.score_2022' was left open.
[0m19:30:50.496835 [debug] [MainThread]: On model.citrus_trade.score_2022: Close
[0m19:30:50.660330 [debug] [MainThread]: Connection 'model.citrus_trade.growth_score' was properly closed.
[0m19:30:50.660955 [debug] [MainThread]: Connection 'model.citrus_trade.imports_by_year' was properly closed.
[0m19:30:50.662090 [debug] [MainThread]: Command end result
[0m19:30:50.715808 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m19:30:50.720573 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m19:30:50.727347 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/target/run_results.json
[0m19:30:50.733587 [debug] [MainThread]: Acquiring new snowflake connection 'generate_catalog'
[0m19:30:50.733917 [info ] [MainThread]: Building catalog
[0m19:30:50.741895 [debug] [ThreadPool]: Acquiring new snowflake connection 'TRHS.information_schema'
[0m19:30:50.742783 [debug] [ThreadPool]: Acquiring new snowflake connection 'trhs.information_schema'
[0m19:30:50.759330 [debug] [ThreadPool]: Using snowflake connection "TRHS.information_schema"
[0m19:30:50.762217 [debug] [ThreadPool]: Using snowflake connection "trhs.information_schema"
[0m19:30:50.762752 [debug] [ThreadPool]: On TRHS.information_schema: with tables as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",
        case
            when is_dynamic = 'YES' and table_type = 'BASE TABLE' THEN 'DYNAMIC TABLE'
            else table_type
        end as "table_type",
        comment as "table_comment",

        -- note: this is the _role_ that owns the table
        table_owner as "table_owner",

        'Clustering Key' as "stats:clustering_key:label",
        clustering_key as "stats:clustering_key:value",
        'The key used to cluster this table' as "stats:clustering_key:description",
        (clustering_key is not null) as "stats:clustering_key:include",

        'Row Count' as "stats:row_count:label",
        row_count as "stats:row_count:value",
        'An approximate count of rows in this table' as "stats:row_count:description",
        (row_count is not null) as "stats:row_count:include",

        'Approximate Size' as "stats:bytes:label",
        bytes as "stats:bytes:value",
        'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
        (bytes is not null) as "stats:bytes:include",

        'Last Modified' as "stats:last_modified:label",
        to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
        'The timestamp for last update/change' as "stats:last_modified:description",
        (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"
    from TRHS.INFORMATION_SCHEMA.tables
            where (
                (
                    
    "table_schema" ilike 'analytics' and upper("table_schema") = upper('analytics')

                    and 
    "table_name" ilike 'imports_exports_2022' and upper("table_name") = upper('imports_exports_2022')

                )
             or 
                (
                    
    "table_schema" ilike 'analytics' and upper("table_schema") = upper('analytics')

                    and 
    "table_name" ilike 'growth_score' and upper("table_name") = upper('growth_score')

                )
             or 
                (
                    
    "table_schema" ilike 'staging' and upper("table_schema") = upper('staging')

                    and 
    "table_name" ilike 'stg_trade' and upper("table_name") = upper('stg_trade')

                )
             or 
                (
                    
    "table_schema" ilike 'analytics' and upper("table_schema") = upper('analytics')

                    and 
    "table_name" ilike 'trade_by_hs' and upper("table_name") = upper('trade_by_hs')

                )
             or 
                (
                    
    "table_schema" ilike 'analytics' and upper("table_schema") = upper('analytics')

                    and 
    "table_name" ilike 'imports_by_year' and upper("table_name") = upper('imports_by_year')

                )
             or 
                (
                    
    "table_schema" ilike 'analytics' and upper("table_schema") = upper('analytics')

                    and 
    "table_name" ilike 'score_2022' and upper("table_name") = upper('score_2022')

                )
             or 
                (
                    
    "table_schema" ilike 'analytics' and upper("table_schema") = upper('analytics')

                    and 
    "table_name" ilike 'trade_by_declarant' and upper("table_name") = upper('trade_by_declarant')

                )
            )
        ),
        columns as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",

        column_name as "column_name",
        ordinal_position as "column_index",
        data_type as "column_type",
        comment as "column_comment"
    from TRHS.INFORMATION_SCHEMA.columns
            where (
                (
                    
    "table_schema" ilike 'analytics' and upper("table_schema") = upper('analytics')

                    and 
    "table_name" ilike 'imports_exports_2022' and upper("table_name") = upper('imports_exports_2022')

                )
             or 
                (
                    
    "table_schema" ilike 'analytics' and upper("table_schema") = upper('analytics')

                    and 
    "table_name" ilike 'growth_score' and upper("table_name") = upper('growth_score')

                )
             or 
                (
                    
    "table_schema" ilike 'staging' and upper("table_schema") = upper('staging')

                    and 
    "table_name" ilike 'stg_trade' and upper("table_name") = upper('stg_trade')

                )
             or 
                (
                    
    "table_schema" ilike 'analytics' and upper("table_schema") = upper('analytics')

                    and 
    "table_name" ilike 'trade_by_hs' and upper("table_name") = upper('trade_by_hs')

                )
             or 
                (
                    
    "table_schema" ilike 'analytics' and upper("table_schema") = upper('analytics')

                    and 
    "table_name" ilike 'imports_by_year' and upper("table_name") = upper('imports_by_year')

                )
             or 
                (
                    
    "table_schema" ilike 'analytics' and upper("table_schema") = upper('analytics')

                    and 
    "table_name" ilike 'score_2022' and upper("table_name") = upper('score_2022')

                )
             or 
                (
                    
    "table_schema" ilike 'analytics' and upper("table_schema") = upper('analytics')

                    and 
    "table_name" ilike 'trade_by_declarant' and upper("table_name") = upper('trade_by_declarant')

                )
            )
        )
        select *
    from tables
    join columns using ("table_database", "table_schema", "table_name")
    order by "column_index"
/* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "TRHS.information_schema"} */
[0m19:30:50.763286 [debug] [ThreadPool]: On trhs.information_schema: with tables as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",
        case
            when is_dynamic = 'YES' and table_type = 'BASE TABLE' THEN 'DYNAMIC TABLE'
            else table_type
        end as "table_type",
        comment as "table_comment",

        -- note: this is the _role_ that owns the table
        table_owner as "table_owner",

        'Clustering Key' as "stats:clustering_key:label",
        clustering_key as "stats:clustering_key:value",
        'The key used to cluster this table' as "stats:clustering_key:description",
        (clustering_key is not null) as "stats:clustering_key:include",

        'Row Count' as "stats:row_count:label",
        row_count as "stats:row_count:value",
        'An approximate count of rows in this table' as "stats:row_count:description",
        (row_count is not null) as "stats:row_count:include",

        'Approximate Size' as "stats:bytes:label",
        bytes as "stats:bytes:value",
        'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
        (bytes is not null) as "stats:bytes:include",

        'Last Modified' as "stats:last_modified:label",
        to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
        'The timestamp for last update/change' as "stats:last_modified:description",
        (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"
    from trhs.INFORMATION_SCHEMA.tables
            where (
                (
                    
    "table_schema" ilike 'staging' and upper("table_schema") = upper('staging')

                    and 
    "table_name" ilike 'citrus_ext' and upper("table_name") = upper('citrus_ext')

                )
            )
        ),
        columns as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",

        column_name as "column_name",
        ordinal_position as "column_index",
        data_type as "column_type",
        comment as "column_comment"
    from trhs.INFORMATION_SCHEMA.columns
            where (
                (
                    
    "table_schema" ilike 'staging' and upper("table_schema") = upper('staging')

                    and 
    "table_name" ilike 'citrus_ext' and upper("table_name") = upper('citrus_ext')

                )
            )
        )
        select *
    from tables
    join columns using ("table_database", "table_schema", "table_name")
    order by "column_index"
/* {"app": "dbt", "dbt_version": "1.11.0b4", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "trhs.information_schema"} */
[0m19:30:50.763658 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:30:50.763986 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:30:52.766285 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 2.001 seconds
[0m19:30:54.391977 [debug] [ThreadPool]: SQL status: SUCCESS 64 in 3.628 seconds
[0m19:30:54.448313 [debug] [MainThread]: Wrote artifact CatalogArtifact to /opt/airflow/dbt/target/catalog.json
[0m19:30:54.587425 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m19:30:54.595602 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m19:30:54.598375 [info ] [MainThread]: Catalog written to /opt/airflow/dbt/target/catalog.json
[0m19:30:54.605786 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 5.5058465, "process_in_blocks": "3400", "process_kernel_time": 0.361706, "process_mem_max_rss": "153208", "process_out_blocks": "6207", "process_user_time": 1.933853}
[0m19:30:54.607910 [debug] [MainThread]: Command `dbt docs generate` succeeded at 19:30:54.607651 after 5.51 seconds
[0m19:30:54.611952 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m19:30:54.613423 [debug] [MainThread]: Connection 'TRHS.information_schema' was left open.
[0m19:30:54.625725 [debug] [MainThread]: On TRHS.information_schema: Close
[0m19:30:54.781749 [debug] [MainThread]: Connection 'trhs.information_schema' was left open.
[0m19:30:54.785056 [debug] [MainThread]: On trhs.information_schema: Close
[0m19:30:54.991658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b14c1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b1430d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88060f10>]}
[0m19:30:54.996685 [debug] [MainThread]: Flushing usage events
[0m19:30:55.944640 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:31:00.294942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a5e0250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a5e35d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a5e0d90>]}


============================== 19:31:00.306051 | 9a880441-1f25-4ec6-bb1a-df933f3bf391 ==============================
[0m19:31:00.306051 [info ] [MainThread]: Running with dbt=1.11.0-b4
[0m19:31:00.309537 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'indirect_selection': 'eager', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'write_json': 'True', 'invocation_command': 'dbt docs serve --port 5050 --host 0.0.0.0', 'use_colors': 'True', 'version_check': 'True', 'empty': 'None', 'static_parser': 'True', 'partial_parse': 'True', 'target_path': 'None', 'log_path': '/opt/airflow/dbt/logs', 'log_cache_events': 'False', 'fail_fast': 'False', 'introspect': 'True', 'use_experimental_parser': 'False', 'warn_error': 'None', 'log_format': 'default', 'debug': 'False'}
[0m19:31:00.741444 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m19:31:00.768136 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m19:31:00.770450 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m19:31:01.465129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9a880441-1f25-4ec6-bb1a-df933f3bf391', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff890fd510>]}
[0m19:31:01.645497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9a880441-1f25-4ec6-bb1a-df933f3bf391', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b5a2b10>]}
[0m20:07:21.708135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90c58710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92881c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9017ec30>]}


============================== 20:07:21.714986 | c69a19a2-58e1-4e41-b6b5-251d14be502d ==============================
[0m20:07:21.714986 [info ] [MainThread]: Running with dbt=1.10.13
[0m20:07:21.715378 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'printer_width': '80', 'quiet': 'False', 'static_parser': 'True', 'log_path': '/opt/airflow/dbt/logs', 'cache_selected_only': 'False', 'partial_parse': 'True', 'empty': 'False', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'use_experimental_parser': 'False', 'invocation_command': 'dbt run', 'debug': 'False', 'use_colors': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'warn_error': 'None', 'target_path': 'None', 'profiles_dir': '/opt/airflow/dbt', 'write_json': 'True'}
[0m20:07:22.044583 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m20:07:22.045044 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m20:07:22.045239 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m20:07:22.156530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c69a19a2-58e1-4e41-b6b5-251d14be502d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e5a5d00>]}
[0m20:07:22.188157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c69a19a2-58e1-4e41-b6b5-251d14be502d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e7af1a0>]}
[0m20:07:22.188847 [info ] [MainThread]: Registered adapter: snowflake=1.10.3
[0m20:07:22.251363 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m20:07:22.303271 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m20:07:22.303733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c69a19a2-58e1-4e41-b6b5-251d14be502d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e5eeff0>]}
[0m20:07:23.067841 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.citrus_trade.stg_trade' (models/staging/stg_trade.sql) depends on a source named 'citrus_trade.citrus_ext' which was not found
[0m20:07:23.069869 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.392783, "process_in_blocks": "57296", "process_kernel_time": 0.86223, "process_mem_max_rss": "134140", "process_out_blocks": "3317", "process_user_time": 2.067755}
[0m20:07:23.070207 [debug] [MainThread]: Command `dbt run` failed at 20:07:23.070150 after 1.39 seconds
[0m20:07:23.070443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90ae3260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e0c8f80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91979d60>]}
[0m20:07:23.070662 [debug] [MainThread]: Flushing usage events
[0m20:07:23.627421 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:08:06.026566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ea79e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ceda270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d5e49e0>]}


============================== 20:08:06.030568 | 6e405294-df30-48ab-999b-1de32c619cdc ==============================
[0m20:08:06.030568 [info ] [MainThread]: Running with dbt=1.10.13
[0m20:08:06.030953 [debug] [MainThread]: running dbt with arguments {'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'introspect': 'True', 'use_colors': 'True', 'no_print': 'None', 'profiles_dir': '/opt/airflow/dbt', 'log_format': 'default', 'quiet': 'False', 'printer_width': '80', 'version_check': 'True', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'static_parser': 'True', 'fail_fast': 'False', 'empty': 'False', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'target_path': 'None', 'debug': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True', 'invocation_command': 'dbt run', 'log_cache_events': 'False'}
[0m20:08:06.176675 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m20:08:06.177093 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m20:08:06.177395 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m20:08:06.275324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6e405294-df30-48ab-999b-1de32c619cdc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b29a5a0>]}
[0m20:08:06.307058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6e405294-df30-48ab-999b-1de32c619cdc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b29a930>]}
[0m20:08:06.307628 [info ] [MainThread]: Registered adapter: snowflake=1.10.3
[0m20:08:06.357734 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m20:08:06.441146 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m20:08:06.441564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '6e405294-df30-48ab-999b-1de32c619cdc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7cea6fc0>]}
[0m20:08:07.128021 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.citrus_trade.visualisation
[0m20:08:07.133182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6e405294-df30-48ab-999b-1de32c619cdc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7a744e00>]}
[0m20:08:07.176494 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m20:08:07.178570 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m20:08:07.211859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6e405294-df30-48ab-999b-1de32c619cdc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7a7afc20>]}
[0m20:08:07.212150 [info ] [MainThread]: Found 7 models, 1 source, 636 macros
[0m20:08:07.212357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6e405294-df30-48ab-999b-1de32c619cdc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7a744ce0>]}
[0m20:08:07.213407 [info ] [MainThread]: 
[0m20:08:07.213636 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:08:07.213847 [info ] [MainThread]: 
[0m20:08:07.214214 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:08:07.217121 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRHS'
[0m20:08:07.223766 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRHS'
[0m20:08:07.311703 [debug] [ThreadPool]: Using snowflake connection "list_TRHS"
[0m20:08:07.312091 [debug] [ThreadPool]: Using snowflake connection "list_TRHS"
[0m20:08:07.312265 [debug] [ThreadPool]: On list_TRHS: show terse schemas in database TRHS
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS"} */
[0m20:08:07.312499 [debug] [ThreadPool]: On list_TRHS: show terse schemas in database TRHS
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS"} */
[0m20:08:07.312684 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:08:07.312887 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:08:08.581066 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.268 seconds
[0m20:08:08.627874 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.315 seconds
[0m20:08:08.630016 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRHS, now list_TRHS_staging)
[0m20:08:08.636551 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRHS, now list_TRHS_analytics)
[0m20:08:08.639398 [debug] [ThreadPool]: Using snowflake connection "list_TRHS_staging"
[0m20:08:08.640722 [debug] [ThreadPool]: Using snowflake connection "list_TRHS_analytics"
[0m20:08:08.640958 [debug] [ThreadPool]: On list_TRHS_staging: show objects in TRHS.staging
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS_staging"} */;
[0m20:08:08.641173 [debug] [ThreadPool]: On list_TRHS_analytics: show objects in TRHS.analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS_analytics"} */;
[0m20:08:08.725150 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 0.083 seconds
[0m20:08:08.725824 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.084 seconds
[0m20:08:08.730482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6e405294-df30-48ab-999b-1de32c619cdc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ab9e1e0>]}
[0m20:08:08.741064 [debug] [Thread-1 (]: Began running node model.citrus_trade.stg_trade
[0m20:08:08.741496 [info ] [Thread-1 (]: 1 of 7 START sql table model staging.stg_trade ................................. [RUN]
[0m20:08:08.741887 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_TRHS_staging, now model.citrus_trade.stg_trade)
[0m20:08:08.742199 [debug] [Thread-1 (]: Began compiling node model.citrus_trade.stg_trade
[0m20:08:08.747388 [debug] [Thread-1 (]: Writing injected SQL for node "model.citrus_trade.stg_trade"
[0m20:08:08.748552 [debug] [Thread-1 (]: Began executing node model.citrus_trade.stg_trade
[0m20:08:08.767312 [debug] [Thread-1 (]: Writing runtime sql for node "model.citrus_trade.stg_trade"
[0m20:08:08.769320 [debug] [Thread-1 (]: Using snowflake connection "model.citrus_trade.stg_trade"
[0m20:08:08.769601 [debug] [Thread-1 (]: On model.citrus_trade.stg_trade: create or replace transient table TRHS.staging.stg_trade
    
    
    
    as (select
  value:DECLARANT::int as declarant,
  value:DECLARANT_ISO::string as declarant_iso,
  value:PARTNER::string as partner,
  value:PARTNER_ISO::string as partner_iso,
  value:FLOW::int as flow,
  value:TRANSPORT_MODE::int as transport_mode,
  value:PERIOD::int as period,
  value:HS4::string as hs4,
  value:HS4_NAME::string as hs4_name,
  value:HS6::string as hs6,
  value:HS6_NAME::string as hs6_name,
  value:VALUE_IN_EUROS::float as value_in_euros,
  value:QUANTITY_IN_KG::float as quantity_in_kg
from trhs.staging.citrus_trade_ext
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.stg_trade"} */;
[0m20:08:09.576967 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.807 seconds
[0m20:08:09.612244 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6e405294-df30-48ab-999b-1de32c619cdc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7efb5bb0>]}
[0m20:08:09.613119 [info ] [Thread-1 (]: 1 of 7 OK created sql table model staging.stg_trade ............................ [[32mSUCCESS 1[0m in 0.87s]
[0m20:08:09.614038 [debug] [Thread-1 (]: Finished running node model.citrus_trade.stg_trade
[0m20:08:09.615131 [debug] [Thread-3 (]: Began running node model.citrus_trade.trade_by_declarant
[0m20:08:09.615655 [info ] [Thread-3 (]: 2 of 7 START sql table model analytics.trade_by_declarant ...................... [RUN]
[0m20:08:09.616327 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.citrus_trade.trade_by_declarant'
[0m20:08:09.616706 [debug] [Thread-3 (]: Began compiling node model.citrus_trade.trade_by_declarant
[0m20:08:09.620415 [debug] [Thread-3 (]: Writing injected SQL for node "model.citrus_trade.trade_by_declarant"
[0m20:08:09.622135 [debug] [Thread-3 (]: Began executing node model.citrus_trade.trade_by_declarant
[0m20:08:09.625180 [debug] [Thread-3 (]: Writing runtime sql for node "model.citrus_trade.trade_by_declarant"
[0m20:08:09.627164 [debug] [Thread-3 (]: Using snowflake connection "model.citrus_trade.trade_by_declarant"
[0m20:08:09.627626 [debug] [Thread-3 (]: On model.citrus_trade.trade_by_declarant: create or replace transient table TRHS.analytics.trade_by_declarant
    
    
    
    as (select 
    declarant,
    declarant_iso,
    partner,
    partner_iso,
    flow,
    transport_mode,
    year(to_date(left(period,4),'YYYY')) as year,
    period,
    hs6,
    hs6_name,
    sum(value_in_euros) as value,
    sum(quantity_in_kg) as quantity
from TRHS.staging.stg_trade
group by 1,2,3,4,5,6,7,8,9,10
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.trade_by_declarant"} */;
[0m20:08:09.627906 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m20:08:10.555058 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.927 seconds
[0m20:08:10.556614 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6e405294-df30-48ab-999b-1de32c619cdc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ad46840>]}
[0m20:08:10.557032 [info ] [Thread-3 (]: 2 of 7 OK created sql table model analytics.trade_by_declarant ................. [[32mSUCCESS 1[0m in 0.94s]
[0m20:08:10.557560 [debug] [Thread-3 (]: Finished running node model.citrus_trade.trade_by_declarant
[0m20:08:10.558138 [debug] [Thread-2 (]: Began running node model.citrus_trade.trade_by_hs
[0m20:08:10.558586 [info ] [Thread-2 (]: 3 of 7 START sql table model analytics.trade_by_hs ............................. [RUN]
[0m20:08:10.559034 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_TRHS_analytics, now model.citrus_trade.trade_by_hs)
[0m20:08:10.559273 [debug] [Thread-2 (]: Began compiling node model.citrus_trade.trade_by_hs
[0m20:08:10.561348 [debug] [Thread-2 (]: Writing injected SQL for node "model.citrus_trade.trade_by_hs"
[0m20:08:10.562202 [debug] [Thread-2 (]: Began executing node model.citrus_trade.trade_by_hs
[0m20:08:10.565084 [debug] [Thread-2 (]: Writing runtime sql for node "model.citrus_trade.trade_by_hs"
[0m20:08:10.566005 [debug] [Thread-2 (]: Using snowflake connection "model.citrus_trade.trade_by_hs"
[0m20:08:10.566217 [debug] [Thread-2 (]: On model.citrus_trade.trade_by_hs: create or replace transient table TRHS.analytics.trade_by_hs
    
    
    
    as (select
    *
from TRHS.analytics.trade_by_declarant
where hs6 = '080510'
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.trade_by_hs"} */;
[0m20:08:11.271756 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.705 seconds
[0m20:08:11.276350 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6e405294-df30-48ab-999b-1de32c619cdc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff78f626c0>]}
[0m20:08:11.276742 [info ] [Thread-2 (]: 3 of 7 OK created sql table model analytics.trade_by_hs ........................ [[32mSUCCESS 1[0m in 0.72s]
[0m20:08:11.277212 [debug] [Thread-2 (]: Finished running node model.citrus_trade.trade_by_hs
[0m20:08:11.277884 [debug] [Thread-4 (]: Began running node model.citrus_trade.imports_by_year
[0m20:08:11.278136 [debug] [Thread-3 (]: Began running node model.citrus_trade.imports_exports_2022
[0m20:08:11.278411 [info ] [Thread-4 (]: 4 of 7 START sql table model analytics.imports_by_year ......................... [RUN]
[0m20:08:11.278756 [info ] [Thread-3 (]: 5 of 7 START sql table model analytics.imports_exports_2022 .................... [RUN]
[0m20:08:11.279134 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.citrus_trade.imports_by_year'
[0m20:08:11.279421 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.citrus_trade.trade_by_declarant, now model.citrus_trade.imports_exports_2022)
[0m20:08:11.279661 [debug] [Thread-4 (]: Began compiling node model.citrus_trade.imports_by_year
[0m20:08:11.279984 [debug] [Thread-3 (]: Began compiling node model.citrus_trade.imports_exports_2022
[0m20:08:11.281909 [debug] [Thread-4 (]: Writing injected SQL for node "model.citrus_trade.imports_by_year"
[0m20:08:11.283520 [debug] [Thread-3 (]: Writing injected SQL for node "model.citrus_trade.imports_exports_2022"
[0m20:08:11.285229 [debug] [Thread-4 (]: Began executing node model.citrus_trade.imports_by_year
[0m20:08:11.287140 [debug] [Thread-4 (]: Writing runtime sql for node "model.citrus_trade.imports_by_year"
[0m20:08:11.287375 [debug] [Thread-3 (]: Began executing node model.citrus_trade.imports_exports_2022
[0m20:08:11.288966 [debug] [Thread-3 (]: Writing runtime sql for node "model.citrus_trade.imports_exports_2022"
[0m20:08:11.289859 [debug] [Thread-4 (]: Using snowflake connection "model.citrus_trade.imports_by_year"
[0m20:08:11.290152 [debug] [Thread-4 (]: On model.citrus_trade.imports_by_year: create or replace transient table TRHS.analytics.imports_by_year
    
    
    
    as (select
    declarant_iso,
    year,
    sum(value) as total_value,
    sum(quantity) as total_quantity,
    total_value/nullif(total_quantity,0) as value_per_quantity
from TRHS.analytics.trade_by_hs
where flow = 1
group by 1,2
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.imports_by_year"} */;
[0m20:08:11.290407 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m20:08:11.290864 [debug] [Thread-3 (]: Using snowflake connection "model.citrus_trade.imports_exports_2022"
[0m20:08:11.293687 [debug] [Thread-3 (]: On model.citrus_trade.imports_exports_2022: create or replace transient table TRHS.analytics.imports_exports_2022
    
    
    
    as (select
    declarant_iso,
    flow,
    sum(value) over(partition by declarant_iso, flow) as total_value,
    sum(quantity) over(partition by declarant_iso, flow) as total_quantity,
    total_value/nullif(total_quantity,0) as value_per_quantity
from TRHS.analytics.trade_by_hs
group by 
    declarant_iso,
    flow,
    value,
    quantity
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.imports_exports_2022"} */;
[0m20:08:12.086722 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.792 seconds
[0m20:08:12.093498 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6e405294-df30-48ab-999b-1de32c619cdc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ad36db0>]}
[0m20:08:12.094473 [info ] [Thread-3 (]: 5 of 7 OK created sql table model analytics.imports_exports_2022 ............... [[32mSUCCESS 1[0m in 0.81s]
[0m20:08:12.095140 [debug] [Thread-3 (]: Finished running node model.citrus_trade.imports_exports_2022
[0m20:08:12.095955 [debug] [Thread-2 (]: Began running node model.citrus_trade.score_2022
[0m20:08:12.096224 [info ] [Thread-2 (]: 6 of 7 START sql table model analytics.score_2022 .............................. [RUN]
[0m20:08:12.096645 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.citrus_trade.trade_by_hs, now model.citrus_trade.score_2022)
[0m20:08:12.096868 [debug] [Thread-2 (]: Began compiling node model.citrus_trade.score_2022
[0m20:08:12.102317 [debug] [Thread-2 (]: Writing injected SQL for node "model.citrus_trade.score_2022"
[0m20:08:12.103365 [debug] [Thread-2 (]: Began executing node model.citrus_trade.score_2022
[0m20:08:12.105834 [debug] [Thread-2 (]: Writing runtime sql for node "model.citrus_trade.score_2022"
[0m20:08:12.107142 [debug] [Thread-2 (]: Using snowflake connection "model.citrus_trade.score_2022"
[0m20:08:12.107440 [debug] [Thread-2 (]: On model.citrus_trade.score_2022: create or replace transient table TRHS.analytics.score_2022
    
    
    
    as (select distinct 
    declarant_iso,
    total_value,
    total_quantity,
    value_per_quantity,
    (total_value - min(total_value) over())/((max(total_value) over())-(min(total_value) over())) as score_value,
    (total_quantity - min(total_quantity) over())/((max(total_quantity) over())-(min(total_quantity) over())) as score_quantity,
    (value_per_quantity - min(value_per_quantity) over())/((max(value_per_quantity) over())-(min(value_per_quantity) over())) as score_price
from TRHS.analytics.imports_exports_2022
where flow = 1
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.score_2022"} */;
[0m20:08:12.110564 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.820 seconds
[0m20:08:12.111906 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6e405294-df30-48ab-999b-1de32c619cdc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff78f62c60>]}
[0m20:08:12.112348 [info ] [Thread-4 (]: 4 of 7 OK created sql table model analytics.imports_by_year .................... [[32mSUCCESS 1[0m in 0.83s]
[0m20:08:12.112681 [debug] [Thread-4 (]: Finished running node model.citrus_trade.imports_by_year
[0m20:08:12.113138 [debug] [Thread-3 (]: Began running node model.citrus_trade.growth_score
[0m20:08:12.113418 [info ] [Thread-3 (]: 7 of 7 START sql table model analytics.growth_score ............................ [RUN]
[0m20:08:12.113753 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.citrus_trade.imports_exports_2022, now model.citrus_trade.growth_score)
[0m20:08:12.114037 [debug] [Thread-3 (]: Began compiling node model.citrus_trade.growth_score
[0m20:08:12.116564 [debug] [Thread-3 (]: Writing injected SQL for node "model.citrus_trade.growth_score"
[0m20:08:12.118273 [debug] [Thread-3 (]: Began executing node model.citrus_trade.growth_score
[0m20:08:12.122810 [debug] [Thread-3 (]: Writing runtime sql for node "model.citrus_trade.growth_score"
[0m20:08:12.125737 [debug] [Thread-3 (]: Using snowflake connection "model.citrus_trade.growth_score"
[0m20:08:12.126177 [debug] [Thread-3 (]: On model.citrus_trade.growth_score: create or replace transient table TRHS.analytics.growth_score
    
    
    
    as (with 
    previous_year AS (
        select 
            declarant_iso,
            year,
            lag(total_value,1) over(partition by declarant_iso order by year) previous_year_value,
            total_value,
            first_value(total_value) over(partition by declarant_iso order by year) as first_year_value,
            last_value(total_value) over(partition by declarant_iso order by year) as last_year_value
        from TRHS.analytics.imports_by_year
    ),
    growth_speed AS (
        select 
            declarant_iso,
            year,
            first_year_value,
            last_year_value,
            last_year_value/nullif(first_year_value,0) as growth_overall,
            previous_year_value,
            total_value,
            (total_value - previous_year_value)/total_value * 100 as growth_speed 
        from previous_year
    ),
    previous_year_growth_speed AS (
        select 
            declarant_iso,
            year,
            first_year_value,
            last_year_value,
            growth_overall,
            previous_year_value,
            total_value as current_value,
            growth_speed,
            lag(growth_speed,1) over(partition by declarant_iso order by year) previous_year_growth_speed,
        from growth_speed
        order by 1,2
    ),
    base AS (
        select 
            declarant_iso,
            year,
            first_year_value,
            last_year_value,
            growth_overall,
            previous_year_value,
            current_value,
            previous_year_growth_speed,
            growth_speed,
            growth_speed - previous_year_growth_speed as growth_acceleration,
            avg(growth_acceleration) over(partition by declarant_iso) as avg_acceleration
        from previous_year_growth_speed
    ),
    ok as (
        select 
            declarant_iso,
            year,
            first_year_value,
            last_year_value,
            growth_overall,
            (growth_overall - min(growth_overall) OVER())/(max(growth_overall) OVER() - min(growth_overall) OVER()) as growth_overall_norm,
            previous_year_value,
            current_value,
            -- previous_year_growth_speed,
            growth_speed,
            growth_acceleration,
            avg_acceleration,
            (avg_acceleration - min(avg_acceleration) OVER())/(max(avg_acceleration) OVER() - min(avg_acceleration) OVER()) as avg_acceleration_norm
        from base 
    )
    select 
        declarant_iso,
        year,
        current_value,
        growth_speed,
        growth_acceleration,
        growth_overall,
        growth_overall_norm,
        avg_acceleration,
        avg_acceleration_norm,
        growth_overall_norm * avg_acceleration_norm as growth_score
    from ok
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.growth_score"} */;
[0m20:08:12.733829 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.626 seconds
[0m20:08:12.737204 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6e405294-df30-48ab-999b-1de32c619cdc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ad88260>]}
[0m20:08:12.737914 [info ] [Thread-2 (]: 6 of 7 OK created sql table model analytics.score_2022 ......................... [[32mSUCCESS 1[0m in 0.64s]
[0m20:08:12.738480 [debug] [Thread-2 (]: Finished running node model.citrus_trade.score_2022
[0m20:08:12.842632 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.716 seconds
[0m20:08:12.844350 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6e405294-df30-48ab-999b-1de32c619cdc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff78fe3a40>]}
[0m20:08:12.845061 [info ] [Thread-3 (]: 7 of 7 OK created sql table model analytics.growth_score ....................... [[32mSUCCESS 1[0m in 0.73s]
[0m20:08:12.845589 [debug] [Thread-3 (]: Finished running node model.citrus_trade.growth_score
[0m20:08:12.849384 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:08:12.849921 [debug] [MainThread]: Connection 'model.citrus_trade.score_2022' was left open.
[0m20:08:12.850559 [debug] [MainThread]: On model.citrus_trade.score_2022: Close
[0m20:08:12.926563 [debug] [MainThread]: Connection 'model.citrus_trade.stg_trade' was left open.
[0m20:08:12.927047 [debug] [MainThread]: On model.citrus_trade.stg_trade: Close
[0m20:08:13.020145 [debug] [MainThread]: Connection 'model.citrus_trade.growth_score' was left open.
[0m20:08:13.020536 [debug] [MainThread]: On model.citrus_trade.growth_score: Close
[0m20:08:13.127079 [debug] [MainThread]: Connection 'model.citrus_trade.imports_by_year' was left open.
[0m20:08:13.127526 [debug] [MainThread]: On model.citrus_trade.imports_by_year: Close
[0m20:08:13.206613 [info ] [MainThread]: 
[0m20:08:13.207041 [info ] [MainThread]: Finished running 7 table models in 0 hours 0 minutes and 5.99 seconds (5.99s).
[0m20:08:13.208371 [debug] [MainThread]: Command end result
[0m20:08:13.237349 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m20:08:13.239901 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m20:08:13.245372 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/target/run_results.json
[0m20:08:13.245640 [info ] [MainThread]: 
[0m20:08:13.246027 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:08:13.246459 [info ] [MainThread]: 
[0m20:08:13.246796 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=7
[0m20:08:13.248293 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.259966, "process_in_blocks": "3880", "process_kernel_time": 0.72737, "process_mem_max_rss": "157864", "process_out_blocks": "9350", "process_user_time": 2.651935}
[0m20:08:13.248878 [debug] [MainThread]: Command `dbt run` succeeded at 20:08:13.248792 after 7.26 seconds
[0m20:08:13.249296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d5e49e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ab25490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ea79e20>]}
[0m20:08:13.249718 [debug] [MainThread]: Flushing usage events
[0m20:08:13.815660 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:57:50.827666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e061190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7cbd65d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7cbd6930>]}


============================== 03:57:50.832563 | 0e70e9f5-3923-4d90-a238-58bba828b9f8 ==============================
[0m03:57:50.832563 [info ] [MainThread]: Running with dbt=1.10.13
[0m03:57:50.833180 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'log_format': 'default', 'printer_width': '80', 'cache_selected_only': 'False', 'quiet': 'False', 'no_print': 'None', 'fail_fast': 'False', 'version_check': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'debug': 'False', 'empty': 'False', 'use_experimental_parser': 'False', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/opt/airflow/dbt', 'static_parser': 'True', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'warn_error': 'None', 'log_cache_events': 'False', 'introspect': 'True', 'partial_parse': 'True', 'invocation_command': 'dbt run'}
[0m03:57:51.020535 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m03:57:51.021045 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m03:57:51.021251 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m03:57:51.124618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0e70e9f5-3923-4d90-a238-58bba828b9f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b170980>]}
[0m03:57:51.155696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0e70e9f5-3923-4d90-a238-58bba828b9f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c6df0e0>]}
[0m03:57:51.156171 [info ] [MainThread]: Registered adapter: snowflake=1.10.3
[0m03:57:51.211396 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m03:57:51.341118 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m03:57:51.341865 [debug] [MainThread]: Partial parsing: updated file: citrus_trade://models/staging/_src_citrus_trade.yml
[0m03:57:51.505320 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.citrus_trade.stg_trade' (models/staging/stg_trade.sql) depends on a source named 'citrus_trade.citrus_trade_ext' which was not found
[0m03:57:51.507438 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.7111921, "process_in_blocks": "53688", "process_kernel_time": 0.459786, "process_mem_max_rss": "133252", "process_out_blocks": "5", "process_user_time": 1.32503}
[0m03:57:51.507757 [debug] [MainThread]: Command `dbt run` failed at 03:57:51.507683 after 0.71 seconds
[0m03:57:51.508064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d1adbe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7addf740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7a88b440>]}
[0m03:57:51.508311 [debug] [MainThread]: Flushing usage events
[0m03:57:52.061104 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:58:06.181882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8993650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa82d1fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8993530>]}


============================== 03:58:06.185009 | 864ce09a-ee38-48a2-b6e8-8192e358b8dd ==============================
[0m03:58:06.185009 [info ] [MainThread]: Running with dbt=1.10.13
[0m03:58:06.185464 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/opt/airflow/dbt', 'static_parser': 'True', 'warn_error': 'None', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'cache_selected_only': 'False', 'target_path': 'None', 'use_colors': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'introspect': 'True', 'version_check': 'True', 'no_print': 'None', 'quiet': 'False', 'fail_fast': 'False', 'partial_parse': 'True', 'empty': 'False', 'indirect_selection': 'eager', 'printer_width': '80'}
[0m03:58:06.317922 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m03:58:06.318818 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m03:58:06.319290 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m03:58:06.441745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '864ce09a-ee38-48a2-b6e8-8192e358b8dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6c2bdd0>]}
[0m03:58:06.472959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '864ce09a-ee38-48a2-b6e8-8192e358b8dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7192060>]}
[0m03:58:06.473405 [info ] [MainThread]: Registered adapter: snowflake=1.10.3
[0m03:58:06.520483 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m03:58:06.641822 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m03:58:06.642517 [debug] [MainThread]: Partial parsing: updated file: citrus_trade://models/staging/_src_citrus_trade.yml
[0m03:58:06.642773 [debug] [MainThread]: Partial parsing: updated file: citrus_trade://models/staging/stg_trade.sql
[0m03:58:06.835845 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.citrus_trade.visualisation
[0m03:58:06.841031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '864ce09a-ee38-48a2-b6e8-8192e358b8dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6463350>]}
[0m03:58:06.884421 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m03:58:06.885902 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m03:58:06.896962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '864ce09a-ee38-48a2-b6e8-8192e358b8dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa614aa20>]}
[0m03:58:06.897449 [info ] [MainThread]: Found 7 models, 3 sources, 636 macros
[0m03:58:06.897804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '864ce09a-ee38-48a2-b6e8-8192e358b8dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6ab75c0>]}
[0m03:58:06.898928 [info ] [MainThread]: 
[0m03:58:06.899152 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m03:58:06.899392 [info ] [MainThread]: 
[0m03:58:06.899772 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m03:58:06.902378 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRHS'
[0m03:58:06.908944 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRHS'
[0m03:58:06.946658 [debug] [ThreadPool]: Using snowflake connection "list_TRHS"
[0m03:58:06.946995 [debug] [ThreadPool]: Using snowflake connection "list_TRHS"
[0m03:58:06.947168 [debug] [ThreadPool]: On list_TRHS: show terse schemas in database TRHS
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS"} */
[0m03:58:06.947382 [debug] [ThreadPool]: On list_TRHS: show terse schemas in database TRHS
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS"} */
[0m03:58:06.947557 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:58:06.947755 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:58:07.563782 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.616 seconds
[0m03:58:07.566665 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.619 seconds
[0m03:58:07.576623 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRHS, now list_TRHS_staging)
[0m03:58:07.577289 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRHS, now list_TRHS_analytics)
[0m03:58:07.602977 [debug] [ThreadPool]: Using snowflake connection "list_TRHS_staging"
[0m03:58:07.609469 [debug] [ThreadPool]: On list_TRHS_staging: show objects in TRHS.staging
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS_staging"} */;
[0m03:58:07.613069 [debug] [ThreadPool]: Using snowflake connection "list_TRHS_analytics"
[0m03:58:07.618807 [debug] [ThreadPool]: On list_TRHS_analytics: show objects in TRHS.analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS_analytics"} */;
[0m03:58:07.696270 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.082 seconds
[0m03:58:07.706864 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 0.087 seconds
[0m03:58:07.709364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '864ce09a-ee38-48a2-b6e8-8192e358b8dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaab29460>]}
[0m03:58:07.712122 [debug] [Thread-1 (]: Began running node model.citrus_trade.stg_trade
[0m03:58:07.712470 [info ] [Thread-1 (]: 1 of 7 START sql table model staging.stg_trade ................................. [RUN]
[0m03:58:07.712813 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_TRHS_analytics, now model.citrus_trade.stg_trade)
[0m03:58:07.713113 [debug] [Thread-1 (]: Began compiling node model.citrus_trade.stg_trade
[0m03:58:07.717840 [debug] [Thread-1 (]: Writing injected SQL for node "model.citrus_trade.stg_trade"
[0m03:58:07.719147 [debug] [Thread-1 (]: Began executing node model.citrus_trade.stg_trade
[0m03:58:07.736307 [debug] [Thread-1 (]: Writing runtime sql for node "model.citrus_trade.stg_trade"
[0m03:58:07.737863 [debug] [Thread-1 (]: Using snowflake connection "model.citrus_trade.stg_trade"
[0m03:58:07.738071 [debug] [Thread-1 (]: On model.citrus_trade.stg_trade: create or replace transient table TRHS.staging.stg_trade
    
    
    
    as (select
  value:DECLARANT::int as declarant,
  value:DECLARANT_ISO::string as declarant_iso,
  value:PARTNER::string as partner,
  value:PARTNER_ISO::string as partner_iso,
  value:FLOW::int as flow,
  value:TRANSPORT_MODE::int as transport_mode,
  value:PERIOD::int as period,
  value:HS4::string as hs4,
  value:HS4_NAME::string as hs4_name,
  value:HS6::string as hs6,
  value:HS6_NAME::string as hs6_name,
  value:VALUE_IN_EUROS::float as value_in_euros,
  value:QUANTITY_IN_KG::float as quantity_in_kg
from trhs.staging.nested_parquet_trhs
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.stg_trade"} */;
[0m03:58:08.510233 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.771 seconds
[0m03:58:08.536031 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '864ce09a-ee38-48a2-b6e8-8192e358b8dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaaa51580>]}
[0m03:58:08.536894 [info ] [Thread-1 (]: 1 of 7 OK created sql table model staging.stg_trade ............................ [[32mSUCCESS 1[0m in 0.82s]
[0m03:58:08.537564 [debug] [Thread-1 (]: Finished running node model.citrus_trade.stg_trade
[0m03:58:08.538993 [debug] [Thread-3 (]: Began running node model.citrus_trade.trade_by_declarant
[0m03:58:08.540272 [info ] [Thread-3 (]: 2 of 7 START sql table model analytics.trade_by_declarant ...................... [RUN]
[0m03:58:08.540910 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.citrus_trade.trade_by_declarant'
[0m03:58:08.541278 [debug] [Thread-3 (]: Began compiling node model.citrus_trade.trade_by_declarant
[0m03:58:08.544581 [debug] [Thread-3 (]: Writing injected SQL for node "model.citrus_trade.trade_by_declarant"
[0m03:58:08.548188 [debug] [Thread-3 (]: Began executing node model.citrus_trade.trade_by_declarant
[0m03:58:08.555902 [debug] [Thread-3 (]: Writing runtime sql for node "model.citrus_trade.trade_by_declarant"
[0m03:58:08.561732 [debug] [Thread-3 (]: Using snowflake connection "model.citrus_trade.trade_by_declarant"
[0m03:58:08.562125 [debug] [Thread-3 (]: On model.citrus_trade.trade_by_declarant: create or replace transient table TRHS.analytics.trade_by_declarant
    
    
    
    as (select 
    declarant,
    declarant_iso,
    partner,
    partner_iso,
    flow,
    transport_mode,
    year(to_date(left(period,4),'YYYY')) as year,
    period,
    hs6,
    hs6_name,
    sum(value_in_euros) as value,
    sum(quantity_in_kg) as quantity
from TRHS.staging.stg_trade
group by 1,2,3,4,5,6,7,8,9,10
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.trade_by_declarant"} */;
[0m03:58:08.562384 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m03:58:09.481691 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.919 seconds
[0m03:58:09.486915 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '864ce09a-ee38-48a2-b6e8-8192e358b8dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4dea450>]}
[0m03:58:09.487878 [info ] [Thread-3 (]: 2 of 7 OK created sql table model analytics.trade_by_declarant ................. [[32mSUCCESS 1[0m in 0.95s]
[0m03:58:09.488851 [debug] [Thread-3 (]: Finished running node model.citrus_trade.trade_by_declarant
[0m03:58:09.490269 [debug] [Thread-2 (]: Began running node model.citrus_trade.trade_by_hs
[0m03:58:09.490684 [info ] [Thread-2 (]: 3 of 7 START sql table model analytics.trade_by_hs ............................. [RUN]
[0m03:58:09.491354 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_TRHS_staging, now model.citrus_trade.trade_by_hs)
[0m03:58:09.491757 [debug] [Thread-2 (]: Began compiling node model.citrus_trade.trade_by_hs
[0m03:58:09.495239 [debug] [Thread-2 (]: Writing injected SQL for node "model.citrus_trade.trade_by_hs"
[0m03:58:09.497305 [debug] [Thread-2 (]: Began executing node model.citrus_trade.trade_by_hs
[0m03:58:09.500022 [debug] [Thread-2 (]: Writing runtime sql for node "model.citrus_trade.trade_by_hs"
[0m03:58:09.501749 [debug] [Thread-2 (]: Using snowflake connection "model.citrus_trade.trade_by_hs"
[0m03:58:09.502063 [debug] [Thread-2 (]: On model.citrus_trade.trade_by_hs: create or replace transient table TRHS.analytics.trade_by_hs
    
    
    
    as (select
    *
from TRHS.analytics.trade_by_declarant
where hs6 = '080510'
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.trade_by_hs"} */;
[0m03:58:10.085033 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.582 seconds
[0m03:58:10.090374 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '864ce09a-ee38-48a2-b6e8-8192e358b8dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa49fe810>]}
[0m03:58:10.091606 [info ] [Thread-2 (]: 3 of 7 OK created sql table model analytics.trade_by_hs ........................ [[32mSUCCESS 1[0m in 0.60s]
[0m03:58:10.093345 [debug] [Thread-2 (]: Finished running node model.citrus_trade.trade_by_hs
[0m03:58:10.094935 [debug] [Thread-4 (]: Began running node model.citrus_trade.imports_by_year
[0m03:58:10.095556 [info ] [Thread-4 (]: 4 of 7 START sql table model analytics.imports_by_year ......................... [RUN]
[0m03:58:10.096390 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.citrus_trade.imports_by_year'
[0m03:58:10.096673 [debug] [Thread-4 (]: Began compiling node model.citrus_trade.imports_by_year
[0m03:58:10.099718 [debug] [Thread-4 (]: Writing injected SQL for node "model.citrus_trade.imports_by_year"
[0m03:58:10.095240 [debug] [Thread-3 (]: Began running node model.citrus_trade.imports_exports_2022
[0m03:58:10.100338 [info ] [Thread-3 (]: 5 of 7 START sql table model analytics.imports_exports_2022 .................... [RUN]
[0m03:58:10.100879 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.citrus_trade.trade_by_declarant, now model.citrus_trade.imports_exports_2022)
[0m03:58:10.101476 [debug] [Thread-3 (]: Began compiling node model.citrus_trade.imports_exports_2022
[0m03:58:10.103355 [debug] [Thread-3 (]: Writing injected SQL for node "model.citrus_trade.imports_exports_2022"
[0m03:58:10.103842 [debug] [Thread-4 (]: Began executing node model.citrus_trade.imports_by_year
[0m03:58:10.106065 [debug] [Thread-4 (]: Writing runtime sql for node "model.citrus_trade.imports_by_year"
[0m03:58:10.107025 [debug] [Thread-3 (]: Began executing node model.citrus_trade.imports_exports_2022
[0m03:58:10.110061 [debug] [Thread-3 (]: Writing runtime sql for node "model.citrus_trade.imports_exports_2022"
[0m03:58:10.110986 [debug] [Thread-4 (]: Using snowflake connection "model.citrus_trade.imports_by_year"
[0m03:58:10.111362 [debug] [Thread-4 (]: On model.citrus_trade.imports_by_year: create or replace transient table TRHS.analytics.imports_by_year
    
    
    
    as (select
    declarant_iso,
    year,
    sum(value) as total_value,
    sum(quantity) as total_quantity,
    total_value/nullif(total_quantity,0) as value_per_quantity
from TRHS.analytics.trade_by_hs
where flow = 1
group by 1,2
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.imports_by_year"} */;
[0m03:58:10.111828 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m03:58:10.122608 [debug] [Thread-3 (]: Using snowflake connection "model.citrus_trade.imports_exports_2022"
[0m03:58:10.124330 [debug] [Thread-3 (]: On model.citrus_trade.imports_exports_2022: create or replace transient table TRHS.analytics.imports_exports_2022
    
    
    
    as (select
    declarant_iso,
    flow,
    sum(value) over(partition by declarant_iso, flow) as total_value,
    sum(quantity) over(partition by declarant_iso, flow) as total_quantity,
    total_value/nullif(total_quantity,0) as value_per_quantity
from TRHS.analytics.trade_by_hs
group by 
    declarant_iso,
    flow,
    value,
    quantity
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.imports_exports_2022"} */;
[0m03:58:10.764301 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.639 seconds
[0m03:58:10.770820 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '864ce09a-ee38-48a2-b6e8-8192e358b8dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4552e10>]}
[0m03:58:10.773524 [info ] [Thread-3 (]: 5 of 7 OK created sql table model analytics.imports_exports_2022 ............... [[32mSUCCESS 1[0m in 0.67s]
[0m03:58:10.776073 [debug] [Thread-3 (]: Finished running node model.citrus_trade.imports_exports_2022
[0m03:58:10.779036 [debug] [Thread-2 (]: Began running node model.citrus_trade.score_2022
[0m03:58:10.780615 [info ] [Thread-2 (]: 6 of 7 START sql table model analytics.score_2022 .............................. [RUN]
[0m03:58:10.783860 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.citrus_trade.trade_by_hs, now model.citrus_trade.score_2022)
[0m03:58:10.787073 [debug] [Thread-2 (]: Began compiling node model.citrus_trade.score_2022
[0m03:58:10.793554 [debug] [Thread-2 (]: Writing injected SQL for node "model.citrus_trade.score_2022"
[0m03:58:10.798289 [debug] [Thread-2 (]: Began executing node model.citrus_trade.score_2022
[0m03:58:10.804695 [debug] [Thread-2 (]: Writing runtime sql for node "model.citrus_trade.score_2022"
[0m03:58:10.808902 [debug] [Thread-2 (]: Using snowflake connection "model.citrus_trade.score_2022"
[0m03:58:10.810886 [debug] [Thread-2 (]: On model.citrus_trade.score_2022: create or replace transient table TRHS.analytics.score_2022
    
    
    
    as (select distinct 
    declarant_iso,
    total_value,
    total_quantity,
    value_per_quantity,
    (total_value - min(total_value) over())/((max(total_value) over())-(min(total_value) over())) as score_value,
    (total_quantity - min(total_quantity) over())/((max(total_quantity) over())-(min(total_quantity) over())) as score_quantity,
    (value_per_quantity - min(value_per_quantity) over())/((max(value_per_quantity) over())-(min(value_per_quantity) over())) as score_price
from TRHS.analytics.imports_exports_2022
where flow = 1
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.score_2022"} */;
[0m03:58:10.854148 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.742 seconds
[0m03:58:10.859364 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '864ce09a-ee38-48a2-b6e8-8192e358b8dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4553860>]}
[0m03:58:10.861008 [info ] [Thread-4 (]: 4 of 7 OK created sql table model analytics.imports_by_year .................... [[32mSUCCESS 1[0m in 0.76s]
[0m03:58:10.861799 [debug] [Thread-4 (]: Finished running node model.citrus_trade.imports_by_year
[0m03:58:10.863820 [debug] [Thread-3 (]: Began running node model.citrus_trade.growth_score
[0m03:58:10.865681 [info ] [Thread-3 (]: 7 of 7 START sql table model analytics.growth_score ............................ [RUN]
[0m03:58:10.866602 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.citrus_trade.imports_exports_2022, now model.citrus_trade.growth_score)
[0m03:58:10.868133 [debug] [Thread-3 (]: Began compiling node model.citrus_trade.growth_score
[0m03:58:10.873270 [debug] [Thread-3 (]: Writing injected SQL for node "model.citrus_trade.growth_score"
[0m03:58:10.876505 [debug] [Thread-3 (]: Began executing node model.citrus_trade.growth_score
[0m03:58:10.883348 [debug] [Thread-3 (]: Writing runtime sql for node "model.citrus_trade.growth_score"
[0m03:58:10.894320 [debug] [Thread-3 (]: Using snowflake connection "model.citrus_trade.growth_score"
[0m03:58:10.895874 [debug] [Thread-3 (]: On model.citrus_trade.growth_score: create or replace transient table TRHS.analytics.growth_score
    
    
    
    as (with 
    previous_year AS (
        select 
            declarant_iso,
            year,
            lag(total_value,1) over(partition by declarant_iso order by year) previous_year_value,
            total_value,
            first_value(total_value) over(partition by declarant_iso order by year) as first_year_value,
            last_value(total_value) over(partition by declarant_iso order by year) as last_year_value
        from TRHS.analytics.imports_by_year
    ),
    growth_speed AS (
        select 
            declarant_iso,
            year,
            first_year_value,
            last_year_value,
            last_year_value/nullif(first_year_value,0) as growth_overall,
            previous_year_value,
            total_value,
            (total_value - previous_year_value)/total_value * 100 as growth_speed 
        from previous_year
    ),
    previous_year_growth_speed AS (
        select 
            declarant_iso,
            year,
            first_year_value,
            last_year_value,
            growth_overall,
            previous_year_value,
            total_value as current_value,
            growth_speed,
            lag(growth_speed,1) over(partition by declarant_iso order by year) previous_year_growth_speed,
        from growth_speed
        order by 1,2
    ),
    base AS (
        select 
            declarant_iso,
            year,
            first_year_value,
            last_year_value,
            growth_overall,
            previous_year_value,
            current_value,
            previous_year_growth_speed,
            growth_speed,
            growth_speed - previous_year_growth_speed as growth_acceleration,
            avg(growth_acceleration) over(partition by declarant_iso) as avg_acceleration
        from previous_year_growth_speed
    ),
    ok as (
        select 
            declarant_iso,
            year,
            first_year_value,
            last_year_value,
            growth_overall,
            (growth_overall - min(growth_overall) OVER())/(max(growth_overall) OVER() - min(growth_overall) OVER()) as growth_overall_norm,
            previous_year_value,
            current_value,
            -- previous_year_growth_speed,
            growth_speed,
            growth_acceleration,
            avg_acceleration,
            (avg_acceleration - min(avg_acceleration) OVER())/(max(avg_acceleration) OVER() - min(avg_acceleration) OVER()) as avg_acceleration_norm
        from base 
    )
    select 
        declarant_iso,
        year,
        current_value,
        growth_speed,
        growth_acceleration,
        growth_overall,
        growth_overall_norm,
        avg_acceleration,
        avg_acceleration_norm,
        growth_overall_norm * avg_acceleration_norm as growth_score
    from ok
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.growth_score"} */;
[0m03:58:11.330631 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.518 seconds
[0m03:58:11.332491 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '864ce09a-ee38-48a2-b6e8-8192e358b8dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4d3f2c0>]}
[0m03:58:11.333219 [info ] [Thread-2 (]: 6 of 7 OK created sql table model analytics.score_2022 ......................... [[32mSUCCESS 1[0m in 0.55s]
[0m03:58:11.333837 [debug] [Thread-2 (]: Finished running node model.citrus_trade.score_2022
[0m03:58:11.533070 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.634 seconds
[0m03:58:11.547413 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '864ce09a-ee38-48a2-b6e8-8192e358b8dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa610bc80>]}
[0m03:58:11.548229 [info ] [Thread-3 (]: 7 of 7 OK created sql table model analytics.growth_score ....................... [[32mSUCCESS 1[0m in 0.68s]
[0m03:58:11.548897 [debug] [Thread-3 (]: Finished running node model.citrus_trade.growth_score
[0m03:58:11.552191 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:58:11.553321 [debug] [MainThread]: Connection 'model.citrus_trade.score_2022' was left open.
[0m03:58:11.554477 [debug] [MainThread]: On model.citrus_trade.score_2022: Close
[0m03:58:11.642800 [debug] [MainThread]: Connection 'model.citrus_trade.stg_trade' was left open.
[0m03:58:11.643613 [debug] [MainThread]: On model.citrus_trade.stg_trade: Close
[0m03:58:11.741531 [debug] [MainThread]: Connection 'model.citrus_trade.growth_score' was left open.
[0m03:58:11.743796 [debug] [MainThread]: On model.citrus_trade.growth_score: Close
[0m03:58:11.843369 [debug] [MainThread]: Connection 'model.citrus_trade.imports_by_year' was left open.
[0m03:58:11.844368 [debug] [MainThread]: On model.citrus_trade.imports_by_year: Close
[0m03:58:11.928288 [info ] [MainThread]: 
[0m03:58:11.929656 [info ] [MainThread]: Finished running 7 table models in 0 hours 0 minutes and 5.03 seconds (5.03s).
[0m03:58:11.933228 [debug] [MainThread]: Command end result
[0m03:58:12.022010 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m03:58:12.028784 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m03:58:12.038031 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/target/run_results.json
[0m03:58:12.038502 [info ] [MainThread]: 
[0m03:58:12.039267 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:58:12.040924 [info ] [MainThread]: 
[0m03:58:12.041784 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=7
[0m03:58:12.045232 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.8921337, "process_in_blocks": "2240", "process_kernel_time": 0.377522, "process_mem_max_rss": "155764", "process_out_blocks": "4255", "process_user_time": 1.906641}
[0m03:58:12.046186 [debug] [MainThread]: Command `dbt run` succeeded at 03:58:12.046050 after 5.89 seconds
[0m03:58:12.047434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa81fc5f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6b784d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa550ff50>]}
[0m03:58:12.048200 [debug] [MainThread]: Flushing usage events
[0m03:58:12.658345 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:39:39.493093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7ffe1b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffba6e9d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7ffd4f0>]}


============================== 21:39:39.511705 | 5b180cd3-69c1-4c4b-9448-a7ab9d0b23b6 ==============================
[0m21:39:39.511705 [info ] [MainThread]: Running with dbt=1.10.13
[0m21:39:39.512177 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'empty': 'False', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'no_print': 'None', 'quiet': 'False', 'use_experimental_parser': 'False', 'target_path': 'None', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'profiles_dir': '/opt/airflow/dbt', 'log_format': 'default', 'warn_error': 'None', 'introspect': 'True', 'static_parser': 'True', 'partial_parse': 'True', 'use_colors': 'True', 'indirect_selection': 'eager', 'printer_width': '80'}
[0m21:39:39.784677 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m21:39:39.790124 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m21:39:39.790336 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m21:39:39.897372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5b180cd3-69c1-4c4b-9448-a7ab9d0b23b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffba38a5d0>]}
[0m21:39:39.929938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5b180cd3-69c1-4c4b-9448-a7ab9d0b23b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6d2f0e0>]}
[0m21:39:39.930467 [info ] [MainThread]: Registered adapter: snowflake=1.10.3
[0m21:39:39.994315 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m21:39:40.083143 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m21:39:40.083494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5b180cd3-69c1-4c4b-9448-a7ab9d0b23b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb82a2f30>]}
[0m21:39:40.808028 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.citrus_trade.analytics
[0m21:39:40.813343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5b180cd3-69c1-4c4b-9448-a7ab9d0b23b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5e88170>]}
[0m21:39:40.893013 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m21:39:40.895777 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m21:39:40.923293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5b180cd3-69c1-4c4b-9448-a7ab9d0b23b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb57374a0>]}
[0m21:39:40.923793 [info ] [MainThread]: Found 7 models, 3 sources, 636 macros
[0m21:39:40.924236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5b180cd3-69c1-4c4b-9448-a7ab9d0b23b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5b63560>]}
[0m21:39:40.925779 [info ] [MainThread]: 
[0m21:39:40.926170 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:39:40.926421 [info ] [MainThread]: 
[0m21:39:40.927063 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:39:40.930910 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRHS'
[0m21:39:40.938877 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRHS'
[0m21:39:40.996564 [debug] [ThreadPool]: Using snowflake connection "list_TRHS"
[0m21:39:40.997175 [debug] [ThreadPool]: Using snowflake connection "list_TRHS"
[0m21:39:40.997392 [debug] [ThreadPool]: On list_TRHS: show terse schemas in database TRHS
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS"} */
[0m21:39:40.997796 [debug] [ThreadPool]: On list_TRHS: show terse schemas in database TRHS
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS"} */
[0m21:39:40.999345 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:39:41.000283 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:39:43.378569 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 2.379 seconds
[0m21:39:43.477208 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 2.477 seconds
[0m21:39:43.479524 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRHS, now create_TRHS_staging)
[0m21:39:43.480759 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRHS, now create_TRHS_marts)
[0m21:39:43.482129 [debug] [ThreadPool]: Creating schema "database: "TRHS"
schema: "staging"
"
[0m21:39:43.483112 [debug] [ThreadPool]: Creating schema "database: "TRHS"
schema: "marts"
"
[0m21:39:43.492485 [debug] [ThreadPool]: Using snowflake connection "create_TRHS_staging"
[0m21:39:43.506895 [debug] [ThreadPool]: Using snowflake connection "create_TRHS_marts"
[0m21:39:43.513508 [debug] [ThreadPool]: On create_TRHS_staging: create schema if not exists TRHS.staging
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "create_TRHS_staging"} */
[0m21:39:43.519372 [debug] [ThreadPool]: On create_TRHS_marts: create schema if not exists TRHS.marts
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "create_TRHS_marts"} */
[0m21:39:43.619155 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.097 seconds
[0m21:39:43.636705 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.110 seconds
[0m21:39:43.639395 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_TRHS_marts, now list_TRHS_staging)
[0m21:39:43.639798 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_TRHS_staging, now list_TRHS_marts)
[0m21:39:43.649004 [debug] [ThreadPool]: Using snowflake connection "list_TRHS_staging"
[0m21:39:43.651130 [debug] [ThreadPool]: On list_TRHS_staging: show objects in TRHS.staging
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS_staging"} */;
[0m21:39:43.650762 [debug] [ThreadPool]: Using snowflake connection "list_TRHS_marts"
[0m21:39:43.652731 [debug] [ThreadPool]: On list_TRHS_marts: show objects in TRHS.marts
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRHS_marts"} */;
[0m21:39:43.739830 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.088 seconds
[0m21:39:43.740403 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.087 seconds
[0m21:39:43.742794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5b180cd3-69c1-4c4b-9448-a7ab9d0b23b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5b74f80>]}
[0m21:39:43.746119 [debug] [Thread-1 (]: Began running node model.citrus_trade.stg_trade
[0m21:39:43.746523 [info ] [Thread-1 (]: 1 of 7 START sql table model staging.stg_trade ................................. [RUN]
[0m21:39:43.747016 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_TRHS_marts, now model.citrus_trade.stg_trade)
[0m21:39:43.747283 [debug] [Thread-1 (]: Began compiling node model.citrus_trade.stg_trade
[0m21:39:43.752562 [debug] [Thread-1 (]: Writing injected SQL for node "model.citrus_trade.stg_trade"
[0m21:39:43.754024 [debug] [Thread-1 (]: Began executing node model.citrus_trade.stg_trade
[0m21:39:43.773758 [debug] [Thread-1 (]: Writing runtime sql for node "model.citrus_trade.stg_trade"
[0m21:39:43.775491 [debug] [Thread-1 (]: Using snowflake connection "model.citrus_trade.stg_trade"
[0m21:39:43.775734 [debug] [Thread-1 (]: On model.citrus_trade.stg_trade: create or replace transient table TRHS.staging.stg_trade
    
    
    
    as (select
  value:DECLARANT::int as declarant,
  value:DECLARANT_ISO::string as declarant_iso,
  value:PARTNER::string as partner,
  value:PARTNER_ISO::string as partner_iso,
  value:FLOW::int as flow,
  value:TRANSPORT_MODE::int as transport_mode,
  value:PERIOD::int as period,
  value:HS4::string as hs4,
  value:HS4_NAME::string as hs4_name,
  value:HS6::string as hs6,
  value:HS6_NAME::string as hs6_name,
  value:VALUE_IN_EUROS::float as value_in_euros,
  value:QUANTITY_IN_KG::float as quantity_in_kg
from trade_flow.raw.raw_trhs
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.stg_trade"} */;
[0m21:39:45.106255 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.330 seconds
[0m21:39:45.140014 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5b180cd3-69c1-4c4b-9448-a7ab9d0b23b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5e5c230>]}
[0m21:39:45.141110 [info ] [Thread-1 (]: 1 of 7 OK created sql table model staging.stg_trade ............................ [[32mSUCCESS 1[0m in 1.39s]
[0m21:39:45.142393 [debug] [Thread-1 (]: Finished running node model.citrus_trade.stg_trade
[0m21:39:45.143918 [debug] [Thread-3 (]: Began running node model.citrus_trade.trade_by_declarant
[0m21:39:45.144774 [info ] [Thread-3 (]: 2 of 7 START sql table model marts.trade_by_declarant .......................... [RUN]
[0m21:39:45.145551 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.citrus_trade.trade_by_declarant'
[0m21:39:45.146027 [debug] [Thread-3 (]: Began compiling node model.citrus_trade.trade_by_declarant
[0m21:39:45.150016 [debug] [Thread-3 (]: Writing injected SQL for node "model.citrus_trade.trade_by_declarant"
[0m21:39:45.152155 [debug] [Thread-3 (]: Began executing node model.citrus_trade.trade_by_declarant
[0m21:39:45.155059 [debug] [Thread-3 (]: Writing runtime sql for node "model.citrus_trade.trade_by_declarant"
[0m21:39:45.157624 [debug] [Thread-3 (]: Using snowflake connection "model.citrus_trade.trade_by_declarant"
[0m21:39:45.158006 [debug] [Thread-3 (]: On model.citrus_trade.trade_by_declarant: create or replace transient table TRHS.marts.trade_by_declarant
    
    
    
    as (select 
    declarant,
    declarant_iso,
    partner,
    partner_iso,
    flow,
    transport_mode,
    year(to_date(left(period,4),'YYYY')) as year,
    period,
    hs6,
    hs6_name,
    sum(value_in_euros) as value,
    sum(quantity_in_kg) as quantity
from TRHS.staging.stg_trade
group by 1,2,3,4,5,6,7,8,9,10
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.trade_by_declarant"} */;
[0m21:39:45.158300 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m21:39:47.181790 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 2.023 seconds
[0m21:39:47.184508 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5b180cd3-69c1-4c4b-9448-a7ab9d0b23b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4204ad0>]}
[0m21:39:47.185216 [info ] [Thread-3 (]: 2 of 7 OK created sql table model marts.trade_by_declarant ..................... [[32mSUCCESS 1[0m in 2.04s]
[0m21:39:47.186133 [debug] [Thread-3 (]: Finished running node model.citrus_trade.trade_by_declarant
[0m21:39:47.187266 [debug] [Thread-2 (]: Began running node model.citrus_trade.trade_by_hs
[0m21:39:47.187853 [info ] [Thread-2 (]: 3 of 7 START sql table model marts.trade_by_hs ................................. [RUN]
[0m21:39:47.188451 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_TRHS_staging, now model.citrus_trade.trade_by_hs)
[0m21:39:47.188919 [debug] [Thread-2 (]: Began compiling node model.citrus_trade.trade_by_hs
[0m21:39:47.193397 [debug] [Thread-2 (]: Writing injected SQL for node "model.citrus_trade.trade_by_hs"
[0m21:39:47.194868 [debug] [Thread-2 (]: Began executing node model.citrus_trade.trade_by_hs
[0m21:39:47.196792 [debug] [Thread-2 (]: Writing runtime sql for node "model.citrus_trade.trade_by_hs"
[0m21:39:47.197692 [debug] [Thread-2 (]: Using snowflake connection "model.citrus_trade.trade_by_hs"
[0m21:39:47.197907 [debug] [Thread-2 (]: On model.citrus_trade.trade_by_hs: create or replace transient table TRHS.marts.trade_by_hs
    
    
    
    as (select
    *
from TRHS.marts.trade_by_declarant
where hs6 = '080510'
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.trade_by_hs"} */;
[0m21:39:47.866923 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.668 seconds
[0m21:39:47.871252 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5b180cd3-69c1-4c4b-9448-a7ab9d0b23b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb61e6ba0>]}
[0m21:39:47.872470 [info ] [Thread-2 (]: 3 of 7 OK created sql table model marts.trade_by_hs ............................ [[32mSUCCESS 1[0m in 0.68s]
[0m21:39:47.873805 [debug] [Thread-2 (]: Finished running node model.citrus_trade.trade_by_hs
[0m21:39:47.875250 [debug] [Thread-4 (]: Began running node model.citrus_trade.imports_by_year
[0m21:39:47.875799 [debug] [Thread-3 (]: Began running node model.citrus_trade.imports_exports_2022
[0m21:39:47.876333 [info ] [Thread-4 (]: 4 of 7 START sql table model marts.imports_by_year ............................. [RUN]
[0m21:39:47.878288 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.citrus_trade.imports_by_year'
[0m21:39:47.878856 [debug] [Thread-4 (]: Began compiling node model.citrus_trade.imports_by_year
[0m21:39:47.877372 [info ] [Thread-3 (]: 5 of 7 START sql table model marts.imports_exports_2022 ........................ [RUN]
[0m21:39:47.884130 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.citrus_trade.trade_by_declarant, now model.citrus_trade.imports_exports_2022)
[0m21:39:47.884539 [debug] [Thread-3 (]: Began compiling node model.citrus_trade.imports_exports_2022
[0m21:39:47.883600 [debug] [Thread-4 (]: Writing injected SQL for node "model.citrus_trade.imports_by_year"
[0m21:39:47.887623 [debug] [Thread-3 (]: Writing injected SQL for node "model.citrus_trade.imports_exports_2022"
[0m21:39:47.890787 [debug] [Thread-4 (]: Began executing node model.citrus_trade.imports_by_year
[0m21:39:47.893935 [debug] [Thread-4 (]: Writing runtime sql for node "model.citrus_trade.imports_by_year"
[0m21:39:47.894375 [debug] [Thread-3 (]: Began executing node model.citrus_trade.imports_exports_2022
[0m21:39:47.897140 [debug] [Thread-3 (]: Writing runtime sql for node "model.citrus_trade.imports_exports_2022"
[0m21:39:47.898292 [debug] [Thread-4 (]: Using snowflake connection "model.citrus_trade.imports_by_year"
[0m21:39:47.898757 [debug] [Thread-4 (]: On model.citrus_trade.imports_by_year: create or replace transient table TRHS.marts.imports_by_year
    
    
    
    as (select
    declarant_iso,
    year,
    sum(value) as total_value,
    sum(quantity) as total_quantity,
    total_value/nullif(total_quantity,0) as value_per_quantity
from TRHS.marts.trade_by_hs
where flow = 1
group by 1,2
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.imports_by_year"} */;
[0m21:39:47.899171 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m21:39:47.902760 [debug] [Thread-3 (]: Using snowflake connection "model.citrus_trade.imports_exports_2022"
[0m21:39:47.906088 [debug] [Thread-3 (]: On model.citrus_trade.imports_exports_2022: create or replace transient table TRHS.marts.imports_exports_2022
    
    
    
    as (select
    declarant_iso,
    flow,
    sum(value) over(partition by declarant_iso, flow) as total_value,
    sum(quantity) over(partition by declarant_iso, flow) as total_quantity,
    total_value/nullif(total_quantity,0) as value_per_quantity
from TRHS.marts.trade_by_hs
group by 
    declarant_iso,
    flow,
    value,
    quantity
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.imports_exports_2022"} */;
[0m21:39:48.763740 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.854 seconds
[0m21:39:48.766806 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5b180cd3-69c1-4c4b-9448-a7ab9d0b23b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb61e5460>]}
[0m21:39:48.767770 [info ] [Thread-3 (]: 5 of 7 OK created sql table model marts.imports_exports_2022 ................... [[32mSUCCESS 1[0m in 0.88s]
[0m21:39:48.768604 [debug] [Thread-3 (]: Finished running node model.citrus_trade.imports_exports_2022
[0m21:39:48.769575 [debug] [Thread-2 (]: Began running node model.citrus_trade.score_2022
[0m21:39:48.770320 [info ] [Thread-2 (]: 6 of 7 START sql table model marts.score_2022 .................................. [RUN]
[0m21:39:48.771012 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.citrus_trade.trade_by_hs, now model.citrus_trade.score_2022)
[0m21:39:48.771572 [debug] [Thread-2 (]: Began compiling node model.citrus_trade.score_2022
[0m21:39:48.776137 [debug] [Thread-2 (]: Writing injected SQL for node "model.citrus_trade.score_2022"
[0m21:39:48.777624 [debug] [Thread-2 (]: Began executing node model.citrus_trade.score_2022
[0m21:39:48.780728 [debug] [Thread-2 (]: Writing runtime sql for node "model.citrus_trade.score_2022"
[0m21:39:48.783442 [debug] [Thread-2 (]: Using snowflake connection "model.citrus_trade.score_2022"
[0m21:39:48.784163 [debug] [Thread-2 (]: On model.citrus_trade.score_2022: create or replace transient table TRHS.marts.score_2022
    
    
    
    as (select distinct 
    declarant_iso,
    total_value,
    total_quantity,
    value_per_quantity,
    (total_value - min(total_value) over())/((max(total_value) over())-(min(total_value) over())) as score_value,
    (total_quantity - min(total_quantity) over())/((max(total_quantity) over())-(min(total_quantity) over())) as score_quantity,
    (value_per_quantity - min(value_per_quantity) over())/((max(value_per_quantity) over())-(min(value_per_quantity) over())) as score_price
from TRHS.marts.imports_exports_2022
where flow = 1
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.score_2022"} */;
[0m21:39:49.401864 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.614 seconds
[0m21:39:49.407273 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5b180cd3-69c1-4c4b-9448-a7ab9d0b23b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb429ac00>]}
[0m21:39:49.408708 [info ] [Thread-2 (]: 6 of 7 OK created sql table model marts.score_2022 ............................. [[32mSUCCESS 1[0m in 0.64s]
[0m21:39:49.409868 [debug] [Thread-2 (]: Finished running node model.citrus_trade.score_2022
[0m21:39:49.742779 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.843 seconds
[0m21:39:49.746001 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5b180cd3-69c1-4c4b-9448-a7ab9d0b23b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4298cb0>]}
[0m21:39:49.746931 [info ] [Thread-4 (]: 4 of 7 OK created sql table model marts.imports_by_year ........................ [[32mSUCCESS 1[0m in 1.87s]
[0m21:39:49.747771 [debug] [Thread-4 (]: Finished running node model.citrus_trade.imports_by_year
[0m21:39:49.748803 [debug] [Thread-3 (]: Began running node model.citrus_trade.growth_score
[0m21:39:49.749295 [info ] [Thread-3 (]: 7 of 7 START sql table model marts.growth_score ................................ [RUN]
[0m21:39:49.749806 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.citrus_trade.imports_exports_2022, now model.citrus_trade.growth_score)
[0m21:39:49.750175 [debug] [Thread-3 (]: Began compiling node model.citrus_trade.growth_score
[0m21:39:49.754087 [debug] [Thread-3 (]: Writing injected SQL for node "model.citrus_trade.growth_score"
[0m21:39:49.755451 [debug] [Thread-3 (]: Began executing node model.citrus_trade.growth_score
[0m21:39:49.758681 [debug] [Thread-3 (]: Writing runtime sql for node "model.citrus_trade.growth_score"
[0m21:39:49.761907 [debug] [Thread-3 (]: Using snowflake connection "model.citrus_trade.growth_score"
[0m21:39:49.762299 [debug] [Thread-3 (]: On model.citrus_trade.growth_score: create or replace transient table TRHS.marts.growth_score
    
    
    
    as (with 
    previous_year AS (
        select 
            declarant_iso,
            year,
            lag(total_value,1) over(partition by declarant_iso order by year) previous_year_value,
            total_value,
            first_value(total_value) over(partition by declarant_iso order by year) as first_year_value,
            last_value(total_value) over(partition by declarant_iso order by year) as last_year_value
        from TRHS.marts.imports_by_year
    ),
    growth_speed AS (
        select 
            declarant_iso,
            year,
            first_year_value,
            last_year_value,
            last_year_value/nullif(first_year_value,0) as growth_overall,
            previous_year_value,
            total_value,
            (total_value - previous_year_value)/total_value * 100 as growth_speed 
        from previous_year
    ),
    previous_year_growth_speed AS (
        select 
            declarant_iso,
            year,
            first_year_value,
            last_year_value,
            growth_overall,
            previous_year_value,
            total_value as current_value,
            growth_speed,
            lag(growth_speed,1) over(partition by declarant_iso order by year) previous_year_growth_speed,
        from growth_speed
        order by 1,2
    ),
    base AS (
        select 
            declarant_iso,
            year,
            first_year_value,
            last_year_value,
            growth_overall,
            previous_year_value,
            current_value,
            previous_year_growth_speed,
            growth_speed,
            growth_speed - previous_year_growth_speed as growth_acceleration,
            avg(growth_acceleration) over(partition by declarant_iso) as avg_acceleration
        from previous_year_growth_speed
    ),
    ok as (
        select 
            declarant_iso,
            year,
            first_year_value,
            last_year_value,
            growth_overall,
            (growth_overall - min(growth_overall) OVER())/(max(growth_overall) OVER() - min(growth_overall) OVER()) as growth_overall_norm,
            previous_year_value,
            current_value,
            -- previous_year_growth_speed,
            growth_speed,
            growth_acceleration,
            avg_acceleration,
            (avg_acceleration - min(avg_acceleration) OVER())/(max(avg_acceleration) OVER() - min(avg_acceleration) OVER()) as avg_acceleration_norm
        from base 
    )
    select 
        declarant_iso,
        year,
        current_value,
        growth_speed,
        growth_acceleration,
        growth_overall,
        growth_overall_norm,
        avg_acceleration,
        avg_acceleration_norm,
        growth_overall_norm * avg_acceleration_norm as growth_score
    from ok
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.growth_score"} */;
[0m21:39:50.457627 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.695 seconds
[0m21:39:50.459437 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5b180cd3-69c1-4c4b-9448-a7ab9d0b23b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb60ea720>]}
[0m21:39:50.459925 [info ] [Thread-3 (]: 7 of 7 OK created sql table model marts.growth_score ........................... [[32mSUCCESS 1[0m in 0.71s]
[0m21:39:50.460347 [debug] [Thread-3 (]: Finished running node model.citrus_trade.growth_score
[0m21:39:50.461875 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:39:50.462174 [debug] [MainThread]: Connection 'model.citrus_trade.stg_trade' was left open.
[0m21:39:50.462358 [debug] [MainThread]: On model.citrus_trade.stg_trade: Close
[0m21:39:50.634493 [debug] [MainThread]: Connection 'model.citrus_trade.score_2022' was left open.
[0m21:39:50.635072 [debug] [MainThread]: On model.citrus_trade.score_2022: Close
[0m21:39:50.766653 [debug] [MainThread]: Connection 'model.citrus_trade.growth_score' was left open.
[0m21:39:50.767032 [debug] [MainThread]: On model.citrus_trade.growth_score: Close
[0m21:39:50.883705 [debug] [MainThread]: Connection 'model.citrus_trade.imports_by_year' was left open.
[0m21:39:50.884109 [debug] [MainThread]: On model.citrus_trade.imports_by_year: Close
[0m21:39:51.005582 [info ] [MainThread]: 
[0m21:39:51.006279 [info ] [MainThread]: Finished running 7 table models in 0 hours 0 minutes and 10.08 seconds (10.08s).
[0m21:39:51.007741 [debug] [MainThread]: Command end result
[0m21:39:51.048836 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m21:39:51.053542 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m21:39:51.059478 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/target/run_results.json
[0m21:39:51.059865 [info ] [MainThread]: 
[0m21:39:51.060458 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:39:51.061103 [info ] [MainThread]: 
[0m21:39:51.061834 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=7
[0m21:39:51.070170 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.610943, "process_in_blocks": "2680", "process_kernel_time": 1.179175, "process_mem_max_rss": "157592", "process_out_blocks": "8703", "process_user_time": 2.975443}
[0m21:39:51.071278 [debug] [MainThread]: Command `dbt run` succeeded at 21:39:51.071132 after 11.61 seconds
[0m21:39:51.072078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbc9a28a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8a25340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8a24350>]}
[0m21:39:51.072598 [debug] [MainThread]: Flushing usage events
[0m21:39:52.440082 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:01:34.340996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3bc6a80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3b97f80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3bc6cc0>]}


============================== 22:01:34.345664 | 2b97fa43-c7ef-4725-a6fb-2dff52e76e45 ==============================
[0m22:01:34.345664 [info ] [MainThread]: Running with dbt=1.10.13
[0m22:01:34.346157 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'quiet': 'False', 'invocation_command': 'dbt run', 'no_print': 'None', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'introspect': 'True', 'cache_selected_only': 'False', 'fail_fast': 'False', 'indirect_selection': 'eager', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': '/opt/airflow/dbt/logs', 'printer_width': '80', 'use_experimental_parser': 'False', 'write_json': 'True', 'log_format': 'default', 'static_parser': 'True', 'empty': 'False', 'partial_parse': 'True', 'log_cache_events': 'False', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'version_check': 'True'}
[0m22:01:34.546463 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m22:01:34.546915 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m22:01:34.547213 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m22:01:34.649869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2b97fa43-c7ef-4725-a6fb-2dff52e76e45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa20532c0>]}
[0m22:01:34.680902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2b97fa43-c7ef-4725-a6fb-2dff52e76e45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1ef1160>]}
[0m22:01:34.681503 [info ] [MainThread]: Registered adapter: snowflake=1.10.3
[0m22:01:34.744205 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m22:01:34.832575 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m22:01:34.833002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '2b97fa43-c7ef-4725-a6fb-2dff52e76e45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1aba600>]}
[0m22:01:35.547487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2b97fa43-c7ef-4725-a6fb-2dff52e76e45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1b2c1d0>]}
[0m22:01:35.593114 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m22:01:35.594890 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m22:01:35.610130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2b97fa43-c7ef-4725-a6fb-2dff52e76e45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa19f7fe0>]}
[0m22:01:35.610465 [info ] [MainThread]: Found 8 models, 3 sources, 636 macros
[0m22:01:35.610709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2b97fa43-c7ef-4725-a6fb-2dff52e76e45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa151b350>]}
[0m22:01:35.611760 [info ] [MainThread]: 
[0m22:01:35.612008 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:01:35.612317 [info ] [MainThread]: 
[0m22:01:35.612791 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:01:35.615861 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRADE_FLOW'
[0m22:01:35.622467 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRADE_FLOW'
[0m22:01:35.659393 [debug] [ThreadPool]: Using snowflake connection "list_TRADE_FLOW"
[0m22:01:35.659754 [debug] [ThreadPool]: Using snowflake connection "list_TRADE_FLOW"
[0m22:01:35.659938 [debug] [ThreadPool]: On list_TRADE_FLOW: show terse schemas in database TRADE_FLOW
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRADE_FLOW"} */
[0m22:01:35.660188 [debug] [ThreadPool]: On list_TRADE_FLOW: show terse schemas in database TRADE_FLOW
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRADE_FLOW"} */
[0m22:01:35.660414 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:01:35.660596 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:01:37.232954 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.572 seconds
[0m22:01:37.253351 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.593 seconds
[0m22:01:37.255495 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRADE_FLOW, now list_TRADE_FLOW_analytics)
[0m22:01:37.261992 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRADE_FLOW, now list_TRADE_FLOW_marts)
[0m22:01:37.263765 [debug] [ThreadPool]: Using snowflake connection "list_TRADE_FLOW_analytics"
[0m22:01:37.264029 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRADE_FLOW_staging'
[0m22:01:37.265481 [debug] [ThreadPool]: Using snowflake connection "list_TRADE_FLOW_marts"
[0m22:01:37.265768 [debug] [ThreadPool]: On list_TRADE_FLOW_analytics: show objects in TRADE_FLOW.analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRADE_FLOW_analytics"} */;
[0m22:01:37.266994 [debug] [ThreadPool]: Using snowflake connection "list_TRADE_FLOW_staging"
[0m22:01:37.267226 [debug] [ThreadPool]: On list_TRADE_FLOW_marts: show objects in TRADE_FLOW.marts
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRADE_FLOW_marts"} */;
[0m22:01:37.268480 [debug] [ThreadPool]: On list_TRADE_FLOW_staging: show objects in TRADE_FLOW.staging
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRADE_FLOW_staging"} */;
[0m22:01:37.269070 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:01:37.360411 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.092 seconds
[0m22:01:37.378518 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.111 seconds
[0m22:01:38.383253 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 1.114 seconds
[0m22:01:38.387806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2b97fa43-c7ef-4725-a6fb-2dff52e76e45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0d77fb0>]}
[0m22:01:38.393233 [debug] [Thread-1 (]: Began running node model.citrus_trade.stg_trade
[0m22:01:38.393700 [info ] [Thread-1 (]: 1 of 7 START sql table model staging.stg_trade ................................. [RUN]
[0m22:01:38.394107 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_TRADE_FLOW_staging, now model.citrus_trade.stg_trade)
[0m22:01:38.394467 [debug] [Thread-1 (]: Began compiling node model.citrus_trade.stg_trade
[0m22:01:38.399930 [debug] [Thread-1 (]: Writing injected SQL for node "model.citrus_trade.stg_trade"
[0m22:01:38.401369 [debug] [Thread-1 (]: Began executing node model.citrus_trade.stg_trade
[0m22:01:38.421696 [debug] [Thread-1 (]: Writing runtime sql for node "model.citrus_trade.stg_trade"
[0m22:01:38.424270 [debug] [Thread-1 (]: Using snowflake connection "model.citrus_trade.stg_trade"
[0m22:01:38.424590 [debug] [Thread-1 (]: On model.citrus_trade.stg_trade: create or replace transient table TRADE_FLOW.staging.stg_trade
    
    
    
    as (select
  value:DECLARANT::int as declarant,
  value:DECLARANT_ISO::string as declarant_iso,
  value:PARTNER::string as partner,
  value:PARTNER_ISO::string as partner_iso,
  value:FLOW::int as flow,
  value:TRANSPORT_MODE::int as transport_mode,
  value:PERIOD::int as period,
  year(to_date(left(period,4),'YYYY')) as year,
  value:HS4::string as hs4,
  value:HS4_NAME::string as hs4_name,
  value:HS6::string as hs6,
  value:HS6_NAME::string as hs6_name,
  value:VALUE_IN_EUROS::float as value_in_euros,
  value:QUANTITY_IN_KG::float as quantity_in_kg
from trade_flow.raw.raw_trhs
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.stg_trade"} */;
[0m22:01:39.727464 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.302 seconds
[0m22:01:39.762424 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b97fa43-c7ef-4725-a6fb-2dff52e76e45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5cb99a0>]}
[0m22:01:39.763710 [info ] [Thread-1 (]: 1 of 7 OK created sql table model staging.stg_trade ............................ [[32mSUCCESS 1[0m in 1.37s]
[0m22:01:39.764646 [debug] [Thread-1 (]: Finished running node model.citrus_trade.stg_trade
[0m22:01:39.766137 [debug] [Thread-3 (]: Began running node model.citrus_trade.trade_by_declarant
[0m22:01:39.766710 [info ] [Thread-3 (]: 2 of 7 START sql table model marts.trade_by_declarant .......................... [RUN]
[0m22:01:39.767363 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_TRADE_FLOW_marts, now model.citrus_trade.trade_by_declarant)
[0m22:01:39.767815 [debug] [Thread-3 (]: Began compiling node model.citrus_trade.trade_by_declarant
[0m22:01:39.771604 [debug] [Thread-3 (]: Writing injected SQL for node "model.citrus_trade.trade_by_declarant"
[0m22:01:39.773304 [debug] [Thread-3 (]: Began executing node model.citrus_trade.trade_by_declarant
[0m22:01:39.776022 [debug] [Thread-3 (]: Writing runtime sql for node "model.citrus_trade.trade_by_declarant"
[0m22:01:39.777694 [debug] [Thread-3 (]: Using snowflake connection "model.citrus_trade.trade_by_declarant"
[0m22:01:39.778036 [debug] [Thread-3 (]: On model.citrus_trade.trade_by_declarant: create or replace transient table TRADE_FLOW.marts.trade_by_declarant
    
    
    
    as (select 
    declarant,
    declarant_iso,
    partner,
    partner_iso,
    flow,
    transport_mode,
    year(to_date(left(period,4),'YYYY')) as year,
    period,
    hs6,
    hs6_name,
    sum(value_in_euros) as value,
    sum(quantity_in_kg) as quantity
from TRADE_FLOW.staging.stg_trade
group by 1,2,3,4,5,6,7,8,9,10
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.trade_by_declarant"} */;
[0m22:01:40.466401 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.688 seconds
[0m22:01:40.470941 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b97fa43-c7ef-4725-a6fb-2dff52e76e45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1a79220>]}
[0m22:01:40.471966 [info ] [Thread-3 (]: 2 of 7 OK created sql table model marts.trade_by_declarant ..................... [[32mSUCCESS 1[0m in 0.70s]
[0m22:01:40.472669 [debug] [Thread-3 (]: Finished running node model.citrus_trade.trade_by_declarant
[0m22:01:40.473770 [debug] [Thread-2 (]: Began running node model.citrus_trade.trade_by_hs
[0m22:01:40.474293 [info ] [Thread-2 (]: 3 of 7 START sql table model marts.trade_by_hs ................................. [RUN]
[0m22:01:40.474741 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_TRADE_FLOW_analytics, now model.citrus_trade.trade_by_hs)
[0m22:01:40.475143 [debug] [Thread-2 (]: Began compiling node model.citrus_trade.trade_by_hs
[0m22:01:40.478190 [debug] [Thread-2 (]: Writing injected SQL for node "model.citrus_trade.trade_by_hs"
[0m22:01:40.479537 [debug] [Thread-2 (]: Began executing node model.citrus_trade.trade_by_hs
[0m22:01:40.481764 [debug] [Thread-2 (]: Writing runtime sql for node "model.citrus_trade.trade_by_hs"
[0m22:01:40.482799 [debug] [Thread-2 (]: Using snowflake connection "model.citrus_trade.trade_by_hs"
[0m22:01:40.483052 [debug] [Thread-2 (]: On model.citrus_trade.trade_by_hs: create or replace transient table TRADE_FLOW.marts.trade_by_hs
    
    
    
    as (select
    *
from TRADE_FLOW.marts.trade_by_declarant
where hs6 = '080510'
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.trade_by_hs"} */;
[0m22:01:41.110324 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.627 seconds
[0m22:01:41.115196 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b97fa43-c7ef-4725-a6fb-2dff52e76e45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa199db20>]}
[0m22:01:41.116788 [info ] [Thread-2 (]: 3 of 7 OK created sql table model marts.trade_by_hs ............................ [[32mSUCCESS 1[0m in 0.64s]
[0m22:01:41.117642 [debug] [Thread-2 (]: Finished running node model.citrus_trade.trade_by_hs
[0m22:01:41.118986 [debug] [Thread-4 (]: Began running node model.citrus_trade.imports_by_year
[0m22:01:41.119486 [debug] [Thread-3 (]: Began running node model.citrus_trade.imports_exports_2022
[0m22:01:41.120161 [info ] [Thread-4 (]: 4 of 7 START sql table model marts.imports_by_year ............................. [RUN]
[0m22:01:41.121597 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.citrus_trade.imports_by_year'
[0m22:01:41.122056 [debug] [Thread-4 (]: Began compiling node model.citrus_trade.imports_by_year
[0m22:01:41.120714 [info ] [Thread-3 (]: 5 of 7 START sql table model marts.imports_exports_2022 ........................ [RUN]
[0m22:01:41.125846 [debug] [Thread-4 (]: Writing injected SQL for node "model.citrus_trade.imports_by_year"
[0m22:01:41.126412 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.citrus_trade.trade_by_declarant, now model.citrus_trade.imports_exports_2022)
[0m22:01:41.127089 [debug] [Thread-3 (]: Began compiling node model.citrus_trade.imports_exports_2022
[0m22:01:41.130363 [debug] [Thread-3 (]: Writing injected SQL for node "model.citrus_trade.imports_exports_2022"
[0m22:01:41.131237 [debug] [Thread-4 (]: Began executing node model.citrus_trade.imports_by_year
[0m22:01:41.137970 [debug] [Thread-4 (]: Writing runtime sql for node "model.citrus_trade.imports_by_year"
[0m22:01:41.139229 [debug] [Thread-3 (]: Began executing node model.citrus_trade.imports_exports_2022
[0m22:01:41.142219 [debug] [Thread-3 (]: Writing runtime sql for node "model.citrus_trade.imports_exports_2022"
[0m22:01:41.143960 [debug] [Thread-4 (]: Using snowflake connection "model.citrus_trade.imports_by_year"
[0m22:01:41.144374 [debug] [Thread-4 (]: On model.citrus_trade.imports_by_year: create or replace transient table TRADE_FLOW.marts.imports_by_year
    
    
    
    as (select
    declarant_iso,
    year,
    sum(value) as total_value,
    sum(quantity) as total_quantity,
    total_value/nullif(total_quantity,0) as value_per_quantity
from TRADE_FLOW.marts.trade_by_hs
where flow = 1
group by 1,2
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.imports_by_year"} */;
[0m22:01:41.144683 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m22:01:41.146053 [debug] [Thread-3 (]: Using snowflake connection "model.citrus_trade.imports_exports_2022"
[0m22:01:41.147451 [debug] [Thread-3 (]: On model.citrus_trade.imports_exports_2022: create or replace transient table TRADE_FLOW.marts.imports_exports_2022
    
    
    
    as (select
    declarant_iso,
    flow,
    sum(value) over(partition by declarant_iso, flow) as total_value,
    sum(quantity) over(partition by declarant_iso, flow) as total_quantity,
    total_value/nullif(total_quantity,0) as value_per_quantity
from TRADE_FLOW.marts.trade_by_hs
group by 
    declarant_iso,
    flow,
    value,
    quantity
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.imports_exports_2022"} */;
[0m22:01:41.855545 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.706 seconds
[0m22:01:41.861310 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b97fa43-c7ef-4725-a6fb-2dff52e76e45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa15dfbf0>]}
[0m22:01:41.862614 [info ] [Thread-3 (]: 5 of 7 OK created sql table model marts.imports_exports_2022 ................... [[32mSUCCESS 1[0m in 0.73s]
[0m22:01:41.864023 [debug] [Thread-3 (]: Finished running node model.citrus_trade.imports_exports_2022
[0m22:01:41.865543 [debug] [Thread-2 (]: Began running node model.citrus_trade.score_2022
[0m22:01:41.866443 [info ] [Thread-2 (]: 6 of 7 START sql table model marts.score_2022 .................................. [RUN]
[0m22:01:41.867209 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.citrus_trade.trade_by_hs, now model.citrus_trade.score_2022)
[0m22:01:41.867961 [debug] [Thread-2 (]: Began compiling node model.citrus_trade.score_2022
[0m22:01:41.872775 [debug] [Thread-2 (]: Writing injected SQL for node "model.citrus_trade.score_2022"
[0m22:01:41.874393 [debug] [Thread-2 (]: Began executing node model.citrus_trade.score_2022
[0m22:01:41.878190 [debug] [Thread-2 (]: Writing runtime sql for node "model.citrus_trade.score_2022"
[0m22:01:41.880358 [debug] [Thread-2 (]: Using snowflake connection "model.citrus_trade.score_2022"
[0m22:01:41.880819 [debug] [Thread-2 (]: On model.citrus_trade.score_2022: create or replace transient table TRADE_FLOW.marts.score_2022
    
    
    
    as (select distinct 
    declarant_iso,
    total_value,
    total_quantity,
    value_per_quantity,
    (total_value - min(total_value) over())/((max(total_value) over())-(min(total_value) over())) as score_value,
    (total_quantity - min(total_quantity) over())/((max(total_quantity) over())-(min(total_quantity) over())) as score_quantity,
    (value_per_quantity - min(value_per_quantity) over())/((max(value_per_quantity) over())-(min(value_per_quantity) over())) as score_price
from TRADE_FLOW.marts.imports_exports_2022
where flow = 1
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.score_2022"} */;
[0m22:01:42.524032 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.642 seconds
[0m22:01:42.527840 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b97fa43-c7ef-4725-a6fb-2dff52e76e45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1a6af30>]}
[0m22:01:42.528824 [info ] [Thread-2 (]: 6 of 7 OK created sql table model marts.score_2022 ............................. [[32mSUCCESS 1[0m in 0.66s]
[0m22:01:42.529749 [debug] [Thread-2 (]: Finished running node model.citrus_trade.score_2022
[0m22:01:42.769470 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.624 seconds
[0m22:01:42.773516 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b97fa43-c7ef-4725-a6fb-2dff52e76e45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1a79100>]}
[0m22:01:42.774563 [info ] [Thread-4 (]: 4 of 7 OK created sql table model marts.imports_by_year ........................ [[32mSUCCESS 1[0m in 1.65s]
[0m22:01:42.775467 [debug] [Thread-4 (]: Finished running node model.citrus_trade.imports_by_year
[0m22:01:42.776962 [debug] [Thread-3 (]: Began running node model.citrus_trade.growth_score
[0m22:01:42.777803 [info ] [Thread-3 (]: 7 of 7 START sql table model marts.growth_score ................................ [RUN]
[0m22:01:42.778740 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.citrus_trade.imports_exports_2022, now model.citrus_trade.growth_score)
[0m22:01:42.779385 [debug] [Thread-3 (]: Began compiling node model.citrus_trade.growth_score
[0m22:01:42.784938 [debug] [Thread-3 (]: Writing injected SQL for node "model.citrus_trade.growth_score"
[0m22:01:42.786786 [debug] [Thread-3 (]: Began executing node model.citrus_trade.growth_score
[0m22:01:42.790769 [debug] [Thread-3 (]: Writing runtime sql for node "model.citrus_trade.growth_score"
[0m22:01:42.796738 [debug] [Thread-3 (]: Using snowflake connection "model.citrus_trade.growth_score"
[0m22:01:42.797468 [debug] [Thread-3 (]: On model.citrus_trade.growth_score: create or replace transient table TRADE_FLOW.marts.growth_score
    
    
    
    as (with 
    previous_year AS (
        select 
            declarant_iso,
            year,
            lag(total_value,1) over(partition by declarant_iso order by year) previous_year_value,
            total_value,
            first_value(total_value) over(partition by declarant_iso order by year) as first_year_value,
            last_value(total_value) over(partition by declarant_iso order by year) as last_year_value
        from TRADE_FLOW.marts.imports_by_year
    ),
    growth_speed AS (
        select 
            declarant_iso,
            year,
            first_year_value,
            last_year_value,
            last_year_value/nullif(first_year_value,0) as growth_overall,
            previous_year_value,
            total_value,
            (total_value - previous_year_value)/total_value * 100 as growth_speed 
        from previous_year
    ),
    previous_year_growth_speed AS (
        select 
            declarant_iso,
            year,
            first_year_value,
            last_year_value,
            growth_overall,
            previous_year_value,
            total_value as current_value,
            growth_speed,
            lag(growth_speed,1) over(partition by declarant_iso order by year) previous_year_growth_speed,
        from growth_speed
        order by 1,2
    ),
    base AS (
        select 
            declarant_iso,
            year,
            first_year_value,
            last_year_value,
            growth_overall,
            previous_year_value,
            current_value,
            previous_year_growth_speed,
            growth_speed,
            growth_speed - previous_year_growth_speed as growth_acceleration,
            avg(growth_acceleration) over(partition by declarant_iso) as avg_acceleration
        from previous_year_growth_speed
    ),
    ok as (
        select 
            declarant_iso,
            year,
            first_year_value,
            last_year_value,
            growth_overall,
            (growth_overall - min(growth_overall) OVER())/(max(growth_overall) OVER() - min(growth_overall) OVER()) as growth_overall_norm,
            previous_year_value,
            current_value,
            -- previous_year_growth_speed,
            growth_speed,
            growth_acceleration,
            avg_acceleration,
            (avg_acceleration - min(avg_acceleration) OVER())/(max(avg_acceleration) OVER() - min(avg_acceleration) OVER()) as avg_acceleration_norm
        from base 
    )
    select 
        declarant_iso,
        year,
        current_value,
        growth_speed,
        growth_acceleration,
        growth_overall,
        growth_overall_norm,
        avg_acceleration,
        avg_acceleration_norm,
        growth_overall_norm * avg_acceleration_norm as growth_score
    from ok
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.growth_score"} */;
[0m22:01:43.496886 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.697 seconds
[0m22:01:43.504447 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b97fa43-c7ef-4725-a6fb-2dff52e76e45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9bf2b740>]}
[0m22:01:43.505940 [info ] [Thread-3 (]: 7 of 7 OK created sql table model marts.growth_score ........................... [[32mSUCCESS 1[0m in 0.73s]
[0m22:01:43.507323 [debug] [Thread-3 (]: Finished running node model.citrus_trade.growth_score
[0m22:01:43.511516 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:01:43.512032 [debug] [MainThread]: Connection 'model.citrus_trade.score_2022' was left open.
[0m22:01:43.512567 [debug] [MainThread]: On model.citrus_trade.score_2022: Close
[0m22:01:43.642403 [debug] [MainThread]: Connection 'model.citrus_trade.growth_score' was left open.
[0m22:01:43.643825 [debug] [MainThread]: On model.citrus_trade.growth_score: Close
[0m22:01:43.768859 [debug] [MainThread]: Connection 'model.citrus_trade.stg_trade' was left open.
[0m22:01:43.769511 [debug] [MainThread]: On model.citrus_trade.stg_trade: Close
[0m22:01:43.895165 [debug] [MainThread]: Connection 'model.citrus_trade.imports_by_year' was left open.
[0m22:01:43.895816 [debug] [MainThread]: On model.citrus_trade.imports_by_year: Close
[0m22:01:44.048071 [info ] [MainThread]: 
[0m22:01:44.048636 [info ] [MainThread]: Finished running 7 table models in 0 hours 0 minutes and 8.44 seconds (8.44s).
[0m22:01:44.049755 [debug] [MainThread]: Command end result
[0m22:01:44.075538 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m22:01:44.077559 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m22:01:44.081820 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/target/run_results.json
[0m22:01:44.081992 [info ] [MainThread]: 
[0m22:01:44.082261 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:01:44.082623 [info ] [MainThread]: 
[0m22:01:44.082900 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=7
[0m22:01:44.084133 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.773789, "process_in_blocks": "0", "process_kernel_time": 0.510656, "process_mem_max_rss": "154256", "process_out_blocks": "4268", "process_user_time": 2.750857}
[0m22:01:44.084546 [debug] [MainThread]: Command `dbt run` succeeded at 22:01:44.084468 after 9.77 seconds
[0m22:01:44.084818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa81fa8a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa19f75f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4d2a270>]}
[0m22:01:44.085043 [debug] [MainThread]: Flushing usage events
[0m22:01:45.414722 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:04:10.312878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d0e9a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7adc11c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7aa6ec60>]}


============================== 22:04:10.321430 | e6b4b26e-2940-4004-b91f-0ed9a9ac6fd7 ==============================
[0m22:04:10.321430 [info ] [MainThread]: Running with dbt=1.10.13
[0m22:04:10.324307 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'printer_width': '80', 'log_format': 'default', 'quiet': 'False', 'cache_selected_only': 'False', 'invocation_command': 'dbt run', 'empty': 'False', 'log_path': '/opt/airflow/dbt/logs', 'static_parser': 'True', 'version_check': 'True', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'no_print': 'None', 'fail_fast': 'False', 'partial_parse': 'True', 'log_cache_events': 'False', 'profiles_dir': '/opt/airflow/dbt', 'use_experimental_parser': 'False', 'write_json': 'True', 'debug': 'False'}
[0m22:04:10.489638 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m22:04:10.490239 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m22:04:10.490482 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m22:04:10.618633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e6b4b26e-2940-4004-b91f-0ed9a9ac6fd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d226540>]}
[0m22:04:10.655475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e6b4b26e-2940-4004-b91f-0ed9a9ac6fd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff79362840>]}
[0m22:04:10.656225 [info ] [MainThread]: Registered adapter: snowflake=1.10.3
[0m22:04:10.719334 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m22:04:10.864116 [debug] [MainThread]: Partial parsing enabled: 3 files deleted, 2 files added, 2 files changed.
[0m22:04:10.864662 [debug] [MainThread]: Partial parsing: added file: citrus_trade://models/marts/imports_exports_2020.sql
[0m22:04:10.864976 [debug] [MainThread]: Partial parsing: added file: citrus_trade://models/marts/score_2020.sql
[0m22:04:10.865195 [debug] [MainThread]: Partial parsing: deleted file: citrus_trade://models/marts/imports_exports_2022.sql
[0m22:04:10.865451 [debug] [MainThread]: Partial parsing: deleted file: citrus_trade://models/marts/trade_by_declarant.sql
[0m22:04:10.865601 [debug] [MainThread]: Partial parsing: deleted file: citrus_trade://models/marts/score_2022.sql
[0m22:04:10.865756 [debug] [MainThread]: Partial parsing: updated file: citrus_trade://models/marts/trade_by_hs.sql
[0m22:04:10.865949 [debug] [MainThread]: Partial parsing: updated file: citrus_trade://models/analytics/importer_trade_score.sql
[0m22:04:10.986059 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.citrus_trade.importer_trade_score' (models/analytics/importer_trade_score.sql) depends on a node named 'score_2022' which was not found
[0m22:04:10.987549 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.73654383, "process_in_blocks": "0", "process_kernel_time": 0.317695, "process_mem_max_rss": "130904", "process_out_blocks": "7", "process_user_time": 1.45938}
[0m22:04:10.987959 [debug] [MainThread]: Command `dbt run` failed at 22:04:10.987882 after 0.74 seconds
[0m22:04:10.988213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c6513d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff78f92150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff78f27b30>]}
[0m22:04:10.988422 [debug] [MainThread]: Flushing usage events
[0m22:04:12.301495 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:04:27.247254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0d3c8f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa35ccfe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa136e270>]}


============================== 22:04:27.249932 | 1f3fe262-5359-43c6-8be8-f4a49ab74496 ==============================
[0m22:04:27.249932 [info ] [MainThread]: Running with dbt=1.10.13
[0m22:04:27.250400 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_experimental_parser': 'False', 'target_path': 'None', 'profiles_dir': '/opt/airflow/dbt', 'cache_selected_only': 'False', 'printer_width': '80', 'write_json': 'True', 'invocation_command': 'dbt run', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'debug': 'False', 'warn_error': 'None', 'log_cache_events': 'False', 'introspect': 'True', 'log_path': '/opt/airflow/dbt/logs', 'quiet': 'False', 'static_parser': 'True', 'version_check': 'True', 'empty': 'False', 'fail_fast': 'False', 'use_colors': 'True'}
[0m22:04:27.382874 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m22:04:27.383222 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m22:04:27.383391 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m22:04:27.475796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1f3fe262-5359-43c6-8be8-f4a49ab74496', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f62fe60>]}
[0m22:04:27.506785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1f3fe262-5359-43c6-8be8-f4a49ab74496', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9fde8170>]}
[0m22:04:27.507318 [info ] [MainThread]: Registered adapter: snowflake=1.10.3
[0m22:04:27.555276 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m22:04:27.666423 [debug] [MainThread]: Partial parsing enabled: 3 files deleted, 2 files added, 2 files changed.
[0m22:04:27.666781 [debug] [MainThread]: Partial parsing: added file: citrus_trade://models/marts/imports_exports_2020.sql
[0m22:04:27.666960 [debug] [MainThread]: Partial parsing: added file: citrus_trade://models/marts/score_2020.sql
[0m22:04:27.667184 [debug] [MainThread]: Partial parsing: deleted file: citrus_trade://models/marts/trade_by_declarant.sql
[0m22:04:27.667316 [debug] [MainThread]: Partial parsing: deleted file: citrus_trade://models/marts/score_2022.sql
[0m22:04:27.667437 [debug] [MainThread]: Partial parsing: deleted file: citrus_trade://models/marts/imports_exports_2022.sql
[0m22:04:27.667572 [debug] [MainThread]: Partial parsing: updated file: citrus_trade://models/marts/trade_by_hs.sql
[0m22:04:27.667725 [debug] [MainThread]: Partial parsing: updated file: citrus_trade://models/analytics/importer_trade_score.sql
[0m22:04:27.800176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1f3fe262-5359-43c6-8be8-f4a49ab74496', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f0b68a0>]}
[0m22:04:27.848274 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m22:04:27.849710 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m22:04:27.858524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1f3fe262-5359-43c6-8be8-f4a49ab74496', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ed848f0>]}
[0m22:04:27.858799 [info ] [MainThread]: Found 7 models, 3 sources, 636 macros
[0m22:04:27.859041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1f3fe262-5359-43c6-8be8-f4a49ab74496', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f241970>]}
[0m22:04:27.860109 [info ] [MainThread]: 
[0m22:04:27.860322 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:04:27.860688 [info ] [MainThread]: 
[0m22:04:27.861330 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:04:27.864077 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRADE_FLOW'
[0m22:04:27.870144 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRADE_FLOW'
[0m22:04:27.871637 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRADE_FLOW'
[0m22:04:27.894221 [debug] [ThreadPool]: Using snowflake connection "list_TRADE_FLOW"
[0m22:04:27.894538 [debug] [ThreadPool]: Using snowflake connection "list_TRADE_FLOW"
[0m22:04:27.894739 [debug] [ThreadPool]: Using snowflake connection "list_TRADE_FLOW"
[0m22:04:27.894900 [debug] [ThreadPool]: On list_TRADE_FLOW: show terse schemas in database TRADE_FLOW
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRADE_FLOW"} */
[0m22:04:27.895119 [debug] [ThreadPool]: On list_TRADE_FLOW: show terse schemas in database TRADE_FLOW
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRADE_FLOW"} */
[0m22:04:27.895324 [debug] [ThreadPool]: On list_TRADE_FLOW: show terse schemas in database TRADE_FLOW
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRADE_FLOW"} */
[0m22:04:27.895522 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:04:27.895713 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:04:27.895907 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:04:29.507093 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.611 seconds
[0m22:04:29.524567 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.629 seconds
[0m22:04:29.528836 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.633 seconds
[0m22:04:29.531597 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRADE_FLOW, now list_TRADE_FLOW_staging)
[0m22:04:29.538299 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRADE_FLOW, now list_TRADE_FLOW_marts)
[0m22:04:29.547530 [debug] [ThreadPool]: Using snowflake connection "list_TRADE_FLOW_marts"
[0m22:04:29.548229 [debug] [ThreadPool]: Using snowflake connection "list_TRADE_FLOW_staging"
[0m22:04:29.548596 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRADE_FLOW, now list_TRADE_FLOW_analytics)
[0m22:04:29.548869 [debug] [ThreadPool]: On list_TRADE_FLOW_marts: show objects in TRADE_FLOW.marts
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRADE_FLOW_marts"} */;
[0m22:04:29.549241 [debug] [ThreadPool]: On list_TRADE_FLOW_staging: show objects in TRADE_FLOW.staging
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRADE_FLOW_staging"} */;
[0m22:04:29.551461 [debug] [ThreadPool]: Using snowflake connection "list_TRADE_FLOW_analytics"
[0m22:04:29.554352 [debug] [ThreadPool]: On list_TRADE_FLOW_analytics: show objects in TRADE_FLOW.analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRADE_FLOW_analytics"} */;
[0m22:04:29.652656 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.100 seconds
[0m22:04:29.658201 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.106 seconds
[0m22:04:29.662475 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.107 seconds
[0m22:04:29.664778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1f3fe262-5359-43c6-8be8-f4a49ab74496', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f4f23c0>]}
[0m22:04:29.668516 [debug] [Thread-1 (]: Began running node model.citrus_trade.stg_trade
[0m22:04:29.669182 [info ] [Thread-1 (]: 1 of 7 START sql table model staging.stg_trade ................................. [RUN]
[0m22:04:29.669780 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_TRADE_FLOW_analytics, now model.citrus_trade.stg_trade)
[0m22:04:29.670390 [debug] [Thread-1 (]: Began compiling node model.citrus_trade.stg_trade
[0m22:04:29.678837 [debug] [Thread-1 (]: Writing injected SQL for node "model.citrus_trade.stg_trade"
[0m22:04:29.680644 [debug] [Thread-1 (]: Began executing node model.citrus_trade.stg_trade
[0m22:04:29.707693 [debug] [Thread-1 (]: Writing runtime sql for node "model.citrus_trade.stg_trade"
[0m22:04:29.709580 [debug] [Thread-1 (]: Using snowflake connection "model.citrus_trade.stg_trade"
[0m22:04:29.709894 [debug] [Thread-1 (]: On model.citrus_trade.stg_trade: create or replace transient table TRADE_FLOW.staging.stg_trade
    
    
    
    as (select
  value:DECLARANT::int as declarant,
  value:DECLARANT_ISO::string as declarant_iso,
  value:PARTNER::string as partner,
  value:PARTNER_ISO::string as partner_iso,
  value:FLOW::int as flow,
  value:TRANSPORT_MODE::int as transport_mode,
  value:PERIOD::int as period,
  year(to_date(left(period,4),'YYYY')) as year,
  value:HS4::string as hs4,
  value:HS4_NAME::string as hs4_name,
  value:HS6::string as hs6,
  value:HS6_NAME::string as hs6_name,
  value:VALUE_IN_EUROS::float as value_in_euros,
  value:QUANTITY_IN_KG::float as quantity_in_kg
from trade_flow.raw.raw_trhs
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.stg_trade"} */;
[0m22:04:30.417922 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.708 seconds
[0m22:04:30.439279 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f3fe262-5359-43c6-8be8-f4a49ab74496', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3425820>]}
[0m22:04:30.440025 [info ] [Thread-1 (]: 1 of 7 OK created sql table model staging.stg_trade ............................ [[32mSUCCESS 1[0m in 0.77s]
[0m22:04:30.440720 [debug] [Thread-1 (]: Finished running node model.citrus_trade.stg_trade
[0m22:04:30.441647 [debug] [Thread-3 (]: Began running node model.citrus_trade.trade_by_hs
[0m22:04:30.442184 [info ] [Thread-3 (]: 2 of 7 START sql table model marts.trade_by_hs ................................. [RUN]
[0m22:04:30.442756 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_TRADE_FLOW_staging, now model.citrus_trade.trade_by_hs)
[0m22:04:30.443168 [debug] [Thread-3 (]: Began compiling node model.citrus_trade.trade_by_hs
[0m22:04:30.447085 [debug] [Thread-3 (]: Writing injected SQL for node "model.citrus_trade.trade_by_hs"
[0m22:04:30.448451 [debug] [Thread-3 (]: Began executing node model.citrus_trade.trade_by_hs
[0m22:04:30.450638 [debug] [Thread-3 (]: Writing runtime sql for node "model.citrus_trade.trade_by_hs"
[0m22:04:30.451628 [debug] [Thread-3 (]: Using snowflake connection "model.citrus_trade.trade_by_hs"
[0m22:04:30.451922 [debug] [Thread-3 (]: On model.citrus_trade.trade_by_hs: create or replace transient table TRADE_FLOW.marts.trade_by_hs
    
    
    
    as (select
    *
from TRADE_FLOW.staging.stg_trade
where hs6 = '080510'
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.trade_by_hs"} */;
[0m22:04:31.088498 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.634 seconds
[0m22:04:31.093801 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f3fe262-5359-43c6-8be8-f4a49ab74496', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d578950>]}
[0m22:04:31.095143 [info ] [Thread-3 (]: 2 of 7 OK created sql table model marts.trade_by_hs ............................ [[32mSUCCESS 1[0m in 0.65s]
[0m22:04:31.096690 [debug] [Thread-3 (]: Finished running node model.citrus_trade.trade_by_hs
[0m22:04:31.098647 [debug] [Thread-2 (]: Began running node model.citrus_trade.imports_by_year
[0m22:04:31.099266 [debug] [Thread-1 (]: Began running node model.citrus_trade.imports_exports_2020
[0m22:04:31.099879 [info ] [Thread-2 (]: 3 of 7 START sql table model marts.imports_by_year ............................. [RUN]
[0m22:04:31.100802 [info ] [Thread-1 (]: 4 of 7 START sql table model marts.imports_exports_2020 ........................ [RUN]
[0m22:04:31.102536 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.citrus_trade.stg_trade, now model.citrus_trade.imports_exports_2020)
[0m22:04:31.103167 [debug] [Thread-1 (]: Began compiling node model.citrus_trade.imports_exports_2020
[0m22:04:31.101739 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_TRADE_FLOW_marts, now model.citrus_trade.imports_by_year)
[0m22:04:31.108196 [debug] [Thread-1 (]: Writing injected SQL for node "model.citrus_trade.imports_exports_2020"
[0m22:04:31.109076 [debug] [Thread-2 (]: Began compiling node model.citrus_trade.imports_by_year
[0m22:04:31.113444 [debug] [Thread-2 (]: Writing injected SQL for node "model.citrus_trade.imports_by_year"
[0m22:04:31.114620 [debug] [Thread-1 (]: Began executing node model.citrus_trade.imports_exports_2020
[0m22:04:31.117688 [debug] [Thread-1 (]: Writing runtime sql for node "model.citrus_trade.imports_exports_2020"
[0m22:04:31.118719 [debug] [Thread-2 (]: Began executing node model.citrus_trade.imports_by_year
[0m22:04:31.121385 [debug] [Thread-2 (]: Writing runtime sql for node "model.citrus_trade.imports_by_year"
[0m22:04:31.123300 [debug] [Thread-1 (]: Using snowflake connection "model.citrus_trade.imports_exports_2020"
[0m22:04:31.125468 [debug] [Thread-1 (]: On model.citrus_trade.imports_exports_2020: create or replace transient table TRADE_FLOW.marts.imports_exports_2020
    
    
    
    as (select
    declarant_iso,
    flow,
    sum(value) over(partition by declarant_iso, flow) as total_value,
    sum(quantity) over(partition by declarant_iso, flow) as total_quantity,
    total_value/nullif(total_quantity,0) as value_per_quantity
from TRADE_FLOW.marts.trade_by_hs
where year = 2020
group by 
    declarant_iso,
    flow,
    value,
    quantity
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.imports_exports_2020"} */;
[0m22:04:31.129355 [debug] [Thread-2 (]: Using snowflake connection "model.citrus_trade.imports_by_year"
[0m22:04:31.129890 [debug] [Thread-2 (]: On model.citrus_trade.imports_by_year: create or replace transient table TRADE_FLOW.marts.imports_by_year
    
    
    
    as (select
    declarant_iso,
    year,
    sum(value) as total_value,
    sum(quantity) as total_quantity,
    total_value/nullif(total_quantity,0) as value_per_quantity
from TRADE_FLOW.marts.trade_by_hs
where flow = 1
group by 1,2
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.imports_by_year"} */;
[0m22:04:31.267535 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01c03d8c-0105-74a0-0004-20ca00024d3e
[0m22:04:31.270010 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 8 at position 8
invalid identifier 'VALUE'
[0m22:04:31.269642 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01c03d8c-0105-74a0-0004-20ca00024d3a
[0m22:04:31.272190 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 8 at position 8
invalid identifier 'VALUE'
[0m22:04:31.276324 [debug] [Thread-1 (]: Database Error in model imports_exports_2020 (models/marts/imports_exports_2020.sql)
  000904 (42000): SQL compilation error: error line 8 at position 8
  invalid identifier 'VALUE'
  compiled code at target/run/citrus_trade/models/marts/imports_exports_2020.sql
[0m22:04:31.277203 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f3fe262-5359-43c6-8be8-f4a49ab74496', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ed78740>]}
[0m22:04:31.279166 [debug] [Thread-2 (]: Database Error in model imports_by_year (models/marts/imports_by_year.sql)
  000904 (42000): SQL compilation error: error line 8 at position 8
  invalid identifier 'VALUE'
  compiled code at target/run/citrus_trade/models/marts/imports_by_year.sql
[0m22:04:31.279933 [error] [Thread-1 (]: 4 of 7 ERROR creating sql table model marts.imports_exports_2020 ............... [[31mERROR[0m in 0.17s]
[0m22:04:31.281238 [debug] [Thread-1 (]: Finished running node model.citrus_trade.imports_exports_2020
[0m22:04:31.280568 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f3fe262-5359-43c6-8be8-f4a49ab74496', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d55dc70>]}
[0m22:04:31.281830 [debug] [Thread-7 (]: Marking all children of 'model.citrus_trade.imports_exports_2020' to be skipped because of status 'error'.  Reason: Database Error in model imports_exports_2020 (models/marts/imports_exports_2020.sql)
  000904 (42000): SQL compilation error: error line 8 at position 8
  invalid identifier 'VALUE'
  compiled code at target/run/citrus_trade/models/marts/imports_exports_2020.sql.
[0m22:04:31.282361 [error] [Thread-2 (]: 3 of 7 ERROR creating sql table model marts.imports_by_year .................... [[31mERROR[0m in 0.18s]
[0m22:04:31.284084 [debug] [Thread-2 (]: Finished running node model.citrus_trade.imports_by_year
[0m22:04:31.284439 [debug] [Thread-3 (]: Began running node model.citrus_trade.score_2020
[0m22:04:31.284963 [debug] [Thread-7 (]: Marking all children of 'model.citrus_trade.imports_by_year' to be skipped because of status 'error'.  Reason: Database Error in model imports_by_year (models/marts/imports_by_year.sql)
  000904 (42000): SQL compilation error: error line 8 at position 8
  invalid identifier 'VALUE'
  compiled code at target/run/citrus_trade/models/marts/imports_by_year.sql.
[0m22:04:31.285573 [info ] [Thread-3 (]: 5 of 7 SKIP relation marts.score_2020 .......................................... [[33mSKIP[0m]
[0m22:04:31.286388 [debug] [Thread-1 (]: Began running node model.citrus_trade.growth_score
[0m22:04:31.286759 [debug] [Thread-3 (]: Finished running node model.citrus_trade.score_2020
[0m22:04:31.287193 [info ] [Thread-1 (]: 6 of 7 SKIP relation marts.growth_score ........................................ [[33mSKIP[0m]
[0m22:04:31.287931 [debug] [Thread-1 (]: Finished running node model.citrus_trade.growth_score
[0m22:04:31.288725 [debug] [Thread-2 (]: Began running node model.citrus_trade.importer_trade_score
[0m22:04:31.289124 [info ] [Thread-2 (]: 7 of 7 SKIP relation analytics.importer_trade_score ............................ [[33mSKIP[0m]
[0m22:04:31.289534 [debug] [Thread-2 (]: Finished running node model.citrus_trade.importer_trade_score
[0m22:04:31.291348 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:04:31.291647 [debug] [MainThread]: Connection 'model.citrus_trade.trade_by_hs' was left open.
[0m22:04:31.291924 [debug] [MainThread]: On model.citrus_trade.trade_by_hs: Close
[0m22:04:31.430842 [debug] [MainThread]: Connection 'model.citrus_trade.imports_by_year' was left open.
[0m22:04:31.431880 [debug] [MainThread]: On model.citrus_trade.imports_by_year: Close
[0m22:04:31.557898 [debug] [MainThread]: Connection 'model.citrus_trade.imports_exports_2020' was left open.
[0m22:04:31.558862 [debug] [MainThread]: On model.citrus_trade.imports_exports_2020: Close
[0m22:04:31.733568 [info ] [MainThread]: 
[0m22:04:31.734805 [info ] [MainThread]: Finished running 7 table models in 0 hours 0 minutes and 3.87 seconds (3.87s).
[0m22:04:31.738186 [debug] [MainThread]: Command end result
[0m22:04:31.794977 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m22:04:31.797678 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m22:04:31.803620 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/target/run_results.json
[0m22:04:31.803889 [info ] [MainThread]: 
[0m22:04:31.804194 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m22:04:31.804473 [info ] [MainThread]: 
[0m22:04:31.804999 [error] [MainThread]: [31mFailure in model imports_exports_2020 (models/marts/imports_exports_2020.sql)[0m
[0m22:04:31.805377 [error] [MainThread]:   Database Error in model imports_exports_2020 (models/marts/imports_exports_2020.sql)
  000904 (42000): SQL compilation error: error line 8 at position 8
  invalid identifier 'VALUE'
  compiled code at target/run/citrus_trade/models/marts/imports_exports_2020.sql
[0m22:04:31.805687 [info ] [MainThread]: 
[0m22:04:31.806021 [info ] [MainThread]:   compiled code at target/compiled/citrus_trade/models/marts/imports_exports_2020.sql
[0m22:04:31.806250 [info ] [MainThread]: 
[0m22:04:31.806705 [error] [MainThread]: [31mFailure in model imports_by_year (models/marts/imports_by_year.sql)[0m
[0m22:04:31.807081 [error] [MainThread]:   Database Error in model imports_by_year (models/marts/imports_by_year.sql)
  000904 (42000): SQL compilation error: error line 8 at position 8
  invalid identifier 'VALUE'
  compiled code at target/run/citrus_trade/models/marts/imports_by_year.sql
[0m22:04:31.807566 [info ] [MainThread]: 
[0m22:04:31.808098 [info ] [MainThread]:   compiled code at target/compiled/citrus_trade/models/marts/imports_by_year.sql
[0m22:04:31.808515 [info ] [MainThread]: 
[0m22:04:31.809021 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=2 SKIP=3 NO-OP=0 TOTAL=7
[0m22:04:31.810442 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 4.5900903, "process_in_blocks": "208", "process_kernel_time": 0.327129, "process_mem_max_rss": "151496", "process_out_blocks": "4216", "process_user_time": 1.739687}
[0m22:04:31.810932 [debug] [MainThread]: Command `dbt run` failed at 22:04:31.810817 after 4.59 seconds
[0m22:04:31.811234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa59fa8a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa28ceae0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d1102f0>]}
[0m22:04:31.811512 [debug] [MainThread]: Flushing usage events
[0m22:04:33.065886 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:05:44.886591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb95b42c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb9204e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbad3d220>]}


============================== 22:05:44.889551 | 5e8f1751-33a0-4349-b626-e101f9371089 ==============================
[0m22:05:44.889551 [info ] [MainThread]: Running with dbt=1.10.13
[0m22:05:44.889990 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'introspect': 'True', 'no_print': 'None', 'quiet': 'False', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'log_path': '/opt/airflow/dbt/logs', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'partial_parse': 'True', 'profiles_dir': '/opt/airflow/dbt', 'printer_width': '80', 'fail_fast': 'False', 'debug': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_format': 'default', 'static_parser': 'True', 'warn_error': 'None', 'use_colors': 'True', 'version_check': 'True'}
[0m22:05:45.026696 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m22:05:45.027112 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m22:05:45.027295 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m22:05:45.131081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5e8f1751-33a0-4349-b626-e101f9371089', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7787170>]}
[0m22:05:45.161654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5e8f1751-33a0-4349-b626-e101f9371089', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8a9e270>]}
[0m22:05:45.162165 [info ] [MainThread]: Registered adapter: snowflake=1.10.3
[0m22:05:45.219595 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m22:05:45.339355 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m22:05:45.339759 [debug] [MainThread]: Partial parsing: updated file: citrus_trade://models/marts/imports_by_year.sql
[0m22:05:45.339970 [debug] [MainThread]: Partial parsing: updated file: citrus_trade://models/marts/imports_exports_2020.sql
[0m22:05:45.519045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5e8f1751-33a0-4349-b626-e101f9371089', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6f9e9c0>]}
[0m22:05:45.612340 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m22:05:45.614706 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m22:05:45.624865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5e8f1751-33a0-4349-b626-e101f9371089', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6b60620>]}
[0m22:05:45.625181 [info ] [MainThread]: Found 7 models, 3 sources, 636 macros
[0m22:05:45.625418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5e8f1751-33a0-4349-b626-e101f9371089', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6bb6a50>]}
[0m22:05:45.626595 [info ] [MainThread]: 
[0m22:05:45.626858 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:05:45.627113 [info ] [MainThread]: 
[0m22:05:45.627523 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:05:45.630188 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRADE_FLOW'
[0m22:05:45.636714 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRADE_FLOW'
[0m22:05:45.638658 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRADE_FLOW'
[0m22:05:45.667491 [debug] [ThreadPool]: Using snowflake connection "list_TRADE_FLOW"
[0m22:05:45.667826 [debug] [ThreadPool]: Using snowflake connection "list_TRADE_FLOW"
[0m22:05:45.668052 [debug] [ThreadPool]: Using snowflake connection "list_TRADE_FLOW"
[0m22:05:45.668203 [debug] [ThreadPool]: On list_TRADE_FLOW: show terse schemas in database TRADE_FLOW
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRADE_FLOW"} */
[0m22:05:45.668902 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:05:45.668704 [debug] [ThreadPool]: On list_TRADE_FLOW: show terse schemas in database TRADE_FLOW
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRADE_FLOW"} */
[0m22:05:45.668471 [debug] [ThreadPool]: On list_TRADE_FLOW: show terse schemas in database TRADE_FLOW
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRADE_FLOW"} */
[0m22:05:45.671489 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:05:45.673440 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:05:47.201391 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.530 seconds
[0m22:05:47.245779 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.577 seconds
[0m22:05:47.284487 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.611 seconds
[0m22:05:47.286785 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRADE_FLOW, now list_TRADE_FLOW_staging)
[0m22:05:47.293185 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRADE_FLOW, now list_TRADE_FLOW_analytics)
[0m22:05:47.299721 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRADE_FLOW, now list_TRADE_FLOW_marts)
[0m22:05:47.302705 [debug] [ThreadPool]: Using snowflake connection "list_TRADE_FLOW_staging"
[0m22:05:47.303637 [debug] [ThreadPool]: Using snowflake connection "list_TRADE_FLOW_analytics"
[0m22:05:47.305047 [debug] [ThreadPool]: Using snowflake connection "list_TRADE_FLOW_marts"
[0m22:05:47.305354 [debug] [ThreadPool]: On list_TRADE_FLOW_staging: show objects in TRADE_FLOW.staging
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRADE_FLOW_staging"} */;
[0m22:05:47.306490 [debug] [ThreadPool]: On list_TRADE_FLOW_analytics: show objects in TRADE_FLOW.analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRADE_FLOW_analytics"} */;
[0m22:05:47.306715 [debug] [ThreadPool]: On list_TRADE_FLOW_marts: show objects in TRADE_FLOW.marts
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRADE_FLOW_marts"} */;
[0m22:05:47.423422 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.112 seconds
[0m22:05:47.451629 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.142 seconds
[0m22:05:47.479305 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.172 seconds
[0m22:05:47.482156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5e8f1751-33a0-4349-b626-e101f9371089', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb73f80b0>]}
[0m22:05:47.486144 [debug] [Thread-1 (]: Began running node model.citrus_trade.stg_trade
[0m22:05:47.486683 [info ] [Thread-1 (]: 1 of 7 START sql table model staging.stg_trade ................................. [RUN]
[0m22:05:47.487767 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_TRADE_FLOW_staging, now model.citrus_trade.stg_trade)
[0m22:05:47.491775 [debug] [Thread-1 (]: Began compiling node model.citrus_trade.stg_trade
[0m22:05:47.499896 [debug] [Thread-1 (]: Writing injected SQL for node "model.citrus_trade.stg_trade"
[0m22:05:47.501477 [debug] [Thread-1 (]: Began executing node model.citrus_trade.stg_trade
[0m22:05:47.532739 [debug] [Thread-1 (]: Writing runtime sql for node "model.citrus_trade.stg_trade"
[0m22:05:47.534688 [debug] [Thread-1 (]: Using snowflake connection "model.citrus_trade.stg_trade"
[0m22:05:47.534977 [debug] [Thread-1 (]: On model.citrus_trade.stg_trade: create or replace transient table TRADE_FLOW.staging.stg_trade
    
    
    
    as (select
  value:DECLARANT::int as declarant,
  value:DECLARANT_ISO::string as declarant_iso,
  value:PARTNER::string as partner,
  value:PARTNER_ISO::string as partner_iso,
  value:FLOW::int as flow,
  value:TRANSPORT_MODE::int as transport_mode,
  value:PERIOD::int as period,
  year(to_date(left(period,4),'YYYY')) as year,
  value:HS4::string as hs4,
  value:HS4_NAME::string as hs4_name,
  value:HS6::string as hs6,
  value:HS6_NAME::string as hs6_name,
  value:VALUE_IN_EUROS::float as value_in_euros,
  value:QUANTITY_IN_KG::float as quantity_in_kg
from trade_flow.raw.raw_trhs
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.stg_trade"} */;
[0m22:05:48.346064 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.811 seconds
[0m22:05:48.363487 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5e8f1751-33a0-4349-b626-e101f9371089', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbb2adbe0>]}
[0m22:05:48.364305 [info ] [Thread-1 (]: 1 of 7 OK created sql table model staging.stg_trade ............................ [[32mSUCCESS 1[0m in 0.88s]
[0m22:05:48.365103 [debug] [Thread-1 (]: Finished running node model.citrus_trade.stg_trade
[0m22:05:48.366646 [debug] [Thread-3 (]: Began running node model.citrus_trade.trade_by_hs
[0m22:05:48.367130 [info ] [Thread-3 (]: 2 of 7 START sql table model marts.trade_by_hs ................................. [RUN]
[0m22:05:48.367742 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_TRADE_FLOW_marts, now model.citrus_trade.trade_by_hs)
[0m22:05:48.368068 [debug] [Thread-3 (]: Began compiling node model.citrus_trade.trade_by_hs
[0m22:05:48.370726 [debug] [Thread-3 (]: Writing injected SQL for node "model.citrus_trade.trade_by_hs"
[0m22:05:48.372957 [debug] [Thread-3 (]: Began executing node model.citrus_trade.trade_by_hs
[0m22:05:48.376622 [debug] [Thread-3 (]: Writing runtime sql for node "model.citrus_trade.trade_by_hs"
[0m22:05:48.377808 [debug] [Thread-3 (]: Using snowflake connection "model.citrus_trade.trade_by_hs"
[0m22:05:48.378072 [debug] [Thread-3 (]: On model.citrus_trade.trade_by_hs: create or replace transient table TRADE_FLOW.marts.trade_by_hs
    
    
    
    as (select
    *
from TRADE_FLOW.staging.stg_trade
where hs6 = '080510'
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.trade_by_hs"} */;
[0m22:05:49.164925 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.786 seconds
[0m22:05:49.167567 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5e8f1751-33a0-4349-b626-e101f9371089', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4968050>]}
[0m22:05:49.168419 [info ] [Thread-3 (]: 2 of 7 OK created sql table model marts.trade_by_hs ............................ [[32mSUCCESS 1[0m in 0.80s]
[0m22:05:49.169452 [debug] [Thread-3 (]: Finished running node model.citrus_trade.trade_by_hs
[0m22:05:49.170743 [debug] [Thread-2 (]: Began running node model.citrus_trade.imports_by_year
[0m22:05:49.171490 [info ] [Thread-2 (]: 3 of 7 START sql table model marts.imports_by_year ............................. [RUN]
[0m22:05:49.171988 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_TRADE_FLOW_analytics, now model.citrus_trade.imports_by_year)
[0m22:05:49.171162 [debug] [Thread-1 (]: Began running node model.citrus_trade.imports_exports_2020
[0m22:05:49.173232 [info ] [Thread-1 (]: 4 of 7 START sql table model marts.imports_exports_2020 ........................ [RUN]
[0m22:05:49.173656 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.citrus_trade.stg_trade, now model.citrus_trade.imports_exports_2020)
[0m22:05:49.173996 [debug] [Thread-1 (]: Began compiling node model.citrus_trade.imports_exports_2020
[0m22:05:49.172559 [debug] [Thread-2 (]: Began compiling node model.citrus_trade.imports_by_year
[0m22:05:49.179724 [debug] [Thread-2 (]: Writing injected SQL for node "model.citrus_trade.imports_by_year"
[0m22:05:49.177264 [debug] [Thread-1 (]: Writing injected SQL for node "model.citrus_trade.imports_exports_2020"
[0m22:05:49.181817 [debug] [Thread-2 (]: Began executing node model.citrus_trade.imports_by_year
[0m22:05:49.185105 [debug] [Thread-2 (]: Writing runtime sql for node "model.citrus_trade.imports_by_year"
[0m22:05:49.185709 [debug] [Thread-1 (]: Began executing node model.citrus_trade.imports_exports_2020
[0m22:05:49.188597 [debug] [Thread-1 (]: Writing runtime sql for node "model.citrus_trade.imports_exports_2020"
[0m22:05:49.190865 [debug] [Thread-2 (]: Using snowflake connection "model.citrus_trade.imports_by_year"
[0m22:05:49.191542 [debug] [Thread-2 (]: On model.citrus_trade.imports_by_year: create or replace transient table TRADE_FLOW.marts.imports_by_year
    
    
    
    as (select
    declarant_iso,
    year,
    sum(value_in_euros) as total_value,
    sum(quantity_in_kg) as total_quantity,
    total_value/nullif(total_quantity,0) as value_per_quantity
from TRADE_FLOW.marts.trade_by_hs
where flow = 1
group by 1,2
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.imports_by_year"} */;
[0m22:05:49.192192 [debug] [Thread-1 (]: Using snowflake connection "model.citrus_trade.imports_exports_2020"
[0m22:05:49.194107 [debug] [Thread-1 (]: On model.citrus_trade.imports_exports_2020: create or replace transient table TRADE_FLOW.marts.imports_exports_2020
    
    
    
    as (select
    declarant_iso,
    flow,
    sum(value_in_euros) over(partition by declarant_iso, flow) as total_value,
    sum(quantity_in_kg) over(partition by declarant_iso, flow) as total_quantity,
    total_value/nullif(total_quantity,0) as value_per_quantity
from TRADE_FLOW.marts.trade_by_hs
where year = 2020
group by 
    declarant_iso,
    flow,
    value,
    quantity
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.imports_exports_2020"} */;
[0m22:05:49.299155 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01c03d8d-0105-74a0-0004-20ca00024d6a
[0m22:05:49.299735 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 16 at position 4
invalid identifier 'VALUE'
[0m22:05:49.302591 [debug] [Thread-1 (]: Database Error in model imports_exports_2020 (models/marts/imports_exports_2020.sql)
  000904 (42000): SQL compilation error: error line 16 at position 4
  invalid identifier 'VALUE'
  compiled code at target/run/citrus_trade/models/marts/imports_exports_2020.sql
[0m22:05:49.304578 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5e8f1751-33a0-4349-b626-e101f9371089', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4948560>]}
[0m22:05:49.305383 [error] [Thread-1 (]: 4 of 7 ERROR creating sql table model marts.imports_exports_2020 ............... [[31mERROR[0m in 0.13s]
[0m22:05:49.306205 [debug] [Thread-1 (]: Finished running node model.citrus_trade.imports_exports_2020
[0m22:05:49.307085 [debug] [Thread-7 (]: Marking all children of 'model.citrus_trade.imports_exports_2020' to be skipped because of status 'error'.  Reason: Database Error in model imports_exports_2020 (models/marts/imports_exports_2020.sql)
  000904 (42000): SQL compilation error: error line 16 at position 4
  invalid identifier 'VALUE'
  compiled code at target/run/citrus_trade/models/marts/imports_exports_2020.sql.
[0m22:05:49.308495 [debug] [Thread-3 (]: Began running node model.citrus_trade.score_2020
[0m22:05:49.308920 [info ] [Thread-3 (]: 5 of 7 SKIP relation marts.score_2020 .......................................... [[33mSKIP[0m]
[0m22:05:49.309664 [debug] [Thread-3 (]: Finished running node model.citrus_trade.score_2020
[0m22:05:49.849134 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.656 seconds
[0m22:05:49.854769 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5e8f1751-33a0-4349-b626-e101f9371089', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4924200>]}
[0m22:05:49.856740 [info ] [Thread-2 (]: 3 of 7 OK created sql table model marts.imports_by_year ........................ [[32mSUCCESS 1[0m in 0.68s]
[0m22:05:49.859032 [debug] [Thread-2 (]: Finished running node model.citrus_trade.imports_by_year
[0m22:05:49.861568 [debug] [Thread-1 (]: Began running node model.citrus_trade.growth_score
[0m22:05:49.862292 [info ] [Thread-1 (]: 6 of 7 START sql table model marts.growth_score ................................ [RUN]
[0m22:05:49.862875 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.citrus_trade.imports_exports_2020, now model.citrus_trade.growth_score)
[0m22:05:49.863322 [debug] [Thread-1 (]: Began compiling node model.citrus_trade.growth_score
[0m22:05:49.867955 [debug] [Thread-1 (]: Writing injected SQL for node "model.citrus_trade.growth_score"
[0m22:05:49.870013 [debug] [Thread-1 (]: Began executing node model.citrus_trade.growth_score
[0m22:05:49.874891 [debug] [Thread-1 (]: Writing runtime sql for node "model.citrus_trade.growth_score"
[0m22:05:49.879158 [debug] [Thread-1 (]: Using snowflake connection "model.citrus_trade.growth_score"
[0m22:05:49.879834 [debug] [Thread-1 (]: On model.citrus_trade.growth_score: create or replace transient table TRADE_FLOW.marts.growth_score
    
    
    
    as (with 
    previous_year AS (
        select 
            declarant_iso,
            year,
            lag(total_value,1) over(partition by declarant_iso order by year) previous_year_value,
            total_value,
            first_value(total_value) over(partition by declarant_iso order by year) as first_year_value,
            last_value(total_value) over(partition by declarant_iso order by year) as last_year_value
        from TRADE_FLOW.marts.imports_by_year
    ),
    growth_speed AS (
        select 
            declarant_iso,
            year,
            first_year_value,
            last_year_value,
            last_year_value/nullif(first_year_value,0) as growth_overall,
            previous_year_value,
            total_value,
            (total_value - previous_year_value)/total_value * 100 as growth_speed 
        from previous_year
    ),
    previous_year_growth_speed AS (
        select 
            declarant_iso,
            year,
            first_year_value,
            last_year_value,
            growth_overall,
            previous_year_value,
            total_value as current_value,
            growth_speed,
            lag(growth_speed,1) over(partition by declarant_iso order by year) previous_year_growth_speed,
        from growth_speed
        order by 1,2
    ),
    base AS (
        select 
            declarant_iso,
            year,
            first_year_value,
            last_year_value,
            growth_overall,
            previous_year_value,
            current_value,
            previous_year_growth_speed,
            growth_speed,
            growth_speed - previous_year_growth_speed as growth_acceleration,
            avg(growth_acceleration) over(partition by declarant_iso) as avg_acceleration
        from previous_year_growth_speed
    ),
    ok as (
        select 
            declarant_iso,
            year,
            first_year_value,
            last_year_value,
            growth_overall,
            (growth_overall - min(growth_overall) OVER())/(max(growth_overall) OVER() - min(growth_overall) OVER()) as growth_overall_norm,
            previous_year_value,
            current_value,
            -- previous_year_growth_speed,
            growth_speed,
            growth_acceleration,
            avg_acceleration,
            (avg_acceleration - min(avg_acceleration) OVER())/(max(avg_acceleration) OVER() - min(avg_acceleration) OVER()) as avg_acceleration_norm
        from base 
    )
    select 
        declarant_iso,
        year,
        current_value,
        growth_speed,
        growth_acceleration,
        growth_overall,
        growth_overall_norm,
        avg_acceleration,
        avg_acceleration_norm,
        growth_overall_norm * avg_acceleration_norm as growth_score
    from ok
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.growth_score"} */;
[0m22:05:50.906464 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.026 seconds
[0m22:05:50.911196 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5e8f1751-33a0-4349-b626-e101f9371089', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb49efaa0>]}
[0m22:05:50.912291 [info ] [Thread-1 (]: 6 of 7 OK created sql table model marts.growth_score ........................... [[32mSUCCESS 1[0m in 1.05s]
[0m22:05:50.913422 [debug] [Thread-1 (]: Finished running node model.citrus_trade.growth_score
[0m22:05:50.915114 [debug] [Thread-3 (]: Began running node model.citrus_trade.importer_trade_score
[0m22:05:50.915707 [info ] [Thread-3 (]: 7 of 7 SKIP relation analytics.importer_trade_score ............................ [[33mSKIP[0m]
[0m22:05:50.916324 [debug] [Thread-3 (]: Finished running node model.citrus_trade.importer_trade_score
[0m22:05:50.919213 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:05:50.919812 [debug] [MainThread]: Connection 'model.citrus_trade.imports_by_year' was left open.
[0m22:05:50.920259 [debug] [MainThread]: On model.citrus_trade.imports_by_year: Close
[0m22:05:51.075724 [debug] [MainThread]: Connection 'model.citrus_trade.growth_score' was left open.
[0m22:05:51.076389 [debug] [MainThread]: On model.citrus_trade.growth_score: Close
[0m22:05:51.264281 [debug] [MainThread]: Connection 'model.citrus_trade.trade_by_hs' was left open.
[0m22:05:51.264941 [debug] [MainThread]: On model.citrus_trade.trade_by_hs: Close
[0m22:05:51.441318 [info ] [MainThread]: 
[0m22:05:51.442733 [info ] [MainThread]: Finished running 7 table models in 0 hours 0 minutes and 5.81 seconds (5.81s).
[0m22:05:51.444296 [debug] [MainThread]: Command end result
[0m22:05:51.489120 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m22:05:51.502846 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m22:05:51.510994 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/target/run_results.json
[0m22:05:51.511273 [info ] [MainThread]: 
[0m22:05:51.511637 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m22:05:51.512114 [info ] [MainThread]: 
[0m22:05:51.512543 [error] [MainThread]: [31mFailure in model imports_exports_2020 (models/marts/imports_exports_2020.sql)[0m
[0m22:05:51.512868 [error] [MainThread]:   Database Error in model imports_exports_2020 (models/marts/imports_exports_2020.sql)
  000904 (42000): SQL compilation error: error line 16 at position 4
  invalid identifier 'VALUE'
  compiled code at target/run/citrus_trade/models/marts/imports_exports_2020.sql
[0m22:05:51.513090 [info ] [MainThread]: 
[0m22:05:51.513394 [info ] [MainThread]:   compiled code at target/compiled/citrus_trade/models/marts/imports_exports_2020.sql
[0m22:05:51.513826 [info ] [MainThread]: 
[0m22:05:51.514280 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=2 NO-OP=0 TOTAL=7
[0m22:05:51.517555 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 6.659921, "process_in_blocks": "0", "process_kernel_time": 0.407567, "process_mem_max_rss": "151668", "process_out_blocks": "4246", "process_user_time": 1.871379}
[0m22:05:51.518977 [debug] [MainThread]: Command `dbt run` failed at 22:05:51.518894 after 6.66 seconds
[0m22:05:51.519546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb98d8110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb678c200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbd7fa8a0>]}
[0m22:05:51.519804 [debug] [MainThread]: Flushing usage events
[0m22:05:52.832684 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:06:11.383089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92e35f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff926e80b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff926e8b60>]}


============================== 22:06:11.389395 | bfc8a772-1e1a-428a-8e84-0ffd9b643c07 ==============================
[0m22:06:11.389395 [info ] [MainThread]: Running with dbt=1.10.13
[0m22:06:11.389761 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_colors': 'True', 'introspect': 'True', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'cache_selected_only': 'False', 'quiet': 'False', 'use_experimental_parser': 'False', 'target_path': 'None', 'partial_parse': 'True', 'static_parser': 'True', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'empty': 'False', 'write_json': 'True', 'printer_width': '80', 'log_format': 'default', 'invocation_command': 'dbt run', 'fail_fast': 'False', 'warn_error': 'None', 'profiles_dir': '/opt/airflow/dbt'}
[0m22:06:11.544705 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m22:06:11.545157 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m22:06:11.545330 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m22:06:11.638554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bfc8a772-1e1a-428a-8e84-0ffd9b643c07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff908c13a0>]}
[0m22:06:11.669560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bfc8a772-1e1a-428a-8e84-0ffd9b643c07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90862ba0>]}
[0m22:06:11.670038 [info ] [MainThread]: Registered adapter: snowflake=1.10.3
[0m22:06:11.723885 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m22:06:11.847406 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:06:11.847812 [debug] [MainThread]: Partial parsing: updated file: citrus_trade://models/marts/imports_exports_2020.sql
[0m22:06:11.976669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bfc8a772-1e1a-428a-8e84-0ffd9b643c07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff907fb170>]}
[0m22:06:12.026775 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m22:06:12.028433 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m22:06:12.042181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bfc8a772-1e1a-428a-8e84-0ffd9b643c07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff902b4650>]}
[0m22:06:12.042543 [info ] [MainThread]: Found 7 models, 3 sources, 636 macros
[0m22:06:12.042876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bfc8a772-1e1a-428a-8e84-0ffd9b643c07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff905ef6e0>]}
[0m22:06:12.043940 [info ] [MainThread]: 
[0m22:06:12.044189 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:06:12.044447 [info ] [MainThread]: 
[0m22:06:12.044788 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:06:12.048161 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRADE_FLOW'
[0m22:06:12.054415 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRADE_FLOW'
[0m22:06:12.056927 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRADE_FLOW'
[0m22:06:12.083220 [debug] [ThreadPool]: Using snowflake connection "list_TRADE_FLOW"
[0m22:06:12.083536 [debug] [ThreadPool]: Using snowflake connection "list_TRADE_FLOW"
[0m22:06:12.083774 [debug] [ThreadPool]: Using snowflake connection "list_TRADE_FLOW"
[0m22:06:12.083960 [debug] [ThreadPool]: On list_TRADE_FLOW: show terse schemas in database TRADE_FLOW
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRADE_FLOW"} */
[0m22:06:12.084191 [debug] [ThreadPool]: On list_TRADE_FLOW: show terse schemas in database TRADE_FLOW
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRADE_FLOW"} */
[0m22:06:12.084397 [debug] [ThreadPool]: On list_TRADE_FLOW: show terse schemas in database TRADE_FLOW
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRADE_FLOW"} */
[0m22:06:12.084570 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:06:12.084751 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:06:12.084927 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:06:13.496501 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.411 seconds
[0m22:06:13.548302 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.463 seconds
[0m22:06:13.550750 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.466 seconds
[0m22:06:13.558032 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRADE_FLOW, now list_TRADE_FLOW_staging)
[0m22:06:13.564657 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRADE_FLOW, now list_TRADE_FLOW_marts)
[0m22:06:13.583441 [debug] [ThreadPool]: Using snowflake connection "list_TRADE_FLOW_staging"
[0m22:06:13.583890 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRADE_FLOW, now list_TRADE_FLOW_analytics)
[0m22:06:13.588638 [debug] [ThreadPool]: Using snowflake connection "list_TRADE_FLOW_marts"
[0m22:06:13.589005 [debug] [ThreadPool]: On list_TRADE_FLOW_staging: show objects in TRADE_FLOW.staging
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRADE_FLOW_staging"} */;
[0m22:06:13.591366 [debug] [ThreadPool]: Using snowflake connection "list_TRADE_FLOW_analytics"
[0m22:06:13.591824 [debug] [ThreadPool]: On list_TRADE_FLOW_marts: show objects in TRADE_FLOW.marts
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRADE_FLOW_marts"} */;
[0m22:06:13.593776 [debug] [ThreadPool]: On list_TRADE_FLOW_analytics: show objects in TRADE_FLOW.analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRADE_FLOW_analytics"} */;
[0m22:06:13.680659 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.088 seconds
[0m22:06:13.686088 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.092 seconds
[0m22:06:13.687041 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.092 seconds
[0m22:06:13.692760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bfc8a772-1e1a-428a-8e84-0ffd9b643c07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ff198b0>]}
[0m22:06:13.697324 [debug] [Thread-1 (]: Began running node model.citrus_trade.stg_trade
[0m22:06:13.698033 [info ] [Thread-1 (]: 1 of 7 START sql table model staging.stg_trade ................................. [RUN]
[0m22:06:13.698657 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_TRADE_FLOW_analytics, now model.citrus_trade.stg_trade)
[0m22:06:13.699229 [debug] [Thread-1 (]: Began compiling node model.citrus_trade.stg_trade
[0m22:06:13.708350 [debug] [Thread-1 (]: Writing injected SQL for node "model.citrus_trade.stg_trade"
[0m22:06:13.709926 [debug] [Thread-1 (]: Began executing node model.citrus_trade.stg_trade
[0m22:06:13.811445 [debug] [Thread-1 (]: Writing runtime sql for node "model.citrus_trade.stg_trade"
[0m22:06:13.813192 [debug] [Thread-1 (]: Using snowflake connection "model.citrus_trade.stg_trade"
[0m22:06:13.813447 [debug] [Thread-1 (]: On model.citrus_trade.stg_trade: create or replace transient table TRADE_FLOW.staging.stg_trade
    
    
    
    as (select
  value:DECLARANT::int as declarant,
  value:DECLARANT_ISO::string as declarant_iso,
  value:PARTNER::string as partner,
  value:PARTNER_ISO::string as partner_iso,
  value:FLOW::int as flow,
  value:TRANSPORT_MODE::int as transport_mode,
  value:PERIOD::int as period,
  year(to_date(left(period,4),'YYYY')) as year,
  value:HS4::string as hs4,
  value:HS4_NAME::string as hs4_name,
  value:HS6::string as hs6,
  value:HS6_NAME::string as hs6_name,
  value:VALUE_IN_EUROS::float as value_in_euros,
  value:QUANTITY_IN_KG::float as quantity_in_kg
from trade_flow.raw.raw_trhs
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.stg_trade"} */;
[0m22:06:14.666388 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.852 seconds
[0m22:06:14.703283 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bfc8a772-1e1a-428a-8e84-0ffd9b643c07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff946fd7c0>]}
[0m22:06:14.704363 [info ] [Thread-1 (]: 1 of 7 OK created sql table model staging.stg_trade ............................ [[32mSUCCESS 1[0m in 1.00s]
[0m22:06:14.705409 [debug] [Thread-1 (]: Finished running node model.citrus_trade.stg_trade
[0m22:06:14.706809 [debug] [Thread-3 (]: Began running node model.citrus_trade.trade_by_hs
[0m22:06:14.707469 [info ] [Thread-3 (]: 2 of 7 START sql table model marts.trade_by_hs ................................. [RUN]
[0m22:06:14.708101 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_TRADE_FLOW_staging, now model.citrus_trade.trade_by_hs)
[0m22:06:14.708517 [debug] [Thread-3 (]: Began compiling node model.citrus_trade.trade_by_hs
[0m22:06:14.712146 [debug] [Thread-3 (]: Writing injected SQL for node "model.citrus_trade.trade_by_hs"
[0m22:06:14.713534 [debug] [Thread-3 (]: Began executing node model.citrus_trade.trade_by_hs
[0m22:06:14.716164 [debug] [Thread-3 (]: Writing runtime sql for node "model.citrus_trade.trade_by_hs"
[0m22:06:14.717333 [debug] [Thread-3 (]: Using snowflake connection "model.citrus_trade.trade_by_hs"
[0m22:06:14.717659 [debug] [Thread-3 (]: On model.citrus_trade.trade_by_hs: create or replace transient table TRADE_FLOW.marts.trade_by_hs
    
    
    
    as (select
    *
from TRADE_FLOW.staging.stg_trade
where hs6 = '080510'
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.trade_by_hs"} */;
[0m22:06:15.383047 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.664 seconds
[0m22:06:15.388248 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bfc8a772-1e1a-428a-8e84-0ffd9b643c07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e75cb00>]}
[0m22:06:15.389507 [info ] [Thread-3 (]: 2 of 7 OK created sql table model marts.trade_by_hs ............................ [[32mSUCCESS 1[0m in 0.68s]
[0m22:06:15.390703 [debug] [Thread-3 (]: Finished running node model.citrus_trade.trade_by_hs
[0m22:06:15.392421 [debug] [Thread-2 (]: Began running node model.citrus_trade.imports_by_year
[0m22:06:15.393118 [debug] [Thread-1 (]: Began running node model.citrus_trade.imports_exports_2020
[0m22:06:15.393746 [info ] [Thread-2 (]: 3 of 7 START sql table model marts.imports_by_year ............................. [RUN]
[0m22:06:15.394701 [info ] [Thread-1 (]: 4 of 7 START sql table model marts.imports_exports_2020 ........................ [RUN]
[0m22:06:15.395621 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_TRADE_FLOW_marts, now model.citrus_trade.imports_by_year)
[0m22:06:15.396351 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.citrus_trade.stg_trade, now model.citrus_trade.imports_exports_2020)
[0m22:06:15.397044 [debug] [Thread-2 (]: Began compiling node model.citrus_trade.imports_by_year
[0m22:06:15.397652 [debug] [Thread-1 (]: Began compiling node model.citrus_trade.imports_exports_2020
[0m22:06:15.404547 [debug] [Thread-2 (]: Writing injected SQL for node "model.citrus_trade.imports_by_year"
[0m22:06:15.410280 [debug] [Thread-1 (]: Writing injected SQL for node "model.citrus_trade.imports_exports_2020"
[0m22:06:15.412310 [debug] [Thread-2 (]: Began executing node model.citrus_trade.imports_by_year
[0m22:06:15.415748 [debug] [Thread-2 (]: Writing runtime sql for node "model.citrus_trade.imports_by_year"
[0m22:06:15.416166 [debug] [Thread-1 (]: Began executing node model.citrus_trade.imports_exports_2020
[0m22:06:15.419199 [debug] [Thread-1 (]: Writing runtime sql for node "model.citrus_trade.imports_exports_2020"
[0m22:06:15.420887 [debug] [Thread-2 (]: Using snowflake connection "model.citrus_trade.imports_by_year"
[0m22:06:15.421786 [debug] [Thread-2 (]: On model.citrus_trade.imports_by_year: create or replace transient table TRADE_FLOW.marts.imports_by_year
    
    
    
    as (select
    declarant_iso,
    year,
    sum(value_in_euros) as total_value,
    sum(quantity_in_kg) as total_quantity,
    total_value/nullif(total_quantity,0) as value_per_quantity
from TRADE_FLOW.marts.trade_by_hs
where flow = 1
group by 1,2
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.imports_by_year"} */;
[0m22:06:15.423181 [debug] [Thread-1 (]: Using snowflake connection "model.citrus_trade.imports_exports_2020"
[0m22:06:15.424523 [debug] [Thread-1 (]: On model.citrus_trade.imports_exports_2020: create or replace transient table TRADE_FLOW.marts.imports_exports_2020
    
    
    
    as (select
    declarant_iso,
    flow,
    sum(value_in_euros) over(partition by declarant_iso, flow) as total_value,
    sum(quantity_in_kg) over(partition by declarant_iso, flow) as total_quantity,
    total_value/nullif(total_quantity,0) as value_per_quantity
from TRADE_FLOW.marts.trade_by_hs
where year = 2020
group by 
    declarant_iso,
    flow,
    value_in_euros,
    quantity_in_kg
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.imports_exports_2020"} */;
[0m22:06:16.101165 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.677 seconds
[0m22:06:16.102660 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.676 seconds
[0m22:06:16.108138 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bfc8a772-1e1a-428a-8e84-0ffd9b643c07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e737cb0>]}
[0m22:06:16.111260 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bfc8a772-1e1a-428a-8e84-0ffd9b643c07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e736a50>]}
[0m22:06:16.112624 [info ] [Thread-2 (]: 3 of 7 OK created sql table model marts.imports_by_year ........................ [[32mSUCCESS 1[0m in 0.71s]
[0m22:06:16.114227 [info ] [Thread-1 (]: 4 of 7 OK created sql table model marts.imports_exports_2020 ................... [[32mSUCCESS 1[0m in 0.71s]
[0m22:06:16.115810 [debug] [Thread-2 (]: Finished running node model.citrus_trade.imports_by_year
[0m22:06:16.116709 [debug] [Thread-1 (]: Finished running node model.citrus_trade.imports_exports_2020
[0m22:06:16.118696 [debug] [Thread-3 (]: Began running node model.citrus_trade.growth_score
[0m22:06:16.119279 [debug] [Thread-4 (]: Began running node model.citrus_trade.score_2020
[0m22:06:16.120054 [info ] [Thread-3 (]: 5 of 7 START sql table model marts.growth_score ................................ [RUN]
[0m22:06:16.121340 [info ] [Thread-4 (]: 6 of 7 START sql table model marts.score_2020 .................................. [RUN]
[0m22:06:16.122913 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.citrus_trade.trade_by_hs, now model.citrus_trade.growth_score)
[0m22:06:16.124672 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.citrus_trade.score_2020'
[0m22:06:16.126057 [debug] [Thread-3 (]: Began compiling node model.citrus_trade.growth_score
[0m22:06:16.126719 [debug] [Thread-4 (]: Began compiling node model.citrus_trade.score_2020
[0m22:06:16.132748 [debug] [Thread-3 (]: Writing injected SQL for node "model.citrus_trade.growth_score"
[0m22:06:16.138522 [debug] [Thread-4 (]: Writing injected SQL for node "model.citrus_trade.score_2020"
[0m22:06:16.143552 [debug] [Thread-3 (]: Began executing node model.citrus_trade.growth_score
[0m22:06:16.150909 [debug] [Thread-4 (]: Began executing node model.citrus_trade.score_2020
[0m22:06:16.150042 [debug] [Thread-3 (]: Writing runtime sql for node "model.citrus_trade.growth_score"
[0m22:06:16.154643 [debug] [Thread-4 (]: Writing runtime sql for node "model.citrus_trade.score_2020"
[0m22:06:16.162442 [debug] [Thread-4 (]: Using snowflake connection "model.citrus_trade.score_2020"
[0m22:06:16.163159 [debug] [Thread-4 (]: On model.citrus_trade.score_2020: create or replace transient table TRADE_FLOW.marts.score_2020
    
    
    
    as (select distinct 
    declarant_iso,
    total_value,
    total_quantity,
    value_per_quantity,
    (total_value - min(total_value) over())/((max(total_value) over())-(min(total_value) over())) as value_score,
    (total_quantity - min(total_quantity) over())/((max(total_quantity) over())-(min(total_quantity) over())) as quantity_score,
    (value_per_quantity - min(value_per_quantity) over())/((max(value_per_quantity) over())-(min(value_per_quantity) over())) as price_score
from TRADE_FLOW.marts.imports_exports_2020
where flow = 1
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.score_2020"} */;
[0m22:06:16.168322 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m22:06:16.167916 [debug] [Thread-3 (]: Using snowflake connection "model.citrus_trade.growth_score"
[0m22:06:16.172178 [debug] [Thread-3 (]: On model.citrus_trade.growth_score: create or replace transient table TRADE_FLOW.marts.growth_score
    
    
    
    as (with 
    previous_year AS (
        select 
            declarant_iso,
            year,
            lag(total_value,1) over(partition by declarant_iso order by year) previous_year_value,
            total_value,
            first_value(total_value) over(partition by declarant_iso order by year) as first_year_value,
            last_value(total_value) over(partition by declarant_iso order by year) as last_year_value
        from TRADE_FLOW.marts.imports_by_year
    ),
    growth_speed AS (
        select 
            declarant_iso,
            year,
            first_year_value,
            last_year_value,
            last_year_value/nullif(first_year_value,0) as growth_overall,
            previous_year_value,
            total_value,
            (total_value - previous_year_value)/total_value * 100 as growth_speed 
        from previous_year
    ),
    previous_year_growth_speed AS (
        select 
            declarant_iso,
            year,
            first_year_value,
            last_year_value,
            growth_overall,
            previous_year_value,
            total_value as current_value,
            growth_speed,
            lag(growth_speed,1) over(partition by declarant_iso order by year) previous_year_growth_speed,
        from growth_speed
        order by 1,2
    ),
    base AS (
        select 
            declarant_iso,
            year,
            first_year_value,
            last_year_value,
            growth_overall,
            previous_year_value,
            current_value,
            previous_year_growth_speed,
            growth_speed,
            growth_speed - previous_year_growth_speed as growth_acceleration,
            avg(growth_acceleration) over(partition by declarant_iso) as avg_acceleration
        from previous_year_growth_speed
    ),
    ok as (
        select 
            declarant_iso,
            year,
            first_year_value,
            last_year_value,
            growth_overall,
            (growth_overall - min(growth_overall) OVER())/(max(growth_overall) OVER() - min(growth_overall) OVER()) as growth_overall_norm,
            previous_year_value,
            current_value,
            -- previous_year_growth_speed,
            growth_speed,
            growth_acceleration,
            avg_acceleration,
            (avg_acceleration - min(avg_acceleration) OVER())/(max(avg_acceleration) OVER() - min(avg_acceleration) OVER()) as avg_acceleration_norm
        from base 
    )
    select 
        declarant_iso,
        year,
        current_value,
        growth_speed,
        growth_acceleration,
        growth_overall,
        growth_overall_norm,
        avg_acceleration,
        avg_acceleration_norm,
        growth_overall_norm * avg_acceleration_norm as growth_score
    from ok
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.growth_score"} */;
[0m22:06:17.237547 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.063 seconds
[0m22:06:17.242911 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bfc8a772-1e1a-428a-8e84-0ffd9b643c07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e7a3020>]}
[0m22:06:17.245481 [info ] [Thread-3 (]: 5 of 7 OK created sql table model marts.growth_score ........................... [[32mSUCCESS 1[0m in 1.12s]
[0m22:06:17.246511 [debug] [Thread-3 (]: Finished running node model.citrus_trade.growth_score
[0m22:06:18.303095 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 2.134 seconds
[0m22:06:18.307080 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bfc8a772-1e1a-428a-8e84-0ffd9b643c07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e72ec60>]}
[0m22:06:18.308140 [info ] [Thread-4 (]: 6 of 7 OK created sql table model marts.score_2020 ............................. [[32mSUCCESS 1[0m in 2.18s]
[0m22:06:18.309455 [debug] [Thread-4 (]: Finished running node model.citrus_trade.score_2020
[0m22:06:18.311118 [debug] [Thread-1 (]: Began running node model.citrus_trade.importer_trade_score
[0m22:06:18.311788 [info ] [Thread-1 (]: 7 of 7 START sql table model analytics.importer_trade_score .................... [RUN]
[0m22:06:18.312576 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.citrus_trade.imports_exports_2020, now model.citrus_trade.importer_trade_score)
[0m22:06:18.313087 [debug] [Thread-1 (]: Began compiling node model.citrus_trade.importer_trade_score
[0m22:06:18.318922 [debug] [Thread-1 (]: Writing injected SQL for node "model.citrus_trade.importer_trade_score"
[0m22:06:18.321376 [debug] [Thread-1 (]: Began executing node model.citrus_trade.importer_trade_score
[0m22:06:18.324404 [debug] [Thread-1 (]: Writing runtime sql for node "model.citrus_trade.importer_trade_score"
[0m22:06:18.326432 [debug] [Thread-1 (]: Using snowflake connection "model.citrus_trade.importer_trade_score"
[0m22:06:18.326798 [debug] [Thread-1 (]: On model.citrus_trade.importer_trade_score: create or replace transient table TRADE_FLOW.analytics.importer_trade_score
    
    
    
    as (select 
    sc.declarant_iso,
    sc.value_score,
    sc.quantity_score,
    sc.price_score,
    gs.growth_score
from TRADE_FLOW.marts.score_2020 as sc
inner join TRADE_FLOW.marts.growth_score as gs
    on gs.declarant_iso = sc.declarant_iso
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.importer_trade_score"} */;
[0m22:06:18.963428 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.636 seconds
[0m22:06:18.968776 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bfc8a772-1e1a-428a-8e84-0ffd9b643c07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e72c8c0>]}
[0m22:06:18.969839 [info ] [Thread-1 (]: 7 of 7 OK created sql table model analytics.importer_trade_score ............... [[32mSUCCESS 1[0m in 0.66s]
[0m22:06:18.970562 [debug] [Thread-1 (]: Finished running node model.citrus_trade.importer_trade_score
[0m22:06:18.974909 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:06:18.975712 [debug] [MainThread]: Connection 'model.citrus_trade.growth_score' was left open.
[0m22:06:18.976447 [debug] [MainThread]: On model.citrus_trade.growth_score: Close
[0m22:06:19.099480 [debug] [MainThread]: Connection 'model.citrus_trade.importer_trade_score' was left open.
[0m22:06:19.100509 [debug] [MainThread]: On model.citrus_trade.importer_trade_score: Close
[0m22:06:19.239618 [debug] [MainThread]: Connection 'model.citrus_trade.imports_by_year' was left open.
[0m22:06:19.240551 [debug] [MainThread]: On model.citrus_trade.imports_by_year: Close
[0m22:06:19.386107 [debug] [MainThread]: Connection 'model.citrus_trade.score_2020' was left open.
[0m22:06:19.386896 [debug] [MainThread]: On model.citrus_trade.score_2020: Close
[0m22:06:19.533369 [info ] [MainThread]: 
[0m22:06:19.534856 [info ] [MainThread]: Finished running 7 table models in 0 hours 0 minutes and 7.49 seconds (7.49s).
[0m22:06:19.538382 [debug] [MainThread]: Command end result
[0m22:06:19.591626 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m22:06:19.595126 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m22:06:19.602289 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/target/run_results.json
[0m22:06:19.602604 [info ] [MainThread]: 
[0m22:06:19.603042 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:06:19.603406 [info ] [MainThread]: 
[0m22:06:19.603764 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=7
[0m22:06:19.605880 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.2599745, "process_in_blocks": "0", "process_kernel_time": 0.431656, "process_mem_max_rss": "153440", "process_out_blocks": "4259", "process_user_time": 2.040189}
[0m22:06:19.606359 [debug] [MainThread]: Command `dbt run` succeeded at 22:06:19.606282 after 8.26 seconds
[0m22:06:19.606729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92185f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92f7eab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90421e50>]}
[0m22:06:19.607004 [debug] [MainThread]: Flushing usage events
[0m22:06:20.916615 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:09:50.343555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6871df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7a8d220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8f1f740>]}


============================== 22:09:50.346579 | 6fdb228f-74c5-4e4c-af11-e66163de5d50 ==============================
[0m22:09:50.346579 [info ] [MainThread]: Running with dbt=1.10.13
[0m22:09:50.346929 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'empty': 'False', 'log_format': 'default', 'write_json': 'True', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'static_parser': 'True', 'profiles_dir': '/opt/airflow/dbt', 'printer_width': '80', 'fail_fast': 'False', 'log_cache_events': 'False', 'log_path': '/opt/airflow/dbt/logs', 'no_print': 'None', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'indirect_selection': 'eager', 'partial_parse': 'True', 'use_colors': 'True'}
[0m22:09:50.486858 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m22:09:50.487334 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m22:09:50.487550 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m22:09:50.583305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6fdb228f-74c5-4e4c-af11-e66163de5d50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb51b4fe0>]}
[0m22:09:50.614320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6fdb228f-74c5-4e4c-af11-e66163de5d50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb52b2000>]}
[0m22:09:50.614793 [info ] [MainThread]: Registered adapter: snowflake=1.10.3
[0m22:09:50.668085 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m22:09:50.790189 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:09:50.790635 [debug] [MainThread]: Partial parsing: updated file: citrus_trade://models/marts/growth_score.sql
[0m22:09:50.962551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6fdb228f-74c5-4e4c-af11-e66163de5d50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb460a0c0>]}
[0m22:09:51.021503 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m22:09:51.023018 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m22:09:51.032393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6fdb228f-74c5-4e4c-af11-e66163de5d50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb44b4680>]}
[0m22:09:51.032717 [info ] [MainThread]: Found 7 models, 3 sources, 636 macros
[0m22:09:51.032997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6fdb228f-74c5-4e4c-af11-e66163de5d50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4507fb0>]}
[0m22:09:51.034230 [info ] [MainThread]: 
[0m22:09:51.034509 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:09:51.034845 [info ] [MainThread]: 
[0m22:09:51.035267 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:09:51.037892 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRADE_FLOW'
[0m22:09:51.044412 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRADE_FLOW'
[0m22:09:51.045642 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRADE_FLOW'
[0m22:09:51.068603 [debug] [ThreadPool]: Using snowflake connection "list_TRADE_FLOW"
[0m22:09:51.068923 [debug] [ThreadPool]: Using snowflake connection "list_TRADE_FLOW"
[0m22:09:51.069139 [debug] [ThreadPool]: Using snowflake connection "list_TRADE_FLOW"
[0m22:09:51.069297 [debug] [ThreadPool]: On list_TRADE_FLOW: show terse schemas in database TRADE_FLOW
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRADE_FLOW"} */
[0m22:09:51.069869 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:09:51.069696 [debug] [ThreadPool]: On list_TRADE_FLOW: show terse schemas in database TRADE_FLOW
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRADE_FLOW"} */
[0m22:09:51.069506 [debug] [ThreadPool]: On list_TRADE_FLOW: show terse schemas in database TRADE_FLOW
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRADE_FLOW"} */
[0m22:09:51.072595 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:09:51.074573 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:09:52.529018 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.456 seconds
[0m22:09:52.531799 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.462 seconds
[0m22:09:52.536093 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.461 seconds
[0m22:09:52.543298 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRADE_FLOW, now list_TRADE_FLOW_marts)
[0m22:09:52.550837 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRADE_FLOW, now list_TRADE_FLOW_staging)
[0m22:09:52.568498 [debug] [ThreadPool]: Using snowflake connection "list_TRADE_FLOW_marts"
[0m22:09:52.569084 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRADE_FLOW, now list_TRADE_FLOW_analytics)
[0m22:09:52.569415 [debug] [ThreadPool]: On list_TRADE_FLOW_marts: show objects in TRADE_FLOW.marts
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRADE_FLOW_marts"} */;
[0m22:09:52.571946 [debug] [ThreadPool]: Using snowflake connection "list_TRADE_FLOW_staging"
[0m22:09:52.574293 [debug] [ThreadPool]: Using snowflake connection "list_TRADE_FLOW_analytics"
[0m22:09:52.576316 [debug] [ThreadPool]: On list_TRADE_FLOW_staging: show objects in TRADE_FLOW.staging
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRADE_FLOW_staging"} */;
[0m22:09:52.576664 [debug] [ThreadPool]: On list_TRADE_FLOW_analytics: show objects in TRADE_FLOW.analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRADE_FLOW_analytics"} */;
[0m22:09:52.704299 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.129 seconds
[0m22:09:52.706503 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.128 seconds
[0m22:09:52.712541 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.136 seconds
[0m22:09:52.718288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6fdb228f-74c5-4e4c-af11-e66163de5d50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3562ff0>]}
[0m22:09:52.723563 [debug] [Thread-1 (]: Began running node model.citrus_trade.stg_trade
[0m22:09:52.724379 [info ] [Thread-1 (]: 1 of 7 START sql table model staging.stg_trade ................................. [RUN]
[0m22:09:52.725145 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_TRADE_FLOW_staging, now model.citrus_trade.stg_trade)
[0m22:09:52.725929 [debug] [Thread-1 (]: Began compiling node model.citrus_trade.stg_trade
[0m22:09:52.735753 [debug] [Thread-1 (]: Writing injected SQL for node "model.citrus_trade.stg_trade"
[0m22:09:52.738377 [debug] [Thread-1 (]: Began executing node model.citrus_trade.stg_trade
[0m22:09:52.765065 [debug] [Thread-1 (]: Writing runtime sql for node "model.citrus_trade.stg_trade"
[0m22:09:52.767004 [debug] [Thread-1 (]: Using snowflake connection "model.citrus_trade.stg_trade"
[0m22:09:52.767296 [debug] [Thread-1 (]: On model.citrus_trade.stg_trade: create or replace transient table TRADE_FLOW.staging.stg_trade
    
    
    
    as (select
  value:DECLARANT::int as declarant,
  value:DECLARANT_ISO::string as declarant_iso,
  value:PARTNER::string as partner,
  value:PARTNER_ISO::string as partner_iso,
  value:FLOW::int as flow,
  value:TRANSPORT_MODE::int as transport_mode,
  value:PERIOD::int as period,
  year(to_date(left(period,4),'YYYY')) as year,
  value:HS4::string as hs4,
  value:HS4_NAME::string as hs4_name,
  value:HS6::string as hs6,
  value:HS6_NAME::string as hs6_name,
  value:VALUE_IN_EUROS::float as value_in_euros,
  value:QUANTITY_IN_KG::float as quantity_in_kg
from trade_flow.raw.raw_trhs
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.stg_trade"} */;
[0m22:09:53.592975 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.825 seconds
[0m22:09:53.625886 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6fdb228f-74c5-4e4c-af11-e66163de5d50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb89298e0>]}
[0m22:09:53.626893 [info ] [Thread-1 (]: 1 of 7 OK created sql table model staging.stg_trade ............................ [[32mSUCCESS 1[0m in 0.90s]
[0m22:09:53.627787 [debug] [Thread-1 (]: Finished running node model.citrus_trade.stg_trade
[0m22:09:53.628855 [debug] [Thread-3 (]: Began running node model.citrus_trade.trade_by_hs
[0m22:09:53.629594 [info ] [Thread-3 (]: 2 of 7 START sql table model marts.trade_by_hs ................................. [RUN]
[0m22:09:53.630140 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_TRADE_FLOW_marts, now model.citrus_trade.trade_by_hs)
[0m22:09:53.630652 [debug] [Thread-3 (]: Began compiling node model.citrus_trade.trade_by_hs
[0m22:09:53.634070 [debug] [Thread-3 (]: Writing injected SQL for node "model.citrus_trade.trade_by_hs"
[0m22:09:53.636028 [debug] [Thread-3 (]: Began executing node model.citrus_trade.trade_by_hs
[0m22:09:53.640580 [debug] [Thread-3 (]: Writing runtime sql for node "model.citrus_trade.trade_by_hs"
[0m22:09:53.642422 [debug] [Thread-3 (]: Using snowflake connection "model.citrus_trade.trade_by_hs"
[0m22:09:53.642797 [debug] [Thread-3 (]: On model.citrus_trade.trade_by_hs: create or replace transient table TRADE_FLOW.marts.trade_by_hs
    
    
    
    as (select
    *
from TRADE_FLOW.staging.stg_trade
where hs6 = '080510'
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.trade_by_hs"} */;
[0m22:09:54.248457 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.605 seconds
[0m22:09:54.250202 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6fdb228f-74c5-4e4c-af11-e66163de5d50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2954230>]}
[0m22:09:54.251650 [info ] [Thread-3 (]: 2 of 7 OK created sql table model marts.trade_by_hs ............................ [[32mSUCCESS 1[0m in 0.62s]
[0m22:09:54.252492 [debug] [Thread-3 (]: Finished running node model.citrus_trade.trade_by_hs
[0m22:09:54.253470 [debug] [Thread-2 (]: Began running node model.citrus_trade.imports_by_year
[0m22:09:54.254124 [info ] [Thread-2 (]: 3 of 7 START sql table model marts.imports_by_year ............................. [RUN]
[0m22:09:54.254666 [debug] [Thread-1 (]: Began running node model.citrus_trade.imports_exports_2020
[0m22:09:54.254977 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_TRADE_FLOW_analytics, now model.citrus_trade.imports_by_year)
[0m22:09:54.255750 [debug] [Thread-2 (]: Began compiling node model.citrus_trade.imports_by_year
[0m22:09:54.255325 [info ] [Thread-1 (]: 4 of 7 START sql table model marts.imports_exports_2020 ........................ [RUN]
[0m22:09:54.258142 [debug] [Thread-2 (]: Writing injected SQL for node "model.citrus_trade.imports_by_year"
[0m22:09:54.258973 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.citrus_trade.stg_trade, now model.citrus_trade.imports_exports_2020)
[0m22:09:54.270608 [debug] [Thread-1 (]: Began compiling node model.citrus_trade.imports_exports_2020
[0m22:09:54.281630 [debug] [Thread-1 (]: Writing injected SQL for node "model.citrus_trade.imports_exports_2020"
[0m22:09:54.285634 [debug] [Thread-2 (]: Began executing node model.citrus_trade.imports_by_year
[0m22:09:54.288776 [debug] [Thread-2 (]: Writing runtime sql for node "model.citrus_trade.imports_by_year"
[0m22:09:54.289463 [debug] [Thread-1 (]: Began executing node model.citrus_trade.imports_exports_2020
[0m22:09:54.290898 [debug] [Thread-1 (]: Writing runtime sql for node "model.citrus_trade.imports_exports_2020"
[0m22:09:54.291466 [debug] [Thread-2 (]: Using snowflake connection "model.citrus_trade.imports_by_year"
[0m22:09:54.292317 [debug] [Thread-2 (]: On model.citrus_trade.imports_by_year: create or replace transient table TRADE_FLOW.marts.imports_by_year
    
    
    
    as (select
    declarant_iso,
    year,
    sum(value_in_euros) as total_value,
    sum(quantity_in_kg) as total_quantity,
    total_value/nullif(total_quantity,0) as value_per_quantity
from TRADE_FLOW.marts.trade_by_hs
where flow = 1
group by 1,2
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.imports_by_year"} */;
[0m22:09:54.295232 [debug] [Thread-1 (]: Using snowflake connection "model.citrus_trade.imports_exports_2020"
[0m22:09:54.295794 [debug] [Thread-1 (]: On model.citrus_trade.imports_exports_2020: create or replace transient table TRADE_FLOW.marts.imports_exports_2020
    
    
    
    as (select
    declarant_iso,
    flow,
    sum(value_in_euros) over(partition by declarant_iso, flow) as total_value,
    sum(quantity_in_kg) over(partition by declarant_iso, flow) as total_quantity,
    total_value/nullif(total_quantity,0) as value_per_quantity
from TRADE_FLOW.marts.trade_by_hs
where year = 2020
group by 
    declarant_iso,
    flow,
    value_in_euros,
    quantity_in_kg
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.imports_exports_2020"} */;
[0m22:09:54.924080 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.631 seconds
[0m22:09:54.927363 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6fdb228f-74c5-4e4c-af11-e66163de5d50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2d4dcd0>]}
[0m22:09:54.928306 [info ] [Thread-2 (]: 3 of 7 OK created sql table model marts.imports_by_year ........................ [[32mSUCCESS 1[0m in 0.67s]
[0m22:09:54.929340 [debug] [Thread-2 (]: Finished running node model.citrus_trade.imports_by_year
[0m22:09:54.930018 [debug] [Thread-3 (]: Began running node model.citrus_trade.growth_score
[0m22:09:54.930405 [info ] [Thread-3 (]: 5 of 7 START sql table model marts.growth_score ................................ [RUN]
[0m22:09:54.930903 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.citrus_trade.trade_by_hs, now model.citrus_trade.growth_score)
[0m22:09:54.931283 [debug] [Thread-3 (]: Began compiling node model.citrus_trade.growth_score
[0m22:09:54.934657 [debug] [Thread-3 (]: Writing injected SQL for node "model.citrus_trade.growth_score"
[0m22:09:54.938668 [debug] [Thread-3 (]: Began executing node model.citrus_trade.growth_score
[0m22:09:54.943144 [debug] [Thread-3 (]: Writing runtime sql for node "model.citrus_trade.growth_score"
[0m22:09:54.950396 [debug] [Thread-3 (]: Using snowflake connection "model.citrus_trade.growth_score"
[0m22:09:54.951830 [debug] [Thread-3 (]: On model.citrus_trade.growth_score: create or replace transient table TRADE_FLOW.marts.growth_score
    
    
    
    as (with 
    previous_year AS (
        select 
            declarant_iso,
            year,
            lag(total_value,1) over(partition by declarant_iso order by year) previous_year_value,
            total_value,
            first_value(total_value) over(partition by declarant_iso order by year) as first_year_value,
            last_value(total_value) over(partition by declarant_iso order by year) as last_year_value
        from TRADE_FLOW.marts.imports_by_year
    ),
    growth_speed AS (
        select 
            declarant_iso,
            year,
            first_year_value,
            last_year_value,
            last_year_value/nullif(first_year_value,0) as growth_overall,
            previous_year_value,
            total_value,
            (total_value - previous_year_value)/total_value * 100 as growth_speed 
        from previous_year
    ),
    previous_year_growth_speed AS (
        select 
            declarant_iso,
            year,
            first_year_value,
            last_year_value,
            growth_overall,
            previous_year_value,
            total_value as current_value,
            growth_speed,
            lag(growth_speed,1) over(partition by declarant_iso order by year) previous_year_growth_speed,
        from growth_speed
        order by 1,2
    ),
    base AS (
        select 
            declarant_iso,
            year,
            first_year_value,
            last_year_value,
            growth_overall,
            previous_year_value,
            current_value,
            previous_year_growth_speed,
            growth_speed,
            growth_speed - previous_year_growth_speed as growth_acceleration,
            avg(growth_acceleration) over(partition by declarant_iso) as avg_acceleration
        from previous_year_growth_speed
    ),
    ok as (
        select 
            declarant_iso,
            year,
            first_year_value,
            last_year_value,
            growth_overall,
            (growth_overall - min(growth_overall) OVER())/(max(growth_overall) OVER() - min(growth_overall) OVER()) as growth_overall_norm,
            previous_year_value,
            current_value,
            -- previous_year_growth_speed,
            growth_speed,
            growth_acceleration,
            avg_acceleration,
            (avg_acceleration - min(avg_acceleration) OVER())/(max(avg_acceleration) OVER() - min(avg_acceleration) OVER()) as avg_acceleration_norm
        from base 
    )
    select 
        distinct 
        declarant_iso,
        year,
        current_value,
        growth_speed,
        growth_acceleration,
        growth_overall,
        growth_overall_norm,
        avg_acceleration,
        avg_acceleration_norm,
        growth_overall_norm * avg_acceleration_norm as growth_score
    from ok
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.growth_score"} */;
[0m22:09:54.974202 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.678 seconds
[0m22:09:54.976130 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6fdb228f-74c5-4e4c-af11-e66163de5d50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb292fef0>]}
[0m22:09:54.976791 [info ] [Thread-1 (]: 4 of 7 OK created sql table model marts.imports_exports_2020 ................... [[32mSUCCESS 1[0m in 0.72s]
[0m22:09:54.977571 [debug] [Thread-1 (]: Finished running node model.citrus_trade.imports_exports_2020
[0m22:09:54.978248 [debug] [Thread-2 (]: Began running node model.citrus_trade.score_2020
[0m22:09:54.978696 [info ] [Thread-2 (]: 6 of 7 START sql table model marts.score_2020 .................................. [RUN]
[0m22:09:54.979172 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.citrus_trade.imports_by_year, now model.citrus_trade.score_2020)
[0m22:09:54.979627 [debug] [Thread-2 (]: Began compiling node model.citrus_trade.score_2020
[0m22:09:54.982439 [debug] [Thread-2 (]: Writing injected SQL for node "model.citrus_trade.score_2020"
[0m22:09:54.983698 [debug] [Thread-2 (]: Began executing node model.citrus_trade.score_2020
[0m22:09:54.987769 [debug] [Thread-2 (]: Writing runtime sql for node "model.citrus_trade.score_2020"
[0m22:09:54.989348 [debug] [Thread-2 (]: Using snowflake connection "model.citrus_trade.score_2020"
[0m22:09:54.989656 [debug] [Thread-2 (]: On model.citrus_trade.score_2020: create or replace transient table TRADE_FLOW.marts.score_2020
    
    
    
    as (select distinct 
    declarant_iso,
    total_value,
    total_quantity,
    value_per_quantity,
    (total_value - min(total_value) over())/((max(total_value) over())-(min(total_value) over())) as value_score,
    (total_quantity - min(total_quantity) over())/((max(total_quantity) over())-(min(total_quantity) over())) as quantity_score,
    (value_per_quantity - min(value_per_quantity) over())/((max(value_per_quantity) over())-(min(value_per_quantity) over())) as price_score
from TRADE_FLOW.marts.imports_exports_2020
where flow = 1
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.score_2020"} */;
[0m22:09:55.656577 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.666 seconds
[0m22:09:55.662446 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6fdb228f-74c5-4e4c-af11-e66163de5d50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2960470>]}
[0m22:09:55.663844 [info ] [Thread-2 (]: 6 of 7 OK created sql table model marts.score_2020 ............................. [[32mSUCCESS 1[0m in 0.68s]
[0m22:09:55.665109 [debug] [Thread-2 (]: Finished running node model.citrus_trade.score_2020
[0m22:09:55.779874 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.825 seconds
[0m22:09:55.785164 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6fdb228f-74c5-4e4c-af11-e66163de5d50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2d4af30>]}
[0m22:09:55.786610 [info ] [Thread-3 (]: 5 of 7 OK created sql table model marts.growth_score ........................... [[32mSUCCESS 1[0m in 0.85s]
[0m22:09:55.787670 [debug] [Thread-3 (]: Finished running node model.citrus_trade.growth_score
[0m22:09:55.789115 [debug] [Thread-1 (]: Began running node model.citrus_trade.importer_trade_score
[0m22:09:55.789956 [info ] [Thread-1 (]: 7 of 7 START sql table model analytics.importer_trade_score .................... [RUN]
[0m22:09:55.790722 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.citrus_trade.imports_exports_2020, now model.citrus_trade.importer_trade_score)
[0m22:09:55.791514 [debug] [Thread-1 (]: Began compiling node model.citrus_trade.importer_trade_score
[0m22:09:55.796843 [debug] [Thread-1 (]: Writing injected SQL for node "model.citrus_trade.importer_trade_score"
[0m22:09:55.798717 [debug] [Thread-1 (]: Began executing node model.citrus_trade.importer_trade_score
[0m22:09:55.802430 [debug] [Thread-1 (]: Writing runtime sql for node "model.citrus_trade.importer_trade_score"
[0m22:09:55.804597 [debug] [Thread-1 (]: Using snowflake connection "model.citrus_trade.importer_trade_score"
[0m22:09:55.805124 [debug] [Thread-1 (]: On model.citrus_trade.importer_trade_score: create or replace transient table TRADE_FLOW.analytics.importer_trade_score
    
    
    
    as (select 
    sc.declarant_iso,
    sc.value_score,
    sc.quantity_score,
    sc.price_score,
    gs.growth_score
from TRADE_FLOW.marts.score_2020 as sc
inner join TRADE_FLOW.marts.growth_score as gs
    on gs.declarant_iso = sc.declarant_iso
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.importer_trade_score"} */;
[0m22:09:56.521978 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.716 seconds
[0m22:09:56.527884 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6fdb228f-74c5-4e4c-af11-e66163de5d50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2926720>]}
[0m22:09:56.529193 [info ] [Thread-1 (]: 7 of 7 OK created sql table model analytics.importer_trade_score ............... [[32mSUCCESS 1[0m in 0.74s]
[0m22:09:56.530282 [debug] [Thread-1 (]: Finished running node model.citrus_trade.importer_trade_score
[0m22:09:56.533453 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:09:56.534079 [debug] [MainThread]: Connection 'model.citrus_trade.importer_trade_score' was left open.
[0m22:09:56.534784 [debug] [MainThread]: On model.citrus_trade.importer_trade_score: Close
[0m22:09:56.656950 [debug] [MainThread]: Connection 'model.citrus_trade.growth_score' was left open.
[0m22:09:56.658322 [debug] [MainThread]: On model.citrus_trade.growth_score: Close
[0m22:09:56.788054 [debug] [MainThread]: Connection 'model.citrus_trade.score_2020' was left open.
[0m22:09:56.789256 [debug] [MainThread]: On model.citrus_trade.score_2020: Close
[0m22:09:56.910027 [info ] [MainThread]: 
[0m22:09:56.910506 [info ] [MainThread]: Finished running 7 table models in 0 hours 0 minutes and 5.87 seconds (5.87s).
[0m22:09:56.911584 [debug] [MainThread]: Command end result
[0m22:09:56.935582 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m22:09:56.937304 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m22:09:56.941860 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/target/run_results.json
[0m22:09:56.942142 [info ] [MainThread]: 
[0m22:09:56.942538 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:09:56.942855 [info ] [MainThread]: 
[0m22:09:56.943420 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=7
[0m22:09:56.944449 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.6307364, "process_in_blocks": "0", "process_kernel_time": 0.337222, "process_mem_max_rss": "151124", "process_out_blocks": "4260", "process_user_time": 1.886652}
[0m22:09:56.944815 [debug] [MainThread]: Command `dbt run` succeeded at 22:09:56.944753 after 6.63 seconds
[0m22:09:56.945067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8c89c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4b45790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7020860>]}
[0m22:09:56.947158 [debug] [MainThread]: Flushing usage events
[0m22:09:58.260802 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:16:24.757281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8fddb830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f49eea0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f49fc80>]}


============================== 22:16:24.760261 | 3c25dae1-8aaf-4fd1-ae3b-4adbc7084809 ==============================
[0m22:16:24.760261 [info ] [MainThread]: Running with dbt=1.10.13
[0m22:16:24.760667 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'no_print': 'None', 'target_path': 'None', 'static_parser': 'True', 'invocation_command': 'dbt run', 'profiles_dir': '/opt/airflow/dbt', 'partial_parse': 'True', 'use_colors': 'True', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'debug': 'False', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'quiet': 'False', 'log_format': 'default', 'use_experimental_parser': 'False', 'version_check': 'True', 'write_json': 'True'}
[0m22:16:24.950321 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m22:16:24.950813 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m22:16:24.951072 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m22:16:25.043629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3c25dae1-8aaf-4fd1-ae3b-4adbc7084809', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91cb2480>]}
[0m22:16:25.074063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3c25dae1-8aaf-4fd1-ae3b-4adbc7084809', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e1a98e0>]}
[0m22:16:25.074566 [info ] [MainThread]: Registered adapter: snowflake=1.10.3
[0m22:16:25.138807 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m22:16:25.259745 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:16:25.260257 [debug] [MainThread]: Partial parsing: updated file: citrus_trade://models/analytics/importer_trade_score.sql
[0m22:16:25.410350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3c25dae1-8aaf-4fd1-ae3b-4adbc7084809', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d5ba8a0>]}
[0m22:16:25.456450 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m22:16:25.458159 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m22:16:25.467416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3c25dae1-8aaf-4fd1-ae3b-4adbc7084809', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d5645c0>]}
[0m22:16:25.467762 [info ] [MainThread]: Found 7 models, 3 sources, 636 macros
[0m22:16:25.468037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3c25dae1-8aaf-4fd1-ae3b-4adbc7084809', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8dba5a60>]}
[0m22:16:25.469241 [info ] [MainThread]: 
[0m22:16:25.469522 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:16:25.469877 [info ] [MainThread]: 
[0m22:16:25.470294 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:16:25.472922 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRADE_FLOW'
[0m22:16:25.479388 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRADE_FLOW'
[0m22:16:25.481746 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRADE_FLOW'
[0m22:16:25.506612 [debug] [ThreadPool]: Using snowflake connection "list_TRADE_FLOW"
[0m22:16:25.506947 [debug] [ThreadPool]: Using snowflake connection "list_TRADE_FLOW"
[0m22:16:25.507197 [debug] [ThreadPool]: Using snowflake connection "list_TRADE_FLOW"
[0m22:16:25.507360 [debug] [ThreadPool]: On list_TRADE_FLOW: show terse schemas in database TRADE_FLOW
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRADE_FLOW"} */
[0m22:16:25.507603 [debug] [ThreadPool]: On list_TRADE_FLOW: show terse schemas in database TRADE_FLOW
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRADE_FLOW"} */
[0m22:16:25.507863 [debug] [ThreadPool]: On list_TRADE_FLOW: show terse schemas in database TRADE_FLOW
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRADE_FLOW"} */
[0m22:16:25.508057 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:16:25.508253 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:16:25.508446 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:16:26.981341 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.473 seconds
[0m22:16:26.991388 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.483 seconds
[0m22:16:27.013266 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.505 seconds
[0m22:16:27.017402 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRADE_FLOW, now list_TRADE_FLOW_marts)
[0m22:16:27.023651 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRADE_FLOW, now list_TRADE_FLOW_analytics)
[0m22:16:27.038468 [debug] [ThreadPool]: Using snowflake connection "list_TRADE_FLOW_marts"
[0m22:16:27.039031 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRADE_FLOW, now list_TRADE_FLOW_staging)
[0m22:16:27.041093 [debug] [ThreadPool]: Using snowflake connection "list_TRADE_FLOW_analytics"
[0m22:16:27.041439 [debug] [ThreadPool]: On list_TRADE_FLOW_marts: show objects in TRADE_FLOW.marts
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRADE_FLOW_marts"} */;
[0m22:16:27.043508 [debug] [ThreadPool]: Using snowflake connection "list_TRADE_FLOW_staging"
[0m22:16:27.043893 [debug] [ThreadPool]: On list_TRADE_FLOW_analytics: show objects in TRADE_FLOW.analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRADE_FLOW_analytics"} */;
[0m22:16:27.045540 [debug] [ThreadPool]: On list_TRADE_FLOW_staging: show objects in TRADE_FLOW.staging
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRADE_FLOW_staging"} */;
[0m22:16:27.152732 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.106 seconds
[0m22:16:27.155030 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.109 seconds
[0m22:16:27.155664 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.111 seconds
[0m22:16:27.158491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3c25dae1-8aaf-4fd1-ae3b-4adbc7084809', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c076c00>]}
[0m22:16:27.161079 [debug] [Thread-1 (]: Began running node model.citrus_trade.stg_trade
[0m22:16:27.161484 [info ] [Thread-1 (]: 1 of 7 START sql table model staging.stg_trade ................................. [RUN]
[0m22:16:27.161830 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_TRADE_FLOW_marts, now model.citrus_trade.stg_trade)
[0m22:16:27.162168 [debug] [Thread-1 (]: Began compiling node model.citrus_trade.stg_trade
[0m22:16:27.167184 [debug] [Thread-1 (]: Writing injected SQL for node "model.citrus_trade.stg_trade"
[0m22:16:27.169702 [debug] [Thread-1 (]: Began executing node model.citrus_trade.stg_trade
[0m22:16:27.195761 [debug] [Thread-1 (]: Writing runtime sql for node "model.citrus_trade.stg_trade"
[0m22:16:27.197888 [debug] [Thread-1 (]: Using snowflake connection "model.citrus_trade.stg_trade"
[0m22:16:27.198177 [debug] [Thread-1 (]: On model.citrus_trade.stg_trade: create or replace transient table TRADE_FLOW.staging.stg_trade
    
    
    
    as (select
  value:DECLARANT::int as declarant,
  value:DECLARANT_ISO::string as declarant_iso,
  value:PARTNER::string as partner,
  value:PARTNER_ISO::string as partner_iso,
  value:FLOW::int as flow,
  value:TRANSPORT_MODE::int as transport_mode,
  value:PERIOD::int as period,
  year(to_date(left(period,4),'YYYY')) as year,
  value:HS4::string as hs4,
  value:HS4_NAME::string as hs4_name,
  value:HS6::string as hs6,
  value:HS6_NAME::string as hs6_name,
  value:VALUE_IN_EUROS::float as value_in_euros,
  value:QUANTITY_IN_KG::float as quantity_in_kg
from trade_flow.raw.raw_trhs
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.stg_trade"} */;
[0m22:16:27.872067 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.673 seconds
[0m22:16:27.902397 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c25dae1-8aaf-4fd1-ae3b-4adbc7084809', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91cb1670>]}
[0m22:16:27.903290 [info ] [Thread-1 (]: 1 of 7 OK created sql table model staging.stg_trade ............................ [[32mSUCCESS 1[0m in 0.74s]
[0m22:16:27.904163 [debug] [Thread-1 (]: Finished running node model.citrus_trade.stg_trade
[0m22:16:27.906402 [debug] [Thread-3 (]: Began running node model.citrus_trade.trade_by_hs
[0m22:16:27.906880 [info ] [Thread-3 (]: 2 of 7 START sql table model marts.trade_by_hs ................................. [RUN]
[0m22:16:27.907400 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_TRADE_FLOW_staging, now model.citrus_trade.trade_by_hs)
[0m22:16:27.907680 [debug] [Thread-3 (]: Began compiling node model.citrus_trade.trade_by_hs
[0m22:16:27.913789 [debug] [Thread-3 (]: Writing injected SQL for node "model.citrus_trade.trade_by_hs"
[0m22:16:27.915730 [debug] [Thread-3 (]: Began executing node model.citrus_trade.trade_by_hs
[0m22:16:27.918043 [debug] [Thread-3 (]: Writing runtime sql for node "model.citrus_trade.trade_by_hs"
[0m22:16:27.919157 [debug] [Thread-3 (]: Using snowflake connection "model.citrus_trade.trade_by_hs"
[0m22:16:27.919415 [debug] [Thread-3 (]: On model.citrus_trade.trade_by_hs: create or replace transient table TRADE_FLOW.marts.trade_by_hs
    
    
    
    as (select
    *
from TRADE_FLOW.staging.stg_trade
where hs6 = '080510'
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.trade_by_hs"} */;
[0m22:16:28.651130 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.731 seconds
[0m22:16:28.654259 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c25dae1-8aaf-4fd1-ae3b-4adbc7084809', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c1d0e00>]}
[0m22:16:28.655089 [info ] [Thread-3 (]: 2 of 7 OK created sql table model marts.trade_by_hs ............................ [[32mSUCCESS 1[0m in 0.75s]
[0m22:16:28.655717 [debug] [Thread-3 (]: Finished running node model.citrus_trade.trade_by_hs
[0m22:16:28.656843 [debug] [Thread-2 (]: Began running node model.citrus_trade.imports_by_year
[0m22:16:28.657231 [debug] [Thread-1 (]: Began running node model.citrus_trade.imports_exports_2020
[0m22:16:28.657545 [info ] [Thread-2 (]: 3 of 7 START sql table model marts.imports_by_year ............................. [RUN]
[0m22:16:28.658688 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_TRADE_FLOW_analytics, now model.citrus_trade.imports_by_year)
[0m22:16:28.658992 [debug] [Thread-2 (]: Began compiling node model.citrus_trade.imports_by_year
[0m22:16:28.658022 [info ] [Thread-1 (]: 4 of 7 START sql table model marts.imports_exports_2020 ........................ [RUN]
[0m22:16:28.662380 [debug] [Thread-2 (]: Writing injected SQL for node "model.citrus_trade.imports_by_year"
[0m22:16:28.662842 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.citrus_trade.stg_trade, now model.citrus_trade.imports_exports_2020)
[0m22:16:28.663423 [debug] [Thread-1 (]: Began compiling node model.citrus_trade.imports_exports_2020
[0m22:16:28.666939 [debug] [Thread-1 (]: Writing injected SQL for node "model.citrus_trade.imports_exports_2020"
[0m22:16:28.667887 [debug] [Thread-2 (]: Began executing node model.citrus_trade.imports_by_year
[0m22:16:28.669906 [debug] [Thread-2 (]: Writing runtime sql for node "model.citrus_trade.imports_by_year"
[0m22:16:28.670537 [debug] [Thread-1 (]: Began executing node model.citrus_trade.imports_exports_2020
[0m22:16:28.672739 [debug] [Thread-1 (]: Writing runtime sql for node "model.citrus_trade.imports_exports_2020"
[0m22:16:28.673761 [debug] [Thread-2 (]: Using snowflake connection "model.citrus_trade.imports_by_year"
[0m22:16:28.674057 [debug] [Thread-2 (]: On model.citrus_trade.imports_by_year: create or replace transient table TRADE_FLOW.marts.imports_by_year
    
    
    
    as (select
    declarant_iso,
    year,
    sum(value_in_euros) as total_value,
    sum(quantity_in_kg) as total_quantity,
    total_value/nullif(total_quantity,0) as value_per_quantity
from TRADE_FLOW.marts.trade_by_hs
where flow = 1
group by 1,2
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.imports_by_year"} */;
[0m22:16:28.676681 [debug] [Thread-1 (]: Using snowflake connection "model.citrus_trade.imports_exports_2020"
[0m22:16:28.677030 [debug] [Thread-1 (]: On model.citrus_trade.imports_exports_2020: create or replace transient table TRADE_FLOW.marts.imports_exports_2020
    
    
    
    as (select
    declarant_iso,
    flow,
    sum(value_in_euros) over(partition by declarant_iso, flow) as total_value,
    sum(quantity_in_kg) over(partition by declarant_iso, flow) as total_quantity,
    total_value/nullif(total_quantity,0) as value_per_quantity
from TRADE_FLOW.marts.trade_by_hs
where year = 2020
group by 
    declarant_iso,
    flow,
    value_in_euros,
    quantity_in_kg
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.imports_exports_2020"} */;
[0m22:16:29.228317 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.554 seconds
[0m22:16:29.231974 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c25dae1-8aaf-4fd1-ae3b-4adbc7084809', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87f97a10>]}
[0m22:16:29.233232 [info ] [Thread-2 (]: 3 of 7 OK created sql table model marts.imports_by_year ........................ [[32mSUCCESS 1[0m in 0.57s]
[0m22:16:29.234727 [debug] [Thread-2 (]: Finished running node model.citrus_trade.imports_by_year
[0m22:16:29.235521 [debug] [Thread-3 (]: Began running node model.citrus_trade.growth_score
[0m22:16:29.236338 [info ] [Thread-3 (]: 5 of 7 START sql table model marts.growth_score ................................ [RUN]
[0m22:16:29.237103 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.citrus_trade.trade_by_hs, now model.citrus_trade.growth_score)
[0m22:16:29.237614 [debug] [Thread-3 (]: Began compiling node model.citrus_trade.growth_score
[0m22:16:29.241252 [debug] [Thread-3 (]: Writing injected SQL for node "model.citrus_trade.growth_score"
[0m22:16:29.242707 [debug] [Thread-3 (]: Began executing node model.citrus_trade.growth_score
[0m22:16:29.245684 [debug] [Thread-3 (]: Writing runtime sql for node "model.citrus_trade.growth_score"
[0m22:16:29.249896 [debug] [Thread-3 (]: Using snowflake connection "model.citrus_trade.growth_score"
[0m22:16:29.250536 [debug] [Thread-3 (]: On model.citrus_trade.growth_score: create or replace transient table TRADE_FLOW.marts.growth_score
    
    
    
    as (with 
    previous_year AS (
        select 
            declarant_iso,
            year,
            lag(total_value,1) over(partition by declarant_iso order by year) previous_year_value,
            total_value,
            first_value(total_value) over(partition by declarant_iso order by year) as first_year_value,
            last_value(total_value) over(partition by declarant_iso order by year) as last_year_value
        from TRADE_FLOW.marts.imports_by_year
    ),
    growth_speed AS (
        select 
            declarant_iso,
            year,
            first_year_value,
            last_year_value,
            last_year_value/nullif(first_year_value,0) as growth_overall,
            previous_year_value,
            total_value,
            (total_value - previous_year_value)/total_value * 100 as growth_speed 
        from previous_year
    ),
    previous_year_growth_speed AS (
        select 
            declarant_iso,
            year,
            first_year_value,
            last_year_value,
            growth_overall,
            previous_year_value,
            total_value as current_value,
            growth_speed,
            lag(growth_speed,1) over(partition by declarant_iso order by year) previous_year_growth_speed,
        from growth_speed
        order by 1,2
    ),
    base AS (
        select 
            declarant_iso,
            year,
            first_year_value,
            last_year_value,
            growth_overall,
            previous_year_value,
            current_value,
            previous_year_growth_speed,
            growth_speed,
            growth_speed - previous_year_growth_speed as growth_acceleration,
            avg(growth_acceleration) over(partition by declarant_iso) as avg_acceleration
        from previous_year_growth_speed
    ),
    ok as (
        select 
            declarant_iso,
            year,
            first_year_value,
            last_year_value,
            growth_overall,
            (growth_overall - min(growth_overall) OVER())/(max(growth_overall) OVER() - min(growth_overall) OVER()) as growth_overall_norm,
            previous_year_value,
            current_value,
            -- previous_year_growth_speed,
            growth_speed,
            growth_acceleration,
            avg_acceleration,
            (avg_acceleration - min(avg_acceleration) OVER())/(max(avg_acceleration) OVER() - min(avg_acceleration) OVER()) as avg_acceleration_norm
        from base 
    )
    select 
        distinct 
        declarant_iso,
        year,
        current_value,
        growth_speed,
        growth_acceleration,
        growth_overall,
        growth_overall_norm,
        avg_acceleration,
        avg_acceleration_norm,
        growth_overall_norm * avg_acceleration_norm as growth_score
    from ok
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.growth_score"} */;
[0m22:16:29.263605 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.586 seconds
[0m22:16:29.265744 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c25dae1-8aaf-4fd1-ae3b-4adbc7084809', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87f84380>]}
[0m22:16:29.266405 [info ] [Thread-1 (]: 4 of 7 OK created sql table model marts.imports_exports_2020 ................... [[32mSUCCESS 1[0m in 0.60s]
[0m22:16:29.267092 [debug] [Thread-1 (]: Finished running node model.citrus_trade.imports_exports_2020
[0m22:16:29.267926 [debug] [Thread-2 (]: Began running node model.citrus_trade.score_2020
[0m22:16:29.268412 [info ] [Thread-2 (]: 6 of 7 START sql table model marts.score_2020 .................................. [RUN]
[0m22:16:29.268854 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.citrus_trade.imports_by_year, now model.citrus_trade.score_2020)
[0m22:16:29.269276 [debug] [Thread-2 (]: Began compiling node model.citrus_trade.score_2020
[0m22:16:29.272499 [debug] [Thread-2 (]: Writing injected SQL for node "model.citrus_trade.score_2020"
[0m22:16:29.274295 [debug] [Thread-2 (]: Began executing node model.citrus_trade.score_2020
[0m22:16:29.277848 [debug] [Thread-2 (]: Writing runtime sql for node "model.citrus_trade.score_2020"
[0m22:16:29.280244 [debug] [Thread-2 (]: Using snowflake connection "model.citrus_trade.score_2020"
[0m22:16:29.280816 [debug] [Thread-2 (]: On model.citrus_trade.score_2020: create or replace transient table TRADE_FLOW.marts.score_2020
    
    
    
    as (select distinct 
    declarant_iso,
    total_value,
    total_quantity,
    value_per_quantity,
    (total_value - min(total_value) over())/((max(total_value) over())-(min(total_value) over())) as value_score,
    (total_quantity - min(total_quantity) over())/((max(total_quantity) over())-(min(total_quantity) over())) as quantity_score,
    (value_per_quantity - min(value_per_quantity) over())/((max(value_per_quantity) over())-(min(value_per_quantity) over())) as price_score
from TRADE_FLOW.marts.imports_exports_2020
where flow = 1
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.score_2020"} */;
[0m22:16:29.913496 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.632 seconds
[0m22:16:29.917697 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c25dae1-8aaf-4fd1-ae3b-4adbc7084809', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c075dc0>]}
[0m22:16:29.918663 [info ] [Thread-2 (]: 6 of 7 OK created sql table model marts.score_2020 ............................. [[32mSUCCESS 1[0m in 0.65s]
[0m22:16:29.919719 [debug] [Thread-2 (]: Finished running node model.citrus_trade.score_2020
[0m22:16:29.961714 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.710 seconds
[0m22:16:29.964367 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c25dae1-8aaf-4fd1-ae3b-4adbc7084809', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87f73d40>]}
[0m22:16:29.965364 [info ] [Thread-3 (]: 5 of 7 OK created sql table model marts.growth_score ........................... [[32mSUCCESS 1[0m in 0.73s]
[0m22:16:29.965941 [debug] [Thread-3 (]: Finished running node model.citrus_trade.growth_score
[0m22:16:29.966809 [debug] [Thread-1 (]: Began running node model.citrus_trade.importer_trade_score
[0m22:16:29.967410 [info ] [Thread-1 (]: 7 of 7 START sql table model analytics.importer_trade_score .................... [RUN]
[0m22:16:29.967822 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.citrus_trade.imports_exports_2020, now model.citrus_trade.importer_trade_score)
[0m22:16:29.968282 [debug] [Thread-1 (]: Began compiling node model.citrus_trade.importer_trade_score
[0m22:16:29.974542 [debug] [Thread-1 (]: Writing injected SQL for node "model.citrus_trade.importer_trade_score"
[0m22:16:29.976881 [debug] [Thread-1 (]: Began executing node model.citrus_trade.importer_trade_score
[0m22:16:29.979488 [debug] [Thread-1 (]: Writing runtime sql for node "model.citrus_trade.importer_trade_score"
[0m22:16:29.982711 [debug] [Thread-1 (]: Using snowflake connection "model.citrus_trade.importer_trade_score"
[0m22:16:29.983187 [debug] [Thread-1 (]: On model.citrus_trade.importer_trade_score: create or replace transient table TRADE_FLOW.analytics.importer_trade_score
    
    
    
    as (select 
    declarant_iso,
    score_type,
    score
from (
    select 
        sc.declarant_iso,
        sc.value_score,
        sc.quantity_score,
        sc.price_score,
        gs.growth_score
    from TRADE_FLOW.marts.score_2020 as sc
    inner join TRADE_FLOW.marts.growth_score as gs
        on gs.declarant_iso = sc.declarant_iso
)
unpivot (
    score for score_type in (
        value_score,
        quantity_score,
        price_score,
        growth_score
    )
)
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.importer_trade_score"} */;
[0m22:16:30.066637 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01c03d98-0105-74a0-0004-20ca00024fae
[0m22:16:30.067029 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 28 at position 154 unexpected ';'.
[0m22:16:30.070961 [debug] [Thread-1 (]: Database Error in model importer_trade_score (models/analytics/importer_trade_score.sql)
  001003 (42000): SQL compilation error:
  syntax error line 28 at position 154 unexpected ';'.
  compiled code at target/run/citrus_trade/models/analytics/importer_trade_score.sql
[0m22:16:30.071558 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c25dae1-8aaf-4fd1-ae3b-4adbc7084809', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87f54380>]}
[0m22:16:30.072029 [error] [Thread-1 (]: 7 of 7 ERROR creating sql table model analytics.importer_trade_score ........... [[31mERROR[0m in 0.10s]
[0m22:16:30.072500 [debug] [Thread-1 (]: Finished running node model.citrus_trade.importer_trade_score
[0m22:16:30.072888 [debug] [Thread-7 (]: Marking all children of 'model.citrus_trade.importer_trade_score' to be skipped because of status 'error'.  Reason: Database Error in model importer_trade_score (models/analytics/importer_trade_score.sql)
  001003 (42000): SQL compilation error:
  syntax error line 28 at position 154 unexpected ';'.
  compiled code at target/run/citrus_trade/models/analytics/importer_trade_score.sql.
[0m22:16:30.076196 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:16:30.076565 [debug] [MainThread]: Connection 'model.citrus_trade.score_2020' was left open.
[0m22:16:30.076762 [debug] [MainThread]: On model.citrus_trade.score_2020: Close
[0m22:16:30.200223 [debug] [MainThread]: Connection 'model.citrus_trade.growth_score' was left open.
[0m22:16:30.200562 [debug] [MainThread]: On model.citrus_trade.growth_score: Close
[0m22:16:30.342165 [debug] [MainThread]: Connection 'model.citrus_trade.importer_trade_score' was left open.
[0m22:16:30.343236 [debug] [MainThread]: On model.citrus_trade.importer_trade_score: Close
[0m22:16:30.489300 [info ] [MainThread]: 
[0m22:16:30.490865 [info ] [MainThread]: Finished running 7 table models in 0 hours 0 minutes and 5.02 seconds (5.02s).
[0m22:16:30.493509 [debug] [MainThread]: Command end result
[0m22:16:30.530334 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m22:16:30.539792 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m22:16:30.549505 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/target/run_results.json
[0m22:16:30.549982 [info ] [MainThread]: 
[0m22:16:30.550821 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m22:16:30.552588 [info ] [MainThread]: 
[0m22:16:30.554120 [error] [MainThread]: [31mFailure in model importer_trade_score (models/analytics/importer_trade_score.sql)[0m
[0m22:16:30.554973 [error] [MainThread]:   Database Error in model importer_trade_score (models/analytics/importer_trade_score.sql)
  001003 (42000): SQL compilation error:
  syntax error line 28 at position 154 unexpected ';'.
  compiled code at target/run/citrus_trade/models/analytics/importer_trade_score.sql
[0m22:16:30.555544 [info ] [MainThread]: 
[0m22:16:30.556547 [info ] [MainThread]:   compiled code at target/compiled/citrus_trade/models/analytics/importer_trade_score.sql
[0m22:16:30.557241 [info ] [MainThread]: 
[0m22:16:30.558777 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=7
[0m22:16:30.567518 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 5.8449054, "process_in_blocks": "0", "process_kernel_time": 0.338726, "process_mem_max_rss": "151648", "process_out_blocks": "4267", "process_user_time": 1.948932}
[0m22:16:30.569003 [debug] [MainThread]: Command `dbt run` failed at 22:16:30.568654 after 5.85 seconds
[0m22:16:30.571353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ff75280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d95d760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c513d70>]}
[0m22:16:30.573481 [debug] [MainThread]: Flushing usage events
[0m22:16:31.937107 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:16:55.902517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a515ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a003e60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a3e82f0>]}


============================== 22:16:55.905384 | c390d98b-118d-480a-bebf-80359e40affc ==============================
[0m22:16:55.905384 [info ] [MainThread]: Running with dbt=1.10.13
[0m22:16:55.905831 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'invocation_command': 'dbt run', 'use_colors': 'True', 'empty': 'False', 'use_experimental_parser': 'False', 'profiles_dir': '/opt/airflow/dbt', 'printer_width': '80', 'log_format': 'default', 'cache_selected_only': 'False', 'introspect': 'True', 'target_path': 'None', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'indirect_selection': 'eager', 'write_json': 'True', 'partial_parse': 'True', 'warn_error': 'None', 'quiet': 'False', 'static_parser': 'True', 'no_print': 'None', 'debug': 'False'}
[0m22:16:56.047232 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m22:16:56.047792 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m22:16:56.048065 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m22:16:56.143362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c390d98b-118d-480a-bebf-80359e40affc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97e984d0>]}
[0m22:16:56.174424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c390d98b-118d-480a-bebf-80359e40affc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff984299d0>]}
[0m22:16:56.174972 [info ] [MainThread]: Registered adapter: snowflake=1.10.3
[0m22:16:56.226908 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m22:16:56.345603 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:16:56.346019 [debug] [MainThread]: Partial parsing: updated file: citrus_trade://models/analytics/importer_trade_score.sql
[0m22:16:56.472414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c390d98b-118d-480a-bebf-80359e40affc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff977beae0>]}
[0m22:16:56.531916 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m22:16:56.533536 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m22:16:56.543412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c390d98b-118d-480a-bebf-80359e40affc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97760560>]}
[0m22:16:56.543830 [info ] [MainThread]: Found 7 models, 3 sources, 636 macros
[0m22:16:56.544214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c390d98b-118d-480a-bebf-80359e40affc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff977be4b0>]}
[0m22:16:56.545456 [info ] [MainThread]: 
[0m22:16:56.545848 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:16:56.546102 [info ] [MainThread]: 
[0m22:16:56.546518 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:16:56.549282 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRADE_FLOW'
[0m22:16:56.555993 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRADE_FLOW'
[0m22:16:56.558885 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRADE_FLOW'
[0m22:16:56.582146 [debug] [ThreadPool]: Using snowflake connection "list_TRADE_FLOW"
[0m22:16:56.582468 [debug] [ThreadPool]: Using snowflake connection "list_TRADE_FLOW"
[0m22:16:56.582710 [debug] [ThreadPool]: Using snowflake connection "list_TRADE_FLOW"
[0m22:16:56.582867 [debug] [ThreadPool]: On list_TRADE_FLOW: show terse schemas in database TRADE_FLOW
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRADE_FLOW"} */
[0m22:16:56.583094 [debug] [ThreadPool]: On list_TRADE_FLOW: show terse schemas in database TRADE_FLOW
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRADE_FLOW"} */
[0m22:16:56.583307 [debug] [ThreadPool]: On list_TRADE_FLOW: show terse schemas in database TRADE_FLOW
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRADE_FLOW"} */
[0m22:16:56.583522 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:16:56.583717 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:16:56.583902 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:16:57.955748 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.372 seconds
[0m22:16:57.968352 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.385 seconds
[0m22:16:58.007884 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.424 seconds
[0m22:16:58.012807 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRADE_FLOW, now list_TRADE_FLOW_staging)
[0m22:16:58.019665 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRADE_FLOW, now list_TRADE_FLOW_analytics)
[0m22:16:58.035113 [debug] [ThreadPool]: Using snowflake connection "list_TRADE_FLOW_staging"
[0m22:16:58.039790 [debug] [ThreadPool]: Using snowflake connection "list_TRADE_FLOW_analytics"
[0m22:16:58.040289 [debug] [ThreadPool]: On list_TRADE_FLOW_staging: show objects in TRADE_FLOW.staging
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRADE_FLOW_staging"} */;
[0m22:16:58.040722 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRADE_FLOW, now list_TRADE_FLOW_marts)
[0m22:16:58.041175 [debug] [ThreadPool]: On list_TRADE_FLOW_analytics: show objects in TRADE_FLOW.analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRADE_FLOW_analytics"} */;
[0m22:16:58.045066 [debug] [ThreadPool]: Using snowflake connection "list_TRADE_FLOW_marts"
[0m22:16:58.046539 [debug] [ThreadPool]: On list_TRADE_FLOW_marts: show objects in TRADE_FLOW.marts
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRADE_FLOW_marts"} */;
[0m22:16:58.128985 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.087 seconds
[0m22:16:58.137277 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.090 seconds
[0m22:16:58.149374 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.104 seconds
[0m22:16:58.152331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c390d98b-118d-480a-bebf-80359e40affc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff963de2d0>]}
[0m22:16:58.156782 [debug] [Thread-1 (]: Began running node model.citrus_trade.stg_trade
[0m22:16:58.157527 [info ] [Thread-1 (]: 1 of 7 START sql table model staging.stg_trade ................................. [RUN]
[0m22:16:58.158181 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_TRADE_FLOW_analytics, now model.citrus_trade.stg_trade)
[0m22:16:58.158824 [debug] [Thread-1 (]: Began compiling node model.citrus_trade.stg_trade
[0m22:16:58.168224 [debug] [Thread-1 (]: Writing injected SQL for node "model.citrus_trade.stg_trade"
[0m22:16:58.169851 [debug] [Thread-1 (]: Began executing node model.citrus_trade.stg_trade
[0m22:16:58.196325 [debug] [Thread-1 (]: Writing runtime sql for node "model.citrus_trade.stg_trade"
[0m22:16:58.197990 [debug] [Thread-1 (]: Using snowflake connection "model.citrus_trade.stg_trade"
[0m22:16:58.198262 [debug] [Thread-1 (]: On model.citrus_trade.stg_trade: create or replace transient table TRADE_FLOW.staging.stg_trade
    
    
    
    as (select
  value:DECLARANT::int as declarant,
  value:DECLARANT_ISO::string as declarant_iso,
  value:PARTNER::string as partner,
  value:PARTNER_ISO::string as partner_iso,
  value:FLOW::int as flow,
  value:TRANSPORT_MODE::int as transport_mode,
  value:PERIOD::int as period,
  year(to_date(left(period,4),'YYYY')) as year,
  value:HS4::string as hs4,
  value:HS4_NAME::string as hs4_name,
  value:HS6::string as hs6,
  value:HS6_NAME::string as hs6_name,
  value:VALUE_IN_EUROS::float as value_in_euros,
  value:QUANTITY_IN_KG::float as quantity_in_kg
from trade_flow.raw.raw_trhs
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.stg_trade"} */;
[0m22:16:58.915858 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.717 seconds
[0m22:16:58.938047 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c390d98b-118d-480a-bebf-80359e40affc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95b22090>]}
[0m22:16:58.938643 [info ] [Thread-1 (]: 1 of 7 OK created sql table model staging.stg_trade ............................ [[32mSUCCESS 1[0m in 0.78s]
[0m22:16:58.939181 [debug] [Thread-1 (]: Finished running node model.citrus_trade.stg_trade
[0m22:16:58.939892 [debug] [Thread-3 (]: Began running node model.citrus_trade.trade_by_hs
[0m22:16:58.940363 [info ] [Thread-3 (]: 2 of 7 START sql table model marts.trade_by_hs ................................. [RUN]
[0m22:16:58.940768 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_TRADE_FLOW_staging, now model.citrus_trade.trade_by_hs)
[0m22:16:58.941153 [debug] [Thread-3 (]: Began compiling node model.citrus_trade.trade_by_hs
[0m22:16:58.943567 [debug] [Thread-3 (]: Writing injected SQL for node "model.citrus_trade.trade_by_hs"
[0m22:16:58.944616 [debug] [Thread-3 (]: Began executing node model.citrus_trade.trade_by_hs
[0m22:16:58.946657 [debug] [Thread-3 (]: Writing runtime sql for node "model.citrus_trade.trade_by_hs"
[0m22:16:58.947457 [debug] [Thread-3 (]: Using snowflake connection "model.citrus_trade.trade_by_hs"
[0m22:16:58.947698 [debug] [Thread-3 (]: On model.citrus_trade.trade_by_hs: create or replace transient table TRADE_FLOW.marts.trade_by_hs
    
    
    
    as (select
    *
from TRADE_FLOW.staging.stg_trade
where hs6 = '080510'
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.trade_by_hs"} */;
[0m22:16:59.560633 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.612 seconds
[0m22:16:59.565901 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c390d98b-118d-480a-bebf-80359e40affc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95b58680>]}
[0m22:16:59.567140 [info ] [Thread-3 (]: 2 of 7 OK created sql table model marts.trade_by_hs ............................ [[32mSUCCESS 1[0m in 0.62s]
[0m22:16:59.568336 [debug] [Thread-3 (]: Finished running node model.citrus_trade.trade_by_hs
[0m22:16:59.569616 [debug] [Thread-2 (]: Began running node model.citrus_trade.imports_by_year
[0m22:16:59.570184 [debug] [Thread-1 (]: Began running node model.citrus_trade.imports_exports_2020
[0m22:16:59.570771 [info ] [Thread-2 (]: 3 of 7 START sql table model marts.imports_by_year ............................. [RUN]
[0m22:16:59.571648 [info ] [Thread-1 (]: 4 of 7 START sql table model marts.imports_exports_2020 ........................ [RUN]
[0m22:16:59.573336 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.citrus_trade.stg_trade, now model.citrus_trade.imports_exports_2020)
[0m22:16:59.573996 [debug] [Thread-1 (]: Began compiling node model.citrus_trade.imports_exports_2020
[0m22:16:59.572616 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_TRADE_FLOW_marts, now model.citrus_trade.imports_by_year)
[0m22:16:59.581776 [debug] [Thread-2 (]: Began compiling node model.citrus_trade.imports_by_year
[0m22:16:59.581001 [debug] [Thread-1 (]: Writing injected SQL for node "model.citrus_trade.imports_exports_2020"
[0m22:16:59.585461 [debug] [Thread-2 (]: Writing injected SQL for node "model.citrus_trade.imports_by_year"
[0m22:16:59.587427 [debug] [Thread-1 (]: Began executing node model.citrus_trade.imports_exports_2020
[0m22:16:59.590581 [debug] [Thread-1 (]: Writing runtime sql for node "model.citrus_trade.imports_exports_2020"
[0m22:16:59.590980 [debug] [Thread-2 (]: Began executing node model.citrus_trade.imports_by_year
[0m22:16:59.593760 [debug] [Thread-2 (]: Writing runtime sql for node "model.citrus_trade.imports_by_year"
[0m22:16:59.595750 [debug] [Thread-1 (]: Using snowflake connection "model.citrus_trade.imports_exports_2020"
[0m22:16:59.596214 [debug] [Thread-1 (]: On model.citrus_trade.imports_exports_2020: create or replace transient table TRADE_FLOW.marts.imports_exports_2020
    
    
    
    as (select
    declarant_iso,
    flow,
    sum(value_in_euros) over(partition by declarant_iso, flow) as total_value,
    sum(quantity_in_kg) over(partition by declarant_iso, flow) as total_quantity,
    total_value/nullif(total_quantity,0) as value_per_quantity
from TRADE_FLOW.marts.trade_by_hs
where year = 2020
group by 
    declarant_iso,
    flow,
    value_in_euros,
    quantity_in_kg
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.imports_exports_2020"} */;
[0m22:16:59.597136 [debug] [Thread-2 (]: Using snowflake connection "model.citrus_trade.imports_by_year"
[0m22:16:59.598897 [debug] [Thread-2 (]: On model.citrus_trade.imports_by_year: create or replace transient table TRADE_FLOW.marts.imports_by_year
    
    
    
    as (select
    declarant_iso,
    year,
    sum(value_in_euros) as total_value,
    sum(quantity_in_kg) as total_quantity,
    total_value/nullif(total_quantity,0) as value_per_quantity
from TRADE_FLOW.marts.trade_by_hs
where flow = 1
group by 1,2
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.imports_by_year"} */;
[0m22:17:00.265291 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.665 seconds
[0m22:17:00.267798 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.670 seconds
[0m22:17:00.273854 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c390d98b-118d-480a-bebf-80359e40affc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95f871a0>]}
[0m22:17:00.270890 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c390d98b-118d-480a-bebf-80359e40affc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95b6b080>]}
[0m22:17:00.274951 [info ] [Thread-1 (]: 4 of 7 OK created sql table model marts.imports_exports_2020 ................... [[32mSUCCESS 1[0m in 0.70s]
[0m22:17:00.277175 [debug] [Thread-1 (]: Finished running node model.citrus_trade.imports_exports_2020
[0m22:17:00.276214 [info ] [Thread-2 (]: 3 of 7 OK created sql table model marts.imports_by_year ........................ [[32mSUCCESS 1[0m in 0.70s]
[0m22:17:00.278031 [debug] [Thread-2 (]: Finished running node model.citrus_trade.imports_by_year
[0m22:17:00.278609 [debug] [Thread-3 (]: Began running node model.citrus_trade.score_2020
[0m22:17:00.279308 [debug] [Thread-1 (]: Began running node model.citrus_trade.growth_score
[0m22:17:00.279786 [info ] [Thread-3 (]: 5 of 7 START sql table model marts.score_2020 .................................. [RUN]
[0m22:17:00.280494 [info ] [Thread-1 (]: 6 of 7 START sql table model marts.growth_score ................................ [RUN]
[0m22:17:00.281150 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.citrus_trade.trade_by_hs, now model.citrus_trade.score_2020)
[0m22:17:00.281910 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.citrus_trade.imports_exports_2020, now model.citrus_trade.growth_score)
[0m22:17:00.282496 [debug] [Thread-3 (]: Began compiling node model.citrus_trade.score_2020
[0m22:17:00.283050 [debug] [Thread-1 (]: Began compiling node model.citrus_trade.growth_score
[0m22:17:00.287231 [debug] [Thread-3 (]: Writing injected SQL for node "model.citrus_trade.score_2020"
[0m22:17:00.291164 [debug] [Thread-1 (]: Writing injected SQL for node "model.citrus_trade.growth_score"
[0m22:17:00.293234 [debug] [Thread-1 (]: Began executing node model.citrus_trade.growth_score
[0m22:17:00.293637 [debug] [Thread-3 (]: Began executing node model.citrus_trade.score_2020
[0m22:17:00.296873 [debug] [Thread-1 (]: Writing runtime sql for node "model.citrus_trade.growth_score"
[0m22:17:00.300204 [debug] [Thread-3 (]: Writing runtime sql for node "model.citrus_trade.score_2020"
[0m22:17:00.306764 [debug] [Thread-1 (]: Using snowflake connection "model.citrus_trade.growth_score"
[0m22:17:00.308467 [debug] [Thread-1 (]: On model.citrus_trade.growth_score: create or replace transient table TRADE_FLOW.marts.growth_score
    
    
    
    as (with 
    previous_year AS (
        select 
            declarant_iso,
            year,
            lag(total_value,1) over(partition by declarant_iso order by year) previous_year_value,
            total_value,
            first_value(total_value) over(partition by declarant_iso order by year) as first_year_value,
            last_value(total_value) over(partition by declarant_iso order by year) as last_year_value
        from TRADE_FLOW.marts.imports_by_year
    ),
    growth_speed AS (
        select 
            declarant_iso,
            year,
            first_year_value,
            last_year_value,
            last_year_value/nullif(first_year_value,0) as growth_overall,
            previous_year_value,
            total_value,
            (total_value - previous_year_value)/total_value * 100 as growth_speed 
        from previous_year
    ),
    previous_year_growth_speed AS (
        select 
            declarant_iso,
            year,
            first_year_value,
            last_year_value,
            growth_overall,
            previous_year_value,
            total_value as current_value,
            growth_speed,
            lag(growth_speed,1) over(partition by declarant_iso order by year) previous_year_growth_speed,
        from growth_speed
        order by 1,2
    ),
    base AS (
        select 
            declarant_iso,
            year,
            first_year_value,
            last_year_value,
            growth_overall,
            previous_year_value,
            current_value,
            previous_year_growth_speed,
            growth_speed,
            growth_speed - previous_year_growth_speed as growth_acceleration,
            avg(growth_acceleration) over(partition by declarant_iso) as avg_acceleration
        from previous_year_growth_speed
    ),
    ok as (
        select 
            declarant_iso,
            year,
            first_year_value,
            last_year_value,
            growth_overall,
            (growth_overall - min(growth_overall) OVER())/(max(growth_overall) OVER() - min(growth_overall) OVER()) as growth_overall_norm,
            previous_year_value,
            current_value,
            -- previous_year_growth_speed,
            growth_speed,
            growth_acceleration,
            avg_acceleration,
            (avg_acceleration - min(avg_acceleration) OVER())/(max(avg_acceleration) OVER() - min(avg_acceleration) OVER()) as avg_acceleration_norm
        from base 
    )
    select 
        distinct 
        declarant_iso,
        year,
        current_value,
        growth_speed,
        growth_acceleration,
        growth_overall,
        growth_overall_norm,
        avg_acceleration,
        avg_acceleration_norm,
        growth_overall_norm * avg_acceleration_norm as growth_score
    from ok
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.growth_score"} */;
[0m22:17:00.308063 [debug] [Thread-3 (]: Using snowflake connection "model.citrus_trade.score_2020"
[0m22:17:00.310689 [debug] [Thread-3 (]: On model.citrus_trade.score_2020: create or replace transient table TRADE_FLOW.marts.score_2020
    
    
    
    as (select distinct 
    declarant_iso,
    total_value,
    total_quantity,
    value_per_quantity,
    (total_value - min(total_value) over())/((max(total_value) over())-(min(total_value) over())) as value_score,
    (total_quantity - min(total_quantity) over())/((max(total_quantity) over())-(min(total_quantity) over())) as quantity_score,
    (value_per_quantity - min(value_per_quantity) over())/((max(value_per_quantity) over())-(min(value_per_quantity) over())) as price_score
from TRADE_FLOW.marts.imports_exports_2020
where flow = 1
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.score_2020"} */;
[0m22:17:00.976355 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.666 seconds
[0m22:17:00.978865 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c390d98b-118d-480a-bebf-80359e40affc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95bbb8f0>]}
[0m22:17:00.979656 [info ] [Thread-3 (]: 5 of 7 OK created sql table model marts.score_2020 ............................. [[32mSUCCESS 1[0m in 0.70s]
[0m22:17:00.980532 [debug] [Thread-3 (]: Finished running node model.citrus_trade.score_2020
[0m22:17:01.034239 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.726 seconds
[0m22:17:01.037436 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c390d98b-118d-480a-bebf-80359e40affc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95ba7770>]}
[0m22:17:01.038466 [info ] [Thread-1 (]: 6 of 7 OK created sql table model marts.growth_score ........................... [[32mSUCCESS 1[0m in 0.76s]
[0m22:17:01.039466 [debug] [Thread-1 (]: Finished running node model.citrus_trade.growth_score
[0m22:17:01.040687 [debug] [Thread-4 (]: Began running node model.citrus_trade.importer_trade_score
[0m22:17:01.041349 [info ] [Thread-4 (]: 7 of 7 START sql table model analytics.importer_trade_score .................... [RUN]
[0m22:17:01.042143 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.citrus_trade.importer_trade_score'
[0m22:17:01.042625 [debug] [Thread-4 (]: Began compiling node model.citrus_trade.importer_trade_score
[0m22:17:01.047201 [debug] [Thread-4 (]: Writing injected SQL for node "model.citrus_trade.importer_trade_score"
[0m22:17:01.049140 [debug] [Thread-4 (]: Began executing node model.citrus_trade.importer_trade_score
[0m22:17:01.052595 [debug] [Thread-4 (]: Writing runtime sql for node "model.citrus_trade.importer_trade_score"
[0m22:17:01.054316 [debug] [Thread-4 (]: Using snowflake connection "model.citrus_trade.importer_trade_score"
[0m22:17:01.054742 [debug] [Thread-4 (]: On model.citrus_trade.importer_trade_score: create or replace transient table TRADE_FLOW.analytics.importer_trade_score
    
    
    
    as (select 
    declarant_iso,
    score_type,
    score
from (
    select 
        sc.declarant_iso,
        sc.value_score,
        sc.quantity_score,
        sc.price_score,
        gs.growth_score
    from TRADE_FLOW.marts.score_2020 as sc
    inner join TRADE_FLOW.marts.growth_score as gs
        on gs.declarant_iso = sc.declarant_iso
)
unpivot (
    score for score_type in (
        value_score,
        quantity_score,
        price_score,
        growth_score
    )
)
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.importer_trade_score"} */;
[0m22:17:01.055087 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m22:17:02.750064 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.695 seconds
[0m22:17:02.753718 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c390d98b-118d-480a-bebf-80359e40affc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95f563c0>]}
[0m22:17:02.754765 [info ] [Thread-4 (]: 7 of 7 OK created sql table model analytics.importer_trade_score ............... [[32mSUCCESS 1[0m in 1.71s]
[0m22:17:02.755905 [debug] [Thread-4 (]: Finished running node model.citrus_trade.importer_trade_score
[0m22:17:02.758006 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:17:02.758420 [debug] [MainThread]: Connection 'model.citrus_trade.score_2020' was left open.
[0m22:17:02.758794 [debug] [MainThread]: On model.citrus_trade.score_2020: Close
[0m22:17:02.939970 [debug] [MainThread]: Connection 'model.citrus_trade.growth_score' was left open.
[0m22:17:02.942015 [debug] [MainThread]: On model.citrus_trade.growth_score: Close
[0m22:17:03.097511 [debug] [MainThread]: Connection 'model.citrus_trade.imports_by_year' was left open.
[0m22:17:03.097911 [debug] [MainThread]: On model.citrus_trade.imports_by_year: Close
[0m22:17:03.221298 [debug] [MainThread]: Connection 'model.citrus_trade.importer_trade_score' was left open.
[0m22:17:03.221798 [debug] [MainThread]: On model.citrus_trade.importer_trade_score: Close
[0m22:17:03.408633 [info ] [MainThread]: 
[0m22:17:03.409975 [info ] [MainThread]: Finished running 7 table models in 0 hours 0 minutes and 6.86 seconds (6.86s).
[0m22:17:03.414425 [debug] [MainThread]: Command end result
[0m22:17:03.461289 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m22:17:03.463819 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m22:17:03.469174 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/target/run_results.json
[0m22:17:03.469447 [info ] [MainThread]: 
[0m22:17:03.469772 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:17:03.470127 [info ] [MainThread]: 
[0m22:17:03.470456 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=7
[0m22:17:03.471496 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.60105, "process_in_blocks": "0", "process_kernel_time": 0.323105, "process_mem_max_rss": "153468", "process_out_blocks": "4263", "process_user_time": 1.800157}
[0m22:17:03.471909 [debug] [MainThread]: Command `dbt run` succeeded at 22:17:03.471842 after 7.60 seconds
[0m22:17:03.472217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9bcb4c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff985922d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99d6dd00>]}
[0m22:17:03.472511 [debug] [MainThread]: Flushing usage events
[0m22:17:04.943282 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:17:33.505626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7a36ec30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7aaa3b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7aaa3bf0>]}


============================== 22:17:33.508364 | 0325b3c9-b64e-4f31-af25-84c25c827252 ==============================
[0m22:17:33.508364 [info ] [MainThread]: Running with dbt=1.10.13
[0m22:17:33.508804 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'empty': 'False', 'warn_error': 'None', 'quiet': 'False', 'write_json': 'True', 'introspect': 'True', 'no_print': 'None', 'log_cache_events': 'False', 'printer_width': '80', 'debug': 'False', 'partial_parse': 'True', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'invocation_command': 'dbt run', 'profiles_dir': '/opt/airflow/dbt', 'target_path': 'None', 'cache_selected_only': 'False', 'version_check': 'True', 'use_experimental_parser': 'False', 'log_path': '/opt/airflow/dbt/logs', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'use_colors': 'True'}
[0m22:17:33.626752 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m22:17:33.627160 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m22:17:33.627351 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m22:17:33.769047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0325b3c9-b64e-4f31-af25-84c25c827252', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff78f12600>]}
[0m22:17:33.822090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0325b3c9-b64e-4f31-af25-84c25c827252', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff78c62ba0>]}
[0m22:17:33.823176 [info ] [MainThread]: Registered adapter: snowflake=1.10.3
[0m22:17:34.100435 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m22:17:34.411544 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:17:34.412372 [debug] [MainThread]: Partial parsing: updated file: citrus_trade://models/analytics/importer_trade_score.sql
[0m22:17:34.581050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0325b3c9-b64e-4f31-af25-84c25c827252', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff787db830>]}
[0m22:17:34.628272 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m22:17:34.629754 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m22:17:34.639476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0325b3c9-b64e-4f31-af25-84c25c827252', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff786b4740>]}
[0m22:17:34.639750 [info ] [MainThread]: Found 7 models, 3 sources, 636 macros
[0m22:17:34.639979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0325b3c9-b64e-4f31-af25-84c25c827252', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff78802150>]}
[0m22:17:34.641239 [info ] [MainThread]: 
[0m22:17:34.641512 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:17:34.641868 [info ] [MainThread]: 
[0m22:17:34.642240 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:17:34.644948 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRADE_FLOW'
[0m22:17:34.651133 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRADE_FLOW'
[0m22:17:34.652994 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRADE_FLOW'
[0m22:17:34.701088 [debug] [ThreadPool]: Using snowflake connection "list_TRADE_FLOW"
[0m22:17:34.701412 [debug] [ThreadPool]: Using snowflake connection "list_TRADE_FLOW"
[0m22:17:34.701638 [debug] [ThreadPool]: Using snowflake connection "list_TRADE_FLOW"
[0m22:17:34.701791 [debug] [ThreadPool]: On list_TRADE_FLOW: show terse schemas in database TRADE_FLOW
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRADE_FLOW"} */
[0m22:17:34.702054 [debug] [ThreadPool]: On list_TRADE_FLOW: show terse schemas in database TRADE_FLOW
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRADE_FLOW"} */
[0m22:17:34.702308 [debug] [ThreadPool]: On list_TRADE_FLOW: show terse schemas in database TRADE_FLOW
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRADE_FLOW"} */
[0m22:17:34.702497 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:17:34.702691 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:17:34.702909 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:17:36.129039 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.426 seconds
[0m22:17:36.130459 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.428 seconds
[0m22:17:36.135856 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.433 seconds
[0m22:17:36.142373 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRADE_FLOW, now list_TRADE_FLOW_analytics)
[0m22:17:36.149098 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRADE_FLOW, now list_TRADE_FLOW_marts)
[0m22:17:36.164198 [debug] [ThreadPool]: Using snowflake connection "list_TRADE_FLOW_analytics"
[0m22:17:36.166125 [debug] [ThreadPool]: Using snowflake connection "list_TRADE_FLOW_marts"
[0m22:17:36.166513 [debug] [ThreadPool]: On list_TRADE_FLOW_analytics: show objects in TRADE_FLOW.analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRADE_FLOW_analytics"} */;
[0m22:17:36.166887 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRADE_FLOW, now list_TRADE_FLOW_staging)
[0m22:17:36.167245 [debug] [ThreadPool]: On list_TRADE_FLOW_marts: show objects in TRADE_FLOW.marts
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRADE_FLOW_marts"} */;
[0m22:17:36.170281 [debug] [ThreadPool]: Using snowflake connection "list_TRADE_FLOW_staging"
[0m22:17:36.171099 [debug] [ThreadPool]: On list_TRADE_FLOW_staging: show objects in TRADE_FLOW.staging
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRADE_FLOW_staging"} */;
[0m22:17:36.255967 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.088 seconds
[0m22:17:36.260802 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.089 seconds
[0m22:17:36.264274 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.094 seconds
[0m22:17:36.267755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0325b3c9-b64e-4f31-af25-84c25c827252', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7aad6870>]}
[0m22:17:36.271837 [debug] [Thread-1 (]: Began running node model.citrus_trade.stg_trade
[0m22:17:36.272461 [info ] [Thread-1 (]: 1 of 7 START sql table model staging.stg_trade ................................. [RUN]
[0m22:17:36.273008 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_TRADE_FLOW_marts, now model.citrus_trade.stg_trade)
[0m22:17:36.273417 [debug] [Thread-1 (]: Began compiling node model.citrus_trade.stg_trade
[0m22:17:36.284124 [debug] [Thread-1 (]: Writing injected SQL for node "model.citrus_trade.stg_trade"
[0m22:17:36.286394 [debug] [Thread-1 (]: Began executing node model.citrus_trade.stg_trade
[0m22:17:36.314493 [debug] [Thread-1 (]: Writing runtime sql for node "model.citrus_trade.stg_trade"
[0m22:17:36.316588 [debug] [Thread-1 (]: Using snowflake connection "model.citrus_trade.stg_trade"
[0m22:17:36.316920 [debug] [Thread-1 (]: On model.citrus_trade.stg_trade: create or replace transient table TRADE_FLOW.staging.stg_trade
    
    
    
    as (select
  value:DECLARANT::int as declarant,
  value:DECLARANT_ISO::string as declarant_iso,
  value:PARTNER::string as partner,
  value:PARTNER_ISO::string as partner_iso,
  value:FLOW::int as flow,
  value:TRANSPORT_MODE::int as transport_mode,
  value:PERIOD::int as period,
  year(to_date(left(period,4),'YYYY')) as year,
  value:HS4::string as hs4,
  value:HS4_NAME::string as hs4_name,
  value:HS6::string as hs6,
  value:HS6_NAME::string as hs6_name,
  value:VALUE_IN_EUROS::float as value_in_euros,
  value:QUANTITY_IN_KG::float as quantity_in_kg
from trade_flow.raw.raw_trhs
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.stg_trade"} */;
[0m22:17:37.054703 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.737 seconds
[0m22:17:37.089200 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0325b3c9-b64e-4f31-af25-84c25c827252', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff76f7f890>]}
[0m22:17:37.090140 [info ] [Thread-1 (]: 1 of 7 OK created sql table model staging.stg_trade ............................ [[32mSUCCESS 1[0m in 0.82s]
[0m22:17:37.090928 [debug] [Thread-1 (]: Finished running node model.citrus_trade.stg_trade
[0m22:17:37.092154 [debug] [Thread-3 (]: Began running node model.citrus_trade.trade_by_hs
[0m22:17:37.092891 [info ] [Thread-3 (]: 2 of 7 START sql table model marts.trade_by_hs ................................. [RUN]
[0m22:17:37.093462 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_TRADE_FLOW_analytics, now model.citrus_trade.trade_by_hs)
[0m22:17:37.093901 [debug] [Thread-3 (]: Began compiling node model.citrus_trade.trade_by_hs
[0m22:17:37.097383 [debug] [Thread-3 (]: Writing injected SQL for node "model.citrus_trade.trade_by_hs"
[0m22:17:37.099028 [debug] [Thread-3 (]: Began executing node model.citrus_trade.trade_by_hs
[0m22:17:37.102153 [debug] [Thread-3 (]: Writing runtime sql for node "model.citrus_trade.trade_by_hs"
[0m22:17:37.103348 [debug] [Thread-3 (]: Using snowflake connection "model.citrus_trade.trade_by_hs"
[0m22:17:37.103644 [debug] [Thread-3 (]: On model.citrus_trade.trade_by_hs: create or replace transient table TRADE_FLOW.marts.trade_by_hs
    
    
    
    as (select
    *
from TRADE_FLOW.staging.stg_trade
where hs6 = '080510'
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.trade_by_hs"} */;
[0m22:17:37.743302 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.639 seconds
[0m22:17:37.749026 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0325b3c9-b64e-4f31-af25-84c25c827252', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff76b7bf80>]}
[0m22:17:37.750676 [info ] [Thread-3 (]: 2 of 7 OK created sql table model marts.trade_by_hs ............................ [[32mSUCCESS 1[0m in 0.66s]
[0m22:17:37.751922 [debug] [Thread-3 (]: Finished running node model.citrus_trade.trade_by_hs
[0m22:17:37.753954 [debug] [Thread-2 (]: Began running node model.citrus_trade.imports_by_year
[0m22:17:37.754572 [debug] [Thread-1 (]: Began running node model.citrus_trade.imports_exports_2020
[0m22:17:37.755285 [info ] [Thread-2 (]: 3 of 7 START sql table model marts.imports_by_year ............................. [RUN]
[0m22:17:37.756484 [info ] [Thread-1 (]: 4 of 7 START sql table model marts.imports_exports_2020 ........................ [RUN]
[0m22:17:37.757744 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_TRADE_FLOW_staging, now model.citrus_trade.imports_by_year)
[0m22:17:37.759421 [debug] [Thread-2 (]: Began compiling node model.citrus_trade.imports_by_year
[0m22:17:37.758769 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.citrus_trade.stg_trade, now model.citrus_trade.imports_exports_2020)
[0m22:17:37.765149 [debug] [Thread-1 (]: Began compiling node model.citrus_trade.imports_exports_2020
[0m22:17:37.764443 [debug] [Thread-2 (]: Writing injected SQL for node "model.citrus_trade.imports_by_year"
[0m22:17:37.772432 [debug] [Thread-1 (]: Writing injected SQL for node "model.citrus_trade.imports_exports_2020"
[0m22:17:37.775103 [debug] [Thread-2 (]: Began executing node model.citrus_trade.imports_by_year
[0m22:17:37.778462 [debug] [Thread-2 (]: Writing runtime sql for node "model.citrus_trade.imports_by_year"
[0m22:17:37.779026 [debug] [Thread-1 (]: Began executing node model.citrus_trade.imports_exports_2020
[0m22:17:37.782298 [debug] [Thread-1 (]: Writing runtime sql for node "model.citrus_trade.imports_exports_2020"
[0m22:17:37.783749 [debug] [Thread-2 (]: Using snowflake connection "model.citrus_trade.imports_by_year"
[0m22:17:37.784182 [debug] [Thread-2 (]: On model.citrus_trade.imports_by_year: create or replace transient table TRADE_FLOW.marts.imports_by_year
    
    
    
    as (select
    declarant_iso,
    year,
    sum(value_in_euros) as total_value,
    sum(quantity_in_kg) as total_quantity,
    total_value/nullif(total_quantity,0) as value_per_quantity
from TRADE_FLOW.marts.trade_by_hs
where flow = 1
group by 1,2
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.imports_by_year"} */;
[0m22:17:37.787360 [debug] [Thread-1 (]: Using snowflake connection "model.citrus_trade.imports_exports_2020"
[0m22:17:37.787979 [debug] [Thread-1 (]: On model.citrus_trade.imports_exports_2020: create or replace transient table TRADE_FLOW.marts.imports_exports_2020
    
    
    
    as (select
    declarant_iso,
    flow,
    sum(value_in_euros) over(partition by declarant_iso, flow) as total_value,
    sum(quantity_in_kg) over(partition by declarant_iso, flow) as total_quantity,
    total_value/nullif(total_quantity,0) as value_per_quantity
from TRADE_FLOW.marts.trade_by_hs
where year = 2020
group by 
    declarant_iso,
    flow,
    value_in_euros,
    quantity_in_kg
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.imports_exports_2020"} */;
[0m22:17:38.404203 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.619 seconds
[0m22:17:38.410854 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0325b3c9-b64e-4f31-af25-84c25c827252', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff76b53ce0>]}
[0m22:17:38.412375 [info ] [Thread-2 (]: 3 of 7 OK created sql table model marts.imports_by_year ........................ [[32mSUCCESS 1[0m in 0.65s]
[0m22:17:38.413772 [debug] [Thread-2 (]: Finished running node model.citrus_trade.imports_by_year
[0m22:17:38.415145 [debug] [Thread-3 (]: Began running node model.citrus_trade.growth_score
[0m22:17:38.416004 [info ] [Thread-3 (]: 5 of 7 START sql table model marts.growth_score ................................ [RUN]
[0m22:17:38.416961 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.citrus_trade.trade_by_hs, now model.citrus_trade.growth_score)
[0m22:17:38.417646 [debug] [Thread-3 (]: Began compiling node model.citrus_trade.growth_score
[0m22:17:38.423407 [debug] [Thread-3 (]: Writing injected SQL for node "model.citrus_trade.growth_score"
[0m22:17:38.425076 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.637 seconds
[0m22:17:38.427761 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0325b3c9-b64e-4f31-af25-84c25c827252', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff773ed760>]}
[0m22:17:38.428608 [info ] [Thread-1 (]: 4 of 7 OK created sql table model marts.imports_exports_2020 ................... [[32mSUCCESS 1[0m in 0.67s]
[0m22:17:38.429610 [debug] [Thread-1 (]: Finished running node model.citrus_trade.imports_exports_2020
[0m22:17:38.430447 [debug] [Thread-2 (]: Began running node model.citrus_trade.score_2020
[0m22:17:38.430806 [debug] [Thread-3 (]: Began executing node model.citrus_trade.growth_score
[0m22:17:38.431337 [info ] [Thread-2 (]: 6 of 7 START sql table model marts.score_2020 .................................. [RUN]
[0m22:17:38.435266 [debug] [Thread-3 (]: Writing runtime sql for node "model.citrus_trade.growth_score"
[0m22:17:38.437225 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.citrus_trade.imports_by_year, now model.citrus_trade.score_2020)
[0m22:17:38.438053 [debug] [Thread-2 (]: Began compiling node model.citrus_trade.score_2020
[0m22:17:38.441270 [debug] [Thread-2 (]: Writing injected SQL for node "model.citrus_trade.score_2020"
[0m22:17:38.444712 [debug] [Thread-3 (]: Using snowflake connection "model.citrus_trade.growth_score"
[0m22:17:38.445363 [debug] [Thread-3 (]: On model.citrus_trade.growth_score: create or replace transient table TRADE_FLOW.marts.growth_score
    
    
    
    as (with 
    previous_year AS (
        select 
            declarant_iso,
            year,
            lag(total_value,1) over(partition by declarant_iso order by year) previous_year_value,
            total_value,
            first_value(total_value) over(partition by declarant_iso order by year) as first_year_value,
            last_value(total_value) over(partition by declarant_iso order by year) as last_year_value
        from TRADE_FLOW.marts.imports_by_year
    ),
    growth_speed AS (
        select 
            declarant_iso,
            year,
            first_year_value,
            last_year_value,
            last_year_value/nullif(first_year_value,0) as growth_overall,
            previous_year_value,
            total_value,
            (total_value - previous_year_value)/total_value * 100 as growth_speed 
        from previous_year
    ),
    previous_year_growth_speed AS (
        select 
            declarant_iso,
            year,
            first_year_value,
            last_year_value,
            growth_overall,
            previous_year_value,
            total_value as current_value,
            growth_speed,
            lag(growth_speed,1) over(partition by declarant_iso order by year) previous_year_growth_speed,
        from growth_speed
        order by 1,2
    ),
    base AS (
        select 
            declarant_iso,
            year,
            first_year_value,
            last_year_value,
            growth_overall,
            previous_year_value,
            current_value,
            previous_year_growth_speed,
            growth_speed,
            growth_speed - previous_year_growth_speed as growth_acceleration,
            avg(growth_acceleration) over(partition by declarant_iso) as avg_acceleration
        from previous_year_growth_speed
    ),
    ok as (
        select 
            declarant_iso,
            year,
            first_year_value,
            last_year_value,
            growth_overall,
            (growth_overall - min(growth_overall) OVER())/(max(growth_overall) OVER() - min(growth_overall) OVER()) as growth_overall_norm,
            previous_year_value,
            current_value,
            -- previous_year_growth_speed,
            growth_speed,
            growth_acceleration,
            avg_acceleration,
            (avg_acceleration - min(avg_acceleration) OVER())/(max(avg_acceleration) OVER() - min(avg_acceleration) OVER()) as avg_acceleration_norm
        from base 
    )
    select 
        distinct 
        declarant_iso,
        year,
        current_value,
        growth_speed,
        growth_acceleration,
        growth_overall,
        growth_overall_norm,
        avg_acceleration,
        avg_acceleration_norm,
        growth_overall_norm * avg_acceleration_norm as growth_score
    from ok
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.growth_score"} */;
[0m22:17:38.449612 [debug] [Thread-2 (]: Began executing node model.citrus_trade.score_2020
[0m22:17:38.452587 [debug] [Thread-2 (]: Writing runtime sql for node "model.citrus_trade.score_2020"
[0m22:17:38.454464 [debug] [Thread-2 (]: Using snowflake connection "model.citrus_trade.score_2020"
[0m22:17:38.454857 [debug] [Thread-2 (]: On model.citrus_trade.score_2020: create or replace transient table TRADE_FLOW.marts.score_2020
    
    
    
    as (select distinct 
    declarant_iso,
    total_value,
    total_quantity,
    value_per_quantity,
    (total_value - min(total_value) over())/((max(total_value) over())-(min(total_value) over())) as value_score,
    (total_quantity - min(total_quantity) over())/((max(total_quantity) over())-(min(total_quantity) over())) as quantity_score,
    (value_per_quantity - min(value_per_quantity) over())/((max(value_per_quantity) over())-(min(value_per_quantity) over())) as price_score
from TRADE_FLOW.marts.imports_exports_2020
where flow = 1
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.score_2020"} */;
[0m22:17:39.102725 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.647 seconds
[0m22:17:39.109264 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0325b3c9-b64e-4f31-af25-84c25c827252', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff76f80c20>]}
[0m22:17:39.111051 [info ] [Thread-2 (]: 6 of 7 OK created sql table model marts.score_2020 ............................. [[32mSUCCESS 1[0m in 0.67s]
[0m22:17:39.112428 [debug] [Thread-2 (]: Finished running node model.citrus_trade.score_2020
[0m22:17:39.140536 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.694 seconds
[0m22:17:39.143423 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0325b3c9-b64e-4f31-af25-84c25c827252', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff76b692e0>]}
[0m22:17:39.144407 [info ] [Thread-3 (]: 5 of 7 OK created sql table model marts.growth_score ........................... [[32mSUCCESS 1[0m in 0.73s]
[0m22:17:39.145892 [debug] [Thread-3 (]: Finished running node model.citrus_trade.growth_score
[0m22:17:39.147234 [debug] [Thread-1 (]: Began running node model.citrus_trade.importer_trade_score
[0m22:17:39.148082 [info ] [Thread-1 (]: 7 of 7 START sql table model analytics.importer_trade_score .................... [RUN]
[0m22:17:39.148688 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.citrus_trade.imports_exports_2020, now model.citrus_trade.importer_trade_score)
[0m22:17:39.149292 [debug] [Thread-1 (]: Began compiling node model.citrus_trade.importer_trade_score
[0m22:17:39.154689 [debug] [Thread-1 (]: Writing injected SQL for node "model.citrus_trade.importer_trade_score"
[0m22:17:39.155876 [debug] [Thread-1 (]: Began executing node model.citrus_trade.importer_trade_score
[0m22:17:39.157699 [debug] [Thread-1 (]: Writing runtime sql for node "model.citrus_trade.importer_trade_score"
[0m22:17:39.159252 [debug] [Thread-1 (]: Using snowflake connection "model.citrus_trade.importer_trade_score"
[0m22:17:39.159619 [debug] [Thread-1 (]: On model.citrus_trade.importer_trade_score: create or replace transient table TRADE_FLOW.analytics.importer_trade_score
    
    
    
    as (select 
    declarant_iso,
    score_type,
    score
from (
    select distinct
        sc.declarant_iso,
        sc.value_score,
        sc.quantity_score,
        sc.price_score,
        gs.growth_score
    from TRADE_FLOW.marts.score_2020 as sc
    inner join TRADE_FLOW.marts.growth_score as gs
        on gs.declarant_iso = sc.declarant_iso
)
unpivot (
    score for score_type in (
        value_score,
        quantity_score,
        price_score,
        growth_score
    )
)
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.importer_trade_score"} */;
[0m22:17:39.822291 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.662 seconds
[0m22:17:39.827561 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0325b3c9-b64e-4f31-af25-84c25c827252', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff76b367e0>]}
[0m22:17:39.828968 [info ] [Thread-1 (]: 7 of 7 OK created sql table model analytics.importer_trade_score ............... [[32mSUCCESS 1[0m in 0.68s]
[0m22:17:39.830165 [debug] [Thread-1 (]: Finished running node model.citrus_trade.importer_trade_score
[0m22:17:39.833523 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:17:39.834160 [debug] [MainThread]: Connection 'model.citrus_trade.growth_score' was left open.
[0m22:17:39.834777 [debug] [MainThread]: On model.citrus_trade.growth_score: Close
[0m22:17:40.033228 [debug] [MainThread]: Connection 'model.citrus_trade.importer_trade_score' was left open.
[0m22:17:40.034789 [debug] [MainThread]: On model.citrus_trade.importer_trade_score: Close
[0m22:17:40.176725 [debug] [MainThread]: Connection 'model.citrus_trade.score_2020' was left open.
[0m22:17:40.177375 [debug] [MainThread]: On model.citrus_trade.score_2020: Close
[0m22:17:40.290168 [info ] [MainThread]: 
[0m22:17:40.291092 [info ] [MainThread]: Finished running 7 table models in 0 hours 0 minutes and 5.65 seconds (5.65s).
[0m22:17:40.293150 [debug] [MainThread]: Command end result
[0m22:17:40.338863 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m22:17:40.341671 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m22:17:40.348905 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/target/run_results.json
[0m22:17:40.349184 [info ] [MainThread]: 
[0m22:17:40.349471 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:17:40.349862 [info ] [MainThread]: 
[0m22:17:40.350248 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=7
[0m22:17:40.351624 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.875797, "process_in_blocks": "0", "process_kernel_time": 0.408943, "process_mem_max_rss": "151248", "process_out_blocks": "4264", "process_user_time": 2.182787}
[0m22:17:40.352072 [debug] [MainThread]: Command `dbt run` succeeded at 22:17:40.351993 after 6.88 seconds
[0m22:17:40.352362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7a8ff140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff78801d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff783544a0>]}
[0m22:17:40.352612 [debug] [MainThread]: Flushing usage events
[0m22:17:41.735078 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:22:40.234508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ce46ba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f251160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7cec0bf0>]}


============================== 22:22:40.237134 | 0651fd0b-4188-4f71-8cc2-76c8b580e28a ==============================
[0m22:22:40.237134 [info ] [MainThread]: Running with dbt=1.10.13
[0m22:22:40.237483 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'log_cache_events': 'False', 'invocation_command': 'dbt run', 'log_format': 'default', 'log_path': '/opt/airflow/dbt/logs', 'partial_parse': 'True', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'introspect': 'True', 'static_parser': 'True', 'printer_width': '80', 'indirect_selection': 'eager', 'empty': 'False', 'debug': 'False', 'use_colors': 'True', 'warn_error': 'None', 'write_json': 'True', 'quiet': 'False', 'cache_selected_only': 'False', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m22:22:40.383411 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m22:22:40.383826 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m22:22:40.384063 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m22:22:40.492086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0651fd0b-4188-4f71-8cc2-76c8b580e28a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f183fe0>]}
[0m22:22:40.526515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0651fd0b-4188-4f71-8cc2-76c8b580e28a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b212660>]}
[0m22:22:40.527155 [info ] [MainThread]: Registered adapter: snowflake=1.10.3
[0m22:22:40.577200 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m22:22:40.693504 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 2 files added, 0 files changed.
[0m22:22:40.693868 [debug] [MainThread]: Partial parsing: added file: citrus_trade://models/marts/importer_score.sql
[0m22:22:40.694062 [debug] [MainThread]: Partial parsing: added file: citrus_trade://models/analytics/viz_importer_score.sql
[0m22:22:40.694204 [debug] [MainThread]: Partial parsing: deleted file: citrus_trade://models/analytics/importer_trade_score.sql
[0m22:22:40.822699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0651fd0b-4188-4f71-8cc2-76c8b580e28a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7adb2180>]}
[0m22:22:40.867190 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m22:22:40.868587 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m22:22:40.877411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0651fd0b-4188-4f71-8cc2-76c8b580e28a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7a96c5c0>]}
[0m22:22:40.877663 [info ] [MainThread]: Found 8 models, 3 sources, 636 macros
[0m22:22:40.877871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0651fd0b-4188-4f71-8cc2-76c8b580e28a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7a9c3ce0>]}
[0m22:22:40.878970 [info ] [MainThread]: 
[0m22:22:40.879212 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:22:40.879707 [info ] [MainThread]: 
[0m22:22:40.880057 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:22:40.882836 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRADE_FLOW'
[0m22:22:40.889640 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRADE_FLOW'
[0m22:22:40.892347 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRADE_FLOW'
[0m22:22:40.929311 [debug] [ThreadPool]: Using snowflake connection "list_TRADE_FLOW"
[0m22:22:40.929679 [debug] [ThreadPool]: Using snowflake connection "list_TRADE_FLOW"
[0m22:22:40.929914 [debug] [ThreadPool]: Using snowflake connection "list_TRADE_FLOW"
[0m22:22:40.930093 [debug] [ThreadPool]: On list_TRADE_FLOW: show terse schemas in database TRADE_FLOW
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRADE_FLOW"} */
[0m22:22:40.930335 [debug] [ThreadPool]: On list_TRADE_FLOW: show terse schemas in database TRADE_FLOW
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRADE_FLOW"} */
[0m22:22:40.930555 [debug] [ThreadPool]: On list_TRADE_FLOW: show terse schemas in database TRADE_FLOW
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRADE_FLOW"} */
[0m22:22:40.930746 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:22:40.930951 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:22:40.931149 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:22:42.630365 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.699 seconds
[0m22:22:42.632293 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.701 seconds
[0m22:22:42.645189 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.714 seconds
[0m22:22:42.650518 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRADE_FLOW, now list_TRADE_FLOW_staging)
[0m22:22:42.657499 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRADE_FLOW, now list_TRADE_FLOW_analytics)
[0m22:22:42.674347 [debug] [ThreadPool]: Using snowflake connection "list_TRADE_FLOW_staging"
[0m22:22:42.680716 [debug] [ThreadPool]: Using snowflake connection "list_TRADE_FLOW_analytics"
[0m22:22:42.681169 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRADE_FLOW, now list_TRADE_FLOW_marts)
[0m22:22:42.681462 [debug] [ThreadPool]: On list_TRADE_FLOW_staging: show objects in TRADE_FLOW.staging
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRADE_FLOW_staging"} */;
[0m22:22:42.681915 [debug] [ThreadPool]: On list_TRADE_FLOW_analytics: show objects in TRADE_FLOW.analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRADE_FLOW_analytics"} */;
[0m22:22:42.684148 [debug] [ThreadPool]: Using snowflake connection "list_TRADE_FLOW_marts"
[0m22:22:42.686216 [debug] [ThreadPool]: On list_TRADE_FLOW_marts: show objects in TRADE_FLOW.marts
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRADE_FLOW_marts"} */;
[0m22:22:42.799277 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.112 seconds
[0m22:22:42.800326 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.114 seconds
[0m22:22:42.809509 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.125 seconds
[0m22:22:42.812044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0651fd0b-4188-4f71-8cc2-76c8b580e28a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7af3cce0>]}
[0m22:22:42.816082 [debug] [Thread-1 (]: Began running node model.citrus_trade.stg_trade
[0m22:22:42.816670 [info ] [Thread-1 (]: 1 of 8 START sql table model staging.stg_trade ................................. [RUN]
[0m22:22:42.817218 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_TRADE_FLOW_staging, now model.citrus_trade.stg_trade)
[0m22:22:42.817751 [debug] [Thread-1 (]: Began compiling node model.citrus_trade.stg_trade
[0m22:22:42.826887 [debug] [Thread-1 (]: Writing injected SQL for node "model.citrus_trade.stg_trade"
[0m22:22:42.829386 [debug] [Thread-1 (]: Began executing node model.citrus_trade.stg_trade
[0m22:22:42.854138 [debug] [Thread-1 (]: Writing runtime sql for node "model.citrus_trade.stg_trade"
[0m22:22:42.856239 [debug] [Thread-1 (]: Using snowflake connection "model.citrus_trade.stg_trade"
[0m22:22:42.856539 [debug] [Thread-1 (]: On model.citrus_trade.stg_trade: create or replace transient table TRADE_FLOW.staging.stg_trade
    
    
    
    as (select
  value:DECLARANT::int as declarant,
  value:DECLARANT_ISO::string as declarant_iso,
  value:PARTNER::string as partner,
  value:PARTNER_ISO::string as partner_iso,
  value:FLOW::int as flow,
  value:TRANSPORT_MODE::int as transport_mode,
  value:PERIOD::int as period,
  year(to_date(left(period,4),'YYYY')) as year,
  value:HS4::string as hs4,
  value:HS4_NAME::string as hs4_name,
  value:HS6::string as hs6,
  value:HS6_NAME::string as hs6_name,
  value:VALUE_IN_EUROS::float as value_in_euros,
  value:QUANTITY_IN_KG::float as quantity_in_kg
from trade_flow.raw.raw_trhs
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.stg_trade"} */;
[0m22:22:43.638554 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.781 seconds
[0m22:22:43.671778 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0651fd0b-4188-4f71-8cc2-76c8b580e28a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f0b1910>]}
[0m22:22:43.672973 [info ] [Thread-1 (]: 1 of 8 OK created sql table model staging.stg_trade ............................ [[32mSUCCESS 1[0m in 0.85s]
[0m22:22:43.674238 [debug] [Thread-1 (]: Finished running node model.citrus_trade.stg_trade
[0m22:22:43.676241 [debug] [Thread-3 (]: Began running node model.citrus_trade.trade_by_hs
[0m22:22:43.676881 [info ] [Thread-3 (]: 2 of 8 START sql table model marts.trade_by_hs ................................. [RUN]
[0m22:22:43.677430 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_TRADE_FLOW_marts, now model.citrus_trade.trade_by_hs)
[0m22:22:43.677922 [debug] [Thread-3 (]: Began compiling node model.citrus_trade.trade_by_hs
[0m22:22:43.681970 [debug] [Thread-3 (]: Writing injected SQL for node "model.citrus_trade.trade_by_hs"
[0m22:22:43.684275 [debug] [Thread-3 (]: Began executing node model.citrus_trade.trade_by_hs
[0m22:22:43.687465 [debug] [Thread-3 (]: Writing runtime sql for node "model.citrus_trade.trade_by_hs"
[0m22:22:43.689232 [debug] [Thread-3 (]: Using snowflake connection "model.citrus_trade.trade_by_hs"
[0m22:22:43.689546 [debug] [Thread-3 (]: On model.citrus_trade.trade_by_hs: create or replace transient table TRADE_FLOW.marts.trade_by_hs
    
    
    
    as (select
    *
from TRADE_FLOW.staging.stg_trade
where hs6 = '080510'
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.trade_by_hs"} */;
[0m22:22:44.352829 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.663 seconds
[0m22:22:44.355106 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0651fd0b-4188-4f71-8cc2-76c8b580e28a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff79176540>]}
[0m22:22:44.355845 [info ] [Thread-3 (]: 2 of 8 OK created sql table model marts.trade_by_hs ............................ [[32mSUCCESS 1[0m in 0.68s]
[0m22:22:44.356864 [debug] [Thread-3 (]: Finished running node model.citrus_trade.trade_by_hs
[0m22:22:44.358089 [debug] [Thread-2 (]: Began running node model.citrus_trade.imports_by_year
[0m22:22:44.358561 [debug] [Thread-1 (]: Began running node model.citrus_trade.imports_exports_2020
[0m22:22:44.358988 [info ] [Thread-2 (]: 3 of 8 START sql table model marts.imports_by_year ............................. [RUN]
[0m22:22:44.360111 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_TRADE_FLOW_analytics, now model.citrus_trade.imports_by_year)
[0m22:22:44.360698 [debug] [Thread-2 (]: Began compiling node model.citrus_trade.imports_by_year
[0m22:22:44.359524 [info ] [Thread-1 (]: 4 of 8 START sql table model marts.imports_exports_2020 ........................ [RUN]
[0m22:22:44.363769 [debug] [Thread-2 (]: Writing injected SQL for node "model.citrus_trade.imports_by_year"
[0m22:22:44.364313 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.citrus_trade.stg_trade, now model.citrus_trade.imports_exports_2020)
[0m22:22:44.365435 [debug] [Thread-1 (]: Began compiling node model.citrus_trade.imports_exports_2020
[0m22:22:44.369093 [debug] [Thread-1 (]: Writing injected SQL for node "model.citrus_trade.imports_exports_2020"
[0m22:22:44.370315 [debug] [Thread-2 (]: Began executing node model.citrus_trade.imports_by_year
[0m22:22:44.372988 [debug] [Thread-2 (]: Writing runtime sql for node "model.citrus_trade.imports_by_year"
[0m22:22:44.374830 [debug] [Thread-1 (]: Began executing node model.citrus_trade.imports_exports_2020
[0m22:22:44.377025 [debug] [Thread-1 (]: Writing runtime sql for node "model.citrus_trade.imports_exports_2020"
[0m22:22:44.379056 [debug] [Thread-2 (]: Using snowflake connection "model.citrus_trade.imports_by_year"
[0m22:22:44.379885 [debug] [Thread-2 (]: On model.citrus_trade.imports_by_year: create or replace transient table TRADE_FLOW.marts.imports_by_year
    
    
    
    as (select
    declarant_iso,
    year,
    sum(value_in_euros) as total_value,
    sum(quantity_in_kg) as total_quantity,
    total_value/nullif(total_quantity,0) as value_per_quantity
from TRADE_FLOW.marts.trade_by_hs
where flow = 1
group by 1,2
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.imports_by_year"} */;
[0m22:22:44.382306 [debug] [Thread-1 (]: Using snowflake connection "model.citrus_trade.imports_exports_2020"
[0m22:22:44.382666 [debug] [Thread-1 (]: On model.citrus_trade.imports_exports_2020: create or replace transient table TRADE_FLOW.marts.imports_exports_2020
    
    
    
    as (select
    declarant_iso,
    flow,
    sum(value_in_euros) over(partition by declarant_iso, flow) as total_value,
    sum(quantity_in_kg) over(partition by declarant_iso, flow) as total_quantity,
    total_value/nullif(total_quantity,0) as value_per_quantity
from TRADE_FLOW.marts.trade_by_hs
where year = 2020
group by 
    declarant_iso,
    flow,
    value_in_euros,
    quantity_in_kg
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.imports_exports_2020"} */;
[0m22:22:45.062063 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.679 seconds
[0m22:22:45.064717 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0651fd0b-4188-4f71-8cc2-76c8b580e28a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff791678f0>]}
[0m22:22:45.065585 [info ] [Thread-1 (]: 4 of 8 OK created sql table model marts.imports_exports_2020 ................... [[32mSUCCESS 1[0m in 0.70s]
[0m22:22:45.066518 [debug] [Thread-1 (]: Finished running node model.citrus_trade.imports_exports_2020
[0m22:22:45.067384 [debug] [Thread-3 (]: Began running node model.citrus_trade.score_2020
[0m22:22:45.067987 [info ] [Thread-3 (]: 5 of 8 START sql table model marts.score_2020 .................................. [RUN]
[0m22:22:45.068735 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.citrus_trade.trade_by_hs, now model.citrus_trade.score_2020)
[0m22:22:45.069365 [debug] [Thread-3 (]: Began compiling node model.citrus_trade.score_2020
[0m22:22:45.075837 [debug] [Thread-3 (]: Writing injected SQL for node "model.citrus_trade.score_2020"
[0m22:22:45.079945 [debug] [Thread-3 (]: Began executing node model.citrus_trade.score_2020
[0m22:22:45.083303 [debug] [Thread-3 (]: Writing runtime sql for node "model.citrus_trade.score_2020"
[0m22:22:45.084652 [debug] [Thread-3 (]: Using snowflake connection "model.citrus_trade.score_2020"
[0m22:22:45.084959 [debug] [Thread-3 (]: On model.citrus_trade.score_2020: create or replace transient table TRADE_FLOW.marts.score_2020
    
    
    
    as (select distinct 
    declarant_iso,
    total_value,
    total_quantity,
    value_per_quantity,
    (total_value - min(total_value) over())/((max(total_value) over())-(min(total_value) over())) as value_score,
    (total_quantity - min(total_quantity) over())/((max(total_quantity) over())-(min(total_quantity) over())) as quantity_score,
    (value_per_quantity - min(value_per_quantity) over())/((max(value_per_quantity) over())-(min(value_per_quantity) over())) as price_score
from TRADE_FLOW.marts.imports_exports_2020
where flow = 1
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.score_2020"} */;
[0m22:22:45.127451 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.747 seconds
[0m22:22:45.129110 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0651fd0b-4188-4f71-8cc2-76c8b580e28a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff78d7e750>]}
[0m22:22:45.129590 [info ] [Thread-2 (]: 3 of 8 OK created sql table model marts.imports_by_year ........................ [[32mSUCCESS 1[0m in 0.77s]
[0m22:22:45.130080 [debug] [Thread-2 (]: Finished running node model.citrus_trade.imports_by_year
[0m22:22:45.130599 [debug] [Thread-1 (]: Began running node model.citrus_trade.growth_score
[0m22:22:45.130964 [info ] [Thread-1 (]: 6 of 8 START sql table model marts.growth_score ................................ [RUN]
[0m22:22:45.131371 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.citrus_trade.imports_exports_2020, now model.citrus_trade.growth_score)
[0m22:22:45.131685 [debug] [Thread-1 (]: Began compiling node model.citrus_trade.growth_score
[0m22:22:45.134118 [debug] [Thread-1 (]: Writing injected SQL for node "model.citrus_trade.growth_score"
[0m22:22:45.135277 [debug] [Thread-1 (]: Began executing node model.citrus_trade.growth_score
[0m22:22:45.137036 [debug] [Thread-1 (]: Writing runtime sql for node "model.citrus_trade.growth_score"
[0m22:22:45.139350 [debug] [Thread-1 (]: Using snowflake connection "model.citrus_trade.growth_score"
[0m22:22:45.139674 [debug] [Thread-1 (]: On model.citrus_trade.growth_score: create or replace transient table TRADE_FLOW.marts.growth_score
    
    
    
    as (with 
    previous_year AS (
        select 
            declarant_iso,
            year,
            lag(total_value,1) over(partition by declarant_iso order by year) previous_year_value,
            total_value,
            first_value(total_value) over(partition by declarant_iso order by year) as first_year_value,
            last_value(total_value) over(partition by declarant_iso order by year) as last_year_value
        from TRADE_FLOW.marts.imports_by_year
    ),
    growth_speed AS (
        select 
            declarant_iso,
            year,
            first_year_value,
            last_year_value,
            last_year_value/nullif(first_year_value,0) as growth_overall,
            previous_year_value,
            total_value,
            (total_value - previous_year_value)/total_value * 100 as growth_speed 
        from previous_year
    ),
    previous_year_growth_speed AS (
        select 
            declarant_iso,
            year,
            first_year_value,
            last_year_value,
            growth_overall,
            previous_year_value,
            total_value as current_value,
            growth_speed,
            lag(growth_speed,1) over(partition by declarant_iso order by year) previous_year_growth_speed,
        from growth_speed
        order by 1,2
    ),
    base AS (
        select 
            declarant_iso,
            year,
            first_year_value,
            last_year_value,
            growth_overall,
            previous_year_value,
            current_value,
            previous_year_growth_speed,
            growth_speed,
            growth_speed - previous_year_growth_speed as growth_acceleration,
            avg(growth_acceleration) over(partition by declarant_iso) as avg_acceleration
        from previous_year_growth_speed
    ),
    ok as (
        select 
            declarant_iso,
            year,
            first_year_value,
            last_year_value,
            growth_overall,
            (growth_overall - min(growth_overall) OVER())/(max(growth_overall) OVER() - min(growth_overall) OVER()) as growth_overall_norm,
            previous_year_value,
            current_value,
            -- previous_year_growth_speed,
            growth_speed,
            growth_acceleration,
            avg_acceleration,
            (avg_acceleration - min(avg_acceleration) OVER())/(max(avg_acceleration) OVER() - min(avg_acceleration) OVER()) as avg_acceleration_norm
        from base 
    )
    select 
        distinct 
        declarant_iso,
        year,
        current_value,
        growth_speed,
        growth_acceleration,
        growth_overall,
        growth_overall_norm,
        avg_acceleration,
        avg_acceleration_norm,
        growth_overall_norm * avg_acceleration_norm as growth_score
    from ok
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.growth_score"} */;
[0m22:22:45.789452 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.704 seconds
[0m22:22:45.792984 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0651fd0b-4188-4f71-8cc2-76c8b580e28a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff78da7c80>]}
[0m22:22:45.794101 [info ] [Thread-3 (]: 5 of 8 OK created sql table model marts.score_2020 ............................. [[32mSUCCESS 1[0m in 0.72s]
[0m22:22:45.795316 [debug] [Thread-3 (]: Finished running node model.citrus_trade.score_2020
[0m22:22:45.931522 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.791 seconds
[0m22:22:45.939858 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0651fd0b-4188-4f71-8cc2-76c8b580e28a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff78d7faa0>]}
[0m22:22:45.941482 [info ] [Thread-1 (]: 6 of 8 OK created sql table model marts.growth_score ........................... [[32mSUCCESS 1[0m in 0.81s]
[0m22:22:45.942646 [debug] [Thread-1 (]: Finished running node model.citrus_trade.growth_score
[0m22:22:45.944238 [debug] [Thread-2 (]: Began running node model.citrus_trade.importer_score
[0m22:22:45.944955 [info ] [Thread-2 (]: 7 of 8 START sql table model marts.importer_score .............................. [RUN]
[0m22:22:45.945826 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.citrus_trade.imports_by_year, now model.citrus_trade.importer_score)
[0m22:22:45.946480 [debug] [Thread-2 (]: Began compiling node model.citrus_trade.importer_score
[0m22:22:45.954202 [debug] [Thread-2 (]: Writing injected SQL for node "model.citrus_trade.importer_score"
[0m22:22:45.956067 [debug] [Thread-2 (]: Began executing node model.citrus_trade.importer_score
[0m22:22:45.959413 [debug] [Thread-2 (]: Writing runtime sql for node "model.citrus_trade.importer_score"
[0m22:22:45.961183 [debug] [Thread-2 (]: Using snowflake connection "model.citrus_trade.importer_score"
[0m22:22:45.961617 [debug] [Thread-2 (]: On model.citrus_trade.importer_score: create or replace transient table TRADE_FLOW.marts.importer_score
    
    
    
    as (select distinct
    sc.declarant_iso,
    sc.value_score,
    sc.quantity_score,
    sc.price_score,
    gs.growth_score
from TRADE_FLOW.marts.score_2020 as sc
inner join TRADE_FLOW.marts.growth_score as gs
    on gs.declarant_iso = sc.declarant_iso
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.importer_score"} */;
[0m22:22:46.671354 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.709 seconds
[0m22:22:46.677511 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0651fd0b-4188-4f71-8cc2-76c8b580e28a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff79156720>]}
[0m22:22:46.679476 [info ] [Thread-2 (]: 7 of 8 OK created sql table model marts.importer_score ......................... [[32mSUCCESS 1[0m in 0.73s]
[0m22:22:46.681816 [debug] [Thread-2 (]: Finished running node model.citrus_trade.importer_score
[0m22:22:46.684526 [debug] [Thread-3 (]: Began running node model.citrus_trade.viz_importer_score
[0m22:22:46.686918 [info ] [Thread-3 (]: 8 of 8 START sql table model analytics.viz_importer_score ...................... [RUN]
[0m22:22:46.687926 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.citrus_trade.score_2020, now model.citrus_trade.viz_importer_score)
[0m22:22:46.688588 [debug] [Thread-3 (]: Began compiling node model.citrus_trade.viz_importer_score
[0m22:22:46.693200 [debug] [Thread-3 (]: Writing injected SQL for node "model.citrus_trade.viz_importer_score"
[0m22:22:46.695650 [debug] [Thread-3 (]: Began executing node model.citrus_trade.viz_importer_score
[0m22:22:46.699054 [debug] [Thread-3 (]: Writing runtime sql for node "model.citrus_trade.viz_importer_score"
[0m22:22:46.703293 [debug] [Thread-3 (]: Using snowflake connection "model.citrus_trade.viz_importer_score"
[0m22:22:46.703905 [debug] [Thread-3 (]: On model.citrus_trade.viz_importer_score: create or replace transient table TRADE_FLOW.analytics.viz_importer_score
    
    
    
    as (select 
    declarant_iso,
    score_type,
    score
from TRADE_FLOW.marts.importer_score
unpivot (
    score for score_type in (
        value_score,
        quantity_score,
        price_score,
        growth_score
    )
)
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.viz_importer_score"} */;
[0m22:22:47.312909 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.607 seconds
[0m22:22:47.363375 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0651fd0b-4188-4f71-8cc2-76c8b580e28a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff79175d90>]}
[0m22:22:47.371392 [info ] [Thread-3 (]: 8 of 8 OK created sql table model analytics.viz_importer_score ................. [[32mSUCCESS 1[0m in 0.67s]
[0m22:22:47.379473 [debug] [Thread-3 (]: Finished running node model.citrus_trade.viz_importer_score
[0m22:22:47.404270 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:22:47.405046 [debug] [MainThread]: Connection 'model.citrus_trade.importer_score' was left open.
[0m22:22:47.407804 [debug] [MainThread]: On model.citrus_trade.importer_score: Close
[0m22:22:47.555611 [debug] [MainThread]: Connection 'model.citrus_trade.viz_importer_score' was left open.
[0m22:22:47.556123 [debug] [MainThread]: On model.citrus_trade.viz_importer_score: Close
[0m22:22:47.670151 [debug] [MainThread]: Connection 'model.citrus_trade.growth_score' was left open.
[0m22:22:47.670532 [debug] [MainThread]: On model.citrus_trade.growth_score: Close
[0m22:22:47.795555 [info ] [MainThread]: 
[0m22:22:47.796099 [info ] [MainThread]: Finished running 8 table models in 0 hours 0 minutes and 6.92 seconds (6.92s).
[0m22:22:47.799919 [debug] [MainThread]: Command end result
[0m22:22:47.845214 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m22:22:47.853109 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m22:22:47.867461 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/target/run_results.json
[0m22:22:47.867777 [info ] [MainThread]: 
[0m22:22:47.868227 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:22:47.868580 [info ] [MainThread]: 
[0m22:22:47.869066 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=8
[0m22:22:47.871259 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.6649284, "process_in_blocks": "0", "process_kernel_time": 0.36563, "process_mem_max_rss": "151244", "process_out_blocks": "4283", "process_user_time": 1.992018}
[0m22:22:47.871941 [debug] [MainThread]: Command `dbt run` succeeded at 22:22:47.871854 after 7.67 seconds
[0m22:22:47.872547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e407620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7adb0da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7cef7470>]}
[0m22:22:47.872857 [debug] [MainThread]: Flushing usage events
[0m22:22:49.721056 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:27:37.385285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb55bad80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5d0a630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4dd8bf0>]}


============================== 08:27:37.391426 | 3de2632f-1535-453e-828d-a14d15842971 ==============================
[0m08:27:37.391426 [info ] [MainThread]: Running with dbt=1.10.13
[0m08:27:37.392025 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'partial_parse': 'True', 'target_path': 'None', 'introspect': 'True', 'empty': 'False', 'use_colors': 'True', 'version_check': 'True', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'static_parser': 'True', 'log_cache_events': 'False', 'quiet': 'False', 'log_path': '/opt/airflow/dbt/logs', 'write_json': 'True', 'warn_error': 'None', 'printer_width': '80', 'indirect_selection': 'eager', 'invocation_command': 'dbt run', 'use_experimental_parser': 'False', 'no_print': 'None', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m08:27:37.587032 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m08:27:37.587381 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m08:27:37.587582 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m08:27:37.691561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3de2632f-1535-453e-828d-a14d15842971', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4b9bf80>]}
[0m08:27:37.724664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3de2632f-1535-453e-828d-a14d15842971', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2d626c0>]}
[0m08:27:37.725304 [info ] [MainThread]: Registered adapter: snowflake=1.10.3
[0m08:27:37.784446 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m08:27:37.915569 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m08:27:37.916012 [debug] [MainThread]: Partial parsing: updated file: citrus_trade://models/marts/importer_score.sql
[0m08:27:37.916282 [debug] [MainThread]: Partial parsing: updated file: citrus_trade://models/analytics/viz_importer_score.sql
[0m08:27:38.060826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3de2632f-1535-453e-828d-a14d15842971', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb25c73e0>]}
[0m08:27:38.113076 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m08:27:38.115080 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m08:27:38.133371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3de2632f-1535-453e-828d-a14d15842971', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb256c7d0>]}
[0m08:27:38.133715 [info ] [MainThread]: Found 8 models, 3 sources, 636 macros
[0m08:27:38.133936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3de2632f-1535-453e-828d-a14d15842971', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2956c90>]}
[0m08:27:38.135179 [info ] [MainThread]: 
[0m08:27:38.135450 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:27:38.135683 [info ] [MainThread]: 
[0m08:27:38.136065 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m08:27:38.139005 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRADE_FLOW'
[0m08:27:38.144732 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRADE_FLOW'
[0m08:27:38.148332 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRADE_FLOW'
[0m08:27:38.195172 [debug] [ThreadPool]: Using snowflake connection "list_TRADE_FLOW"
[0m08:27:38.195651 [debug] [ThreadPool]: Using snowflake connection "list_TRADE_FLOW"
[0m08:27:38.195919 [debug] [ThreadPool]: Using snowflake connection "list_TRADE_FLOW"
[0m08:27:38.196086 [debug] [ThreadPool]: On list_TRADE_FLOW: show terse schemas in database TRADE_FLOW
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRADE_FLOW"} */
[0m08:27:38.196310 [debug] [ThreadPool]: On list_TRADE_FLOW: show terse schemas in database TRADE_FLOW
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRADE_FLOW"} */
[0m08:27:38.196510 [debug] [ThreadPool]: On list_TRADE_FLOW: show terse schemas in database TRADE_FLOW
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRADE_FLOW"} */
[0m08:27:38.196691 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:27:38.196895 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:27:38.197078 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:27:38.906705 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.709 seconds
[0m08:27:38.959117 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.762 seconds
[0m08:27:38.969939 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.773 seconds
[0m08:27:38.975378 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRADE_FLOW, now list_TRADE_FLOW_analytics)
[0m08:27:38.982931 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRADE_FLOW, now list_TRADE_FLOW_staging)
[0m08:27:39.002562 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRADE_FLOW, now list_TRADE_FLOW_marts)
[0m08:27:39.008674 [debug] [ThreadPool]: Using snowflake connection "list_TRADE_FLOW_staging"
[0m08:27:39.009084 [debug] [ThreadPool]: Using snowflake connection "list_TRADE_FLOW_analytics"
[0m08:27:39.011294 [debug] [ThreadPool]: Using snowflake connection "list_TRADE_FLOW_marts"
[0m08:27:39.011769 [debug] [ThreadPool]: On list_TRADE_FLOW_staging: show objects in TRADE_FLOW.staging
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRADE_FLOW_staging"} */;
[0m08:27:39.012235 [debug] [ThreadPool]: On list_TRADE_FLOW_analytics: show objects in TRADE_FLOW.analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRADE_FLOW_analytics"} */;
[0m08:27:39.012626 [debug] [ThreadPool]: On list_TRADE_FLOW_marts: show objects in TRADE_FLOW.marts
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRADE_FLOW_marts"} */;
[0m08:27:39.096640 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 0.081 seconds
[0m08:27:39.097845 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.085 seconds
[0m08:27:39.106648 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.093 seconds
[0m08:27:39.109489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3de2632f-1535-453e-828d-a14d15842971', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb28ce510>]}
[0m08:27:39.114981 [debug] [Thread-1 (]: Began running node model.citrus_trade.stg_trade
[0m08:27:39.115649 [info ] [Thread-1 (]: 1 of 8 START sql table model staging.stg_trade ................................. [RUN]
[0m08:27:39.116442 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_TRADE_FLOW_analytics, now model.citrus_trade.stg_trade)
[0m08:27:39.117110 [debug] [Thread-1 (]: Began compiling node model.citrus_trade.stg_trade
[0m08:27:39.126689 [debug] [Thread-1 (]: Writing injected SQL for node "model.citrus_trade.stg_trade"
[0m08:27:39.128691 [debug] [Thread-1 (]: Began executing node model.citrus_trade.stg_trade
[0m08:27:39.153602 [debug] [Thread-1 (]: Writing runtime sql for node "model.citrus_trade.stg_trade"
[0m08:27:39.155761 [debug] [Thread-1 (]: Using snowflake connection "model.citrus_trade.stg_trade"
[0m08:27:39.156061 [debug] [Thread-1 (]: On model.citrus_trade.stg_trade: create or replace transient table TRADE_FLOW.staging.stg_trade
    
    
    
    as (select
  value:DECLARANT::int as declarant,
  value:DECLARANT_ISO::string as declarant_iso,
  value:PARTNER::string as partner,
  value:PARTNER_ISO::string as partner_iso,
  value:FLOW::int as flow,
  value:TRANSPORT_MODE::int as transport_mode,
  value:PERIOD::int as period,
  year(to_date(left(period,4),'YYYY')) as year,
  value:HS4::string as hs4,
  value:HS4_NAME::string as hs4_name,
  value:HS6::string as hs6,
  value:HS6_NAME::string as hs6_name,
  value:VALUE_IN_EUROS::float as value_in_euros,
  value:QUANTITY_IN_KG::float as quantity_in_kg
from trade_flow.raw.raw_trhs
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.stg_trade"} */;
[0m08:27:40.464725 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.308 seconds
[0m08:27:40.495990 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3de2632f-1535-453e-828d-a14d15842971', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0322990>]}
[0m08:27:40.497091 [info ] [Thread-1 (]: 1 of 8 OK created sql table model staging.stg_trade ............................ [[32mSUCCESS 1[0m in 1.38s]
[0m08:27:40.497850 [debug] [Thread-1 (]: Finished running node model.citrus_trade.stg_trade
[0m08:27:40.499317 [debug] [Thread-3 (]: Began running node model.citrus_trade.trade_by_hs
[0m08:27:40.499824 [info ] [Thread-3 (]: 2 of 8 START sql table model marts.trade_by_hs ................................. [RUN]
[0m08:27:40.500273 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_TRADE_FLOW_marts, now model.citrus_trade.trade_by_hs)
[0m08:27:40.500610 [debug] [Thread-3 (]: Began compiling node model.citrus_trade.trade_by_hs
[0m08:27:40.503776 [debug] [Thread-3 (]: Writing injected SQL for node "model.citrus_trade.trade_by_hs"
[0m08:27:40.505260 [debug] [Thread-3 (]: Began executing node model.citrus_trade.trade_by_hs
[0m08:27:40.507688 [debug] [Thread-3 (]: Writing runtime sql for node "model.citrus_trade.trade_by_hs"
[0m08:27:40.510460 [debug] [Thread-3 (]: Using snowflake connection "model.citrus_trade.trade_by_hs"
[0m08:27:40.511172 [debug] [Thread-3 (]: On model.citrus_trade.trade_by_hs: create or replace transient table TRADE_FLOW.marts.trade_by_hs
    
    
    
    as (select
    *
from TRADE_FLOW.staging.stg_trade
where hs6 = '080510'
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.trade_by_hs"} */;
[0m08:27:41.181761 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.670 seconds
[0m08:27:41.187525 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3de2632f-1535-453e-828d-a14d15842971', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0337ce0>]}
[0m08:27:41.188890 [info ] [Thread-3 (]: 2 of 8 OK created sql table model marts.trade_by_hs ............................ [[32mSUCCESS 1[0m in 0.69s]
[0m08:27:41.190322 [debug] [Thread-3 (]: Finished running node model.citrus_trade.trade_by_hs
[0m08:27:41.191971 [debug] [Thread-2 (]: Began running node model.citrus_trade.imports_by_year
[0m08:27:41.192628 [debug] [Thread-1 (]: Began running node model.citrus_trade.imports_exports_2020
[0m08:27:41.193268 [info ] [Thread-2 (]: 3 of 8 START sql table model marts.imports_by_year ............................. [RUN]
[0m08:27:41.194247 [info ] [Thread-1 (]: 4 of 8 START sql table model marts.imports_exports_2020 ........................ [RUN]
[0m08:27:41.195402 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_TRADE_FLOW_staging, now model.citrus_trade.imports_by_year)
[0m08:27:41.196153 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.citrus_trade.stg_trade, now model.citrus_trade.imports_exports_2020)
[0m08:27:41.196844 [debug] [Thread-2 (]: Began compiling node model.citrus_trade.imports_by_year
[0m08:27:41.197457 [debug] [Thread-1 (]: Began compiling node model.citrus_trade.imports_exports_2020
[0m08:27:41.204948 [debug] [Thread-2 (]: Writing injected SQL for node "model.citrus_trade.imports_by_year"
[0m08:27:41.208713 [debug] [Thread-1 (]: Writing injected SQL for node "model.citrus_trade.imports_exports_2020"
[0m08:27:41.211037 [debug] [Thread-2 (]: Began executing node model.citrus_trade.imports_by_year
[0m08:27:41.214351 [debug] [Thread-2 (]: Writing runtime sql for node "model.citrus_trade.imports_by_year"
[0m08:27:41.214956 [debug] [Thread-1 (]: Began executing node model.citrus_trade.imports_exports_2020
[0m08:27:41.217877 [debug] [Thread-1 (]: Writing runtime sql for node "model.citrus_trade.imports_exports_2020"
[0m08:27:41.219326 [debug] [Thread-2 (]: Using snowflake connection "model.citrus_trade.imports_by_year"
[0m08:27:41.219726 [debug] [Thread-2 (]: On model.citrus_trade.imports_by_year: create or replace transient table TRADE_FLOW.marts.imports_by_year
    
    
    
    as (select
    declarant_iso,
    year,
    sum(value_in_euros) as total_value,
    sum(quantity_in_kg) as total_quantity,
    total_value/nullif(total_quantity,0) as value_per_quantity
from TRADE_FLOW.marts.trade_by_hs
where flow = 1
group by 1,2
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.imports_by_year"} */;
[0m08:27:41.220736 [debug] [Thread-1 (]: Using snowflake connection "model.citrus_trade.imports_exports_2020"
[0m08:27:41.223008 [debug] [Thread-1 (]: On model.citrus_trade.imports_exports_2020: create or replace transient table TRADE_FLOW.marts.imports_exports_2020
    
    
    
    as (select
    declarant_iso,
    flow,
    sum(value_in_euros) over(partition by declarant_iso, flow) as total_value,
    sum(quantity_in_kg) over(partition by declarant_iso, flow) as total_quantity,
    total_value/nullif(total_quantity,0) as value_per_quantity
from TRADE_FLOW.marts.trade_by_hs
where year = 2020
group by 
    declarant_iso,
    flow,
    value_in_euros,
    quantity_in_kg
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.imports_exports_2020"} */;
[0m08:27:41.815297 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.594 seconds
[0m08:27:41.819317 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3de2632f-1535-453e-828d-a14d15842971', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0d800b0>]}
[0m08:27:41.821025 [info ] [Thread-2 (]: 3 of 8 OK created sql table model marts.imports_by_year ........................ [[32mSUCCESS 1[0m in 0.62s]
[0m08:27:41.822029 [debug] [Thread-2 (]: Finished running node model.citrus_trade.imports_by_year
[0m08:27:41.823004 [debug] [Thread-3 (]: Began running node model.citrus_trade.growth_score
[0m08:27:41.823674 [info ] [Thread-3 (]: 5 of 8 START sql table model marts.growth_score ................................ [RUN]
[0m08:27:41.824560 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.citrus_trade.trade_by_hs, now model.citrus_trade.growth_score)
[0m08:27:41.825130 [debug] [Thread-3 (]: Began compiling node model.citrus_trade.growth_score
[0m08:27:41.829012 [debug] [Thread-3 (]: Writing injected SQL for node "model.citrus_trade.growth_score"
[0m08:27:41.830495 [debug] [Thread-3 (]: Began executing node model.citrus_trade.growth_score
[0m08:27:41.832995 [debug] [Thread-3 (]: Writing runtime sql for node "model.citrus_trade.growth_score"
[0m08:27:41.836818 [debug] [Thread-3 (]: Using snowflake connection "model.citrus_trade.growth_score"
[0m08:27:41.837517 [debug] [Thread-3 (]: On model.citrus_trade.growth_score: create or replace transient table TRADE_FLOW.marts.growth_score
    
    
    
    as (with 
    previous_year AS (
        select 
            declarant_iso,
            year,
            lag(total_value,1) over(partition by declarant_iso order by year) previous_year_value,
            total_value,
            first_value(total_value) over(partition by declarant_iso order by year) as first_year_value,
            last_value(total_value) over(partition by declarant_iso order by year) as last_year_value
        from TRADE_FLOW.marts.imports_by_year
    ),
    growth_speed AS (
        select 
            declarant_iso,
            year,
            first_year_value,
            last_year_value,
            last_year_value/nullif(first_year_value,0) as growth_overall,
            previous_year_value,
            total_value,
            (total_value - previous_year_value)/total_value * 100 as growth_speed 
        from previous_year
    ),
    previous_year_growth_speed AS (
        select 
            declarant_iso,
            year,
            first_year_value,
            last_year_value,
            growth_overall,
            previous_year_value,
            total_value as current_value,
            growth_speed,
            lag(growth_speed,1) over(partition by declarant_iso order by year) previous_year_growth_speed,
        from growth_speed
        order by 1,2
    ),
    base AS (
        select 
            declarant_iso,
            year,
            first_year_value,
            last_year_value,
            growth_overall,
            previous_year_value,
            current_value,
            previous_year_growth_speed,
            growth_speed,
            growth_speed - previous_year_growth_speed as growth_acceleration,
            avg(growth_acceleration) over(partition by declarant_iso) as avg_acceleration
        from previous_year_growth_speed
    ),
    ok as (
        select 
            declarant_iso,
            year,
            first_year_value,
            last_year_value,
            growth_overall,
            (growth_overall - min(growth_overall) OVER())/(max(growth_overall) OVER() - min(growth_overall) OVER()) as growth_overall_norm,
            previous_year_value,
            current_value,
            -- previous_year_growth_speed,
            growth_speed,
            growth_acceleration,
            avg_acceleration,
            (avg_acceleration - min(avg_acceleration) OVER())/(max(avg_acceleration) OVER() - min(avg_acceleration) OVER()) as avg_acceleration_norm
        from base 
    )
    select 
        distinct 
        declarant_iso,
        year,
        current_value,
        growth_speed,
        growth_acceleration,
        growth_overall,
        growth_overall_norm,
        avg_acceleration,
        avg_acceleration_norm,
        growth_overall_norm * avg_acceleration_norm as growth_score
    from ok
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.growth_score"} */;
[0m08:27:41.848420 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.624 seconds
[0m08:27:41.850250 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3de2632f-1535-453e-828d-a14d15842971', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0d6eb70>]}
[0m08:27:41.850796 [info ] [Thread-1 (]: 4 of 8 OK created sql table model marts.imports_exports_2020 ................... [[32mSUCCESS 1[0m in 0.65s]
[0m08:27:41.851324 [debug] [Thread-1 (]: Finished running node model.citrus_trade.imports_exports_2020
[0m08:27:41.851881 [debug] [Thread-2 (]: Began running node model.citrus_trade.score_2020
[0m08:27:41.852319 [info ] [Thread-2 (]: 6 of 8 START sql table model marts.score_2020 .................................. [RUN]
[0m08:27:41.852818 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.citrus_trade.imports_by_year, now model.citrus_trade.score_2020)
[0m08:27:41.853166 [debug] [Thread-2 (]: Began compiling node model.citrus_trade.score_2020
[0m08:27:41.855626 [debug] [Thread-2 (]: Writing injected SQL for node "model.citrus_trade.score_2020"
[0m08:27:41.856839 [debug] [Thread-2 (]: Began executing node model.citrus_trade.score_2020
[0m08:27:41.862744 [debug] [Thread-2 (]: Writing runtime sql for node "model.citrus_trade.score_2020"
[0m08:27:41.864503 [debug] [Thread-2 (]: Using snowflake connection "model.citrus_trade.score_2020"
[0m08:27:41.864856 [debug] [Thread-2 (]: On model.citrus_trade.score_2020: create or replace transient table TRADE_FLOW.marts.score_2020
    
    
    
    as (select distinct 
    declarant_iso,
    total_value,
    total_quantity,
    value_per_quantity,
    (total_value - min(total_value) over())/((max(total_value) over())-(min(total_value) over())) as value_score,
    (total_quantity - min(total_quantity) over())/((max(total_quantity) over())-(min(total_quantity) over())) as quantity_score,
    (value_per_quantity - min(value_per_quantity) over())/((max(value_per_quantity) over())-(min(value_per_quantity) over())) as price_score
from TRADE_FLOW.marts.imports_exports_2020
where flow = 1
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.score_2020"} */;
[0m08:27:42.510801 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.645 seconds
[0m08:27:42.515625 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3de2632f-1535-453e-828d-a14d15842971', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0393ad0>]}
[0m08:27:42.517569 [info ] [Thread-2 (]: 6 of 8 OK created sql table model marts.score_2020 ............................. [[32mSUCCESS 1[0m in 0.66s]
[0m08:27:42.518830 [debug] [Thread-2 (]: Finished running node model.citrus_trade.score_2020
[0m08:27:42.519916 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.681 seconds
[0m08:27:42.522764 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3de2632f-1535-453e-828d-a14d15842971', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0391700>]}
[0m08:27:42.523646 [info ] [Thread-3 (]: 5 of 8 OK created sql table model marts.growth_score ........................... [[32mSUCCESS 1[0m in 0.70s]
[0m08:27:42.524566 [debug] [Thread-3 (]: Finished running node model.citrus_trade.growth_score
[0m08:27:42.525807 [debug] [Thread-1 (]: Began running node model.citrus_trade.importer_score
[0m08:27:42.526491 [info ] [Thread-1 (]: 7 of 8 START sql table model marts.importer_score .............................. [RUN]
[0m08:27:42.527030 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.citrus_trade.imports_exports_2020, now model.citrus_trade.importer_score)
[0m08:27:42.527621 [debug] [Thread-1 (]: Began compiling node model.citrus_trade.importer_score
[0m08:27:42.533321 [debug] [Thread-1 (]: Writing injected SQL for node "model.citrus_trade.importer_score"
[0m08:27:42.535281 [debug] [Thread-1 (]: Began executing node model.citrus_trade.importer_score
[0m08:27:42.538892 [debug] [Thread-1 (]: Writing runtime sql for node "model.citrus_trade.importer_score"
[0m08:27:42.540907 [debug] [Thread-1 (]: Using snowflake connection "model.citrus_trade.importer_score"
[0m08:27:42.541348 [debug] [Thread-1 (]: On model.citrus_trade.importer_score: create or replace transient table TRADE_FLOW.marts.importer_score
    
    
    
    as (select distinct
    sc.declarant_iso,
    sc.total_value as revenue_total,
    sc.total_quantity as volume_total,
    sc.value_per_quantity as rate_avg,
    sc.value_score as revenue_score,
    sc.quantity_score as volume_score,
    sc.price_score as rate_score,
    gs.growth_score
from TRADE_FLOW.marts.score_2020 as sc
inner join TRADE_FLOW.marts.growth_score as gs
    on gs.declarant_iso = sc.declarant_iso
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.importer_score"} */;
[0m08:27:43.232045 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.690 seconds
[0m08:27:43.237047 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3de2632f-1535-453e-828d-a14d15842971', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb03200b0>]}
[0m08:27:43.238403 [info ] [Thread-1 (]: 7 of 8 OK created sql table model marts.importer_score ......................... [[32mSUCCESS 1[0m in 0.71s]
[0m08:27:43.239745 [debug] [Thread-1 (]: Finished running node model.citrus_trade.importer_score
[0m08:27:43.241393 [debug] [Thread-2 (]: Began running node model.citrus_trade.viz_importer_score
[0m08:27:43.242359 [info ] [Thread-2 (]: 8 of 8 START sql table model analytics.viz_importer_score ...................... [RUN]
[0m08:27:43.243165 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.citrus_trade.score_2020, now model.citrus_trade.viz_importer_score)
[0m08:27:43.243779 [debug] [Thread-2 (]: Began compiling node model.citrus_trade.viz_importer_score
[0m08:27:43.249119 [debug] [Thread-2 (]: Writing injected SQL for node "model.citrus_trade.viz_importer_score"
[0m08:27:43.263448 [debug] [Thread-2 (]: Began executing node model.citrus_trade.viz_importer_score
[0m08:27:43.291122 [debug] [Thread-2 (]: Writing runtime sql for node "model.citrus_trade.viz_importer_score"
[0m08:27:43.294022 [debug] [Thread-2 (]: Using snowflake connection "model.citrus_trade.viz_importer_score"
[0m08:27:43.294531 [debug] [Thread-2 (]: On model.citrus_trade.viz_importer_score: create or replace transient table TRADE_FLOW.analytics.viz_importer_score
    
    
    
    as (with 
    scores AS (
        select 
            declarant_iso,
            score_type,
            score
        from TRADE_FLOW.marts.importer_score
        unpivot (
            score for score_type in (
                revenue_score as 'revenue',
                volume_score as 'volume',
                rate_score as 'rate',
                growth_score as 'growth'
            ),
        )
    ),
    value as (
        select 
            declarant_iso,
            value_type,
            value
        from TRADE_FLOW.marts.importer_score
        unpivot (
            value for value_type in (
                revenue_total as 'revenue',
                volume_score as 'volume',
                rate_score as 'rate',
            ),
        )
    )
select 
    s.declarant_iso,
    s.score_type,
    s.score,
    v.value
from scores as s
left join values as v
    on s.declarant_iso = v.declarant_iso
   and s.score_type = v.value_type
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.viz_importer_score"} */;
[0m08:27:43.392083 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01c03ffb-0305-74a0-0004-20ca0002556a
[0m08:27:43.392574 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 14 at position 33 unexpected ''revenue''.
syntax error line 15 at position 32 unexpected ''volume''.
syntax error line 16 at position 30 unexpected ''rate''.
syntax error line 17 at position 32 unexpected ''growth''.
syntax error line 18 at position 13 unexpected ','.
syntax error line 29 at position 33 unexpected ''revenue''.
syntax error line 30 at position 32 unexpected ''volume''.
syntax error line 31 at position 30 unexpected ''rate''.
syntax error line 32 at position 12 unexpected ')'.
syntax error line 32 at position 13 unexpected ','.
syntax error line 41 at position 17 unexpected 'as'.
syntax error line 42 at position 4 unexpected 'on'.
syntax error line 42 at position 7 unexpected 's'.
[0m08:27:43.396975 [debug] [Thread-2 (]: Database Error in model viz_importer_score (models/analytics/viz_importer_score.sql)
  001003 (42000): SQL compilation error:
  syntax error line 14 at position 33 unexpected ''revenue''.
  syntax error line 15 at position 32 unexpected ''volume''.
  syntax error line 16 at position 30 unexpected ''rate''.
  syntax error line 17 at position 32 unexpected ''growth''.
  syntax error line 18 at position 13 unexpected ','.
  syntax error line 29 at position 33 unexpected ''revenue''.
  syntax error line 30 at position 32 unexpected ''volume''.
  syntax error line 31 at position 30 unexpected ''rate''.
  syntax error line 32 at position 12 unexpected ')'.
  syntax error line 32 at position 13 unexpected ','.
  syntax error line 41 at position 17 unexpected 'as'.
  syntax error line 42 at position 4 unexpected 'on'.
  syntax error line 42 at position 7 unexpected 's'.
  compiled code at target/run/citrus_trade/models/analytics/viz_importer_score.sql
[0m08:27:43.397507 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3de2632f-1535-453e-828d-a14d15842971', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0325df0>]}
[0m08:27:43.398092 [error] [Thread-2 (]: 8 of 8 ERROR creating sql table model analytics.viz_importer_score ............. [[31mERROR[0m in 0.15s]
[0m08:27:43.398651 [debug] [Thread-2 (]: Finished running node model.citrus_trade.viz_importer_score
[0m08:27:43.399188 [debug] [Thread-7 (]: Marking all children of 'model.citrus_trade.viz_importer_score' to be skipped because of status 'error'.  Reason: Database Error in model viz_importer_score (models/analytics/viz_importer_score.sql)
  001003 (42000): SQL compilation error:
  syntax error line 14 at position 33 unexpected ''revenue''.
  syntax error line 15 at position 32 unexpected ''volume''.
  syntax error line 16 at position 30 unexpected ''rate''.
  syntax error line 17 at position 32 unexpected ''growth''.
  syntax error line 18 at position 13 unexpected ','.
  syntax error line 29 at position 33 unexpected ''revenue''.
  syntax error line 30 at position 32 unexpected ''volume''.
  syntax error line 31 at position 30 unexpected ''rate''.
  syntax error line 32 at position 12 unexpected ')'.
  syntax error line 32 at position 13 unexpected ','.
  syntax error line 41 at position 17 unexpected 'as'.
  syntax error line 42 at position 4 unexpected 'on'.
  syntax error line 42 at position 7 unexpected 's'.
  compiled code at target/run/citrus_trade/models/analytics/viz_importer_score.sql.
[0m08:27:43.402104 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:27:43.402478 [debug] [MainThread]: Connection 'model.citrus_trade.growth_score' was left open.
[0m08:27:43.402793 [debug] [MainThread]: On model.citrus_trade.growth_score: Close
[0m08:27:43.552825 [debug] [MainThread]: Connection 'model.citrus_trade.viz_importer_score' was left open.
[0m08:27:43.554350 [debug] [MainThread]: On model.citrus_trade.viz_importer_score: Close
[0m08:27:43.714009 [debug] [MainThread]: Connection 'model.citrus_trade.importer_score' was left open.
[0m08:27:43.714516 [debug] [MainThread]: On model.citrus_trade.importer_score: Close
[0m08:27:43.799327 [info ] [MainThread]: 
[0m08:27:43.800048 [info ] [MainThread]: Finished running 8 table models in 0 hours 0 minutes and 5.66 seconds (5.66s).
[0m08:27:43.802067 [debug] [MainThread]: Command end result
[0m08:27:43.849766 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m08:27:43.852453 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m08:27:43.857589 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/target/run_results.json
[0m08:27:43.857791 [info ] [MainThread]: 
[0m08:27:43.858033 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m08:27:43.858284 [info ] [MainThread]: 
[0m08:27:43.858520 [error] [MainThread]: [31mFailure in model viz_importer_score (models/analytics/viz_importer_score.sql)[0m
[0m08:27:43.859171 [error] [MainThread]:   Database Error in model viz_importer_score (models/analytics/viz_importer_score.sql)
  001003 (42000): SQL compilation error:
  syntax error line 14 at position 33 unexpected ''revenue''.
  syntax error line 15 at position 32 unexpected ''volume''.
  syntax error line 16 at position 30 unexpected ''rate''.
  syntax error line 17 at position 32 unexpected ''growth''.
  syntax error line 18 at position 13 unexpected ','.
  syntax error line 29 at position 33 unexpected ''revenue''.
  syntax error line 30 at position 32 unexpected ''volume''.
  syntax error line 31 at position 30 unexpected ''rate''.
  syntax error line 32 at position 12 unexpected ')'.
  syntax error line 32 at position 13 unexpected ','.
  syntax error line 41 at position 17 unexpected 'as'.
  syntax error line 42 at position 4 unexpected 'on'.
  syntax error line 42 at position 7 unexpected 's'.
  compiled code at target/run/citrus_trade/models/analytics/viz_importer_score.sql
[0m08:27:43.859447 [info ] [MainThread]: 
[0m08:27:43.859717 [info ] [MainThread]:   compiled code at target/compiled/citrus_trade/models/analytics/viz_importer_score.sql
[0m08:27:43.860067 [info ] [MainThread]: 
[0m08:27:43.860441 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=8
[0m08:27:43.862353 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 6.6054254, "process_in_blocks": "0", "process_kernel_time": 0.619662, "process_mem_max_rss": "152052", "process_out_blocks": "4309", "process_user_time": 2.19523}
[0m08:27:43.862870 [debug] [MainThread]: Command `dbt run` failed at 08:27:43.862791 after 6.61 seconds
[0m08:27:43.863260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6f89970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6c257c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2cec230>]}
[0m08:27:43.863487 [debug] [MainThread]: Flushing usage events
[0m08:27:44.512761 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:28:58.240468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8356ac00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83f286b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff838c0bf0>]}


============================== 08:28:58.243860 | 42bf4b5e-b589-4d51-ac11-67922d01672b ==============================
[0m08:28:58.243860 [info ] [MainThread]: Running with dbt=1.10.13
[0m08:28:58.244300 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'fail_fast': 'False', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'warn_error': 'None', 'use_colors': 'True', 'printer_width': '80', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'target_path': 'None', 'indirect_selection': 'eager', 'profiles_dir': '/opt/airflow/dbt', 'no_print': 'None', 'debug': 'False', 'quiet': 'False', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'write_json': 'True', 'empty': 'False', 'introspect': 'True', 'partial_parse': 'True'}
[0m08:28:58.412617 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m08:28:58.413072 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m08:28:58.413264 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m08:28:58.507969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '42bf4b5e-b589-4d51-ac11-67922d01672b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff847d5e20>]}
[0m08:28:58.540439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '42bf4b5e-b589-4d51-ac11-67922d01672b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81e62660>]}
[0m08:28:58.541096 [info ] [MainThread]: Registered adapter: snowflake=1.10.3
[0m08:28:58.591100 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m08:28:58.721862 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m08:28:58.722332 [debug] [MainThread]: Partial parsing: updated file: citrus_trade://models/analytics/viz_importer_score.sql
[0m08:28:58.861745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '42bf4b5e-b589-4d51-ac11-67922d01672b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81917140>]}
[0m08:28:58.915640 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m08:28:58.917144 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m08:28:58.926343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '42bf4b5e-b589-4d51-ac11-67922d01672b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff818bc620>]}
[0m08:28:58.926625 [info ] [MainThread]: Found 8 models, 3 sources, 636 macros
[0m08:28:58.926897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '42bf4b5e-b589-4d51-ac11-67922d01672b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81a5b770>]}
[0m08:28:58.928198 [info ] [MainThread]: 
[0m08:28:58.928425 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:28:58.928777 [info ] [MainThread]: 
[0m08:28:58.929266 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m08:28:58.932063 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRADE_FLOW'
[0m08:28:58.937905 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRADE_FLOW'
[0m08:28:58.940784 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRADE_FLOW'
[0m08:28:58.966560 [debug] [ThreadPool]: Using snowflake connection "list_TRADE_FLOW"
[0m08:28:58.966929 [debug] [ThreadPool]: Using snowflake connection "list_TRADE_FLOW"
[0m08:28:58.967147 [debug] [ThreadPool]: Using snowflake connection "list_TRADE_FLOW"
[0m08:28:58.967316 [debug] [ThreadPool]: On list_TRADE_FLOW: show terse schemas in database TRADE_FLOW
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRADE_FLOW"} */
[0m08:28:58.967587 [debug] [ThreadPool]: On list_TRADE_FLOW: show terse schemas in database TRADE_FLOW
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRADE_FLOW"} */
[0m08:28:58.967848 [debug] [ThreadPool]: On list_TRADE_FLOW: show terse schemas in database TRADE_FLOW
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRADE_FLOW"} */
[0m08:28:58.968079 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:28:58.968326 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:28:58.968551 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:28:59.607848 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.639 seconds
[0m08:28:59.609863 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.641 seconds
[0m08:28:59.613916 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.646 seconds
[0m08:28:59.620624 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRADE_FLOW, now list_TRADE_FLOW_marts)
[0m08:28:59.627432 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRADE_FLOW, now list_TRADE_FLOW_analytics)
[0m08:28:59.636875 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRADE_FLOW, now list_TRADE_FLOW_staging)
[0m08:28:59.639755 [debug] [ThreadPool]: Using snowflake connection "list_TRADE_FLOW_marts"
[0m08:28:59.642223 [debug] [ThreadPool]: Using snowflake connection "list_TRADE_FLOW_analytics"
[0m08:28:59.644437 [debug] [ThreadPool]: Using snowflake connection "list_TRADE_FLOW_staging"
[0m08:28:59.644867 [debug] [ThreadPool]: On list_TRADE_FLOW_marts: show objects in TRADE_FLOW.marts
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRADE_FLOW_marts"} */;
[0m08:28:59.645298 [debug] [ThreadPool]: On list_TRADE_FLOW_analytics: show objects in TRADE_FLOW.analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRADE_FLOW_analytics"} */;
[0m08:28:59.645703 [debug] [ThreadPool]: On list_TRADE_FLOW_staging: show objects in TRADE_FLOW.staging
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRADE_FLOW_staging"} */;
[0m08:28:59.734112 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.085 seconds
[0m08:28:59.743102 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 0.097 seconds
[0m08:28:59.759031 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.111 seconds
[0m08:28:59.761633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '42bf4b5e-b589-4d51-ac11-67922d01672b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff819f85f0>]}
[0m08:28:59.765800 [debug] [Thread-1 (]: Began running node model.citrus_trade.stg_trade
[0m08:28:59.766425 [info ] [Thread-1 (]: 1 of 8 START sql table model staging.stg_trade ................................. [RUN]
[0m08:28:59.767099 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_TRADE_FLOW_analytics, now model.citrus_trade.stg_trade)
[0m08:28:59.767661 [debug] [Thread-1 (]: Began compiling node model.citrus_trade.stg_trade
[0m08:28:59.776397 [debug] [Thread-1 (]: Writing injected SQL for node "model.citrus_trade.stg_trade"
[0m08:28:59.778431 [debug] [Thread-1 (]: Began executing node model.citrus_trade.stg_trade
[0m08:28:59.803230 [debug] [Thread-1 (]: Writing runtime sql for node "model.citrus_trade.stg_trade"
[0m08:28:59.805065 [debug] [Thread-1 (]: Using snowflake connection "model.citrus_trade.stg_trade"
[0m08:28:59.805365 [debug] [Thread-1 (]: On model.citrus_trade.stg_trade: create or replace transient table TRADE_FLOW.staging.stg_trade
    
    
    
    as (select
  value:DECLARANT::int as declarant,
  value:DECLARANT_ISO::string as declarant_iso,
  value:PARTNER::string as partner,
  value:PARTNER_ISO::string as partner_iso,
  value:FLOW::int as flow,
  value:TRANSPORT_MODE::int as transport_mode,
  value:PERIOD::int as period,
  year(to_date(left(period,4),'YYYY')) as year,
  value:HS4::string as hs4,
  value:HS4_NAME::string as hs4_name,
  value:HS6::string as hs6,
  value:HS6_NAME::string as hs6_name,
  value:VALUE_IN_EUROS::float as value_in_euros,
  value:QUANTITY_IN_KG::float as quantity_in_kg
from trade_flow.raw.raw_trhs
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.stg_trade"} */;
[0m08:29:00.525125 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.719 seconds
[0m08:29:00.557364 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '42bf4b5e-b589-4d51-ac11-67922d01672b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85d51a00>]}
[0m08:29:00.558315 [info ] [Thread-1 (]: 1 of 8 OK created sql table model staging.stg_trade ............................ [[32mSUCCESS 1[0m in 0.79s]
[0m08:29:00.559148 [debug] [Thread-1 (]: Finished running node model.citrus_trade.stg_trade
[0m08:29:00.560413 [debug] [Thread-3 (]: Began running node model.citrus_trade.trade_by_hs
[0m08:29:00.560963 [info ] [Thread-3 (]: 2 of 8 START sql table model marts.trade_by_hs ................................. [RUN]
[0m08:29:00.561641 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_TRADE_FLOW_staging, now model.citrus_trade.trade_by_hs)
[0m08:29:00.562075 [debug] [Thread-3 (]: Began compiling node model.citrus_trade.trade_by_hs
[0m08:29:00.565616 [debug] [Thread-3 (]: Writing injected SQL for node "model.citrus_trade.trade_by_hs"
[0m08:29:00.567138 [debug] [Thread-3 (]: Began executing node model.citrus_trade.trade_by_hs
[0m08:29:00.571404 [debug] [Thread-3 (]: Writing runtime sql for node "model.citrus_trade.trade_by_hs"
[0m08:29:00.572640 [debug] [Thread-3 (]: Using snowflake connection "model.citrus_trade.trade_by_hs"
[0m08:29:00.572927 [debug] [Thread-3 (]: On model.citrus_trade.trade_by_hs: create or replace transient table TRADE_FLOW.marts.trade_by_hs
    
    
    
    as (select
    *
from TRADE_FLOW.staging.stg_trade
where hs6 = '080510'
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.trade_by_hs"} */;
[0m08:29:01.179088 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.605 seconds
[0m08:29:01.182456 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '42bf4b5e-b589-4d51-ac11-67922d01672b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff819b3d10>]}
[0m08:29:01.183407 [info ] [Thread-3 (]: 2 of 8 OK created sql table model marts.trade_by_hs ............................ [[32mSUCCESS 1[0m in 0.62s]
[0m08:29:01.184069 [debug] [Thread-3 (]: Finished running node model.citrus_trade.trade_by_hs
[0m08:29:01.185355 [debug] [Thread-2 (]: Began running node model.citrus_trade.imports_by_year
[0m08:29:01.185763 [debug] [Thread-1 (]: Began running node model.citrus_trade.imports_exports_2020
[0m08:29:01.186188 [info ] [Thread-2 (]: 3 of 8 START sql table model marts.imports_by_year ............................. [RUN]
[0m08:29:01.186879 [info ] [Thread-1 (]: 4 of 8 START sql table model marts.imports_exports_2020 ........................ [RUN]
[0m08:29:01.188121 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.citrus_trade.stg_trade, now model.citrus_trade.imports_exports_2020)
[0m08:29:01.188478 [debug] [Thread-1 (]: Began compiling node model.citrus_trade.imports_exports_2020
[0m08:29:01.187704 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_TRADE_FLOW_marts, now model.citrus_trade.imports_by_year)
[0m08:29:01.192291 [debug] [Thread-1 (]: Writing injected SQL for node "model.citrus_trade.imports_exports_2020"
[0m08:29:01.192742 [debug] [Thread-2 (]: Began compiling node model.citrus_trade.imports_by_year
[0m08:29:01.196360 [debug] [Thread-2 (]: Writing injected SQL for node "model.citrus_trade.imports_by_year"
[0m08:29:01.197906 [debug] [Thread-1 (]: Began executing node model.citrus_trade.imports_exports_2020
[0m08:29:01.200593 [debug] [Thread-1 (]: Writing runtime sql for node "model.citrus_trade.imports_exports_2020"
[0m08:29:01.201039 [debug] [Thread-2 (]: Began executing node model.citrus_trade.imports_by_year
[0m08:29:01.203190 [debug] [Thread-2 (]: Writing runtime sql for node "model.citrus_trade.imports_by_year"
[0m08:29:01.204288 [debug] [Thread-1 (]: Using snowflake connection "model.citrus_trade.imports_exports_2020"
[0m08:29:01.204613 [debug] [Thread-1 (]: On model.citrus_trade.imports_exports_2020: create or replace transient table TRADE_FLOW.marts.imports_exports_2020
    
    
    
    as (select
    declarant_iso,
    flow,
    sum(value_in_euros) over(partition by declarant_iso, flow) as total_value,
    sum(quantity_in_kg) over(partition by declarant_iso, flow) as total_quantity,
    total_value/nullif(total_quantity,0) as value_per_quantity
from TRADE_FLOW.marts.trade_by_hs
where year = 2020
group by 
    declarant_iso,
    flow,
    value_in_euros,
    quantity_in_kg
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.imports_exports_2020"} */;
[0m08:29:01.208274 [debug] [Thread-2 (]: Using snowflake connection "model.citrus_trade.imports_by_year"
[0m08:29:01.208781 [debug] [Thread-2 (]: On model.citrus_trade.imports_by_year: create or replace transient table TRADE_FLOW.marts.imports_by_year
    
    
    
    as (select
    declarant_iso,
    year,
    sum(value_in_euros) as total_value,
    sum(quantity_in_kg) as total_quantity,
    total_value/nullif(total_quantity,0) as value_per_quantity
from TRADE_FLOW.marts.trade_by_hs
where flow = 1
group by 1,2
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.imports_by_year"} */;
[0m08:29:01.876345 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.671 seconds
[0m08:29:01.878216 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.669 seconds
[0m08:29:01.884750 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '42bf4b5e-b589-4d51-ac11-67922d01672b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8018d130>]}
[0m08:29:01.887456 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '42bf4b5e-b589-4d51-ac11-67922d01672b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81a0a1e0>]}
[0m08:29:01.889030 [info ] [Thread-1 (]: 4 of 8 OK created sql table model marts.imports_exports_2020 ................... [[32mSUCCESS 1[0m in 0.70s]
[0m08:29:01.890886 [info ] [Thread-2 (]: 3 of 8 OK created sql table model marts.imports_by_year ........................ [[32mSUCCESS 1[0m in 0.70s]
[0m08:29:01.893390 [debug] [Thread-2 (]: Finished running node model.citrus_trade.imports_by_year
[0m08:29:01.892427 [debug] [Thread-1 (]: Finished running node model.citrus_trade.imports_exports_2020
[0m08:29:01.894637 [debug] [Thread-1 (]: Began running node model.citrus_trade.growth_score
[0m08:29:01.895499 [info ] [Thread-1 (]: 5 of 8 START sql table model marts.growth_score ................................ [RUN]
[0m08:29:01.896139 [debug] [Thread-3 (]: Began running node model.citrus_trade.score_2020
[0m08:29:01.896898 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.citrus_trade.imports_exports_2020, now model.citrus_trade.growth_score)
[0m08:29:01.897845 [info ] [Thread-3 (]: 6 of 8 START sql table model marts.score_2020 .................................. [RUN]
[0m08:29:01.898646 [debug] [Thread-1 (]: Began compiling node model.citrus_trade.growth_score
[0m08:29:01.899398 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.citrus_trade.trade_by_hs, now model.citrus_trade.score_2020)
[0m08:29:01.905287 [debug] [Thread-1 (]: Writing injected SQL for node "model.citrus_trade.growth_score"
[0m08:29:01.905950 [debug] [Thread-3 (]: Began compiling node model.citrus_trade.score_2020
[0m08:29:01.910152 [debug] [Thread-3 (]: Writing injected SQL for node "model.citrus_trade.score_2020"
[0m08:29:01.911744 [debug] [Thread-1 (]: Began executing node model.citrus_trade.growth_score
[0m08:29:01.915327 [debug] [Thread-1 (]: Writing runtime sql for node "model.citrus_trade.growth_score"
[0m08:29:01.916005 [debug] [Thread-3 (]: Began executing node model.citrus_trade.score_2020
[0m08:29:01.919768 [debug] [Thread-3 (]: Writing runtime sql for node "model.citrus_trade.score_2020"
[0m08:29:01.924880 [debug] [Thread-1 (]: Using snowflake connection "model.citrus_trade.growth_score"
[0m08:29:01.925544 [debug] [Thread-1 (]: On model.citrus_trade.growth_score: create or replace transient table TRADE_FLOW.marts.growth_score
    
    
    
    as (with 
    previous_year AS (
        select 
            declarant_iso,
            year,
            lag(total_value,1) over(partition by declarant_iso order by year) previous_year_value,
            total_value,
            first_value(total_value) over(partition by declarant_iso order by year) as first_year_value,
            last_value(total_value) over(partition by declarant_iso order by year) as last_year_value
        from TRADE_FLOW.marts.imports_by_year
    ),
    growth_speed AS (
        select 
            declarant_iso,
            year,
            first_year_value,
            last_year_value,
            last_year_value/nullif(first_year_value,0) as growth_overall,
            previous_year_value,
            total_value,
            (total_value - previous_year_value)/total_value * 100 as growth_speed 
        from previous_year
    ),
    previous_year_growth_speed AS (
        select 
            declarant_iso,
            year,
            first_year_value,
            last_year_value,
            growth_overall,
            previous_year_value,
            total_value as current_value,
            growth_speed,
            lag(growth_speed,1) over(partition by declarant_iso order by year) previous_year_growth_speed,
        from growth_speed
        order by 1,2
    ),
    base AS (
        select 
            declarant_iso,
            year,
            first_year_value,
            last_year_value,
            growth_overall,
            previous_year_value,
            current_value,
            previous_year_growth_speed,
            growth_speed,
            growth_speed - previous_year_growth_speed as growth_acceleration,
            avg(growth_acceleration) over(partition by declarant_iso) as avg_acceleration
        from previous_year_growth_speed
    ),
    ok as (
        select 
            declarant_iso,
            year,
            first_year_value,
            last_year_value,
            growth_overall,
            (growth_overall - min(growth_overall) OVER())/(max(growth_overall) OVER() - min(growth_overall) OVER()) as growth_overall_norm,
            previous_year_value,
            current_value,
            -- previous_year_growth_speed,
            growth_speed,
            growth_acceleration,
            avg_acceleration,
            (avg_acceleration - min(avg_acceleration) OVER())/(max(avg_acceleration) OVER() - min(avg_acceleration) OVER()) as avg_acceleration_norm
        from base 
    )
    select 
        distinct 
        declarant_iso,
        year,
        current_value,
        growth_speed,
        growth_acceleration,
        growth_overall,
        growth_overall_norm,
        avg_acceleration,
        avg_acceleration_norm,
        growth_overall_norm * avg_acceleration_norm as growth_score
    from ok
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.growth_score"} */;
[0m08:29:01.926681 [debug] [Thread-3 (]: Using snowflake connection "model.citrus_trade.score_2020"
[0m08:29:01.928694 [debug] [Thread-3 (]: On model.citrus_trade.score_2020: create or replace transient table TRADE_FLOW.marts.score_2020
    
    
    
    as (select distinct 
    declarant_iso,
    total_value,
    total_quantity,
    value_per_quantity,
    (total_value - min(total_value) over())/((max(total_value) over())-(min(total_value) over())) as value_score,
    (total_quantity - min(total_quantity) over())/((max(total_quantity) over())-(min(total_quantity) over())) as quantity_score,
    (value_per_quantity - min(value_per_quantity) over())/((max(value_per_quantity) over())-(min(value_per_quantity) over())) as price_score
from TRADE_FLOW.marts.imports_exports_2020
where flow = 1
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.score_2020"} */;
[0m08:29:02.590764 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.661 seconds
[0m08:29:02.597449 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '42bf4b5e-b589-4d51-ac11-67922d01672b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8008fbc0>]}
[0m08:29:02.599134 [info ] [Thread-3 (]: 6 of 8 OK created sql table model marts.score_2020 ............................. [[32mSUCCESS 1[0m in 0.70s]
[0m08:29:02.600517 [debug] [Thread-3 (]: Finished running node model.citrus_trade.score_2020
[0m08:29:02.723781 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.796 seconds
[0m08:29:02.729655 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '42bf4b5e-b589-4d51-ac11-67922d01672b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff800b0fb0>]}
[0m08:29:02.730753 [info ] [Thread-1 (]: 5 of 8 OK created sql table model marts.growth_score ........................... [[32mSUCCESS 1[0m in 0.83s]
[0m08:29:02.731969 [debug] [Thread-1 (]: Finished running node model.citrus_trade.growth_score
[0m08:29:02.733552 [debug] [Thread-2 (]: Began running node model.citrus_trade.importer_score
[0m08:29:02.734425 [info ] [Thread-2 (]: 7 of 8 START sql table model marts.importer_score .............................. [RUN]
[0m08:29:02.735416 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.citrus_trade.imports_by_year, now model.citrus_trade.importer_score)
[0m08:29:02.736193 [debug] [Thread-2 (]: Began compiling node model.citrus_trade.importer_score
[0m08:29:02.741908 [debug] [Thread-2 (]: Writing injected SQL for node "model.citrus_trade.importer_score"
[0m08:29:02.743758 [debug] [Thread-2 (]: Began executing node model.citrus_trade.importer_score
[0m08:29:02.747636 [debug] [Thread-2 (]: Writing runtime sql for node "model.citrus_trade.importer_score"
[0m08:29:02.749820 [debug] [Thread-2 (]: Using snowflake connection "model.citrus_trade.importer_score"
[0m08:29:02.750345 [debug] [Thread-2 (]: On model.citrus_trade.importer_score: create or replace transient table TRADE_FLOW.marts.importer_score
    
    
    
    as (select distinct
    sc.declarant_iso,
    sc.total_value as revenue_total,
    sc.total_quantity as volume_total,
    sc.value_per_quantity as rate_avg,
    sc.value_score as revenue_score,
    sc.quantity_score as volume_score,
    sc.price_score as rate_score,
    gs.growth_score
from TRADE_FLOW.marts.score_2020 as sc
inner join TRADE_FLOW.marts.growth_score as gs
    on gs.declarant_iso = sc.declarant_iso
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.importer_score"} */;
[0m08:29:03.467918 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.717 seconds
[0m08:29:03.471915 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '42bf4b5e-b589-4d51-ac11-67922d01672b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80064740>]}
[0m08:29:03.473500 [info ] [Thread-2 (]: 7 of 8 OK created sql table model marts.importer_score ......................... [[32mSUCCESS 1[0m in 0.74s]
[0m08:29:03.475063 [debug] [Thread-2 (]: Finished running node model.citrus_trade.importer_score
[0m08:29:03.476591 [debug] [Thread-3 (]: Began running node model.citrus_trade.viz_importer_score
[0m08:29:03.477565 [info ] [Thread-3 (]: 8 of 8 START sql table model analytics.viz_importer_score ...................... [RUN]
[0m08:29:03.478590 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.citrus_trade.score_2020, now model.citrus_trade.viz_importer_score)
[0m08:29:03.479299 [debug] [Thread-3 (]: Began compiling node model.citrus_trade.viz_importer_score
[0m08:29:03.484207 [debug] [Thread-3 (]: Writing injected SQL for node "model.citrus_trade.viz_importer_score"
[0m08:29:03.486046 [debug] [Thread-3 (]: Began executing node model.citrus_trade.viz_importer_score
[0m08:29:03.488641 [debug] [Thread-3 (]: Writing runtime sql for node "model.citrus_trade.viz_importer_score"
[0m08:29:03.490087 [debug] [Thread-3 (]: Using snowflake connection "model.citrus_trade.viz_importer_score"
[0m08:29:03.490435 [debug] [Thread-3 (]: On model.citrus_trade.viz_importer_score: create or replace transient table TRADE_FLOW.analytics.viz_importer_score
    
    
    
    as (-- with 
--     scores AS (
--         select 
--             declarant_iso,
--             score_type,
--             score
--         from TRADE_FLOW.marts.importer_score
--         unpivot (
--             score for score_type in (
--                 revenue_score as 'revenue',
--                 volume_score as 'volume',
--                 rate_score as 'rate',
--                 growth_score as 'growth'
--             ),
--         )
--     ),
--     value as (
--         select 
--             declarant_iso,
--             value_type,
--             value
--         from TRADE_FLOW.marts.importer_score
--         unpivot (
--             value for value_type in (
--                 revenue_total as 'revenue',
--                 volume_score as 'volume',
--                 rate_score as 'rate',
--             ),
--         )
--     )
-- select 
--     s.declarant_iso,
--     s.score_type,
--     s.score,
--     v.value
-- from scores as s
-- left join values as v
--     on s.declarant_iso = v.declarant_iso
--    and s.score_type = v.value_type
select 
*
from TRADE_FLOW.marts.importer_score
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.viz_importer_score"} */;
[0m08:29:04.073404 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.582 seconds
[0m08:29:04.077456 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '42bf4b5e-b589-4d51-ac11-67922d01672b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8016e000>]}
[0m08:29:04.078686 [info ] [Thread-3 (]: 8 of 8 OK created sql table model analytics.viz_importer_score ................. [[32mSUCCESS 1[0m in 0.60s]
[0m08:29:04.080081 [debug] [Thread-3 (]: Finished running node model.citrus_trade.viz_importer_score
[0m08:29:04.084031 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:29:04.084774 [debug] [MainThread]: Connection 'model.citrus_trade.importer_score' was left open.
[0m08:29:04.085399 [debug] [MainThread]: On model.citrus_trade.importer_score: Close
[0m08:29:04.177988 [debug] [MainThread]: Connection 'model.citrus_trade.viz_importer_score' was left open.
[0m08:29:04.178791 [debug] [MainThread]: On model.citrus_trade.viz_importer_score: Close
[0m08:29:04.257651 [debug] [MainThread]: Connection 'model.citrus_trade.growth_score' was left open.
[0m08:29:04.258112 [debug] [MainThread]: On model.citrus_trade.growth_score: Close
[0m08:29:04.333862 [info ] [MainThread]: 
[0m08:29:04.334688 [info ] [MainThread]: Finished running 8 table models in 0 hours 0 minutes and 5.40 seconds (5.40s).
[0m08:29:04.337088 [debug] [MainThread]: Command end result
[0m08:29:04.388291 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m08:29:04.391056 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m08:29:04.408410 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/target/run_results.json
[0m08:29:04.409386 [info ] [MainThread]: 
[0m08:29:04.410308 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:29:04.410883 [info ] [MainThread]: 
[0m08:29:04.411646 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=8
[0m08:29:04.413823 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.2083173, "process_in_blocks": "0", "process_kernel_time": 0.467684, "process_mem_max_rss": "151640", "process_out_blocks": "4302", "process_user_time": 1.922032}
[0m08:29:04.414527 [debug] [MainThread]: Command `dbt run` succeeded at 08:29:04.414430 after 6.21 seconds
[0m08:29:04.415002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84423ec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84420a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84420530>]}
[0m08:29:04.415451 [debug] [MainThread]: Flushing usage events
[0m08:29:05.094212 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:36:27.064298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb46d8ec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb66a7740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb466fbf0>]}


============================== 08:36:27.068049 | 59826ff5-b738-458a-a1eb-7a72f20baecb ==============================
[0m08:36:27.068049 [info ] [MainThread]: Running with dbt=1.10.13
[0m08:36:27.068535 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'debug': 'False', 'target_path': 'None', 'static_parser': 'True', 'printer_width': '80', 'invocation_command': 'dbt run', 'indirect_selection': 'eager', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_cache_events': 'False', 'use_colors': 'True', 'write_json': 'True', 'fail_fast': 'False', 'introspect': 'True', 'quiet': 'False', 'use_experimental_parser': 'False', 'empty': 'False', 'log_format': 'default', 'cache_selected_only': 'False', 'no_print': 'None', 'partial_parse': 'True'}
[0m08:36:27.217218 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m08:36:27.217674 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m08:36:27.217909 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m08:36:27.414491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '59826ff5-b738-458a-a1eb-7a72f20baecb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb36809e0>]}
[0m08:36:27.472208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '59826ff5-b738-458a-a1eb-7a72f20baecb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2495b20>]}
[0m08:36:27.480995 [info ] [MainThread]: Registered adapter: snowflake=1.10.3
[0m08:36:27.592195 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m08:36:27.806439 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m08:36:27.806900 [debug] [MainThread]: Partial parsing: updated file: citrus_trade://models/analytics/viz_importer_score.sql
[0m08:36:27.945364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '59826ff5-b738-458a-a1eb-7a72f20baecb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb19cf0b0>]}
[0m08:36:28.013920 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m08:36:28.015427 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m08:36:28.026088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '59826ff5-b738-458a-a1eb-7a72f20baecb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb196c7a0>]}
[0m08:36:28.026399 [info ] [MainThread]: Found 8 models, 3 sources, 636 macros
[0m08:36:28.026682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '59826ff5-b738-458a-a1eb-7a72f20baecb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1db5e20>]}
[0m08:36:28.027863 [info ] [MainThread]: 
[0m08:36:28.028157 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:36:28.028418 [info ] [MainThread]: 
[0m08:36:28.028826 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m08:36:28.031581 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRADE_FLOW'
[0m08:36:28.038042 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRADE_FLOW'
[0m08:36:28.044738 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRADE_FLOW'
[0m08:36:28.076561 [debug] [ThreadPool]: Using snowflake connection "list_TRADE_FLOW"
[0m08:36:28.076953 [debug] [ThreadPool]: Using snowflake connection "list_TRADE_FLOW"
[0m08:36:28.077224 [debug] [ThreadPool]: Using snowflake connection "list_TRADE_FLOW"
[0m08:36:28.077405 [debug] [ThreadPool]: On list_TRADE_FLOW: show terse schemas in database TRADE_FLOW
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRADE_FLOW"} */
[0m08:36:28.077645 [debug] [ThreadPool]: On list_TRADE_FLOW: show terse schemas in database TRADE_FLOW
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRADE_FLOW"} */
[0m08:36:28.077841 [debug] [ThreadPool]: On list_TRADE_FLOW: show terse schemas in database TRADE_FLOW
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRADE_FLOW"} */
[0m08:36:28.078036 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:36:28.078269 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:36:28.078511 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:36:28.691237 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.611 seconds
[0m08:36:28.794698 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.716 seconds
[0m08:36:28.818803 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.740 seconds
[0m08:36:28.822731 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRADE_FLOW, now list_TRADE_FLOW_analytics)
[0m08:36:28.829397 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRADE_FLOW, now list_TRADE_FLOW_staging)
[0m08:36:28.844476 [debug] [ThreadPool]: Using snowflake connection "list_TRADE_FLOW_analytics"
[0m08:36:28.851131 [debug] [ThreadPool]: Using snowflake connection "list_TRADE_FLOW_staging"
[0m08:36:28.851623 [debug] [ThreadPool]: On list_TRADE_FLOW_analytics: show objects in TRADE_FLOW.analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRADE_FLOW_analytics"} */;
[0m08:36:28.852034 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRADE_FLOW, now list_TRADE_FLOW_marts)
[0m08:36:28.852493 [debug] [ThreadPool]: On list_TRADE_FLOW_staging: show objects in TRADE_FLOW.staging
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRADE_FLOW_staging"} */;
[0m08:36:28.856587 [debug] [ThreadPool]: Using snowflake connection "list_TRADE_FLOW_marts"
[0m08:36:28.858257 [debug] [ThreadPool]: On list_TRADE_FLOW_marts: show objects in TRADE_FLOW.marts
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRADE_FLOW_marts"} */;
[0m08:36:28.937746 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.081 seconds
[0m08:36:28.942425 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 0.084 seconds
[0m08:36:29.011065 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.158 seconds
[0m08:36:29.017859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '59826ff5-b738-458a-a1eb-7a72f20baecb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb222c6e0>]}
[0m08:36:29.025417 [debug] [Thread-1 (]: Began running node model.citrus_trade.stg_trade
[0m08:36:29.026321 [info ] [Thread-1 (]: 1 of 8 START sql table model staging.stg_trade ................................. [RUN]
[0m08:36:29.027155 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_TRADE_FLOW_analytics, now model.citrus_trade.stg_trade)
[0m08:36:29.028345 [debug] [Thread-1 (]: Began compiling node model.citrus_trade.stg_trade
[0m08:36:29.038755 [debug] [Thread-1 (]: Writing injected SQL for node "model.citrus_trade.stg_trade"
[0m08:36:29.041068 [debug] [Thread-1 (]: Began executing node model.citrus_trade.stg_trade
[0m08:36:29.070904 [debug] [Thread-1 (]: Writing runtime sql for node "model.citrus_trade.stg_trade"
[0m08:36:29.078471 [debug] [Thread-1 (]: Using snowflake connection "model.citrus_trade.stg_trade"
[0m08:36:29.078816 [debug] [Thread-1 (]: On model.citrus_trade.stg_trade: create or replace transient table TRADE_FLOW.staging.stg_trade
    
    
    
    as (select
  value:DECLARANT::int as declarant,
  value:DECLARANT_ISO::string as declarant_iso,
  value:PARTNER::string as partner,
  value:PARTNER_ISO::string as partner_iso,
  value:FLOW::int as flow,
  value:TRANSPORT_MODE::int as transport_mode,
  value:PERIOD::int as period,
  year(to_date(left(period,4),'YYYY')) as year,
  value:HS4::string as hs4,
  value:HS4_NAME::string as hs4_name,
  value:HS6::string as hs6,
  value:HS6_NAME::string as hs6_name,
  value:VALUE_IN_EUROS::float as value_in_euros,
  value:QUANTITY_IN_KG::float as quantity_in_kg
from trade_flow.raw.raw_trhs
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.stg_trade"} */;
[0m08:36:29.826894 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.747 seconds
[0m08:36:29.844559 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '59826ff5-b738-458a-a1eb-7a72f20baecb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb60adc40>]}
[0m08:36:29.845191 [info ] [Thread-1 (]: 1 of 8 OK created sql table model staging.stg_trade ............................ [[32mSUCCESS 1[0m in 0.82s]
[0m08:36:29.845940 [debug] [Thread-1 (]: Finished running node model.citrus_trade.stg_trade
[0m08:36:29.846721 [debug] [Thread-3 (]: Began running node model.citrus_trade.trade_by_hs
[0m08:36:29.847068 [info ] [Thread-3 (]: 2 of 8 START sql table model marts.trade_by_hs ................................. [RUN]
[0m08:36:29.847381 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_TRADE_FLOW_staging, now model.citrus_trade.trade_by_hs)
[0m08:36:29.847696 [debug] [Thread-3 (]: Began compiling node model.citrus_trade.trade_by_hs
[0m08:36:29.851287 [debug] [Thread-3 (]: Writing injected SQL for node "model.citrus_trade.trade_by_hs"
[0m08:36:29.853116 [debug] [Thread-3 (]: Began executing node model.citrus_trade.trade_by_hs
[0m08:36:29.856085 [debug] [Thread-3 (]: Writing runtime sql for node "model.citrus_trade.trade_by_hs"
[0m08:36:29.857422 [debug] [Thread-3 (]: Using snowflake connection "model.citrus_trade.trade_by_hs"
[0m08:36:29.857893 [debug] [Thread-3 (]: On model.citrus_trade.trade_by_hs: create or replace transient table TRADE_FLOW.marts.trade_by_hs
    
    
    
    as (select
    *
from TRADE_FLOW.staging.stg_trade
where hs6 = '080510'
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.trade_by_hs"} */;
[0m08:36:30.542118 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.683 seconds
[0m08:36:30.546483 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '59826ff5-b738-458a-a1eb-7a72f20baecb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb007d970>]}
[0m08:36:30.547443 [info ] [Thread-3 (]: 2 of 8 OK created sql table model marts.trade_by_hs ............................ [[32mSUCCESS 1[0m in 0.70s]
[0m08:36:30.549062 [debug] [Thread-3 (]: Finished running node model.citrus_trade.trade_by_hs
[0m08:36:30.550893 [debug] [Thread-2 (]: Began running node model.citrus_trade.imports_by_year
[0m08:36:30.551675 [info ] [Thread-2 (]: 3 of 8 START sql table model marts.imports_by_year ............................. [RUN]
[0m08:36:30.552391 [debug] [Thread-1 (]: Began running node model.citrus_trade.imports_exports_2020
[0m08:36:30.552988 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_TRADE_FLOW_marts, now model.citrus_trade.imports_by_year)
[0m08:36:30.554344 [debug] [Thread-2 (]: Began compiling node model.citrus_trade.imports_by_year
[0m08:36:30.553715 [info ] [Thread-1 (]: 4 of 8 START sql table model marts.imports_exports_2020 ........................ [RUN]
[0m08:36:30.561048 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.citrus_trade.stg_trade, now model.citrus_trade.imports_exports_2020)
[0m08:36:30.561376 [debug] [Thread-1 (]: Began compiling node model.citrus_trade.imports_exports_2020
[0m08:36:30.560553 [debug] [Thread-2 (]: Writing injected SQL for node "model.citrus_trade.imports_by_year"
[0m08:36:30.563681 [debug] [Thread-1 (]: Writing injected SQL for node "model.citrus_trade.imports_exports_2020"
[0m08:36:30.565146 [debug] [Thread-2 (]: Began executing node model.citrus_trade.imports_by_year
[0m08:36:30.567939 [debug] [Thread-2 (]: Writing runtime sql for node "model.citrus_trade.imports_by_year"
[0m08:36:30.568372 [debug] [Thread-1 (]: Began executing node model.citrus_trade.imports_exports_2020
[0m08:36:30.570707 [debug] [Thread-1 (]: Writing runtime sql for node "model.citrus_trade.imports_exports_2020"
[0m08:36:30.571546 [debug] [Thread-2 (]: Using snowflake connection "model.citrus_trade.imports_by_year"
[0m08:36:30.571822 [debug] [Thread-2 (]: On model.citrus_trade.imports_by_year: create or replace transient table TRADE_FLOW.marts.imports_by_year
    
    
    
    as (select
    declarant_iso,
    year,
    sum(value_in_euros) as total_value,
    sum(quantity_in_kg) as total_quantity,
    total_value/nullif(total_quantity,0) as value_per_quantity
from TRADE_FLOW.marts.trade_by_hs
where flow = 1
group by 1,2
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.imports_by_year"} */;
[0m08:36:30.574427 [debug] [Thread-1 (]: Using snowflake connection "model.citrus_trade.imports_exports_2020"
[0m08:36:30.574741 [debug] [Thread-1 (]: On model.citrus_trade.imports_exports_2020: create or replace transient table TRADE_FLOW.marts.imports_exports_2020
    
    
    
    as (select
    declarant_iso,
    flow,
    sum(value_in_euros) over(partition by declarant_iso, flow) as total_value,
    sum(quantity_in_kg) over(partition by declarant_iso, flow) as total_quantity,
    total_value/nullif(total_quantity,0) as value_per_quantity
from TRADE_FLOW.marts.trade_by_hs
where year = 2020
group by 
    declarant_iso,
    flow,
    value_in_euros,
    quantity_in_kg
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.imports_exports_2020"} */;
[0m08:36:31.277390 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.702 seconds
[0m08:36:31.281659 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '59826ff5-b738-458a-a1eb-7a72f20baecb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0183920>]}
[0m08:36:31.283534 [info ] [Thread-1 (]: 4 of 8 OK created sql table model marts.imports_exports_2020 ................... [[32mSUCCESS 1[0m in 0.72s]
[0m08:36:31.285340 [debug] [Thread-1 (]: Finished running node model.citrus_trade.imports_exports_2020
[0m08:36:31.286662 [debug] [Thread-3 (]: Began running node model.citrus_trade.score_2020
[0m08:36:31.287501 [info ] [Thread-3 (]: 5 of 8 START sql table model marts.score_2020 .................................. [RUN]
[0m08:36:31.288480 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.citrus_trade.trade_by_hs, now model.citrus_trade.score_2020)
[0m08:36:31.289211 [debug] [Thread-3 (]: Began compiling node model.citrus_trade.score_2020
[0m08:36:31.294718 [debug] [Thread-3 (]: Writing injected SQL for node "model.citrus_trade.score_2020"
[0m08:36:31.296562 [debug] [Thread-3 (]: Began executing node model.citrus_trade.score_2020
[0m08:36:31.300515 [debug] [Thread-3 (]: Writing runtime sql for node "model.citrus_trade.score_2020"
[0m08:36:31.303132 [debug] [Thread-3 (]: Using snowflake connection "model.citrus_trade.score_2020"
[0m08:36:31.303677 [debug] [Thread-3 (]: On model.citrus_trade.score_2020: create or replace transient table TRADE_FLOW.marts.score_2020
    
    
    
    as (select distinct 
    declarant_iso,
    total_value,
    total_quantity,
    value_per_quantity,
    (total_value - min(total_value) over())/((max(total_value) over())-(min(total_value) over())) as value_score,
    (total_quantity - min(total_quantity) over())/((max(total_quantity) over())-(min(total_quantity) over())) as quantity_score,
    (value_per_quantity - min(value_per_quantity) over())/((max(value_per_quantity) over())-(min(value_per_quantity) over())) as price_score
from TRADE_FLOW.marts.imports_exports_2020
where flow = 1
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.score_2020"} */;
[0m08:36:31.379479 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.807 seconds
[0m08:36:31.383303 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '59826ff5-b738-458a-a1eb-7a72f20baecb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb002e1b0>]}
[0m08:36:31.384394 [info ] [Thread-2 (]: 3 of 8 OK created sql table model marts.imports_by_year ........................ [[32mSUCCESS 1[0m in 0.83s]
[0m08:36:31.385553 [debug] [Thread-2 (]: Finished running node model.citrus_trade.imports_by_year
[0m08:36:31.386791 [debug] [Thread-1 (]: Began running node model.citrus_trade.growth_score
[0m08:36:31.387318 [info ] [Thread-1 (]: 6 of 8 START sql table model marts.growth_score ................................ [RUN]
[0m08:36:31.387759 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.citrus_trade.imports_exports_2020, now model.citrus_trade.growth_score)
[0m08:36:31.388125 [debug] [Thread-1 (]: Began compiling node model.citrus_trade.growth_score
[0m08:36:31.392719 [debug] [Thread-1 (]: Writing injected SQL for node "model.citrus_trade.growth_score"
[0m08:36:31.394347 [debug] [Thread-1 (]: Began executing node model.citrus_trade.growth_score
[0m08:36:31.397983 [debug] [Thread-1 (]: Writing runtime sql for node "model.citrus_trade.growth_score"
[0m08:36:31.403965 [debug] [Thread-1 (]: Using snowflake connection "model.citrus_trade.growth_score"
[0m08:36:31.404715 [debug] [Thread-1 (]: On model.citrus_trade.growth_score: create or replace transient table TRADE_FLOW.marts.growth_score
    
    
    
    as (with 
    previous_year AS (
        select 
            declarant_iso,
            year,
            lag(total_value,1) over(partition by declarant_iso order by year) previous_year_value,
            total_value,
            first_value(total_value) over(partition by declarant_iso order by year) as first_year_value,
            last_value(total_value) over(partition by declarant_iso order by year) as last_year_value
        from TRADE_FLOW.marts.imports_by_year
    ),
    growth_speed AS (
        select 
            declarant_iso,
            year,
            first_year_value,
            last_year_value,
            last_year_value/nullif(first_year_value,0) as growth_overall,
            previous_year_value,
            total_value,
            (total_value - previous_year_value)/total_value * 100 as growth_speed 
        from previous_year
    ),
    previous_year_growth_speed AS (
        select 
            declarant_iso,
            year,
            first_year_value,
            last_year_value,
            growth_overall,
            previous_year_value,
            total_value as current_value,
            growth_speed,
            lag(growth_speed,1) over(partition by declarant_iso order by year) previous_year_growth_speed,
        from growth_speed
        order by 1,2
    ),
    base AS (
        select 
            declarant_iso,
            year,
            first_year_value,
            last_year_value,
            growth_overall,
            previous_year_value,
            current_value,
            previous_year_growth_speed,
            growth_speed,
            growth_speed - previous_year_growth_speed as growth_acceleration,
            avg(growth_acceleration) over(partition by declarant_iso) as avg_acceleration
        from previous_year_growth_speed
    ),
    ok as (
        select 
            declarant_iso,
            year,
            first_year_value,
            last_year_value,
            growth_overall,
            (growth_overall - min(growth_overall) OVER())/(max(growth_overall) OVER() - min(growth_overall) OVER()) as growth_overall_norm,
            previous_year_value,
            current_value,
            -- previous_year_growth_speed,
            growth_speed,
            growth_acceleration,
            avg_acceleration,
            (avg_acceleration - min(avg_acceleration) OVER())/(max(avg_acceleration) OVER() - min(avg_acceleration) OVER()) as avg_acceleration_norm
        from base 
    )
    select 
        distinct 
        declarant_iso,
        year,
        current_value,
        growth_speed,
        growth_acceleration,
        growth_overall,
        growth_overall_norm,
        avg_acceleration,
        avg_acceleration_norm,
        growth_overall_norm * avg_acceleration_norm as growth_score
    from ok
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.growth_score"} */;
[0m08:36:31.983162 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.679 seconds
[0m08:36:31.989938 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '59826ff5-b738-458a-a1eb-7a72f20baecb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb05dc230>]}
[0m08:36:31.991570 [info ] [Thread-3 (]: 5 of 8 OK created sql table model marts.score_2020 ............................. [[32mSUCCESS 1[0m in 0.70s]
[0m08:36:31.993034 [debug] [Thread-3 (]: Finished running node model.citrus_trade.score_2020
[0m08:36:32.384017 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.978 seconds
[0m08:36:32.397286 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '59826ff5-b738-458a-a1eb-7a72f20baecb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0097fe0>]}
[0m08:36:32.399351 [info ] [Thread-1 (]: 6 of 8 OK created sql table model marts.growth_score ........................... [[32mSUCCESS 1[0m in 1.01s]
[0m08:36:32.403089 [debug] [Thread-1 (]: Finished running node model.citrus_trade.growth_score
[0m08:36:32.410408 [debug] [Thread-2 (]: Began running node model.citrus_trade.importer_score
[0m08:36:32.413491 [info ] [Thread-2 (]: 7 of 8 START sql table model marts.importer_score .............................. [RUN]
[0m08:36:32.414580 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.citrus_trade.imports_by_year, now model.citrus_trade.importer_score)
[0m08:36:32.415708 [debug] [Thread-2 (]: Began compiling node model.citrus_trade.importer_score
[0m08:36:32.421209 [debug] [Thread-2 (]: Writing injected SQL for node "model.citrus_trade.importer_score"
[0m08:36:32.424989 [debug] [Thread-2 (]: Began executing node model.citrus_trade.importer_score
[0m08:36:32.429947 [debug] [Thread-2 (]: Writing runtime sql for node "model.citrus_trade.importer_score"
[0m08:36:32.433162 [debug] [Thread-2 (]: Using snowflake connection "model.citrus_trade.importer_score"
[0m08:36:32.434386 [debug] [Thread-2 (]: On model.citrus_trade.importer_score: create or replace transient table TRADE_FLOW.marts.importer_score
    
    
    
    as (select distinct
    sc.declarant_iso,
    sc.total_value as revenue_total,
    sc.total_quantity as volume_total,
    sc.value_per_quantity as rate_avg,
    sc.value_score as revenue_score,
    sc.quantity_score as volume_score,
    sc.price_score as rate_score,
    gs.growth_score
from TRADE_FLOW.marts.score_2020 as sc
inner join TRADE_FLOW.marts.growth_score as gs
    on gs.declarant_iso = sc.declarant_iso
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.importer_score"} */;
[0m08:36:33.202072 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.767 seconds
[0m08:36:33.206498 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '59826ff5-b738-458a-a1eb-7a72f20baecb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb00a2540>]}
[0m08:36:33.207709 [info ] [Thread-2 (]: 7 of 8 OK created sql table model marts.importer_score ......................... [[32mSUCCESS 1[0m in 0.79s]
[0m08:36:33.208642 [debug] [Thread-2 (]: Finished running node model.citrus_trade.importer_score
[0m08:36:33.209854 [debug] [Thread-3 (]: Began running node model.citrus_trade.viz_importer_score
[0m08:36:33.210438 [info ] [Thread-3 (]: 8 of 8 START sql table model analytics.viz_importer_score ...................... [RUN]
[0m08:36:33.211049 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.citrus_trade.score_2020, now model.citrus_trade.viz_importer_score)
[0m08:36:33.211585 [debug] [Thread-3 (]: Began compiling node model.citrus_trade.viz_importer_score
[0m08:36:33.216121 [debug] [Thread-3 (]: Writing injected SQL for node "model.citrus_trade.viz_importer_score"
[0m08:36:33.218692 [debug] [Thread-3 (]: Began executing node model.citrus_trade.viz_importer_score
[0m08:36:33.222404 [debug] [Thread-3 (]: Writing runtime sql for node "model.citrus_trade.viz_importer_score"
[0m08:36:33.225400 [debug] [Thread-3 (]: Using snowflake connection "model.citrus_trade.viz_importer_score"
[0m08:36:33.225934 [debug] [Thread-3 (]: On model.citrus_trade.viz_importer_score: create or replace transient table TRADE_FLOW.analytics.viz_importer_score
    
    
    
    as (with 
    scores AS (
        select 
            declarant_iso,
            score_type,
            score
        from TRADE_FLOW.marts.importer_score
        unpivot (
            score for score_type in (
                revenue_score as 'revenue',
                volume_score as 'volume',
                rate_score as 'rate',
                growth_score as 'growth'
            )
        )
    ),
    value as (
        select 
            declarant_iso,
            value_type,
            value
        from TRADE_FLOW.marts.importer_score
        unpivot (
            value for value_type in (
                revenue_total as 'revenue',
                volume_score as 'volume',
                rate_score as 'rate'
            )
        )
    )
select 
    s.declarant_iso,
    s.score_type,
    s.score,
    v.value
from scores as s
left join values as v
    on s.declarant_iso = v.declarant_iso
   and s.score_type = v.value_type
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.viz_importer_score"} */;
[0m08:36:33.301727 [debug] [Thread-3 (]: Snowflake adapter: Snowflake query id: 01c04004-0305-74a0-0004-20ca000257be
[0m08:36:33.302818 [debug] [Thread-3 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 14 at position 33 unexpected ''revenue''.
syntax error line 15 at position 32 unexpected ''volume''.
syntax error line 16 at position 30 unexpected ''rate''.
syntax error line 17 at position 32 unexpected ''growth''.
syntax error line 29 at position 33 unexpected ''revenue''.
syntax error line 30 at position 32 unexpected ''volume''.
syntax error line 31 at position 30 unexpected ''rate''.
syntax error line 41 at position 17 unexpected 'as'.
syntax error line 42 at position 4 unexpected 'on'.
syntax error line 42 at position 7 unexpected 's'.
[0m08:36:33.310788 [debug] [Thread-3 (]: Database Error in model viz_importer_score (models/analytics/viz_importer_score.sql)
  001003 (42000): SQL compilation error:
  syntax error line 14 at position 33 unexpected ''revenue''.
  syntax error line 15 at position 32 unexpected ''volume''.
  syntax error line 16 at position 30 unexpected ''rate''.
  syntax error line 17 at position 32 unexpected ''growth''.
  syntax error line 29 at position 33 unexpected ''revenue''.
  syntax error line 30 at position 32 unexpected ''volume''.
  syntax error line 31 at position 30 unexpected ''rate''.
  syntax error line 41 at position 17 unexpected 'as'.
  syntax error line 42 at position 4 unexpected 'on'.
  syntax error line 42 at position 7 unexpected 's'.
  compiled code at target/run/citrus_trade/models/analytics/viz_importer_score.sql
[0m08:36:33.311782 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '59826ff5-b738-458a-a1eb-7a72f20baecb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb00b45c0>]}
[0m08:36:33.312540 [error] [Thread-3 (]: 8 of 8 ERROR creating sql table model analytics.viz_importer_score ............. [[31mERROR[0m in 0.10s]
[0m08:36:33.313203 [debug] [Thread-3 (]: Finished running node model.citrus_trade.viz_importer_score
[0m08:36:33.314048 [debug] [Thread-7 (]: Marking all children of 'model.citrus_trade.viz_importer_score' to be skipped because of status 'error'.  Reason: Database Error in model viz_importer_score (models/analytics/viz_importer_score.sql)
  001003 (42000): SQL compilation error:
  syntax error line 14 at position 33 unexpected ''revenue''.
  syntax error line 15 at position 32 unexpected ''volume''.
  syntax error line 16 at position 30 unexpected ''rate''.
  syntax error line 17 at position 32 unexpected ''growth''.
  syntax error line 29 at position 33 unexpected ''revenue''.
  syntax error line 30 at position 32 unexpected ''volume''.
  syntax error line 31 at position 30 unexpected ''rate''.
  syntax error line 41 at position 17 unexpected 'as'.
  syntax error line 42 at position 4 unexpected 'on'.
  syntax error line 42 at position 7 unexpected 's'.
  compiled code at target/run/citrus_trade/models/analytics/viz_importer_score.sql.
[0m08:36:33.318749 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:36:33.319197 [debug] [MainThread]: Connection 'model.citrus_trade.importer_score' was left open.
[0m08:36:33.319467 [debug] [MainThread]: On model.citrus_trade.importer_score: Close
[0m08:36:33.451232 [debug] [MainThread]: Connection 'model.citrus_trade.growth_score' was left open.
[0m08:36:33.452594 [debug] [MainThread]: On model.citrus_trade.growth_score: Close
[0m08:36:33.599161 [debug] [MainThread]: Connection 'model.citrus_trade.viz_importer_score' was left open.
[0m08:36:33.599839 [debug] [MainThread]: On model.citrus_trade.viz_importer_score: Close
[0m08:36:33.686809 [info ] [MainThread]: 
[0m08:36:33.687978 [info ] [MainThread]: Finished running 8 table models in 0 hours 0 minutes and 5.66 seconds (5.66s).
[0m08:36:33.691566 [debug] [MainThread]: Command end result
[0m08:36:33.746979 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m08:36:33.750521 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m08:36:33.758419 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/target/run_results.json
[0m08:36:33.758711 [info ] [MainThread]: 
[0m08:36:33.758957 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m08:36:33.759280 [info ] [MainThread]: 
[0m08:36:33.759751 [error] [MainThread]: [31mFailure in model viz_importer_score (models/analytics/viz_importer_score.sql)[0m
[0m08:36:33.760164 [error] [MainThread]:   Database Error in model viz_importer_score (models/analytics/viz_importer_score.sql)
  001003 (42000): SQL compilation error:
  syntax error line 14 at position 33 unexpected ''revenue''.
  syntax error line 15 at position 32 unexpected ''volume''.
  syntax error line 16 at position 30 unexpected ''rate''.
  syntax error line 17 at position 32 unexpected ''growth''.
  syntax error line 29 at position 33 unexpected ''revenue''.
  syntax error line 30 at position 32 unexpected ''volume''.
  syntax error line 31 at position 30 unexpected ''rate''.
  syntax error line 41 at position 17 unexpected 'as'.
  syntax error line 42 at position 4 unexpected 'on'.
  syntax error line 42 at position 7 unexpected 's'.
  compiled code at target/run/citrus_trade/models/analytics/viz_importer_score.sql
[0m08:36:33.760408 [info ] [MainThread]: 
[0m08:36:33.760762 [info ] [MainThread]:   compiled code at target/compiled/citrus_trade/models/analytics/viz_importer_score.sql
[0m08:36:33.760985 [info ] [MainThread]: 
[0m08:36:33.761373 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=8
[0m08:36:33.762978 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 6.7488756, "process_in_blocks": "0", "process_kernel_time": 0.461047, "process_mem_max_rss": "151936", "process_out_blocks": "4306", "process_user_time": 2.023207}
[0m08:36:33.763424 [debug] [MainThread]: Command `dbt run` failed at 08:36:33.763359 after 6.75 seconds
[0m08:36:33.763844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1d906e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb19cbe00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb19c8500>]}
[0m08:36:33.764097 [debug] [MainThread]: Flushing usage events
[0m08:36:34.376972 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:37:45.616171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e65deb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e5df020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f2d0b00>]}


============================== 08:37:45.619227 | f62dfd4c-1833-415d-abe8-9a7d8ee30b74 ==============================
[0m08:37:45.619227 [info ] [MainThread]: Running with dbt=1.10.13
[0m08:37:45.619675 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'target_path': 'None', 'printer_width': '80', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'write_json': 'True', 'warn_error': 'None', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'log_format': 'default', 'quiet': 'False', 'fail_fast': 'False', 'empty': 'False', 'invocation_command': 'dbt run', 'log_path': '/opt/airflow/dbt/logs', 'no_print': 'None', 'static_parser': 'True', 'profiles_dir': '/opt/airflow/dbt', 'partial_parse': 'True', 'use_experimental_parser': 'False'}
[0m08:37:45.774991 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m08:37:45.775418 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m08:37:45.775599 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m08:37:45.883042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f62dfd4c-1833-415d-abe8-9a7d8ee30b74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ff8a690>]}
[0m08:37:45.915673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f62dfd4c-1833-415d-abe8-9a7d8ee30b74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8fee5b20>]}
[0m08:37:45.916280 [info ] [MainThread]: Registered adapter: snowflake=1.10.3
[0m08:37:45.971612 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m08:37:46.106150 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m08:37:46.106567 [debug] [MainThread]: Partial parsing: updated file: citrus_trade://models/analytics/viz_importer_score.sql
[0m08:37:46.258782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f62dfd4c-1833-415d-abe8-9a7d8ee30b74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8bb17110>]}
[0m08:37:46.314203 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m08:37:46.315937 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m08:37:46.325129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f62dfd4c-1833-415d-abe8-9a7d8ee30b74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8babc470>]}
[0m08:37:46.325393 [info ] [MainThread]: Found 8 models, 3 sources, 636 macros
[0m08:37:46.325622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f62dfd4c-1833-415d-abe8-9a7d8ee30b74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8bc05e20>]}
[0m08:37:46.326933 [info ] [MainThread]: 
[0m08:37:46.327175 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:37:46.327596 [info ] [MainThread]: 
[0m08:37:46.328037 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m08:37:46.330880 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRADE_FLOW'
[0m08:37:46.336462 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRADE_FLOW'
[0m08:37:46.341860 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRADE_FLOW'
[0m08:37:46.366456 [debug] [ThreadPool]: Using snowflake connection "list_TRADE_FLOW"
[0m08:37:46.366778 [debug] [ThreadPool]: Using snowflake connection "list_TRADE_FLOW"
[0m08:37:46.366998 [debug] [ThreadPool]: Using snowflake connection "list_TRADE_FLOW"
[0m08:37:46.367163 [debug] [ThreadPool]: On list_TRADE_FLOW: show terse schemas in database TRADE_FLOW
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRADE_FLOW"} */
[0m08:37:46.367386 [debug] [ThreadPool]: On list_TRADE_FLOW: show terse schemas in database TRADE_FLOW
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRADE_FLOW"} */
[0m08:37:46.367609 [debug] [ThreadPool]: On list_TRADE_FLOW: show terse schemas in database TRADE_FLOW
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRADE_FLOW"} */
[0m08:37:46.367799 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:37:46.367986 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:37:46.368180 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:37:47.130742 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.763 seconds
[0m08:37:47.150737 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.783 seconds
[0m08:37:47.163628 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.795 seconds
[0m08:37:47.169591 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRADE_FLOW, now list_TRADE_FLOW_analytics)
[0m08:37:47.177781 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRADE_FLOW, now list_TRADE_FLOW_marts)
[0m08:37:47.187608 [debug] [ThreadPool]: Using snowflake connection "list_TRADE_FLOW_marts"
[0m08:37:47.188119 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRADE_FLOW, now list_TRADE_FLOW_staging)
[0m08:37:47.185393 [debug] [ThreadPool]: Using snowflake connection "list_TRADE_FLOW_analytics"
[0m08:37:47.188593 [debug] [ThreadPool]: On list_TRADE_FLOW_marts: show objects in TRADE_FLOW.marts
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRADE_FLOW_marts"} */;
[0m08:37:47.190541 [debug] [ThreadPool]: Using snowflake connection "list_TRADE_FLOW_staging"
[0m08:37:47.190894 [debug] [ThreadPool]: On list_TRADE_FLOW_analytics: show objects in TRADE_FLOW.analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRADE_FLOW_analytics"} */;
[0m08:37:47.191788 [debug] [ThreadPool]: On list_TRADE_FLOW_staging: show objects in TRADE_FLOW.staging
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRADE_FLOW_staging"} */;
[0m08:37:47.266684 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.074 seconds
[0m08:37:47.273310 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 0.082 seconds
[0m08:37:47.312326 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.118 seconds
[0m08:37:47.314365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f62dfd4c-1833-415d-abe8-9a7d8ee30b74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8babf800>]}
[0m08:37:47.321140 [debug] [Thread-1 (]: Began running node model.citrus_trade.stg_trade
[0m08:37:47.322539 [info ] [Thread-1 (]: 1 of 8 START sql table model staging.stg_trade ................................. [RUN]
[0m08:37:47.323137 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_TRADE_FLOW_staging, now model.citrus_trade.stg_trade)
[0m08:37:47.323623 [debug] [Thread-1 (]: Began compiling node model.citrus_trade.stg_trade
[0m08:37:47.332297 [debug] [Thread-1 (]: Writing injected SQL for node "model.citrus_trade.stg_trade"
[0m08:37:47.334177 [debug] [Thread-1 (]: Began executing node model.citrus_trade.stg_trade
[0m08:37:47.363969 [debug] [Thread-1 (]: Writing runtime sql for node "model.citrus_trade.stg_trade"
[0m08:37:47.366198 [debug] [Thread-1 (]: Using snowflake connection "model.citrus_trade.stg_trade"
[0m08:37:47.366563 [debug] [Thread-1 (]: On model.citrus_trade.stg_trade: create or replace transient table TRADE_FLOW.staging.stg_trade
    
    
    
    as (select
  value:DECLARANT::int as declarant,
  value:DECLARANT_ISO::string as declarant_iso,
  value:PARTNER::string as partner,
  value:PARTNER_ISO::string as partner_iso,
  value:FLOW::int as flow,
  value:TRANSPORT_MODE::int as transport_mode,
  value:PERIOD::int as period,
  year(to_date(left(period,4),'YYYY')) as year,
  value:HS4::string as hs4,
  value:HS4_NAME::string as hs4_name,
  value:HS6::string as hs6,
  value:HS6_NAME::string as hs6_name,
  value:VALUE_IN_EUROS::float as value_in_euros,
  value:QUANTITY_IN_KG::float as quantity_in_kg
from trade_flow.raw.raw_trhs
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.stg_trade"} */;
[0m08:37:48.159591 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.792 seconds
[0m08:37:48.194596 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f62dfd4c-1833-415d-abe8-9a7d8ee30b74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89f238c0>]}
[0m08:37:48.195390 [info ] [Thread-1 (]: 1 of 8 OK created sql table model staging.stg_trade ............................ [[32mSUCCESS 1[0m in 0.87s]
[0m08:37:48.196249 [debug] [Thread-1 (]: Finished running node model.citrus_trade.stg_trade
[0m08:37:48.197047 [debug] [Thread-3 (]: Began running node model.citrus_trade.trade_by_hs
[0m08:37:48.197554 [info ] [Thread-3 (]: 2 of 8 START sql table model marts.trade_by_hs ................................. [RUN]
[0m08:37:48.198154 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_TRADE_FLOW_marts, now model.citrus_trade.trade_by_hs)
[0m08:37:48.198491 [debug] [Thread-3 (]: Began compiling node model.citrus_trade.trade_by_hs
[0m08:37:48.201404 [debug] [Thread-3 (]: Writing injected SQL for node "model.citrus_trade.trade_by_hs"
[0m08:37:48.202515 [debug] [Thread-3 (]: Began executing node model.citrus_trade.trade_by_hs
[0m08:37:48.207427 [debug] [Thread-3 (]: Writing runtime sql for node "model.citrus_trade.trade_by_hs"
[0m08:37:48.208823 [debug] [Thread-3 (]: Using snowflake connection "model.citrus_trade.trade_by_hs"
[0m08:37:48.209262 [debug] [Thread-3 (]: On model.citrus_trade.trade_by_hs: create or replace transient table TRADE_FLOW.marts.trade_by_hs
    
    
    
    as (select
    *
from TRADE_FLOW.staging.stg_trade
where hs6 = '080510'
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.trade_by_hs"} */;
[0m08:37:48.879205 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.669 seconds
[0m08:37:48.884251 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f62dfd4c-1833-415d-abe8-9a7d8ee30b74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89f30680>]}
[0m08:37:48.885591 [info ] [Thread-3 (]: 2 of 8 OK created sql table model marts.trade_by_hs ............................ [[32mSUCCESS 1[0m in 0.69s]
[0m08:37:48.886817 [debug] [Thread-3 (]: Finished running node model.citrus_trade.trade_by_hs
[0m08:37:48.888278 [debug] [Thread-2 (]: Began running node model.citrus_trade.imports_by_year
[0m08:37:48.889184 [debug] [Thread-1 (]: Began running node model.citrus_trade.imports_exports_2020
[0m08:37:48.889865 [info ] [Thread-2 (]: 3 of 8 START sql table model marts.imports_by_year ............................. [RUN]
[0m08:37:48.892019 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_TRADE_FLOW_analytics, now model.citrus_trade.imports_by_year)
[0m08:37:48.892723 [debug] [Thread-2 (]: Began compiling node model.citrus_trade.imports_by_year
[0m08:37:48.891173 [info ] [Thread-1 (]: 4 of 8 START sql table model marts.imports_exports_2020 ........................ [RUN]
[0m08:37:48.897552 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.citrus_trade.stg_trade, now model.citrus_trade.imports_exports_2020)
[0m08:37:48.898039 [debug] [Thread-1 (]: Began compiling node model.citrus_trade.imports_exports_2020
[0m08:37:48.896929 [debug] [Thread-2 (]: Writing injected SQL for node "model.citrus_trade.imports_by_year"
[0m08:37:48.901552 [debug] [Thread-1 (]: Writing injected SQL for node "model.citrus_trade.imports_exports_2020"
[0m08:37:48.903921 [debug] [Thread-2 (]: Began executing node model.citrus_trade.imports_by_year
[0m08:37:48.907328 [debug] [Thread-2 (]: Writing runtime sql for node "model.citrus_trade.imports_by_year"
[0m08:37:48.907708 [debug] [Thread-1 (]: Began executing node model.citrus_trade.imports_exports_2020
[0m08:37:48.910482 [debug] [Thread-1 (]: Writing runtime sql for node "model.citrus_trade.imports_exports_2020"
[0m08:37:48.912124 [debug] [Thread-2 (]: Using snowflake connection "model.citrus_trade.imports_by_year"
[0m08:37:48.912594 [debug] [Thread-2 (]: On model.citrus_trade.imports_by_year: create or replace transient table TRADE_FLOW.marts.imports_by_year
    
    
    
    as (select
    declarant_iso,
    year,
    sum(value_in_euros) as total_value,
    sum(quantity_in_kg) as total_quantity,
    total_value/nullif(total_quantity,0) as value_per_quantity
from TRADE_FLOW.marts.trade_by_hs
where flow = 1
group by 1,2
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.imports_by_year"} */;
[0m08:37:48.913651 [debug] [Thread-1 (]: Using snowflake connection "model.citrus_trade.imports_exports_2020"
[0m08:37:48.914879 [debug] [Thread-1 (]: On model.citrus_trade.imports_exports_2020: create or replace transient table TRADE_FLOW.marts.imports_exports_2020
    
    
    
    as (select
    declarant_iso,
    flow,
    sum(value_in_euros) over(partition by declarant_iso, flow) as total_value,
    sum(quantity_in_kg) over(partition by declarant_iso, flow) as total_quantity,
    total_value/nullif(total_quantity,0) as value_per_quantity
from TRADE_FLOW.marts.trade_by_hs
where year = 2020
group by 
    declarant_iso,
    flow,
    value_in_euros,
    quantity_in_kg
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.imports_exports_2020"} */;
[0m08:37:49.696043 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.782 seconds
[0m08:37:49.700806 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f62dfd4c-1833-415d-abe8-9a7d8ee30b74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a364440>]}
[0m08:37:49.702025 [info ] [Thread-2 (]: 3 of 8 OK created sql table model marts.imports_by_year ........................ [[32mSUCCESS 1[0m in 0.81s]
[0m08:37:49.703265 [debug] [Thread-2 (]: Finished running node model.citrus_trade.imports_by_year
[0m08:37:49.704450 [debug] [Thread-3 (]: Began running node model.citrus_trade.growth_score
[0m08:37:49.705217 [info ] [Thread-3 (]: 5 of 8 START sql table model marts.growth_score ................................ [RUN]
[0m08:37:49.706066 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.citrus_trade.trade_by_hs, now model.citrus_trade.growth_score)
[0m08:37:49.706632 [debug] [Thread-3 (]: Began compiling node model.citrus_trade.growth_score
[0m08:37:49.712874 [debug] [Thread-3 (]: Writing injected SQL for node "model.citrus_trade.growth_score"
[0m08:37:49.714966 [debug] [Thread-3 (]: Began executing node model.citrus_trade.growth_score
[0m08:37:49.718587 [debug] [Thread-3 (]: Writing runtime sql for node "model.citrus_trade.growth_score"
[0m08:37:49.722834 [debug] [Thread-3 (]: Using snowflake connection "model.citrus_trade.growth_score"
[0m08:37:49.723483 [debug] [Thread-3 (]: On model.citrus_trade.growth_score: create or replace transient table TRADE_FLOW.marts.growth_score
    
    
    
    as (with 
    previous_year AS (
        select 
            declarant_iso,
            year,
            lag(total_value,1) over(partition by declarant_iso order by year) previous_year_value,
            total_value,
            first_value(total_value) over(partition by declarant_iso order by year) as first_year_value,
            last_value(total_value) over(partition by declarant_iso order by year) as last_year_value
        from TRADE_FLOW.marts.imports_by_year
    ),
    growth_speed AS (
        select 
            declarant_iso,
            year,
            first_year_value,
            last_year_value,
            last_year_value/nullif(first_year_value,0) as growth_overall,
            previous_year_value,
            total_value,
            (total_value - previous_year_value)/total_value * 100 as growth_speed 
        from previous_year
    ),
    previous_year_growth_speed AS (
        select 
            declarant_iso,
            year,
            first_year_value,
            last_year_value,
            growth_overall,
            previous_year_value,
            total_value as current_value,
            growth_speed,
            lag(growth_speed,1) over(partition by declarant_iso order by year) previous_year_growth_speed,
        from growth_speed
        order by 1,2
    ),
    base AS (
        select 
            declarant_iso,
            year,
            first_year_value,
            last_year_value,
            growth_overall,
            previous_year_value,
            current_value,
            previous_year_growth_speed,
            growth_speed,
            growth_speed - previous_year_growth_speed as growth_acceleration,
            avg(growth_acceleration) over(partition by declarant_iso) as avg_acceleration
        from previous_year_growth_speed
    ),
    ok as (
        select 
            declarant_iso,
            year,
            first_year_value,
            last_year_value,
            growth_overall,
            (growth_overall - min(growth_overall) OVER())/(max(growth_overall) OVER() - min(growth_overall) OVER()) as growth_overall_norm,
            previous_year_value,
            current_value,
            -- previous_year_growth_speed,
            growth_speed,
            growth_acceleration,
            avg_acceleration,
            (avg_acceleration - min(avg_acceleration) OVER())/(max(avg_acceleration) OVER() - min(avg_acceleration) OVER()) as avg_acceleration_norm
        from base 
    )
    select 
        distinct 
        declarant_iso,
        year,
        current_value,
        growth_speed,
        growth_acceleration,
        growth_overall,
        growth_overall_norm,
        avg_acceleration,
        avg_acceleration_norm,
        growth_overall_norm * avg_acceleration_norm as growth_score
    from ok
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.growth_score"} */;
[0m08:37:49.729774 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.814 seconds
[0m08:37:49.731970 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f62dfd4c-1833-415d-abe8-9a7d8ee30b74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a36ec30>]}
[0m08:37:49.732675 [info ] [Thread-1 (]: 4 of 8 OK created sql table model marts.imports_exports_2020 ................... [[32mSUCCESS 1[0m in 0.83s]
[0m08:37:49.733282 [debug] [Thread-1 (]: Finished running node model.citrus_trade.imports_exports_2020
[0m08:37:49.734155 [debug] [Thread-2 (]: Began running node model.citrus_trade.score_2020
[0m08:37:49.734671 [info ] [Thread-2 (]: 6 of 8 START sql table model marts.score_2020 .................................. [RUN]
[0m08:37:49.735279 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.citrus_trade.imports_by_year, now model.citrus_trade.score_2020)
[0m08:37:49.735725 [debug] [Thread-2 (]: Began compiling node model.citrus_trade.score_2020
[0m08:37:49.740054 [debug] [Thread-2 (]: Writing injected SQL for node "model.citrus_trade.score_2020"
[0m08:37:49.741799 [debug] [Thread-2 (]: Began executing node model.citrus_trade.score_2020
[0m08:37:49.744805 [debug] [Thread-2 (]: Writing runtime sql for node "model.citrus_trade.score_2020"
[0m08:37:49.746417 [debug] [Thread-2 (]: Using snowflake connection "model.citrus_trade.score_2020"
[0m08:37:49.746742 [debug] [Thread-2 (]: On model.citrus_trade.score_2020: create or replace transient table TRADE_FLOW.marts.score_2020
    
    
    
    as (select distinct 
    declarant_iso,
    total_value,
    total_quantity,
    value_per_quantity,
    (total_value - min(total_value) over())/((max(total_value) over())-(min(total_value) over())) as value_score,
    (total_quantity - min(total_quantity) over())/((max(total_quantity) over())-(min(total_quantity) over())) as quantity_score,
    (value_per_quantity - min(value_per_quantity) over())/((max(value_per_quantity) over())-(min(value_per_quantity) over())) as price_score
from TRADE_FLOW.marts.imports_exports_2020
where flow = 1
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.score_2020"} */;
[0m08:37:50.413989 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.666 seconds
[0m08:37:50.419665 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f62dfd4c-1833-415d-abe8-9a7d8ee30b74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a3455e0>]}
[0m08:37:50.420957 [info ] [Thread-2 (]: 6 of 8 OK created sql table model marts.score_2020 ............................. [[32mSUCCESS 1[0m in 0.68s]
[0m08:37:50.421904 [debug] [Thread-2 (]: Finished running node model.citrus_trade.score_2020
[0m08:37:50.585033 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.861 seconds
[0m08:37:50.589870 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f62dfd4c-1833-415d-abe8-9a7d8ee30b74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a7da330>]}
[0m08:37:50.591131 [info ] [Thread-3 (]: 5 of 8 OK created sql table model marts.growth_score ........................... [[32mSUCCESS 1[0m in 0.88s]
[0m08:37:50.592007 [debug] [Thread-3 (]: Finished running node model.citrus_trade.growth_score
[0m08:37:50.593540 [debug] [Thread-1 (]: Began running node model.citrus_trade.importer_score
[0m08:37:50.594013 [info ] [Thread-1 (]: 7 of 8 START sql table model marts.importer_score .............................. [RUN]
[0m08:37:50.594552 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.citrus_trade.imports_exports_2020, now model.citrus_trade.importer_score)
[0m08:37:50.595000 [debug] [Thread-1 (]: Began compiling node model.citrus_trade.importer_score
[0m08:37:50.600742 [debug] [Thread-1 (]: Writing injected SQL for node "model.citrus_trade.importer_score"
[0m08:37:50.602244 [debug] [Thread-1 (]: Began executing node model.citrus_trade.importer_score
[0m08:37:50.604941 [debug] [Thread-1 (]: Writing runtime sql for node "model.citrus_trade.importer_score"
[0m08:37:50.606467 [debug] [Thread-1 (]: Using snowflake connection "model.citrus_trade.importer_score"
[0m08:37:50.606796 [debug] [Thread-1 (]: On model.citrus_trade.importer_score: create or replace transient table TRADE_FLOW.marts.importer_score
    
    
    
    as (select distinct
    sc.declarant_iso,
    sc.total_value as revenue_total,
    sc.total_quantity as volume_total,
    sc.value_per_quantity as rate_avg,
    sc.value_score as revenue_score,
    sc.quantity_score as volume_score,
    sc.price_score as rate_score,
    gs.growth_score
from TRADE_FLOW.marts.score_2020 as sc
inner join TRADE_FLOW.marts.growth_score as gs
    on gs.declarant_iso = sc.declarant_iso
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.importer_score"} */;
[0m08:37:51.438096 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.831 seconds
[0m08:37:51.442429 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f62dfd4c-1833-415d-abe8-9a7d8ee30b74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8afc1be0>]}
[0m08:37:51.443489 [info ] [Thread-1 (]: 7 of 8 OK created sql table model marts.importer_score ......................... [[32mSUCCESS 1[0m in 0.85s]
[0m08:37:51.444593 [debug] [Thread-1 (]: Finished running node model.citrus_trade.importer_score
[0m08:37:51.445938 [debug] [Thread-2 (]: Began running node model.citrus_trade.viz_importer_score
[0m08:37:51.446541 [info ] [Thread-2 (]: 8 of 8 START sql table model analytics.viz_importer_score ...................... [RUN]
[0m08:37:51.447233 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.citrus_trade.score_2020, now model.citrus_trade.viz_importer_score)
[0m08:37:51.447848 [debug] [Thread-2 (]: Began compiling node model.citrus_trade.viz_importer_score
[0m08:37:51.452121 [debug] [Thread-2 (]: Writing injected SQL for node "model.citrus_trade.viz_importer_score"
[0m08:37:51.453729 [debug] [Thread-2 (]: Began executing node model.citrus_trade.viz_importer_score
[0m08:37:51.456869 [debug] [Thread-2 (]: Writing runtime sql for node "model.citrus_trade.viz_importer_score"
[0m08:37:51.458827 [debug] [Thread-2 (]: Using snowflake connection "model.citrus_trade.viz_importer_score"
[0m08:37:51.459235 [debug] [Thread-2 (]: On model.citrus_trade.viz_importer_score: create or replace transient table TRADE_FLOW.analytics.viz_importer_score
    
    
    
    as (with 
    scores AS (
        select 
            declarant_iso,
            score_type,
            score
        from TRADE_FLOW.marts.importer_score
        unpivot (
            score for score_type in (
                revenue_score as "revenue",
                volume_score as "volume",
                rate_score as "rate",
                growth_score as "growth"
            )
        )
    ),
    value as (
        select 
            declarant_iso,
            value_type,
            value
        from TRADE_FLOW.marts.importer_score
        unpivot (
            value for value_type in (
                revenue_total as "revenue",
                volume_score as "volume",
                rate_score as "rate"
            )
        )
    )
select 
    s.declarant_iso,
    s.score_type,
    s.score,
    v.value
from scores as s
left join values as v
    on s.declarant_iso = v.declarant_iso
   and s.score_type = v.value_type
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.viz_importer_score"} */;
[0m08:37:51.533333 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01c04005-0305-74a0-0004-20ca000257f6
[0m08:37:51.533908 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 41 at position 17 unexpected 'as'.
syntax error line 42 at position 4 unexpected 'on'.
syntax error line 42 at position 7 unexpected 's'.
[0m08:37:51.537231 [debug] [Thread-2 (]: Database Error in model viz_importer_score (models/analytics/viz_importer_score.sql)
  001003 (42000): SQL compilation error:
  syntax error line 41 at position 17 unexpected 'as'.
  syntax error line 42 at position 4 unexpected 'on'.
  syntax error line 42 at position 7 unexpected 's'.
  compiled code at target/run/citrus_trade/models/analytics/viz_importer_score.sql
[0m08:37:51.537825 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f62dfd4c-1833-415d-abe8-9a7d8ee30b74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a7d9be0>]}
[0m08:37:51.538427 [error] [Thread-2 (]: 8 of 8 ERROR creating sql table model analytics.viz_importer_score ............. [[31mERROR[0m in 0.09s]
[0m08:37:51.538964 [debug] [Thread-2 (]: Finished running node model.citrus_trade.viz_importer_score
[0m08:37:51.539524 [debug] [Thread-7 (]: Marking all children of 'model.citrus_trade.viz_importer_score' to be skipped because of status 'error'.  Reason: Database Error in model viz_importer_score (models/analytics/viz_importer_score.sql)
  001003 (42000): SQL compilation error:
  syntax error line 41 at position 17 unexpected 'as'.
  syntax error line 42 at position 4 unexpected 'on'.
  syntax error line 42 at position 7 unexpected 's'.
  compiled code at target/run/citrus_trade/models/analytics/viz_importer_score.sql.
[0m08:37:51.541892 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:37:51.542251 [debug] [MainThread]: Connection 'model.citrus_trade.importer_score' was left open.
[0m08:37:51.542518 [debug] [MainThread]: On model.citrus_trade.importer_score: Close
[0m08:37:51.648233 [debug] [MainThread]: Connection 'model.citrus_trade.growth_score' was left open.
[0m08:37:51.649128 [debug] [MainThread]: On model.citrus_trade.growth_score: Close
[0m08:37:51.743764 [debug] [MainThread]: Connection 'model.citrus_trade.viz_importer_score' was left open.
[0m08:37:51.744996 [debug] [MainThread]: On model.citrus_trade.viz_importer_score: Close
[0m08:37:51.838431 [info ] [MainThread]: 
[0m08:37:51.839787 [info ] [MainThread]: Finished running 8 table models in 0 hours 0 minutes and 5.51 seconds (5.51s).
[0m08:37:51.842879 [debug] [MainThread]: Command end result
[0m08:37:51.906695 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m08:37:51.909554 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m08:37:51.915716 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/target/run_results.json
[0m08:37:51.915965 [info ] [MainThread]: 
[0m08:37:51.916278 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m08:37:51.916649 [info ] [MainThread]: 
[0m08:37:51.917051 [error] [MainThread]: [31mFailure in model viz_importer_score (models/analytics/viz_importer_score.sql)[0m
[0m08:37:51.917407 [error] [MainThread]:   Database Error in model viz_importer_score (models/analytics/viz_importer_score.sql)
  001003 (42000): SQL compilation error:
  syntax error line 41 at position 17 unexpected 'as'.
  syntax error line 42 at position 4 unexpected 'on'.
  syntax error line 42 at position 7 unexpected 's'.
  compiled code at target/run/citrus_trade/models/analytics/viz_importer_score.sql
[0m08:37:51.917665 [info ] [MainThread]: 
[0m08:37:51.918124 [info ] [MainThread]:   compiled code at target/compiled/citrus_trade/models/analytics/viz_importer_score.sql
[0m08:37:51.918423 [info ] [MainThread]: 
[0m08:37:51.918830 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=8
[0m08:37:51.920369 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 6.3367634, "process_in_blocks": "0", "process_kernel_time": 0.474426, "process_mem_max_rss": "151596", "process_out_blocks": "4303", "process_user_time": 1.954879}
[0m08:37:51.920837 [debug] [MainThread]: Command `dbt run` failed at 08:37:51.920745 after 6.34 seconds
[0m08:37:51.921260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8db6be30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c8552e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e624890>]}
[0m08:37:51.921493 [debug] [MainThread]: Flushing usage events
[0m08:37:52.533188 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:39:03.129273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d6029f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b5567e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d39f5f0>]}


============================== 08:39:03.132739 | 27f39edd-4de5-4cd0-8bc6-a92b07fd137f ==============================
[0m08:39:03.132739 [info ] [MainThread]: Running with dbt=1.10.13
[0m08:39:03.133270 [debug] [MainThread]: running dbt with arguments {'log_path': '/opt/airflow/dbt/logs', 'quiet': 'False', 'indirect_selection': 'eager', 'no_print': 'None', 'static_parser': 'True', 'profiles_dir': '/opt/airflow/dbt', 'target_path': 'None', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'empty': 'False', 'warn_error': 'None', 'write_json': 'True', 'debug': 'False', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'version_check': 'True', 'printer_width': '80', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'partial_parse': 'True'}
[0m08:39:03.287892 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m08:39:03.289475 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m08:39:03.289719 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m08:39:03.402070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '27f39edd-4de5-4cd0-8bc6-a92b07fd137f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff790bf6e0>]}
[0m08:39:03.440979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '27f39edd-4de5-4cd0-8bc6-a92b07fd137f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff79248aa0>]}
[0m08:39:03.441727 [info ] [MainThread]: Registered adapter: snowflake=1.10.3
[0m08:39:03.499673 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m08:39:03.639373 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m08:39:03.639802 [debug] [MainThread]: Partial parsing: updated file: citrus_trade://models/analytics/viz_importer_score.sql
[0m08:39:03.802460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '27f39edd-4de5-4cd0-8bc6-a92b07fd137f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff789cb2c0>]}
[0m08:39:03.858310 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m08:39:03.859919 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m08:39:03.869758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '27f39edd-4de5-4cd0-8bc6-a92b07fd137f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff789705c0>]}
[0m08:39:03.870307 [info ] [MainThread]: Found 8 models, 3 sources, 636 macros
[0m08:39:03.870545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '27f39edd-4de5-4cd0-8bc6-a92b07fd137f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff79498e30>]}
[0m08:39:03.872008 [info ] [MainThread]: 
[0m08:39:03.872319 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:39:03.872625 [info ] [MainThread]: 
[0m08:39:03.873028 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m08:39:03.875784 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRADE_FLOW'
[0m08:39:03.881707 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRADE_FLOW'
[0m08:39:03.885150 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRADE_FLOW'
[0m08:39:03.912838 [debug] [ThreadPool]: Using snowflake connection "list_TRADE_FLOW"
[0m08:39:03.913177 [debug] [ThreadPool]: Using snowflake connection "list_TRADE_FLOW"
[0m08:39:03.913434 [debug] [ThreadPool]: Using snowflake connection "list_TRADE_FLOW"
[0m08:39:03.913595 [debug] [ThreadPool]: On list_TRADE_FLOW: show terse schemas in database TRADE_FLOW
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRADE_FLOW"} */
[0m08:39:03.913846 [debug] [ThreadPool]: On list_TRADE_FLOW: show terse schemas in database TRADE_FLOW
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRADE_FLOW"} */
[0m08:39:03.914084 [debug] [ThreadPool]: On list_TRADE_FLOW: show terse schemas in database TRADE_FLOW
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRADE_FLOW"} */
[0m08:39:03.914277 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:39:03.914499 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:39:03.914709 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:39:04.623762 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.709 seconds
[0m08:39:04.625525 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.711 seconds
[0m08:39:04.642463 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.728 seconds
[0m08:39:04.644503 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRADE_FLOW, now list_TRADE_FLOW_analytics)
[0m08:39:04.650909 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRADE_FLOW, now list_TRADE_FLOW_staging)
[0m08:39:04.652525 [debug] [ThreadPool]: Using snowflake connection "list_TRADE_FLOW_analytics"
[0m08:39:04.655118 [debug] [ThreadPool]: Using snowflake connection "list_TRADE_FLOW_staging"
[0m08:39:04.655435 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRADE_FLOW, now list_TRADE_FLOW_marts)
[0m08:39:04.655784 [debug] [ThreadPool]: On list_TRADE_FLOW_analytics: show objects in TRADE_FLOW.analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRADE_FLOW_analytics"} */;
[0m08:39:04.656028 [debug] [ThreadPool]: On list_TRADE_FLOW_staging: show objects in TRADE_FLOW.staging
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRADE_FLOW_staging"} */;
[0m08:39:04.657383 [debug] [ThreadPool]: Using snowflake connection "list_TRADE_FLOW_marts"
[0m08:39:04.659528 [debug] [ThreadPool]: On list_TRADE_FLOW_marts: show objects in TRADE_FLOW.marts
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRADE_FLOW_marts"} */;
[0m08:39:04.737748 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 0.078 seconds
[0m08:39:04.756447 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.099 seconds
[0m08:39:04.757228 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.098 seconds
[0m08:39:04.760328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '27f39edd-4de5-4cd0-8bc6-a92b07fd137f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff789cb230>]}
[0m08:39:04.763154 [debug] [Thread-1 (]: Began running node model.citrus_trade.stg_trade
[0m08:39:04.763686 [info ] [Thread-1 (]: 1 of 8 START sql table model staging.stg_trade ................................. [RUN]
[0m08:39:04.764153 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_TRADE_FLOW_staging, now model.citrus_trade.stg_trade)
[0m08:39:04.764388 [debug] [Thread-1 (]: Began compiling node model.citrus_trade.stg_trade
[0m08:39:04.769747 [debug] [Thread-1 (]: Writing injected SQL for node "model.citrus_trade.stg_trade"
[0m08:39:04.771267 [debug] [Thread-1 (]: Began executing node model.citrus_trade.stg_trade
[0m08:39:04.798447 [debug] [Thread-1 (]: Writing runtime sql for node "model.citrus_trade.stg_trade"
[0m08:39:04.804062 [debug] [Thread-1 (]: Using snowflake connection "model.citrus_trade.stg_trade"
[0m08:39:04.806522 [debug] [Thread-1 (]: On model.citrus_trade.stg_trade: create or replace transient table TRADE_FLOW.staging.stg_trade
    
    
    
    as (select
  value:DECLARANT::int as declarant,
  value:DECLARANT_ISO::string as declarant_iso,
  value:PARTNER::string as partner,
  value:PARTNER_ISO::string as partner_iso,
  value:FLOW::int as flow,
  value:TRANSPORT_MODE::int as transport_mode,
  value:PERIOD::int as period,
  year(to_date(left(period,4),'YYYY')) as year,
  value:HS4::string as hs4,
  value:HS4_NAME::string as hs4_name,
  value:HS6::string as hs6,
  value:HS6_NAME::string as hs6_name,
  value:VALUE_IN_EUROS::float as value_in_euros,
  value:QUANTITY_IN_KG::float as quantity_in_kg
from trade_flow.raw.raw_trhs
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.stg_trade"} */;
[0m08:39:05.573214 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.765 seconds
[0m08:39:05.592383 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '27f39edd-4de5-4cd0-8bc6-a92b07fd137f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7cff5970>]}
[0m08:39:05.592968 [info ] [Thread-1 (]: 1 of 8 OK created sql table model staging.stg_trade ............................ [[32mSUCCESS 1[0m in 0.83s]
[0m08:39:05.593568 [debug] [Thread-1 (]: Finished running node model.citrus_trade.stg_trade
[0m08:39:05.594819 [debug] [Thread-3 (]: Began running node model.citrus_trade.trade_by_hs
[0m08:39:05.595246 [info ] [Thread-3 (]: 2 of 8 START sql table model marts.trade_by_hs ................................. [RUN]
[0m08:39:05.595698 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_TRADE_FLOW_marts, now model.citrus_trade.trade_by_hs)
[0m08:39:05.596674 [debug] [Thread-3 (]: Began compiling node model.citrus_trade.trade_by_hs
[0m08:39:05.599636 [debug] [Thread-3 (]: Writing injected SQL for node "model.citrus_trade.trade_by_hs"
[0m08:39:05.602226 [debug] [Thread-3 (]: Began executing node model.citrus_trade.trade_by_hs
[0m08:39:05.604087 [debug] [Thread-3 (]: Writing runtime sql for node "model.citrus_trade.trade_by_hs"
[0m08:39:05.604976 [debug] [Thread-3 (]: Using snowflake connection "model.citrus_trade.trade_by_hs"
[0m08:39:05.605178 [debug] [Thread-3 (]: On model.citrus_trade.trade_by_hs: create or replace transient table TRADE_FLOW.marts.trade_by_hs
    
    
    
    as (select
    *
from TRADE_FLOW.staging.stg_trade
where hs6 = '080510'
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.trade_by_hs"} */;
[0m08:39:06.254512 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.649 seconds
[0m08:39:06.256490 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '27f39edd-4de5-4cd0-8bc6-a92b07fd137f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff73372150>]}
[0m08:39:06.257076 [info ] [Thread-3 (]: 2 of 8 OK created sql table model marts.trade_by_hs ............................ [[32mSUCCESS 1[0m in 0.66s]
[0m08:39:06.257568 [debug] [Thread-3 (]: Finished running node model.citrus_trade.trade_by_hs
[0m08:39:06.258329 [debug] [Thread-2 (]: Began running node model.citrus_trade.imports_by_year
[0m08:39:06.258803 [info ] [Thread-2 (]: 3 of 8 START sql table model marts.imports_by_year ............................. [RUN]
[0m08:39:06.258534 [debug] [Thread-1 (]: Began running node model.citrus_trade.imports_exports_2020
[0m08:39:06.259527 [info ] [Thread-1 (]: 4 of 8 START sql table model marts.imports_exports_2020 ........................ [RUN]
[0m08:39:06.259828 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.citrus_trade.stg_trade, now model.citrus_trade.imports_exports_2020)
[0m08:39:06.260066 [debug] [Thread-1 (]: Began compiling node model.citrus_trade.imports_exports_2020
[0m08:39:06.259138 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_TRADE_FLOW_analytics, now model.citrus_trade.imports_by_year)
[0m08:39:06.263818 [debug] [Thread-2 (]: Began compiling node model.citrus_trade.imports_by_year
[0m08:39:06.265466 [debug] [Thread-2 (]: Writing injected SQL for node "model.citrus_trade.imports_by_year"
[0m08:39:06.263474 [debug] [Thread-1 (]: Writing injected SQL for node "model.citrus_trade.imports_exports_2020"
[0m08:39:06.266890 [debug] [Thread-2 (]: Began executing node model.citrus_trade.imports_by_year
[0m08:39:06.268863 [debug] [Thread-2 (]: Writing runtime sql for node "model.citrus_trade.imports_by_year"
[0m08:39:06.269107 [debug] [Thread-1 (]: Began executing node model.citrus_trade.imports_exports_2020
[0m08:39:06.270781 [debug] [Thread-1 (]: Writing runtime sql for node "model.citrus_trade.imports_exports_2020"
[0m08:39:06.272150 [debug] [Thread-2 (]: Using snowflake connection "model.citrus_trade.imports_by_year"
[0m08:39:06.272462 [debug] [Thread-2 (]: On model.citrus_trade.imports_by_year: create or replace transient table TRADE_FLOW.marts.imports_by_year
    
    
    
    as (select
    declarant_iso,
    year,
    sum(value_in_euros) as total_value,
    sum(quantity_in_kg) as total_quantity,
    total_value/nullif(total_quantity,0) as value_per_quantity
from TRADE_FLOW.marts.trade_by_hs
where flow = 1
group by 1,2
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.imports_by_year"} */;
[0m08:39:06.273023 [debug] [Thread-1 (]: Using snowflake connection "model.citrus_trade.imports_exports_2020"
[0m08:39:06.274518 [debug] [Thread-1 (]: On model.citrus_trade.imports_exports_2020: create or replace transient table TRADE_FLOW.marts.imports_exports_2020
    
    
    
    as (select
    declarant_iso,
    flow,
    sum(value_in_euros) over(partition by declarant_iso, flow) as total_value,
    sum(quantity_in_kg) over(partition by declarant_iso, flow) as total_quantity,
    total_value/nullif(total_quantity,0) as value_per_quantity
from TRADE_FLOW.marts.trade_by_hs
where year = 2020
group by 
    declarant_iso,
    flow,
    value_in_euros,
    quantity_in_kg
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.imports_exports_2020"} */;
[0m08:39:06.909253 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.636 seconds
[0m08:39:06.911031 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.636 seconds
[0m08:39:06.915459 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '27f39edd-4de5-4cd0-8bc6-a92b07fd137f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff73735220>]}
[0m08:39:06.916197 [info ] [Thread-1 (]: 4 of 8 OK created sql table model marts.imports_exports_2020 ................... [[32mSUCCESS 1[0m in 0.66s]
[0m08:39:06.917039 [debug] [Thread-1 (]: Finished running node model.citrus_trade.imports_exports_2020
[0m08:39:06.914146 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '27f39edd-4de5-4cd0-8bc6-a92b07fd137f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff73381550>]}
[0m08:39:06.917886 [info ] [Thread-2 (]: 3 of 8 OK created sql table model marts.imports_by_year ........................ [[32mSUCCESS 1[0m in 0.65s]
[0m08:39:06.918572 [debug] [Thread-2 (]: Finished running node model.citrus_trade.imports_by_year
[0m08:39:06.918848 [debug] [Thread-3 (]: Began running node model.citrus_trade.score_2020
[0m08:39:06.919280 [info ] [Thread-3 (]: 5 of 8 START sql table model marts.score_2020 .................................. [RUN]
[0m08:39:06.919609 [debug] [Thread-1 (]: Began running node model.citrus_trade.growth_score
[0m08:39:06.919978 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.citrus_trade.trade_by_hs, now model.citrus_trade.score_2020)
[0m08:39:06.920733 [debug] [Thread-3 (]: Began compiling node model.citrus_trade.score_2020
[0m08:39:06.920311 [info ] [Thread-1 (]: 6 of 8 START sql table model marts.growth_score ................................ [RUN]
[0m08:39:06.924203 [debug] [Thread-3 (]: Writing injected SQL for node "model.citrus_trade.score_2020"
[0m08:39:06.924736 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.citrus_trade.imports_exports_2020, now model.citrus_trade.growth_score)
[0m08:39:06.925204 [debug] [Thread-1 (]: Began compiling node model.citrus_trade.growth_score
[0m08:39:06.927511 [debug] [Thread-1 (]: Writing injected SQL for node "model.citrus_trade.growth_score"
[0m08:39:06.928375 [debug] [Thread-3 (]: Began executing node model.citrus_trade.score_2020
[0m08:39:06.930753 [debug] [Thread-3 (]: Writing runtime sql for node "model.citrus_trade.score_2020"
[0m08:39:06.931321 [debug] [Thread-1 (]: Began executing node model.citrus_trade.growth_score
[0m08:39:06.933211 [debug] [Thread-1 (]: Writing runtime sql for node "model.citrus_trade.growth_score"
[0m08:39:06.934475 [debug] [Thread-3 (]: Using snowflake connection "model.citrus_trade.score_2020"
[0m08:39:06.934743 [debug] [Thread-3 (]: On model.citrus_trade.score_2020: create or replace transient table TRADE_FLOW.marts.score_2020
    
    
    
    as (select distinct 
    declarant_iso,
    total_value,
    total_quantity,
    value_per_quantity,
    (total_value - min(total_value) over())/((max(total_value) over())-(min(total_value) over())) as value_score,
    (total_quantity - min(total_quantity) over())/((max(total_quantity) over())-(min(total_quantity) over())) as quantity_score,
    (value_per_quantity - min(value_per_quantity) over())/((max(value_per_quantity) over())-(min(value_per_quantity) over())) as price_score
from TRADE_FLOW.marts.imports_exports_2020
where flow = 1
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.score_2020"} */;
[0m08:39:06.940480 [debug] [Thread-1 (]: Using snowflake connection "model.citrus_trade.growth_score"
[0m08:39:06.940928 [debug] [Thread-1 (]: On model.citrus_trade.growth_score: create or replace transient table TRADE_FLOW.marts.growth_score
    
    
    
    as (with 
    previous_year AS (
        select 
            declarant_iso,
            year,
            lag(total_value,1) over(partition by declarant_iso order by year) previous_year_value,
            total_value,
            first_value(total_value) over(partition by declarant_iso order by year) as first_year_value,
            last_value(total_value) over(partition by declarant_iso order by year) as last_year_value
        from TRADE_FLOW.marts.imports_by_year
    ),
    growth_speed AS (
        select 
            declarant_iso,
            year,
            first_year_value,
            last_year_value,
            last_year_value/nullif(first_year_value,0) as growth_overall,
            previous_year_value,
            total_value,
            (total_value - previous_year_value)/total_value * 100 as growth_speed 
        from previous_year
    ),
    previous_year_growth_speed AS (
        select 
            declarant_iso,
            year,
            first_year_value,
            last_year_value,
            growth_overall,
            previous_year_value,
            total_value as current_value,
            growth_speed,
            lag(growth_speed,1) over(partition by declarant_iso order by year) previous_year_growth_speed,
        from growth_speed
        order by 1,2
    ),
    base AS (
        select 
            declarant_iso,
            year,
            first_year_value,
            last_year_value,
            growth_overall,
            previous_year_value,
            current_value,
            previous_year_growth_speed,
            growth_speed,
            growth_speed - previous_year_growth_speed as growth_acceleration,
            avg(growth_acceleration) over(partition by declarant_iso) as avg_acceleration
        from previous_year_growth_speed
    ),
    ok as (
        select 
            declarant_iso,
            year,
            first_year_value,
            last_year_value,
            growth_overall,
            (growth_overall - min(growth_overall) OVER())/(max(growth_overall) OVER() - min(growth_overall) OVER()) as growth_overall_norm,
            previous_year_value,
            current_value,
            -- previous_year_growth_speed,
            growth_speed,
            growth_acceleration,
            avg_acceleration,
            (avg_acceleration - min(avg_acceleration) OVER())/(max(avg_acceleration) OVER() - min(avg_acceleration) OVER()) as avg_acceleration_norm
        from base 
    )
    select 
        distinct 
        declarant_iso,
        year,
        current_value,
        growth_speed,
        growth_acceleration,
        growth_overall,
        growth_overall_norm,
        avg_acceleration,
        avg_acceleration_norm,
        growth_overall_norm * avg_acceleration_norm as growth_score
    from ok
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.growth_score"} */;
[0m08:39:07.624181 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.689 seconds
[0m08:39:07.627474 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '27f39edd-4de5-4cd0-8bc6-a92b07fd137f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff733b4830>]}
[0m08:39:07.628187 [info ] [Thread-3 (]: 5 of 8 OK created sql table model marts.score_2020 ............................. [[32mSUCCESS 1[0m in 0.71s]
[0m08:39:07.628887 [debug] [Thread-3 (]: Finished running node model.citrus_trade.score_2020
[0m08:39:07.640331 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.699 seconds
[0m08:39:07.641839 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '27f39edd-4de5-4cd0-8bc6-a92b07fd137f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff733a4ad0>]}
[0m08:39:07.642284 [info ] [Thread-1 (]: 6 of 8 OK created sql table model marts.growth_score ........................... [[32mSUCCESS 1[0m in 0.72s]
[0m08:39:07.642692 [debug] [Thread-1 (]: Finished running node model.citrus_trade.growth_score
[0m08:39:07.643520 [debug] [Thread-4 (]: Began running node model.citrus_trade.importer_score
[0m08:39:07.643896 [info ] [Thread-4 (]: 7 of 8 START sql table model marts.importer_score .............................. [RUN]
[0m08:39:07.644391 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.citrus_trade.importer_score'
[0m08:39:07.644675 [debug] [Thread-4 (]: Began compiling node model.citrus_trade.importer_score
[0m08:39:07.647679 [debug] [Thread-4 (]: Writing injected SQL for node "model.citrus_trade.importer_score"
[0m08:39:07.648835 [debug] [Thread-4 (]: Began executing node model.citrus_trade.importer_score
[0m08:39:07.650789 [debug] [Thread-4 (]: Writing runtime sql for node "model.citrus_trade.importer_score"
[0m08:39:07.651855 [debug] [Thread-4 (]: Using snowflake connection "model.citrus_trade.importer_score"
[0m08:39:07.652104 [debug] [Thread-4 (]: On model.citrus_trade.importer_score: create or replace transient table TRADE_FLOW.marts.importer_score
    
    
    
    as (select distinct
    sc.declarant_iso,
    sc.total_value as revenue_total,
    sc.total_quantity as volume_total,
    sc.value_per_quantity as rate_avg,
    sc.value_score as revenue_score,
    sc.quantity_score as volume_score,
    sc.price_score as rate_score,
    gs.growth_score
from TRADE_FLOW.marts.score_2020 as sc
inner join TRADE_FLOW.marts.growth_score as gs
    on gs.declarant_iso = sc.declarant_iso
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.importer_score"} */;
[0m08:39:07.652377 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m08:39:08.754700 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.102 seconds
[0m08:39:08.761819 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '27f39edd-4de5-4cd0-8bc6-a92b07fd137f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7375ebd0>]}
[0m08:39:08.763296 [info ] [Thread-4 (]: 7 of 8 OK created sql table model marts.importer_score ......................... [[32mSUCCESS 1[0m in 1.12s]
[0m08:39:08.764581 [debug] [Thread-4 (]: Finished running node model.citrus_trade.importer_score
[0m08:39:08.766671 [debug] [Thread-3 (]: Began running node model.citrus_trade.viz_importer_score
[0m08:39:08.767658 [info ] [Thread-3 (]: 8 of 8 START sql table model analytics.viz_importer_score ...................... [RUN]
[0m08:39:08.768839 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.citrus_trade.score_2020, now model.citrus_trade.viz_importer_score)
[0m08:39:08.769521 [debug] [Thread-3 (]: Began compiling node model.citrus_trade.viz_importer_score
[0m08:39:08.775799 [debug] [Thread-3 (]: Writing injected SQL for node "model.citrus_trade.viz_importer_score"
[0m08:39:08.777809 [debug] [Thread-3 (]: Began executing node model.citrus_trade.viz_importer_score
[0m08:39:08.781534 [debug] [Thread-3 (]: Writing runtime sql for node "model.citrus_trade.viz_importer_score"
[0m08:39:08.783982 [debug] [Thread-3 (]: Using snowflake connection "model.citrus_trade.viz_importer_score"
[0m08:39:08.784465 [debug] [Thread-3 (]: On model.citrus_trade.viz_importer_score: create or replace transient table TRADE_FLOW.analytics.viz_importer_score
    
    
    
    as (with 
    scores as (
        select 
            declarant_iso,
            score_type,
            score
        from TRADE_FLOW.marts.importer_score
        unpivot (
            score for score_type in (
                revenue_score as "revenue",
                volume_score as "volume",
                rate_score as "rate",
                growth_score as "growth"
            )
        )
    ),
    valueewrw as (
        select 
            declarant_iso,
            value_type,
            value
        from TRADE_FLOW.marts.importer_score
        unpivot (
            value for value_type in (
                revenue_total as "revenue",
                volume_score as "volume",
                rate_score as "rate"
            )
        )
    )
select 
    s.declarant_iso,
    s.score_type,
    s.score,
    v.value
from scores as s
left join valueewrw as v
    on s.declarant_iso = v.declarant_iso
    and s.score_type = v.value_type
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.viz_importer_score"} */;
[0m08:39:09.470042 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.685 seconds
[0m08:39:09.475879 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '27f39edd-4de5-4cd0-8bc6-a92b07fd137f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff733f6f90>]}
[0m08:39:09.477492 [info ] [Thread-3 (]: 8 of 8 OK created sql table model analytics.viz_importer_score ................. [[32mSUCCESS 1[0m in 0.71s]
[0m08:39:09.479009 [debug] [Thread-3 (]: Finished running node model.citrus_trade.viz_importer_score
[0m08:39:09.483333 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:39:09.484048 [debug] [MainThread]: Connection 'model.citrus_trade.growth_score' was left open.
[0m08:39:09.484651 [debug] [MainThread]: On model.citrus_trade.growth_score: Close
[0m08:39:09.588983 [debug] [MainThread]: Connection 'model.citrus_trade.imports_by_year' was left open.
[0m08:39:09.590552 [debug] [MainThread]: On model.citrus_trade.imports_by_year: Close
[0m08:39:09.687888 [debug] [MainThread]: Connection 'model.citrus_trade.viz_importer_score' was left open.
[0m08:39:09.688493 [debug] [MainThread]: On model.citrus_trade.viz_importer_score: Close
[0m08:39:09.806530 [debug] [MainThread]: Connection 'model.citrus_trade.importer_score' was left open.
[0m08:39:09.807123 [debug] [MainThread]: On model.citrus_trade.importer_score: Close
[0m08:39:09.899149 [info ] [MainThread]: 
[0m08:39:09.900466 [info ] [MainThread]: Finished running 8 table models in 0 hours 0 minutes and 6.03 seconds (6.03s).
[0m08:39:09.903578 [debug] [MainThread]: Command end result
[0m08:39:09.967064 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m08:39:09.969959 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m08:39:09.976272 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/target/run_results.json
[0m08:39:09.976496 [info ] [MainThread]: 
[0m08:39:09.976773 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:39:09.977288 [info ] [MainThread]: 
[0m08:39:09.977694 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=8
[0m08:39:09.979456 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.902949, "process_in_blocks": "0", "process_kernel_time": 0.387188, "process_mem_max_rss": "153772", "process_out_blocks": "4299", "process_user_time": 1.976168}
[0m08:39:09.980172 [debug] [MainThread]: Command `dbt run` succeeded at 08:39:09.980016 after 6.90 seconds
[0m08:39:09.980683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b0b6ba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff78ea0710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff78ea00e0>]}
[0m08:39:09.981141 [debug] [MainThread]: Flushing usage events
[0m08:39:10.596917 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:42:02.606421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff971c28d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff984c88f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96cc5940>]}


============================== 08:42:02.609354 | c18b0c8e-d95a-47ca-8a70-4ffaab2ad947 ==============================
[0m08:42:02.609354 [info ] [MainThread]: Running with dbt=1.10.13
[0m08:42:02.609830 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'warn_error': 'None', 'no_print': 'None', 'static_parser': 'True', 'indirect_selection': 'eager', 'use_colors': 'True', 'quiet': 'False', 'partial_parse': 'True', 'log_path': '/opt/airflow/dbt/logs', 'target_path': 'None', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'cache_selected_only': 'False', 'write_json': 'True', 'log_format': 'default', 'printer_width': '80', 'empty': 'False', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '/opt/airflow/dbt', 'use_experimental_parser': 'False', 'version_check': 'True', 'introspect': 'True', 'fail_fast': 'False', 'invocation_command': 'dbt run'}
[0m08:42:02.782325 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m08:42:02.782742 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m08:42:02.782973 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m08:42:02.878806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c18b0c8e-d95a-47ca-8a70-4ffaab2ad947', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95da0980>]}
[0m08:42:02.909812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c18b0c8e-d95a-47ca-8a70-4ffaab2ad947', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff951f3a70>]}
[0m08:42:02.910365 [info ] [MainThread]: Registered adapter: snowflake=1.10.3
[0m08:42:02.961275 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m08:42:03.090528 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m08:42:03.090928 [debug] [MainThread]: Partial parsing: updated file: citrus_trade://models/analytics/viz_importer_score.sql
[0m08:42:03.244133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c18b0c8e-d95a-47ca-8a70-4ffaab2ad947', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff941cf1d0>]}
[0m08:42:03.323186 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m08:42:03.325788 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m08:42:03.342636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c18b0c8e-d95a-47ca-8a70-4ffaab2ad947', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94174740>]}
[0m08:42:03.342970 [info ] [MainThread]: Found 8 models, 3 sources, 636 macros
[0m08:42:03.343257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c18b0c8e-d95a-47ca-8a70-4ffaab2ad947', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9456bc50>]}
[0m08:42:03.349223 [info ] [MainThread]: 
[0m08:42:03.349938 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:42:03.350479 [info ] [MainThread]: 
[0m08:42:03.351109 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m08:42:03.356403 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRADE_FLOW'
[0m08:42:03.364991 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRADE_FLOW'
[0m08:42:03.372310 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRADE_FLOW'
[0m08:42:03.410657 [debug] [ThreadPool]: Using snowflake connection "list_TRADE_FLOW"
[0m08:42:03.411523 [debug] [ThreadPool]: Using snowflake connection "list_TRADE_FLOW"
[0m08:42:03.412209 [debug] [ThreadPool]: Using snowflake connection "list_TRADE_FLOW"
[0m08:42:03.412460 [debug] [ThreadPool]: On list_TRADE_FLOW: show terse schemas in database TRADE_FLOW
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRADE_FLOW"} */
[0m08:42:03.412830 [debug] [ThreadPool]: On list_TRADE_FLOW: show terse schemas in database TRADE_FLOW
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRADE_FLOW"} */
[0m08:42:03.413282 [debug] [ThreadPool]: On list_TRADE_FLOW: show terse schemas in database TRADE_FLOW
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRADE_FLOW"} */
[0m08:42:03.413950 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:42:03.414744 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:42:03.415142 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:42:04.170980 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.757 seconds
[0m08:42:04.171553 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.756 seconds
[0m08:42:04.178339 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.764 seconds
[0m08:42:04.180538 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRADE_FLOW, now list_TRADE_FLOW_marts)
[0m08:42:04.181063 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRADE_FLOW, now list_TRADE_FLOW_staging)
[0m08:42:04.187780 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRADE_FLOW, now list_TRADE_FLOW_analytics)
[0m08:42:04.198819 [debug] [ThreadPool]: Using snowflake connection "list_TRADE_FLOW_marts"
[0m08:42:04.202166 [debug] [ThreadPool]: Using snowflake connection "list_TRADE_FLOW_staging"
[0m08:42:04.204811 [debug] [ThreadPool]: Using snowflake connection "list_TRADE_FLOW_analytics"
[0m08:42:04.205263 [debug] [ThreadPool]: On list_TRADE_FLOW_marts: show objects in TRADE_FLOW.marts
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRADE_FLOW_marts"} */;
[0m08:42:04.205719 [debug] [ThreadPool]: On list_TRADE_FLOW_staging: show objects in TRADE_FLOW.staging
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRADE_FLOW_staging"} */;
[0m08:42:04.206191 [debug] [ThreadPool]: On list_TRADE_FLOW_analytics: show objects in TRADE_FLOW.analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRADE_FLOW_analytics"} */;
[0m08:42:04.284075 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 0.077 seconds
[0m08:42:04.294481 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.086 seconds
[0m08:42:04.307308 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.098 seconds
[0m08:42:04.311443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c18b0c8e-d95a-47ca-8a70-4ffaab2ad947', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff947adc10>]}
[0m08:42:04.317476 [debug] [Thread-1 (]: Began running node model.citrus_trade.stg_trade
[0m08:42:04.318111 [info ] [Thread-1 (]: 1 of 8 START sql table model staging.stg_trade ................................. [RUN]
[0m08:42:04.318596 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_TRADE_FLOW_analytics, now model.citrus_trade.stg_trade)
[0m08:42:04.318997 [debug] [Thread-1 (]: Began compiling node model.citrus_trade.stg_trade
[0m08:42:04.325130 [debug] [Thread-1 (]: Writing injected SQL for node "model.citrus_trade.stg_trade"
[0m08:42:04.326411 [debug] [Thread-1 (]: Began executing node model.citrus_trade.stg_trade
[0m08:42:04.350239 [debug] [Thread-1 (]: Writing runtime sql for node "model.citrus_trade.stg_trade"
[0m08:42:04.352338 [debug] [Thread-1 (]: Using snowflake connection "model.citrus_trade.stg_trade"
[0m08:42:04.352711 [debug] [Thread-1 (]: On model.citrus_trade.stg_trade: create or replace transient table TRADE_FLOW.staging.stg_trade
    
    
    
    as (select
  value:DECLARANT::int as declarant,
  value:DECLARANT_ISO::string as declarant_iso,
  value:PARTNER::string as partner,
  value:PARTNER_ISO::string as partner_iso,
  value:FLOW::int as flow,
  value:TRANSPORT_MODE::int as transport_mode,
  value:PERIOD::int as period,
  year(to_date(left(period,4),'YYYY')) as year,
  value:HS4::string as hs4,
  value:HS4_NAME::string as hs4_name,
  value:HS6::string as hs6,
  value:HS6_NAME::string as hs6_name,
  value:VALUE_IN_EUROS::float as value_in_euros,
  value:QUANTITY_IN_KG::float as quantity_in_kg
from trade_flow.raw.raw_trhs
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.stg_trade"} */;
[0m08:42:05.086139 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.732 seconds
[0m08:42:05.117949 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c18b0c8e-d95a-47ca-8a70-4ffaab2ad947', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff988b96d0>]}
[0m08:42:05.119149 [info ] [Thread-1 (]: 1 of 8 OK created sql table model staging.stg_trade ............................ [[32mSUCCESS 1[0m in 0.80s]
[0m08:42:05.120059 [debug] [Thread-1 (]: Finished running node model.citrus_trade.stg_trade
[0m08:42:05.121274 [debug] [Thread-3 (]: Began running node model.citrus_trade.trade_by_hs
[0m08:42:05.121906 [info ] [Thread-3 (]: 2 of 8 START sql table model marts.trade_by_hs ................................. [RUN]
[0m08:42:05.122460 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_TRADE_FLOW_marts, now model.citrus_trade.trade_by_hs)
[0m08:42:05.122871 [debug] [Thread-3 (]: Began compiling node model.citrus_trade.trade_by_hs
[0m08:42:05.125993 [debug] [Thread-3 (]: Writing injected SQL for node "model.citrus_trade.trade_by_hs"
[0m08:42:05.127635 [debug] [Thread-3 (]: Began executing node model.citrus_trade.trade_by_hs
[0m08:42:05.132809 [debug] [Thread-3 (]: Writing runtime sql for node "model.citrus_trade.trade_by_hs"
[0m08:42:05.134496 [debug] [Thread-3 (]: Using snowflake connection "model.citrus_trade.trade_by_hs"
[0m08:42:05.134840 [debug] [Thread-3 (]: On model.citrus_trade.trade_by_hs: create or replace transient table TRADE_FLOW.marts.trade_by_hs
    
    
    
    as (select
    *
from TRADE_FLOW.staging.stg_trade
where hs6 = '080510'
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.trade_by_hs"} */;
[0m08:42:05.817381 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.682 seconds
[0m08:42:05.820132 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c18b0c8e-d95a-47ca-8a70-4ffaab2ad947', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92d7e270>]}
[0m08:42:05.820740 [info ] [Thread-3 (]: 2 of 8 OK created sql table model marts.trade_by_hs ............................ [[32mSUCCESS 1[0m in 0.70s]
[0m08:42:05.821364 [debug] [Thread-3 (]: Finished running node model.citrus_trade.trade_by_hs
[0m08:42:05.822123 [debug] [Thread-2 (]: Began running node model.citrus_trade.imports_by_year
[0m08:42:05.822565 [info ] [Thread-2 (]: 3 of 8 START sql table model marts.imports_by_year ............................. [RUN]
[0m08:42:05.822841 [debug] [Thread-1 (]: Began running node model.citrus_trade.imports_exports_2020
[0m08:42:05.823220 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_TRADE_FLOW_staging, now model.citrus_trade.imports_by_year)
[0m08:42:05.824005 [debug] [Thread-2 (]: Began compiling node model.citrus_trade.imports_by_year
[0m08:42:05.826652 [debug] [Thread-2 (]: Writing injected SQL for node "model.citrus_trade.imports_by_year"
[0m08:42:05.823609 [info ] [Thread-1 (]: 4 of 8 START sql table model marts.imports_exports_2020 ........................ [RUN]
[0m08:42:05.827196 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.citrus_trade.stg_trade, now model.citrus_trade.imports_exports_2020)
[0m08:42:05.827694 [debug] [Thread-1 (]: Began compiling node model.citrus_trade.imports_exports_2020
[0m08:42:05.829772 [debug] [Thread-1 (]: Writing injected SQL for node "model.citrus_trade.imports_exports_2020"
[0m08:42:05.830219 [debug] [Thread-2 (]: Began executing node model.citrus_trade.imports_by_year
[0m08:42:05.832261 [debug] [Thread-2 (]: Writing runtime sql for node "model.citrus_trade.imports_by_year"
[0m08:42:05.832727 [debug] [Thread-1 (]: Began executing node model.citrus_trade.imports_exports_2020
[0m08:42:05.834473 [debug] [Thread-1 (]: Writing runtime sql for node "model.citrus_trade.imports_exports_2020"
[0m08:42:05.835179 [debug] [Thread-2 (]: Using snowflake connection "model.citrus_trade.imports_by_year"
[0m08:42:05.835513 [debug] [Thread-2 (]: On model.citrus_trade.imports_by_year: create or replace transient table TRADE_FLOW.marts.imports_by_year
    
    
    
    as (select
    declarant_iso,
    year,
    sum(value_in_euros) as total_value,
    sum(quantity_in_kg) as total_quantity,
    total_value/nullif(total_quantity,0) as value_per_quantity
from TRADE_FLOW.marts.trade_by_hs
where flow = 1
group by 1,2
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.imports_by_year"} */;
[0m08:42:05.837718 [debug] [Thread-1 (]: Using snowflake connection "model.citrus_trade.imports_exports_2020"
[0m08:42:05.838008 [debug] [Thread-1 (]: On model.citrus_trade.imports_exports_2020: create or replace transient table TRADE_FLOW.marts.imports_exports_2020
    
    
    
    as (select
    declarant_iso,
    flow,
    sum(value_in_euros) over(partition by declarant_iso, flow) as total_value,
    sum(quantity_in_kg) over(partition by declarant_iso, flow) as total_quantity,
    total_value/nullif(total_quantity,0) as value_per_quantity
from TRADE_FLOW.marts.trade_by_hs
where year = 2020
group by 
    declarant_iso,
    flow,
    value_in_euros,
    quantity_in_kg
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.imports_exports_2020"} */;
[0m08:42:06.438970 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.603 seconds
[0m08:42:06.441311 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.603 seconds
[0m08:42:06.449215 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c18b0c8e-d95a-47ca-8a70-4ffaab2ad947', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92df67e0>]}
[0m08:42:06.446336 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c18b0c8e-d95a-47ca-8a70-4ffaab2ad947', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92970e90>]}
[0m08:42:06.450365 [info ] [Thread-1 (]: 4 of 8 OK created sql table model marts.imports_exports_2020 ................... [[32mSUCCESS 1[0m in 0.62s]
[0m08:42:06.452801 [debug] [Thread-1 (]: Finished running node model.citrus_trade.imports_exports_2020
[0m08:42:06.451554 [info ] [Thread-2 (]: 3 of 8 OK created sql table model marts.imports_by_year ........................ [[32mSUCCESS 1[0m in 0.62s]
[0m08:42:06.454012 [debug] [Thread-2 (]: Finished running node model.citrus_trade.imports_by_year
[0m08:42:06.454804 [debug] [Thread-2 (]: Began running node model.citrus_trade.score_2020
[0m08:42:06.455671 [info ] [Thread-2 (]: 5 of 8 START sql table model marts.score_2020 .................................. [RUN]
[0m08:42:06.456292 [debug] [Thread-4 (]: Began running node model.citrus_trade.growth_score
[0m08:42:06.457063 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.citrus_trade.imports_by_year, now model.citrus_trade.score_2020)
[0m08:42:06.457816 [info ] [Thread-4 (]: 6 of 8 START sql table model marts.growth_score ................................ [RUN]
[0m08:42:06.458507 [debug] [Thread-2 (]: Began compiling node model.citrus_trade.score_2020
[0m08:42:06.459365 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.citrus_trade.growth_score'
[0m08:42:06.464664 [debug] [Thread-2 (]: Writing injected SQL for node "model.citrus_trade.score_2020"
[0m08:42:06.465476 [debug] [Thread-4 (]: Began compiling node model.citrus_trade.growth_score
[0m08:42:06.468236 [debug] [Thread-4 (]: Writing injected SQL for node "model.citrus_trade.growth_score"
[0m08:42:06.468892 [debug] [Thread-2 (]: Began executing node model.citrus_trade.score_2020
[0m08:42:06.470741 [debug] [Thread-2 (]: Writing runtime sql for node "model.citrus_trade.score_2020"
[0m08:42:06.471236 [debug] [Thread-4 (]: Began executing node model.citrus_trade.growth_score
[0m08:42:06.473013 [debug] [Thread-4 (]: Writing runtime sql for node "model.citrus_trade.growth_score"
[0m08:42:06.474124 [debug] [Thread-2 (]: Using snowflake connection "model.citrus_trade.score_2020"
[0m08:42:06.475526 [debug] [Thread-2 (]: On model.citrus_trade.score_2020: create or replace transient table TRADE_FLOW.marts.score_2020
    
    
    
    as (select distinct 
    declarant_iso,
    total_value,
    total_quantity,
    value_per_quantity,
    (total_value - min(total_value) over())/((max(total_value) over())-(min(total_value) over())) as value_score,
    (total_quantity - min(total_quantity) over())/((max(total_quantity) over())-(min(total_quantity) over())) as quantity_score,
    (value_per_quantity - min(value_per_quantity) over())/((max(value_per_quantity) over())-(min(value_per_quantity) over())) as price_score
from TRADE_FLOW.marts.imports_exports_2020
where flow = 1
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.score_2020"} */;
[0m08:42:06.481235 [debug] [Thread-4 (]: Using snowflake connection "model.citrus_trade.growth_score"
[0m08:42:06.481680 [debug] [Thread-4 (]: On model.citrus_trade.growth_score: create or replace transient table TRADE_FLOW.marts.growth_score
    
    
    
    as (with 
    previous_year AS (
        select 
            declarant_iso,
            year,
            lag(total_value,1) over(partition by declarant_iso order by year) previous_year_value,
            total_value,
            first_value(total_value) over(partition by declarant_iso order by year) as first_year_value,
            last_value(total_value) over(partition by declarant_iso order by year) as last_year_value
        from TRADE_FLOW.marts.imports_by_year
    ),
    growth_speed AS (
        select 
            declarant_iso,
            year,
            first_year_value,
            last_year_value,
            last_year_value/nullif(first_year_value,0) as growth_overall,
            previous_year_value,
            total_value,
            (total_value - previous_year_value)/total_value * 100 as growth_speed 
        from previous_year
    ),
    previous_year_growth_speed AS (
        select 
            declarant_iso,
            year,
            first_year_value,
            last_year_value,
            growth_overall,
            previous_year_value,
            total_value as current_value,
            growth_speed,
            lag(growth_speed,1) over(partition by declarant_iso order by year) previous_year_growth_speed,
        from growth_speed
        order by 1,2
    ),
    base AS (
        select 
            declarant_iso,
            year,
            first_year_value,
            last_year_value,
            growth_overall,
            previous_year_value,
            current_value,
            previous_year_growth_speed,
            growth_speed,
            growth_speed - previous_year_growth_speed as growth_acceleration,
            avg(growth_acceleration) over(partition by declarant_iso) as avg_acceleration
        from previous_year_growth_speed
    ),
    ok as (
        select 
            declarant_iso,
            year,
            first_year_value,
            last_year_value,
            growth_overall,
            (growth_overall - min(growth_overall) OVER())/(max(growth_overall) OVER() - min(growth_overall) OVER()) as growth_overall_norm,
            previous_year_value,
            current_value,
            -- previous_year_growth_speed,
            growth_speed,
            growth_acceleration,
            avg_acceleration,
            (avg_acceleration - min(avg_acceleration) OVER())/(max(avg_acceleration) OVER() - min(avg_acceleration) OVER()) as avg_acceleration_norm
        from base 
    )
    select 
        distinct 
        declarant_iso,
        year,
        current_value,
        growth_speed,
        growth_acceleration,
        growth_overall,
        growth_overall_norm,
        avg_acceleration,
        avg_acceleration_norm,
        growth_overall_norm * avg_acceleration_norm as growth_score
    from ok
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.growth_score"} */;
[0m08:42:06.482131 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m08:42:07.135715 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.659 seconds
[0m08:42:07.142278 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c18b0c8e-d95a-47ca-8a70-4ffaab2ad947', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff925bd4f0>]}
[0m08:42:07.143979 [info ] [Thread-2 (]: 5 of 8 OK created sql table model marts.score_2020 ............................. [[32mSUCCESS 1[0m in 0.68s]
[0m08:42:07.145552 [debug] [Thread-2 (]: Finished running node model.citrus_trade.score_2020
[0m08:42:07.542017 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.060 seconds
[0m08:42:07.547314 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c18b0c8e-d95a-47ca-8a70-4ffaab2ad947', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9259b2c0>]}
[0m08:42:07.549995 [info ] [Thread-4 (]: 6 of 8 OK created sql table model marts.growth_score ........................... [[32mSUCCESS 1[0m in 1.09s]
[0m08:42:07.551279 [debug] [Thread-4 (]: Finished running node model.citrus_trade.growth_score
[0m08:42:07.553305 [debug] [Thread-3 (]: Began running node model.citrus_trade.importer_score
[0m08:42:07.555592 [info ] [Thread-3 (]: 7 of 8 START sql table model marts.importer_score .............................. [RUN]
[0m08:42:07.556763 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.citrus_trade.trade_by_hs, now model.citrus_trade.importer_score)
[0m08:42:07.557651 [debug] [Thread-3 (]: Began compiling node model.citrus_trade.importer_score
[0m08:42:07.563790 [debug] [Thread-3 (]: Writing injected SQL for node "model.citrus_trade.importer_score"
[0m08:42:07.566187 [debug] [Thread-3 (]: Began executing node model.citrus_trade.importer_score
[0m08:42:07.569467 [debug] [Thread-3 (]: Writing runtime sql for node "model.citrus_trade.importer_score"
[0m08:42:07.572375 [debug] [Thread-3 (]: Using snowflake connection "model.citrus_trade.importer_score"
[0m08:42:07.572811 [debug] [Thread-3 (]: On model.citrus_trade.importer_score: create or replace transient table TRADE_FLOW.marts.importer_score
    
    
    
    as (select distinct
    sc.declarant_iso,
    sc.total_value as revenue_total,
    sc.total_quantity as volume_total,
    sc.value_per_quantity as rate_avg,
    sc.value_score as revenue_score,
    sc.quantity_score as volume_score,
    sc.price_score as rate_score,
    gs.growth_score
from TRADE_FLOW.marts.score_2020 as sc
inner join TRADE_FLOW.marts.growth_score as gs
    on gs.declarant_iso = sc.declarant_iso
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.importer_score"} */;
[0m08:42:08.469829 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.895 seconds
[0m08:42:08.476951 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c18b0c8e-d95a-47ca-8a70-4ffaab2ad947', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9252ed80>]}
[0m08:42:08.478322 [info ] [Thread-3 (]: 7 of 8 OK created sql table model marts.importer_score ......................... [[32mSUCCESS 1[0m in 0.92s]
[0m08:42:08.479759 [debug] [Thread-3 (]: Finished running node model.citrus_trade.importer_score
[0m08:42:08.481668 [debug] [Thread-2 (]: Began running node model.citrus_trade.viz_importer_score
[0m08:42:08.482511 [info ] [Thread-2 (]: 8 of 8 START sql table model analytics.viz_importer_score ...................... [RUN]
[0m08:42:08.483218 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.citrus_trade.score_2020, now model.citrus_trade.viz_importer_score)
[0m08:42:08.483791 [debug] [Thread-2 (]: Began compiling node model.citrus_trade.viz_importer_score
[0m08:42:08.491101 [debug] [Thread-2 (]: Writing injected SQL for node "model.citrus_trade.viz_importer_score"
[0m08:42:08.494047 [debug] [Thread-2 (]: Began executing node model.citrus_trade.viz_importer_score
[0m08:42:08.497954 [debug] [Thread-2 (]: Writing runtime sql for node "model.citrus_trade.viz_importer_score"
[0m08:42:08.500708 [debug] [Thread-2 (]: Using snowflake connection "model.citrus_trade.viz_importer_score"
[0m08:42:08.501229 [debug] [Thread-2 (]: On model.citrus_trade.viz_importer_score: create or replace transient table TRADE_FLOW.analytics.viz_importer_score
    
    
    
    as (with 
    scores as (
        select 
            declarant_iso,
            score_type,
            score
        from TRADE_FLOW.marts.importer_score
        unpivot (
            score for score_type in (
                revenue_score as "revenue",
                volume_score as "volume",
                rate_score as "rate",
                growth_score as "growth"
            )
        )
    ),
    metrics as (
        select 
            declarant_iso,
            value_type,
            metric
        from TRADE_FLOW.marts.importer_score
        unpivot (
            metric for metric_type in (
                revenue_total as "revenue",
                volume_score as "volume",
                rate_score as "rate"
            )
        )
    )
select 
    s.declarant_iso,
    s.score_type,
    s.score,
    m.metric
from scores as s
left join metrics as m
    on s.declarant_iso = v.declarant_iso
    and s.score_type = m.metric_type
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.viz_importer_score"} */;
[0m08:42:08.614556 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01c0400a-0305-74a0-0004-20ca00025872
[0m08:42:08.615829 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 24 at position 12
invalid identifier 'VALUE_TYPE'
[0m08:42:08.622866 [debug] [Thread-2 (]: Database Error in model viz_importer_score (models/analytics/viz_importer_score.sql)
  000904 (42000): SQL compilation error: error line 24 at position 12
  invalid identifier 'VALUE_TYPE'
  compiled code at target/run/citrus_trade/models/analytics/viz_importer_score.sql
[0m08:42:08.623688 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c18b0c8e-d95a-47ca-8a70-4ffaab2ad947', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92540170>]}
[0m08:42:08.624460 [error] [Thread-2 (]: 8 of 8 ERROR creating sql table model analytics.viz_importer_score ............. [[31mERROR[0m in 0.14s]
[0m08:42:08.625187 [debug] [Thread-2 (]: Finished running node model.citrus_trade.viz_importer_score
[0m08:42:08.625858 [debug] [Thread-7 (]: Marking all children of 'model.citrus_trade.viz_importer_score' to be skipped because of status 'error'.  Reason: Database Error in model viz_importer_score (models/analytics/viz_importer_score.sql)
  000904 (42000): SQL compilation error: error line 24 at position 12
  invalid identifier 'VALUE_TYPE'
  compiled code at target/run/citrus_trade/models/analytics/viz_importer_score.sql.
[0m08:42:08.629355 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:42:08.629779 [debug] [MainThread]: Connection 'model.citrus_trade.imports_exports_2020' was left open.
[0m08:42:08.630127 [debug] [MainThread]: On model.citrus_trade.imports_exports_2020: Close
[0m08:42:08.740861 [debug] [MainThread]: Connection 'model.citrus_trade.importer_score' was left open.
[0m08:42:08.741531 [debug] [MainThread]: On model.citrus_trade.importer_score: Close
[0m08:42:08.845556 [debug] [MainThread]: Connection 'model.citrus_trade.viz_importer_score' was left open.
[0m08:42:08.846057 [debug] [MainThread]: On model.citrus_trade.viz_importer_score: Close
[0m08:42:08.932336 [debug] [MainThread]: Connection 'model.citrus_trade.growth_score' was left open.
[0m08:42:08.933218 [debug] [MainThread]: On model.citrus_trade.growth_score: Close
[0m08:42:09.040659 [info ] [MainThread]: 
[0m08:42:09.042476 [info ] [MainThread]: Finished running 8 table models in 0 hours 0 minutes and 5.69 seconds (5.69s).
[0m08:42:09.045932 [debug] [MainThread]: Command end result
[0m08:42:09.111083 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m08:42:09.114298 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m08:42:09.124228 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/target/run_results.json
[0m08:42:09.124580 [info ] [MainThread]: 
[0m08:42:09.124991 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m08:42:09.125299 [info ] [MainThread]: 
[0m08:42:09.125684 [error] [MainThread]: [31mFailure in model viz_importer_score (models/analytics/viz_importer_score.sql)[0m
[0m08:42:09.125919 [error] [MainThread]:   Database Error in model viz_importer_score (models/analytics/viz_importer_score.sql)
  000904 (42000): SQL compilation error: error line 24 at position 12
  invalid identifier 'VALUE_TYPE'
  compiled code at target/run/citrus_trade/models/analytics/viz_importer_score.sql
[0m08:42:09.126245 [info ] [MainThread]: 
[0m08:42:09.126538 [info ] [MainThread]:   compiled code at target/compiled/citrus_trade/models/analytics/viz_importer_score.sql
[0m08:42:09.126827 [info ] [MainThread]: 
[0m08:42:09.127391 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=8
[0m08:42:09.133225 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 6.556258, "process_in_blocks": "0", "process_kernel_time": 0.574657, "process_mem_max_rss": "153912", "process_out_blocks": "4302", "process_user_time": 1.998766}
[0m08:42:09.133899 [debug] [MainThread]: Command `dbt run` failed at 08:42:09.133812 after 6.56 seconds
[0m08:42:09.134376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96008950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96cc5940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96f28320>]}
[0m08:42:09.135627 [debug] [MainThread]: Flushing usage events
[0m08:42:09.726269 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:42:23.639773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c075d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e52f530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c076f30>]}


============================== 08:42:23.644662 | 99b37f00-6338-40a5-b531-7017af67b773 ==============================
[0m08:42:23.644662 [info ] [MainThread]: Running with dbt=1.10.13
[0m08:42:23.645350 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'printer_width': '80', 'indirect_selection': 'eager', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'introspect': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'use_colors': 'True', 'quiet': 'False', 'target_path': 'None', 'empty': 'False', 'use_experimental_parser': 'False', 'invocation_command': 'dbt run', 'static_parser': 'True', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_cache_events': 'False', 'version_check': 'True', 'write_json': 'True', 'no_print': 'None'}
[0m08:42:23.826668 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m08:42:23.831245 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m08:42:23.831622 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m08:42:24.047410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '99b37f00-6338-40a5-b531-7017af67b773', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a687170>]}
[0m08:42:24.132291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '99b37f00-6338-40a5-b531-7017af67b773', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a262bd0>]}
[0m08:42:24.134157 [info ] [MainThread]: Registered adapter: snowflake=1.10.3
[0m08:42:24.210706 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m08:42:24.348279 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m08:42:24.348731 [debug] [MainThread]: Partial parsing: updated file: citrus_trade://models/analytics/viz_importer_score.sql
[0m08:42:24.507501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '99b37f00-6338-40a5-b531-7017af67b773', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a19ea50>]}
[0m08:42:24.591405 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m08:42:24.595463 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m08:42:24.619517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '99b37f00-6338-40a5-b531-7017af67b773', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99cc8680>]}
[0m08:42:24.620718 [info ] [MainThread]: Found 8 models, 3 sources, 636 macros
[0m08:42:24.621647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '99b37f00-6338-40a5-b531-7017af67b773', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99f95a90>]}
[0m08:42:24.626832 [info ] [MainThread]: 
[0m08:42:24.628160 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:42:24.629585 [info ] [MainThread]: 
[0m08:42:24.631132 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m08:42:24.639386 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRADE_FLOW'
[0m08:42:24.649320 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRADE_FLOW'
[0m08:42:24.684845 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRADE_FLOW'
[0m08:42:24.723178 [debug] [ThreadPool]: Using snowflake connection "list_TRADE_FLOW"
[0m08:42:24.723756 [debug] [ThreadPool]: Using snowflake connection "list_TRADE_FLOW"
[0m08:42:24.724258 [debug] [ThreadPool]: On list_TRADE_FLOW: show terse schemas in database TRADE_FLOW
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRADE_FLOW"} */
[0m08:42:24.724959 [debug] [ThreadPool]: Using snowflake connection "list_TRADE_FLOW"
[0m08:42:24.725212 [debug] [ThreadPool]: On list_TRADE_FLOW: show terse schemas in database TRADE_FLOW
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRADE_FLOW"} */
[0m08:42:24.725564 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:42:24.725831 [debug] [ThreadPool]: On list_TRADE_FLOW: show terse schemas in database TRADE_FLOW
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRADE_FLOW"} */
[0m08:42:24.726083 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:42:24.727294 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:42:25.393658 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.666 seconds
[0m08:42:25.394246 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.668 seconds
[0m08:42:25.421967 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.696 seconds
[0m08:42:25.424747 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRADE_FLOW, now list_TRADE_FLOW_analytics)
[0m08:42:25.432487 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRADE_FLOW, now list_TRADE_FLOW_staging)
[0m08:42:25.437302 [debug] [ThreadPool]: Using snowflake connection "list_TRADE_FLOW_analytics"
[0m08:42:25.439310 [debug] [ThreadPool]: Using snowflake connection "list_TRADE_FLOW_staging"
[0m08:42:25.439715 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRADE_FLOW, now list_TRADE_FLOW_marts)
[0m08:42:25.440229 [debug] [ThreadPool]: On list_TRADE_FLOW_analytics: show objects in TRADE_FLOW.analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRADE_FLOW_analytics"} */;
[0m08:42:25.440488 [debug] [ThreadPool]: On list_TRADE_FLOW_staging: show objects in TRADE_FLOW.staging
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRADE_FLOW_staging"} */;
[0m08:42:25.442202 [debug] [ThreadPool]: Using snowflake connection "list_TRADE_FLOW_marts"
[0m08:42:25.444763 [debug] [ThreadPool]: On list_TRADE_FLOW_marts: show objects in TRADE_FLOW.marts
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRADE_FLOW_marts"} */;
[0m08:42:25.523227 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.081 seconds
[0m08:42:25.526712 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 0.082 seconds
[0m08:42:25.538830 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.095 seconds
[0m08:42:25.540719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '99b37f00-6338-40a5-b531-7017af67b773', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99dd59a0>]}
[0m08:42:25.553672 [debug] [Thread-1 (]: Began running node model.citrus_trade.stg_trade
[0m08:42:25.555518 [info ] [Thread-1 (]: 1 of 8 START sql table model staging.stg_trade ................................. [RUN]
[0m08:42:25.557786 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_TRADE_FLOW_staging, now model.citrus_trade.stg_trade)
[0m08:42:25.561255 [debug] [Thread-1 (]: Began compiling node model.citrus_trade.stg_trade
[0m08:42:25.574821 [debug] [Thread-1 (]: Writing injected SQL for node "model.citrus_trade.stg_trade"
[0m08:42:25.576348 [debug] [Thread-1 (]: Began executing node model.citrus_trade.stg_trade
[0m08:42:25.602273 [debug] [Thread-1 (]: Writing runtime sql for node "model.citrus_trade.stg_trade"
[0m08:42:25.604213 [debug] [Thread-1 (]: Using snowflake connection "model.citrus_trade.stg_trade"
[0m08:42:25.604628 [debug] [Thread-1 (]: On model.citrus_trade.stg_trade: create or replace transient table TRADE_FLOW.staging.stg_trade
    
    
    
    as (select
  value:DECLARANT::int as declarant,
  value:DECLARANT_ISO::string as declarant_iso,
  value:PARTNER::string as partner,
  value:PARTNER_ISO::string as partner_iso,
  value:FLOW::int as flow,
  value:TRANSPORT_MODE::int as transport_mode,
  value:PERIOD::int as period,
  year(to_date(left(period,4),'YYYY')) as year,
  value:HS4::string as hs4,
  value:HS4_NAME::string as hs4_name,
  value:HS6::string as hs6,
  value:HS6_NAME::string as hs6_name,
  value:VALUE_IN_EUROS::float as value_in_euros,
  value:QUANTITY_IN_KG::float as quantity_in_kg
from trade_flow.raw.raw_trhs
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.stg_trade"} */;
[0m08:42:26.214548 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.609 seconds
[0m08:42:26.240187 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '99b37f00-6338-40a5-b531-7017af67b773', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c7fa570>]}
[0m08:42:26.240937 [info ] [Thread-1 (]: 1 of 8 OK created sql table model staging.stg_trade ............................ [[32mSUCCESS 1[0m in 0.68s]
[0m08:42:26.241673 [debug] [Thread-1 (]: Finished running node model.citrus_trade.stg_trade
[0m08:42:26.242717 [debug] [Thread-3 (]: Began running node model.citrus_trade.trade_by_hs
[0m08:42:26.243621 [info ] [Thread-3 (]: 2 of 8 START sql table model marts.trade_by_hs ................................. [RUN]
[0m08:42:26.244227 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_TRADE_FLOW_analytics, now model.citrus_trade.trade_by_hs)
[0m08:42:26.244790 [debug] [Thread-3 (]: Began compiling node model.citrus_trade.trade_by_hs
[0m08:42:26.250884 [debug] [Thread-3 (]: Writing injected SQL for node "model.citrus_trade.trade_by_hs"
[0m08:42:26.252334 [debug] [Thread-3 (]: Began executing node model.citrus_trade.trade_by_hs
[0m08:42:26.255361 [debug] [Thread-3 (]: Writing runtime sql for node "model.citrus_trade.trade_by_hs"
[0m08:42:26.256932 [debug] [Thread-3 (]: Using snowflake connection "model.citrus_trade.trade_by_hs"
[0m08:42:26.257452 [debug] [Thread-3 (]: On model.citrus_trade.trade_by_hs: create or replace transient table TRADE_FLOW.marts.trade_by_hs
    
    
    
    as (select
    *
from TRADE_FLOW.staging.stg_trade
where hs6 = '080510'
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.trade_by_hs"} */;
[0m08:42:26.827850 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.570 seconds
[0m08:42:26.829730 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '99b37f00-6338-40a5-b531-7017af67b773', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff989e4ef0>]}
[0m08:42:26.830379 [info ] [Thread-3 (]: 2 of 8 OK created sql table model marts.trade_by_hs ............................ [[32mSUCCESS 1[0m in 0.59s]
[0m08:42:26.831054 [debug] [Thread-3 (]: Finished running node model.citrus_trade.trade_by_hs
[0m08:42:26.832069 [debug] [Thread-2 (]: Began running node model.citrus_trade.imports_by_year
[0m08:42:26.832675 [info ] [Thread-2 (]: 3 of 8 START sql table model marts.imports_by_year ............................. [RUN]
[0m08:42:26.833156 [debug] [Thread-1 (]: Began running node model.citrus_trade.imports_exports_2020
[0m08:42:26.833431 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_TRADE_FLOW_marts, now model.citrus_trade.imports_by_year)
[0m08:42:26.834222 [debug] [Thread-2 (]: Began compiling node model.citrus_trade.imports_by_year
[0m08:42:26.833855 [info ] [Thread-1 (]: 4 of 8 START sql table model marts.imports_exports_2020 ........................ [RUN]
[0m08:42:26.836636 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.citrus_trade.stg_trade, now model.citrus_trade.imports_exports_2020)
[0m08:42:26.836825 [debug] [Thread-1 (]: Began compiling node model.citrus_trade.imports_exports_2020
[0m08:42:26.838452 [debug] [Thread-1 (]: Writing injected SQL for node "model.citrus_trade.imports_exports_2020"
[0m08:42:26.836383 [debug] [Thread-2 (]: Writing injected SQL for node "model.citrus_trade.imports_by_year"
[0m08:42:26.839233 [debug] [Thread-1 (]: Began executing node model.citrus_trade.imports_exports_2020
[0m08:42:26.840886 [debug] [Thread-1 (]: Writing runtime sql for node "model.citrus_trade.imports_exports_2020"
[0m08:42:26.841088 [debug] [Thread-2 (]: Began executing node model.citrus_trade.imports_by_year
[0m08:42:26.842535 [debug] [Thread-2 (]: Writing runtime sql for node "model.citrus_trade.imports_by_year"
[0m08:42:26.843491 [debug] [Thread-1 (]: Using snowflake connection "model.citrus_trade.imports_exports_2020"
[0m08:42:26.843752 [debug] [Thread-1 (]: On model.citrus_trade.imports_exports_2020: create or replace transient table TRADE_FLOW.marts.imports_exports_2020
    
    
    
    as (select
    declarant_iso,
    flow,
    sum(value_in_euros) over(partition by declarant_iso, flow) as total_value,
    sum(quantity_in_kg) over(partition by declarant_iso, flow) as total_quantity,
    total_value/nullif(total_quantity,0) as value_per_quantity
from TRADE_FLOW.marts.trade_by_hs
where year = 2020
group by 
    declarant_iso,
    flow,
    value_in_euros,
    quantity_in_kg
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.imports_exports_2020"} */;
[0m08:42:26.844204 [debug] [Thread-2 (]: Using snowflake connection "model.citrus_trade.imports_by_year"
[0m08:42:26.845644 [debug] [Thread-2 (]: On model.citrus_trade.imports_by_year: create or replace transient table TRADE_FLOW.marts.imports_by_year
    
    
    
    as (select
    declarant_iso,
    year,
    sum(value_in_euros) as total_value,
    sum(quantity_in_kg) as total_quantity,
    total_value/nullif(total_quantity,0) as value_per_quantity
from TRADE_FLOW.marts.trade_by_hs
where flow = 1
group by 1,2
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.imports_by_year"} */;
[0m08:42:27.389531 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.542 seconds
[0m08:42:27.398248 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '99b37f00-6338-40a5-b531-7017af67b773', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9858af90>]}
[0m08:42:27.400308 [info ] [Thread-2 (]: 3 of 8 OK created sql table model marts.imports_by_year ........................ [[32mSUCCESS 1[0m in 0.56s]
[0m08:42:27.402855 [debug] [Thread-2 (]: Finished running node model.citrus_trade.imports_by_year
[0m08:42:27.404146 [debug] [Thread-3 (]: Began running node model.citrus_trade.growth_score
[0m08:42:27.404941 [info ] [Thread-3 (]: 5 of 8 START sql table model marts.growth_score ................................ [RUN]
[0m08:42:27.406568 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.citrus_trade.trade_by_hs, now model.citrus_trade.growth_score)
[0m08:42:27.409892 [debug] [Thread-3 (]: Began compiling node model.citrus_trade.growth_score
[0m08:42:27.416390 [debug] [Thread-3 (]: Writing injected SQL for node "model.citrus_trade.growth_score"
[0m08:42:27.419968 [debug] [Thread-3 (]: Began executing node model.citrus_trade.growth_score
[0m08:42:27.424312 [debug] [Thread-3 (]: Writing runtime sql for node "model.citrus_trade.growth_score"
[0m08:42:27.431300 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.587 seconds
[0m08:42:27.440718 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '99b37f00-6338-40a5-b531-7017af67b773', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98132690>]}
[0m08:42:27.441657 [info ] [Thread-1 (]: 4 of 8 OK created sql table model marts.imports_exports_2020 ................... [[32mSUCCESS 1[0m in 0.60s]
[0m08:42:27.445228 [debug] [Thread-1 (]: Finished running node model.citrus_trade.imports_exports_2020
[0m08:42:27.457343 [debug] [Thread-3 (]: Using snowflake connection "model.citrus_trade.growth_score"
[0m08:42:27.461105 [debug] [Thread-3 (]: On model.citrus_trade.growth_score: create or replace transient table TRADE_FLOW.marts.growth_score
    
    
    
    as (with 
    previous_year AS (
        select 
            declarant_iso,
            year,
            lag(total_value,1) over(partition by declarant_iso order by year) previous_year_value,
            total_value,
            first_value(total_value) over(partition by declarant_iso order by year) as first_year_value,
            last_value(total_value) over(partition by declarant_iso order by year) as last_year_value
        from TRADE_FLOW.marts.imports_by_year
    ),
    growth_speed AS (
        select 
            declarant_iso,
            year,
            first_year_value,
            last_year_value,
            last_year_value/nullif(first_year_value,0) as growth_overall,
            previous_year_value,
            total_value,
            (total_value - previous_year_value)/total_value * 100 as growth_speed 
        from previous_year
    ),
    previous_year_growth_speed AS (
        select 
            declarant_iso,
            year,
            first_year_value,
            last_year_value,
            growth_overall,
            previous_year_value,
            total_value as current_value,
            growth_speed,
            lag(growth_speed,1) over(partition by declarant_iso order by year) previous_year_growth_speed,
        from growth_speed
        order by 1,2
    ),
    base AS (
        select 
            declarant_iso,
            year,
            first_year_value,
            last_year_value,
            growth_overall,
            previous_year_value,
            current_value,
            previous_year_growth_speed,
            growth_speed,
            growth_speed - previous_year_growth_speed as growth_acceleration,
            avg(growth_acceleration) over(partition by declarant_iso) as avg_acceleration
        from previous_year_growth_speed
    ),
    ok as (
        select 
            declarant_iso,
            year,
            first_year_value,
            last_year_value,
            growth_overall,
            (growth_overall - min(growth_overall) OVER())/(max(growth_overall) OVER() - min(growth_overall) OVER()) as growth_overall_norm,
            previous_year_value,
            current_value,
            -- previous_year_growth_speed,
            growth_speed,
            growth_acceleration,
            avg_acceleration,
            (avg_acceleration - min(avg_acceleration) OVER())/(max(avg_acceleration) OVER() - min(avg_acceleration) OVER()) as avg_acceleration_norm
        from base 
    )
    select 
        distinct 
        declarant_iso,
        year,
        current_value,
        growth_speed,
        growth_acceleration,
        growth_overall,
        growth_overall_norm,
        avg_acceleration,
        avg_acceleration_norm,
        growth_overall_norm * avg_acceleration_norm as growth_score
    from ok
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.growth_score"} */;
[0m08:42:27.466377 [debug] [Thread-2 (]: Began running node model.citrus_trade.score_2020
[0m08:42:27.474373 [info ] [Thread-2 (]: 6 of 8 START sql table model marts.score_2020 .................................. [RUN]
[0m08:42:27.475240 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.citrus_trade.imports_by_year, now model.citrus_trade.score_2020)
[0m08:42:27.476124 [debug] [Thread-2 (]: Began compiling node model.citrus_trade.score_2020
[0m08:42:27.483821 [debug] [Thread-2 (]: Writing injected SQL for node "model.citrus_trade.score_2020"
[0m08:42:27.489595 [debug] [Thread-2 (]: Began executing node model.citrus_trade.score_2020
[0m08:42:27.494825 [debug] [Thread-2 (]: Writing runtime sql for node "model.citrus_trade.score_2020"
[0m08:42:27.517433 [debug] [Thread-2 (]: Using snowflake connection "model.citrus_trade.score_2020"
[0m08:42:27.522137 [debug] [Thread-2 (]: On model.citrus_trade.score_2020: create or replace transient table TRADE_FLOW.marts.score_2020
    
    
    
    as (select distinct 
    declarant_iso,
    total_value,
    total_quantity,
    value_per_quantity,
    (total_value - min(total_value) over())/((max(total_value) over())-(min(total_value) over())) as value_score,
    (total_quantity - min(total_quantity) over())/((max(total_quantity) over())-(min(total_quantity) over())) as quantity_score,
    (value_per_quantity - min(value_per_quantity) over())/((max(value_per_quantity) over())-(min(value_per_quantity) over())) as price_score
from TRADE_FLOW.marts.imports_exports_2020
where flow = 1
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.score_2020"} */;
[0m08:42:28.232682 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.708 seconds
[0m08:42:28.235114 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.766 seconds
[0m08:42:28.239654 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '99b37f00-6338-40a5-b531-7017af67b773', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9990fb60>]}
[0m08:42:28.242778 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '99b37f00-6338-40a5-b531-7017af67b773', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9990edb0>]}
[0m08:42:28.243883 [info ] [Thread-2 (]: 6 of 8 OK created sql table model marts.score_2020 ............................. [[32mSUCCESS 1[0m in 0.76s]
[0m08:42:28.245176 [info ] [Thread-3 (]: 5 of 8 OK created sql table model marts.growth_score ........................... [[32mSUCCESS 1[0m in 0.84s]
[0m08:42:28.246327 [debug] [Thread-2 (]: Finished running node model.citrus_trade.score_2020
[0m08:42:28.247119 [debug] [Thread-3 (]: Finished running node model.citrus_trade.growth_score
[0m08:42:28.248936 [debug] [Thread-1 (]: Began running node model.citrus_trade.importer_score
[0m08:42:28.249713 [info ] [Thread-1 (]: 7 of 8 START sql table model marts.importer_score .............................. [RUN]
[0m08:42:28.250497 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.citrus_trade.imports_exports_2020, now model.citrus_trade.importer_score)
[0m08:42:28.251444 [debug] [Thread-1 (]: Began compiling node model.citrus_trade.importer_score
[0m08:42:28.260265 [debug] [Thread-1 (]: Writing injected SQL for node "model.citrus_trade.importer_score"
[0m08:42:28.261727 [debug] [Thread-1 (]: Began executing node model.citrus_trade.importer_score
[0m08:42:28.263651 [debug] [Thread-1 (]: Writing runtime sql for node "model.citrus_trade.importer_score"
[0m08:42:28.264702 [debug] [Thread-1 (]: Using snowflake connection "model.citrus_trade.importer_score"
[0m08:42:28.264929 [debug] [Thread-1 (]: On model.citrus_trade.importer_score: create or replace transient table TRADE_FLOW.marts.importer_score
    
    
    
    as (select distinct
    sc.declarant_iso,
    sc.total_value as revenue_total,
    sc.total_quantity as volume_total,
    sc.value_per_quantity as rate_avg,
    sc.value_score as revenue_score,
    sc.quantity_score as volume_score,
    sc.price_score as rate_score,
    gs.growth_score
from TRADE_FLOW.marts.score_2020 as sc
inner join TRADE_FLOW.marts.growth_score as gs
    on gs.declarant_iso = sc.declarant_iso
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.importer_score"} */;
[0m08:42:28.935861 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.670 seconds
[0m08:42:28.939543 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '99b37f00-6338-40a5-b531-7017af67b773', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98577aa0>]}
[0m08:42:28.940297 [info ] [Thread-1 (]: 7 of 8 OK created sql table model marts.importer_score ......................... [[32mSUCCESS 1[0m in 0.69s]
[0m08:42:28.941293 [debug] [Thread-1 (]: Finished running node model.citrus_trade.importer_score
[0m08:42:28.942504 [debug] [Thread-2 (]: Began running node model.citrus_trade.viz_importer_score
[0m08:42:28.943071 [info ] [Thread-2 (]: 8 of 8 START sql table model analytics.viz_importer_score ...................... [RUN]
[0m08:42:28.943606 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.citrus_trade.score_2020, now model.citrus_trade.viz_importer_score)
[0m08:42:28.944220 [debug] [Thread-2 (]: Began compiling node model.citrus_trade.viz_importer_score
[0m08:42:28.949180 [debug] [Thread-2 (]: Writing injected SQL for node "model.citrus_trade.viz_importer_score"
[0m08:42:28.950885 [debug] [Thread-2 (]: Began executing node model.citrus_trade.viz_importer_score
[0m08:42:28.954661 [debug] [Thread-2 (]: Writing runtime sql for node "model.citrus_trade.viz_importer_score"
[0m08:42:28.957258 [debug] [Thread-2 (]: Using snowflake connection "model.citrus_trade.viz_importer_score"
[0m08:42:28.958070 [debug] [Thread-2 (]: On model.citrus_trade.viz_importer_score: create or replace transient table TRADE_FLOW.analytics.viz_importer_score
    
    
    
    as (with 
    scores as (
        select 
            declarant_iso,
            score_type,
            score
        from TRADE_FLOW.marts.importer_score
        unpivot (
            score for score_type in (
                revenue_score as "revenue",
                volume_score as "volume",
                rate_score as "rate",
                growth_score as "growth"
            )
        )
    ),
    metrics as (
        select 
            declarant_iso,
            metric_type,
            metric
        from TRADE_FLOW.marts.importer_score
        unpivot (
            metric for metric_type in (
                revenue_total as "revenue",
                volume_score as "volume",
                rate_score as "rate"
            )
        )
    )
select 
    s.declarant_iso,
    s.score_type,
    s.score,
    m.metric
from scores as s
left join metrics as m
    on s.declarant_iso = v.declarant_iso
    and s.score_type = m.metric_type
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.viz_importer_score"} */;
[0m08:42:29.053905 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01c0400a-0305-74a0-0004-20ca000258aa
[0m08:42:29.055108 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 42 at position 25
invalid identifier 'V.DECLARANT_ISO'
[0m08:42:29.061466 [debug] [Thread-2 (]: Database Error in model viz_importer_score (models/analytics/viz_importer_score.sql)
  000904 (42000): SQL compilation error: error line 42 at position 25
  invalid identifier 'V.DECLARANT_ISO'
  compiled code at target/run/citrus_trade/models/analytics/viz_importer_score.sql
[0m08:42:29.062322 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '99b37f00-6338-40a5-b531-7017af67b773', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff991a57c0>]}
[0m08:42:29.063267 [error] [Thread-2 (]: 8 of 8 ERROR creating sql table model analytics.viz_importer_score ............. [[31mERROR[0m in 0.12s]
[0m08:42:29.064176 [debug] [Thread-2 (]: Finished running node model.citrus_trade.viz_importer_score
[0m08:42:29.065096 [debug] [Thread-7 (]: Marking all children of 'model.citrus_trade.viz_importer_score' to be skipped because of status 'error'.  Reason: Database Error in model viz_importer_score (models/analytics/viz_importer_score.sql)
  000904 (42000): SQL compilation error: error line 42 at position 25
  invalid identifier 'V.DECLARANT_ISO'
  compiled code at target/run/citrus_trade/models/analytics/viz_importer_score.sql.
[0m08:42:29.070309 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:42:29.070738 [debug] [MainThread]: Connection 'model.citrus_trade.importer_score' was left open.
[0m08:42:29.071172 [debug] [MainThread]: On model.citrus_trade.importer_score: Close
[0m08:42:29.151017 [debug] [MainThread]: Connection 'model.citrus_trade.growth_score' was left open.
[0m08:42:29.151445 [debug] [MainThread]: On model.citrus_trade.growth_score: Close
[0m08:42:29.246999 [debug] [MainThread]: Connection 'model.citrus_trade.viz_importer_score' was left open.
[0m08:42:29.248015 [debug] [MainThread]: On model.citrus_trade.viz_importer_score: Close
[0m08:42:29.383916 [info ] [MainThread]: 
[0m08:42:29.384902 [info ] [MainThread]: Finished running 8 table models in 0 hours 0 minutes and 4.75 seconds (4.75s).
[0m08:42:29.388773 [debug] [MainThread]: Command end result
[0m08:42:29.436799 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m08:42:29.440586 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m08:42:29.448709 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/target/run_results.json
[0m08:42:29.449073 [info ] [MainThread]: 
[0m08:42:29.449493 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m08:42:29.449815 [info ] [MainThread]: 
[0m08:42:29.450177 [error] [MainThread]: [31mFailure in model viz_importer_score (models/analytics/viz_importer_score.sql)[0m
[0m08:42:29.450469 [error] [MainThread]:   Database Error in model viz_importer_score (models/analytics/viz_importer_score.sql)
  000904 (42000): SQL compilation error: error line 42 at position 25
  invalid identifier 'V.DECLARANT_ISO'
  compiled code at target/run/citrus_trade/models/analytics/viz_importer_score.sql
[0m08:42:29.450738 [info ] [MainThread]: 
[0m08:42:29.451056 [info ] [MainThread]:   compiled code at target/compiled/citrus_trade/models/analytics/viz_importer_score.sql
[0m08:42:29.451304 [info ] [MainThread]: 
[0m08:42:29.451680 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=8
[0m08:42:29.457282 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 5.862228, "process_in_blocks": "0", "process_kernel_time": 0.50254, "process_mem_max_rss": "151848", "process_out_blocks": "4301", "process_user_time": 2.375005}
[0m08:42:29.458172 [debug] [MainThread]: Command `dbt run` failed at 08:42:29.458071 after 5.86 seconds
[0m08:42:29.458987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d5e62a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9bfa2270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9cc0cce0>]}
[0m08:42:29.459531 [debug] [MainThread]: Flushing usage events
[0m08:42:30.022667 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:42:42.927475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2713da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1c40b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa21c7c20>]}


============================== 08:42:42.930584 | e6d384c1-4e36-43f8-ba71-3cdcaf40e41d ==============================
[0m08:42:42.930584 [info ] [MainThread]: Running with dbt=1.10.13
[0m08:42:42.930999 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'partial_parse': 'True', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'invocation_command': 'dbt run', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'introspect': 'True', 'printer_width': '80', 'target_path': 'None', 'version_check': 'True', 'empty': 'False', 'profiles_dir': '/opt/airflow/dbt', 'write_json': 'True', 'log_path': '/opt/airflow/dbt/logs', 'quiet': 'False', 'warn_error': 'None', 'no_print': 'None'}
[0m08:42:43.086748 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m08:42:43.087205 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m08:42:43.087431 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m08:42:43.185886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e6d384c1-4e36-43f8-ba71-3cdcaf40e41d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0399c10>]}
[0m08:42:43.219580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e6d384c1-4e36-43f8-ba71-3cdcaf40e41d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0bb5b20>]}
[0m08:42:43.220363 [info ] [MainThread]: Registered adapter: snowflake=1.10.3
[0m08:42:43.274995 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m08:42:43.406995 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m08:42:43.408045 [debug] [MainThread]: Partial parsing: updated file: citrus_trade://models/analytics/viz_importer_score.sql
[0m08:42:43.542858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e6d384c1-4e36-43f8-ba71-3cdcaf40e41d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ff1ee10>]}
[0m08:42:43.602998 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m08:42:43.604509 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m08:42:43.613927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e6d384c1-4e36-43f8-ba71-3cdcaf40e41d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9febc680>]}
[0m08:42:43.614200 [info ] [MainThread]: Found 8 models, 3 sources, 636 macros
[0m08:42:43.614550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e6d384c1-4e36-43f8-ba71-3cdcaf40e41d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0544aa0>]}
[0m08:42:43.616376 [info ] [MainThread]: 
[0m08:42:43.616808 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:42:43.617181 [info ] [MainThread]: 
[0m08:42:43.617859 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m08:42:43.621139 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRADE_FLOW'
[0m08:42:43.627141 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRADE_FLOW'
[0m08:42:43.631241 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRADE_FLOW'
[0m08:42:43.659258 [debug] [ThreadPool]: Using snowflake connection "list_TRADE_FLOW"
[0m08:42:43.659606 [debug] [ThreadPool]: Using snowflake connection "list_TRADE_FLOW"
[0m08:42:43.659869 [debug] [ThreadPool]: Using snowflake connection "list_TRADE_FLOW"
[0m08:42:43.660033 [debug] [ThreadPool]: On list_TRADE_FLOW: show terse schemas in database TRADE_FLOW
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRADE_FLOW"} */
[0m08:42:43.660256 [debug] [ThreadPool]: On list_TRADE_FLOW: show terse schemas in database TRADE_FLOW
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRADE_FLOW"} */
[0m08:42:43.660474 [debug] [ThreadPool]: On list_TRADE_FLOW: show terse schemas in database TRADE_FLOW
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRADE_FLOW"} */
[0m08:42:43.660666 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:42:43.660872 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:42:43.661056 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:42:44.249165 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.587 seconds
[0m08:42:44.258694 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.598 seconds
[0m08:42:44.294872 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.634 seconds
[0m08:42:44.303032 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRADE_FLOW, now list_TRADE_FLOW_marts)
[0m08:42:44.311936 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRADE_FLOW, now list_TRADE_FLOW_staging)
[0m08:42:44.342750 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRADE_FLOW, now list_TRADE_FLOW_analytics)
[0m08:42:44.343460 [debug] [ThreadPool]: Using snowflake connection "list_TRADE_FLOW_marts"
[0m08:42:44.345182 [debug] [ThreadPool]: Using snowflake connection "list_TRADE_FLOW_staging"
[0m08:42:44.348058 [debug] [ThreadPool]: Using snowflake connection "list_TRADE_FLOW_analytics"
[0m08:42:44.348508 [debug] [ThreadPool]: On list_TRADE_FLOW_marts: show objects in TRADE_FLOW.marts
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRADE_FLOW_marts"} */;
[0m08:42:44.348874 [debug] [ThreadPool]: On list_TRADE_FLOW_staging: show objects in TRADE_FLOW.staging
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRADE_FLOW_staging"} */;
[0m08:42:44.349123 [debug] [ThreadPool]: On list_TRADE_FLOW_analytics: show objects in TRADE_FLOW.analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRADE_FLOW_analytics"} */;
[0m08:42:44.434131 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 0.084 seconds
[0m08:42:44.443623 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.090 seconds
[0m08:42:44.460081 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.106 seconds
[0m08:42:44.466280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e6d384c1-4e36-43f8-ba71-3cdcaf40e41d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa04805c0>]}
[0m08:42:44.471043 [debug] [Thread-1 (]: Began running node model.citrus_trade.stg_trade
[0m08:42:44.483708 [info ] [Thread-1 (]: 1 of 8 START sql table model staging.stg_trade ................................. [RUN]
[0m08:42:44.493952 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_TRADE_FLOW_analytics, now model.citrus_trade.stg_trade)
[0m08:42:44.505286 [debug] [Thread-1 (]: Began compiling node model.citrus_trade.stg_trade
[0m08:42:44.620465 [debug] [Thread-1 (]: Writing injected SQL for node "model.citrus_trade.stg_trade"
[0m08:42:44.642396 [debug] [Thread-1 (]: Began executing node model.citrus_trade.stg_trade
[0m08:42:44.740737 [debug] [Thread-1 (]: Writing runtime sql for node "model.citrus_trade.stg_trade"
[0m08:42:44.744660 [debug] [Thread-1 (]: Using snowflake connection "model.citrus_trade.stg_trade"
[0m08:42:44.745345 [debug] [Thread-1 (]: On model.citrus_trade.stg_trade: create or replace transient table TRADE_FLOW.staging.stg_trade
    
    
    
    as (select
  value:DECLARANT::int as declarant,
  value:DECLARANT_ISO::string as declarant_iso,
  value:PARTNER::string as partner,
  value:PARTNER_ISO::string as partner_iso,
  value:FLOW::int as flow,
  value:TRANSPORT_MODE::int as transport_mode,
  value:PERIOD::int as period,
  year(to_date(left(period,4),'YYYY')) as year,
  value:HS4::string as hs4,
  value:HS4_NAME::string as hs4_name,
  value:HS6::string as hs6,
  value:HS6_NAME::string as hs6_name,
  value:VALUE_IN_EUROS::float as value_in_euros,
  value:QUANTITY_IN_KG::float as quantity_in_kg
from trade_flow.raw.raw_trhs
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.stg_trade"} */;
[0m08:42:45.409488 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.663 seconds
[0m08:42:45.599216 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e6d384c1-4e36-43f8-ba71-3cdcaf40e41d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4389940>]}
[0m08:42:45.602701 [info ] [Thread-1 (]: 1 of 8 OK created sql table model staging.stg_trade ............................ [[32mSUCCESS 1[0m in 1.10s]
[0m08:42:45.603538 [debug] [Thread-1 (]: Finished running node model.citrus_trade.stg_trade
[0m08:42:45.605248 [debug] [Thread-3 (]: Began running node model.citrus_trade.trade_by_hs
[0m08:42:45.605682 [info ] [Thread-3 (]: 2 of 8 START sql table model marts.trade_by_hs ................................. [RUN]
[0m08:42:45.606108 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_TRADE_FLOW_staging, now model.citrus_trade.trade_by_hs)
[0m08:42:45.606392 [debug] [Thread-3 (]: Began compiling node model.citrus_trade.trade_by_hs
[0m08:42:45.609743 [debug] [Thread-3 (]: Writing injected SQL for node "model.citrus_trade.trade_by_hs"
[0m08:42:45.611513 [debug] [Thread-3 (]: Began executing node model.citrus_trade.trade_by_hs
[0m08:42:45.617921 [debug] [Thread-3 (]: Writing runtime sql for node "model.citrus_trade.trade_by_hs"
[0m08:42:45.619167 [debug] [Thread-3 (]: Using snowflake connection "model.citrus_trade.trade_by_hs"
[0m08:42:45.619447 [debug] [Thread-3 (]: On model.citrus_trade.trade_by_hs: create or replace transient table TRADE_FLOW.marts.trade_by_hs
    
    
    
    as (select
    *
from TRADE_FLOW.staging.stg_trade
where hs6 = '080510'
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.trade_by_hs"} */;
[0m08:42:46.309233 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.689 seconds
[0m08:42:46.322926 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e6d384c1-4e36-43f8-ba71-3cdcaf40e41d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ffb3e60>]}
[0m08:42:46.324430 [info ] [Thread-3 (]: 2 of 8 OK created sql table model marts.trade_by_hs ............................ [[32mSUCCESS 1[0m in 0.72s]
[0m08:42:46.325555 [debug] [Thread-3 (]: Finished running node model.citrus_trade.trade_by_hs
[0m08:42:46.327975 [debug] [Thread-2 (]: Began running node model.citrus_trade.imports_by_year
[0m08:42:46.328839 [debug] [Thread-1 (]: Began running node model.citrus_trade.imports_exports_2020
[0m08:42:46.329752 [info ] [Thread-2 (]: 3 of 8 START sql table model marts.imports_by_year ............................. [RUN]
[0m08:42:46.331734 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_TRADE_FLOW_marts, now model.citrus_trade.imports_by_year)
[0m08:42:46.332297 [debug] [Thread-2 (]: Began compiling node model.citrus_trade.imports_by_year
[0m08:42:46.330914 [info ] [Thread-1 (]: 4 of 8 START sql table model marts.imports_exports_2020 ........................ [RUN]
[0m08:42:46.338111 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.citrus_trade.stg_trade, now model.citrus_trade.imports_exports_2020)
[0m08:42:46.338613 [debug] [Thread-1 (]: Began compiling node model.citrus_trade.imports_exports_2020
[0m08:42:46.337567 [debug] [Thread-2 (]: Writing injected SQL for node "model.citrus_trade.imports_by_year"
[0m08:42:46.342253 [debug] [Thread-1 (]: Writing injected SQL for node "model.citrus_trade.imports_exports_2020"
[0m08:42:46.344118 [debug] [Thread-2 (]: Began executing node model.citrus_trade.imports_by_year
[0m08:42:46.347500 [debug] [Thread-2 (]: Writing runtime sql for node "model.citrus_trade.imports_by_year"
[0m08:42:46.347931 [debug] [Thread-1 (]: Began executing node model.citrus_trade.imports_exports_2020
[0m08:42:46.350902 [debug] [Thread-1 (]: Writing runtime sql for node "model.citrus_trade.imports_exports_2020"
[0m08:42:46.352271 [debug] [Thread-2 (]: Using snowflake connection "model.citrus_trade.imports_by_year"
[0m08:42:46.352695 [debug] [Thread-2 (]: On model.citrus_trade.imports_by_year: create or replace transient table TRADE_FLOW.marts.imports_by_year
    
    
    
    as (select
    declarant_iso,
    year,
    sum(value_in_euros) as total_value,
    sum(quantity_in_kg) as total_quantity,
    total_value/nullif(total_quantity,0) as value_per_quantity
from TRADE_FLOW.marts.trade_by_hs
where flow = 1
group by 1,2
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.imports_by_year"} */;
[0m08:42:46.353684 [debug] [Thread-1 (]: Using snowflake connection "model.citrus_trade.imports_exports_2020"
[0m08:42:46.355991 [debug] [Thread-1 (]: On model.citrus_trade.imports_exports_2020: create or replace transient table TRADE_FLOW.marts.imports_exports_2020
    
    
    
    as (select
    declarant_iso,
    flow,
    sum(value_in_euros) over(partition by declarant_iso, flow) as total_value,
    sum(quantity_in_kg) over(partition by declarant_iso, flow) as total_quantity,
    total_value/nullif(total_quantity,0) as value_per_quantity
from TRADE_FLOW.marts.trade_by_hs
where year = 2020
group by 
    declarant_iso,
    flow,
    value_in_euros,
    quantity_in_kg
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.imports_exports_2020"} */;
[0m08:42:46.920376 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.566 seconds
[0m08:42:46.924550 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e6d384c1-4e36-43f8-ba71-3cdcaf40e41d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e33bad0>]}
[0m08:42:46.925942 [info ] [Thread-2 (]: 3 of 8 OK created sql table model marts.imports_by_year ........................ [[32mSUCCESS 1[0m in 0.59s]
[0m08:42:46.926952 [debug] [Thread-2 (]: Finished running node model.citrus_trade.imports_by_year
[0m08:42:46.927817 [debug] [Thread-3 (]: Began running node model.citrus_trade.growth_score
[0m08:42:46.928277 [info ] [Thread-3 (]: 5 of 8 START sql table model marts.growth_score ................................ [RUN]
[0m08:42:46.928791 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.citrus_trade.trade_by_hs, now model.citrus_trade.growth_score)
[0m08:42:46.929250 [debug] [Thread-3 (]: Began compiling node model.citrus_trade.growth_score
[0m08:42:46.932510 [debug] [Thread-3 (]: Writing injected SQL for node "model.citrus_trade.growth_score"
[0m08:42:46.933534 [debug] [Thread-3 (]: Began executing node model.citrus_trade.growth_score
[0m08:42:46.936062 [debug] [Thread-3 (]: Writing runtime sql for node "model.citrus_trade.growth_score"
[0m08:42:46.938757 [debug] [Thread-3 (]: Using snowflake connection "model.citrus_trade.growth_score"
[0m08:42:46.939203 [debug] [Thread-3 (]: On model.citrus_trade.growth_score: create or replace transient table TRADE_FLOW.marts.growth_score
    
    
    
    as (with 
    previous_year AS (
        select 
            declarant_iso,
            year,
            lag(total_value,1) over(partition by declarant_iso order by year) previous_year_value,
            total_value,
            first_value(total_value) over(partition by declarant_iso order by year) as first_year_value,
            last_value(total_value) over(partition by declarant_iso order by year) as last_year_value
        from TRADE_FLOW.marts.imports_by_year
    ),
    growth_speed AS (
        select 
            declarant_iso,
            year,
            first_year_value,
            last_year_value,
            last_year_value/nullif(first_year_value,0) as growth_overall,
            previous_year_value,
            total_value,
            (total_value - previous_year_value)/total_value * 100 as growth_speed 
        from previous_year
    ),
    previous_year_growth_speed AS (
        select 
            declarant_iso,
            year,
            first_year_value,
            last_year_value,
            growth_overall,
            previous_year_value,
            total_value as current_value,
            growth_speed,
            lag(growth_speed,1) over(partition by declarant_iso order by year) previous_year_growth_speed,
        from growth_speed
        order by 1,2
    ),
    base AS (
        select 
            declarant_iso,
            year,
            first_year_value,
            last_year_value,
            growth_overall,
            previous_year_value,
            current_value,
            previous_year_growth_speed,
            growth_speed,
            growth_speed - previous_year_growth_speed as growth_acceleration,
            avg(growth_acceleration) over(partition by declarant_iso) as avg_acceleration
        from previous_year_growth_speed
    ),
    ok as (
        select 
            declarant_iso,
            year,
            first_year_value,
            last_year_value,
            growth_overall,
            (growth_overall - min(growth_overall) OVER())/(max(growth_overall) OVER() - min(growth_overall) OVER()) as growth_overall_norm,
            previous_year_value,
            current_value,
            -- previous_year_growth_speed,
            growth_speed,
            growth_acceleration,
            avg_acceleration,
            (avg_acceleration - min(avg_acceleration) OVER())/(max(avg_acceleration) OVER() - min(avg_acceleration) OVER()) as avg_acceleration_norm
        from base 
    )
    select 
        distinct 
        declarant_iso,
        year,
        current_value,
        growth_speed,
        growth_acceleration,
        growth_overall,
        growth_overall_norm,
        avg_acceleration,
        avg_acceleration_norm,
        growth_overall_norm * avg_acceleration_norm as growth_score
    from ok
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.growth_score"} */;
[0m08:42:47.038284 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.681 seconds
[0m08:42:47.043216 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e6d384c1-4e36-43f8-ba71-3cdcaf40e41d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e32f440>]}
[0m08:42:47.044638 [info ] [Thread-1 (]: 4 of 8 OK created sql table model marts.imports_exports_2020 ................... [[32mSUCCESS 1[0m in 0.70s]
[0m08:42:47.045733 [debug] [Thread-1 (]: Finished running node model.citrus_trade.imports_exports_2020
[0m08:42:47.047112 [debug] [Thread-2 (]: Began running node model.citrus_trade.score_2020
[0m08:42:47.047977 [info ] [Thread-2 (]: 6 of 8 START sql table model marts.score_2020 .................................. [RUN]
[0m08:42:47.048826 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.citrus_trade.imports_by_year, now model.citrus_trade.score_2020)
[0m08:42:47.049546 [debug] [Thread-2 (]: Began compiling node model.citrus_trade.score_2020
[0m08:42:47.056292 [debug] [Thread-2 (]: Writing injected SQL for node "model.citrus_trade.score_2020"
[0m08:42:47.058280 [debug] [Thread-2 (]: Began executing node model.citrus_trade.score_2020
[0m08:42:47.063443 [debug] [Thread-2 (]: Writing runtime sql for node "model.citrus_trade.score_2020"
[0m08:42:47.065911 [debug] [Thread-2 (]: Using snowflake connection "model.citrus_trade.score_2020"
[0m08:42:47.066429 [debug] [Thread-2 (]: On model.citrus_trade.score_2020: create or replace transient table TRADE_FLOW.marts.score_2020
    
    
    
    as (select distinct 
    declarant_iso,
    total_value,
    total_quantity,
    value_per_quantity,
    (total_value - min(total_value) over())/((max(total_value) over())-(min(total_value) over())) as value_score,
    (total_quantity - min(total_quantity) over())/((max(total_quantity) over())-(min(total_quantity) over())) as quantity_score,
    (value_per_quantity - min(value_per_quantity) over())/((max(value_per_quantity) over())-(min(value_per_quantity) over())) as price_score
from TRADE_FLOW.marts.imports_exports_2020
where flow = 1
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.score_2020"} */;
[0m08:42:47.682819 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.742 seconds
[0m08:42:47.692373 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e6d384c1-4e36-43f8-ba71-3cdcaf40e41d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e756b70>]}
[0m08:42:47.693512 [info ] [Thread-3 (]: 5 of 8 OK created sql table model marts.growth_score ........................... [[32mSUCCESS 1[0m in 0.76s]
[0m08:42:47.694952 [debug] [Thread-3 (]: Finished running node model.citrus_trade.growth_score
[0m08:42:47.771177 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.704 seconds
[0m08:42:47.779809 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e6d384c1-4e36-43f8-ba71-3cdcaf40e41d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e75e2a0>]}
[0m08:42:47.781239 [info ] [Thread-2 (]: 6 of 8 OK created sql table model marts.score_2020 ............................. [[32mSUCCESS 1[0m in 0.73s]
[0m08:42:47.786108 [debug] [Thread-2 (]: Finished running node model.citrus_trade.score_2020
[0m08:42:47.790670 [debug] [Thread-1 (]: Began running node model.citrus_trade.importer_score
[0m08:42:47.792351 [info ] [Thread-1 (]: 7 of 8 START sql table model marts.importer_score .............................. [RUN]
[0m08:42:47.793455 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.citrus_trade.imports_exports_2020, now model.citrus_trade.importer_score)
[0m08:42:47.794608 [debug] [Thread-1 (]: Began compiling node model.citrus_trade.importer_score
[0m08:42:47.799098 [debug] [Thread-1 (]: Writing injected SQL for node "model.citrus_trade.importer_score"
[0m08:42:47.801324 [debug] [Thread-1 (]: Began executing node model.citrus_trade.importer_score
[0m08:42:47.803507 [debug] [Thread-1 (]: Writing runtime sql for node "model.citrus_trade.importer_score"
[0m08:42:47.804760 [debug] [Thread-1 (]: Using snowflake connection "model.citrus_trade.importer_score"
[0m08:42:47.805047 [debug] [Thread-1 (]: On model.citrus_trade.importer_score: create or replace transient table TRADE_FLOW.marts.importer_score
    
    
    
    as (select distinct
    sc.declarant_iso,
    sc.total_value as revenue_total,
    sc.total_quantity as volume_total,
    sc.value_per_quantity as rate_avg,
    sc.value_score as revenue_score,
    sc.quantity_score as volume_score,
    sc.price_score as rate_score,
    gs.growth_score
from TRADE_FLOW.marts.score_2020 as sc
inner join TRADE_FLOW.marts.growth_score as gs
    on gs.declarant_iso = sc.declarant_iso
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.importer_score"} */;
[0m08:42:48.609198 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.803 seconds
[0m08:42:48.614424 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e6d384c1-4e36-43f8-ba71-3cdcaf40e41d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e39a060>]}
[0m08:42:48.616068 [info ] [Thread-1 (]: 7 of 8 OK created sql table model marts.importer_score ......................... [[32mSUCCESS 1[0m in 0.82s]
[0m08:42:48.617656 [debug] [Thread-1 (]: Finished running node model.citrus_trade.importer_score
[0m08:42:48.619430 [debug] [Thread-3 (]: Began running node model.citrus_trade.viz_importer_score
[0m08:42:48.620144 [info ] [Thread-3 (]: 8 of 8 START sql table model analytics.viz_importer_score ...................... [RUN]
[0m08:42:48.620835 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.citrus_trade.growth_score, now model.citrus_trade.viz_importer_score)
[0m08:42:48.621522 [debug] [Thread-3 (]: Began compiling node model.citrus_trade.viz_importer_score
[0m08:42:48.627029 [debug] [Thread-3 (]: Writing injected SQL for node "model.citrus_trade.viz_importer_score"
[0m08:42:48.629007 [debug] [Thread-3 (]: Began executing node model.citrus_trade.viz_importer_score
[0m08:42:48.632794 [debug] [Thread-3 (]: Writing runtime sql for node "model.citrus_trade.viz_importer_score"
[0m08:42:48.635276 [debug] [Thread-3 (]: Using snowflake connection "model.citrus_trade.viz_importer_score"
[0m08:42:48.635787 [debug] [Thread-3 (]: On model.citrus_trade.viz_importer_score: create or replace transient table TRADE_FLOW.analytics.viz_importer_score
    
    
    
    as (with 
    scores as (
        select 
            declarant_iso,
            score_type,
            score
        from TRADE_FLOW.marts.importer_score
        unpivot (
            score for score_type in (
                revenue_score as "revenue",
                volume_score as "volume",
                rate_score as "rate",
                growth_score as "growth"
            )
        )
    ),
    metrics as (
        select 
            declarant_iso,
            metric_type,
            metric
        from TRADE_FLOW.marts.importer_score
        unpivot (
            metric for metric_type in (
                revenue_total as "revenue",
                volume_score as "volume",
                rate_score as "rate"
            )
        )
    )
select 
    s.declarant_iso,
    s.score_type,
    s.score,
    m.metric
from scores as s
left join metrics as m
    on s.declarant_iso = m.declarant_iso
    and s.score_type = m.metric_type
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.viz_importer_score"} */;
[0m08:42:49.326132 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.689 seconds
[0m08:42:49.331786 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e6d384c1-4e36-43f8-ba71-3cdcaf40e41d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e75f5f0>]}
[0m08:42:49.332940 [info ] [Thread-3 (]: 8 of 8 OK created sql table model analytics.viz_importer_score ................. [[32mSUCCESS 1[0m in 0.71s]
[0m08:42:49.333822 [debug] [Thread-3 (]: Finished running node model.citrus_trade.viz_importer_score
[0m08:42:49.339406 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:42:49.340006 [debug] [MainThread]: Connection 'model.citrus_trade.score_2020' was left open.
[0m08:42:49.340438 [debug] [MainThread]: On model.citrus_trade.score_2020: Close
[0m08:42:49.436305 [debug] [MainThread]: Connection 'model.citrus_trade.viz_importer_score' was left open.
[0m08:42:49.436657 [debug] [MainThread]: On model.citrus_trade.viz_importer_score: Close
[0m08:42:49.522246 [debug] [MainThread]: Connection 'model.citrus_trade.importer_score' was left open.
[0m08:42:49.523191 [debug] [MainThread]: On model.citrus_trade.importer_score: Close
[0m08:42:49.631119 [info ] [MainThread]: 
[0m08:42:49.633176 [info ] [MainThread]: Finished running 8 table models in 0 hours 0 minutes and 6.01 seconds (6.01s).
[0m08:42:49.636742 [debug] [MainThread]: Command end result
[0m08:42:49.692203 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m08:42:49.708422 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m08:42:49.716385 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/target/run_results.json
[0m08:42:49.716657 [info ] [MainThread]: 
[0m08:42:49.717023 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:42:49.717310 [info ] [MainThread]: 
[0m08:42:49.717814 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=8
[0m08:42:49.721715 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.827686, "process_in_blocks": "0", "process_kernel_time": 0.510047, "process_mem_max_rss": "151168", "process_out_blocks": "4299", "process_user_time": 2.461299}
[0m08:42:49.723248 [debug] [MainThread]: Command `dbt run` succeeded at 08:42:49.723068 after 6.83 seconds
[0m08:42:49.724454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa46e9af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa29de5a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa044a720>]}
[0m08:42:49.724818 [debug] [MainThread]: Flushing usage events
[0m08:42:50.335025 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:43:51.944319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1546e70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb11e9100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb159e1e0>]}


============================== 08:43:51.950116 | 9e4eb8d7-8c01-4c58-971b-80136909ec6f ==============================
[0m08:43:51.950116 [info ] [MainThread]: Running with dbt=1.10.13
[0m08:43:51.950646 [debug] [MainThread]: running dbt with arguments {'empty': 'False', 'quiet': 'False', 'use_colors': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': '/opt/airflow/dbt/logs', 'write_json': 'True', 'use_experimental_parser': 'False', 'invocation_command': 'dbt run', 'log_format': 'default', 'profiles_dir': '/opt/airflow/dbt', 'printer_width': '80', 'static_parser': 'True', 'partial_parse': 'True', 'target_path': 'None', 'indirect_selection': 'eager', 'no_print': 'None', 'fail_fast': 'False', 'version_check': 'True', 'debug': 'False', 'introspect': 'True', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True'}
[0m08:43:52.110687 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m08:43:52.111121 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m08:43:52.111349 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m08:43:52.210473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9e4eb8d7-8c01-4c58-971b-80136909ec6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffafe831a0>]}
[0m08:43:52.241518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9e4eb8d7-8c01-4c58-971b-80136909ec6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0ed7230>]}
[0m08:43:52.241999 [info ] [MainThread]: Registered adapter: snowflake=1.10.3
[0m08:43:52.295411 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m08:43:52.414653 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:43:52.414948 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:43:52.433463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9e4eb8d7-8c01-4c58-971b-80136909ec6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf6fc920>]}
[0m08:43:52.495121 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m08:43:52.496579 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m08:43:52.505693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9e4eb8d7-8c01-4c58-971b-80136909ec6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf2d2ae0>]}
[0m08:43:52.505952 [info ] [MainThread]: Found 8 models, 3 sources, 636 macros
[0m08:43:52.506149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9e4eb8d7-8c01-4c58-971b-80136909ec6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf553140>]}
[0m08:43:52.507679 [info ] [MainThread]: 
[0m08:43:52.507994 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:43:52.508279 [info ] [MainThread]: 
[0m08:43:52.508885 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m08:43:52.511733 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRADE_FLOW'
[0m08:43:52.519156 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRADE_FLOW'
[0m08:43:52.522880 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRADE_FLOW'
[0m08:43:52.557020 [debug] [ThreadPool]: Using snowflake connection "list_TRADE_FLOW"
[0m08:43:52.557380 [debug] [ThreadPool]: Using snowflake connection "list_TRADE_FLOW"
[0m08:43:52.557642 [debug] [ThreadPool]: Using snowflake connection "list_TRADE_FLOW"
[0m08:43:52.557817 [debug] [ThreadPool]: On list_TRADE_FLOW: show terse schemas in database TRADE_FLOW
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRADE_FLOW"} */
[0m08:43:52.558049 [debug] [ThreadPool]: On list_TRADE_FLOW: show terse schemas in database TRADE_FLOW
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRADE_FLOW"} */
[0m08:43:52.558286 [debug] [ThreadPool]: On list_TRADE_FLOW: show terse schemas in database TRADE_FLOW
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRADE_FLOW"} */
[0m08:43:52.558524 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:43:52.558751 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:43:52.558970 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:43:53.229180 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.670 seconds
[0m08:43:53.244371 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.685 seconds
[0m08:43:53.262881 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.704 seconds
[0m08:43:53.269717 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRADE_FLOW, now list_TRADE_FLOW_staging)
[0m08:43:53.276753 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRADE_FLOW, now list_TRADE_FLOW_marts)
[0m08:43:53.307468 [debug] [ThreadPool]: Using snowflake connection "list_TRADE_FLOW_staging"
[0m08:43:53.308114 [debug] [ThreadPool]: Using snowflake connection "list_TRADE_FLOW_marts"
[0m08:43:53.308521 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRADE_FLOW, now list_TRADE_FLOW_analytics)
[0m08:43:53.308835 [debug] [ThreadPool]: On list_TRADE_FLOW_staging: show objects in TRADE_FLOW.staging
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRADE_FLOW_staging"} */;
[0m08:43:53.309270 [debug] [ThreadPool]: On list_TRADE_FLOW_marts: show objects in TRADE_FLOW.marts
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRADE_FLOW_marts"} */;
[0m08:43:53.313181 [debug] [ThreadPool]: Using snowflake connection "list_TRADE_FLOW_analytics"
[0m08:43:53.319781 [debug] [ThreadPool]: On list_TRADE_FLOW_analytics: show objects in TRADE_FLOW.analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRADE_FLOW_analytics"} */;
[0m08:43:53.402495 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.088 seconds
[0m08:43:53.403138 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.083 seconds
[0m08:43:53.406798 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 0.089 seconds
[0m08:43:53.409244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9e4eb8d7-8c01-4c58-971b-80136909ec6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf72c230>]}
[0m08:43:53.411895 [debug] [Thread-1 (]: Began running node model.citrus_trade.stg_trade
[0m08:43:53.412281 [info ] [Thread-1 (]: 1 of 8 START sql table model staging.stg_trade ................................. [RUN]
[0m08:43:53.412709 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_TRADE_FLOW_marts, now model.citrus_trade.stg_trade)
[0m08:43:53.412999 [debug] [Thread-1 (]: Began compiling node model.citrus_trade.stg_trade
[0m08:43:53.419187 [debug] [Thread-1 (]: Writing injected SQL for node "model.citrus_trade.stg_trade"
[0m08:43:53.420408 [debug] [Thread-1 (]: Began executing node model.citrus_trade.stg_trade
[0m08:43:53.438953 [debug] [Thread-1 (]: Writing runtime sql for node "model.citrus_trade.stg_trade"
[0m08:43:53.440287 [debug] [Thread-1 (]: Using snowflake connection "model.citrus_trade.stg_trade"
[0m08:43:53.440513 [debug] [Thread-1 (]: On model.citrus_trade.stg_trade: create or replace transient table TRADE_FLOW.staging.stg_trade
    
    
    
    as (select
  value:DECLARANT::int as declarant,
  value:DECLARANT_ISO::string as declarant_iso,
  value:PARTNER::string as partner,
  value:PARTNER_ISO::string as partner_iso,
  value:FLOW::int as flow,
  value:TRANSPORT_MODE::int as transport_mode,
  value:PERIOD::int as period,
  year(to_date(left(period,4),'YYYY')) as year,
  value:HS4::string as hs4,
  value:HS4_NAME::string as hs4_name,
  value:HS6::string as hs6,
  value:HS6_NAME::string as hs6_name,
  value:VALUE_IN_EUROS::float as value_in_euros,
  value:QUANTITY_IN_KG::float as quantity_in_kg
from trade_flow.raw.raw_trhs
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.stg_trade"} */;
[0m08:43:54.117479 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.676 seconds
[0m08:43:54.136105 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9e4eb8d7-8c01-4c58-971b-80136909ec6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb35e9b20>]}
[0m08:43:54.136697 [info ] [Thread-1 (]: 1 of 8 OK created sql table model staging.stg_trade ............................ [[32mSUCCESS 1[0m in 0.72s]
[0m08:43:54.137275 [debug] [Thread-1 (]: Finished running node model.citrus_trade.stg_trade
[0m08:43:54.138032 [debug] [Thread-3 (]: Began running node model.citrus_trade.trade_by_hs
[0m08:43:54.138342 [info ] [Thread-3 (]: 2 of 8 START sql table model marts.trade_by_hs ................................. [RUN]
[0m08:43:54.138668 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_TRADE_FLOW_staging, now model.citrus_trade.trade_by_hs)
[0m08:43:54.139075 [debug] [Thread-3 (]: Began compiling node model.citrus_trade.trade_by_hs
[0m08:43:54.141194 [debug] [Thread-3 (]: Writing injected SQL for node "model.citrus_trade.trade_by_hs"
[0m08:43:54.142169 [debug] [Thread-3 (]: Began executing node model.citrus_trade.trade_by_hs
[0m08:43:54.143900 [debug] [Thread-3 (]: Writing runtime sql for node "model.citrus_trade.trade_by_hs"
[0m08:43:54.144683 [debug] [Thread-3 (]: Using snowflake connection "model.citrus_trade.trade_by_hs"
[0m08:43:54.144903 [debug] [Thread-3 (]: On model.citrus_trade.trade_by_hs: create or replace transient table TRADE_FLOW.marts.trade_by_hs
    
    
    
    as (select
    *
from TRADE_FLOW.staging.stg_trade
where hs6 = '080510'
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.trade_by_hs"} */;
[0m08:43:54.730706 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.585 seconds
[0m08:43:54.733856 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9e4eb8d7-8c01-4c58-971b-80136909ec6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad3e5e50>]}
[0m08:43:54.734427 [info ] [Thread-3 (]: 2 of 8 OK created sql table model marts.trade_by_hs ............................ [[32mSUCCESS 1[0m in 0.60s]
[0m08:43:54.735060 [debug] [Thread-3 (]: Finished running node model.citrus_trade.trade_by_hs
[0m08:43:54.735880 [debug] [Thread-2 (]: Began running node model.citrus_trade.imports_by_year
[0m08:43:54.736387 [info ] [Thread-2 (]: 3 of 8 START sql table model marts.imports_by_year ............................. [RUN]
[0m08:43:54.736644 [debug] [Thread-1 (]: Began running node model.citrus_trade.imports_exports_2020
[0m08:43:54.736926 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_TRADE_FLOW_analytics, now model.citrus_trade.imports_by_year)
[0m08:43:54.737502 [debug] [Thread-2 (]: Began compiling node model.citrus_trade.imports_by_year
[0m08:43:54.740998 [debug] [Thread-2 (]: Writing injected SQL for node "model.citrus_trade.imports_by_year"
[0m08:43:54.737240 [info ] [Thread-1 (]: 4 of 8 START sql table model marts.imports_exports_2020 ........................ [RUN]
[0m08:43:54.741440 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.citrus_trade.stg_trade, now model.citrus_trade.imports_exports_2020)
[0m08:43:54.741720 [debug] [Thread-1 (]: Began compiling node model.citrus_trade.imports_exports_2020
[0m08:43:54.743202 [debug] [Thread-1 (]: Writing injected SQL for node "model.citrus_trade.imports_exports_2020"
[0m08:43:54.743635 [debug] [Thread-2 (]: Began executing node model.citrus_trade.imports_by_year
[0m08:43:54.745471 [debug] [Thread-2 (]: Writing runtime sql for node "model.citrus_trade.imports_by_year"
[0m08:43:54.745866 [debug] [Thread-1 (]: Began executing node model.citrus_trade.imports_exports_2020
[0m08:43:54.747740 [debug] [Thread-1 (]: Writing runtime sql for node "model.citrus_trade.imports_exports_2020"
[0m08:43:54.748791 [debug] [Thread-2 (]: Using snowflake connection "model.citrus_trade.imports_by_year"
[0m08:43:54.749128 [debug] [Thread-2 (]: On model.citrus_trade.imports_by_year: create or replace transient table TRADE_FLOW.marts.imports_by_year
    
    
    
    as (select
    declarant_iso,
    year,
    sum(value_in_euros) as total_value,
    sum(quantity_in_kg) as total_quantity,
    total_value/nullif(total_quantity,0) as value_per_quantity
from TRADE_FLOW.marts.trade_by_hs
where flow = 1
group by 1,2
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.imports_by_year"} */;
[0m08:43:54.749888 [debug] [Thread-1 (]: Using snowflake connection "model.citrus_trade.imports_exports_2020"
[0m08:43:54.751865 [debug] [Thread-1 (]: On model.citrus_trade.imports_exports_2020: create or replace transient table TRADE_FLOW.marts.imports_exports_2020
    
    
    
    as (select
    declarant_iso,
    flow,
    sum(value_in_euros) over(partition by declarant_iso, flow) as total_value,
    sum(quantity_in_kg) over(partition by declarant_iso, flow) as total_quantity,
    total_value/nullif(total_quantity,0) as value_per_quantity
from TRADE_FLOW.marts.trade_by_hs
where year = 2020
group by 
    declarant_iso,
    flow,
    value_in_euros,
    quantity_in_kg
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.imports_exports_2020"} */;
[0m08:43:55.475878 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.725 seconds
[0m08:43:55.483096 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9e4eb8d7-8c01-4c58-971b-80136909ec6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad2aea80>]}
[0m08:43:55.484747 [info ] [Thread-2 (]: 3 of 8 OK created sql table model marts.imports_by_year ........................ [[32mSUCCESS 1[0m in 0.75s]
[0m08:43:55.486119 [debug] [Thread-2 (]: Finished running node model.citrus_trade.imports_by_year
[0m08:43:55.487464 [debug] [Thread-3 (]: Began running node model.citrus_trade.growth_score
[0m08:43:55.488386 [info ] [Thread-3 (]: 5 of 8 START sql table model marts.growth_score ................................ [RUN]
[0m08:43:55.489797 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.citrus_trade.trade_by_hs, now model.citrus_trade.growth_score)
[0m08:43:55.490540 [debug] [Thread-3 (]: Began compiling node model.citrus_trade.growth_score
[0m08:43:55.497287 [debug] [Thread-3 (]: Writing injected SQL for node "model.citrus_trade.growth_score"
[0m08:43:55.499114 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.747 seconds
[0m08:43:55.501982 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9e4eb8d7-8c01-4c58-971b-80136909ec6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad3f8410>]}
[0m08:43:55.502853 [info ] [Thread-1 (]: 4 of 8 OK created sql table model marts.imports_exports_2020 ................... [[32mSUCCESS 1[0m in 0.76s]
[0m08:43:55.503518 [debug] [Thread-1 (]: Finished running node model.citrus_trade.imports_exports_2020
[0m08:43:55.504381 [debug] [Thread-2 (]: Began running node model.citrus_trade.score_2020
[0m08:43:55.505008 [info ] [Thread-2 (]: 6 of 8 START sql table model marts.score_2020 .................................. [RUN]
[0m08:43:55.505534 [debug] [Thread-3 (]: Began executing node model.citrus_trade.growth_score
[0m08:43:55.506009 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.citrus_trade.imports_by_year, now model.citrus_trade.score_2020)
[0m08:43:55.510740 [debug] [Thread-2 (]: Began compiling node model.citrus_trade.score_2020
[0m08:43:55.510002 [debug] [Thread-3 (]: Writing runtime sql for node "model.citrus_trade.growth_score"
[0m08:43:55.514157 [debug] [Thread-2 (]: Writing injected SQL for node "model.citrus_trade.score_2020"
[0m08:43:55.518959 [debug] [Thread-3 (]: Using snowflake connection "model.citrus_trade.growth_score"
[0m08:43:55.519580 [debug] [Thread-3 (]: On model.citrus_trade.growth_score: create or replace transient table TRADE_FLOW.marts.growth_score
    
    
    
    as (with 
    previous_year AS (
        select 
            declarant_iso,
            year,
            lag(total_value,1) over(partition by declarant_iso order by year) previous_year_value,
            total_value,
            first_value(total_value) over(partition by declarant_iso order by year) as first_year_value,
            last_value(total_value) over(partition by declarant_iso order by year) as last_year_value
        from TRADE_FLOW.marts.imports_by_year
    ),
    growth_speed AS (
        select 
            declarant_iso,
            year,
            first_year_value,
            last_year_value,
            last_year_value/nullif(first_year_value,0) as growth_overall,
            previous_year_value,
            total_value,
            (total_value - previous_year_value)/total_value * 100 as growth_speed 
        from previous_year
    ),
    previous_year_growth_speed AS (
        select 
            declarant_iso,
            year,
            first_year_value,
            last_year_value,
            growth_overall,
            previous_year_value,
            total_value as current_value,
            growth_speed,
            lag(growth_speed,1) over(partition by declarant_iso order by year) previous_year_growth_speed,
        from growth_speed
        order by 1,2
    ),
    base AS (
        select 
            declarant_iso,
            year,
            first_year_value,
            last_year_value,
            growth_overall,
            previous_year_value,
            current_value,
            previous_year_growth_speed,
            growth_speed,
            growth_speed - previous_year_growth_speed as growth_acceleration,
            avg(growth_acceleration) over(partition by declarant_iso) as avg_acceleration
        from previous_year_growth_speed
    ),
    ok as (
        select 
            declarant_iso,
            year,
            first_year_value,
            last_year_value,
            growth_overall,
            (growth_overall - min(growth_overall) OVER())/(max(growth_overall) OVER() - min(growth_overall) OVER()) as growth_overall_norm,
            previous_year_value,
            current_value,
            -- previous_year_growth_speed,
            growth_speed,
            growth_acceleration,
            avg_acceleration,
            (avg_acceleration - min(avg_acceleration) OVER())/(max(avg_acceleration) OVER() - min(avg_acceleration) OVER()) as avg_acceleration_norm
        from base 
    )
    select 
        distinct 
        declarant_iso,
        year,
        current_value,
        growth_speed,
        growth_acceleration,
        growth_overall,
        growth_overall_norm,
        avg_acceleration,
        avg_acceleration_norm,
        growth_overall_norm * avg_acceleration_norm as growth_score
    from ok
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.growth_score"} */;
[0m08:43:55.520093 [debug] [Thread-2 (]: Began executing node model.citrus_trade.score_2020
[0m08:43:55.524691 [debug] [Thread-2 (]: Writing runtime sql for node "model.citrus_trade.score_2020"
[0m08:43:55.526164 [debug] [Thread-2 (]: Using snowflake connection "model.citrus_trade.score_2020"
[0m08:43:55.526459 [debug] [Thread-2 (]: On model.citrus_trade.score_2020: create or replace transient table TRADE_FLOW.marts.score_2020
    
    
    
    as (select distinct 
    declarant_iso,
    total_value,
    total_quantity,
    value_per_quantity,
    (total_value - min(total_value) over())/((max(total_value) over())-(min(total_value) over())) as value_score,
    (total_quantity - min(total_quantity) over())/((max(total_quantity) over())-(min(total_quantity) over())) as quantity_score,
    (value_per_quantity - min(value_per_quantity) over())/((max(value_per_quantity) over())-(min(value_per_quantity) over())) as price_score
from TRADE_FLOW.marts.imports_exports_2020
where flow = 1
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.score_2020"} */;
[0m08:43:56.294993 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.768 seconds
[0m08:43:56.300873 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9e4eb8d7-8c01-4c58-971b-80136909ec6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad12f920>]}
[0m08:43:56.302549 [info ] [Thread-2 (]: 6 of 8 OK created sql table model marts.score_2020 ............................. [[32mSUCCESS 1[0m in 0.79s]
[0m08:43:56.304042 [debug] [Thread-2 (]: Finished running node model.citrus_trade.score_2020
[0m08:43:56.327090 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.806 seconds
[0m08:43:56.330426 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9e4eb8d7-8c01-4c58-971b-80136909ec6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad2a44d0>]}
[0m08:43:56.331536 [info ] [Thread-3 (]: 5 of 8 OK created sql table model marts.growth_score ........................... [[32mSUCCESS 1[0m in 0.84s]
[0m08:43:56.332554 [debug] [Thread-3 (]: Finished running node model.citrus_trade.growth_score
[0m08:43:56.334159 [debug] [Thread-1 (]: Began running node model.citrus_trade.importer_score
[0m08:43:56.334954 [info ] [Thread-1 (]: 7 of 8 START sql table model marts.importer_score .............................. [RUN]
[0m08:43:56.335758 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.citrus_trade.imports_exports_2020, now model.citrus_trade.importer_score)
[0m08:43:56.336429 [debug] [Thread-1 (]: Began compiling node model.citrus_trade.importer_score
[0m08:43:56.344063 [debug] [Thread-1 (]: Writing injected SQL for node "model.citrus_trade.importer_score"
[0m08:43:56.346043 [debug] [Thread-1 (]: Began executing node model.citrus_trade.importer_score
[0m08:43:56.349652 [debug] [Thread-1 (]: Writing runtime sql for node "model.citrus_trade.importer_score"
[0m08:43:56.351561 [debug] [Thread-1 (]: Using snowflake connection "model.citrus_trade.importer_score"
[0m08:43:56.352104 [debug] [Thread-1 (]: On model.citrus_trade.importer_score: create or replace transient table TRADE_FLOW.marts.importer_score
    
    
    
    as (select distinct
    sc.declarant_iso,
    sc.total_value as revenue_total,
    sc.total_quantity as volume_total,
    sc.value_per_quantity as rate_avg,
    sc.value_score as revenue_score,
    sc.quantity_score as volume_score,
    sc.price_score as rate_score,
    gs.growth_score
from TRADE_FLOW.marts.score_2020 as sc
inner join TRADE_FLOW.marts.growth_score as gs
    on gs.declarant_iso = sc.declarant_iso
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.importer_score"} */;
[0m08:43:57.070015 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.717 seconds
[0m08:43:57.071968 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9e4eb8d7-8c01-4c58-971b-80136909ec6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad3dcc20>]}
[0m08:43:57.072472 [info ] [Thread-1 (]: 7 of 8 OK created sql table model marts.importer_score ......................... [[32mSUCCESS 1[0m in 0.74s]
[0m08:43:57.072995 [debug] [Thread-1 (]: Finished running node model.citrus_trade.importer_score
[0m08:43:57.073778 [debug] [Thread-2 (]: Began running node model.citrus_trade.viz_importer_score
[0m08:43:57.074175 [info ] [Thread-2 (]: 8 of 8 START sql table model analytics.viz_importer_score ...................... [RUN]
[0m08:43:57.074480 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.citrus_trade.score_2020, now model.citrus_trade.viz_importer_score)
[0m08:43:57.074891 [debug] [Thread-2 (]: Began compiling node model.citrus_trade.viz_importer_score
[0m08:43:57.077354 [debug] [Thread-2 (]: Writing injected SQL for node "model.citrus_trade.viz_importer_score"
[0m08:43:57.078153 [debug] [Thread-2 (]: Began executing node model.citrus_trade.viz_importer_score
[0m08:43:57.079954 [debug] [Thread-2 (]: Writing runtime sql for node "model.citrus_trade.viz_importer_score"
[0m08:43:57.081169 [debug] [Thread-2 (]: Using snowflake connection "model.citrus_trade.viz_importer_score"
[0m08:43:57.081399 [debug] [Thread-2 (]: On model.citrus_trade.viz_importer_score: create or replace transient table TRADE_FLOW.analytics.viz_importer_score
    
    
    
    as (with 
    scores as (
        select 
            declarant_iso,
            score_type,
            score
        from TRADE_FLOW.marts.importer_score
        unpivot (
            score for score_type in (
                revenue_score as "revenue",
                volume_score as "volume",
                rate_score as "rate",
                growth_score as "growth"
            )
        )
    ),
    metrics as (
        select 
            declarant_iso,
            metric_type,
            metric
        from TRADE_FLOW.marts.importer_score
        unpivot (
            metric for metric_type in (
                revenue_total as "revenue",
                volume_score as "volume",
                rate_score as "rate"
            )
        )
    )
select 
    s.declarant_iso,
    s.score_type,
    s.score,
    m.metric
from scores as s
left join metrics as m
    on s.declarant_iso = m.declarant_iso
    and s.score_type = m.metric_type
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.viz_importer_score"} */;
[0m08:43:57.701581 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.620 seconds
[0m08:43:57.704628 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9e4eb8d7-8c01-4c58-971b-80136909ec6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad146240>]}
[0m08:43:57.705451 [info ] [Thread-2 (]: 8 of 8 OK created sql table model analytics.viz_importer_score ................. [[32mSUCCESS 1[0m in 0.63s]
[0m08:43:57.706057 [debug] [Thread-2 (]: Finished running node model.citrus_trade.viz_importer_score
[0m08:43:57.709078 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:43:57.709487 [debug] [MainThread]: Connection 'model.citrus_trade.viz_importer_score' was left open.
[0m08:43:57.709808 [debug] [MainThread]: On model.citrus_trade.viz_importer_score: Close
[0m08:43:57.833466 [debug] [MainThread]: Connection 'model.citrus_trade.importer_score' was left open.
[0m08:43:57.833870 [debug] [MainThread]: On model.citrus_trade.importer_score: Close
[0m08:43:57.934380 [debug] [MainThread]: Connection 'model.citrus_trade.growth_score' was left open.
[0m08:43:57.934819 [debug] [MainThread]: On model.citrus_trade.growth_score: Close
[0m08:43:58.028156 [info ] [MainThread]: 
[0m08:43:58.028763 [info ] [MainThread]: Finished running 8 table models in 0 hours 0 minutes and 5.52 seconds (5.52s).
[0m08:43:58.030407 [debug] [MainThread]: Command end result
[0m08:43:58.073970 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m08:43:58.077728 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m08:43:58.086397 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/target/run_results.json
[0m08:43:58.086652 [info ] [MainThread]: 
[0m08:43:58.087059 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:43:58.087368 [info ] [MainThread]: 
[0m08:43:58.087887 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=8
[0m08:43:58.091429 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.1836042, "process_in_blocks": "0", "process_kernel_time": 0.480327, "process_mem_max_rss": "148780", "process_out_blocks": "2905", "process_user_time": 1.784931}
[0m08:43:58.093007 [debug] [MainThread]: Command `dbt run` succeeded at 08:43:58.092829 after 6.19 seconds
[0m08:43:58.093914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5ba28a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1572c60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf7bc9b0>]}
[0m08:43:58.094280 [debug] [MainThread]: Flushing usage events
[0m08:43:58.776501 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:44:18.503328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff801c0770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7eb735c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff801c03b0>]}


============================== 08:44:18.508606 | b4892a58-d77e-46c1-ab62-b5b11aab2ad7 ==============================
[0m08:44:18.508606 [info ] [MainThread]: Running with dbt=1.10.13
[0m08:44:18.509021 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'cache_selected_only': 'False', 'version_check': 'True', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'log_format': 'default', 'indirect_selection': 'eager', 'use_colors': 'True', 'no_print': 'None', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/opt/airflow/dbt', 'printer_width': '80', 'fail_fast': 'False', 'invocation_command': 'dbt run', 'introspect': 'True', 'log_cache_events': 'False', 'quiet': 'False', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'empty': 'False', 'use_experimental_parser': 'False', 'partial_parse': 'True'}
[0m08:44:18.704841 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m08:44:18.705367 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m08:44:18.705561 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m08:44:18.799316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b4892a58-d77e-46c1-ab62-b5b11aab2ad7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d207170>]}
[0m08:44:18.830845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b4892a58-d77e-46c1-ab62-b5b11aab2ad7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e4d7200>]}
[0m08:44:18.831381 [info ] [MainThread]: Registered adapter: snowflake=1.10.3
[0m08:44:18.884468 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m08:44:19.008154 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m08:44:19.008590 [debug] [MainThread]: Partial parsing: updated file: citrus_trade://models/analytics/viz_importer_score.sql
[0m08:44:19.145395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b4892a58-d77e-46c1-ab62-b5b11aab2ad7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d32f230>]}
[0m08:44:19.202041 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m08:44:19.203822 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m08:44:19.214816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b4892a58-d77e-46c1-ab62-b5b11aab2ad7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c574710>]}
[0m08:44:19.215196 [info ] [MainThread]: Found 8 models, 3 sources, 636 macros
[0m08:44:19.215450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b4892a58-d77e-46c1-ab62-b5b11aab2ad7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c90d820>]}
[0m08:44:19.216638 [info ] [MainThread]: 
[0m08:44:19.216887 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:44:19.217106 [info ] [MainThread]: 
[0m08:44:19.217499 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m08:44:19.220212 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRADE_FLOW'
[0m08:44:19.227278 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRADE_FLOW'
[0m08:44:19.233711 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRADE_FLOW'
[0m08:44:19.259305 [debug] [ThreadPool]: Using snowflake connection "list_TRADE_FLOW"
[0m08:44:19.259639 [debug] [ThreadPool]: Using snowflake connection "list_TRADE_FLOW"
[0m08:44:19.259866 [debug] [ThreadPool]: Using snowflake connection "list_TRADE_FLOW"
[0m08:44:19.260018 [debug] [ThreadPool]: On list_TRADE_FLOW: show terse schemas in database TRADE_FLOW
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRADE_FLOW"} */
[0m08:44:19.260272 [debug] [ThreadPool]: On list_TRADE_FLOW: show terse schemas in database TRADE_FLOW
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRADE_FLOW"} */
[0m08:44:19.260496 [debug] [ThreadPool]: On list_TRADE_FLOW: show terse schemas in database TRADE_FLOW
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRADE_FLOW"} */
[0m08:44:19.260708 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:44:19.260913 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:44:19.261117 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:44:20.004536 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.743 seconds
[0m08:44:20.010638 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.749 seconds
[0m08:44:20.021053 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.760 seconds
[0m08:44:20.023611 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRADE_FLOW, now list_TRADE_FLOW_staging)
[0m08:44:20.029656 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRADE_FLOW, now list_TRADE_FLOW_marts)
[0m08:44:20.036854 [debug] [ThreadPool]: Using snowflake connection "list_TRADE_FLOW_marts"
[0m08:44:20.035045 [debug] [ThreadPool]: Using snowflake connection "list_TRADE_FLOW_staging"
[0m08:44:20.037424 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRADE_FLOW, now list_TRADE_FLOW_analytics)
[0m08:44:20.037623 [debug] [ThreadPool]: On list_TRADE_FLOW_marts: show objects in TRADE_FLOW.marts
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRADE_FLOW_marts"} */;
[0m08:44:20.037915 [debug] [ThreadPool]: On list_TRADE_FLOW_staging: show objects in TRADE_FLOW.staging
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRADE_FLOW_staging"} */;
[0m08:44:20.039428 [debug] [ThreadPool]: Using snowflake connection "list_TRADE_FLOW_analytics"
[0m08:44:20.041661 [debug] [ThreadPool]: On list_TRADE_FLOW_analytics: show objects in TRADE_FLOW.analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRADE_FLOW_analytics"} */;
[0m08:44:20.117489 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 0.078 seconds
[0m08:44:20.123871 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.082 seconds
[0m08:44:20.124902 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.084 seconds
[0m08:44:20.129788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b4892a58-d77e-46c1-ab62-b5b11aab2ad7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7caf1a60>]}
[0m08:44:20.133924 [debug] [Thread-1 (]: Began running node model.citrus_trade.stg_trade
[0m08:44:20.134574 [info ] [Thread-1 (]: 1 of 8 START sql table model staging.stg_trade ................................. [RUN]
[0m08:44:20.135313 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_TRADE_FLOW_staging, now model.citrus_trade.stg_trade)
[0m08:44:20.135859 [debug] [Thread-1 (]: Began compiling node model.citrus_trade.stg_trade
[0m08:44:20.151405 [debug] [Thread-1 (]: Writing injected SQL for node "model.citrus_trade.stg_trade"
[0m08:44:20.153403 [debug] [Thread-1 (]: Began executing node model.citrus_trade.stg_trade
[0m08:44:20.179536 [debug] [Thread-1 (]: Writing runtime sql for node "model.citrus_trade.stg_trade"
[0m08:44:20.181013 [debug] [Thread-1 (]: Using snowflake connection "model.citrus_trade.stg_trade"
[0m08:44:20.181275 [debug] [Thread-1 (]: On model.citrus_trade.stg_trade: create or replace transient table TRADE_FLOW.staging.stg_trade
    
    
    
    as (select
  value:DECLARANT::int as declarant,
  value:DECLARANT_ISO::string as declarant_iso,
  value:PARTNER::string as partner,
  value:PARTNER_ISO::string as partner_iso,
  value:FLOW::int as flow,
  value:TRANSPORT_MODE::int as transport_mode,
  value:PERIOD::int as period,
  year(to_date(left(period,4),'YYYY')) as year,
  value:HS4::string as hs4,
  value:HS4_NAME::string as hs4_name,
  value:HS6::string as hs6,
  value:HS6_NAME::string as hs6_name,
  value:VALUE_IN_EUROS::float as value_in_euros,
  value:QUANTITY_IN_KG::float as quantity_in_kg
from trade_flow.raw.raw_trhs
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.stg_trade"} */;
[0m08:44:20.978296 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.795 seconds
[0m08:44:21.014847 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b4892a58-d77e-46c1-ab62-b5b11aab2ad7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80be1be0>]}
[0m08:44:21.016039 [info ] [Thread-1 (]: 1 of 8 OK created sql table model staging.stg_trade ............................ [[32mSUCCESS 1[0m in 0.88s]
[0m08:44:21.017107 [debug] [Thread-1 (]: Finished running node model.citrus_trade.stg_trade
[0m08:44:21.018658 [debug] [Thread-3 (]: Began running node model.citrus_trade.trade_by_hs
[0m08:44:21.019197 [info ] [Thread-3 (]: 2 of 8 START sql table model marts.trade_by_hs ................................. [RUN]
[0m08:44:21.019758 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_TRADE_FLOW_marts, now model.citrus_trade.trade_by_hs)
[0m08:44:21.020322 [debug] [Thread-3 (]: Began compiling node model.citrus_trade.trade_by_hs
[0m08:44:21.023693 [debug] [Thread-3 (]: Writing injected SQL for node "model.citrus_trade.trade_by_hs"
[0m08:44:21.025012 [debug] [Thread-3 (]: Began executing node model.citrus_trade.trade_by_hs
[0m08:44:21.029481 [debug] [Thread-3 (]: Writing runtime sql for node "model.citrus_trade.trade_by_hs"
[0m08:44:21.030654 [debug] [Thread-3 (]: Using snowflake connection "model.citrus_trade.trade_by_hs"
[0m08:44:21.030960 [debug] [Thread-3 (]: On model.citrus_trade.trade_by_hs: create or replace transient table TRADE_FLOW.marts.trade_by_hs
    
    
    
    as (select
    *
from TRADE_FLOW.staging.stg_trade
where hs6 = '080510'
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.trade_by_hs"} */;
[0m08:44:21.791600 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.760 seconds
[0m08:44:21.795299 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b4892a58-d77e-46c1-ab62-b5b11aab2ad7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff76f78440>]}
[0m08:44:21.796128 [info ] [Thread-3 (]: 2 of 8 OK created sql table model marts.trade_by_hs ............................ [[32mSUCCESS 1[0m in 0.78s]
[0m08:44:21.797126 [debug] [Thread-3 (]: Finished running node model.citrus_trade.trade_by_hs
[0m08:44:21.798225 [debug] [Thread-2 (]: Began running node model.citrus_trade.imports_by_year
[0m08:44:21.799133 [info ] [Thread-2 (]: 3 of 8 START sql table model marts.imports_by_year ............................. [RUN]
[0m08:44:21.798661 [debug] [Thread-1 (]: Began running node model.citrus_trade.imports_exports_2020
[0m08:44:21.801023 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_TRADE_FLOW_analytics, now model.citrus_trade.imports_by_year)
[0m08:44:21.802505 [info ] [Thread-1 (]: 4 of 8 START sql table model marts.imports_exports_2020 ........................ [RUN]
[0m08:44:21.807728 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.citrus_trade.stg_trade, now model.citrus_trade.imports_exports_2020)
[0m08:44:21.808794 [debug] [Thread-1 (]: Began compiling node model.citrus_trade.imports_exports_2020
[0m08:44:21.806126 [debug] [Thread-2 (]: Began compiling node model.citrus_trade.imports_by_year
[0m08:44:21.813053 [debug] [Thread-1 (]: Writing injected SQL for node "model.citrus_trade.imports_exports_2020"
[0m08:44:21.817947 [debug] [Thread-2 (]: Writing injected SQL for node "model.citrus_trade.imports_by_year"
[0m08:44:21.820667 [debug] [Thread-1 (]: Began executing node model.citrus_trade.imports_exports_2020
[0m08:44:21.824620 [debug] [Thread-1 (]: Writing runtime sql for node "model.citrus_trade.imports_exports_2020"
[0m08:44:21.825064 [debug] [Thread-2 (]: Began executing node model.citrus_trade.imports_by_year
[0m08:44:21.827895 [debug] [Thread-2 (]: Writing runtime sql for node "model.citrus_trade.imports_by_year"
[0m08:44:21.835322 [debug] [Thread-1 (]: Using snowflake connection "model.citrus_trade.imports_exports_2020"
[0m08:44:21.838701 [debug] [Thread-1 (]: On model.citrus_trade.imports_exports_2020: create or replace transient table TRADE_FLOW.marts.imports_exports_2020
    
    
    
    as (select
    declarant_iso,
    flow,
    sum(value_in_euros) over(partition by declarant_iso, flow) as total_value,
    sum(quantity_in_kg) over(partition by declarant_iso, flow) as total_quantity,
    total_value/nullif(total_quantity,0) as value_per_quantity
from TRADE_FLOW.marts.trade_by_hs
where year = 2020
group by 
    declarant_iso,
    flow,
    value_in_euros,
    quantity_in_kg
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.imports_exports_2020"} */;
[0m08:44:21.840441 [debug] [Thread-2 (]: Using snowflake connection "model.citrus_trade.imports_by_year"
[0m08:44:21.843483 [debug] [Thread-2 (]: On model.citrus_trade.imports_by_year: create or replace transient table TRADE_FLOW.marts.imports_by_year
    
    
    
    as (select
    declarant_iso,
    year,
    sum(value_in_euros) as total_value,
    sum(quantity_in_kg) as total_quantity,
    total_value/nullif(total_quantity,0) as value_per_quantity
from TRADE_FLOW.marts.trade_by_hs
where flow = 1
group by 1,2
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.imports_by_year"} */;
[0m08:44:22.716881 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.872 seconds
[0m08:44:22.719584 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.879 seconds
[0m08:44:22.724870 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b4892a58-d77e-46c1-ab62-b5b11aab2ad7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7738e360>]}
[0m08:44:22.728066 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b4892a58-d77e-46c1-ab62-b5b11aab2ad7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff777e22a0>]}
[0m08:44:22.729625 [info ] [Thread-2 (]: 3 of 8 OK created sql table model marts.imports_by_year ........................ [[32mSUCCESS 1[0m in 0.92s]
[0m08:44:22.731800 [debug] [Thread-2 (]: Finished running node model.citrus_trade.imports_by_year
[0m08:44:22.730716 [info ] [Thread-1 (]: 4 of 8 OK created sql table model marts.imports_exports_2020 ................... [[32mSUCCESS 1[0m in 0.92s]
[0m08:44:22.733147 [debug] [Thread-1 (]: Finished running node model.citrus_trade.imports_exports_2020
[0m08:44:22.733701 [debug] [Thread-3 (]: Began running node model.citrus_trade.growth_score
[0m08:44:22.734627 [info ] [Thread-3 (]: 5 of 8 START sql table model marts.growth_score ................................ [RUN]
[0m08:44:22.735382 [debug] [Thread-2 (]: Began running node model.citrus_trade.score_2020
[0m08:44:22.736076 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.citrus_trade.trade_by_hs, now model.citrus_trade.growth_score)
[0m08:44:22.736831 [info ] [Thread-2 (]: 6 of 8 START sql table model marts.score_2020 .................................. [RUN]
[0m08:44:22.737562 [debug] [Thread-3 (]: Began compiling node model.citrus_trade.growth_score
[0m08:44:22.738150 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.citrus_trade.imports_by_year, now model.citrus_trade.score_2020)
[0m08:44:22.743598 [debug] [Thread-3 (]: Writing injected SQL for node "model.citrus_trade.growth_score"
[0m08:44:22.744272 [debug] [Thread-2 (]: Began compiling node model.citrus_trade.score_2020
[0m08:44:22.748645 [debug] [Thread-2 (]: Writing injected SQL for node "model.citrus_trade.score_2020"
[0m08:44:22.750054 [debug] [Thread-3 (]: Began executing node model.citrus_trade.growth_score
[0m08:44:22.754109 [debug] [Thread-3 (]: Writing runtime sql for node "model.citrus_trade.growth_score"
[0m08:44:22.754893 [debug] [Thread-2 (]: Began executing node model.citrus_trade.score_2020
[0m08:44:22.758100 [debug] [Thread-2 (]: Writing runtime sql for node "model.citrus_trade.score_2020"
[0m08:44:22.763465 [debug] [Thread-3 (]: Using snowflake connection "model.citrus_trade.growth_score"
[0m08:44:22.764722 [debug] [Thread-2 (]: Using snowflake connection "model.citrus_trade.score_2020"
[0m08:44:22.765712 [debug] [Thread-2 (]: On model.citrus_trade.score_2020: create or replace transient table TRADE_FLOW.marts.score_2020
    
    
    
    as (select distinct 
    declarant_iso,
    total_value,
    total_quantity,
    value_per_quantity,
    (total_value - min(total_value) over())/((max(total_value) over())-(min(total_value) over())) as value_score,
    (total_quantity - min(total_quantity) over())/((max(total_quantity) over())-(min(total_quantity) over())) as quantity_score,
    (value_per_quantity - min(value_per_quantity) over())/((max(value_per_quantity) over())-(min(value_per_quantity) over())) as price_score
from TRADE_FLOW.marts.imports_exports_2020
where flow = 1
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.score_2020"} */;
[0m08:44:22.765152 [debug] [Thread-3 (]: On model.citrus_trade.growth_score: create or replace transient table TRADE_FLOW.marts.growth_score
    
    
    
    as (with 
    previous_year AS (
        select 
            declarant_iso,
            year,
            lag(total_value,1) over(partition by declarant_iso order by year) previous_year_value,
            total_value,
            first_value(total_value) over(partition by declarant_iso order by year) as first_year_value,
            last_value(total_value) over(partition by declarant_iso order by year) as last_year_value
        from TRADE_FLOW.marts.imports_by_year
    ),
    growth_speed AS (
        select 
            declarant_iso,
            year,
            first_year_value,
            last_year_value,
            last_year_value/nullif(first_year_value,0) as growth_overall,
            previous_year_value,
            total_value,
            (total_value - previous_year_value)/total_value * 100 as growth_speed 
        from previous_year
    ),
    previous_year_growth_speed AS (
        select 
            declarant_iso,
            year,
            first_year_value,
            last_year_value,
            growth_overall,
            previous_year_value,
            total_value as current_value,
            growth_speed,
            lag(growth_speed,1) over(partition by declarant_iso order by year) previous_year_growth_speed,
        from growth_speed
        order by 1,2
    ),
    base AS (
        select 
            declarant_iso,
            year,
            first_year_value,
            last_year_value,
            growth_overall,
            previous_year_value,
            current_value,
            previous_year_growth_speed,
            growth_speed,
            growth_speed - previous_year_growth_speed as growth_acceleration,
            avg(growth_acceleration) over(partition by declarant_iso) as avg_acceleration
        from previous_year_growth_speed
    ),
    ok as (
        select 
            declarant_iso,
            year,
            first_year_value,
            last_year_value,
            growth_overall,
            (growth_overall - min(growth_overall) OVER())/(max(growth_overall) OVER() - min(growth_overall) OVER()) as growth_overall_norm,
            previous_year_value,
            current_value,
            -- previous_year_growth_speed,
            growth_speed,
            growth_acceleration,
            avg_acceleration,
            (avg_acceleration - min(avg_acceleration) OVER())/(max(avg_acceleration) OVER() - min(avg_acceleration) OVER()) as avg_acceleration_norm
        from base 
    )
    select 
        distinct 
        declarant_iso,
        year,
        current_value,
        growth_speed,
        growth_acceleration,
        growth_overall,
        growth_overall_norm,
        avg_acceleration,
        avg_acceleration_norm,
        growth_overall_norm * avg_acceleration_norm as growth_score
    from ok
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.growth_score"} */;
[0m08:44:23.641100 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.873 seconds
[0m08:44:23.645399 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.879 seconds
[0m08:44:23.653285 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b4892a58-d77e-46c1-ab62-b5b11aab2ad7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff76fb8740>]}
[0m08:44:23.655864 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b4892a58-d77e-46c1-ab62-b5b11aab2ad7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff76f94e00>]}
[0m08:44:23.656738 [info ] [Thread-3 (]: 5 of 8 OK created sql table model marts.growth_score ........................... [[32mSUCCESS 1[0m in 0.92s]
[0m08:44:23.657996 [info ] [Thread-2 (]: 6 of 8 OK created sql table model marts.score_2020 ............................. [[32mSUCCESS 1[0m in 0.92s]
[0m08:44:23.659985 [debug] [Thread-2 (]: Finished running node model.citrus_trade.score_2020
[0m08:44:23.659103 [debug] [Thread-3 (]: Finished running node model.citrus_trade.growth_score
[0m08:44:23.661683 [debug] [Thread-4 (]: Began running node model.citrus_trade.importer_score
[0m08:44:23.664370 [info ] [Thread-4 (]: 7 of 8 START sql table model marts.importer_score .............................. [RUN]
[0m08:44:23.665451 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.citrus_trade.importer_score'
[0m08:44:23.666087 [debug] [Thread-4 (]: Began compiling node model.citrus_trade.importer_score
[0m08:44:23.671533 [debug] [Thread-4 (]: Writing injected SQL for node "model.citrus_trade.importer_score"
[0m08:44:23.673679 [debug] [Thread-4 (]: Began executing node model.citrus_trade.importer_score
[0m08:44:23.677079 [debug] [Thread-4 (]: Writing runtime sql for node "model.citrus_trade.importer_score"
[0m08:44:23.678786 [debug] [Thread-4 (]: Using snowflake connection "model.citrus_trade.importer_score"
[0m08:44:23.679220 [debug] [Thread-4 (]: On model.citrus_trade.importer_score: create or replace transient table TRADE_FLOW.marts.importer_score
    
    
    
    as (select distinct
    sc.declarant_iso,
    sc.total_value as revenue_total,
    sc.total_quantity as volume_total,
    sc.value_per_quantity as rate_avg,
    sc.value_score as revenue_score,
    sc.quantity_score as volume_score,
    sc.price_score as rate_score,
    gs.growth_score
from TRADE_FLOW.marts.score_2020 as sc
inner join TRADE_FLOW.marts.growth_score as gs
    on gs.declarant_iso = sc.declarant_iso
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.importer_score"} */;
[0m08:44:23.679602 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m08:44:24.761308 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.081 seconds
[0m08:44:24.766697 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b4892a58-d77e-46c1-ab62-b5b11aab2ad7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff76f787d0>]}
[0m08:44:24.768139 [info ] [Thread-4 (]: 7 of 8 OK created sql table model marts.importer_score ......................... [[32mSUCCESS 1[0m in 1.10s]
[0m08:44:24.769477 [debug] [Thread-4 (]: Finished running node model.citrus_trade.importer_score
[0m08:44:24.771247 [debug] [Thread-2 (]: Began running node model.citrus_trade.viz_importer_score
[0m08:44:24.772431 [info ] [Thread-2 (]: 8 of 8 START sql table model analytics.viz_importer_score ...................... [RUN]
[0m08:44:24.773411 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.citrus_trade.score_2020, now model.citrus_trade.viz_importer_score)
[0m08:44:24.774090 [debug] [Thread-2 (]: Began compiling node model.citrus_trade.viz_importer_score
[0m08:44:24.781500 [debug] [Thread-2 (]: Writing injected SQL for node "model.citrus_trade.viz_importer_score"
[0m08:44:24.783403 [debug] [Thread-2 (]: Began executing node model.citrus_trade.viz_importer_score
[0m08:44:24.787686 [debug] [Thread-2 (]: Writing runtime sql for node "model.citrus_trade.viz_importer_score"
[0m08:44:24.790003 [debug] [Thread-2 (]: Using snowflake connection "model.citrus_trade.viz_importer_score"
[0m08:44:24.790467 [debug] [Thread-2 (]: On model.citrus_trade.viz_importer_score: create or replace transient table TRADE_FLOW.analytics.viz_importer_score
    
    
    
    as (with 
    scores as (
        select 
            declarant_iso,
            score_type,
            score
        from TRADE_FLOW.marts.importer_score
        unpivot (
            score for score_type in (
                revenue_score as "revenue",
                volume_score as "volume",
                rate_score as "rate",
                growth_score as "growth"
            )
        )
    ),
    metrics as (
        select 
            declarant_iso,
            metric_type,
            metric
        from TRADE_FLOW.marts.importer_score
        unpivot (
            metric for metric_type in (
                revenue_total as "revenue",
                volume_total as "volume",
                rate_avg as "rate"
            )
        )
    )
select 
    s.declarant_iso,
    s.score_type,
    s.score,
    m.metric
from scores as s
left join metrics as m
    on s.declarant_iso = m.declarant_iso
    and s.score_type = m.metric_type
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.viz_importer_score"} */;
[0m08:44:25.475522 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.685 seconds
[0m08:44:25.477628 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b4892a58-d77e-46c1-ab62-b5b11aab2ad7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff77382b70>]}
[0m08:44:25.478281 [info ] [Thread-2 (]: 8 of 8 OK created sql table model analytics.viz_importer_score ................. [[32mSUCCESS 1[0m in 0.70s]
[0m08:44:25.478860 [debug] [Thread-2 (]: Finished running node model.citrus_trade.viz_importer_score
[0m08:44:25.481852 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:44:25.482234 [debug] [MainThread]: Connection 'model.citrus_trade.imports_exports_2020' was left open.
[0m08:44:25.482485 [debug] [MainThread]: On model.citrus_trade.imports_exports_2020: Close
[0m08:44:25.574741 [debug] [MainThread]: Connection 'model.citrus_trade.viz_importer_score' was left open.
[0m08:44:25.575251 [debug] [MainThread]: On model.citrus_trade.viz_importer_score: Close
[0m08:44:25.748259 [debug] [MainThread]: Connection 'model.citrus_trade.growth_score' was left open.
[0m08:44:25.749630 [debug] [MainThread]: On model.citrus_trade.growth_score: Close
[0m08:44:25.869175 [debug] [MainThread]: Connection 'model.citrus_trade.importer_score' was left open.
[0m08:44:25.870291 [debug] [MainThread]: On model.citrus_trade.importer_score: Close
[0m08:44:25.973648 [info ] [MainThread]: 
[0m08:44:25.974792 [info ] [MainThread]: Finished running 8 table models in 0 hours 0 minutes and 6.76 seconds (6.76s).
[0m08:44:25.978218 [debug] [MainThread]: Command end result
[0m08:44:26.044680 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m08:44:26.047225 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m08:44:26.052651 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/target/run_results.json
[0m08:44:26.052839 [info ] [MainThread]: 
[0m08:44:26.053083 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:44:26.053433 [info ] [MainThread]: 
[0m08:44:26.053851 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=8
[0m08:44:26.055566 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.590878, "process_in_blocks": "0", "process_kernel_time": 0.530517, "process_mem_max_rss": "153656", "process_out_blocks": "4299", "process_user_time": 1.993736}
[0m08:44:26.056133 [debug] [MainThread]: Command `dbt run` succeeded at 08:44:26.056036 after 7.59 seconds
[0m08:44:26.056650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7eb44bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7eba29f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f2f5340>]}
[0m08:44:26.057110 [debug] [MainThread]: Flushing usage events
[0m08:44:26.653826 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:24:02.192484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9090590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaae8da90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8f16270>]}


============================== 11:24:02.202649 | 408645e1-962b-4708-b5e3-6747ca33c57b ==============================
[0m11:24:02.202649 [info ] [MainThread]: Running with dbt=1.10.13
[0m11:24:02.203079 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'printer_width': '80', 'write_json': 'True', 'use_colors': 'True', 'log_format': 'default', 'static_parser': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'no_print': 'None', 'version_check': 'True', 'empty': 'False', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'debug': 'False', 'target_path': 'None', 'indirect_selection': 'eager', 'introspect': 'True', 'profiles_dir': '/opt/airflow/dbt', 'quiet': 'False', 'invocation_command': 'dbt run', 'cache_selected_only': 'False'}
[0m11:24:02.447309 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m11:24:02.447687 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m11:24:02.447865 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m11:24:02.546287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '408645e1-962b-4708-b5e3-6747ca33c57b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8334830>]}
[0m11:24:02.587187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '408645e1-962b-4708-b5e3-6747ca33c57b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6c62b10>]}
[0m11:24:02.587872 [info ] [MainThread]: Registered adapter: snowflake=1.10.3
[0m11:24:02.656193 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m11:24:02.791631 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:24:02.792095 [debug] [MainThread]: Partial parsing: updated file: citrus_trade://models/analytics/viz_importer_score.sql
[0m11:24:02.923518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '408645e1-962b-4708-b5e3-6747ca33c57b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6a7ea50>]}
[0m11:24:02.981950 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m11:24:02.983985 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m11:24:03.005387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '408645e1-962b-4708-b5e3-6747ca33c57b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa66cc5c0>]}
[0m11:24:03.005761 [info ] [MainThread]: Found 8 models, 3 sources, 636 macros
[0m11:24:03.006026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '408645e1-962b-4708-b5e3-6747ca33c57b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa699d790>]}
[0m11:24:03.007284 [info ] [MainThread]: 
[0m11:24:03.007575 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:24:03.007901 [info ] [MainThread]: 
[0m11:24:03.008322 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:24:03.011090 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRADE_FLOW'
[0m11:24:03.017954 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRADE_FLOW'
[0m11:24:03.019395 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRADE_FLOW'
[0m11:24:03.068434 [debug] [ThreadPool]: Using snowflake connection "list_TRADE_FLOW"
[0m11:24:03.068818 [debug] [ThreadPool]: Using snowflake connection "list_TRADE_FLOW"
[0m11:24:03.069069 [debug] [ThreadPool]: Using snowflake connection "list_TRADE_FLOW"
[0m11:24:03.069235 [debug] [ThreadPool]: On list_TRADE_FLOW: show terse schemas in database TRADE_FLOW
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRADE_FLOW"} */
[0m11:24:03.069460 [debug] [ThreadPool]: On list_TRADE_FLOW: show terse schemas in database TRADE_FLOW
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRADE_FLOW"} */
[0m11:24:03.069655 [debug] [ThreadPool]: On list_TRADE_FLOW: show terse schemas in database TRADE_FLOW
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRADE_FLOW"} */
[0m11:24:03.069832 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:24:03.070031 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:24:03.070207 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:24:05.123072 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 2.053 seconds
[0m11:24:05.125312 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 2.055 seconds
[0m11:24:05.126353 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 2.056 seconds
[0m11:24:05.133999 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRADE_FLOW, now list_TRADE_FLOW_staging)
[0m11:24:05.141078 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRADE_FLOW, now list_TRADE_FLOW_analytics)
[0m11:24:05.154768 [debug] [ThreadPool]: Using snowflake connection "list_TRADE_FLOW_analytics"
[0m11:24:05.156441 [debug] [ThreadPool]: Using snowflake connection "list_TRADE_FLOW_staging"
[0m11:24:05.156969 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRADE_FLOW, now list_TRADE_FLOW_marts)
[0m11:24:05.157285 [debug] [ThreadPool]: On list_TRADE_FLOW_analytics: show objects in TRADE_FLOW.analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRADE_FLOW_analytics"} */;
[0m11:24:05.157737 [debug] [ThreadPool]: On list_TRADE_FLOW_staging: show objects in TRADE_FLOW.staging
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRADE_FLOW_staging"} */;
[0m11:24:05.159936 [debug] [ThreadPool]: Using snowflake connection "list_TRADE_FLOW_marts"
[0m11:24:05.163336 [debug] [ThreadPool]: On list_TRADE_FLOW_marts: show objects in TRADE_FLOW.marts
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRADE_FLOW_marts"} */;
[0m11:24:05.284927 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.123 seconds
[0m11:24:05.291162 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.131 seconds
[0m11:24:05.311133 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 0.147 seconds
[0m11:24:05.316346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '408645e1-962b-4708-b5e3-6747ca33c57b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa630acc0>]}
[0m11:24:05.323096 [debug] [Thread-1 (]: Began running node model.citrus_trade.stg_trade
[0m11:24:05.323817 [info ] [Thread-1 (]: 1 of 8 START sql table model staging.stg_trade ................................. [RUN]
[0m11:24:05.324685 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_TRADE_FLOW_marts, now model.citrus_trade.stg_trade)
[0m11:24:05.325533 [debug] [Thread-1 (]: Began compiling node model.citrus_trade.stg_trade
[0m11:24:05.336574 [debug] [Thread-1 (]: Writing injected SQL for node "model.citrus_trade.stg_trade"
[0m11:24:05.338734 [debug] [Thread-1 (]: Began executing node model.citrus_trade.stg_trade
[0m11:24:05.366214 [debug] [Thread-1 (]: Writing runtime sql for node "model.citrus_trade.stg_trade"
[0m11:24:05.368861 [debug] [Thread-1 (]: Using snowflake connection "model.citrus_trade.stg_trade"
[0m11:24:05.369174 [debug] [Thread-1 (]: On model.citrus_trade.stg_trade: create or replace transient table TRADE_FLOW.staging.stg_trade
    
    
    
    as (select
  value:DECLARANT::int as declarant,
  value:DECLARANT_ISO::string as declarant_iso,
  value:PARTNER::string as partner,
  value:PARTNER_ISO::string as partner_iso,
  value:FLOW::int as flow,
  value:TRANSPORT_MODE::int as transport_mode,
  value:PERIOD::int as period,
  year(to_date(left(period,4),'YYYY')) as year,
  value:HS4::string as hs4,
  value:HS4_NAME::string as hs4_name,
  value:HS6::string as hs6,
  value:HS6_NAME::string as hs6_name,
  value:VALUE_IN_EUROS::float as value_in_euros,
  value:QUANTITY_IN_KG::float as quantity_in_kg
from trade_flow.raw.raw_trhs
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.stg_trade"} */;
[0m11:24:06.322652 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.952 seconds
[0m11:24:06.356520 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '408645e1-962b-4708-b5e3-6747ca33c57b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaab25b50>]}
[0m11:24:06.357479 [info ] [Thread-1 (]: 1 of 8 OK created sql table model staging.stg_trade ............................ [[32mSUCCESS 1[0m in 1.03s]
[0m11:24:06.358548 [debug] [Thread-1 (]: Finished running node model.citrus_trade.stg_trade
[0m11:24:06.359673 [debug] [Thread-3 (]: Began running node model.citrus_trade.trade_by_hs
[0m11:24:06.360194 [info ] [Thread-3 (]: 2 of 8 START sql table model marts.trade_by_hs ................................. [RUN]
[0m11:24:06.360718 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_TRADE_FLOW_staging, now model.citrus_trade.trade_by_hs)
[0m11:24:06.361156 [debug] [Thread-3 (]: Began compiling node model.citrus_trade.trade_by_hs
[0m11:24:06.364633 [debug] [Thread-3 (]: Writing injected SQL for node "model.citrus_trade.trade_by_hs"
[0m11:24:06.366474 [debug] [Thread-3 (]: Began executing node model.citrus_trade.trade_by_hs
[0m11:24:06.369454 [debug] [Thread-3 (]: Writing runtime sql for node "model.citrus_trade.trade_by_hs"
[0m11:24:06.370711 [debug] [Thread-3 (]: Using snowflake connection "model.citrus_trade.trade_by_hs"
[0m11:24:06.371024 [debug] [Thread-3 (]: On model.citrus_trade.trade_by_hs: create or replace transient table TRADE_FLOW.marts.trade_by_hs
    
    
    
    as (select
    *
from TRADE_FLOW.staging.stg_trade
where hs6 = '080510'
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.trade_by_hs"} */;
[0m11:24:07.145385 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.773 seconds
[0m11:24:07.151491 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '408645e1-962b-4708-b5e3-6747ca33c57b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4b85e50>]}
[0m11:24:07.153314 [info ] [Thread-3 (]: 2 of 8 OK created sql table model marts.trade_by_hs ............................ [[32mSUCCESS 1[0m in 0.79s]
[0m11:24:07.154800 [debug] [Thread-3 (]: Finished running node model.citrus_trade.trade_by_hs
[0m11:24:07.156377 [debug] [Thread-2 (]: Began running node model.citrus_trade.imports_by_year
[0m11:24:07.156988 [debug] [Thread-1 (]: Began running node model.citrus_trade.imports_exports_2020
[0m11:24:07.157691 [info ] [Thread-2 (]: 3 of 8 START sql table model marts.imports_by_year ............................. [RUN]
[0m11:24:07.158652 [info ] [Thread-1 (]: 4 of 8 START sql table model marts.imports_exports_2020 ........................ [RUN]
[0m11:24:07.160203 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.citrus_trade.stg_trade, now model.citrus_trade.imports_exports_2020)
[0m11:24:07.160757 [debug] [Thread-1 (]: Began compiling node model.citrus_trade.imports_exports_2020
[0m11:24:07.159601 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_TRADE_FLOW_analytics, now model.citrus_trade.imports_by_year)
[0m11:24:07.167833 [debug] [Thread-1 (]: Writing injected SQL for node "model.citrus_trade.imports_exports_2020"
[0m11:24:07.168494 [debug] [Thread-2 (]: Began compiling node model.citrus_trade.imports_by_year
[0m11:24:07.173659 [debug] [Thread-2 (]: Writing injected SQL for node "model.citrus_trade.imports_by_year"
[0m11:24:07.175145 [debug] [Thread-1 (]: Began executing node model.citrus_trade.imports_exports_2020
[0m11:24:07.178234 [debug] [Thread-1 (]: Writing runtime sql for node "model.citrus_trade.imports_exports_2020"
[0m11:24:07.178902 [debug] [Thread-2 (]: Began executing node model.citrus_trade.imports_by_year
[0m11:24:07.181759 [debug] [Thread-2 (]: Writing runtime sql for node "model.citrus_trade.imports_by_year"
[0m11:24:07.183534 [debug] [Thread-1 (]: Using snowflake connection "model.citrus_trade.imports_exports_2020"
[0m11:24:07.184232 [debug] [Thread-1 (]: On model.citrus_trade.imports_exports_2020: create or replace transient table TRADE_FLOW.marts.imports_exports_2020
    
    
    
    as (select
    declarant_iso,
    flow,
    sum(value_in_euros) over(partition by declarant_iso, flow) as total_value,
    sum(quantity_in_kg) over(partition by declarant_iso, flow) as total_quantity,
    total_value/nullif(total_quantity,0) as value_per_quantity
from TRADE_FLOW.marts.trade_by_hs
where year = 2020
group by 
    declarant_iso,
    flow,
    value_in_euros,
    quantity_in_kg
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.imports_exports_2020"} */;
[0m11:24:07.186758 [debug] [Thread-2 (]: Using snowflake connection "model.citrus_trade.imports_by_year"
[0m11:24:07.187072 [debug] [Thread-2 (]: On model.citrus_trade.imports_by_year: create or replace transient table TRADE_FLOW.marts.imports_by_year
    
    
    
    as (select
    declarant_iso,
    year,
    sum(value_in_euros) as total_value,
    sum(quantity_in_kg) as total_quantity,
    total_value/nullif(total_quantity,0) as value_per_quantity
from TRADE_FLOW.marts.trade_by_hs
where flow = 1
group by 1,2
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.imports_by_year"} */;
[0m11:24:07.755815 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.568 seconds
[0m11:24:07.758537 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '408645e1-962b-4708-b5e3-6747ca33c57b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5bc17c0>]}
[0m11:24:07.759255 [info ] [Thread-2 (]: 3 of 8 OK created sql table model marts.imports_by_year ........................ [[32mSUCCESS 1[0m in 0.60s]
[0m11:24:07.760127 [debug] [Thread-2 (]: Finished running node model.citrus_trade.imports_by_year
[0m11:24:07.760906 [debug] [Thread-3 (]: Began running node model.citrus_trade.growth_score
[0m11:24:07.761397 [info ] [Thread-3 (]: 5 of 8 START sql table model marts.growth_score ................................ [RUN]
[0m11:24:07.761884 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.citrus_trade.trade_by_hs, now model.citrus_trade.growth_score)
[0m11:24:07.762289 [debug] [Thread-3 (]: Began compiling node model.citrus_trade.growth_score
[0m11:24:07.765940 [debug] [Thread-3 (]: Writing injected SQL for node "model.citrus_trade.growth_score"
[0m11:24:07.768034 [debug] [Thread-3 (]: Began executing node model.citrus_trade.growth_score
[0m11:24:07.770469 [debug] [Thread-3 (]: Writing runtime sql for node "model.citrus_trade.growth_score"
[0m11:24:07.773626 [debug] [Thread-3 (]: Using snowflake connection "model.citrus_trade.growth_score"
[0m11:24:07.774071 [debug] [Thread-3 (]: On model.citrus_trade.growth_score: create or replace transient table TRADE_FLOW.marts.growth_score
    
    
    
    as (with 
    previous_year AS (
        select 
            declarant_iso,
            year,
            lag(total_value,1) over(partition by declarant_iso order by year) previous_year_value,
            total_value,
            first_value(total_value) over(partition by declarant_iso order by year) as first_year_value,
            last_value(total_value) over(partition by declarant_iso order by year) as last_year_value
        from TRADE_FLOW.marts.imports_by_year
    ),
    growth_speed AS (
        select 
            declarant_iso,
            year,
            first_year_value,
            last_year_value,
            last_year_value/nullif(first_year_value,0) as growth_overall,
            previous_year_value,
            total_value,
            (total_value - previous_year_value)/total_value * 100 as growth_speed 
        from previous_year
    ),
    previous_year_growth_speed AS (
        select 
            declarant_iso,
            year,
            first_year_value,
            last_year_value,
            growth_overall,
            previous_year_value,
            total_value as current_value,
            growth_speed,
            lag(growth_speed,1) over(partition by declarant_iso order by year) previous_year_growth_speed,
        from growth_speed
        order by 1,2
    ),
    base AS (
        select 
            declarant_iso,
            year,
            first_year_value,
            last_year_value,
            growth_overall,
            previous_year_value,
            current_value,
            previous_year_growth_speed,
            growth_speed,
            growth_speed - previous_year_growth_speed as growth_acceleration,
            avg(growth_acceleration) over(partition by declarant_iso) as avg_acceleration
        from previous_year_growth_speed
    ),
    ok as (
        select 
            declarant_iso,
            year,
            first_year_value,
            last_year_value,
            growth_overall,
            (growth_overall - min(growth_overall) OVER())/(max(growth_overall) OVER() - min(growth_overall) OVER()) as growth_overall_norm,
            previous_year_value,
            current_value,
            -- previous_year_growth_speed,
            growth_speed,
            growth_acceleration,
            avg_acceleration,
            (avg_acceleration - min(avg_acceleration) OVER())/(max(avg_acceleration) OVER() - min(avg_acceleration) OVER()) as avg_acceleration_norm
        from base 
    )
    select 
        distinct 
        declarant_iso,
        year,
        current_value,
        growth_speed,
        growth_acceleration,
        growth_overall,
        growth_overall_norm,
        avg_acceleration,
        avg_acceleration_norm,
        growth_overall_norm * avg_acceleration_norm as growth_score
    from ok
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.growth_score"} */;
[0m11:24:07.872073 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.687 seconds
[0m11:24:07.875966 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '408645e1-962b-4708-b5e3-6747ca33c57b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4f7f230>]}
[0m11:24:07.876853 [info ] [Thread-1 (]: 4 of 8 OK created sql table model marts.imports_exports_2020 ................... [[32mSUCCESS 1[0m in 0.72s]
[0m11:24:07.877573 [debug] [Thread-1 (]: Finished running node model.citrus_trade.imports_exports_2020
[0m11:24:07.878527 [debug] [Thread-2 (]: Began running node model.citrus_trade.score_2020
[0m11:24:07.879002 [info ] [Thread-2 (]: 6 of 8 START sql table model marts.score_2020 .................................. [RUN]
[0m11:24:07.879574 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.citrus_trade.imports_by_year, now model.citrus_trade.score_2020)
[0m11:24:07.880021 [debug] [Thread-2 (]: Began compiling node model.citrus_trade.score_2020
[0m11:24:07.883970 [debug] [Thread-2 (]: Writing injected SQL for node "model.citrus_trade.score_2020"
[0m11:24:07.887229 [debug] [Thread-2 (]: Began executing node model.citrus_trade.score_2020
[0m11:24:07.891118 [debug] [Thread-2 (]: Writing runtime sql for node "model.citrus_trade.score_2020"
[0m11:24:07.892762 [debug] [Thread-2 (]: Using snowflake connection "model.citrus_trade.score_2020"
[0m11:24:07.893122 [debug] [Thread-2 (]: On model.citrus_trade.score_2020: create or replace transient table TRADE_FLOW.marts.score_2020
    
    
    
    as (select distinct 
    declarant_iso,
    total_value,
    total_quantity,
    value_per_quantity,
    (total_value - min(total_value) over())/((max(total_value) over())-(min(total_value) over())) as value_score,
    (total_quantity - min(total_quantity) over())/((max(total_quantity) over())-(min(total_quantity) over())) as quantity_score,
    (value_per_quantity - min(value_per_quantity) over())/((max(value_per_quantity) over())-(min(value_per_quantity) over())) as price_score
from TRADE_FLOW.marts.imports_exports_2020
where flow = 1
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.score_2020"} */;
[0m11:24:08.584738 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.690 seconds
[0m11:24:08.587054 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.812 seconds
[0m11:24:08.591476 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '408645e1-962b-4708-b5e3-6747ca33c57b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4f4c110>]}
[0m11:24:08.594392 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '408645e1-962b-4708-b5e3-6747ca33c57b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4f4c6b0>]}
[0m11:24:08.595617 [info ] [Thread-2 (]: 6 of 8 OK created sql table model marts.score_2020 ............................. [[32mSUCCESS 1[0m in 0.71s]
[0m11:24:08.597343 [info ] [Thread-3 (]: 5 of 8 OK created sql table model marts.growth_score ........................... [[32mSUCCESS 1[0m in 0.83s]
[0m11:24:08.598755 [debug] [Thread-2 (]: Finished running node model.citrus_trade.score_2020
[0m11:24:08.599654 [debug] [Thread-3 (]: Finished running node model.citrus_trade.growth_score
[0m11:24:08.601242 [debug] [Thread-1 (]: Began running node model.citrus_trade.importer_score
[0m11:24:08.602158 [info ] [Thread-1 (]: 7 of 8 START sql table model marts.importer_score .............................. [RUN]
[0m11:24:08.603010 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.citrus_trade.imports_exports_2020, now model.citrus_trade.importer_score)
[0m11:24:08.603653 [debug] [Thread-1 (]: Began compiling node model.citrus_trade.importer_score
[0m11:24:08.608016 [debug] [Thread-1 (]: Writing injected SQL for node "model.citrus_trade.importer_score"
[0m11:24:08.609937 [debug] [Thread-1 (]: Began executing node model.citrus_trade.importer_score
[0m11:24:08.612012 [debug] [Thread-1 (]: Writing runtime sql for node "model.citrus_trade.importer_score"
[0m11:24:08.613278 [debug] [Thread-1 (]: Using snowflake connection "model.citrus_trade.importer_score"
[0m11:24:08.613566 [debug] [Thread-1 (]: On model.citrus_trade.importer_score: create or replace transient table TRADE_FLOW.marts.importer_score
    
    
    
    as (select distinct
    sc.declarant_iso,
    sc.total_value as revenue_total,
    sc.total_quantity as volume_total,
    sc.value_per_quantity as rate_avg,
    sc.value_score as revenue_score,
    sc.quantity_score as volume_score,
    sc.price_score as rate_score,
    gs.growth_score
from TRADE_FLOW.marts.score_2020 as sc
inner join TRADE_FLOW.marts.growth_score as gs
    on gs.declarant_iso = sc.declarant_iso
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.importer_score"} */;
[0m11:24:09.284620 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.670 seconds
[0m11:24:09.289407 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '408645e1-962b-4708-b5e3-6747ca33c57b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4f8fef0>]}
[0m11:24:09.290564 [info ] [Thread-1 (]: 7 of 8 OK created sql table model marts.importer_score ......................... [[32mSUCCESS 1[0m in 0.69s]
[0m11:24:09.291336 [debug] [Thread-1 (]: Finished running node model.citrus_trade.importer_score
[0m11:24:09.292819 [debug] [Thread-2 (]: Began running node model.citrus_trade.viz_importer_score
[0m11:24:09.293338 [info ] [Thread-2 (]: 8 of 8 START sql table model analytics.viz_importer_score ...................... [RUN]
[0m11:24:09.293919 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.citrus_trade.score_2020, now model.citrus_trade.viz_importer_score)
[0m11:24:09.294439 [debug] [Thread-2 (]: Began compiling node model.citrus_trade.viz_importer_score
[0m11:24:09.299494 [debug] [Thread-2 (]: Writing injected SQL for node "model.citrus_trade.viz_importer_score"
[0m11:24:09.301287 [debug] [Thread-2 (]: Began executing node model.citrus_trade.viz_importer_score
[0m11:24:09.304016 [debug] [Thread-2 (]: Writing runtime sql for node "model.citrus_trade.viz_importer_score"
[0m11:24:09.306174 [debug] [Thread-2 (]: Using snowflake connection "model.citrus_trade.viz_importer_score"
[0m11:24:09.306555 [debug] [Thread-2 (]: On model.citrus_trade.viz_importer_score: create or replace transient table TRADE_FLOW.analytics.viz_importer_score
    
    
    
    as (with 
    scores as (
        select 
            declarant_iso,
            score_type,
            score
        from TRADE_FLOW.marts.importer_score
        unpivot (
            score for score_type in (
                revenue_score as "revenue",
                volume_score as "volume",
                rate_score as "rate",
                growth_score as "growth"
            )
        )
    ),
    metrics as (
        select 
            declarant_iso,
            metric_type,
            metric
        from TRADE_FLOW.marts.importer_score
        unpivot (
            metric for metric_type in (
                revenue_total as "revenue",
                volume_total as "volume",
                rate_avg as "rate"
            )
        )
    )
select 
    s.declarant_iso,
    s.score_type,
    s.score,
    m.metric,
    case 
        when s.score_type = 'revenue' then 'Euro'
        when s.score_type = 'volume' then 'Kg'
        when s.score_type = 'rate' then 'Euro per Kg'
    end as metric_unit
from scores as s
left join metrics as m
    on s.declarant_iso = m.declarant_iso
    and s.score_type = m.metric_type
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.viz_importer_score"} */;
[0m11:24:10.009263 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.702 seconds
[0m11:24:10.013303 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '408645e1-962b-4708-b5e3-6747ca33c57b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4f94cb0>]}
[0m11:24:10.014152 [info ] [Thread-2 (]: 8 of 8 OK created sql table model analytics.viz_importer_score ................. [[32mSUCCESS 1[0m in 0.72s]
[0m11:24:10.014907 [debug] [Thread-2 (]: Finished running node model.citrus_trade.viz_importer_score
[0m11:24:10.017815 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:24:10.018249 [debug] [MainThread]: Connection 'model.citrus_trade.growth_score' was left open.
[0m11:24:10.018675 [debug] [MainThread]: On model.citrus_trade.growth_score: Close
[0m11:24:10.144575 [debug] [MainThread]: Connection 'model.citrus_trade.importer_score' was left open.
[0m11:24:10.145510 [debug] [MainThread]: On model.citrus_trade.importer_score: Close
[0m11:24:10.353665 [debug] [MainThread]: Connection 'model.citrus_trade.viz_importer_score' was left open.
[0m11:24:10.354275 [debug] [MainThread]: On model.citrus_trade.viz_importer_score: Close
[0m11:24:10.485326 [info ] [MainThread]: 
[0m11:24:10.486886 [info ] [MainThread]: Finished running 8 table models in 0 hours 0 minutes and 7.48 seconds (7.48s).
[0m11:24:10.490743 [debug] [MainThread]: Command end result
[0m11:24:10.546923 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m11:24:10.550310 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m11:24:10.557741 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/target/run_results.json
[0m11:24:10.557977 [info ] [MainThread]: 
[0m11:24:10.558265 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:24:10.558740 [info ] [MainThread]: 
[0m11:24:10.559366 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=8
[0m11:24:10.561133 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.407221, "process_in_blocks": "0", "process_kernel_time": 0.869924, "process_mem_max_rss": "151592", "process_out_blocks": "4302", "process_user_time": 2.039512}
[0m11:24:10.561669 [debug] [MainThread]: Command `dbt run` succeeded at 11:24:10.561594 after 8.41 seconds
[0m11:24:10.562030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa61b5f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6823ce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4b44200>]}
[0m11:24:10.562254 [debug] [MainThread]: Flushing usage events
[0m11:24:12.091678 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:31:55.850833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad876930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae149be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac4f1010>]}


============================== 12:31:55.854637 | 8e942241-a8f8-4670-9461-5f921d070db5 ==============================
[0m12:31:55.854637 [info ] [MainThread]: Running with dbt=1.10.13
[0m12:31:55.855045 [debug] [MainThread]: running dbt with arguments {'empty': 'False', 'quiet': 'False', 'log_cache_events': 'False', 'static_parser': 'True', 'profiles_dir': '/opt/airflow/dbt', 'introspect': 'True', 'indirect_selection': 'eager', 'target_path': 'None', 'log_format': 'default', 'warn_error': 'None', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'write_json': 'True', 'partial_parse': 'True', 'use_colors': 'True', 'log_path': '/opt/airflow/dbt/logs', 'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'fail_fast': 'False', 'debug': 'False', 'invocation_command': 'dbt run', 'version_check': 'True'}
[0m12:31:56.027580 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m12:31:56.028082 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m12:31:56.028311 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m12:31:56.133082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8e942241-a8f8-4670-9461-5f921d070db5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa754b00>]}
[0m12:31:56.164285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8e942241-a8f8-4670-9461-5f921d070db5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa6f82f0>]}
[0m12:31:56.164827 [info ] [MainThread]: Registered adapter: snowflake=1.10.3
[0m12:31:56.226413 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m12:31:56.356207 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:31:56.356493 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:31:56.374404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8e942241-a8f8-4670-9461-5f921d070db5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9fba3c0>]}
[0m12:31:56.429125 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m12:31:56.430534 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m12:31:56.441727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8e942241-a8f8-4670-9461-5f921d070db5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9accd10>]}
[0m12:31:56.442028 [info ] [MainThread]: Found 8 models, 3 sources, 636 macros
[0m12:31:56.442309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8e942241-a8f8-4670-9461-5f921d070db5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae3fa480>]}
[0m12:31:56.443497 [info ] [MainThread]: 
[0m12:31:56.443725 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:31:56.443940 [info ] [MainThread]: 
[0m12:31:56.444317 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:31:56.446914 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRADE_FLOW'
[0m12:31:56.453637 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRADE_FLOW'
[0m12:31:56.456769 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRADE_FLOW'
[0m12:31:56.495003 [debug] [ThreadPool]: Using snowflake connection "list_TRADE_FLOW"
[0m12:31:56.495357 [debug] [ThreadPool]: Using snowflake connection "list_TRADE_FLOW"
[0m12:31:56.495600 [debug] [ThreadPool]: Using snowflake connection "list_TRADE_FLOW"
[0m12:31:56.495774 [debug] [ThreadPool]: On list_TRADE_FLOW: show terse schemas in database TRADE_FLOW
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRADE_FLOW"} */
[0m12:31:56.496048 [debug] [ThreadPool]: On list_TRADE_FLOW: show terse schemas in database TRADE_FLOW
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRADE_FLOW"} */
[0m12:31:56.496283 [debug] [ThreadPool]: On list_TRADE_FLOW: show terse schemas in database TRADE_FLOW
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRADE_FLOW"} */
[0m12:31:56.496485 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:31:56.496806 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:31:56.497049 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:31:58.049954 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.553 seconds
[0m12:31:58.064764 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.568 seconds
[0m12:31:58.106205 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.609 seconds
[0m12:31:58.109783 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRADE_FLOW, now list_TRADE_FLOW_analytics)
[0m12:31:58.110252 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRADE_FLOW, now list_TRADE_FLOW_staging)
[0m12:31:58.121775 [debug] [ThreadPool]: Using snowflake connection "list_TRADE_FLOW_analytics"
[0m12:31:58.122229 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRADE_FLOW, now list_TRADE_FLOW_marts)
[0m12:31:58.125082 [debug] [ThreadPool]: Using snowflake connection "list_TRADE_FLOW_staging"
[0m12:31:58.125470 [debug] [ThreadPool]: On list_TRADE_FLOW_analytics: show objects in TRADE_FLOW.analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRADE_FLOW_analytics"} */;
[0m12:31:58.126998 [debug] [ThreadPool]: Using snowflake connection "list_TRADE_FLOW_marts"
[0m12:31:58.127301 [debug] [ThreadPool]: On list_TRADE_FLOW_staging: show objects in TRADE_FLOW.staging
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRADE_FLOW_staging"} */;
[0m12:31:58.128639 [debug] [ThreadPool]: On list_TRADE_FLOW_marts: show objects in TRADE_FLOW.marts
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRADE_FLOW_marts"} */;
[0m12:31:58.230201 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.101 seconds
[0m12:31:58.243404 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 0.114 seconds
[0m12:31:58.350068 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.222 seconds
[0m12:31:58.355444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8e942241-a8f8-4670-9461-5f921d070db5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9c9aa50>]}
[0m12:31:58.362738 [debug] [Thread-1 (]: Began running node model.citrus_trade.stg_trade
[0m12:31:58.363661 [info ] [Thread-1 (]: 1 of 8 START sql table model staging.stg_trade ................................. [RUN]
[0m12:31:58.364410 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_TRADE_FLOW_analytics, now model.citrus_trade.stg_trade)
[0m12:31:58.365021 [debug] [Thread-1 (]: Began compiling node model.citrus_trade.stg_trade
[0m12:31:58.375850 [debug] [Thread-1 (]: Writing injected SQL for node "model.citrus_trade.stg_trade"
[0m12:31:58.378246 [debug] [Thread-1 (]: Began executing node model.citrus_trade.stg_trade
[0m12:31:58.408776 [debug] [Thread-1 (]: Writing runtime sql for node "model.citrus_trade.stg_trade"
[0m12:31:58.411592 [debug] [Thread-1 (]: Using snowflake connection "model.citrus_trade.stg_trade"
[0m12:31:58.411898 [debug] [Thread-1 (]: On model.citrus_trade.stg_trade: create or replace transient table TRADE_FLOW.staging.stg_trade
    
    
    
    as (select
  value:DECLARANT::int as declarant,
  value:DECLARANT_ISO::string as declarant_iso,
  value:PARTNER::string as partner,
  value:PARTNER_ISO::string as partner_iso,
  value:FLOW::int as flow,
  value:TRANSPORT_MODE::int as transport_mode,
  value:PERIOD::int as period,
  year(to_date(left(period,4),'YYYY')) as year,
  value:HS4::string as hs4,
  value:HS4_NAME::string as hs4_name,
  value:HS6::string as hs6,
  value:HS6_NAME::string as hs6_name,
  value:VALUE_IN_EUROS::float as value_in_euros,
  value:QUANTITY_IN_KG::float as quantity_in_kg
from trade_flow.raw.raw_trhs
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.stg_trade"} */;
[0m12:31:59.286089 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.874 seconds
[0m12:31:59.314682 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e942241-a8f8-4670-9461-5f921d070db5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffadde9940>]}
[0m12:31:59.315434 [info ] [Thread-1 (]: 1 of 8 OK created sql table model staging.stg_trade ............................ [[32mSUCCESS 1[0m in 0.95s]
[0m12:31:59.316173 [debug] [Thread-1 (]: Finished running node model.citrus_trade.stg_trade
[0m12:31:59.317169 [debug] [Thread-3 (]: Began running node model.citrus_trade.trade_by_hs
[0m12:31:59.317875 [info ] [Thread-3 (]: 2 of 8 START sql table model marts.trade_by_hs ................................. [RUN]
[0m12:31:59.318376 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_TRADE_FLOW_staging, now model.citrus_trade.trade_by_hs)
[0m12:31:59.318809 [debug] [Thread-3 (]: Began compiling node model.citrus_trade.trade_by_hs
[0m12:31:59.321588 [debug] [Thread-3 (]: Writing injected SQL for node "model.citrus_trade.trade_by_hs"
[0m12:31:59.323180 [debug] [Thread-3 (]: Began executing node model.citrus_trade.trade_by_hs
[0m12:31:59.325473 [debug] [Thread-3 (]: Writing runtime sql for node "model.citrus_trade.trade_by_hs"
[0m12:31:59.326520 [debug] [Thread-3 (]: Using snowflake connection "model.citrus_trade.trade_by_hs"
[0m12:31:59.326764 [debug] [Thread-3 (]: On model.citrus_trade.trade_by_hs: create or replace transient table TRADE_FLOW.marts.trade_by_hs
    
    
    
    as (select
    *
from TRADE_FLOW.staging.stg_trade
where hs6 = '080510'
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.trade_by_hs"} */;
[0m12:32:00.023204 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.696 seconds
[0m12:32:00.027677 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e942241-a8f8-4670-9461-5f921d070db5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9c85370>]}
[0m12:32:00.028860 [info ] [Thread-3 (]: 2 of 8 OK created sql table model marts.trade_by_hs ............................ [[32mSUCCESS 1[0m in 0.71s]
[0m12:32:00.030010 [debug] [Thread-3 (]: Finished running node model.citrus_trade.trade_by_hs
[0m12:32:00.030692 [debug] [Thread-2 (]: Began running node model.citrus_trade.imports_by_year
[0m12:32:00.030992 [debug] [Thread-1 (]: Began running node model.citrus_trade.imports_exports_2020
[0m12:32:00.031387 [info ] [Thread-2 (]: 3 of 8 START sql table model marts.imports_by_year ............................. [RUN]
[0m12:32:00.032261 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_TRADE_FLOW_marts, now model.citrus_trade.imports_by_year)
[0m12:32:00.032573 [debug] [Thread-2 (]: Began compiling node model.citrus_trade.imports_by_year
[0m12:32:00.035063 [debug] [Thread-2 (]: Writing injected SQL for node "model.citrus_trade.imports_by_year"
[0m12:32:00.031770 [info ] [Thread-1 (]: 4 of 8 START sql table model marts.imports_exports_2020 ........................ [RUN]
[0m12:32:00.035615 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.citrus_trade.stg_trade, now model.citrus_trade.imports_exports_2020)
[0m12:32:00.036572 [debug] [Thread-1 (]: Began compiling node model.citrus_trade.imports_exports_2020
[0m12:32:00.041173 [debug] [Thread-1 (]: Writing injected SQL for node "model.citrus_trade.imports_exports_2020"
[0m12:32:00.042036 [debug] [Thread-2 (]: Began executing node model.citrus_trade.imports_by_year
[0m12:32:00.045538 [debug] [Thread-2 (]: Writing runtime sql for node "model.citrus_trade.imports_by_year"
[0m12:32:00.046571 [debug] [Thread-1 (]: Began executing node model.citrus_trade.imports_exports_2020
[0m12:32:00.049920 [debug] [Thread-1 (]: Writing runtime sql for node "model.citrus_trade.imports_exports_2020"
[0m12:32:00.051538 [debug] [Thread-2 (]: Using snowflake connection "model.citrus_trade.imports_by_year"
[0m12:32:00.052411 [debug] [Thread-2 (]: On model.citrus_trade.imports_by_year: create or replace transient table TRADE_FLOW.marts.imports_by_year
    
    
    
    as (select
    declarant_iso,
    year,
    sum(value_in_euros) as total_value,
    sum(quantity_in_kg) as total_quantity,
    total_value/nullif(total_quantity,0) as value_per_quantity
from TRADE_FLOW.marts.trade_by_hs
where flow = 1
group by 1,2
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.imports_by_year"} */;
[0m12:32:00.054249 [debug] [Thread-1 (]: Using snowflake connection "model.citrus_trade.imports_exports_2020"
[0m12:32:00.056158 [debug] [Thread-1 (]: On model.citrus_trade.imports_exports_2020: create or replace transient table TRADE_FLOW.marts.imports_exports_2020
    
    
    
    as (select
    declarant_iso,
    flow,
    sum(value_in_euros) over(partition by declarant_iso, flow) as total_value,
    sum(quantity_in_kg) over(partition by declarant_iso, flow) as total_quantity,
    total_value/nullif(total_quantity,0) as value_per_quantity
from TRADE_FLOW.marts.trade_by_hs
where year = 2020
group by 
    declarant_iso,
    flow,
    value_in_euros,
    quantity_in_kg
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.imports_exports_2020"} */;
[0m12:32:00.670381 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.614 seconds
[0m12:32:00.672947 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e942241-a8f8-4670-9461-5f921d070db5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa84b40b0>]}
[0m12:32:00.673667 [info ] [Thread-1 (]: 4 of 8 OK created sql table model marts.imports_exports_2020 ................... [[32mSUCCESS 1[0m in 0.64s]
[0m12:32:00.674611 [debug] [Thread-1 (]: Finished running node model.citrus_trade.imports_exports_2020
[0m12:32:00.675319 [debug] [Thread-3 (]: Began running node model.citrus_trade.score_2020
[0m12:32:00.675803 [info ] [Thread-3 (]: 5 of 8 START sql table model marts.score_2020 .................................. [RUN]
[0m12:32:00.676299 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.citrus_trade.trade_by_hs, now model.citrus_trade.score_2020)
[0m12:32:00.676695 [debug] [Thread-3 (]: Began compiling node model.citrus_trade.score_2020
[0m12:32:00.679977 [debug] [Thread-3 (]: Writing injected SQL for node "model.citrus_trade.score_2020"
[0m12:32:00.681689 [debug] [Thread-3 (]: Began executing node model.citrus_trade.score_2020
[0m12:32:00.684103 [debug] [Thread-3 (]: Writing runtime sql for node "model.citrus_trade.score_2020"
[0m12:32:00.685482 [debug] [Thread-3 (]: Using snowflake connection "model.citrus_trade.score_2020"
[0m12:32:00.685778 [debug] [Thread-3 (]: On model.citrus_trade.score_2020: create or replace transient table TRADE_FLOW.marts.score_2020
    
    
    
    as (select distinct 
    declarant_iso,
    total_value,
    total_quantity,
    value_per_quantity,
    (total_value - min(total_value) over())/((max(total_value) over())-(min(total_value) over())) as value_score,
    (total_quantity - min(total_quantity) over())/((max(total_quantity) over())-(min(total_quantity) over())) as quantity_score,
    (value_per_quantity - min(value_per_quantity) over())/((max(value_per_quantity) over())-(min(value_per_quantity) over())) as price_score
from TRADE_FLOW.marts.imports_exports_2020
where flow = 1
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.score_2020"} */;
[0m12:32:00.689709 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.637 seconds
[0m12:32:00.691767 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e942241-a8f8-4670-9461-5f921d070db5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa84dd460>]}
[0m12:32:00.692552 [info ] [Thread-2 (]: 3 of 8 OK created sql table model marts.imports_by_year ........................ [[32mSUCCESS 1[0m in 0.66s]
[0m12:32:00.693180 [debug] [Thread-2 (]: Finished running node model.citrus_trade.imports_by_year
[0m12:32:00.694093 [debug] [Thread-1 (]: Began running node model.citrus_trade.growth_score
[0m12:32:00.694498 [info ] [Thread-1 (]: 6 of 8 START sql table model marts.growth_score ................................ [RUN]
[0m12:32:00.694916 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.citrus_trade.imports_exports_2020, now model.citrus_trade.growth_score)
[0m12:32:00.695228 [debug] [Thread-1 (]: Began compiling node model.citrus_trade.growth_score
[0m12:32:00.697884 [debug] [Thread-1 (]: Writing injected SQL for node "model.citrus_trade.growth_score"
[0m12:32:00.699124 [debug] [Thread-1 (]: Began executing node model.citrus_trade.growth_score
[0m12:32:00.701594 [debug] [Thread-1 (]: Writing runtime sql for node "model.citrus_trade.growth_score"
[0m12:32:00.705066 [debug] [Thread-1 (]: Using snowflake connection "model.citrus_trade.growth_score"
[0m12:32:00.705564 [debug] [Thread-1 (]: On model.citrus_trade.growth_score: create or replace transient table TRADE_FLOW.marts.growth_score
    
    
    
    as (with 
    previous_year AS (
        select 
            declarant_iso,
            year,
            lag(total_value,1) over(partition by declarant_iso order by year) previous_year_value,
            total_value,
            first_value(total_value) over(partition by declarant_iso order by year) as first_year_value,
            last_value(total_value) over(partition by declarant_iso order by year) as last_year_value
        from TRADE_FLOW.marts.imports_by_year
    ),
    growth_speed AS (
        select 
            declarant_iso,
            year,
            first_year_value,
            last_year_value,
            last_year_value/nullif(first_year_value,0) as growth_overall,
            previous_year_value,
            total_value,
            (total_value - previous_year_value)/total_value * 100 as growth_speed 
        from previous_year
    ),
    previous_year_growth_speed AS (
        select 
            declarant_iso,
            year,
            first_year_value,
            last_year_value,
            growth_overall,
            previous_year_value,
            total_value as current_value,
            growth_speed,
            lag(growth_speed,1) over(partition by declarant_iso order by year) previous_year_growth_speed,
        from growth_speed
        order by 1,2
    ),
    base AS (
        select 
            declarant_iso,
            year,
            first_year_value,
            last_year_value,
            growth_overall,
            previous_year_value,
            current_value,
            previous_year_growth_speed,
            growth_speed,
            growth_speed - previous_year_growth_speed as growth_acceleration,
            avg(growth_acceleration) over(partition by declarant_iso) as avg_acceleration
        from previous_year_growth_speed
    ),
    ok as (
        select 
            declarant_iso,
            year,
            first_year_value,
            last_year_value,
            growth_overall,
            (growth_overall - min(growth_overall) OVER())/(max(growth_overall) OVER() - min(growth_overall) OVER()) as growth_overall_norm,
            previous_year_value,
            current_value,
            -- previous_year_growth_speed,
            growth_speed,
            growth_acceleration,
            avg_acceleration,
            (avg_acceleration - min(avg_acceleration) OVER())/(max(avg_acceleration) OVER() - min(avg_acceleration) OVER()) as avg_acceleration_norm
        from base 
    )
    select 
        distinct 
        declarant_iso,
        year,
        current_value,
        growth_speed,
        growth_acceleration,
        growth_overall,
        growth_overall_norm,
        avg_acceleration,
        avg_acceleration_norm,
        growth_overall_norm * avg_acceleration_norm as growth_score
    from ok
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.growth_score"} */;
[0m12:32:01.662236 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.976 seconds
[0m12:32:01.664801 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e942241-a8f8-4670-9461-5f921d070db5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa83dd610>]}
[0m12:32:01.665695 [info ] [Thread-3 (]: 5 of 8 OK created sql table model marts.score_2020 ............................. [[32mSUCCESS 1[0m in 0.99s]
[0m12:32:01.666662 [debug] [Thread-3 (]: Finished running node model.citrus_trade.score_2020
[0m12:32:01.822897 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.117 seconds
[0m12:32:01.824363 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e942241-a8f8-4670-9461-5f921d070db5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8211280>]}
[0m12:32:01.824746 [info ] [Thread-1 (]: 6 of 8 OK created sql table model marts.growth_score ........................... [[32mSUCCESS 1[0m in 1.13s]
[0m12:32:01.825131 [debug] [Thread-1 (]: Finished running node model.citrus_trade.growth_score
[0m12:32:01.825828 [debug] [Thread-2 (]: Began running node model.citrus_trade.importer_score
[0m12:32:01.826176 [info ] [Thread-2 (]: 7 of 8 START sql table model marts.importer_score .............................. [RUN]
[0m12:32:01.826508 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.citrus_trade.imports_by_year, now model.citrus_trade.importer_score)
[0m12:32:01.826770 [debug] [Thread-2 (]: Began compiling node model.citrus_trade.importer_score
[0m12:32:01.830011 [debug] [Thread-2 (]: Writing injected SQL for node "model.citrus_trade.importer_score"
[0m12:32:01.831192 [debug] [Thread-2 (]: Began executing node model.citrus_trade.importer_score
[0m12:32:01.833552 [debug] [Thread-2 (]: Writing runtime sql for node "model.citrus_trade.importer_score"
[0m12:32:01.835427 [debug] [Thread-2 (]: Using snowflake connection "model.citrus_trade.importer_score"
[0m12:32:01.835738 [debug] [Thread-2 (]: On model.citrus_trade.importer_score: create or replace transient table TRADE_FLOW.marts.importer_score
    
    
    
    as (select distinct
    sc.declarant_iso,
    sc.total_value as revenue_total,
    sc.total_quantity as volume_total,
    sc.value_per_quantity as rate_avg,
    sc.value_score as revenue_score,
    sc.quantity_score as volume_score,
    sc.price_score as rate_score,
    gs.growth_score
from TRADE_FLOW.marts.score_2020 as sc
inner join TRADE_FLOW.marts.growth_score as gs
    on gs.declarant_iso = sc.declarant_iso
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.importer_score"} */;
[0m12:32:02.993320 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.157 seconds
[0m12:32:02.997169 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e942241-a8f8-4670-9461-5f921d070db5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa84fa180>]}
[0m12:32:02.998027 [info ] [Thread-2 (]: 7 of 8 OK created sql table model marts.importer_score ......................... [[32mSUCCESS 1[0m in 1.17s]
[0m12:32:02.999796 [debug] [Thread-2 (]: Finished running node model.citrus_trade.importer_score
[0m12:32:03.000971 [debug] [Thread-3 (]: Began running node model.citrus_trade.viz_importer_score
[0m12:32:03.001354 [info ] [Thread-3 (]: 8 of 8 START sql table model analytics.viz_importer_score ...................... [RUN]
[0m12:32:03.002551 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.citrus_trade.score_2020, now model.citrus_trade.viz_importer_score)
[0m12:32:03.002834 [debug] [Thread-3 (]: Began compiling node model.citrus_trade.viz_importer_score
[0m12:32:03.006029 [debug] [Thread-3 (]: Writing injected SQL for node "model.citrus_trade.viz_importer_score"
[0m12:32:03.013496 [debug] [Thread-3 (]: Began executing node model.citrus_trade.viz_importer_score
[0m12:32:03.019906 [debug] [Thread-3 (]: Writing runtime sql for node "model.citrus_trade.viz_importer_score"
[0m12:32:03.026897 [debug] [Thread-3 (]: Using snowflake connection "model.citrus_trade.viz_importer_score"
[0m12:32:03.027449 [debug] [Thread-3 (]: On model.citrus_trade.viz_importer_score: create or replace transient table TRADE_FLOW.analytics.viz_importer_score
    
    
    
    as (with 
    scores as (
        select 
            declarant_iso,
            score_type,
            score
        from TRADE_FLOW.marts.importer_score
        unpivot (
            score for score_type in (
                revenue_score as "revenue",
                volume_score as "volume",
                rate_score as "rate",
                growth_score as "growth"
            )
        )
    ),
    metrics as (
        select 
            declarant_iso,
            metric_type,
            metric
        from TRADE_FLOW.marts.importer_score
        unpivot (
            metric for metric_type in (
                revenue_total as "revenue",
                volume_total as "volume",
                rate_avg as "rate"
            )
        )
    )
select 
    s.declarant_iso,
    s.score_type,
    s.score,
    m.metric,
    case 
        when s.score_type = 'revenue' then 'Euro'
        when s.score_type = 'volume' then 'Kg'
        when s.score_type = 'rate' then 'Euro per Kg'
    end as metric_unit
from scores as s
left join metrics as m
    on s.declarant_iso = m.declarant_iso
    and s.score_type = m.metric_type
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.viz_importer_score"} */;
[0m12:32:03.995438 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.968 seconds
[0m12:32:03.997080 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e942241-a8f8-4670-9461-5f921d070db5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa822e4b0>]}
[0m12:32:03.997583 [info ] [Thread-3 (]: 8 of 8 OK created sql table model analytics.viz_importer_score ................. [[32mSUCCESS 1[0m in 0.99s]
[0m12:32:03.998157 [debug] [Thread-3 (]: Finished running node model.citrus_trade.viz_importer_score
[0m12:32:03.999951 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:32:04.000222 [debug] [MainThread]: Connection 'model.citrus_trade.growth_score' was left open.
[0m12:32:04.000427 [debug] [MainThread]: On model.citrus_trade.growth_score: Close
[0m12:32:04.147076 [debug] [MainThread]: Connection 'model.citrus_trade.viz_importer_score' was left open.
[0m12:32:04.147895 [debug] [MainThread]: On model.citrus_trade.viz_importer_score: Close
[0m12:32:04.300698 [debug] [MainThread]: Connection 'model.citrus_trade.importer_score' was left open.
[0m12:32:04.301222 [debug] [MainThread]: On model.citrus_trade.importer_score: Close
[0m12:32:04.422547 [info ] [MainThread]: 
[0m12:32:04.423492 [info ] [MainThread]: Finished running 8 table models in 0 hours 0 minutes and 7.98 seconds (7.98s).
[0m12:32:04.425703 [debug] [MainThread]: Command end result
[0m12:32:04.462704 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m12:32:04.466102 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m12:32:04.472084 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/target/run_results.json
[0m12:32:04.472333 [info ] [MainThread]: 
[0m12:32:04.472645 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:32:04.473228 [info ] [MainThread]: 
[0m12:32:04.473714 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=8
[0m12:32:04.476868 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.655884, "process_in_blocks": "0", "process_kernel_time": 0.598449, "process_mem_max_rss": "149044", "process_out_blocks": "2908", "process_user_time": 1.707135}
[0m12:32:04.477926 [debug] [MainThread]: Command `dbt run` succeeded at 12:32:04.477769 after 8.66 seconds
[0m12:32:04.478847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffabcf0440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac0af020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9c12150>]}
[0m12:32:04.479129 [debug] [MainThread]: Flushing usage events
[0m12:32:05.828747 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:33:58.495916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f449460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d980a40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d930800>]}


============================== 12:33:58.500001 | adc94aa4-de49-4b37-a3e4-f2fc0777c3b6 ==============================
[0m12:33:58.500001 [info ] [MainThread]: Running with dbt=1.10.13
[0m12:33:58.501448 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'write_json': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'indirect_selection': 'eager', 'no_print': 'None', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'log_path': '/opt/airflow/dbt/logs', 'empty': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'version_check': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'quiet': 'False', 'introspect': 'True', 'use_experimental_parser': 'False'}
[0m12:33:58.672695 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m12:33:58.673195 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m12:33:58.673459 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m12:33:58.787720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'adc94aa4-de49-4b37-a3e4-f2fc0777c3b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7bb31b20>]}
[0m12:33:58.822860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'adc94aa4-de49-4b37-a3e4-f2fc0777c3b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e210ec0>]}
[0m12:33:58.823665 [info ] [MainThread]: Registered adapter: snowflake=1.10.3
[0m12:33:58.880014 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m12:33:59.025894 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:33:59.026403 [debug] [MainThread]: Partial parsing: updated file: citrus_trade://models/marts/importer_score.sql
[0m12:33:59.171996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'adc94aa4-de49-4b37-a3e4-f2fc0777c3b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b5d3230>]}
[0m12:33:59.224643 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m12:33:59.226177 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m12:33:59.235576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'adc94aa4-de49-4b37-a3e4-f2fc0777c3b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b5d34a0>]}
[0m12:33:59.235929 [info ] [MainThread]: Found 8 models, 3 sources, 636 macros
[0m12:33:59.236254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'adc94aa4-de49-4b37-a3e4-f2fc0777c3b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b84ca10>]}
[0m12:33:59.237451 [info ] [MainThread]: 
[0m12:33:59.237682 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:33:59.237894 [info ] [MainThread]: 
[0m12:33:59.238247 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:33:59.240905 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRADE_FLOW'
[0m12:33:59.246541 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRADE_FLOW'
[0m12:33:59.250795 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRADE_FLOW'
[0m12:33:59.290293 [debug] [ThreadPool]: Using snowflake connection "list_TRADE_FLOW"
[0m12:33:59.290668 [debug] [ThreadPool]: Using snowflake connection "list_TRADE_FLOW"
[0m12:33:59.290905 [debug] [ThreadPool]: Using snowflake connection "list_TRADE_FLOW"
[0m12:33:59.291067 [debug] [ThreadPool]: On list_TRADE_FLOW: show terse schemas in database TRADE_FLOW
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRADE_FLOW"} */
[0m12:33:59.291330 [debug] [ThreadPool]: On list_TRADE_FLOW: show terse schemas in database TRADE_FLOW
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRADE_FLOW"} */
[0m12:33:59.291558 [debug] [ThreadPool]: On list_TRADE_FLOW: show terse schemas in database TRADE_FLOW
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRADE_FLOW"} */
[0m12:33:59.291757 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:33:59.291957 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:33:59.292149 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:34:01.163464 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.871 seconds
[0m12:34:01.165947 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.874 seconds
[0m12:34:01.166886 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.875 seconds
[0m12:34:01.178644 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRADE_FLOW, now list_TRADE_FLOW_staging)
[0m12:34:01.185862 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRADE_FLOW, now list_TRADE_FLOW_marts)
[0m12:34:01.202443 [debug] [ThreadPool]: Using snowflake connection "list_TRADE_FLOW_staging"
[0m12:34:01.207990 [debug] [ThreadPool]: Using snowflake connection "list_TRADE_FLOW_marts"
[0m12:34:01.208439 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRADE_FLOW, now list_TRADE_FLOW_analytics)
[0m12:34:01.208752 [debug] [ThreadPool]: On list_TRADE_FLOW_staging: show objects in TRADE_FLOW.staging
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRADE_FLOW_staging"} */;
[0m12:34:01.209083 [debug] [ThreadPool]: On list_TRADE_FLOW_marts: show objects in TRADE_FLOW.marts
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRADE_FLOW_marts"} */;
[0m12:34:01.210889 [debug] [ThreadPool]: Using snowflake connection "list_TRADE_FLOW_analytics"
[0m12:34:01.212800 [debug] [ThreadPool]: On list_TRADE_FLOW_analytics: show objects in TRADE_FLOW.analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRADE_FLOW_analytics"} */;
[0m12:34:01.329068 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.116 seconds
[0m12:34:01.330505 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.119 seconds
[0m12:34:01.344786 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 0.132 seconds
[0m12:34:01.348406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'adc94aa4-de49-4b37-a3e4-f2fc0777c3b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ba6fbf0>]}
[0m12:34:01.352248 [debug] [Thread-1 (]: Began running node model.citrus_trade.stg_trade
[0m12:34:01.352812 [info ] [Thread-1 (]: 1 of 8 START sql table model staging.stg_trade ................................. [RUN]
[0m12:34:01.353409 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_TRADE_FLOW_marts, now model.citrus_trade.stg_trade)
[0m12:34:01.353882 [debug] [Thread-1 (]: Began compiling node model.citrus_trade.stg_trade
[0m12:34:01.361923 [debug] [Thread-1 (]: Writing injected SQL for node "model.citrus_trade.stg_trade"
[0m12:34:01.363993 [debug] [Thread-1 (]: Began executing node model.citrus_trade.stg_trade
[0m12:34:01.389005 [debug] [Thread-1 (]: Writing runtime sql for node "model.citrus_trade.stg_trade"
[0m12:34:01.390772 [debug] [Thread-1 (]: Using snowflake connection "model.citrus_trade.stg_trade"
[0m12:34:01.391060 [debug] [Thread-1 (]: On model.citrus_trade.stg_trade: create or replace transient table TRADE_FLOW.staging.stg_trade
    
    
    
    as (select
  value:DECLARANT::int as declarant,
  value:DECLARANT_ISO::string as declarant_iso,
  value:PARTNER::string as partner,
  value:PARTNER_ISO::string as partner_iso,
  value:FLOW::int as flow,
  value:TRANSPORT_MODE::int as transport_mode,
  value:PERIOD::int as period,
  year(to_date(left(period,4),'YYYY')) as year,
  value:HS4::string as hs4,
  value:HS4_NAME::string as hs4_name,
  value:HS6::string as hs6,
  value:HS6_NAME::string as hs6_name,
  value:VALUE_IN_EUROS::float as value_in_euros,
  value:QUANTITY_IN_KG::float as quantity_in_kg
from trade_flow.raw.raw_trhs
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.stg_trade"} */;
[0m12:34:02.103989 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.712 seconds
[0m12:34:02.131434 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'adc94aa4-de49-4b37-a3e4-f2fc0777c3b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f9b5b80>]}
[0m12:34:02.132350 [info ] [Thread-1 (]: 1 of 8 OK created sql table model staging.stg_trade ............................ [[32mSUCCESS 1[0m in 0.78s]
[0m12:34:02.133093 [debug] [Thread-1 (]: Finished running node model.citrus_trade.stg_trade
[0m12:34:02.134094 [debug] [Thread-3 (]: Began running node model.citrus_trade.trade_by_hs
[0m12:34:02.134661 [info ] [Thread-3 (]: 2 of 8 START sql table model marts.trade_by_hs ................................. [RUN]
[0m12:34:02.135190 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_TRADE_FLOW_analytics, now model.citrus_trade.trade_by_hs)
[0m12:34:02.135636 [debug] [Thread-3 (]: Began compiling node model.citrus_trade.trade_by_hs
[0m12:34:02.138521 [debug] [Thread-3 (]: Writing injected SQL for node "model.citrus_trade.trade_by_hs"
[0m12:34:02.140594 [debug] [Thread-3 (]: Began executing node model.citrus_trade.trade_by_hs
[0m12:34:02.144383 [debug] [Thread-3 (]: Writing runtime sql for node "model.citrus_trade.trade_by_hs"
[0m12:34:02.145444 [debug] [Thread-3 (]: Using snowflake connection "model.citrus_trade.trade_by_hs"
[0m12:34:02.145744 [debug] [Thread-3 (]: On model.citrus_trade.trade_by_hs: create or replace transient table TRADE_FLOW.marts.trade_by_hs
    
    
    
    as (select
    *
from TRADE_FLOW.staging.stg_trade
where hs6 = '080510'
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.trade_by_hs"} */;
[0m12:34:03.012695 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.866 seconds
[0m12:34:03.017211 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'adc94aa4-de49-4b37-a3e4-f2fc0777c3b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff79d84f50>]}
[0m12:34:03.018197 [info ] [Thread-3 (]: 2 of 8 OK created sql table model marts.trade_by_hs ............................ [[32mSUCCESS 1[0m in 0.88s]
[0m12:34:03.019006 [debug] [Thread-3 (]: Finished running node model.citrus_trade.trade_by_hs
[0m12:34:03.020105 [debug] [Thread-2 (]: Began running node model.citrus_trade.imports_by_year
[0m12:34:03.020513 [debug] [Thread-1 (]: Began running node model.citrus_trade.imports_exports_2020
[0m12:34:03.020921 [info ] [Thread-2 (]: 3 of 8 START sql table model marts.imports_by_year ............................. [RUN]
[0m12:34:03.021529 [info ] [Thread-1 (]: 4 of 8 START sql table model marts.imports_exports_2020 ........................ [RUN]
[0m12:34:03.022775 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.citrus_trade.stg_trade, now model.citrus_trade.imports_exports_2020)
[0m12:34:03.023145 [debug] [Thread-1 (]: Began compiling node model.citrus_trade.imports_exports_2020
[0m12:34:03.022219 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_TRADE_FLOW_staging, now model.citrus_trade.imports_by_year)
[0m12:34:03.026518 [debug] [Thread-1 (]: Writing injected SQL for node "model.citrus_trade.imports_exports_2020"
[0m12:34:03.027815 [debug] [Thread-2 (]: Began compiling node model.citrus_trade.imports_by_year
[0m12:34:03.031340 [debug] [Thread-2 (]: Writing injected SQL for node "model.citrus_trade.imports_by_year"
[0m12:34:03.032583 [debug] [Thread-1 (]: Began executing node model.citrus_trade.imports_exports_2020
[0m12:34:03.035114 [debug] [Thread-1 (]: Writing runtime sql for node "model.citrus_trade.imports_exports_2020"
[0m12:34:03.035781 [debug] [Thread-2 (]: Began executing node model.citrus_trade.imports_by_year
[0m12:34:03.037870 [debug] [Thread-2 (]: Writing runtime sql for node "model.citrus_trade.imports_by_year"
[0m12:34:03.039074 [debug] [Thread-1 (]: Using snowflake connection "model.citrus_trade.imports_exports_2020"
[0m12:34:03.039406 [debug] [Thread-1 (]: On model.citrus_trade.imports_exports_2020: create or replace transient table TRADE_FLOW.marts.imports_exports_2020
    
    
    
    as (select
    declarant_iso,
    flow,
    sum(value_in_euros) over(partition by declarant_iso, flow) as total_value,
    sum(quantity_in_kg) over(partition by declarant_iso, flow) as total_quantity,
    total_value/nullif(total_quantity,0) as value_per_quantity
from TRADE_FLOW.marts.trade_by_hs
where year = 2020
group by 
    declarant_iso,
    flow,
    value_in_euros,
    quantity_in_kg
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.imports_exports_2020"} */;
[0m12:34:03.041570 [debug] [Thread-2 (]: Using snowflake connection "model.citrus_trade.imports_by_year"
[0m12:34:03.042180 [debug] [Thread-2 (]: On model.citrus_trade.imports_by_year: create or replace transient table TRADE_FLOW.marts.imports_by_year
    
    
    
    as (select
    declarant_iso,
    year,
    sum(value_in_euros) as total_value,
    sum(quantity_in_kg) as total_quantity,
    total_value/nullif(total_quantity,0) as value_per_quantity
from TRADE_FLOW.marts.trade_by_hs
where flow = 1
group by 1,2
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.imports_by_year"} */;
[0m12:34:03.836607 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.793 seconds
[0m12:34:03.838889 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.799 seconds
[0m12:34:03.843831 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'adc94aa4-de49-4b37-a3e4-f2fc0777c3b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7a550ce0>]}
[0m12:34:03.846918 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'adc94aa4-de49-4b37-a3e4-f2fc0777c3b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7997d190>]}
[0m12:34:03.848131 [info ] [Thread-2 (]: 3 of 8 OK created sql table model marts.imports_by_year ........................ [[32mSUCCESS 1[0m in 0.82s]
[0m12:34:03.850221 [debug] [Thread-2 (]: Finished running node model.citrus_trade.imports_by_year
[0m12:34:03.849183 [info ] [Thread-1 (]: 4 of 8 OK created sql table model marts.imports_exports_2020 ................... [[32mSUCCESS 1[0m in 0.82s]
[0m12:34:03.851455 [debug] [Thread-1 (]: Finished running node model.citrus_trade.imports_exports_2020
[0m12:34:03.851933 [debug] [Thread-3 (]: Began running node model.citrus_trade.growth_score
[0m12:34:03.852733 [debug] [Thread-2 (]: Began running node model.citrus_trade.score_2020
[0m12:34:03.853452 [info ] [Thread-3 (]: 5 of 8 START sql table model marts.growth_score ................................ [RUN]
[0m12:34:03.854355 [info ] [Thread-2 (]: 6 of 8 START sql table model marts.score_2020 .................................. [RUN]
[0m12:34:03.855113 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.citrus_trade.trade_by_hs, now model.citrus_trade.growth_score)
[0m12:34:03.855707 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.citrus_trade.imports_by_year, now model.citrus_trade.score_2020)
[0m12:34:03.856287 [debug] [Thread-3 (]: Began compiling node model.citrus_trade.growth_score
[0m12:34:03.856783 [debug] [Thread-2 (]: Began compiling node model.citrus_trade.score_2020
[0m12:34:03.861769 [debug] [Thread-3 (]: Writing injected SQL for node "model.citrus_trade.growth_score"
[0m12:34:03.865060 [debug] [Thread-2 (]: Writing injected SQL for node "model.citrus_trade.score_2020"
[0m12:34:03.867426 [debug] [Thread-2 (]: Began executing node model.citrus_trade.score_2020
[0m12:34:03.867766 [debug] [Thread-3 (]: Began executing node model.citrus_trade.growth_score
[0m12:34:03.870856 [debug] [Thread-2 (]: Writing runtime sql for node "model.citrus_trade.score_2020"
[0m12:34:03.875766 [debug] [Thread-3 (]: Writing runtime sql for node "model.citrus_trade.growth_score"
[0m12:34:03.878382 [debug] [Thread-2 (]: Using snowflake connection "model.citrus_trade.score_2020"
[0m12:34:03.881642 [debug] [Thread-2 (]: On model.citrus_trade.score_2020: create or replace transient table TRADE_FLOW.marts.score_2020
    
    
    
    as (select distinct 
    declarant_iso,
    total_value,
    total_quantity,
    value_per_quantity,
    (total_value - min(total_value) over())/((max(total_value) over())-(min(total_value) over())) as value_score,
    (total_quantity - min(total_quantity) over())/((max(total_quantity) over())-(min(total_quantity) over())) as quantity_score,
    (value_per_quantity - min(value_per_quantity) over())/((max(value_per_quantity) over())-(min(value_per_quantity) over())) as price_score
from TRADE_FLOW.marts.imports_exports_2020
where flow = 1
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.score_2020"} */;
[0m12:34:03.881358 [debug] [Thread-3 (]: Using snowflake connection "model.citrus_trade.growth_score"
[0m12:34:03.883754 [debug] [Thread-3 (]: On model.citrus_trade.growth_score: create or replace transient table TRADE_FLOW.marts.growth_score
    
    
    
    as (with 
    previous_year AS (
        select 
            declarant_iso,
            year,
            lag(total_value,1) over(partition by declarant_iso order by year) previous_year_value,
            total_value,
            first_value(total_value) over(partition by declarant_iso order by year) as first_year_value,
            last_value(total_value) over(partition by declarant_iso order by year) as last_year_value
        from TRADE_FLOW.marts.imports_by_year
    ),
    growth_speed AS (
        select 
            declarant_iso,
            year,
            first_year_value,
            last_year_value,
            last_year_value/nullif(first_year_value,0) as growth_overall,
            previous_year_value,
            total_value,
            (total_value - previous_year_value)/total_value * 100 as growth_speed 
        from previous_year
    ),
    previous_year_growth_speed AS (
        select 
            declarant_iso,
            year,
            first_year_value,
            last_year_value,
            growth_overall,
            previous_year_value,
            total_value as current_value,
            growth_speed,
            lag(growth_speed,1) over(partition by declarant_iso order by year) previous_year_growth_speed,
        from growth_speed
        order by 1,2
    ),
    base AS (
        select 
            declarant_iso,
            year,
            first_year_value,
            last_year_value,
            growth_overall,
            previous_year_value,
            current_value,
            previous_year_growth_speed,
            growth_speed,
            growth_speed - previous_year_growth_speed as growth_acceleration,
            avg(growth_acceleration) over(partition by declarant_iso) as avg_acceleration
        from previous_year_growth_speed
    ),
    ok as (
        select 
            declarant_iso,
            year,
            first_year_value,
            last_year_value,
            growth_overall,
            (growth_overall - min(growth_overall) OVER())/(max(growth_overall) OVER() - min(growth_overall) OVER()) as growth_overall_norm,
            previous_year_value,
            current_value,
            -- previous_year_growth_speed,
            growth_speed,
            growth_acceleration,
            avg_acceleration,
            (avg_acceleration - min(avg_acceleration) OVER())/(max(avg_acceleration) OVER() - min(avg_acceleration) OVER()) as avg_acceleration_norm
        from base 
    )
    select 
        distinct 
        declarant_iso,
        year,
        current_value,
        growth_speed,
        growth_acceleration,
        growth_overall,
        growth_overall_norm,
        avg_acceleration,
        avg_acceleration_norm,
        growth_overall_norm * avg_acceleration_norm as growth_score
    from ok
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.growth_score"} */;
[0m12:34:04.547000 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.665 seconds
[0m12:34:04.551582 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'adc94aa4-de49-4b37-a3e4-f2fc0777c3b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff799a5070>]}
[0m12:34:04.552830 [info ] [Thread-2 (]: 6 of 8 OK created sql table model marts.score_2020 ............................. [[32mSUCCESS 1[0m in 0.70s]
[0m12:34:04.554425 [debug] [Thread-2 (]: Finished running node model.citrus_trade.score_2020
[0m12:34:04.640860 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.756 seconds
[0m12:34:04.644949 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'adc94aa4-de49-4b37-a3e4-f2fc0777c3b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff799842f0>]}
[0m12:34:04.646163 [info ] [Thread-3 (]: 5 of 8 OK created sql table model marts.growth_score ........................... [[32mSUCCESS 1[0m in 0.79s]
[0m12:34:04.647866 [debug] [Thread-3 (]: Finished running node model.citrus_trade.growth_score
[0m12:34:04.649363 [debug] [Thread-1 (]: Began running node model.citrus_trade.importer_score
[0m12:34:04.650325 [info ] [Thread-1 (]: 7 of 8 START sql table model marts.importer_score .............................. [RUN]
[0m12:34:04.651674 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.citrus_trade.imports_exports_2020, now model.citrus_trade.importer_score)
[0m12:34:04.652464 [debug] [Thread-1 (]: Began compiling node model.citrus_trade.importer_score
[0m12:34:04.657839 [debug] [Thread-1 (]: Writing injected SQL for node "model.citrus_trade.importer_score"
[0m12:34:04.659862 [debug] [Thread-1 (]: Began executing node model.citrus_trade.importer_score
[0m12:34:04.662919 [debug] [Thread-1 (]: Writing runtime sql for node "model.citrus_trade.importer_score"
[0m12:34:04.664918 [debug] [Thread-1 (]: Using snowflake connection "model.citrus_trade.importer_score"
[0m12:34:04.665338 [debug] [Thread-1 (]: On model.citrus_trade.importer_score: create or replace transient table TRADE_FLOW.marts.importer_score
    
    
    
    as (with growth_score AS (
    select 
        declarant_iso,
        array_agg(object_construct('year',year,'revenue',cast(current_value as string))) within group (order by year) as revenue_by_year,
        growth_score
    from TRADE_FLOW.marts.growth_score
    group by declarant_iso
)


select distinct
    sc.declarant_iso,
    sc.total_value as revenue_total,
    sc.total_quantity as volume_total,
    sc.value_per_quantity as rate_avg,
    gs.revenue_by_year,
    sc.value_score as revenue_score,
    sc.quantity_score as volume_score,
    sc.price_score as rate_score,
    gs.growth_score
from TRADE_FLOW.marts.score_2020 as sc
inner join TRADE_FLOW.marts.growth_score as gs
    on gs.declarant_iso = sc.declarant_iso
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.importer_score"} */;
[0m12:34:04.808992 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01c040f2-0305-74a0-0004-20ca0002660a
[0m12:34:04.809563 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 20 at position 4
invalid identifier 'GS.REVENUE_BY_YEAR'
[0m12:34:04.813169 [debug] [Thread-1 (]: Database Error in model importer_score (models/marts/importer_score.sql)
  000904 (42000): SQL compilation error: error line 20 at position 4
  invalid identifier 'GS.REVENUE_BY_YEAR'
  compiled code at target/run/citrus_trade/models/marts/importer_score.sql
[0m12:34:04.813822 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'adc94aa4-de49-4b37-a3e4-f2fc0777c3b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff79d628a0>]}
[0m12:34:04.814550 [error] [Thread-1 (]: 7 of 8 ERROR creating sql table model marts.importer_score ..................... [[31mERROR[0m in 0.16s]
[0m12:34:04.815226 [debug] [Thread-1 (]: Finished running node model.citrus_trade.importer_score
[0m12:34:04.815897 [debug] [Thread-7 (]: Marking all children of 'model.citrus_trade.importer_score' to be skipped because of status 'error'.  Reason: Database Error in model importer_score (models/marts/importer_score.sql)
  000904 (42000): SQL compilation error: error line 20 at position 4
  invalid identifier 'GS.REVENUE_BY_YEAR'
  compiled code at target/run/citrus_trade/models/marts/importer_score.sql.
[0m12:34:04.817216 [debug] [Thread-2 (]: Began running node model.citrus_trade.viz_importer_score
[0m12:34:04.817666 [info ] [Thread-2 (]: 8 of 8 SKIP relation analytics.viz_importer_score .............................. [[33mSKIP[0m]
[0m12:34:04.818117 [debug] [Thread-2 (]: Finished running node model.citrus_trade.viz_importer_score
[0m12:34:04.819645 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:34:04.819966 [debug] [MainThread]: Connection 'model.citrus_trade.importer_score' was left open.
[0m12:34:04.820250 [debug] [MainThread]: On model.citrus_trade.importer_score: Close
[0m12:34:04.946511 [debug] [MainThread]: Connection 'model.citrus_trade.score_2020' was left open.
[0m12:34:04.947391 [debug] [MainThread]: On model.citrus_trade.score_2020: Close
[0m12:34:05.071040 [debug] [MainThread]: Connection 'model.citrus_trade.growth_score' was left open.
[0m12:34:05.071878 [debug] [MainThread]: On model.citrus_trade.growth_score: Close
[0m12:34:05.206831 [info ] [MainThread]: 
[0m12:34:05.207586 [info ] [MainThread]: Finished running 8 table models in 0 hours 0 minutes and 5.97 seconds (5.97s).
[0m12:34:05.209492 [debug] [MainThread]: Command end result
[0m12:34:05.255575 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m12:34:05.257850 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m12:34:05.267659 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/target/run_results.json
[0m12:34:05.268151 [info ] [MainThread]: 
[0m12:34:05.268862 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:34:05.269325 [info ] [MainThread]: 
[0m12:34:05.269775 [error] [MainThread]: [31mFailure in model importer_score (models/marts/importer_score.sql)[0m
[0m12:34:05.270111 [error] [MainThread]:   Database Error in model importer_score (models/marts/importer_score.sql)
  000904 (42000): SQL compilation error: error line 20 at position 4
  invalid identifier 'GS.REVENUE_BY_YEAR'
  compiled code at target/run/citrus_trade/models/marts/importer_score.sql
[0m12:34:05.270394 [info ] [MainThread]: 
[0m12:34:05.270729 [info ] [MainThread]:   compiled code at target/compiled/citrus_trade/models/marts/importer_score.sql
[0m12:34:05.270940 [info ] [MainThread]: 
[0m12:34:05.271386 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=1 NO-OP=0 TOTAL=8
[0m12:34:05.275285 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 6.821175, "process_in_blocks": "0", "process_kernel_time": 0.463916, "process_mem_max_rss": "151632", "process_out_blocks": "4295", "process_user_time": 2.113285}
[0m12:34:05.275698 [debug] [MainThread]: Command `dbt run` failed at 12:34:05.275615 after 6.82 seconds
[0m12:34:05.276098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b6e9ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d34aa50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d34aab0>]}
[0m12:34:05.276370 [debug] [MainThread]: Flushing usage events
[0m12:34:06.606309 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:34:39.182210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac408ce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffabb42ab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffabb432c0>]}


============================== 12:34:39.185436 | 880620ba-fb59-4407-880c-b71043028b65 ==============================
[0m12:34:39.185436 [info ] [MainThread]: Running with dbt=1.10.13
[0m12:34:39.185951 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run', 'use_experimental_parser': 'False', 'no_print': 'None', 'empty': 'False', 'printer_width': '80', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'fail_fast': 'False', 'log_cache_events': 'False', 'write_json': 'True', 'introspect': 'True', 'indirect_selection': 'eager', 'target_path': 'None', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'cache_selected_only': 'False', 'partial_parse': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True'}
[0m12:34:39.330173 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m12:34:39.330619 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m12:34:39.330802 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m12:34:39.428101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '880620ba-fb59-4407-880c-b71043028b65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9f87170>]}
[0m12:34:39.458431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '880620ba-fb59-4407-880c-b71043028b65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9d627e0>]}
[0m12:34:39.458938 [info ] [MainThread]: Registered adapter: snowflake=1.10.3
[0m12:34:39.509287 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m12:34:39.638651 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m12:34:39.639123 [debug] [MainThread]: Partial parsing: updated file: citrus_trade://models/marts/growth_score.sql
[0m12:34:39.639356 [debug] [MainThread]: Partial parsing: updated file: citrus_trade://models/marts/importer_score.sql
[0m12:34:39.765894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '880620ba-fb59-4407-880c-b71043028b65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9cf4fe0>]}
[0m12:34:39.821839 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m12:34:39.823237 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m12:34:39.830786 [error] [MainThread]: Encountered an error:
Found a cycle: model.citrus_trade.growth_score
[0m12:34:39.832962 [error] [MainThread]: Traceback (most recent call last):
  File "/usr/local/lib/python3.12/site-packages/dbt/cli/requires.py", line 178, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/cli/requires.py", line 128, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/cli/requires.py", line 272, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/cli/requires.py", line 303, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/cli/requires.py", line 373, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/cli/requires.py", line 350, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/cli/requires.py", line 390, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/cli/main.py", line 587, in run
    results = task.run()
              ^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/task/runnable.py", line 583, in run
    self._runtime_initialize()
  File "/usr/local/lib/python3.12/site-packages/dbt/task/compile.py", line 133, in _runtime_initialize
    super()._runtime_initialize()
  File "/usr/local/lib/python3.12/site-packages/dbt/task/runnable.py", line 170, in _runtime_initialize
    self.compile_manifest()
  File "/usr/local/lib/python3.12/site-packages/dbt/task/base.py", line 135, in compile_manifest
    self.graph = self.compiler.compile(self.manifest)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/compilation.py", line 662, in compile
    linker.link_graph(manifest)
  File "/usr/local/lib/python3.12/site-packages/dbt/compilation.py", line 206, in link_graph
    raise RuntimeError("Found a cycle: {}".format(cycle))
RuntimeError: Found a cycle: model.citrus_trade.growth_score

[0m12:34:39.833900 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.6835084, "process_in_blocks": "88", "process_kernel_time": 0.306671, "process_mem_max_rss": "133072", "process_out_blocks": "2775", "process_user_time": 1.255749}
[0m12:34:39.834406 [debug] [MainThread]: Command `dbt run` failed at 12:34:39.834311 after 0.68 seconds
[0m12:34:39.834636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffab510b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa98ba750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9c9e600>]}
[0m12:34:39.834815 [debug] [MainThread]: Flushing usage events
[0m12:34:41.242649 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:38:00.793312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff975e75c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95a35520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94f683b0>]}


============================== 12:38:00.800315 | f9127e49-959f-4c26-b746-daab71960987 ==============================
[0m12:38:00.800315 [info ] [MainThread]: Running with dbt=1.10.13
[0m12:38:00.801165 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '/opt/airflow/dbt', 'empty': 'False', 'version_check': 'True', 'indirect_selection': 'eager', 'static_parser': 'True', 'invocation_command': 'dbt run', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'introspect': 'True', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'cache_selected_only': 'False', 'write_json': 'True', 'use_colors': 'True', 'debug': 'False', 'log_cache_events': 'False', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'quiet': 'False', 'target_path': 'None', 'log_format': 'default', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:38:00.965093 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m12:38:00.965546 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m12:38:00.965735 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m12:38:01.066636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f9127e49-959f-4c26-b746-daab71960987', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94d88350>]}
[0m12:38:01.102635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f9127e49-959f-4c26-b746-daab71960987', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93e957f0>]}
[0m12:38:01.103386 [info ] [MainThread]: Registered adapter: snowflake=1.10.3
[0m12:38:01.159646 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m12:38:01.303176 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:38:01.303663 [debug] [MainThread]: Partial parsing: updated file: citrus_trade://models/marts/growth_score.sql
[0m12:38:01.451092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f9127e49-959f-4c26-b746-daab71960987', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93776a50>]}
[0m12:38:01.512634 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m12:38:01.514701 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m12:38:01.528432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f9127e49-959f-4c26-b746-daab71960987', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff932c4770>]}
[0m12:38:01.528781 [info ] [MainThread]: Found 8 models, 3 sources, 636 macros
[0m12:38:01.529044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f9127e49-959f-4c26-b746-daab71960987', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93405160>]}
[0m12:38:01.530448 [info ] [MainThread]: 
[0m12:38:01.530861 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:38:01.531178 [info ] [MainThread]: 
[0m12:38:01.531545 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:38:01.534673 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRADE_FLOW'
[0m12:38:01.540914 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRADE_FLOW'
[0m12:38:01.544261 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRADE_FLOW'
[0m12:38:01.569674 [debug] [ThreadPool]: Using snowflake connection "list_TRADE_FLOW"
[0m12:38:01.570008 [debug] [ThreadPool]: Using snowflake connection "list_TRADE_FLOW"
[0m12:38:01.570211 [debug] [ThreadPool]: Using snowflake connection "list_TRADE_FLOW"
[0m12:38:01.570358 [debug] [ThreadPool]: On list_TRADE_FLOW: show terse schemas in database TRADE_FLOW
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRADE_FLOW"} */
[0m12:38:01.570586 [debug] [ThreadPool]: On list_TRADE_FLOW: show terse schemas in database TRADE_FLOW
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRADE_FLOW"} */
[0m12:38:01.570802 [debug] [ThreadPool]: On list_TRADE_FLOW: show terse schemas in database TRADE_FLOW
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRADE_FLOW"} */
[0m12:38:01.571006 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:38:01.571208 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:38:01.571417 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:38:03.365886 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.794 seconds
[0m12:38:03.367705 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.796 seconds
[0m12:38:03.375442 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.804 seconds
[0m12:38:03.384173 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRADE_FLOW, now list_TRADE_FLOW_marts)
[0m12:38:03.385286 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRADE_FLOW, now list_TRADE_FLOW_analytics)
[0m12:38:03.392023 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRADE_FLOW, now list_TRADE_FLOW_staging)
[0m12:38:03.411726 [debug] [ThreadPool]: Using snowflake connection "list_TRADE_FLOW_analytics"
[0m12:38:03.414517 [debug] [ThreadPool]: Using snowflake connection "list_TRADE_FLOW_marts"
[0m12:38:03.416761 [debug] [ThreadPool]: Using snowflake connection "list_TRADE_FLOW_staging"
[0m12:38:03.417272 [debug] [ThreadPool]: On list_TRADE_FLOW_analytics: show objects in TRADE_FLOW.analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRADE_FLOW_analytics"} */;
[0m12:38:03.417698 [debug] [ThreadPool]: On list_TRADE_FLOW_marts: show objects in TRADE_FLOW.marts
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRADE_FLOW_marts"} */;
[0m12:38:03.418142 [debug] [ThreadPool]: On list_TRADE_FLOW_staging: show objects in TRADE_FLOW.staging
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRADE_FLOW_staging"} */;
[0m12:38:03.544182 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.124 seconds
[0m12:38:03.544825 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.126 seconds
[0m12:38:03.560824 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 0.142 seconds
[0m12:38:03.563128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f9127e49-959f-4c26-b746-daab71960987', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff935d2780>]}
[0m12:38:03.565822 [debug] [Thread-1 (]: Began running node model.citrus_trade.stg_trade
[0m12:38:03.566288 [info ] [Thread-1 (]: 1 of 8 START sql table model staging.stg_trade ................................. [RUN]
[0m12:38:03.566712 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_TRADE_FLOW_marts, now model.citrus_trade.stg_trade)
[0m12:38:03.567028 [debug] [Thread-1 (]: Began compiling node model.citrus_trade.stg_trade
[0m12:38:03.572116 [debug] [Thread-1 (]: Writing injected SQL for node "model.citrus_trade.stg_trade"
[0m12:38:03.573904 [debug] [Thread-1 (]: Began executing node model.citrus_trade.stg_trade
[0m12:38:03.591781 [debug] [Thread-1 (]: Writing runtime sql for node "model.citrus_trade.stg_trade"
[0m12:38:03.593301 [debug] [Thread-1 (]: Using snowflake connection "model.citrus_trade.stg_trade"
[0m12:38:03.593563 [debug] [Thread-1 (]: On model.citrus_trade.stg_trade: create or replace transient table TRADE_FLOW.staging.stg_trade
    
    
    
    as (select
  value:DECLARANT::int as declarant,
  value:DECLARANT_ISO::string as declarant_iso,
  value:PARTNER::string as partner,
  value:PARTNER_ISO::string as partner_iso,
  value:FLOW::int as flow,
  value:TRANSPORT_MODE::int as transport_mode,
  value:PERIOD::int as period,
  year(to_date(left(period,4),'YYYY')) as year,
  value:HS4::string as hs4,
  value:HS4_NAME::string as hs4_name,
  value:HS6::string as hs6,
  value:HS6_NAME::string as hs6_name,
  value:VALUE_IN_EUROS::float as value_in_euros,
  value:QUANTITY_IN_KG::float as quantity_in_kg
from trade_flow.raw.raw_trhs
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.stg_trade"} */;
[0m12:38:04.264345 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.670 seconds
[0m12:38:04.279110 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f9127e49-959f-4c26-b746-daab71960987', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97725a90>]}
[0m12:38:04.279675 [info ] [Thread-1 (]: 1 of 8 OK created sql table model staging.stg_trade ............................ [[32mSUCCESS 1[0m in 0.71s]
[0m12:38:04.280151 [debug] [Thread-1 (]: Finished running node model.citrus_trade.stg_trade
[0m12:38:04.280797 [debug] [Thread-3 (]: Began running node model.citrus_trade.trade_by_hs
[0m12:38:04.281160 [info ] [Thread-3 (]: 2 of 8 START sql table model marts.trade_by_hs ................................. [RUN]
[0m12:38:04.281505 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_TRADE_FLOW_staging, now model.citrus_trade.trade_by_hs)
[0m12:38:04.281780 [debug] [Thread-3 (]: Began compiling node model.citrus_trade.trade_by_hs
[0m12:38:04.283752 [debug] [Thread-3 (]: Writing injected SQL for node "model.citrus_trade.trade_by_hs"
[0m12:38:04.284921 [debug] [Thread-3 (]: Began executing node model.citrus_trade.trade_by_hs
[0m12:38:04.287655 [debug] [Thread-3 (]: Writing runtime sql for node "model.citrus_trade.trade_by_hs"
[0m12:38:04.288565 [debug] [Thread-3 (]: Using snowflake connection "model.citrus_trade.trade_by_hs"
[0m12:38:04.288757 [debug] [Thread-3 (]: On model.citrus_trade.trade_by_hs: create or replace transient table TRADE_FLOW.marts.trade_by_hs
    
    
    
    as (select
    *
from TRADE_FLOW.staging.stg_trade
where hs6 = '080510'
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.trade_by_hs"} */;
[0m12:38:04.980392 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.691 seconds
[0m12:38:04.983879 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f9127e49-959f-4c26-b746-daab71960987', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff977f9610>]}
[0m12:38:04.985124 [info ] [Thread-3 (]: 2 of 8 OK created sql table model marts.trade_by_hs ............................ [[32mSUCCESS 1[0m in 0.70s]
[0m12:38:04.985788 [debug] [Thread-3 (]: Finished running node model.citrus_trade.trade_by_hs
[0m12:38:04.986607 [debug] [Thread-2 (]: Began running node model.citrus_trade.imports_by_year
[0m12:38:04.986870 [debug] [Thread-1 (]: Began running node model.citrus_trade.imports_exports_2020
[0m12:38:04.987615 [info ] [Thread-1 (]: 4 of 8 START sql table model marts.imports_exports_2020 ........................ [RUN]
[0m12:38:04.987138 [info ] [Thread-2 (]: 3 of 8 START sql table model marts.imports_by_year ............................. [RUN]
[0m12:38:04.988350 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_TRADE_FLOW_analytics, now model.citrus_trade.imports_by_year)
[0m12:38:04.988005 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.citrus_trade.stg_trade, now model.citrus_trade.imports_exports_2020)
[0m12:38:04.988931 [debug] [Thread-1 (]: Began compiling node model.citrus_trade.imports_exports_2020
[0m12:38:04.988650 [debug] [Thread-2 (]: Began compiling node model.citrus_trade.imports_by_year
[0m12:38:04.991233 [debug] [Thread-1 (]: Writing injected SQL for node "model.citrus_trade.imports_exports_2020"
[0m12:38:04.993239 [debug] [Thread-2 (]: Writing injected SQL for node "model.citrus_trade.imports_by_year"
[0m12:38:04.994880 [debug] [Thread-1 (]: Began executing node model.citrus_trade.imports_exports_2020
[0m12:38:04.996891 [debug] [Thread-1 (]: Writing runtime sql for node "model.citrus_trade.imports_exports_2020"
[0m12:38:04.997177 [debug] [Thread-2 (]: Began executing node model.citrus_trade.imports_by_year
[0m12:38:04.998823 [debug] [Thread-2 (]: Writing runtime sql for node "model.citrus_trade.imports_by_year"
[0m12:38:04.999992 [debug] [Thread-1 (]: Using snowflake connection "model.citrus_trade.imports_exports_2020"
[0m12:38:05.000452 [debug] [Thread-1 (]: On model.citrus_trade.imports_exports_2020: create or replace transient table TRADE_FLOW.marts.imports_exports_2020
    
    
    
    as (select
    declarant_iso,
    flow,
    sum(value_in_euros) over(partition by declarant_iso, flow) as total_value,
    sum(quantity_in_kg) over(partition by declarant_iso, flow) as total_quantity,
    total_value/nullif(total_quantity,0) as value_per_quantity
from TRADE_FLOW.marts.trade_by_hs
where year = 2020
group by 
    declarant_iso,
    flow,
    value_in_euros,
    quantity_in_kg
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.imports_exports_2020"} */;
[0m12:38:05.002695 [debug] [Thread-2 (]: Using snowflake connection "model.citrus_trade.imports_by_year"
[0m12:38:05.003016 [debug] [Thread-2 (]: On model.citrus_trade.imports_by_year: create or replace transient table TRADE_FLOW.marts.imports_by_year
    
    
    
    as (select
    declarant_iso,
    year,
    sum(value_in_euros) as total_value,
    sum(quantity_in_kg) as total_quantity,
    total_value/nullif(total_quantity,0) as value_per_quantity
from TRADE_FLOW.marts.trade_by_hs
where flow = 1
group by 1,2
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.imports_by_year"} */;
[0m12:38:05.697572 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.694 seconds
[0m12:38:05.700820 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f9127e49-959f-4c26-b746-daab71960987', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9173d0a0>]}
[0m12:38:05.701457 [info ] [Thread-2 (]: 3 of 8 OK created sql table model marts.imports_by_year ........................ [[32mSUCCESS 1[0m in 0.71s]
[0m12:38:05.702025 [debug] [Thread-2 (]: Finished running node model.citrus_trade.imports_by_year
[0m12:38:05.698618 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.698 seconds
[0m12:38:05.703607 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f9127e49-959f-4c26-b746-daab71960987', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9173ca40>]}
[0m12:38:05.704131 [info ] [Thread-1 (]: 4 of 8 OK created sql table model marts.imports_exports_2020 ................... [[32mSUCCESS 1[0m in 0.72s]
[0m12:38:05.704468 [debug] [Thread-3 (]: Began running node model.citrus_trade.growth_score
[0m12:38:05.704937 [debug] [Thread-1 (]: Finished running node model.citrus_trade.imports_exports_2020
[0m12:38:05.705285 [info ] [Thread-3 (]: 5 of 8 START sql table model marts.growth_score ................................ [RUN]
[0m12:38:05.705975 [debug] [Thread-2 (]: Began running node model.citrus_trade.score_2020
[0m12:38:05.706247 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.citrus_trade.trade_by_hs, now model.citrus_trade.growth_score)
[0m12:38:05.706558 [info ] [Thread-2 (]: 6 of 8 START sql table model marts.score_2020 .................................. [RUN]
[0m12:38:05.707002 [debug] [Thread-3 (]: Began compiling node model.citrus_trade.growth_score
[0m12:38:05.707287 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.citrus_trade.imports_by_year, now model.citrus_trade.score_2020)
[0m12:38:05.710161 [debug] [Thread-3 (]: Writing injected SQL for node "model.citrus_trade.growth_score"
[0m12:38:05.710490 [debug] [Thread-2 (]: Began compiling node model.citrus_trade.score_2020
[0m12:38:05.712697 [debug] [Thread-2 (]: Writing injected SQL for node "model.citrus_trade.score_2020"
[0m12:38:05.714069 [debug] [Thread-3 (]: Began executing node model.citrus_trade.growth_score
[0m12:38:05.716605 [debug] [Thread-3 (]: Writing runtime sql for node "model.citrus_trade.growth_score"
[0m12:38:05.717148 [debug] [Thread-2 (]: Began executing node model.citrus_trade.score_2020
[0m12:38:05.719590 [debug] [Thread-2 (]: Writing runtime sql for node "model.citrus_trade.score_2020"
[0m12:38:05.723758 [debug] [Thread-3 (]: Using snowflake connection "model.citrus_trade.growth_score"
[0m12:38:05.724549 [debug] [Thread-3 (]: On model.citrus_trade.growth_score: create or replace transient table TRADE_FLOW.marts.growth_score
    
    
    
    as (with 
    previous_year AS (
        select 
            declarant_iso,
            year,
            lag(total_value,1) over(partition by declarant_iso order by year) previous_year_value,
            total_value,
            first_value(total_value) over(partition by declarant_iso order by year) as first_year_value,
            last_value(total_value) over(partition by declarant_iso order by year) as last_year_value
        from TRADE_FLOW.marts.imports_by_year
    ),
    growth_speed AS (
        select 
            declarant_iso,
            year,
            first_year_value,
            last_year_value,
            last_year_value/nullif(first_year_value,0) as growth_overall,
            previous_year_value,
            total_value,
            (total_value - previous_year_value)/total_value * 100 as growth_speed 
        from previous_year
    ),
    previous_year_growth_speed AS (
        select 
            declarant_iso,
            year,
            first_year_value,
            last_year_value,
            growth_overall,
            previous_year_value,
            total_value as current_value,
            growth_speed,
            lag(growth_speed,1) over(partition by declarant_iso order by year) previous_year_growth_speed,
        from growth_speed
        order by 1,2
    ),
    base AS (
        select 
            declarant_iso,
            year,
            first_year_value,
            last_year_value,
            growth_overall,
            previous_year_value,
            current_value,
            previous_year_growth_speed,
            growth_speed,
            growth_speed - previous_year_growth_speed as growth_acceleration,
            avg(growth_acceleration) over(partition by declarant_iso) as avg_acceleration
        from previous_year_growth_speed
    ),
    ok as (
        select 
            declarant_iso,
            year,
            first_year_value,
            last_year_value,
            growth_overall,
            (growth_overall - min(growth_overall) OVER())/(max(growth_overall) OVER() - min(growth_overall) OVER()) as growth_overall_norm,
            previous_year_value,
            current_value,
            -- previous_year_growth_speed,
            growth_speed,
            growth_acceleration,
            avg_acceleration,
            (avg_acceleration - min(avg_acceleration) OVER())/(max(avg_acceleration) OVER() - min(avg_acceleration) OVER()) as avg_acceleration_norm
        from base 
    )
    select 
        declarant_iso,
        growth_overall_norm * avg_acceleration_norm as growth_score,
        array_agg(object_construct('year',year,'revenue',cast(current_value as string))) within group (order by year) as revenue_by_year
    from ok 
    group by 1,2
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.growth_score"} */;
[0m12:38:05.725726 [debug] [Thread-2 (]: Using snowflake connection "model.citrus_trade.score_2020"
[0m12:38:05.727714 [debug] [Thread-2 (]: On model.citrus_trade.score_2020: create or replace transient table TRADE_FLOW.marts.score_2020
    
    
    
    as (select distinct 
    declarant_iso,
    total_value,
    total_quantity,
    value_per_quantity,
    (total_value - min(total_value) over())/((max(total_value) over())-(min(total_value) over())) as value_score,
    (total_quantity - min(total_quantity) over())/((max(total_quantity) over())-(min(total_quantity) over())) as quantity_score,
    (value_per_quantity - min(value_per_quantity) over())/((max(value_per_quantity) over())-(min(value_per_quantity) over())) as price_score
from TRADE_FLOW.marts.imports_exports_2020
where flow = 1
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.score_2020"} */;
[0m12:38:06.517004 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.789 seconds
[0m12:38:06.518289 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.792 seconds
[0m12:38:06.521318 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f9127e49-959f-4c26-b746-daab71960987', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff917b4770>]}
[0m12:38:06.521777 [info ] [Thread-3 (]: 5 of 8 OK created sql table model marts.growth_score ........................... [[32mSUCCESS 1[0m in 0.82s]
[0m12:38:06.522270 [debug] [Thread-3 (]: Finished running node model.citrus_trade.growth_score
[0m12:38:06.520174 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f9127e49-959f-4c26-b746-daab71960987', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff917933b0>]}
[0m12:38:06.522900 [info ] [Thread-2 (]: 6 of 8 OK created sql table model marts.score_2020 ............................. [[32mSUCCESS 1[0m in 0.81s]
[0m12:38:06.523309 [debug] [Thread-2 (]: Finished running node model.citrus_trade.score_2020
[0m12:38:06.524130 [debug] [Thread-1 (]: Began running node model.citrus_trade.importer_score
[0m12:38:06.524393 [info ] [Thread-1 (]: 7 of 8 START sql table model marts.importer_score .............................. [RUN]
[0m12:38:06.524749 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.citrus_trade.imports_exports_2020, now model.citrus_trade.importer_score)
[0m12:38:06.525022 [debug] [Thread-1 (]: Began compiling node model.citrus_trade.importer_score
[0m12:38:06.527700 [debug] [Thread-1 (]: Writing injected SQL for node "model.citrus_trade.importer_score"
[0m12:38:06.529158 [debug] [Thread-1 (]: Began executing node model.citrus_trade.importer_score
[0m12:38:06.531189 [debug] [Thread-1 (]: Writing runtime sql for node "model.citrus_trade.importer_score"
[0m12:38:06.532419 [debug] [Thread-1 (]: Using snowflake connection "model.citrus_trade.importer_score"
[0m12:38:06.532672 [debug] [Thread-1 (]: On model.citrus_trade.importer_score: create or replace transient table TRADE_FLOW.marts.importer_score
    
    
    
    as (select distinct
    sc.declarant_iso,
    sc.total_value as revenue_total,
    sc.total_quantity as volume_total,
    sc.value_per_quantity as rate_avg,
    gs.revenue_by_year,
    sc.value_score as revenue_score,
    sc.quantity_score as volume_score,
    sc.price_score as rate_score,
    gs.growth_score
from TRADE_FLOW.marts.score_2020 as sc
inner join TRADE_FLOW.marts.growth_score as gs
    on gs.declarant_iso = sc.declarant_iso
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.importer_score"} */;
[0m12:38:07.337738 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.805 seconds
[0m12:38:07.340866 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f9127e49-959f-4c26-b746-daab71960987', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91729c40>]}
[0m12:38:07.341790 [info ] [Thread-1 (]: 7 of 8 OK created sql table model marts.importer_score ......................... [[32mSUCCESS 1[0m in 0.82s]
[0m12:38:07.342951 [debug] [Thread-1 (]: Finished running node model.citrus_trade.importer_score
[0m12:38:07.344114 [debug] [Thread-3 (]: Began running node model.citrus_trade.viz_importer_score
[0m12:38:07.344828 [info ] [Thread-3 (]: 8 of 8 START sql table model analytics.viz_importer_score ...................... [RUN]
[0m12:38:07.345435 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.citrus_trade.growth_score, now model.citrus_trade.viz_importer_score)
[0m12:38:07.346064 [debug] [Thread-3 (]: Began compiling node model.citrus_trade.viz_importer_score
[0m12:38:07.350308 [debug] [Thread-3 (]: Writing injected SQL for node "model.citrus_trade.viz_importer_score"
[0m12:38:07.352121 [debug] [Thread-3 (]: Began executing node model.citrus_trade.viz_importer_score
[0m12:38:07.355054 [debug] [Thread-3 (]: Writing runtime sql for node "model.citrus_trade.viz_importer_score"
[0m12:38:07.357143 [debug] [Thread-3 (]: Using snowflake connection "model.citrus_trade.viz_importer_score"
[0m12:38:07.357677 [debug] [Thread-3 (]: On model.citrus_trade.viz_importer_score: create or replace transient table TRADE_FLOW.analytics.viz_importer_score
    
    
    
    as (with 
    scores as (
        select 
            declarant_iso,
            score_type,
            score
        from TRADE_FLOW.marts.importer_score
        unpivot (
            score for score_type in (
                revenue_score as "revenue",
                volume_score as "volume",
                rate_score as "rate",
                growth_score as "growth"
            )
        )
    ),
    metrics as (
        select 
            declarant_iso,
            metric_type,
            metric
        from TRADE_FLOW.marts.importer_score
        unpivot (
            metric for metric_type in (
                revenue_total as "revenue",
                volume_total as "volume",
                rate_avg as "rate"
            )
        )
    )
select 
    s.declarant_iso,
    s.score_type,
    s.score,
    m.metric,
    case 
        when s.score_type = 'revenue' then 'Euro'
        when s.score_type = 'volume' then 'Kg'
        when s.score_type = 'rate' then 'Euro per Kg'
    end as metric_unit
from scores as s
left join metrics as m
    on s.declarant_iso = m.declarant_iso
    and s.score_type = m.metric_type
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.viz_importer_score"} */;
[0m12:38:07.938620 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.580 seconds
[0m12:38:07.944614 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f9127e49-959f-4c26-b746-daab71960987', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91791d60>]}
[0m12:38:07.946007 [info ] [Thread-3 (]: 8 of 8 OK created sql table model analytics.viz_importer_score ................. [[32mSUCCESS 1[0m in 0.60s]
[0m12:38:07.947174 [debug] [Thread-3 (]: Finished running node model.citrus_trade.viz_importer_score
[0m12:38:07.950079 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:38:07.950595 [debug] [MainThread]: Connection 'model.citrus_trade.importer_score' was left open.
[0m12:38:07.950935 [debug] [MainThread]: On model.citrus_trade.importer_score: Close
[0m12:38:08.086861 [debug] [MainThread]: Connection 'model.citrus_trade.score_2020' was left open.
[0m12:38:08.087719 [debug] [MainThread]: On model.citrus_trade.score_2020: Close
[0m12:38:08.240579 [debug] [MainThread]: Connection 'model.citrus_trade.viz_importer_score' was left open.
[0m12:38:08.241752 [debug] [MainThread]: On model.citrus_trade.viz_importer_score: Close
[0m12:38:08.374711 [info ] [MainThread]: 
[0m12:38:08.375583 [info ] [MainThread]: Finished running 8 table models in 0 hours 0 minutes and 6.84 seconds (6.84s).
[0m12:38:08.378107 [debug] [MainThread]: Command end result
[0m12:38:08.429837 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m12:38:08.433924 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m12:38:08.443342 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/target/run_results.json
[0m12:38:08.443639 [info ] [MainThread]: 
[0m12:38:08.443955 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:38:08.444263 [info ] [MainThread]: 
[0m12:38:08.444689 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=8
[0m12:38:08.445986 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.727857, "process_in_blocks": "0", "process_kernel_time": 0.354735, "process_mem_max_rss": "151364", "process_out_blocks": "4301", "process_user_time": 1.926858}
[0m12:38:08.446500 [debug] [MainThread]: Command `dbt run` succeeded at 12:38:08.446420 after 7.73 seconds
[0m12:38:08.446853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94f045f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92f60080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff933c1c70>]}
[0m12:38:08.447070 [debug] [MainThread]: Flushing usage events
[0m12:38:09.871196 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:33:56.054520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa03a19d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9fc97e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2065010>]}


============================== 23:33:56.062615 | 9db61d61-a2fa-49c8-a502-5e28082531d5 ==============================
[0m23:33:56.062615 [info ] [MainThread]: Running with dbt=1.10.13
[0m23:33:56.063264 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'target_path': 'None', 'cache_selected_only': 'False', 'write_json': 'True', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_cache_events': 'False', 'log_path': '/opt/airflow/dbt/logs', 'introspect': 'True', 'partial_parse': 'True', 'static_parser': 'True', 'log_format': 'default', 'warn_error': 'None', 'use_experimental_parser': 'False', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt run', 'version_check': 'True', 'quiet': 'False', 'empty': 'False'}
[0m23:33:56.342295 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m23:33:56.342988 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m23:33:56.343372 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m23:33:56.553736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9db61d61-a2fa-49c8-a502-5e28082531d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9df23ce0>]}
[0m23:33:56.585420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9db61d61-a2fa-49c8-a502-5e28082531d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9df44470>]}
[0m23:33:56.586137 [info ] [MainThread]: Registered adapter: snowflake=1.10.3
[0m23:33:56.663921 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m23:33:57.257579 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 4 files changed.
[0m23:33:57.259789 [debug] [MainThread]: Partial parsing: updated file: citrus_trade://models/marts/imports_exports_2020.sql
[0m23:33:57.260612 [debug] [MainThread]: Partial parsing: updated file: citrus_trade://models/marts/imports_by_year.sql
[0m23:33:57.261224 [debug] [MainThread]: Partial parsing: updated file: citrus_trade://models/marts/growth_score.sql
[0m23:33:57.261891 [debug] [MainThread]: Partial parsing: updated file: citrus_trade://models/marts/score_2020.sql
[0m23:33:57.549287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9db61d61-a2fa-49c8-a502-5e28082531d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9db68ef0>]}
[0m23:33:57.612658 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m23:33:57.616272 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m23:33:57.653125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9db61d61-a2fa-49c8-a502-5e28082531d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e00a480>]}
[0m23:33:57.653997 [info ] [MainThread]: Found 8 models, 3 sources, 636 macros
[0m23:33:57.655165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9db61d61-a2fa-49c8-a502-5e28082531d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9dc07710>]}
[0m23:33:57.657231 [info ] [MainThread]: 
[0m23:33:57.657776 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:33:57.658285 [info ] [MainThread]: 
[0m23:33:57.658979 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:33:57.663234 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRADE_FLOW'
[0m23:33:57.670163 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRADE_FLOW'
[0m23:33:57.674498 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRADE_FLOW'
[0m23:33:57.744035 [debug] [ThreadPool]: Using snowflake connection "list_TRADE_FLOW"
[0m23:33:57.744590 [debug] [ThreadPool]: Using snowflake connection "list_TRADE_FLOW"
[0m23:33:57.744881 [debug] [ThreadPool]: Using snowflake connection "list_TRADE_FLOW"
[0m23:33:57.745079 [debug] [ThreadPool]: On list_TRADE_FLOW: show terse schemas in database TRADE_FLOW
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRADE_FLOW"} */
[0m23:33:57.745367 [debug] [ThreadPool]: On list_TRADE_FLOW: show terse schemas in database TRADE_FLOW
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRADE_FLOW"} */
[0m23:33:57.745631 [debug] [ThreadPool]: On list_TRADE_FLOW: show terse schemas in database TRADE_FLOW
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRADE_FLOW"} */
[0m23:33:57.745985 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:33:57.746243 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:33:57.746557 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:33:59.718278 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.972 seconds
[0m23:33:59.719249 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.973 seconds
[0m23:33:59.793109 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 2.047 seconds
[0m23:33:59.796555 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRADE_FLOW, now list_TRADE_FLOW_analytics)
[0m23:33:59.805041 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRADE_FLOW, now list_TRADE_FLOW_marts)
[0m23:33:59.806850 [debug] [ThreadPool]: Using snowflake connection "list_TRADE_FLOW_analytics"
[0m23:33:59.807145 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRADE_FLOW, now list_TRADE_FLOW_staging)
[0m23:33:59.809112 [debug] [ThreadPool]: Using snowflake connection "list_TRADE_FLOW_marts"
[0m23:33:59.809559 [debug] [ThreadPool]: On list_TRADE_FLOW_analytics: show objects in TRADE_FLOW.analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRADE_FLOW_analytics"} */;
[0m23:33:59.811202 [debug] [ThreadPool]: Using snowflake connection "list_TRADE_FLOW_staging"
[0m23:33:59.811500 [debug] [ThreadPool]: On list_TRADE_FLOW_marts: show objects in TRADE_FLOW.marts
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRADE_FLOW_marts"} */;
[0m23:33:59.812874 [debug] [ThreadPool]: On list_TRADE_FLOW_staging: show objects in TRADE_FLOW.staging
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRADE_FLOW_staging"} */;
[0m23:33:59.898787 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.085 seconds
[0m23:33:59.905956 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.094 seconds
[0m23:33:59.910665 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 0.097 seconds
[0m23:33:59.913096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9db61d61-a2fa-49c8-a502-5e28082531d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9df9f680>]}
[0m23:33:59.921141 [debug] [Thread-1 (]: Began running node model.citrus_trade.stg_trade
[0m23:33:59.921791 [info ] [Thread-1 (]: 1 of 8 START sql table model staging.stg_trade ................................. [RUN]
[0m23:33:59.922370 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_TRADE_FLOW_marts, now model.citrus_trade.stg_trade)
[0m23:33:59.922703 [debug] [Thread-1 (]: Began compiling node model.citrus_trade.stg_trade
[0m23:33:59.928416 [debug] [Thread-1 (]: Writing injected SQL for node "model.citrus_trade.stg_trade"
[0m23:33:59.930263 [debug] [Thread-1 (]: Began executing node model.citrus_trade.stg_trade
[0m23:33:59.953747 [debug] [Thread-1 (]: Writing runtime sql for node "model.citrus_trade.stg_trade"
[0m23:33:59.956136 [debug] [Thread-1 (]: Using snowflake connection "model.citrus_trade.stg_trade"
[0m23:33:59.956540 [debug] [Thread-1 (]: On model.citrus_trade.stg_trade: create or replace transient table TRADE_FLOW.staging.stg_trade
    
    
    
    as (select
  value:DECLARANT::int as declarant,
  value:DECLARANT_ISO::string as declarant_iso,
  value:PARTNER::string as partner,
  value:PARTNER_ISO::string as partner_iso,
  value:FLOW::int as flow,
  value:TRANSPORT_MODE::int as transport_mode,
  value:PERIOD::int as period,
  year(to_date(left(period,4),'YYYY')) as year,
  value:HS4::string as hs4,
  value:HS4_NAME::string as hs4_name,
  value:HS6::string as hs6,
  value:HS6_NAME::string as hs6_name,
  value:VALUE_IN_EUROS::float as value_in_euros,
  value:QUANTITY_IN_KG::float as quantity_in_kg
from trade_flow.raw.raw_trhs
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.stg_trade"} */;
[0m23:34:01.617369 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.660 seconds
[0m23:34:01.655361 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9db61d61-a2fa-49c8-a502-5e28082531d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1ebd910>]}
[0m23:34:01.656361 [info ] [Thread-1 (]: 1 of 8 OK created sql table model staging.stg_trade ............................ [[32mSUCCESS 1[0m in 1.73s]
[0m23:34:01.657200 [debug] [Thread-1 (]: Finished running node model.citrus_trade.stg_trade
[0m23:34:01.658630 [debug] [Thread-3 (]: Began running node model.citrus_trade.trade_by_hs
[0m23:34:01.659224 [info ] [Thread-3 (]: 2 of 8 START sql table model marts.trade_by_hs ................................. [RUN]
[0m23:34:01.659756 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_TRADE_FLOW_staging, now model.citrus_trade.trade_by_hs)
[0m23:34:01.660176 [debug] [Thread-3 (]: Began compiling node model.citrus_trade.trade_by_hs
[0m23:34:01.663471 [debug] [Thread-3 (]: Writing injected SQL for node "model.citrus_trade.trade_by_hs"
[0m23:34:01.665222 [debug] [Thread-3 (]: Began executing node model.citrus_trade.trade_by_hs
[0m23:34:01.667630 [debug] [Thread-3 (]: Writing runtime sql for node "model.citrus_trade.trade_by_hs"
[0m23:34:01.668847 [debug] [Thread-3 (]: Using snowflake connection "model.citrus_trade.trade_by_hs"
[0m23:34:01.669143 [debug] [Thread-3 (]: On model.citrus_trade.trade_by_hs: create or replace transient table TRADE_FLOW.marts.trade_by_hs
    
    
    
    as (select
    *
from TRADE_FLOW.staging.stg_trade
where hs6 = '080510'
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.trade_by_hs"} */;
[0m23:34:02.344860 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.675 seconds
[0m23:34:02.352227 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9db61d61-a2fa-49c8-a502-5e28082531d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c083fe0>]}
[0m23:34:02.353778 [info ] [Thread-3 (]: 2 of 8 OK created sql table model marts.trade_by_hs ............................ [[32mSUCCESS 1[0m in 0.69s]
[0m23:34:02.354969 [debug] [Thread-3 (]: Finished running node model.citrus_trade.trade_by_hs
[0m23:34:02.356742 [debug] [Thread-2 (]: Began running node model.citrus_trade.imports_by_year
[0m23:34:02.357420 [debug] [Thread-1 (]: Began running node model.citrus_trade.imports_exports_2020
[0m23:34:02.358188 [info ] [Thread-2 (]: 3 of 8 START sql table model marts.imports_by_year ............................. [RUN]
[0m23:34:02.360346 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_TRADE_FLOW_analytics, now model.citrus_trade.imports_by_year)
[0m23:34:02.361064 [debug] [Thread-2 (]: Began compiling node model.citrus_trade.imports_by_year
[0m23:34:02.359322 [info ] [Thread-1 (]: 4 of 8 START sql table model marts.imports_exports_2020 ........................ [RUN]
[0m23:34:02.366784 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.citrus_trade.stg_trade, now model.citrus_trade.imports_exports_2020)
[0m23:34:02.367386 [debug] [Thread-1 (]: Began compiling node model.citrus_trade.imports_exports_2020
[0m23:34:02.366181 [debug] [Thread-2 (]: Writing injected SQL for node "model.citrus_trade.imports_by_year"
[0m23:34:02.372014 [debug] [Thread-1 (]: Writing injected SQL for node "model.citrus_trade.imports_exports_2020"
[0m23:34:02.375505 [debug] [Thread-2 (]: Began executing node model.citrus_trade.imports_by_year
[0m23:34:02.381282 [debug] [Thread-2 (]: Writing runtime sql for node "model.citrus_trade.imports_by_year"
[0m23:34:02.381668 [debug] [Thread-1 (]: Began executing node model.citrus_trade.imports_exports_2020
[0m23:34:02.384578 [debug] [Thread-1 (]: Writing runtime sql for node "model.citrus_trade.imports_exports_2020"
[0m23:34:02.386068 [debug] [Thread-2 (]: Using snowflake connection "model.citrus_trade.imports_by_year"
[0m23:34:02.386514 [debug] [Thread-2 (]: On model.citrus_trade.imports_by_year: create or replace transient table TRADE_FLOW.marts.imports_by_year
    
    
    
    as (select
    declarant_iso,
    year,
    sum(value_in_euros) as revenue,
    sum(quantity_in_kg) as quantity,
    total_value/nullif(total_quantity,0) as price_avg
from TRADE_FLOW.marts.trade_by_hs
where flow = 1
group by 1,2
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.imports_by_year"} */;
[0m23:34:02.387989 [debug] [Thread-1 (]: Using snowflake connection "model.citrus_trade.imports_exports_2020"
[0m23:34:02.389016 [debug] [Thread-1 (]: On model.citrus_trade.imports_exports_2020: create or replace transient table TRADE_FLOW.marts.imports_exports_2020
    
    
    
    as (select
    declarant_iso,
    flow,
    sum(value_in_euros) over(partition by declarant_iso, flow) as revenue,
    sum(quantity_in_kg) over(partition by declarant_iso, flow) as quantity,
    revenue_sum/nullif(quantity_sum,0) as price_avg
from TRADE_FLOW.marts.trade_by_hs
where year = 2020
group by 
    declarant_iso,
    flow,
    value_in_euros,
    quantity_in_kg
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.imports_exports_2020"} */;
[0m23:34:02.486335 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01c04386-0305-74a0-0004-20ca0002685a
[0m23:34:02.487090 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 10 at position 4
invalid identifier 'TOTAL_VALUE'
[0m23:34:02.491871 [debug] [Thread-2 (]: Database Error in model imports_by_year (models/marts/imports_by_year.sql)
  000904 (42000): SQL compilation error: error line 10 at position 4
  invalid identifier 'TOTAL_VALUE'
  compiled code at target/run/citrus_trade/models/marts/imports_by_year.sql
[0m23:34:02.492568 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9db61d61-a2fa-49c8-a502-5e28082531d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c0758e0>]}
[0m23:34:02.493457 [error] [Thread-2 (]: 3 of 8 ERROR creating sql table model marts.imports_by_year .................... [[31mERROR[0m in 0.13s]
[0m23:34:02.494508 [debug] [Thread-2 (]: Finished running node model.citrus_trade.imports_by_year
[0m23:34:02.495902 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01c04386-0305-74a0-0004-20ca0002685e
[0m23:34:02.496490 [debug] [Thread-7 (]: Marking all children of 'model.citrus_trade.imports_by_year' to be skipped because of status 'error'.  Reason: Database Error in model imports_by_year (models/marts/imports_by_year.sql)
  000904 (42000): SQL compilation error: error line 10 at position 4
  invalid identifier 'TOTAL_VALUE'
  compiled code at target/run/citrus_trade/models/marts/imports_by_year.sql.
[0m23:34:02.496861 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 10 at position 4
invalid identifier 'REVENUE_SUM'
[0m23:34:02.498908 [debug] [Thread-3 (]: Began running node model.citrus_trade.growth_score
[0m23:34:02.501782 [debug] [Thread-1 (]: Database Error in model imports_exports_2020 (models/marts/imports_exports_2020.sql)
  000904 (42000): SQL compilation error: error line 10 at position 4
  invalid identifier 'REVENUE_SUM'
  compiled code at target/run/citrus_trade/models/marts/imports_exports_2020.sql
[0m23:34:02.502199 [info ] [Thread-3 (]: 5 of 8 SKIP relation marts.growth_score ........................................ [[33mSKIP[0m]
[0m23:34:02.502800 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9db61d61-a2fa-49c8-a502-5e28082531d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c0751c0>]}
[0m23:34:02.503331 [debug] [Thread-3 (]: Finished running node model.citrus_trade.growth_score
[0m23:34:02.503985 [error] [Thread-1 (]: 4 of 8 ERROR creating sql table model marts.imports_exports_2020 ............... [[31mERROR[0m in 0.14s]
[0m23:34:02.504823 [debug] [Thread-1 (]: Finished running node model.citrus_trade.imports_exports_2020
[0m23:34:02.505243 [debug] [Thread-7 (]: Marking all children of 'model.citrus_trade.imports_exports_2020' to be skipped because of status 'error'.  Reason: Database Error in model imports_exports_2020 (models/marts/imports_exports_2020.sql)
  000904 (42000): SQL compilation error: error line 10 at position 4
  invalid identifier 'REVENUE_SUM'
  compiled code at target/run/citrus_trade/models/marts/imports_exports_2020.sql.
[0m23:34:02.505946 [debug] [Thread-2 (]: Began running node model.citrus_trade.score_2020
[0m23:34:02.506281 [info ] [Thread-2 (]: 6 of 8 SKIP relation marts.score_2020 .......................................... [[33mSKIP[0m]
[0m23:34:02.506671 [debug] [Thread-2 (]: Finished running node model.citrus_trade.score_2020
[0m23:34:02.507411 [debug] [Thread-3 (]: Began running node model.citrus_trade.importer_score
[0m23:34:02.507776 [info ] [Thread-3 (]: 7 of 8 SKIP relation marts.importer_score ...................................... [[33mSKIP[0m]
[0m23:34:02.508197 [debug] [Thread-3 (]: Finished running node model.citrus_trade.importer_score
[0m23:34:02.511511 [debug] [Thread-4 (]: Began running node model.citrus_trade.viz_importer_score
[0m23:34:02.512321 [info ] [Thread-4 (]: 8 of 8 SKIP relation analytics.viz_importer_score .............................. [[33mSKIP[0m]
[0m23:34:02.512791 [debug] [Thread-4 (]: Finished running node model.citrus_trade.viz_importer_score
[0m23:34:02.516083 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:34:02.516758 [debug] [MainThread]: Connection 'model.citrus_trade.imports_by_year' was left open.
[0m23:34:02.517048 [debug] [MainThread]: On model.citrus_trade.imports_by_year: Close
[0m23:34:02.621994 [debug] [MainThread]: Connection 'model.citrus_trade.imports_exports_2020' was left open.
[0m23:34:02.622620 [debug] [MainThread]: On model.citrus_trade.imports_exports_2020: Close
[0m23:34:02.707719 [debug] [MainThread]: Connection 'model.citrus_trade.trade_by_hs' was left open.
[0m23:34:02.708578 [debug] [MainThread]: On model.citrus_trade.trade_by_hs: Close
[0m23:34:02.835267 [info ] [MainThread]: 
[0m23:34:02.836519 [info ] [MainThread]: Finished running 8 table models in 0 hours 0 minutes and 5.18 seconds (5.18s).
[0m23:34:02.839516 [debug] [MainThread]: Command end result
[0m23:34:02.891051 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m23:34:02.894251 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m23:34:02.900960 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/target/run_results.json
[0m23:34:02.901166 [info ] [MainThread]: 
[0m23:34:02.901593 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m23:34:02.901958 [info ] [MainThread]: 
[0m23:34:02.902591 [error] [MainThread]: [31mFailure in model imports_by_year (models/marts/imports_by_year.sql)[0m
[0m23:34:02.903103 [error] [MainThread]:   Database Error in model imports_by_year (models/marts/imports_by_year.sql)
  000904 (42000): SQL compilation error: error line 10 at position 4
  invalid identifier 'TOTAL_VALUE'
  compiled code at target/run/citrus_trade/models/marts/imports_by_year.sql
[0m23:34:02.903325 [info ] [MainThread]: 
[0m23:34:02.903992 [info ] [MainThread]:   compiled code at target/compiled/citrus_trade/models/marts/imports_by_year.sql
[0m23:34:02.904229 [info ] [MainThread]: 
[0m23:34:02.904706 [error] [MainThread]: [31mFailure in model imports_exports_2020 (models/marts/imports_exports_2020.sql)[0m
[0m23:34:02.904979 [error] [MainThread]:   Database Error in model imports_exports_2020 (models/marts/imports_exports_2020.sql)
  000904 (42000): SQL compilation error: error line 10 at position 4
  invalid identifier 'REVENUE_SUM'
  compiled code at target/run/citrus_trade/models/marts/imports_exports_2020.sql
[0m23:34:02.905227 [info ] [MainThread]: 
[0m23:34:02.905551 [info ] [MainThread]:   compiled code at target/compiled/citrus_trade/models/marts/imports_exports_2020.sql
[0m23:34:02.905800 [info ] [MainThread]: 
[0m23:34:02.906056 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=2 SKIP=4 NO-OP=0 TOTAL=8
[0m23:34:02.907968 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 6.925137, "process_in_blocks": "9632", "process_kernel_time": 1.568209, "process_mem_max_rss": "155900", "process_out_blocks": "10792", "process_user_time": 3.337868}
[0m23:34:02.908476 [debug] [MainThread]: Command `dbt run` failed at 23:34:02.908400 after 6.93 seconds
[0m23:34:02.908859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa04d6360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2065010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c017d10>]}
[0m23:34:02.909072 [debug] [MainThread]: Flushing usage events
[0m23:34:03.443881 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:34:53.629795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5293980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb51e6ba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb72f9220>]}


============================== 23:34:53.632860 | 7dedfa84-3982-4437-bc6f-755fc1543d19 ==============================
[0m23:34:53.632860 [info ] [MainThread]: Running with dbt=1.10.13
[0m23:34:53.633226 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'empty': 'False', 'use_colors': 'True', 'warn_error': 'None', 'version_check': 'True', 'static_parser': 'True', 'write_json': 'True', 'log_format': 'default', 'debug': 'False', 'introspect': 'True', 'printer_width': '80', 'partial_parse': 'True', 'profiles_dir': '/opt/airflow/dbt', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'target_path': 'None', 'fail_fast': 'False', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'invocation_command': 'dbt run', 'no_print': 'None', 'log_path': '/opt/airflow/dbt/logs'}
[0m23:34:53.780610 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m23:34:53.781027 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m23:34:53.781209 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m23:34:53.874158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7dedfa84-3982-4437-bc6f-755fc1543d19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb397bb00>]}
[0m23:34:53.916397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7dedfa84-3982-4437-bc6f-755fc1543d19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6700740>]}
[0m23:34:53.917082 [info ] [MainThread]: Registered adapter: snowflake=1.10.3
[0m23:34:53.971203 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m23:34:54.091035 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m23:34:54.091516 [debug] [MainThread]: Partial parsing: updated file: citrus_trade://models/marts/imports_exports_2020.sql
[0m23:34:54.091744 [debug] [MainThread]: Partial parsing: updated file: citrus_trade://models/marts/imports_by_year.sql
[0m23:34:54.091926 [debug] [MainThread]: Partial parsing: updated file: citrus_trade://models/marts/importer_score.sql
[0m23:34:54.222876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7dedfa84-3982-4437-bc6f-755fc1543d19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2dd80b0>]}
[0m23:34:54.267070 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m23:34:54.268577 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m23:34:54.278223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7dedfa84-3982-4437-bc6f-755fc1543d19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2f9b1a0>]}
[0m23:34:54.278511 [info ] [MainThread]: Found 8 models, 3 sources, 636 macros
[0m23:34:54.278740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7dedfa84-3982-4437-bc6f-755fc1543d19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2d17f20>]}
[0m23:34:54.279995 [info ] [MainThread]: 
[0m23:34:54.280248 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:34:54.280555 [info ] [MainThread]: 
[0m23:34:54.281064 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:34:54.283813 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRADE_FLOW'
[0m23:34:54.289995 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRADE_FLOW'
[0m23:34:54.292716 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRADE_FLOW'
[0m23:34:54.323478 [debug] [ThreadPool]: Using snowflake connection "list_TRADE_FLOW"
[0m23:34:54.323814 [debug] [ThreadPool]: Using snowflake connection "list_TRADE_FLOW"
[0m23:34:54.324033 [debug] [ThreadPool]: Using snowflake connection "list_TRADE_FLOW"
[0m23:34:54.324185 [debug] [ThreadPool]: On list_TRADE_FLOW: show terse schemas in database TRADE_FLOW
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRADE_FLOW"} */
[0m23:34:54.324403 [debug] [ThreadPool]: On list_TRADE_FLOW: show terse schemas in database TRADE_FLOW
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRADE_FLOW"} */
[0m23:34:54.324608 [debug] [ThreadPool]: On list_TRADE_FLOW: show terse schemas in database TRADE_FLOW
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRADE_FLOW"} */
[0m23:34:54.324826 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:34:54.325018 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:34:54.325204 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:34:55.017649 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.692 seconds
[0m23:34:55.018732 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.693 seconds
[0m23:34:55.021727 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.697 seconds
[0m23:34:55.026202 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRADE_FLOW, now list_TRADE_FLOW_analytics)
[0m23:34:55.033016 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRADE_FLOW, now list_TRADE_FLOW_staging)
[0m23:34:55.042056 [debug] [ThreadPool]: Using snowflake connection "list_TRADE_FLOW_staging"
[0m23:34:55.043604 [debug] [ThreadPool]: Using snowflake connection "list_TRADE_FLOW_analytics"
[0m23:34:55.043903 [debug] [ThreadPool]: On list_TRADE_FLOW_staging: show objects in TRADE_FLOW.staging
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRADE_FLOW_staging"} */;
[0m23:34:55.044245 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRADE_FLOW, now list_TRADE_FLOW_marts)
[0m23:34:55.044573 [debug] [ThreadPool]: On list_TRADE_FLOW_analytics: show objects in TRADE_FLOW.analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRADE_FLOW_analytics"} */;
[0m23:34:55.047587 [debug] [ThreadPool]: Using snowflake connection "list_TRADE_FLOW_marts"
[0m23:34:55.049271 [debug] [ThreadPool]: On list_TRADE_FLOW_marts: show objects in TRADE_FLOW.marts
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRADE_FLOW_marts"} */;
[0m23:34:55.122645 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.078 seconds
[0m23:34:55.128961 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.081 seconds
[0m23:34:55.143145 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 0.094 seconds
[0m23:34:55.146001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7dedfa84-3982-4437-bc6f-755fc1543d19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2f9b080>]}
[0m23:34:55.148962 [debug] [Thread-1 (]: Began running node model.citrus_trade.stg_trade
[0m23:34:55.149388 [info ] [Thread-1 (]: 1 of 8 START sql table model staging.stg_trade ................................. [RUN]
[0m23:34:55.149781 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_TRADE_FLOW_marts, now model.citrus_trade.stg_trade)
[0m23:34:55.150108 [debug] [Thread-1 (]: Began compiling node model.citrus_trade.stg_trade
[0m23:34:55.156302 [debug] [Thread-1 (]: Writing injected SQL for node "model.citrus_trade.stg_trade"
[0m23:34:55.157583 [debug] [Thread-1 (]: Began executing node model.citrus_trade.stg_trade
[0m23:34:55.177646 [debug] [Thread-1 (]: Writing runtime sql for node "model.citrus_trade.stg_trade"
[0m23:34:55.179295 [debug] [Thread-1 (]: Using snowflake connection "model.citrus_trade.stg_trade"
[0m23:34:55.179541 [debug] [Thread-1 (]: On model.citrus_trade.stg_trade: create or replace transient table TRADE_FLOW.staging.stg_trade
    
    
    
    as (select
  value:DECLARANT::int as declarant,
  value:DECLARANT_ISO::string as declarant_iso,
  value:PARTNER::string as partner,
  value:PARTNER_ISO::string as partner_iso,
  value:FLOW::int as flow,
  value:TRANSPORT_MODE::int as transport_mode,
  value:PERIOD::int as period,
  year(to_date(left(period,4),'YYYY')) as year,
  value:HS4::string as hs4,
  value:HS4_NAME::string as hs4_name,
  value:HS6::string as hs6,
  value:HS6_NAME::string as hs6_name,
  value:VALUE_IN_EUROS::float as value_in_euros,
  value:QUANTITY_IN_KG::float as quantity_in_kg
from trade_flow.raw.raw_trhs
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.stg_trade"} */;
[0m23:34:55.965936 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.786 seconds
[0m23:34:56.004920 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7dedfa84-3982-4437-bc6f-755fc1543d19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7129910>]}
[0m23:34:56.005489 [info ] [Thread-1 (]: 1 of 8 OK created sql table model staging.stg_trade ............................ [[32mSUCCESS 1[0m in 0.85s]
[0m23:34:56.005974 [debug] [Thread-1 (]: Finished running node model.citrus_trade.stg_trade
[0m23:34:56.006768 [debug] [Thread-3 (]: Began running node model.citrus_trade.trade_by_hs
[0m23:34:56.007084 [info ] [Thread-3 (]: 2 of 8 START sql table model marts.trade_by_hs ................................. [RUN]
[0m23:34:56.007344 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_TRADE_FLOW_staging, now model.citrus_trade.trade_by_hs)
[0m23:34:56.007581 [debug] [Thread-3 (]: Began compiling node model.citrus_trade.trade_by_hs
[0m23:34:56.009377 [debug] [Thread-3 (]: Writing injected SQL for node "model.citrus_trade.trade_by_hs"
[0m23:34:56.011482 [debug] [Thread-3 (]: Began executing node model.citrus_trade.trade_by_hs
[0m23:34:56.014013 [debug] [Thread-3 (]: Writing runtime sql for node "model.citrus_trade.trade_by_hs"
[0m23:34:56.015150 [debug] [Thread-3 (]: Using snowflake connection "model.citrus_trade.trade_by_hs"
[0m23:34:56.015449 [debug] [Thread-3 (]: On model.citrus_trade.trade_by_hs: create or replace transient table TRADE_FLOW.marts.trade_by_hs
    
    
    
    as (select
    *
from TRADE_FLOW.staging.stg_trade
where hs6 = '080510'
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.trade_by_hs"} */;
[0m23:34:56.742406 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.726 seconds
[0m23:34:56.748035 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7dedfa84-3982-4437-bc6f-755fc1543d19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb114b260>]}
[0m23:34:56.749349 [info ] [Thread-3 (]: 2 of 8 OK created sql table model marts.trade_by_hs ............................ [[32mSUCCESS 1[0m in 0.74s]
[0m23:34:56.750445 [debug] [Thread-3 (]: Finished running node model.citrus_trade.trade_by_hs
[0m23:34:56.752056 [debug] [Thread-2 (]: Began running node model.citrus_trade.imports_by_year
[0m23:34:56.752752 [debug] [Thread-1 (]: Began running node model.citrus_trade.imports_exports_2020
[0m23:34:56.753464 [info ] [Thread-2 (]: 3 of 8 START sql table model marts.imports_by_year ............................. [RUN]
[0m23:34:56.755466 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_TRADE_FLOW_analytics, now model.citrus_trade.imports_by_year)
[0m23:34:56.756139 [debug] [Thread-2 (]: Began compiling node model.citrus_trade.imports_by_year
[0m23:34:56.754388 [info ] [Thread-1 (]: 4 of 8 START sql table model marts.imports_exports_2020 ........................ [RUN]
[0m23:34:56.761022 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.citrus_trade.stg_trade, now model.citrus_trade.imports_exports_2020)
[0m23:34:56.761508 [debug] [Thread-1 (]: Began compiling node model.citrus_trade.imports_exports_2020
[0m23:34:56.760447 [debug] [Thread-2 (]: Writing injected SQL for node "model.citrus_trade.imports_by_year"
[0m23:34:56.765132 [debug] [Thread-1 (]: Writing injected SQL for node "model.citrus_trade.imports_exports_2020"
[0m23:34:56.768010 [debug] [Thread-2 (]: Began executing node model.citrus_trade.imports_by_year
[0m23:34:56.771307 [debug] [Thread-2 (]: Writing runtime sql for node "model.citrus_trade.imports_by_year"
[0m23:34:56.771717 [debug] [Thread-1 (]: Began executing node model.citrus_trade.imports_exports_2020
[0m23:34:56.774540 [debug] [Thread-1 (]: Writing runtime sql for node "model.citrus_trade.imports_exports_2020"
[0m23:34:56.775985 [debug] [Thread-2 (]: Using snowflake connection "model.citrus_trade.imports_by_year"
[0m23:34:56.776429 [debug] [Thread-2 (]: On model.citrus_trade.imports_by_year: create or replace transient table TRADE_FLOW.marts.imports_by_year
    
    
    
    as (select
    declarant_iso,
    year,
    sum(value_in_euros) as revenue,
    sum(quantity_in_kg) as quantity,
    revenue/nullif(quantity,0) as price_avg
from TRADE_FLOW.marts.trade_by_hs
where flow = 1
group by 1,2
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.imports_by_year"} */;
[0m23:34:56.777519 [debug] [Thread-1 (]: Using snowflake connection "model.citrus_trade.imports_exports_2020"
[0m23:34:56.780227 [debug] [Thread-1 (]: On model.citrus_trade.imports_exports_2020: create or replace transient table TRADE_FLOW.marts.imports_exports_2020
    
    
    
    as (select
    declarant_iso,
    flow,
    sum(value_in_euros) over(partition by declarant_iso, flow) as revenue,
    sum(quantity_in_kg) over(partition by declarant_iso, flow) as quantity,
    revenue/nullif(quantity,0) as price_avg
from TRADE_FLOW.marts.trade_by_hs
where year = 2020
group by 
    declarant_iso,
    flow,
    value_in_euros,
    quantity_in_kg
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.imports_exports_2020"} */;
[0m23:34:57.725625 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.947 seconds
[0m23:34:57.727178 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.946 seconds
[0m23:34:57.730670 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7dedfa84-3982-4437-bc6f-755fc1543d19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1137f80>]}
[0m23:34:57.731202 [info ] [Thread-1 (]: 4 of 8 OK created sql table model marts.imports_exports_2020 ................... [[32mSUCCESS 1[0m in 0.97s]
[0m23:34:57.729392 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7dedfa84-3982-4437-bc6f-755fc1543d19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1554050>]}
[0m23:34:57.732051 [info ] [Thread-2 (]: 3 of 8 OK created sql table model marts.imports_by_year ........................ [[32mSUCCESS 1[0m in 0.97s]
[0m23:34:57.732406 [debug] [Thread-2 (]: Finished running node model.citrus_trade.imports_by_year
[0m23:34:57.731625 [debug] [Thread-1 (]: Finished running node model.citrus_trade.imports_exports_2020
[0m23:34:57.732920 [debug] [Thread-3 (]: Began running node model.citrus_trade.growth_score
[0m23:34:57.733117 [debug] [Thread-4 (]: Began running node model.citrus_trade.score_2020
[0m23:34:57.733360 [info ] [Thread-3 (]: 5 of 8 START sql table model marts.growth_score ................................ [RUN]
[0m23:34:57.733664 [info ] [Thread-4 (]: 6 of 8 START sql table model marts.score_2020 .................................. [RUN]
[0m23:34:57.734033 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.citrus_trade.trade_by_hs, now model.citrus_trade.growth_score)
[0m23:34:57.734373 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.citrus_trade.score_2020'
[0m23:34:57.734614 [debug] [Thread-3 (]: Began compiling node model.citrus_trade.growth_score
[0m23:34:57.734858 [debug] [Thread-4 (]: Began compiling node model.citrus_trade.score_2020
[0m23:34:57.736958 [debug] [Thread-3 (]: Writing injected SQL for node "model.citrus_trade.growth_score"
[0m23:34:57.738619 [debug] [Thread-4 (]: Writing injected SQL for node "model.citrus_trade.score_2020"
[0m23:34:57.741090 [debug] [Thread-3 (]: Began executing node model.citrus_trade.growth_score
[0m23:34:57.743483 [debug] [Thread-3 (]: Writing runtime sql for node "model.citrus_trade.growth_score"
[0m23:34:57.744344 [debug] [Thread-4 (]: Began executing node model.citrus_trade.score_2020
[0m23:34:57.746748 [debug] [Thread-4 (]: Writing runtime sql for node "model.citrus_trade.score_2020"
[0m23:34:57.754065 [debug] [Thread-3 (]: Using snowflake connection "model.citrus_trade.growth_score"
[0m23:34:57.754991 [debug] [Thread-3 (]: On model.citrus_trade.growth_score: create or replace transient table TRADE_FLOW.marts.growth_score
    
    
    
    as (with 
    previous_year AS (
        select 
            declarant_iso,
            year,
            lag(revenue,1) over(partition by declarant_iso order by year) revenue_previous_year,
            revenue,
            first_value(revenue) over(partition by declarant_iso order by year) as revenue_first_year,
            last_value(revenue) over(partition by declarant_iso order by year) as revenue_last_year
        from TRADE_FLOW.marts.imports_by_year
    ),
    growth_speed AS (
        select 
            declarant_iso,
            year,
            revenue_first_year,
            revenue_last_year,
            revenue_last_year/nullif(revenue_first_year,0) as growth_overall,
            revenue_previous_year,
            revenue,
            (revenue - revenue_previous_year)/revenue * 100 as growth_speed 
        from previous_year
    ),
    previous_year_growth_speed AS (
        select 
            declarant_iso,
            year,
            revenue_first_year,
            revenue_last_year,
            growth_overall,
            revenue_previous_year,
            revenue,
            growth_speed,
            lag(growth_speed,1) over(partition by declarant_iso order by year) growth_speed_previous_year,
        from growth_speed
    ),
    avg_acc AS (
        select 
            declarant_iso,
            year,
            revenue_first_year,
            revenue_last_year,
            growth_overall,
            revenue_previous_year,
            revenue,
            growth_speed_previous_year,
            growth_speed,
            growth_speed - growth_speed_previous_year as growth_acceleration,
            avg(growth_acceleration) over(partition by declarant_iso) as avg_acceleration
        from previous_year_growth_speed
    ),
    ok as (
        select 
            declarant_iso,
            year,
            revenue_first_year,
            revenue_last_year,
            growth_overall,
            (growth_overall - min(growth_overall) OVER())/(max(growth_overall) OVER() - min(growth_overall) OVER()) as growth_overall_norm,
            revenue_previous_year,
            revenue,
            growth_speed_previous_year,
            growth_speed,
            growth_acceleration,
            avg_acceleration,
            (avg_acceleration - min(avg_acceleration) OVER())/(max(avg_acceleration) OVER() - min(avg_acceleration) OVER()) as avg_acceleration_norm
        from base 
    )
    select 
        declarant_iso,
        growth_overall_norm * avg_acceleration_norm as growth_score,
        array_agg(object_construct('year',year,'revenue',cast(current_value as string))) within group (order by year) as revenue_by_year
    from ok 
    group by 1,2
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.growth_score"} */;
[0m23:34:57.756229 [debug] [Thread-4 (]: Using snowflake connection "model.citrus_trade.score_2020"
[0m23:34:57.758182 [debug] [Thread-4 (]: On model.citrus_trade.score_2020: create or replace transient table TRADE_FLOW.marts.score_2020
    
    
    
    as (select distinct 
    declarant_iso,
    revenue,
    quantity,
    price_avg,
    (revenue - min(revenue) over())/((max(revenue) over())-(min(revenue) over())) as revenue_score,
    (quantity - min(quantity) over())/((max(quantity) over())-(min(quantity) over())) as quantity_score,
    (price_avg - min(price_avg) over())/((max(price_avg) over())-(min(price_avg) over())) as price_score
from TRADE_FLOW.marts.imports_exports_2020
where flow = 1
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.score_2020"} */;
[0m23:34:57.758509 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m23:34:57.898280 [debug] [Thread-3 (]: Snowflake adapter: Snowflake query id: 01c04386-0305-74a0-0004-20ca0002688a
[0m23:34:57.898874 [debug] [Thread-3 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'BASE' does not exist or not authorized.
[0m23:34:57.902570 [debug] [Thread-3 (]: Database Error in model growth_score (models/marts/growth_score.sql)
  002003 (42S02): SQL compilation error:
  Object 'BASE' does not exist or not authorized.
  compiled code at target/run/citrus_trade/models/marts/growth_score.sql
[0m23:34:57.903102 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7dedfa84-3982-4437-bc6f-755fc1543d19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb11b0a70>]}
[0m23:34:57.903754 [error] [Thread-3 (]: 5 of 8 ERROR creating sql table model marts.growth_score ....................... [[31mERROR[0m in 0.17s]
[0m23:34:57.904394 [debug] [Thread-3 (]: Finished running node model.citrus_trade.growth_score
[0m23:34:57.905025 [debug] [Thread-7 (]: Marking all children of 'model.citrus_trade.growth_score' to be skipped because of status 'error'.  Reason: Database Error in model growth_score (models/marts/growth_score.sql)
  002003 (42S02): SQL compilation error:
  Object 'BASE' does not exist or not authorized.
  compiled code at target/run/citrus_trade/models/marts/growth_score.sql.
[0m23:34:58.729991 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.971 seconds
[0m23:34:58.731795 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7dedfa84-3982-4437-bc6f-755fc1543d19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1192ae0>]}
[0m23:34:58.732620 [info ] [Thread-4 (]: 6 of 8 OK created sql table model marts.score_2020 ............................. [[32mSUCCESS 1[0m in 1.00s]
[0m23:34:58.733189 [debug] [Thread-4 (]: Finished running node model.citrus_trade.score_2020
[0m23:34:58.733910 [debug] [Thread-1 (]: Began running node model.citrus_trade.importer_score
[0m23:34:58.734208 [info ] [Thread-1 (]: 7 of 8 SKIP relation marts.importer_score ...................................... [[33mSKIP[0m]
[0m23:34:58.734513 [debug] [Thread-1 (]: Finished running node model.citrus_trade.importer_score
[0m23:34:58.735259 [debug] [Thread-3 (]: Began running node model.citrus_trade.viz_importer_score
[0m23:34:58.737929 [info ] [Thread-3 (]: 8 of 8 SKIP relation analytics.viz_importer_score .............................. [[33mSKIP[0m]
[0m23:34:58.743647 [debug] [Thread-3 (]: Finished running node model.citrus_trade.viz_importer_score
[0m23:34:58.744911 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:34:58.745148 [debug] [MainThread]: Connection 'model.citrus_trade.imports_by_year' was left open.
[0m23:34:58.745328 [debug] [MainThread]: On model.citrus_trade.imports_by_year: Close
[0m23:34:58.836102 [debug] [MainThread]: Connection 'model.citrus_trade.imports_exports_2020' was left open.
[0m23:34:58.836511 [debug] [MainThread]: On model.citrus_trade.imports_exports_2020: Close
[0m23:34:58.978811 [debug] [MainThread]: Connection 'model.citrus_trade.growth_score' was left open.
[0m23:34:58.979472 [debug] [MainThread]: On model.citrus_trade.growth_score: Close
[0m23:34:59.073817 [debug] [MainThread]: Connection 'model.citrus_trade.score_2020' was left open.
[0m23:34:59.074952 [debug] [MainThread]: On model.citrus_trade.score_2020: Close
[0m23:34:59.176160 [info ] [MainThread]: 
[0m23:34:59.177548 [info ] [MainThread]: Finished running 8 table models in 0 hours 0 minutes and 4.89 seconds (4.89s).
[0m23:34:59.180865 [debug] [MainThread]: Command end result
[0m23:34:59.229463 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m23:34:59.231746 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m23:34:59.236879 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/target/run_results.json
[0m23:34:59.237109 [info ] [MainThread]: 
[0m23:34:59.237394 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m23:34:59.237879 [info ] [MainThread]: 
[0m23:34:59.238235 [error] [MainThread]: [31mFailure in model growth_score (models/marts/growth_score.sql)[0m
[0m23:34:59.238624 [error] [MainThread]:   Database Error in model growth_score (models/marts/growth_score.sql)
  002003 (42S02): SQL compilation error:
  Object 'BASE' does not exist or not authorized.
  compiled code at target/run/citrus_trade/models/marts/growth_score.sql
[0m23:34:59.238927 [info ] [MainThread]: 
[0m23:34:59.239242 [info ] [MainThread]:   compiled code at target/compiled/citrus_trade/models/marts/growth_score.sql
[0m23:34:59.239534 [info ] [MainThread]: 
[0m23:34:59.239869 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=2 NO-OP=0 TOTAL=8
[0m23:34:59.241271 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 5.6409473, "process_in_blocks": "0", "process_kernel_time": 0.434718, "process_mem_max_rss": "153588", "process_out_blocks": "4276", "process_user_time": 1.705511}
[0m23:34:59.241716 [debug] [MainThread]: Command `dbt run` failed at 23:34:59.241618 after 5.64 seconds
[0m23:34:59.242030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2cc7fe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2f84500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5110d70>]}
[0m23:34:59.242262 [debug] [MainThread]: Flushing usage events
[0m23:34:59.848021 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:35:23.329278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8f68f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8f6a9c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb88603b0>]}


============================== 23:35:23.332443 | 23303052-e6b2-4487-84f1-1aea97f78bdb ==============================
[0m23:35:23.332443 [info ] [MainThread]: Running with dbt=1.10.13
[0m23:35:23.332825 [debug] [MainThread]: running dbt with arguments {'log_path': '/opt/airflow/dbt/logs', 'introspect': 'True', 'use_colors': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'printer_width': '80', 'log_cache_events': 'False', 'log_format': 'default', 'use_experimental_parser': 'False', 'write_json': 'True', 'empty': 'False', 'debug': 'False', 'target_path': 'None', 'no_print': 'None', 'profiles_dir': '/opt/airflow/dbt', 'indirect_selection': 'eager', 'partial_parse': 'True', 'fail_fast': 'False', 'quiet': 'False', 'warn_error': 'None', 'invocation_command': 'dbt run', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m23:35:23.492557 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m23:35:23.492952 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m23:35:23.493134 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m23:35:23.589605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '23303052-e6b2-4487-84f1-1aea97f78bdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb78b0920>]}
[0m23:35:23.623169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '23303052-e6b2-4487-84f1-1aea97f78bdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb71799d0>]}
[0m23:35:23.623870 [info ] [MainThread]: Registered adapter: snowflake=1.10.3
[0m23:35:23.760705 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m23:35:23.881040 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:35:23.881445 [debug] [MainThread]: Partial parsing: updated file: citrus_trade://models/marts/growth_score.sql
[0m23:35:24.010798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '23303052-e6b2-4487-84f1-1aea97f78bdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb69c3230>]}
[0m23:35:24.060997 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m23:35:24.062527 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m23:35:24.071947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '23303052-e6b2-4487-84f1-1aea97f78bdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb696c080>]}
[0m23:35:24.072202 [info ] [MainThread]: Found 8 models, 3 sources, 636 macros
[0m23:35:24.072448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '23303052-e6b2-4487-84f1-1aea97f78bdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6e14710>]}
[0m23:35:24.073957 [info ] [MainThread]: 
[0m23:35:24.074191 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:35:24.074413 [info ] [MainThread]: 
[0m23:35:24.074830 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:35:24.077522 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRADE_FLOW'
[0m23:35:24.083692 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRADE_FLOW'
[0m23:35:24.089710 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRADE_FLOW'
[0m23:35:24.120174 [debug] [ThreadPool]: Using snowflake connection "list_TRADE_FLOW"
[0m23:35:24.120528 [debug] [ThreadPool]: Using snowflake connection "list_TRADE_FLOW"
[0m23:35:24.120749 [debug] [ThreadPool]: Using snowflake connection "list_TRADE_FLOW"
[0m23:35:24.120899 [debug] [ThreadPool]: On list_TRADE_FLOW: show terse schemas in database TRADE_FLOW
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRADE_FLOW"} */
[0m23:35:24.121128 [debug] [ThreadPool]: On list_TRADE_FLOW: show terse schemas in database TRADE_FLOW
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRADE_FLOW"} */
[0m23:35:24.121350 [debug] [ThreadPool]: On list_TRADE_FLOW: show terse schemas in database TRADE_FLOW
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRADE_FLOW"} */
[0m23:35:24.121529 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:35:24.121718 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:35:24.121896 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:35:24.843063 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.721 seconds
[0m23:35:24.844562 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.723 seconds
[0m23:35:24.845614 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.724 seconds
[0m23:35:24.862196 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRADE_FLOW, now list_TRADE_FLOW_staging)
[0m23:35:24.869158 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRADE_FLOW, now list_TRADE_FLOW_marts)
[0m23:35:24.883061 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRADE_FLOW, now list_TRADE_FLOW_analytics)
[0m23:35:24.903065 [debug] [ThreadPool]: Using snowflake connection "list_TRADE_FLOW_analytics"
[0m23:35:24.903633 [debug] [ThreadPool]: Using snowflake connection "list_TRADE_FLOW_marts"
[0m23:35:24.907192 [debug] [ThreadPool]: Using snowflake connection "list_TRADE_FLOW_staging"
[0m23:35:24.907517 [debug] [ThreadPool]: On list_TRADE_FLOW_analytics: show objects in TRADE_FLOW.analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRADE_FLOW_analytics"} */;
[0m23:35:24.907953 [debug] [ThreadPool]: On list_TRADE_FLOW_marts: show objects in TRADE_FLOW.marts
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRADE_FLOW_marts"} */;
[0m23:35:24.908284 [debug] [ThreadPool]: On list_TRADE_FLOW_staging: show objects in TRADE_FLOW.staging
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRADE_FLOW_staging"} */;
[0m23:35:24.983109 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.073 seconds
[0m23:35:24.988595 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 0.079 seconds
[0m23:35:25.000913 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.092 seconds
[0m23:35:25.002440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '23303052-e6b2-4487-84f1-1aea97f78bdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6d34b90>]}
[0m23:35:25.004608 [debug] [Thread-1 (]: Began running node model.citrus_trade.stg_trade
[0m23:35:25.004933 [info ] [Thread-1 (]: 1 of 8 START sql table model staging.stg_trade ................................. [RUN]
[0m23:35:25.005225 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_TRADE_FLOW_analytics, now model.citrus_trade.stg_trade)
[0m23:35:25.005483 [debug] [Thread-1 (]: Began compiling node model.citrus_trade.stg_trade
[0m23:35:25.010468 [debug] [Thread-1 (]: Writing injected SQL for node "model.citrus_trade.stg_trade"
[0m23:35:25.011405 [debug] [Thread-1 (]: Began executing node model.citrus_trade.stg_trade
[0m23:35:25.028569 [debug] [Thread-1 (]: Writing runtime sql for node "model.citrus_trade.stg_trade"
[0m23:35:25.029836 [debug] [Thread-1 (]: Using snowflake connection "model.citrus_trade.stg_trade"
[0m23:35:25.030139 [debug] [Thread-1 (]: On model.citrus_trade.stg_trade: create or replace transient table TRADE_FLOW.staging.stg_trade
    
    
    
    as (select
  value:DECLARANT::int as declarant,
  value:DECLARANT_ISO::string as declarant_iso,
  value:PARTNER::string as partner,
  value:PARTNER_ISO::string as partner_iso,
  value:FLOW::int as flow,
  value:TRANSPORT_MODE::int as transport_mode,
  value:PERIOD::int as period,
  year(to_date(left(period,4),'YYYY')) as year,
  value:HS4::string as hs4,
  value:HS4_NAME::string as hs4_name,
  value:HS6::string as hs6,
  value:HS6_NAME::string as hs6_name,
  value:VALUE_IN_EUROS::float as value_in_euros,
  value:QUANTITY_IN_KG::float as quantity_in_kg
from trade_flow.raw.raw_trhs
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.stg_trade"} */;
[0m23:35:25.697802 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.667 seconds
[0m23:35:25.741184 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '23303052-e6b2-4487-84f1-1aea97f78bdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbb0b1910>]}
[0m23:35:25.742012 [info ] [Thread-1 (]: 1 of 8 OK created sql table model staging.stg_trade ............................ [[32mSUCCESS 1[0m in 0.73s]
[0m23:35:25.742605 [debug] [Thread-1 (]: Finished running node model.citrus_trade.stg_trade
[0m23:35:25.743565 [debug] [Thread-3 (]: Began running node model.citrus_trade.trade_by_hs
[0m23:35:25.744170 [info ] [Thread-3 (]: 2 of 8 START sql table model marts.trade_by_hs ................................. [RUN]
[0m23:35:25.744684 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_TRADE_FLOW_staging, now model.citrus_trade.trade_by_hs)
[0m23:35:25.745201 [debug] [Thread-3 (]: Began compiling node model.citrus_trade.trade_by_hs
[0m23:35:25.748141 [debug] [Thread-3 (]: Writing injected SQL for node "model.citrus_trade.trade_by_hs"
[0m23:35:25.751558 [debug] [Thread-3 (]: Began executing node model.citrus_trade.trade_by_hs
[0m23:35:25.755446 [debug] [Thread-3 (]: Writing runtime sql for node "model.citrus_trade.trade_by_hs"
[0m23:35:25.756929 [debug] [Thread-3 (]: Using snowflake connection "model.citrus_trade.trade_by_hs"
[0m23:35:25.757337 [debug] [Thread-3 (]: On model.citrus_trade.trade_by_hs: create or replace transient table TRADE_FLOW.marts.trade_by_hs
    
    
    
    as (select
    *
from TRADE_FLOW.staging.stg_trade
where hs6 = '080510'
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.trade_by_hs"} */;
[0m23:35:26.383332 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.625 seconds
[0m23:35:26.388935 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '23303052-e6b2-4487-84f1-1aea97f78bdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4d51e50>]}
[0m23:35:26.390271 [info ] [Thread-3 (]: 2 of 8 OK created sql table model marts.trade_by_hs ............................ [[32mSUCCESS 1[0m in 0.64s]
[0m23:35:26.391605 [debug] [Thread-3 (]: Finished running node model.citrus_trade.trade_by_hs
[0m23:35:26.393191 [debug] [Thread-2 (]: Began running node model.citrus_trade.imports_by_year
[0m23:35:26.393821 [debug] [Thread-1 (]: Began running node model.citrus_trade.imports_exports_2020
[0m23:35:26.394502 [info ] [Thread-2 (]: 3 of 8 START sql table model marts.imports_by_year ............................. [RUN]
[0m23:35:26.395540 [info ] [Thread-1 (]: 4 of 8 START sql table model marts.imports_exports_2020 ........................ [RUN]
[0m23:35:26.397165 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.citrus_trade.stg_trade, now model.citrus_trade.imports_exports_2020)
[0m23:35:26.397724 [debug] [Thread-1 (]: Began compiling node model.citrus_trade.imports_exports_2020
[0m23:35:26.396454 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_TRADE_FLOW_marts, now model.citrus_trade.imports_by_year)
[0m23:35:26.402345 [debug] [Thread-2 (]: Began compiling node model.citrus_trade.imports_by_year
[0m23:35:26.405788 [debug] [Thread-2 (]: Writing injected SQL for node "model.citrus_trade.imports_by_year"
[0m23:35:26.401838 [debug] [Thread-1 (]: Writing injected SQL for node "model.citrus_trade.imports_exports_2020"
[0m23:35:26.407652 [debug] [Thread-2 (]: Began executing node model.citrus_trade.imports_by_year
[0m23:35:26.411071 [debug] [Thread-2 (]: Writing runtime sql for node "model.citrus_trade.imports_by_year"
[0m23:35:26.411463 [debug] [Thread-1 (]: Began executing node model.citrus_trade.imports_exports_2020
[0m23:35:26.414282 [debug] [Thread-1 (]: Writing runtime sql for node "model.citrus_trade.imports_exports_2020"
[0m23:35:26.415755 [debug] [Thread-2 (]: Using snowflake connection "model.citrus_trade.imports_by_year"
[0m23:35:26.416186 [debug] [Thread-2 (]: On model.citrus_trade.imports_by_year: create or replace transient table TRADE_FLOW.marts.imports_by_year
    
    
    
    as (select
    declarant_iso,
    year,
    sum(value_in_euros) as revenue,
    sum(quantity_in_kg) as quantity,
    revenue/nullif(quantity,0) as price_avg
from TRADE_FLOW.marts.trade_by_hs
where flow = 1
group by 1,2
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.imports_by_year"} */;
[0m23:35:26.418296 [debug] [Thread-1 (]: Using snowflake connection "model.citrus_trade.imports_exports_2020"
[0m23:35:26.419511 [debug] [Thread-1 (]: On model.citrus_trade.imports_exports_2020: create or replace transient table TRADE_FLOW.marts.imports_exports_2020
    
    
    
    as (select
    declarant_iso,
    flow,
    sum(value_in_euros) over(partition by declarant_iso, flow) as revenue,
    sum(quantity_in_kg) over(partition by declarant_iso, flow) as quantity,
    revenue/nullif(quantity,0) as price_avg
from TRADE_FLOW.marts.trade_by_hs
where year = 2020
group by 
    declarant_iso,
    flow,
    value_in_euros,
    quantity_in_kg
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.imports_exports_2020"} */;
[0m23:35:26.995850 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.579 seconds
[0m23:35:26.998560 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '23303052-e6b2-4487-84f1-1aea97f78bdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5153050>]}
[0m23:35:26.999509 [info ] [Thread-2 (]: 3 of 8 OK created sql table model marts.imports_by_year ........................ [[32mSUCCESS 1[0m in 0.60s]
[0m23:35:27.000581 [debug] [Thread-2 (]: Finished running node model.citrus_trade.imports_by_year
[0m23:35:27.001556 [debug] [Thread-3 (]: Began running node model.citrus_trade.growth_score
[0m23:35:27.002276 [info ] [Thread-3 (]: 5 of 8 START sql table model marts.growth_score ................................ [RUN]
[0m23:35:27.003211 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.citrus_trade.trade_by_hs, now model.citrus_trade.growth_score)
[0m23:35:27.003680 [debug] [Thread-3 (]: Began compiling node model.citrus_trade.growth_score
[0m23:35:27.007705 [debug] [Thread-3 (]: Writing injected SQL for node "model.citrus_trade.growth_score"
[0m23:35:27.009237 [debug] [Thread-3 (]: Began executing node model.citrus_trade.growth_score
[0m23:35:27.012658 [debug] [Thread-3 (]: Writing runtime sql for node "model.citrus_trade.growth_score"
[0m23:35:27.016599 [debug] [Thread-3 (]: Using snowflake connection "model.citrus_trade.growth_score"
[0m23:35:27.017120 [debug] [Thread-3 (]: On model.citrus_trade.growth_score: create or replace transient table TRADE_FLOW.marts.growth_score
    
    
    
    as (with 
    previous_year AS (
        select 
            declarant_iso,
            year,
            lag(revenue,1) over(partition by declarant_iso order by year) revenue_previous_year,
            revenue,
            first_value(revenue) over(partition by declarant_iso order by year) as revenue_first_year,
            last_value(revenue) over(partition by declarant_iso order by year) as revenue_last_year
        from TRADE_FLOW.marts.imports_by_year
    ),
    growth_speed AS (
        select 
            declarant_iso,
            year,
            revenue_first_year,
            revenue_last_year,
            revenue_last_year/nullif(revenue_first_year,0) as growth_overall,
            revenue_previous_year,
            revenue,
            (revenue - revenue_previous_year)/revenue * 100 as growth_speed 
        from previous_year
    ),
    previous_year_growth_speed AS (
        select 
            declarant_iso,
            year,
            revenue_first_year,
            revenue_last_year,
            growth_overall,
            revenue_previous_year,
            revenue,
            growth_speed,
            lag(growth_speed,1) over(partition by declarant_iso order by year) growth_speed_previous_year,
        from growth_speed
    ),
    avg_acc AS (
        select 
            declarant_iso,
            year,
            revenue_first_year,
            revenue_last_year,
            growth_overall,
            revenue_previous_year,
            revenue,
            growth_speed_previous_year,
            growth_speed,
            growth_speed - growth_speed_previous_year as growth_acceleration,
            avg(growth_acceleration) over(partition by declarant_iso) as avg_acceleration
        from previous_year_growth_speed
    ),
    ok as (
        select 
            declarant_iso,
            year,
            revenue_first_year,
            revenue_last_year,
            growth_overall,
            (growth_overall - min(growth_overall) OVER())/(max(growth_overall) OVER() - min(growth_overall) OVER()) as growth_overall_norm,
            revenue_previous_year,
            revenue,
            growth_speed_previous_year,
            growth_speed,
            growth_acceleration,
            avg_acceleration,
            (avg_acceleration - min(avg_acceleration) OVER())/(max(avg_acceleration) OVER() - min(avg_acceleration) OVER()) as avg_acceleration_norm
        from avg_acc 
    )
    select 
        declarant_iso,
        growth_overall_norm * avg_acceleration_norm as growth_score,
        array_agg(object_construct('year',year,'revenue',cast(current_value as string))) within group (order by year) as revenue_by_year
    from ok 
    group by 1,2
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.growth_score"} */;
[0m23:35:27.050353 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.630 seconds
[0m23:35:27.051785 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '23303052-e6b2-4487-84f1-1aea97f78bdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4d2d220>]}
[0m23:35:27.052236 [info ] [Thread-1 (]: 4 of 8 OK created sql table model marts.imports_exports_2020 ................... [[32mSUCCESS 1[0m in 0.65s]
[0m23:35:27.052677 [debug] [Thread-1 (]: Finished running node model.citrus_trade.imports_exports_2020
[0m23:35:27.053151 [debug] [Thread-2 (]: Began running node model.citrus_trade.score_2020
[0m23:35:27.053520 [info ] [Thread-2 (]: 6 of 8 START sql table model marts.score_2020 .................................. [RUN]
[0m23:35:27.053893 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.citrus_trade.imports_by_year, now model.citrus_trade.score_2020)
[0m23:35:27.054283 [debug] [Thread-2 (]: Began compiling node model.citrus_trade.score_2020
[0m23:35:27.056962 [debug] [Thread-2 (]: Writing injected SQL for node "model.citrus_trade.score_2020"
[0m23:35:27.057998 [debug] [Thread-2 (]: Began executing node model.citrus_trade.score_2020
[0m23:35:27.061310 [debug] [Thread-2 (]: Writing runtime sql for node "model.citrus_trade.score_2020"
[0m23:35:27.062522 [debug] [Thread-2 (]: Using snowflake connection "model.citrus_trade.score_2020"
[0m23:35:27.062830 [debug] [Thread-2 (]: On model.citrus_trade.score_2020: create or replace transient table TRADE_FLOW.marts.score_2020
    
    
    
    as (select distinct 
    declarant_iso,
    revenue,
    quantity,
    price_avg,
    (revenue - min(revenue) over())/((max(revenue) over())-(min(revenue) over())) as revenue_score,
    (quantity - min(quantity) over())/((max(quantity) over())-(min(quantity) over())) as quantity_score,
    (price_avg - min(price_avg) over())/((max(price_avg) over())-(min(price_avg) over())) as price_score
from TRADE_FLOW.marts.imports_exports_2020
where flow = 1
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.score_2020"} */;
[0m23:35:27.108405 [debug] [Thread-3 (]: Snowflake adapter: Snowflake query id: 01c04387-0305-74a0-0004-20ca000268ba
[0m23:35:27.108868 [debug] [Thread-3 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 76 at position 62
invalid identifier 'CURRENT_VALUE'
[0m23:35:27.112005 [debug] [Thread-3 (]: Database Error in model growth_score (models/marts/growth_score.sql)
  000904 (42000): SQL compilation error: error line 76 at position 62
  invalid identifier 'CURRENT_VALUE'
  compiled code at target/run/citrus_trade/models/marts/growth_score.sql
[0m23:35:27.112435 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '23303052-e6b2-4487-84f1-1aea97f78bdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5157c50>]}
[0m23:35:27.113000 [error] [Thread-3 (]: 5 of 8 ERROR creating sql table model marts.growth_score ....................... [[31mERROR[0m in 0.11s]
[0m23:35:27.113522 [debug] [Thread-3 (]: Finished running node model.citrus_trade.growth_score
[0m23:35:27.114065 [debug] [Thread-7 (]: Marking all children of 'model.citrus_trade.growth_score' to be skipped because of status 'error'.  Reason: Database Error in model growth_score (models/marts/growth_score.sql)
  000904 (42000): SQL compilation error: error line 76 at position 62
  invalid identifier 'CURRENT_VALUE'
  compiled code at target/run/citrus_trade/models/marts/growth_score.sql.
[0m23:35:27.683238 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.620 seconds
[0m23:35:27.688605 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '23303052-e6b2-4487-84f1-1aea97f78bdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4d0f680>]}
[0m23:35:27.689813 [info ] [Thread-2 (]: 6 of 8 OK created sql table model marts.score_2020 ............................. [[32mSUCCESS 1[0m in 0.63s]
[0m23:35:27.691028 [debug] [Thread-2 (]: Finished running node model.citrus_trade.score_2020
[0m23:35:27.692860 [debug] [Thread-1 (]: Began running node model.citrus_trade.importer_score
[0m23:35:27.693639 [info ] [Thread-1 (]: 7 of 8 SKIP relation marts.importer_score ...................................... [[33mSKIP[0m]
[0m23:35:27.694456 [debug] [Thread-1 (]: Finished running node model.citrus_trade.importer_score
[0m23:35:27.695669 [debug] [Thread-3 (]: Began running node model.citrus_trade.viz_importer_score
[0m23:35:27.696316 [info ] [Thread-3 (]: 8 of 8 SKIP relation analytics.viz_importer_score .............................. [[33mSKIP[0m]
[0m23:35:27.697225 [debug] [Thread-3 (]: Finished running node model.citrus_trade.viz_importer_score
[0m23:35:27.699443 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:35:27.699898 [debug] [MainThread]: Connection 'model.citrus_trade.score_2020' was left open.
[0m23:35:27.700312 [debug] [MainThread]: On model.citrus_trade.score_2020: Close
[0m23:35:27.792631 [debug] [MainThread]: Connection 'model.citrus_trade.growth_score' was left open.
[0m23:35:27.793935 [debug] [MainThread]: On model.citrus_trade.growth_score: Close
[0m23:35:27.925386 [debug] [MainThread]: Connection 'model.citrus_trade.imports_exports_2020' was left open.
[0m23:35:27.927385 [debug] [MainThread]: On model.citrus_trade.imports_exports_2020: Close
[0m23:35:28.033581 [info ] [MainThread]: 
[0m23:35:28.034005 [info ] [MainThread]: Finished running 8 table models in 0 hours 0 minutes and 3.96 seconds (3.96s).
[0m23:35:28.035180 [debug] [MainThread]: Command end result
[0m23:35:28.074030 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m23:35:28.076152 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m23:35:28.081297 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/target/run_results.json
[0m23:35:28.081539 [info ] [MainThread]: 
[0m23:35:28.081820 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m23:35:28.082332 [info ] [MainThread]: 
[0m23:35:28.082801 [error] [MainThread]: [31mFailure in model growth_score (models/marts/growth_score.sql)[0m
[0m23:35:28.083192 [error] [MainThread]:   Database Error in model growth_score (models/marts/growth_score.sql)
  000904 (42000): SQL compilation error: error line 76 at position 62
  invalid identifier 'CURRENT_VALUE'
  compiled code at target/run/citrus_trade/models/marts/growth_score.sql
[0m23:35:28.083492 [info ] [MainThread]: 
[0m23:35:28.083862 [info ] [MainThread]:   compiled code at target/compiled/citrus_trade/models/marts/growth_score.sql
[0m23:35:28.084315 [info ] [MainThread]: 
[0m23:35:28.084660 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=2 NO-OP=0 TOTAL=8
[0m23:35:28.085740 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 4.7888293, "process_in_blocks": "0", "process_kernel_time": 0.509136, "process_mem_max_rss": "151820", "process_out_blocks": "4276", "process_user_time": 1.759752}
[0m23:35:28.086150 [debug] [MainThread]: Command `dbt run` failed at 23:35:28.086081 after 4.79 seconds
[0m23:35:28.086569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbd5fa8a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6f728d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6f72420>]}
[0m23:35:28.086894 [debug] [MainThread]: Flushing usage events
[0m23:35:28.730892 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:37:58.539769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa93ba750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa893ca70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa88c0bf0>]}


============================== 23:37:58.542765 | 92ed2ad2-5f1c-451c-a3ab-afd2ea317166 ==============================
[0m23:37:58.542765 [info ] [MainThread]: Running with dbt=1.10.13
[0m23:37:58.543177 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/opt/airflow/dbt', 'static_parser': 'True', 'warn_error': 'None', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'cache_selected_only': 'False', 'target_path': 'None', 'use_colors': 'True', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'version_check': 'True', 'invocation_command': 'dbt run', 'quiet': 'False', 'fail_fast': 'False', 'partial_parse': 'True', 'empty': 'False', 'indirect_selection': 'eager', 'printer_width': '80'}
[0m23:37:58.713959 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m23:37:58.714363 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m23:37:58.714582 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m23:37:58.821147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '92ed2ad2-5f1c-451c-a3ab-afd2ea317166', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6e57170>]}
[0m23:37:58.851532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '92ed2ad2-5f1c-451c-a3ab-afd2ea317166', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6f257f0>]}
[0m23:37:58.852021 [info ] [MainThread]: Registered adapter: snowflake=1.10.3
[0m23:37:58.909226 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m23:37:59.051979 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:37:59.052428 [debug] [MainThread]: Partial parsing: updated file: citrus_trade://models/marts/growth_score.sql
[0m23:37:59.179434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '92ed2ad2-5f1c-451c-a3ab-afd2ea317166', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa66dea50>]}
[0m23:37:59.223302 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m23:37:59.224781 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m23:37:59.234852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '92ed2ad2-5f1c-451c-a3ab-afd2ea317166', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6370710>]}
[0m23:37:59.235149 [info ] [MainThread]: Found 8 models, 3 sources, 636 macros
[0m23:37:59.235381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '92ed2ad2-5f1c-451c-a3ab-afd2ea317166', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa689f740>]}
[0m23:37:59.236442 [info ] [MainThread]: 
[0m23:37:59.236665 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:37:59.236901 [info ] [MainThread]: 
[0m23:37:59.237268 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:37:59.239921 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRADE_FLOW'
[0m23:37:59.246298 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRADE_FLOW'
[0m23:37:59.248647 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRADE_FLOW'
[0m23:37:59.287184 [debug] [ThreadPool]: Using snowflake connection "list_TRADE_FLOW"
[0m23:37:59.287550 [debug] [ThreadPool]: Using snowflake connection "list_TRADE_FLOW"
[0m23:37:59.287779 [debug] [ThreadPool]: Using snowflake connection "list_TRADE_FLOW"
[0m23:37:59.287961 [debug] [ThreadPool]: On list_TRADE_FLOW: show terse schemas in database TRADE_FLOW
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRADE_FLOW"} */
[0m23:37:59.288211 [debug] [ThreadPool]: On list_TRADE_FLOW: show terse schemas in database TRADE_FLOW
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRADE_FLOW"} */
[0m23:37:59.288448 [debug] [ThreadPool]: On list_TRADE_FLOW: show terse schemas in database TRADE_FLOW
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRADE_FLOW"} */
[0m23:37:59.288639 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:37:59.288848 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:37:59.289056 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:37:59.972942 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.684 seconds
[0m23:37:59.974401 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.685 seconds
[0m23:37:59.975507 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.687 seconds
[0m23:37:59.983459 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRADE_FLOW, now list_TRADE_FLOW_analytics)
[0m23:37:59.990356 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRADE_FLOW, now list_TRADE_FLOW_marts)
[0m23:38:00.005402 [debug] [ThreadPool]: Using snowflake connection "list_TRADE_FLOW_analytics"
[0m23:38:00.008926 [debug] [ThreadPool]: Using snowflake connection "list_TRADE_FLOW_marts"
[0m23:38:00.009389 [debug] [ThreadPool]: On list_TRADE_FLOW_analytics: show objects in TRADE_FLOW.analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRADE_FLOW_analytics"} */;
[0m23:38:00.009790 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRADE_FLOW, now list_TRADE_FLOW_staging)
[0m23:38:00.010268 [debug] [ThreadPool]: On list_TRADE_FLOW_marts: show objects in TRADE_FLOW.marts
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRADE_FLOW_marts"} */;
[0m23:38:00.013768 [debug] [ThreadPool]: Using snowflake connection "list_TRADE_FLOW_staging"
[0m23:38:00.016059 [debug] [ThreadPool]: On list_TRADE_FLOW_staging: show objects in TRADE_FLOW.staging
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRADE_FLOW_staging"} */;
[0m23:38:00.095814 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 0.081 seconds
[0m23:38:00.137080 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.126 seconds
[0m23:38:00.147726 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.131 seconds
[0m23:38:00.151367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '92ed2ad2-5f1c-451c-a3ab-afd2ea317166', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6af4800>]}
[0m23:38:00.156948 [debug] [Thread-1 (]: Began running node model.citrus_trade.stg_trade
[0m23:38:00.157691 [info ] [Thread-1 (]: 1 of 8 START sql table model staging.stg_trade ................................. [RUN]
[0m23:38:00.158416 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_TRADE_FLOW_staging, now model.citrus_trade.stg_trade)
[0m23:38:00.159034 [debug] [Thread-1 (]: Began compiling node model.citrus_trade.stg_trade
[0m23:38:00.169684 [debug] [Thread-1 (]: Writing injected SQL for node "model.citrus_trade.stg_trade"
[0m23:38:00.172212 [debug] [Thread-1 (]: Began executing node model.citrus_trade.stg_trade
[0m23:38:00.201250 [debug] [Thread-1 (]: Writing runtime sql for node "model.citrus_trade.stg_trade"
[0m23:38:00.203170 [debug] [Thread-1 (]: Using snowflake connection "model.citrus_trade.stg_trade"
[0m23:38:00.203507 [debug] [Thread-1 (]: On model.citrus_trade.stg_trade: create or replace transient table TRADE_FLOW.staging.stg_trade
    
    
    
    as (select
  value:DECLARANT::int as declarant,
  value:DECLARANT_ISO::string as declarant_iso,
  value:PARTNER::string as partner,
  value:PARTNER_ISO::string as partner_iso,
  value:FLOW::int as flow,
  value:TRANSPORT_MODE::int as transport_mode,
  value:PERIOD::int as period,
  year(to_date(left(period,4),'YYYY')) as year,
  value:HS4::string as hs4,
  value:HS4_NAME::string as hs4_name,
  value:HS6::string as hs6,
  value:HS6_NAME::string as hs6_name,
  value:VALUE_IN_EUROS::float as value_in_euros,
  value:QUANTITY_IN_KG::float as quantity_in_kg
from trade_flow.raw.raw_trhs
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.stg_trade"} */;
[0m23:38:01.110067 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.906 seconds
[0m23:38:01.142082 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '92ed2ad2-5f1c-451c-a3ab-afd2ea317166', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaaa517f0>]}
[0m23:38:01.143068 [info ] [Thread-1 (]: 1 of 8 OK created sql table model staging.stg_trade ............................ [[32mSUCCESS 1[0m in 0.98s]
[0m23:38:01.143779 [debug] [Thread-1 (]: Finished running node model.citrus_trade.stg_trade
[0m23:38:01.144805 [debug] [Thread-3 (]: Began running node model.citrus_trade.trade_by_hs
[0m23:38:01.145374 [info ] [Thread-3 (]: 2 of 8 START sql table model marts.trade_by_hs ................................. [RUN]
[0m23:38:01.145959 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_TRADE_FLOW_marts, now model.citrus_trade.trade_by_hs)
[0m23:38:01.146392 [debug] [Thread-3 (]: Began compiling node model.citrus_trade.trade_by_hs
[0m23:38:01.149743 [debug] [Thread-3 (]: Writing injected SQL for node "model.citrus_trade.trade_by_hs"
[0m23:38:01.152396 [debug] [Thread-3 (]: Began executing node model.citrus_trade.trade_by_hs
[0m23:38:01.156486 [debug] [Thread-3 (]: Writing runtime sql for node "model.citrus_trade.trade_by_hs"
[0m23:38:01.157714 [debug] [Thread-3 (]: Using snowflake connection "model.citrus_trade.trade_by_hs"
[0m23:38:01.158073 [debug] [Thread-3 (]: On model.citrus_trade.trade_by_hs: create or replace transient table TRADE_FLOW.marts.trade_by_hs
    
    
    
    as (select
    *
from TRADE_FLOW.staging.stg_trade
where hs6 = '080510'
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.trade_by_hs"} */;
[0m23:38:01.801273 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.642 seconds
[0m23:38:01.806721 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '92ed2ad2-5f1c-451c-a3ab-afd2ea317166', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6abd3a0>]}
[0m23:38:01.808156 [info ] [Thread-3 (]: 2 of 8 OK created sql table model marts.trade_by_hs ............................ [[32mSUCCESS 1[0m in 0.66s]
[0m23:38:01.809025 [debug] [Thread-3 (]: Finished running node model.citrus_trade.trade_by_hs
[0m23:38:01.810369 [debug] [Thread-2 (]: Began running node model.citrus_trade.imports_by_year
[0m23:38:01.810947 [debug] [Thread-1 (]: Began running node model.citrus_trade.imports_exports_2020
[0m23:38:01.811561 [info ] [Thread-2 (]: 3 of 8 START sql table model marts.imports_by_year ............................. [RUN]
[0m23:38:01.813304 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_TRADE_FLOW_analytics, now model.citrus_trade.imports_by_year)
[0m23:38:01.813819 [debug] [Thread-2 (]: Began compiling node model.citrus_trade.imports_by_year
[0m23:38:01.812436 [info ] [Thread-1 (]: 4 of 8 START sql table model marts.imports_exports_2020 ........................ [RUN]
[0m23:38:01.818711 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.citrus_trade.stg_trade, now model.citrus_trade.imports_exports_2020)
[0m23:38:01.819220 [debug] [Thread-1 (]: Began compiling node model.citrus_trade.imports_exports_2020
[0m23:38:01.818145 [debug] [Thread-2 (]: Writing injected SQL for node "model.citrus_trade.imports_by_year"
[0m23:38:01.822339 [debug] [Thread-1 (]: Writing injected SQL for node "model.citrus_trade.imports_exports_2020"
[0m23:38:01.825065 [debug] [Thread-2 (]: Began executing node model.citrus_trade.imports_by_year
[0m23:38:01.828307 [debug] [Thread-2 (]: Writing runtime sql for node "model.citrus_trade.imports_by_year"
[0m23:38:01.828731 [debug] [Thread-1 (]: Began executing node model.citrus_trade.imports_exports_2020
[0m23:38:01.831309 [debug] [Thread-1 (]: Writing runtime sql for node "model.citrus_trade.imports_exports_2020"
[0m23:38:01.832535 [debug] [Thread-2 (]: Using snowflake connection "model.citrus_trade.imports_by_year"
[0m23:38:01.832976 [debug] [Thread-2 (]: On model.citrus_trade.imports_by_year: create or replace transient table TRADE_FLOW.marts.imports_by_year
    
    
    
    as (select
    declarant_iso,
    year,
    sum(value_in_euros) as revenue,
    sum(quantity_in_kg) as quantity,
    revenue/nullif(quantity,0) as price_avg
from TRADE_FLOW.marts.trade_by_hs
where flow = 1
group by 1,2
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.imports_by_year"} */;
[0m23:38:01.835500 [debug] [Thread-1 (]: Using snowflake connection "model.citrus_trade.imports_exports_2020"
[0m23:38:01.835919 [debug] [Thread-1 (]: On model.citrus_trade.imports_exports_2020: create or replace transient table TRADE_FLOW.marts.imports_exports_2020
    
    
    
    as (select
    declarant_iso,
    flow,
    sum(value_in_euros) over(partition by declarant_iso, flow) as revenue,
    sum(quantity_in_kg) over(partition by declarant_iso, flow) as quantity,
    revenue/nullif(quantity,0) as price_avg
from TRADE_FLOW.marts.trade_by_hs
where year = 2020
group by 
    declarant_iso,
    flow,
    value_in_euros,
    quantity_in_kg
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.imports_exports_2020"} */;
[0m23:38:02.574865 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.741 seconds
[0m23:38:02.580559 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '92ed2ad2-5f1c-451c-a3ab-afd2ea317166', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4b60350>]}
[0m23:38:02.582003 [info ] [Thread-2 (]: 3 of 8 OK created sql table model marts.imports_by_year ........................ [[32mSUCCESS 1[0m in 0.77s]
[0m23:38:02.583255 [debug] [Thread-2 (]: Finished running node model.citrus_trade.imports_by_year
[0m23:38:02.584631 [debug] [Thread-3 (]: Began running node model.citrus_trade.growth_score
[0m23:38:02.585479 [info ] [Thread-3 (]: 5 of 8 START sql table model marts.growth_score ................................ [RUN]
[0m23:38:02.586261 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.citrus_trade.trade_by_hs, now model.citrus_trade.growth_score)
[0m23:38:02.586979 [debug] [Thread-3 (]: Began compiling node model.citrus_trade.growth_score
[0m23:38:02.592042 [debug] [Thread-3 (]: Writing injected SQL for node "model.citrus_trade.growth_score"
[0m23:38:02.593697 [debug] [Thread-3 (]: Began executing node model.citrus_trade.growth_score
[0m23:38:02.597269 [debug] [Thread-3 (]: Writing runtime sql for node "model.citrus_trade.growth_score"
[0m23:38:02.601785 [debug] [Thread-3 (]: Using snowflake connection "model.citrus_trade.growth_score"
[0m23:38:02.602350 [debug] [Thread-3 (]: On model.citrus_trade.growth_score: create or replace transient table TRADE_FLOW.marts.growth_score
    
    
    
    as (with 
    previous_year AS (
        select 
            declarant_iso,
            year,
            lag(revenue,1) over(partition by declarant_iso order by year) revenue_previous_year,
            revenue,
            first_value(revenue) over(partition by declarant_iso order by year) as revenue_first_year,
            last_value(revenue) over(partition by declarant_iso order by year) as revenue_last_year
        from TRADE_FLOW.marts.imports_by_year
    ),
    growth_speed AS (
        select 
            declarant_iso,
            year,
            revenue_first_year,
            revenue_last_year,
            revenue_last_year/nullif(revenue_first_year,0) as growth_overall,
            revenue_previous_year,
            revenue,
            (revenue - revenue_previous_year)/revenue * 100 as growth_speed 
        from previous_year
    ),
    previous_year_growth_speed AS (
        select 
            declarant_iso,
            year,
            revenue_first_year,
            revenue_last_year,
            growth_overall,
            revenue_previous_year,
            revenue,
            growth_speed,
            lag(growth_speed,1) over(partition by declarant_iso order by year) growth_speed_previous_year,
        from growth_speed
    ),
    avg_acc AS (
        select 
            declarant_iso,
            year,
            revenue_first_year,
            revenue_last_year,
            growth_overall,
            revenue_previous_year,
            revenue,
            growth_speed_previous_year,
            growth_speed,
            growth_speed - growth_speed_previous_year as growth_acceleration,
            avg(growth_acceleration) over(partition by declarant_iso) as avg_acceleration
        from previous_year_growth_speed
    ),
    ok as (
        select 
            declarant_iso,
            year,
            revenue_first_year,
            revenue_last_year,
            growth_overall,
            (growth_overall - min(growth_overall) OVER())/(max(growth_overall) OVER() - min(growth_overall) OVER()) as growth_overall_norm,
            revenue_previous_year,
            revenue,
            growth_speed_previous_year,
            growth_speed,
            growth_acceleration,
            avg_acceleration,
            (avg_acceleration - min(avg_acceleration) OVER())/(max(avg_acceleration) OVER() - min(avg_acceleration) OVER()) as avg_acceleration_norm
        from avg_acc 
    )
    select 
        declarant_iso,
        growth_overall_norm * avg_acceleration_norm as growth_score,
        array_agg(object_construct('year',year,'revenue',cast(revenue as string))) within group (order by year) as revenue_by_year
    from ok 
    group by 1,2
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.growth_score"} */;
[0m23:38:02.638970 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.803 seconds
[0m23:38:02.642740 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '92ed2ad2-5f1c-451c-a3ab-afd2ea317166', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa412b770>]}
[0m23:38:02.644164 [info ] [Thread-1 (]: 4 of 8 OK created sql table model marts.imports_exports_2020 ................... [[32mSUCCESS 1[0m in 0.82s]
[0m23:38:02.645909 [debug] [Thread-1 (]: Finished running node model.citrus_trade.imports_exports_2020
[0m23:38:02.646720 [debug] [Thread-2 (]: Began running node model.citrus_trade.score_2020
[0m23:38:02.647283 [info ] [Thread-2 (]: 6 of 8 START sql table model marts.score_2020 .................................. [RUN]
[0m23:38:02.647864 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.citrus_trade.imports_by_year, now model.citrus_trade.score_2020)
[0m23:38:02.648457 [debug] [Thread-2 (]: Began compiling node model.citrus_trade.score_2020
[0m23:38:02.652505 [debug] [Thread-2 (]: Writing injected SQL for node "model.citrus_trade.score_2020"
[0m23:38:02.654174 [debug] [Thread-2 (]: Began executing node model.citrus_trade.score_2020
[0m23:38:02.659058 [debug] [Thread-2 (]: Writing runtime sql for node "model.citrus_trade.score_2020"
[0m23:38:02.660907 [debug] [Thread-2 (]: Using snowflake connection "model.citrus_trade.score_2020"
[0m23:38:02.661297 [debug] [Thread-2 (]: On model.citrus_trade.score_2020: create or replace transient table TRADE_FLOW.marts.score_2020
    
    
    
    as (select distinct 
    declarant_iso,
    revenue,
    quantity,
    price_avg,
    (revenue - min(revenue) over())/((max(revenue) over())-(min(revenue) over())) as revenue_score,
    (quantity - min(quantity) over())/((max(quantity) over())-(min(quantity) over())) as quantity_score,
    (price_avg - min(price_avg) over())/((max(price_avg) over())-(min(price_avg) over())) as price_score
from TRADE_FLOW.marts.imports_exports_2020
where flow = 1
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.score_2020"} */;
[0m23:38:03.365028 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.762 seconds
[0m23:38:03.371041 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '92ed2ad2-5f1c-451c-a3ab-afd2ea317166', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4b86de0>]}
[0m23:38:03.372463 [info ] [Thread-3 (]: 5 of 8 OK created sql table model marts.growth_score ........................... [[32mSUCCESS 1[0m in 0.78s]
[0m23:38:03.373545 [debug] [Thread-3 (]: Finished running node model.citrus_trade.growth_score
[0m23:38:03.417328 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.755 seconds
[0m23:38:03.421250 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '92ed2ad2-5f1c-451c-a3ab-afd2ea317166', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4b841a0>]}
[0m23:38:03.422280 [info ] [Thread-2 (]: 6 of 8 OK created sql table model marts.score_2020 ............................. [[32mSUCCESS 1[0m in 0.77s]
[0m23:38:03.423384 [debug] [Thread-2 (]: Finished running node model.citrus_trade.score_2020
[0m23:38:03.424774 [debug] [Thread-1 (]: Began running node model.citrus_trade.importer_score
[0m23:38:03.425609 [info ] [Thread-1 (]: 7 of 8 START sql table model marts.importer_score .............................. [RUN]
[0m23:38:03.426459 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.citrus_trade.imports_exports_2020, now model.citrus_trade.importer_score)
[0m23:38:03.427076 [debug] [Thread-1 (]: Began compiling node model.citrus_trade.importer_score
[0m23:38:03.431902 [debug] [Thread-1 (]: Writing injected SQL for node "model.citrus_trade.importer_score"
[0m23:38:03.435472 [debug] [Thread-1 (]: Began executing node model.citrus_trade.importer_score
[0m23:38:03.439257 [debug] [Thread-1 (]: Writing runtime sql for node "model.citrus_trade.importer_score"
[0m23:38:03.441455 [debug] [Thread-1 (]: Using snowflake connection "model.citrus_trade.importer_score"
[0m23:38:03.441989 [debug] [Thread-1 (]: On model.citrus_trade.importer_score: create or replace transient table TRADE_FLOW.marts.importer_score
    
    
    
    as (select distinct
    sc.declarant_iso,
    sc.revenue as revenue_2020,
    sc.quantity as quantity_2020,
    sc.price_avg as price_avg_2020,
    gs.revenue_by_year,
    sc.revenue_score,
    sc.quantity_score,
    sc.price_score,
    gs.growth_score
from TRADE_FLOW.marts.score_2020 as sc
inner join TRADE_FLOW.marts.growth_score as gs
    on gs.declarant_iso = sc.declarant_iso
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.importer_score"} */;
[0m23:38:04.228154 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.785 seconds
[0m23:38:04.234231 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '92ed2ad2-5f1c-451c-a3ab-afd2ea317166', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4b75070>]}
[0m23:38:04.236161 [info ] [Thread-1 (]: 7 of 8 OK created sql table model marts.importer_score ......................... [[32mSUCCESS 1[0m in 0.81s]
[0m23:38:04.237558 [debug] [Thread-1 (]: Finished running node model.citrus_trade.importer_score
[0m23:38:04.239147 [debug] [Thread-3 (]: Began running node model.citrus_trade.viz_importer_score
[0m23:38:04.240012 [info ] [Thread-3 (]: 8 of 8 START sql table model analytics.viz_importer_score ...................... [RUN]
[0m23:38:04.240996 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.citrus_trade.growth_score, now model.citrus_trade.viz_importer_score)
[0m23:38:04.241678 [debug] [Thread-3 (]: Began compiling node model.citrus_trade.viz_importer_score
[0m23:38:04.247129 [debug] [Thread-3 (]: Writing injected SQL for node "model.citrus_trade.viz_importer_score"
[0m23:38:04.249717 [debug] [Thread-3 (]: Began executing node model.citrus_trade.viz_importer_score
[0m23:38:04.253434 [debug] [Thread-3 (]: Writing runtime sql for node "model.citrus_trade.viz_importer_score"
[0m23:38:04.256643 [debug] [Thread-3 (]: Using snowflake connection "model.citrus_trade.viz_importer_score"
[0m23:38:04.257334 [debug] [Thread-3 (]: On model.citrus_trade.viz_importer_score: create or replace transient table TRADE_FLOW.analytics.viz_importer_score
    
    
    
    as (with 
    scores as (
        select 
            declarant_iso,
            score_type,
            score
        from TRADE_FLOW.marts.importer_score
        unpivot (
            score for score_type in (
                revenue_score as "revenue",
                volume_score as "volume",
                rate_score as "rate",
                growth_score as "growth"
            )
        )
    ),
    metrics as (
        select 
            declarant_iso,
            metric_type,
            metric
        from TRADE_FLOW.marts.importer_score
        unpivot (
            metric for metric_type in (
                revenue_total as "revenue",
                volume_total as "volume",
                rate_avg as "rate"
            )
        )
    )
select 
    s.declarant_iso,
    s.score_type,
    s.score,
    m.metric,
    case 
        when s.score_type = 'revenue' then 'Euro'
        when s.score_type = 'volume' then 'Kg'
        when s.score_type = 'rate' then 'Euro per Kg'
    end as metric_unit
from scores as s
left join metrics as m
    on s.declarant_iso = m.declarant_iso
    and s.score_type = m.metric_type
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.viz_importer_score"} */;
[0m23:38:04.361542 [debug] [Thread-3 (]: Snowflake adapter: Snowflake query id: 01c0438a-0305-74a0-0004-20ca000268f6
[0m23:38:04.362935 [debug] [Thread-3 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 15 at position 16
invalid identifier 'VOLUME_SCORE'
[0m23:38:04.369526 [debug] [Thread-3 (]: Database Error in model viz_importer_score (models/analytics/viz_importer_score.sql)
  000904 (42000): SQL compilation error: error line 15 at position 16
  invalid identifier 'VOLUME_SCORE'
  compiled code at target/run/citrus_trade/models/analytics/viz_importer_score.sql
[0m23:38:04.370524 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '92ed2ad2-5f1c-451c-a3ab-afd2ea317166', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4b86810>]}
[0m23:38:04.371493 [error] [Thread-3 (]: 8 of 8 ERROR creating sql table model analytics.viz_importer_score ............. [[31mERROR[0m in 0.13s]
[0m23:38:04.372803 [debug] [Thread-3 (]: Finished running node model.citrus_trade.viz_importer_score
[0m23:38:04.373931 [debug] [Thread-7 (]: Marking all children of 'model.citrus_trade.viz_importer_score' to be skipped because of status 'error'.  Reason: Database Error in model viz_importer_score (models/analytics/viz_importer_score.sql)
  000904 (42000): SQL compilation error: error line 15 at position 16
  invalid identifier 'VOLUME_SCORE'
  compiled code at target/run/citrus_trade/models/analytics/viz_importer_score.sql.
[0m23:38:04.377258 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:38:04.377768 [debug] [MainThread]: Connection 'model.citrus_trade.score_2020' was left open.
[0m23:38:04.378275 [debug] [MainThread]: On model.citrus_trade.score_2020: Close
[0m23:38:04.486809 [debug] [MainThread]: Connection 'model.citrus_trade.viz_importer_score' was left open.
[0m23:38:04.488185 [debug] [MainThread]: On model.citrus_trade.viz_importer_score: Close
[0m23:38:04.596910 [debug] [MainThread]: Connection 'model.citrus_trade.importer_score' was left open.
[0m23:38:04.598427 [debug] [MainThread]: On model.citrus_trade.importer_score: Close
[0m23:38:04.678507 [info ] [MainThread]: 
[0m23:38:04.679198 [info ] [MainThread]: Finished running 8 table models in 0 hours 0 minutes and 5.44 seconds (5.44s).
[0m23:38:04.681130 [debug] [MainThread]: Command end result
[0m23:38:04.714688 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m23:38:04.716865 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m23:38:04.722040 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/target/run_results.json
[0m23:38:04.722253 [info ] [MainThread]: 
[0m23:38:04.722507 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m23:38:04.722918 [info ] [MainThread]: 
[0m23:38:04.723246 [error] [MainThread]: [31mFailure in model viz_importer_score (models/analytics/viz_importer_score.sql)[0m
[0m23:38:04.723579 [error] [MainThread]:   Database Error in model viz_importer_score (models/analytics/viz_importer_score.sql)
  000904 (42000): SQL compilation error: error line 15 at position 16
  invalid identifier 'VOLUME_SCORE'
  compiled code at target/run/citrus_trade/models/analytics/viz_importer_score.sql
[0m23:38:04.723833 [info ] [MainThread]: 
[0m23:38:04.724170 [info ] [MainThread]:   compiled code at target/compiled/citrus_trade/models/analytics/viz_importer_score.sql
[0m23:38:04.724413 [info ] [MainThread]: 
[0m23:38:04.724698 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=8
[0m23:38:04.725579 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 6.217, "process_in_blocks": "0", "process_kernel_time": 0.384982, "process_mem_max_rss": "151772", "process_out_blocks": "4300", "process_user_time": 1.833394}
[0m23:38:04.725953 [debug] [MainThread]: Command `dbt run` failed at 23:38:04.725877 after 6.22 seconds
[0m23:38:04.726485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa90db080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa90fa030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa66be000>]}
[0m23:38:04.726767 [debug] [MainThread]: Flushing usage events
[0m23:38:05.337488 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:41:34.816953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f6be810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ea6eae0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f4b2030>]}


============================== 23:41:34.820726 | 0d4eabe5-b748-4ca0-af7e-77de218e7fc9 ==============================
[0m23:41:34.820726 [info ] [MainThread]: Running with dbt=1.10.13
[0m23:41:34.821194 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'target_path': 'None', 'introspect': 'True', 'static_parser': 'True', 'debug': 'False', 'invocation_command': 'dbt run', 'no_print': 'None', 'indirect_selection': 'eager', 'empty': 'False', 'use_experimental_parser': 'False', 'use_colors': 'True', 'write_json': 'True', 'quiet': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'printer_width': '80', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'log_format': 'default', 'log_path': '/opt/airflow/dbt/logs'}
[0m23:41:34.981865 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m23:41:34.982314 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m23:41:34.982519 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m23:41:35.077629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0d4eabe5-b748-4ca0-af7e-77de218e7fc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9cfc4620>]}
[0m23:41:35.114515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0d4eabe5-b748-4ca0-af7e-77de218e7fc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d40a630>]}
[0m23:41:35.115493 [info ] [MainThread]: Registered adapter: snowflake=1.10.3
[0m23:41:35.174053 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m23:41:35.294894 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:41:35.295275 [debug] [MainThread]: Partial parsing: updated file: citrus_trade://models/analytics/viz_importer_score.sql
[0m23:41:35.420758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0d4eabe5-b748-4ca0-af7e-77de218e7fc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9cb03830>]}
[0m23:41:35.467014 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m23:41:35.468705 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m23:41:35.481394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0d4eabe5-b748-4ca0-af7e-77de218e7fc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c778560>]}
[0m23:41:35.481694 [info ] [MainThread]: Found 8 models, 3 sources, 636 macros
[0m23:41:35.481921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0d4eabe5-b748-4ca0-af7e-77de218e7fc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9cb0f590>]}
[0m23:41:35.482989 [info ] [MainThread]: 
[0m23:41:35.483214 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:41:35.483458 [info ] [MainThread]: 
[0m23:41:35.483869 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:41:35.486502 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRADE_FLOW'
[0m23:41:35.492095 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRADE_FLOW'
[0m23:41:35.495980 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRADE_FLOW'
[0m23:41:35.524511 [debug] [ThreadPool]: Using snowflake connection "list_TRADE_FLOW"
[0m23:41:35.524925 [debug] [ThreadPool]: Using snowflake connection "list_TRADE_FLOW"
[0m23:41:35.525171 [debug] [ThreadPool]: Using snowflake connection "list_TRADE_FLOW"
[0m23:41:35.525354 [debug] [ThreadPool]: On list_TRADE_FLOW: show terse schemas in database TRADE_FLOW
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRADE_FLOW"} */
[0m23:41:35.525610 [debug] [ThreadPool]: On list_TRADE_FLOW: show terse schemas in database TRADE_FLOW
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRADE_FLOW"} */
[0m23:41:35.525830 [debug] [ThreadPool]: On list_TRADE_FLOW: show terse schemas in database TRADE_FLOW
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRADE_FLOW"} */
[0m23:41:35.526016 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:41:35.526212 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:41:35.526461 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:41:36.135112 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.609 seconds
[0m23:41:36.135752 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.610 seconds
[0m23:41:36.154579 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.628 seconds
[0m23:41:36.156727 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRADE_FLOW, now list_TRADE_FLOW_marts)
[0m23:41:36.165068 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRADE_FLOW, now list_TRADE_FLOW_staging)
[0m23:41:36.166735 [debug] [ThreadPool]: Using snowflake connection "list_TRADE_FLOW_marts"
[0m23:41:36.167110 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRADE_FLOW, now list_TRADE_FLOW_analytics)
[0m23:41:36.168640 [debug] [ThreadPool]: Using snowflake connection "list_TRADE_FLOW_staging"
[0m23:41:36.168959 [debug] [ThreadPool]: On list_TRADE_FLOW_marts: show objects in TRADE_FLOW.marts
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRADE_FLOW_marts"} */;
[0m23:41:36.170394 [debug] [ThreadPool]: Using snowflake connection "list_TRADE_FLOW_analytics"
[0m23:41:36.170663 [debug] [ThreadPool]: On list_TRADE_FLOW_staging: show objects in TRADE_FLOW.staging
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRADE_FLOW_staging"} */;
[0m23:41:36.171846 [debug] [ThreadPool]: On list_TRADE_FLOW_analytics: show objects in TRADE_FLOW.analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRADE_FLOW_analytics"} */;
[0m23:41:36.244702 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.073 seconds
[0m23:41:36.245412 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.073 seconds
[0m23:41:36.249389 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 0.078 seconds
[0m23:41:36.251984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0d4eabe5-b748-4ca0-af7e-77de218e7fc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9cad9130>]}
[0m23:41:36.254758 [debug] [Thread-1 (]: Began running node model.citrus_trade.stg_trade
[0m23:41:36.255232 [info ] [Thread-1 (]: 1 of 8 START sql table model staging.stg_trade ................................. [RUN]
[0m23:41:36.255700 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_TRADE_FLOW_marts, now model.citrus_trade.stg_trade)
[0m23:41:36.256072 [debug] [Thread-1 (]: Began compiling node model.citrus_trade.stg_trade
[0m23:41:36.261859 [debug] [Thread-1 (]: Writing injected SQL for node "model.citrus_trade.stg_trade"
[0m23:41:36.263625 [debug] [Thread-1 (]: Began executing node model.citrus_trade.stg_trade
[0m23:41:36.284197 [debug] [Thread-1 (]: Writing runtime sql for node "model.citrus_trade.stg_trade"
[0m23:41:36.285872 [debug] [Thread-1 (]: Using snowflake connection "model.citrus_trade.stg_trade"
[0m23:41:36.286127 [debug] [Thread-1 (]: On model.citrus_trade.stg_trade: create or replace transient table TRADE_FLOW.staging.stg_trade
    
    
    
    as (select
  value:DECLARANT::int as declarant,
  value:DECLARANT_ISO::string as declarant_iso,
  value:PARTNER::string as partner,
  value:PARTNER_ISO::string as partner_iso,
  value:FLOW::int as flow,
  value:TRANSPORT_MODE::int as transport_mode,
  value:PERIOD::int as period,
  year(to_date(left(period,4),'YYYY')) as year,
  value:HS4::string as hs4,
  value:HS4_NAME::string as hs4_name,
  value:HS6::string as hs6,
  value:HS6_NAME::string as hs6_name,
  value:VALUE_IN_EUROS::float as value_in_euros,
  value:QUANTITY_IN_KG::float as quantity_in_kg
from trade_flow.raw.raw_trhs
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.stg_trade"} */;
[0m23:41:37.074979 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.788 seconds
[0m23:41:37.103568 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d4eabe5-b748-4ca0-af7e-77de218e7fc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0ded5b0>]}
[0m23:41:37.104568 [info ] [Thread-1 (]: 1 of 8 OK created sql table model staging.stg_trade ............................ [[32mSUCCESS 1[0m in 0.85s]
[0m23:41:37.105677 [debug] [Thread-1 (]: Finished running node model.citrus_trade.stg_trade
[0m23:41:37.106877 [debug] [Thread-3 (]: Began running node model.citrus_trade.trade_by_hs
[0m23:41:37.107729 [info ] [Thread-3 (]: 2 of 8 START sql table model marts.trade_by_hs ................................. [RUN]
[0m23:41:37.108351 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_TRADE_FLOW_staging, now model.citrus_trade.trade_by_hs)
[0m23:41:37.108885 [debug] [Thread-3 (]: Began compiling node model.citrus_trade.trade_by_hs
[0m23:41:37.112490 [debug] [Thread-3 (]: Writing injected SQL for node "model.citrus_trade.trade_by_hs"
[0m23:41:37.115414 [debug] [Thread-3 (]: Began executing node model.citrus_trade.trade_by_hs
[0m23:41:37.120163 [debug] [Thread-3 (]: Writing runtime sql for node "model.citrus_trade.trade_by_hs"
[0m23:41:37.121596 [debug] [Thread-3 (]: Using snowflake connection "model.citrus_trade.trade_by_hs"
[0m23:41:37.121937 [debug] [Thread-3 (]: On model.citrus_trade.trade_by_hs: create or replace transient table TRADE_FLOW.marts.trade_by_hs
    
    
    
    as (select
    *
from TRADE_FLOW.staging.stg_trade
where hs6 = '080510'
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.trade_by_hs"} */;
[0m23:41:37.757484 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.635 seconds
[0m23:41:37.763093 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d4eabe5-b748-4ca0-af7e-77de218e7fc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c7795e0>]}
[0m23:41:37.764694 [info ] [Thread-3 (]: 2 of 8 OK created sql table model marts.trade_by_hs ............................ [[32mSUCCESS 1[0m in 0.65s]
[0m23:41:37.765976 [debug] [Thread-3 (]: Finished running node model.citrus_trade.trade_by_hs
[0m23:41:37.767655 [debug] [Thread-2 (]: Began running node model.citrus_trade.imports_by_year
[0m23:41:37.768367 [debug] [Thread-1 (]: Began running node model.citrus_trade.imports_exports_2020
[0m23:41:37.769240 [info ] [Thread-2 (]: 3 of 8 START sql table model marts.imports_by_year ............................. [RUN]
[0m23:41:37.771246 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_TRADE_FLOW_analytics, now model.citrus_trade.imports_by_year)
[0m23:41:37.771920 [debug] [Thread-2 (]: Began compiling node model.citrus_trade.imports_by_year
[0m23:41:37.770232 [info ] [Thread-1 (]: 4 of 8 START sql table model marts.imports_exports_2020 ........................ [RUN]
[0m23:41:37.777235 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.citrus_trade.stg_trade, now model.citrus_trade.imports_exports_2020)
[0m23:41:37.777684 [debug] [Thread-1 (]: Began compiling node model.citrus_trade.imports_exports_2020
[0m23:41:37.776687 [debug] [Thread-2 (]: Writing injected SQL for node "model.citrus_trade.imports_by_year"
[0m23:41:37.781229 [debug] [Thread-1 (]: Writing injected SQL for node "model.citrus_trade.imports_exports_2020"
[0m23:41:37.784280 [debug] [Thread-2 (]: Began executing node model.citrus_trade.imports_by_year
[0m23:41:37.787852 [debug] [Thread-2 (]: Writing runtime sql for node "model.citrus_trade.imports_by_year"
[0m23:41:37.788231 [debug] [Thread-1 (]: Began executing node model.citrus_trade.imports_exports_2020
[0m23:41:37.791073 [debug] [Thread-1 (]: Writing runtime sql for node "model.citrus_trade.imports_exports_2020"
[0m23:41:37.792453 [debug] [Thread-2 (]: Using snowflake connection "model.citrus_trade.imports_by_year"
[0m23:41:37.792908 [debug] [Thread-2 (]: On model.citrus_trade.imports_by_year: create or replace transient table TRADE_FLOW.marts.imports_by_year
    
    
    
    as (select
    declarant_iso,
    year,
    sum(value_in_euros) as revenue,
    sum(quantity_in_kg) as quantity,
    revenue/nullif(quantity,0) as price_avg
from TRADE_FLOW.marts.trade_by_hs
where flow = 1
group by 1,2
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.imports_by_year"} */;
[0m23:41:37.796110 [debug] [Thread-1 (]: Using snowflake connection "model.citrus_trade.imports_exports_2020"
[0m23:41:37.796565 [debug] [Thread-1 (]: On model.citrus_trade.imports_exports_2020: create or replace transient table TRADE_FLOW.marts.imports_exports_2020
    
    
    
    as (select
    declarant_iso,
    flow,
    sum(value_in_euros) over(partition by declarant_iso, flow) as revenue,
    sum(quantity_in_kg) over(partition by declarant_iso, flow) as quantity,
    revenue/nullif(quantity,0) as price_avg
from TRADE_FLOW.marts.trade_by_hs
where year = 2020
group by 
    declarant_iso,
    flow,
    value_in_euros,
    quantity_in_kg
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.imports_exports_2020"} */;
[0m23:41:38.451883 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.658 seconds
[0m23:41:38.455036 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.658 seconds
[0m23:41:38.458946 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d4eabe5-b748-4ca0-af7e-77de218e7fc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a97ca10>]}
[0m23:41:38.461904 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d4eabe5-b748-4ca0-af7e-77de218e7fc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a9961b0>]}
[0m23:41:38.463042 [info ] [Thread-2 (]: 3 of 8 OK created sql table model marts.imports_by_year ........................ [[32mSUCCESS 1[0m in 0.69s]
[0m23:41:38.465755 [debug] [Thread-2 (]: Finished running node model.citrus_trade.imports_by_year
[0m23:41:38.464511 [info ] [Thread-1 (]: 4 of 8 OK created sql table model marts.imports_exports_2020 ................... [[32mSUCCESS 1[0m in 0.68s]
[0m23:41:38.466928 [debug] [Thread-1 (]: Finished running node model.citrus_trade.imports_exports_2020
[0m23:41:38.467362 [debug] [Thread-3 (]: Began running node model.citrus_trade.growth_score
[0m23:41:38.468176 [info ] [Thread-3 (]: 5 of 8 START sql table model marts.growth_score ................................ [RUN]
[0m23:41:38.468916 [debug] [Thread-2 (]: Began running node model.citrus_trade.score_2020
[0m23:41:38.469474 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.citrus_trade.trade_by_hs, now model.citrus_trade.growth_score)
[0m23:41:38.470138 [info ] [Thread-2 (]: 6 of 8 START sql table model marts.score_2020 .................................. [RUN]
[0m23:41:38.470761 [debug] [Thread-3 (]: Began compiling node model.citrus_trade.growth_score
[0m23:41:38.471342 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.citrus_trade.imports_by_year, now model.citrus_trade.score_2020)
[0m23:41:38.476193 [debug] [Thread-3 (]: Writing injected SQL for node "model.citrus_trade.growth_score"
[0m23:41:38.476784 [debug] [Thread-2 (]: Began compiling node model.citrus_trade.score_2020
[0m23:41:38.480431 [debug] [Thread-2 (]: Writing injected SQL for node "model.citrus_trade.score_2020"
[0m23:41:38.482055 [debug] [Thread-3 (]: Began executing node model.citrus_trade.growth_score
[0m23:41:38.482411 [debug] [Thread-2 (]: Began executing node model.citrus_trade.score_2020
[0m23:41:38.485579 [debug] [Thread-3 (]: Writing runtime sql for node "model.citrus_trade.growth_score"
[0m23:41:38.488423 [debug] [Thread-2 (]: Writing runtime sql for node "model.citrus_trade.score_2020"
[0m23:41:38.494197 [debug] [Thread-3 (]: Using snowflake connection "model.citrus_trade.growth_score"
[0m23:41:38.494840 [debug] [Thread-3 (]: On model.citrus_trade.growth_score: create or replace transient table TRADE_FLOW.marts.growth_score
    
    
    
    as (with 
    previous_year AS (
        select 
            declarant_iso,
            year,
            lag(revenue,1) over(partition by declarant_iso order by year) revenue_previous_year,
            revenue,
            first_value(revenue) over(partition by declarant_iso order by year) as revenue_first_year,
            last_value(revenue) over(partition by declarant_iso order by year) as revenue_last_year
        from TRADE_FLOW.marts.imports_by_year
    ),
    growth_speed AS (
        select 
            declarant_iso,
            year,
            revenue_first_year,
            revenue_last_year,
            revenue_last_year/nullif(revenue_first_year,0) as growth_overall,
            revenue_previous_year,
            revenue,
            (revenue - revenue_previous_year)/revenue * 100 as growth_speed 
        from previous_year
    ),
    previous_year_growth_speed AS (
        select 
            declarant_iso,
            year,
            revenue_first_year,
            revenue_last_year,
            growth_overall,
            revenue_previous_year,
            revenue,
            growth_speed,
            lag(growth_speed,1) over(partition by declarant_iso order by year) growth_speed_previous_year,
        from growth_speed
    ),
    avg_acc AS (
        select 
            declarant_iso,
            year,
            revenue_first_year,
            revenue_last_year,
            growth_overall,
            revenue_previous_year,
            revenue,
            growth_speed_previous_year,
            growth_speed,
            growth_speed - growth_speed_previous_year as growth_acceleration,
            avg(growth_acceleration) over(partition by declarant_iso) as avg_acceleration
        from previous_year_growth_speed
    ),
    ok as (
        select 
            declarant_iso,
            year,
            revenue_first_year,
            revenue_last_year,
            growth_overall,
            (growth_overall - min(growth_overall) OVER())/(max(growth_overall) OVER() - min(growth_overall) OVER()) as growth_overall_norm,
            revenue_previous_year,
            revenue,
            growth_speed_previous_year,
            growth_speed,
            growth_acceleration,
            avg_acceleration,
            (avg_acceleration - min(avg_acceleration) OVER())/(max(avg_acceleration) OVER() - min(avg_acceleration) OVER()) as avg_acceleration_norm
        from avg_acc 
    )
    select 
        declarant_iso,
        growth_overall_norm * avg_acceleration_norm as growth_score,
        array_agg(object_construct('year',year,'revenue',cast(revenue as string))) within group (order by year) as revenue_by_year
    from ok 
    group by 1,2
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.growth_score"} */;
[0m23:41:38.495872 [debug] [Thread-2 (]: Using snowflake connection "model.citrus_trade.score_2020"
[0m23:41:38.497971 [debug] [Thread-2 (]: On model.citrus_trade.score_2020: create or replace transient table TRADE_FLOW.marts.score_2020
    
    
    
    as (select distinct 
    declarant_iso,
    revenue,
    quantity,
    price_avg,
    (revenue - min(revenue) over())/((max(revenue) over())-(min(revenue) over())) as revenue_score,
    (quantity - min(quantity) over())/((max(quantity) over())-(min(quantity) over())) as quantity_score,
    (price_avg - min(price_avg) over())/((max(price_avg) over())-(min(price_avg) over())) as price_score
from TRADE_FLOW.marts.imports_exports_2020
where flow = 1
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.score_2020"} */;
[0m23:41:39.122501 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.624 seconds
[0m23:41:39.124301 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d4eabe5-b748-4ca0-af7e-77de218e7fc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99f9b950>]}
[0m23:41:39.125043 [info ] [Thread-2 (]: 6 of 8 OK created sql table model marts.score_2020 ............................. [[32mSUCCESS 1[0m in 0.65s]
[0m23:41:39.125570 [debug] [Thread-2 (]: Finished running node model.citrus_trade.score_2020
[0m23:41:39.281763 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.786 seconds
[0m23:41:39.283189 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d4eabe5-b748-4ca0-af7e-77de218e7fc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99fb9b80>]}
[0m23:41:39.283587 [info ] [Thread-3 (]: 5 of 8 OK created sql table model marts.growth_score ........................... [[32mSUCCESS 1[0m in 0.81s]
[0m23:41:39.284004 [debug] [Thread-3 (]: Finished running node model.citrus_trade.growth_score
[0m23:41:39.284731 [debug] [Thread-1 (]: Began running node model.citrus_trade.importer_score
[0m23:41:39.285070 [info ] [Thread-1 (]: 7 of 8 START sql table model marts.importer_score .............................. [RUN]
[0m23:41:39.285352 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.citrus_trade.imports_exports_2020, now model.citrus_trade.importer_score)
[0m23:41:39.285599 [debug] [Thread-1 (]: Began compiling node model.citrus_trade.importer_score
[0m23:41:39.287849 [debug] [Thread-1 (]: Writing injected SQL for node "model.citrus_trade.importer_score"
[0m23:41:39.289511 [debug] [Thread-1 (]: Began executing node model.citrus_trade.importer_score
[0m23:41:39.291087 [debug] [Thread-1 (]: Writing runtime sql for node "model.citrus_trade.importer_score"
[0m23:41:39.292091 [debug] [Thread-1 (]: Using snowflake connection "model.citrus_trade.importer_score"
[0m23:41:39.292313 [debug] [Thread-1 (]: On model.citrus_trade.importer_score: create or replace transient table TRADE_FLOW.marts.importer_score
    
    
    
    as (select distinct
    sc.declarant_iso,
    sc.revenue as revenue_2020,
    sc.quantity as quantity_2020,
    sc.price_avg as price_avg_2020,
    gs.revenue_by_year,
    sc.revenue_score,
    sc.quantity_score,
    sc.price_score,
    gs.growth_score
from TRADE_FLOW.marts.score_2020 as sc
inner join TRADE_FLOW.marts.growth_score as gs
    on gs.declarant_iso = sc.declarant_iso
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.importer_score"} */;
[0m23:41:40.044084 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.751 seconds
[0m23:41:40.049015 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d4eabe5-b748-4ca0-af7e-77de218e7fc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99f8eab0>]}
[0m23:41:40.050425 [info ] [Thread-1 (]: 7 of 8 OK created sql table model marts.importer_score ......................... [[32mSUCCESS 1[0m in 0.76s]
[0m23:41:40.051880 [debug] [Thread-1 (]: Finished running node model.citrus_trade.importer_score
[0m23:41:40.053661 [debug] [Thread-2 (]: Began running node model.citrus_trade.viz_importer_score
[0m23:41:40.054586 [info ] [Thread-2 (]: 8 of 8 START sql table model analytics.viz_importer_score ...................... [RUN]
[0m23:41:40.055566 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.citrus_trade.score_2020, now model.citrus_trade.viz_importer_score)
[0m23:41:40.056414 [debug] [Thread-2 (]: Began compiling node model.citrus_trade.viz_importer_score
[0m23:41:40.065861 [debug] [Thread-2 (]: Writing injected SQL for node "model.citrus_trade.viz_importer_score"
[0m23:41:40.068375 [debug] [Thread-2 (]: Began executing node model.citrus_trade.viz_importer_score
[0m23:41:40.071181 [debug] [Thread-2 (]: Writing runtime sql for node "model.citrus_trade.viz_importer_score"
[0m23:41:40.075579 [debug] [Thread-2 (]: Using snowflake connection "model.citrus_trade.viz_importer_score"
[0m23:41:40.076703 [debug] [Thread-2 (]: On model.citrus_trade.viz_importer_score: create or replace transient table TRADE_FLOW.analytics.viz_importer_score
    
    
    
    as (with 
    scores as (
        select 
            declarant_iso,
            score_type,
            score
        from TRADE_FLOW.marts.importer_score
        unpivot (
            score for score_type in (
                revenue_score as "revenue",
                quantity_score as "quantity",
                price_score as "price",
                growth_score as "growth"
            )
        )
    ),
    metrics as (
        select 
            declarant_iso,
            metric_type,
            metric
        from TRADE_FLOW.marts.importer_score
        unpivot (
            metric for metric_type in (
                revenue_2020 as "revenue",
                quantity_2020 as "quantity",
                price_avg_2020 as "price"
            )
        )
    )
select 
    s.declarant_iso,
    s.score_type,
    s.score,
    m.metric,
    case 
        when s.score_type = 'revenue' then 'Euro'
        when s.score_type = 'quantity' then 'Kg'
        when s.score_type = 'price' then 'Euro per Kg'
    end as metric_unit
from scores as s
left join metrics as m
    on s.declarant_iso = m.declarant_iso
    and s.score_type = m.metric_type
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.viz_importer_score"} */;
[0m23:41:40.761774 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.684 seconds
[0m23:41:40.764409 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d4eabe5-b748-4ca0-af7e-77de218e7fc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99f9b380>]}
[0m23:41:40.764965 [info ] [Thread-2 (]: 8 of 8 OK created sql table model analytics.viz_importer_score ................. [[32mSUCCESS 1[0m in 0.71s]
[0m23:41:40.765527 [debug] [Thread-2 (]: Finished running node model.citrus_trade.viz_importer_score
[0m23:41:40.769141 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:41:40.769446 [debug] [MainThread]: Connection 'model.citrus_trade.growth_score' was left open.
[0m23:41:40.769658 [debug] [MainThread]: On model.citrus_trade.growth_score: Close
[0m23:41:40.853217 [debug] [MainThread]: Connection 'model.citrus_trade.importer_score' was left open.
[0m23:41:40.853729 [debug] [MainThread]: On model.citrus_trade.importer_score: Close
[0m23:41:40.953052 [debug] [MainThread]: Connection 'model.citrus_trade.viz_importer_score' was left open.
[0m23:41:40.953576 [debug] [MainThread]: On model.citrus_trade.viz_importer_score: Close
[0m23:41:41.038885 [info ] [MainThread]: 
[0m23:41:41.040662 [info ] [MainThread]: Finished running 8 table models in 0 hours 0 minutes and 5.55 seconds (5.55s).
[0m23:41:41.043527 [debug] [MainThread]: Command end result
[0m23:41:41.095684 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m23:41:41.100531 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m23:41:41.118816 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/target/run_results.json
[0m23:41:41.119659 [info ] [MainThread]: 
[0m23:41:41.120522 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:41:41.121691 [info ] [MainThread]: 
[0m23:41:41.122648 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=8
[0m23:41:41.129245 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.3425565, "process_in_blocks": "2464", "process_kernel_time": 0.409062, "process_mem_max_rss": "151336", "process_out_blocks": "4297", "process_user_time": 1.730035}
[0m23:41:41.131171 [debug] [MainThread]: Command `dbt run` succeeded at 23:41:41.130842 after 6.35 seconds
[0m23:41:41.132653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ea6eae0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f4f8290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f4f9280>]}
[0m23:41:41.133492 [debug] [MainThread]: Flushing usage events
[0m23:41:41.825613 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:47:59.014336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff985a9940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97f70470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98238bf0>]}


============================== 23:47:59.017489 | 65d4f9bf-107b-4635-b70f-c8bfc4580553 ==============================
[0m23:47:59.017489 [info ] [MainThread]: Running with dbt=1.10.13
[0m23:47:59.017970 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'empty': 'False', 'invocation_command': 'dbt run', 'partial_parse': 'True', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'profiles_dir': '/opt/airflow/dbt', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'write_json': 'True', 'introspect': 'True', 'warn_error': 'None', 'target_path': 'None', 'fail_fast': 'False', 'quiet': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'debug': 'False', 'static_parser': 'True', 'printer_width': '80', 'cache_selected_only': 'False', 'no_print': 'None'}
[0m23:47:59.188970 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m23:47:59.189352 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m23:47:59.189546 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m23:47:59.286776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '65d4f9bf-107b-4635-b70f-c8bfc4580553', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a026630>]}
[0m23:47:59.321901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '65d4f9bf-107b-4635-b70f-c8bfc4580553', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff965eaf00>]}
[0m23:47:59.322600 [info ] [MainThread]: Registered adapter: snowflake=1.10.3
[0m23:47:59.410410 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m23:47:59.537051 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:47:59.537453 [debug] [MainThread]: Partial parsing: updated file: citrus_trade://models/marts/growth_score.sql
[0m23:47:59.662128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '65d4f9bf-107b-4635-b70f-c8bfc4580553', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff975c2900>]}
[0m23:47:59.707382 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m23:47:59.708787 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m23:47:59.718390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '65d4f9bf-107b-4635-b70f-c8bfc4580553', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff959746b0>]}
[0m23:47:59.718677 [info ] [MainThread]: Found 8 models, 3 sources, 636 macros
[0m23:47:59.718969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '65d4f9bf-107b-4635-b70f-c8bfc4580553', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95cfb560>]}
[0m23:47:59.720377 [info ] [MainThread]: 
[0m23:47:59.720633 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:47:59.720854 [info ] [MainThread]: 
[0m23:47:59.721194 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:47:59.723848 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRADE_FLOW'
[0m23:47:59.729845 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRADE_FLOW'
[0m23:47:59.731643 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRADE_FLOW'
[0m23:47:59.760175 [debug] [ThreadPool]: Using snowflake connection "list_TRADE_FLOW"
[0m23:47:59.760493 [debug] [ThreadPool]: Using snowflake connection "list_TRADE_FLOW"
[0m23:47:59.760728 [debug] [ThreadPool]: Using snowflake connection "list_TRADE_FLOW"
[0m23:47:59.760881 [debug] [ThreadPool]: On list_TRADE_FLOW: show terse schemas in database TRADE_FLOW
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRADE_FLOW"} */
[0m23:47:59.761101 [debug] [ThreadPool]: On list_TRADE_FLOW: show terse schemas in database TRADE_FLOW
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRADE_FLOW"} */
[0m23:47:59.761306 [debug] [ThreadPool]: On list_TRADE_FLOW: show terse schemas in database TRADE_FLOW
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRADE_FLOW"} */
[0m23:47:59.761522 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:47:59.761721 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:47:59.761906 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:48:00.512946 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.751 seconds
[0m23:48:00.515734 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.754 seconds
[0m23:48:00.530016 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.768 seconds
[0m23:48:00.533200 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRADE_FLOW, now list_TRADE_FLOW_staging)
[0m23:48:00.533818 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRADE_FLOW, now list_TRADE_FLOW_marts)
[0m23:48:00.540085 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRADE_FLOW, now list_TRADE_FLOW_analytics)
[0m23:48:00.549180 [debug] [ThreadPool]: Using snowflake connection "list_TRADE_FLOW_marts"
[0m23:48:00.549456 [debug] [ThreadPool]: Using snowflake connection "list_TRADE_FLOW_staging"
[0m23:48:00.551434 [debug] [ThreadPool]: Using snowflake connection "list_TRADE_FLOW_analytics"
[0m23:48:00.551847 [debug] [ThreadPool]: On list_TRADE_FLOW_marts: show objects in TRADE_FLOW.marts
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRADE_FLOW_marts"} */;
[0m23:48:00.552161 [debug] [ThreadPool]: On list_TRADE_FLOW_staging: show objects in TRADE_FLOW.staging
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRADE_FLOW_staging"} */;
[0m23:48:00.552460 [debug] [ThreadPool]: On list_TRADE_FLOW_analytics: show objects in TRADE_FLOW.analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRADE_FLOW_analytics"} */;
[0m23:48:00.634375 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.081 seconds
[0m23:48:00.640933 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.086 seconds
[0m23:48:00.642177 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 0.089 seconds
[0m23:48:00.649825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '65d4f9bf-107b-4635-b70f-c8bfc4580553', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95d06e40>]}
[0m23:48:00.654408 [debug] [Thread-1 (]: Began running node model.citrus_trade.stg_trade
[0m23:48:00.655149 [info ] [Thread-1 (]: 1 of 8 START sql table model staging.stg_trade ................................. [RUN]
[0m23:48:00.655854 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_TRADE_FLOW_marts, now model.citrus_trade.stg_trade)
[0m23:48:00.656455 [debug] [Thread-1 (]: Began compiling node model.citrus_trade.stg_trade
[0m23:48:00.666219 [debug] [Thread-1 (]: Writing injected SQL for node "model.citrus_trade.stg_trade"
[0m23:48:00.668180 [debug] [Thread-1 (]: Began executing node model.citrus_trade.stg_trade
[0m23:48:00.695554 [debug] [Thread-1 (]: Writing runtime sql for node "model.citrus_trade.stg_trade"
[0m23:48:00.697519 [debug] [Thread-1 (]: Using snowflake connection "model.citrus_trade.stg_trade"
[0m23:48:00.697825 [debug] [Thread-1 (]: On model.citrus_trade.stg_trade: create or replace transient table TRADE_FLOW.staging.stg_trade
    
    
    
    as (select
  value:DECLARANT::int as declarant,
  value:DECLARANT_ISO::string as declarant_iso,
  value:PARTNER::string as partner,
  value:PARTNER_ISO::string as partner_iso,
  value:FLOW::int as flow,
  value:TRANSPORT_MODE::int as transport_mode,
  value:PERIOD::int as period,
  year(to_date(left(period,4),'YYYY')) as year,
  value:HS4::string as hs4,
  value:HS4_NAME::string as hs4_name,
  value:HS6::string as hs6,
  value:HS6_NAME::string as hs6_name,
  value:VALUE_IN_EUROS::float as value_in_euros,
  value:QUANTITY_IN_KG::float as quantity_in_kg
from trade_flow.raw.raw_trhs
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.stg_trade"} */;
[0m23:48:01.658182 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.960 seconds
[0m23:48:01.671181 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65d4f9bf-107b-4635-b70f-c8bfc4580553', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a0257f0>]}
[0m23:48:01.671610 [info ] [Thread-1 (]: 1 of 8 OK created sql table model staging.stg_trade ............................ [[32mSUCCESS 1[0m in 1.01s]
[0m23:48:01.672076 [debug] [Thread-1 (]: Finished running node model.citrus_trade.stg_trade
[0m23:48:01.672692 [debug] [Thread-3 (]: Began running node model.citrus_trade.trade_by_hs
[0m23:48:01.673026 [info ] [Thread-3 (]: 2 of 8 START sql table model marts.trade_by_hs ................................. [RUN]
[0m23:48:01.673317 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_TRADE_FLOW_staging, now model.citrus_trade.trade_by_hs)
[0m23:48:01.673722 [debug] [Thread-3 (]: Began compiling node model.citrus_trade.trade_by_hs
[0m23:48:01.675482 [debug] [Thread-3 (]: Writing injected SQL for node "model.citrus_trade.trade_by_hs"
[0m23:48:01.676743 [debug] [Thread-3 (]: Began executing node model.citrus_trade.trade_by_hs
[0m23:48:01.679133 [debug] [Thread-3 (]: Writing runtime sql for node "model.citrus_trade.trade_by_hs"
[0m23:48:01.679876 [debug] [Thread-3 (]: Using snowflake connection "model.citrus_trade.trade_by_hs"
[0m23:48:01.680070 [debug] [Thread-3 (]: On model.citrus_trade.trade_by_hs: create or replace transient table TRADE_FLOW.marts.trade_by_hs
    
    
    
    as (select
    *
from TRADE_FLOW.staging.stg_trade
where hs6 = '080510'
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.trade_by_hs"} */;
[0m23:48:02.384243 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.704 seconds
[0m23:48:02.389712 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65d4f9bf-107b-4635-b70f-c8bfc4580553', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9455d580>]}
[0m23:48:02.391490 [info ] [Thread-3 (]: 2 of 8 OK created sql table model marts.trade_by_hs ............................ [[32mSUCCESS 1[0m in 0.72s]
[0m23:48:02.392938 [debug] [Thread-3 (]: Finished running node model.citrus_trade.trade_by_hs
[0m23:48:02.394482 [debug] [Thread-2 (]: Began running node model.citrus_trade.imports_by_year
[0m23:48:02.395165 [debug] [Thread-1 (]: Began running node model.citrus_trade.imports_exports_2020
[0m23:48:02.396906 [info ] [Thread-1 (]: 4 of 8 START sql table model marts.imports_exports_2020 ........................ [RUN]
[0m23:48:02.395798 [info ] [Thread-2 (]: 3 of 8 START sql table model marts.imports_by_year ............................. [RUN]
[0m23:48:02.397904 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.citrus_trade.stg_trade, now model.citrus_trade.imports_exports_2020)
[0m23:48:02.399309 [debug] [Thread-1 (]: Began compiling node model.citrus_trade.imports_exports_2020
[0m23:48:02.398687 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_TRADE_FLOW_analytics, now model.citrus_trade.imports_by_year)
[0m23:48:02.404346 [debug] [Thread-2 (]: Began compiling node model.citrus_trade.imports_by_year
[0m23:48:02.403826 [debug] [Thread-1 (]: Writing injected SQL for node "model.citrus_trade.imports_exports_2020"
[0m23:48:02.408631 [debug] [Thread-2 (]: Writing injected SQL for node "model.citrus_trade.imports_by_year"
[0m23:48:02.411690 [debug] [Thread-1 (]: Began executing node model.citrus_trade.imports_exports_2020
[0m23:48:02.415047 [debug] [Thread-1 (]: Writing runtime sql for node "model.citrus_trade.imports_exports_2020"
[0m23:48:02.415430 [debug] [Thread-2 (]: Began executing node model.citrus_trade.imports_by_year
[0m23:48:02.418220 [debug] [Thread-2 (]: Writing runtime sql for node "model.citrus_trade.imports_by_year"
[0m23:48:02.420292 [debug] [Thread-1 (]: Using snowflake connection "model.citrus_trade.imports_exports_2020"
[0m23:48:02.420862 [debug] [Thread-1 (]: On model.citrus_trade.imports_exports_2020: create or replace transient table TRADE_FLOW.marts.imports_exports_2020
    
    
    
    as (select
    declarant_iso,
    flow,
    sum(value_in_euros) over(partition by declarant_iso, flow) as revenue,
    sum(quantity_in_kg) over(partition by declarant_iso, flow) as quantity,
    revenue/nullif(quantity,0) as price_avg
from TRADE_FLOW.marts.trade_by_hs
where year = 2020
group by 
    declarant_iso,
    flow,
    value_in_euros,
    quantity_in_kg
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.imports_exports_2020"} */;
[0m23:48:02.422006 [debug] [Thread-2 (]: Using snowflake connection "model.citrus_trade.imports_by_year"
[0m23:48:02.423136 [debug] [Thread-2 (]: On model.citrus_trade.imports_by_year: create or replace transient table TRADE_FLOW.marts.imports_by_year
    
    
    
    as (select
    declarant_iso,
    year,
    sum(value_in_euros) as revenue,
    sum(quantity_in_kg) as quantity,
    revenue/nullif(quantity,0) as price_avg
from TRADE_FLOW.marts.trade_by_hs
where flow = 1
group by 1,2
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.imports_by_year"} */;
[0m23:48:03.010280 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.586 seconds
[0m23:48:03.012156 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65d4f9bf-107b-4635-b70f-c8bfc4580553', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94038ce0>]}
[0m23:48:03.012710 [info ] [Thread-2 (]: 3 of 8 OK created sql table model marts.imports_by_year ........................ [[32mSUCCESS 1[0m in 0.61s]
[0m23:48:03.013283 [debug] [Thread-2 (]: Finished running node model.citrus_trade.imports_by_year
[0m23:48:03.013851 [debug] [Thread-3 (]: Began running node model.citrus_trade.growth_score
[0m23:48:03.014140 [info ] [Thread-3 (]: 5 of 8 START sql table model marts.growth_score ................................ [RUN]
[0m23:48:03.014400 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.citrus_trade.trade_by_hs, now model.citrus_trade.growth_score)
[0m23:48:03.014698 [debug] [Thread-3 (]: Began compiling node model.citrus_trade.growth_score
[0m23:48:03.016991 [debug] [Thread-3 (]: Writing injected SQL for node "model.citrus_trade.growth_score"
[0m23:48:03.017815 [debug] [Thread-3 (]: Began executing node model.citrus_trade.growth_score
[0m23:48:03.019708 [debug] [Thread-3 (]: Writing runtime sql for node "model.citrus_trade.growth_score"
[0m23:48:03.021944 [debug] [Thread-3 (]: Using snowflake connection "model.citrus_trade.growth_score"
[0m23:48:03.022270 [debug] [Thread-3 (]: On model.citrus_trade.growth_score: create or replace transient table TRADE_FLOW.marts.growth_score
    
    
    
    as (with 
    previous_year AS (
        select 
            declarant_iso,
            year,
            lag(revenue,1) over(partition by declarant_iso order by year) revenue_previous_year,
            revenue,
            first_value(revenue) over(partition by declarant_iso order by year) as revenue_first_year,
            last_value(revenue) over(partition by declarant_iso order by year) as revenue_last_year
        from TRADE_FLOW.marts.imports_by_year
    ),
    growth_speed AS (
        select 
            declarant_iso,
            year,
            revenue_first_year,
            revenue_last_year,
            revenue_last_year/nullif(revenue_first_year,0) as growth_overall,
            revenue_previous_year,
            revenue,
            (revenue - revenue_previous_year)/revenue * 100 as growth_speed 
        from previous_year
    ),
    previous_year_growth_speed AS (
        select 
            declarant_iso,
            year,
            revenue_first_year,
            revenue_last_year,
            growth_overall,
            revenue_previous_year,
            revenue,
            growth_speed,
            lag(growth_speed,1) over(partition by declarant_iso order by year) growth_speed_previous_year,
        from growth_speed
    ),
    avg_acc AS (
        select 
            declarant_iso,
            year,
            revenue_first_year,
            revenue_last_year,
            growth_overall,
            revenue_previous_year,
            revenue,
            growth_speed_previous_year,
            growth_speed,
            growth_speed - growth_speed_previous_year as growth_acceleration,
            avg(growth_acceleration) over(partition by declarant_iso) as avg_acceleration
        from previous_year_growth_speed
    ),
    normalized as (
        select 
            declarant_iso,
            year,
            revenue_first_year,
            revenue_last_year,
            growth_overall,
            (growth_overall - min(growth_overall) OVER())/(max(growth_overall) OVER() - min(growth_overall) OVER()) as growth_overall_norm,
            revenue_previous_year,
            revenue,
            growth_speed_previous_year,
            growth_speed,
            growth_acceleration,
            avg_acceleration,
            (avg_acceleration - min(avg_acceleration) OVER())/(max(avg_acceleration) OVER() - min(avg_acceleration) OVER()) as avg_acceleration_norm
        from avg_acc 
    )
    select 
        declarant_iso,
        growth_overall_norm * avg_acceleration_norm as growth_score,
        array_agg(object_construct('year',year,'revenue',cast(revenue as string))) within group (order by year) as revenue_by_year
    from normalized 
    group by 1,2
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.growth_score"} */;
[0m23:48:03.179146 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.756 seconds
[0m23:48:03.184644 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65d4f9bf-107b-4635-b70f-c8bfc4580553', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9408be30>]}
[0m23:48:03.186228 [info ] [Thread-1 (]: 4 of 8 OK created sql table model marts.imports_exports_2020 ................... [[32mSUCCESS 1[0m in 0.79s]
[0m23:48:03.187418 [debug] [Thread-1 (]: Finished running node model.citrus_trade.imports_exports_2020
[0m23:48:03.188611 [debug] [Thread-2 (]: Began running node model.citrus_trade.score_2020
[0m23:48:03.189419 [info ] [Thread-2 (]: 6 of 8 START sql table model marts.score_2020 .................................. [RUN]
[0m23:48:03.190281 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.citrus_trade.imports_by_year, now model.citrus_trade.score_2020)
[0m23:48:03.190993 [debug] [Thread-2 (]: Began compiling node model.citrus_trade.score_2020
[0m23:48:03.196084 [debug] [Thread-2 (]: Writing injected SQL for node "model.citrus_trade.score_2020"
[0m23:48:03.198673 [debug] [Thread-2 (]: Began executing node model.citrus_trade.score_2020
[0m23:48:03.204322 [debug] [Thread-2 (]: Writing runtime sql for node "model.citrus_trade.score_2020"
[0m23:48:03.206618 [debug] [Thread-2 (]: Using snowflake connection "model.citrus_trade.score_2020"
[0m23:48:03.207090 [debug] [Thread-2 (]: On model.citrus_trade.score_2020: create or replace transient table TRADE_FLOW.marts.score_2020
    
    
    
    as (select distinct 
    declarant_iso,
    revenue,
    quantity,
    price_avg,
    (revenue - min(revenue) over())/((max(revenue) over())-(min(revenue) over())) as revenue_score,
    (quantity - min(quantity) over())/((max(quantity) over())-(min(quantity) over())) as quantity_score,
    (price_avg - min(price_avg) over())/((max(price_avg) over())-(min(price_avg) over())) as price_score
from TRADE_FLOW.marts.imports_exports_2020
where flow = 1
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.score_2020"} */;
[0m23:48:03.913291 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.705 seconds
[0m23:48:03.915906 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.893 seconds
[0m23:48:03.920587 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65d4f9bf-107b-4635-b70f-c8bfc4580553', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94161910>]}
[0m23:48:03.921015 [info ] [Thread-3 (]: 5 of 8 OK created sql table model marts.growth_score ........................... [[32mSUCCESS 1[0m in 0.91s]
[0m23:48:03.921591 [debug] [Thread-3 (]: Finished running node model.citrus_trade.growth_score
[0m23:48:03.919474 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65d4f9bf-107b-4635-b70f-c8bfc4580553', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9418a5d0>]}
[0m23:48:03.922106 [info ] [Thread-2 (]: 6 of 8 OK created sql table model marts.score_2020 ............................. [[32mSUCCESS 1[0m in 0.73s]
[0m23:48:03.922461 [debug] [Thread-2 (]: Finished running node model.citrus_trade.score_2020
[0m23:48:03.922952 [debug] [Thread-1 (]: Began running node model.citrus_trade.importer_score
[0m23:48:03.923361 [info ] [Thread-1 (]: 7 of 8 START sql table model marts.importer_score .............................. [RUN]
[0m23:48:03.923628 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.citrus_trade.imports_exports_2020, now model.citrus_trade.importer_score)
[0m23:48:03.923862 [debug] [Thread-1 (]: Began compiling node model.citrus_trade.importer_score
[0m23:48:03.925858 [debug] [Thread-1 (]: Writing injected SQL for node "model.citrus_trade.importer_score"
[0m23:48:03.927767 [debug] [Thread-1 (]: Began executing node model.citrus_trade.importer_score
[0m23:48:03.929350 [debug] [Thread-1 (]: Writing runtime sql for node "model.citrus_trade.importer_score"
[0m23:48:03.930340 [debug] [Thread-1 (]: Using snowflake connection "model.citrus_trade.importer_score"
[0m23:48:03.930619 [debug] [Thread-1 (]: On model.citrus_trade.importer_score: create or replace transient table TRADE_FLOW.marts.importer_score
    
    
    
    as (select distinct
    sc.declarant_iso,
    sc.revenue as revenue_2020,
    sc.quantity as quantity_2020,
    sc.price_avg as price_avg_2020,
    gs.revenue_by_year,
    sc.revenue_score,
    sc.quantity_score,
    sc.price_score,
    gs.growth_score
from TRADE_FLOW.marts.score_2020 as sc
inner join TRADE_FLOW.marts.growth_score as gs
    on gs.declarant_iso = sc.declarant_iso
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.importer_score"} */;
[0m23:48:04.732014 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.801 seconds
[0m23:48:04.735771 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65d4f9bf-107b-4635-b70f-c8bfc4580553', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9404b680>]}
[0m23:48:04.737117 [info ] [Thread-1 (]: 7 of 8 OK created sql table model marts.importer_score ......................... [[32mSUCCESS 1[0m in 0.81s]
[0m23:48:04.739033 [debug] [Thread-1 (]: Finished running node model.citrus_trade.importer_score
[0m23:48:04.740833 [debug] [Thread-3 (]: Began running node model.citrus_trade.viz_importer_score
[0m23:48:04.741730 [info ] [Thread-3 (]: 8 of 8 START sql table model analytics.viz_importer_score ...................... [RUN]
[0m23:48:04.742779 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.citrus_trade.growth_score, now model.citrus_trade.viz_importer_score)
[0m23:48:04.743456 [debug] [Thread-3 (]: Began compiling node model.citrus_trade.viz_importer_score
[0m23:48:04.749386 [debug] [Thread-3 (]: Writing injected SQL for node "model.citrus_trade.viz_importer_score"
[0m23:48:04.752204 [debug] [Thread-3 (]: Began executing node model.citrus_trade.viz_importer_score
[0m23:48:04.756260 [debug] [Thread-3 (]: Writing runtime sql for node "model.citrus_trade.viz_importer_score"
[0m23:48:04.759506 [debug] [Thread-3 (]: Using snowflake connection "model.citrus_trade.viz_importer_score"
[0m23:48:04.760362 [debug] [Thread-3 (]: On model.citrus_trade.viz_importer_score: create or replace transient table TRADE_FLOW.analytics.viz_importer_score
    
    
    
    as (with 
    scores as (
        select 
            declarant_iso,
            score_type,
            score
        from TRADE_FLOW.marts.importer_score
        unpivot (
            score for score_type in (
                revenue_score as "revenue",
                quantity_score as "quantity",
                price_score as "price",
                growth_score as "growth"
            )
        )
    ),
    metrics as (
        select 
            declarant_iso,
            metric_type,
            metric
        from TRADE_FLOW.marts.importer_score
        unpivot (
            metric for metric_type in (
                revenue_2020 as "revenue",
                quantity_2020 as "quantity",
                price_avg_2020 as "price"
            )
        )
    )
select 
    s.declarant_iso,
    s.score_type,
    s.score,
    m.metric,
    case 
        when s.score_type = 'revenue' then 'Euro'
        when s.score_type = 'quantity' then 'Kg'
        when s.score_type = 'price' then 'Euro per Kg'
    end as metric_unit
from scores as s
left join metrics as m
    on s.declarant_iso = m.declarant_iso
    and s.score_type = m.metric_type
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.viz_importer_score"} */;
[0m23:48:05.508344 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.747 seconds
[0m23:48:05.512747 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65d4f9bf-107b-4635-b70f-c8bfc4580553', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9418ae10>]}
[0m23:48:05.514273 [info ] [Thread-3 (]: 8 of 8 OK created sql table model analytics.viz_importer_score ................. [[32mSUCCESS 1[0m in 0.77s]
[0m23:48:05.516037 [debug] [Thread-3 (]: Finished running node model.citrus_trade.viz_importer_score
[0m23:48:05.521009 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:48:05.524449 [debug] [MainThread]: Connection 'model.citrus_trade.importer_score' was left open.
[0m23:48:05.526358 [debug] [MainThread]: On model.citrus_trade.importer_score: Close
[0m23:48:05.615633 [debug] [MainThread]: Connection 'model.citrus_trade.score_2020' was left open.
[0m23:48:05.616604 [debug] [MainThread]: On model.citrus_trade.score_2020: Close
[0m23:48:05.751953 [debug] [MainThread]: Connection 'model.citrus_trade.viz_importer_score' was left open.
[0m23:48:05.752776 [debug] [MainThread]: On model.citrus_trade.viz_importer_score: Close
[0m23:48:05.846219 [info ] [MainThread]: 
[0m23:48:05.847851 [info ] [MainThread]: Finished running 8 table models in 0 hours 0 minutes and 6.12 seconds (6.12s).
[0m23:48:05.851341 [debug] [MainThread]: Command end result
[0m23:48:05.899145 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m23:48:05.901832 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m23:48:05.910774 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/target/run_results.json
[0m23:48:05.911471 [info ] [MainThread]: 
[0m23:48:05.912838 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:48:05.913712 [info ] [MainThread]: 
[0m23:48:05.914182 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=8
[0m23:48:05.915784 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.933271, "process_in_blocks": "0", "process_kernel_time": 0.409559, "process_mem_max_rss": "151276", "process_out_blocks": "4298", "process_user_time": 1.899958}
[0m23:48:05.916390 [debug] [MainThread]: Command `dbt run` succeeded at 23:48:05.916310 after 6.93 seconds
[0m23:48:05.916806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97804f80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9829fad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95cb7e90>]}
[0m23:48:05.917200 [debug] [MainThread]: Flushing usage events
[0m23:48:06.592375 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:48:45.444370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5dbe9f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5410c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5410b30>]}


============================== 23:48:45.447394 | 8f7c590e-6bfd-4bc5-a691-68b6fe8de053 ==============================
[0m23:48:45.447394 [info ] [MainThread]: Running with dbt=1.10.13
[0m23:48:45.447837 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '/opt/airflow/dbt', 'static_parser': 'True', 'log_path': '/opt/airflow/dbt/logs', 'cache_selected_only': 'False', 'no_print': 'None', 'log_cache_events': 'False', 'target_path': 'None', 'partial_parse': 'True', 'fail_fast': 'False', 'debug': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'use_colors': 'True', 'warn_error': 'None', 'version_check': 'True', 'write_json': 'True', 'invocation_command': 'dbt run', 'empty': 'False', 'printer_width': '80', 'indirect_selection': 'eager', 'introspect': 'True', 'use_experimental_parser': 'False'}
[0m23:48:45.573769 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m23:48:45.574176 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m23:48:45.574358 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m23:48:45.671408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8f7c590e-6bfd-4bc5-a691-68b6fe8de053', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5962a20>]}
[0m23:48:45.702471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8f7c590e-6bfd-4bc5-a691-68b6fe8de053', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb354c7a0>]}
[0m23:48:45.702951 [info ] [MainThread]: Registered adapter: snowflake=1.10.3
[0m23:48:45.756491 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m23:48:45.868610 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m23:48:45.868982 [debug] [MainThread]: Partial parsing: added file: citrus_trade://models/analytics/importer_score_unpivot.sql
[0m23:48:45.869201 [debug] [MainThread]: Partial parsing: deleted file: citrus_trade://models/analytics/viz_importer_score.sql
[0m23:48:46.068273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8f7c590e-6bfd-4bc5-a691-68b6fe8de053', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2dd3290>]}
[0m23:48:46.171741 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m23:48:46.173883 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m23:48:46.186378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8f7c590e-6bfd-4bc5-a691-68b6fe8de053', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2d746e0>]}
[0m23:48:46.186678 [info ] [MainThread]: Found 8 models, 3 sources, 636 macros
[0m23:48:46.186899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8f7c590e-6bfd-4bc5-a691-68b6fe8de053', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb32d0f20>]}
[0m23:48:46.188027 [info ] [MainThread]: 
[0m23:48:46.188273 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:48:46.188526 [info ] [MainThread]: 
[0m23:48:46.188884 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:48:46.191720 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRADE_FLOW'
[0m23:48:46.198552 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRADE_FLOW'
[0m23:48:46.201614 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRADE_FLOW'
[0m23:48:46.226749 [debug] [ThreadPool]: Using snowflake connection "list_TRADE_FLOW"
[0m23:48:46.227059 [debug] [ThreadPool]: Using snowflake connection "list_TRADE_FLOW"
[0m23:48:46.227283 [debug] [ThreadPool]: Using snowflake connection "list_TRADE_FLOW"
[0m23:48:46.227430 [debug] [ThreadPool]: On list_TRADE_FLOW: show terse schemas in database TRADE_FLOW
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRADE_FLOW"} */
[0m23:48:46.227638 [debug] [ThreadPool]: On list_TRADE_FLOW: show terse schemas in database TRADE_FLOW
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRADE_FLOW"} */
[0m23:48:46.227832 [debug] [ThreadPool]: On list_TRADE_FLOW: show terse schemas in database TRADE_FLOW
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRADE_FLOW"} */
[0m23:48:46.228008 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:48:46.228201 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:48:46.228412 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:48:46.894854 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.667 seconds
[0m23:48:46.899500 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.671 seconds
[0m23:48:46.903242 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.675 seconds
[0m23:48:46.906931 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRADE_FLOW, now list_TRADE_FLOW_analytics)
[0m23:48:46.914339 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRADE_FLOW, now list_TRADE_FLOW_staging)
[0m23:48:46.923368 [debug] [ThreadPool]: Using snowflake connection "list_TRADE_FLOW_analytics"
[0m23:48:46.923764 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRADE_FLOW, now list_TRADE_FLOW_marts)
[0m23:48:46.927285 [debug] [ThreadPool]: Using snowflake connection "list_TRADE_FLOW_staging"
[0m23:48:46.927799 [debug] [ThreadPool]: On list_TRADE_FLOW_analytics: show objects in TRADE_FLOW.analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRADE_FLOW_analytics"} */;
[0m23:48:46.929971 [debug] [ThreadPool]: Using snowflake connection "list_TRADE_FLOW_marts"
[0m23:48:46.930398 [debug] [ThreadPool]: On list_TRADE_FLOW_staging: show objects in TRADE_FLOW.staging
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRADE_FLOW_staging"} */;
[0m23:48:46.932365 [debug] [ThreadPool]: On list_TRADE_FLOW_marts: show objects in TRADE_FLOW.marts
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRADE_FLOW_marts"} */;
[0m23:48:47.013263 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 0.080 seconds
[0m23:48:47.015139 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.084 seconds
[0m23:48:47.022708 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.090 seconds
[0m23:48:47.025488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8f7c590e-6bfd-4bc5-a691-68b6fe8de053', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2dd3a40>]}
[0m23:48:47.029376 [debug] [Thread-1 (]: Began running node model.citrus_trade.stg_trade
[0m23:48:47.030072 [info ] [Thread-1 (]: 1 of 8 START sql table model staging.stg_trade ................................. [RUN]
[0m23:48:47.030618 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_TRADE_FLOW_staging, now model.citrus_trade.stg_trade)
[0m23:48:47.031162 [debug] [Thread-1 (]: Began compiling node model.citrus_trade.stg_trade
[0m23:48:47.040516 [debug] [Thread-1 (]: Writing injected SQL for node "model.citrus_trade.stg_trade"
[0m23:48:47.043212 [debug] [Thread-1 (]: Began executing node model.citrus_trade.stg_trade
[0m23:48:47.076320 [debug] [Thread-1 (]: Writing runtime sql for node "model.citrus_trade.stg_trade"
[0m23:48:47.078566 [debug] [Thread-1 (]: Using snowflake connection "model.citrus_trade.stg_trade"
[0m23:48:47.078996 [debug] [Thread-1 (]: On model.citrus_trade.stg_trade: create or replace transient table TRADE_FLOW.staging.stg_trade
    
    
    
    as (select
  value:DECLARANT::int as declarant,
  value:DECLARANT_ISO::string as declarant_iso,
  value:PARTNER::string as partner,
  value:PARTNER_ISO::string as partner_iso,
  value:FLOW::int as flow,
  value:TRANSPORT_MODE::int as transport_mode,
  value:PERIOD::int as period,
  year(to_date(left(period,4),'YYYY')) as year,
  value:HS4::string as hs4,
  value:HS4_NAME::string as hs4_name,
  value:HS6::string as hs6,
  value:HS6_NAME::string as hs6_name,
  value:VALUE_IN_EUROS::float as value_in_euros,
  value:QUANTITY_IN_KG::float as quantity_in_kg
from trade_flow.raw.raw_trhs
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.stg_trade"} */;
[0m23:48:47.840047 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.761 seconds
[0m23:48:47.857599 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8f7c590e-6bfd-4bc5-a691-68b6fe8de053', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb74c5a30>]}
[0m23:48:47.858244 [info ] [Thread-1 (]: 1 of 8 OK created sql table model staging.stg_trade ............................ [[32mSUCCESS 1[0m in 0.83s]
[0m23:48:47.858704 [debug] [Thread-1 (]: Finished running node model.citrus_trade.stg_trade
[0m23:48:47.859509 [debug] [Thread-3 (]: Began running node model.citrus_trade.trade_by_hs
[0m23:48:47.859834 [info ] [Thread-3 (]: 2 of 8 START sql table model marts.trade_by_hs ................................. [RUN]
[0m23:48:47.860203 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_TRADE_FLOW_marts, now model.citrus_trade.trade_by_hs)
[0m23:48:47.860445 [debug] [Thread-3 (]: Began compiling node model.citrus_trade.trade_by_hs
[0m23:48:47.862840 [debug] [Thread-3 (]: Writing injected SQL for node "model.citrus_trade.trade_by_hs"
[0m23:48:47.864364 [debug] [Thread-3 (]: Began executing node model.citrus_trade.trade_by_hs
[0m23:48:47.866209 [debug] [Thread-3 (]: Writing runtime sql for node "model.citrus_trade.trade_by_hs"
[0m23:48:47.867067 [debug] [Thread-3 (]: Using snowflake connection "model.citrus_trade.trade_by_hs"
[0m23:48:47.867341 [debug] [Thread-3 (]: On model.citrus_trade.trade_by_hs: create or replace transient table TRADE_FLOW.marts.trade_by_hs
    
    
    
    as (select
    *
from TRADE_FLOW.staging.stg_trade
where hs6 = '080510'
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.trade_by_hs"} */;
[0m23:48:48.537572 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.670 seconds
[0m23:48:48.540192 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8f7c590e-6bfd-4bc5-a691-68b6fe8de053', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0b81b80>]}
[0m23:48:48.540857 [info ] [Thread-3 (]: 2 of 8 OK created sql table model marts.trade_by_hs ............................ [[32mSUCCESS 1[0m in 0.68s]
[0m23:48:48.541533 [debug] [Thread-3 (]: Finished running node model.citrus_trade.trade_by_hs
[0m23:48:48.542422 [debug] [Thread-2 (]: Began running node model.citrus_trade.imports_by_year
[0m23:48:48.542912 [info ] [Thread-2 (]: 3 of 8 START sql table model marts.imports_by_year ............................. [RUN]
[0m23:48:48.543547 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_TRADE_FLOW_analytics, now model.citrus_trade.imports_by_year)
[0m23:48:48.543838 [debug] [Thread-2 (]: Began compiling node model.citrus_trade.imports_by_year
[0m23:48:48.542664 [debug] [Thread-1 (]: Began running node model.citrus_trade.imports_exports_2020
[0m23:48:48.548320 [info ] [Thread-1 (]: 4 of 8 START sql table model marts.imports_exports_2020 ........................ [RUN]
[0m23:48:48.548864 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.citrus_trade.stg_trade, now model.citrus_trade.imports_exports_2020)
[0m23:48:48.549206 [debug] [Thread-1 (]: Began compiling node model.citrus_trade.imports_exports_2020
[0m23:48:48.551348 [debug] [Thread-1 (]: Writing injected SQL for node "model.citrus_trade.imports_exports_2020"
[0m23:48:48.547784 [debug] [Thread-2 (]: Writing injected SQL for node "model.citrus_trade.imports_by_year"
[0m23:48:48.553149 [debug] [Thread-1 (]: Began executing node model.citrus_trade.imports_exports_2020
[0m23:48:48.555118 [debug] [Thread-1 (]: Writing runtime sql for node "model.citrus_trade.imports_exports_2020"
[0m23:48:48.555374 [debug] [Thread-2 (]: Began executing node model.citrus_trade.imports_by_year
[0m23:48:48.557017 [debug] [Thread-2 (]: Writing runtime sql for node "model.citrus_trade.imports_by_year"
[0m23:48:48.558078 [debug] [Thread-1 (]: Using snowflake connection "model.citrus_trade.imports_exports_2020"
[0m23:48:48.558379 [debug] [Thread-1 (]: On model.citrus_trade.imports_exports_2020: create or replace transient table TRADE_FLOW.marts.imports_exports_2020
    
    
    
    as (select
    declarant_iso,
    flow,
    sum(value_in_euros) over(partition by declarant_iso, flow) as revenue,
    sum(quantity_in_kg) over(partition by declarant_iso, flow) as quantity,
    revenue/nullif(quantity,0) as price_avg
from TRADE_FLOW.marts.trade_by_hs
where year = 2020
group by 
    declarant_iso,
    flow,
    value_in_euros,
    quantity_in_kg
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.imports_exports_2020"} */;
[0m23:48:48.558755 [debug] [Thread-2 (]: Using snowflake connection "model.citrus_trade.imports_by_year"
[0m23:48:48.560308 [debug] [Thread-2 (]: On model.citrus_trade.imports_by_year: create or replace transient table TRADE_FLOW.marts.imports_by_year
    
    
    
    as (select
    declarant_iso,
    year,
    sum(value_in_euros) as revenue,
    sum(quantity_in_kg) as quantity,
    revenue/nullif(quantity,0) as price_avg
from TRADE_FLOW.marts.trade_by_hs
where flow = 1
group by 1,2
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.imports_by_year"} */;
[0m23:48:49.125490 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.565 seconds
[0m23:48:49.127644 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8f7c590e-6bfd-4bc5-a691-68b6fe8de053', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb15731a0>]}
[0m23:48:49.128432 [info ] [Thread-2 (]: 3 of 8 OK created sql table model marts.imports_by_year ........................ [[32mSUCCESS 1[0m in 0.58s]
[0m23:48:49.128932 [debug] [Thread-2 (]: Finished running node model.citrus_trade.imports_by_year
[0m23:48:49.129675 [debug] [Thread-3 (]: Began running node model.citrus_trade.growth_score
[0m23:48:49.130090 [info ] [Thread-3 (]: 5 of 8 START sql table model marts.growth_score ................................ [RUN]
[0m23:48:49.130627 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.citrus_trade.trade_by_hs, now model.citrus_trade.growth_score)
[0m23:48:49.131081 [debug] [Thread-3 (]: Began compiling node model.citrus_trade.growth_score
[0m23:48:49.133823 [debug] [Thread-3 (]: Writing injected SQL for node "model.citrus_trade.growth_score"
[0m23:48:49.135016 [debug] [Thread-3 (]: Began executing node model.citrus_trade.growth_score
[0m23:48:49.137160 [debug] [Thread-3 (]: Writing runtime sql for node "model.citrus_trade.growth_score"
[0m23:48:49.139868 [debug] [Thread-3 (]: Using snowflake connection "model.citrus_trade.growth_score"
[0m23:48:49.140325 [debug] [Thread-3 (]: On model.citrus_trade.growth_score: create or replace transient table TRADE_FLOW.marts.growth_score
    
    
    
    as (with 
    previous_year AS (
        select 
            declarant_iso,
            year,
            lag(revenue,1) over(partition by declarant_iso order by year) revenue_previous_year,
            revenue,
            first_value(revenue) over(partition by declarant_iso order by year) as revenue_first_year,
            last_value(revenue) over(partition by declarant_iso order by year) as revenue_last_year
        from TRADE_FLOW.marts.imports_by_year
    ),
    growth_speed AS (
        select 
            declarant_iso,
            year,
            revenue_first_year,
            revenue_last_year,
            revenue_last_year/nullif(revenue_first_year,0) as growth_overall,
            revenue_previous_year,
            revenue,
            (revenue - revenue_previous_year)/revenue * 100 as growth_speed 
        from previous_year
    ),
    previous_year_growth_speed AS (
        select 
            declarant_iso,
            year,
            revenue_first_year,
            revenue_last_year,
            growth_overall,
            revenue_previous_year,
            revenue,
            growth_speed,
            lag(growth_speed,1) over(partition by declarant_iso order by year) growth_speed_previous_year,
        from growth_speed
    ),
    avg_acc AS (
        select 
            declarant_iso,
            year,
            revenue_first_year,
            revenue_last_year,
            growth_overall,
            revenue_previous_year,
            revenue,
            growth_speed_previous_year,
            growth_speed,
            growth_speed - growth_speed_previous_year as growth_acceleration,
            avg(growth_acceleration) over(partition by declarant_iso) as avg_acceleration
        from previous_year_growth_speed
    ),
    normalized as (
        select 
            declarant_iso,
            year,
            revenue_first_year,
            revenue_last_year,
            growth_overall,
            (growth_overall - min(growth_overall) OVER())/(max(growth_overall) OVER() - min(growth_overall) OVER()) as growth_overall_norm,
            revenue_previous_year,
            revenue,
            growth_speed_previous_year,
            growth_speed,
            growth_acceleration,
            avg_acceleration,
            (avg_acceleration - min(avg_acceleration) OVER())/(max(avg_acceleration) OVER() - min(avg_acceleration) OVER()) as avg_acceleration_norm
        from avg_acc 
    )
    select 
        declarant_iso,
        growth_overall_norm * avg_acceleration_norm as growth_score,
        array_agg(object_construct('year',year,'revenue',cast(revenue as string))) within group (order by year) as revenue_by_year
    from normalized 
    group by 1,2
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.growth_score"} */;
[0m23:48:49.176530 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.618 seconds
[0m23:48:49.178716 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8f7c590e-6bfd-4bc5-a691-68b6fe8de053', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0b7ade0>]}
[0m23:48:49.179315 [info ] [Thread-1 (]: 4 of 8 OK created sql table model marts.imports_exports_2020 ................... [[32mSUCCESS 1[0m in 0.63s]
[0m23:48:49.179903 [debug] [Thread-1 (]: Finished running node model.citrus_trade.imports_exports_2020
[0m23:48:49.180749 [debug] [Thread-2 (]: Began running node model.citrus_trade.score_2020
[0m23:48:49.181137 [info ] [Thread-2 (]: 6 of 8 START sql table model marts.score_2020 .................................. [RUN]
[0m23:48:49.181472 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.citrus_trade.imports_by_year, now model.citrus_trade.score_2020)
[0m23:48:49.181771 [debug] [Thread-2 (]: Began compiling node model.citrus_trade.score_2020
[0m23:48:49.184323 [debug] [Thread-2 (]: Writing injected SQL for node "model.citrus_trade.score_2020"
[0m23:48:49.185932 [debug] [Thread-2 (]: Began executing node model.citrus_trade.score_2020
[0m23:48:49.189123 [debug] [Thread-2 (]: Writing runtime sql for node "model.citrus_trade.score_2020"
[0m23:48:49.190580 [debug] [Thread-2 (]: Using snowflake connection "model.citrus_trade.score_2020"
[0m23:48:49.190892 [debug] [Thread-2 (]: On model.citrus_trade.score_2020: create or replace transient table TRADE_FLOW.marts.score_2020
    
    
    
    as (select distinct 
    declarant_iso,
    revenue,
    quantity,
    price_avg,
    (revenue - min(revenue) over())/((max(revenue) over())-(min(revenue) over())) as revenue_score,
    (quantity - min(quantity) over())/((max(quantity) over())-(min(quantity) over())) as quantity_score,
    (price_avg - min(price_avg) over())/((max(price_avg) over())-(min(price_avg) over())) as price_score
from TRADE_FLOW.marts.imports_exports_2020
where flow = 1
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.score_2020"} */;
[0m23:48:49.892406 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.701 seconds
[0m23:48:49.894181 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.753 seconds
[0m23:48:49.900783 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8f7c590e-6bfd-4bc5-a691-68b6fe8de053', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb15572f0>]}
[0m23:48:49.897986 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8f7c590e-6bfd-4bc5-a691-68b6fe8de053', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb19dac30>]}
[0m23:48:49.901701 [info ] [Thread-3 (]: 5 of 8 OK created sql table model marts.growth_score ........................... [[32mSUCCESS 1[0m in 0.77s]
[0m23:48:49.903486 [debug] [Thread-3 (]: Finished running node model.citrus_trade.growth_score
[0m23:48:49.902657 [info ] [Thread-2 (]: 6 of 8 OK created sql table model marts.score_2020 ............................. [[32mSUCCESS 1[0m in 0.72s]
[0m23:48:49.904472 [debug] [Thread-2 (]: Finished running node model.citrus_trade.score_2020
[0m23:48:49.905564 [debug] [Thread-1 (]: Began running node model.citrus_trade.importer_score
[0m23:48:49.906414 [info ] [Thread-1 (]: 7 of 8 START sql table model marts.importer_score .............................. [RUN]
[0m23:48:49.907132 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.citrus_trade.imports_exports_2020, now model.citrus_trade.importer_score)
[0m23:48:49.907653 [debug] [Thread-1 (]: Began compiling node model.citrus_trade.importer_score
[0m23:48:49.912168 [debug] [Thread-1 (]: Writing injected SQL for node "model.citrus_trade.importer_score"
[0m23:48:49.913685 [debug] [Thread-1 (]: Began executing node model.citrus_trade.importer_score
[0m23:48:49.916844 [debug] [Thread-1 (]: Writing runtime sql for node "model.citrus_trade.importer_score"
[0m23:48:49.919422 [debug] [Thread-1 (]: Using snowflake connection "model.citrus_trade.importer_score"
[0m23:48:49.919887 [debug] [Thread-1 (]: On model.citrus_trade.importer_score: create or replace transient table TRADE_FLOW.marts.importer_score
    
    
    
    as (select distinct
    sc.declarant_iso,
    sc.revenue as revenue_2020,
    sc.quantity as quantity_2020,
    sc.price_avg as price_avg_2020,
    gs.revenue_by_year,
    sc.revenue_score,
    sc.quantity_score,
    sc.price_score,
    gs.growth_score
from TRADE_FLOW.marts.score_2020 as sc
inner join TRADE_FLOW.marts.growth_score as gs
    on gs.declarant_iso = sc.declarant_iso
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.importer_score"} */;
[0m23:48:50.710657 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.790 seconds
[0m23:48:50.715633 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8f7c590e-6bfd-4bc5-a691-68b6fe8de053', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb19d8890>]}
[0m23:48:50.716823 [info ] [Thread-1 (]: 7 of 8 OK created sql table model marts.importer_score ......................... [[32mSUCCESS 1[0m in 0.81s]
[0m23:48:50.717863 [debug] [Thread-1 (]: Finished running node model.citrus_trade.importer_score
[0m23:48:50.719509 [debug] [Thread-3 (]: Began running node model.citrus_trade.importer_score_unpivot
[0m23:48:50.720384 [info ] [Thread-3 (]: 8 of 8 START sql table model analytics.importer_score_unpivot .................. [RUN]
[0m23:48:50.721175 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.citrus_trade.growth_score, now model.citrus_trade.importer_score_unpivot)
[0m23:48:50.721891 [debug] [Thread-3 (]: Began compiling node model.citrus_trade.importer_score_unpivot
[0m23:48:50.727567 [debug] [Thread-3 (]: Writing injected SQL for node "model.citrus_trade.importer_score_unpivot"
[0m23:48:50.730266 [debug] [Thread-3 (]: Began executing node model.citrus_trade.importer_score_unpivot
[0m23:48:50.735428 [debug] [Thread-3 (]: Writing runtime sql for node "model.citrus_trade.importer_score_unpivot"
[0m23:48:50.739951 [debug] [Thread-3 (]: Using snowflake connection "model.citrus_trade.importer_score_unpivot"
[0m23:48:50.740765 [debug] [Thread-3 (]: On model.citrus_trade.importer_score_unpivot: create or replace transient table TRADE_FLOW.analytics.importer_score_unpivot
    
    
    
    as (with 
    scores as (
        select 
            declarant_iso,
            score_type,
            score
        from TRADE_FLOW.marts.importer_score
        unpivot (
            score for score_type in (
                revenue_score as "revenue",
                quantity_score as "quantity",
                price_score as "price",
                growth_score as "growth"
            )
        )
    ),
    metrics as (
        select 
            declarant_iso,
            metric_type,
            metric
        from TRADE_FLOW.marts.importer_score
        unpivot (
            metric for metric_type in (
                revenue_2020 as "revenue",
                quantity_2020 as "quantity",
                price_avg_2020 as "price"
            )
        )
    )
select 
    s.declarant_iso,
    s.score_type,
    s.score,
    m.metric,
    case 
        when s.score_type = 'revenue' then 'Euro'
        when s.score_type = 'quantity' then 'Kg'
        when s.score_type = 'price' then 'Euro per Kg'
    end as metric_unit
from scores as s
left join metrics as m
    on s.declarant_iso = m.declarant_iso
    and s.score_type = m.metric_type
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.importer_score_unpivot"} */;
[0m23:48:51.379436 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.637 seconds
[0m23:48:51.387133 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8f7c590e-6bfd-4bc5-a691-68b6fe8de053', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0bb8170>]}
[0m23:48:51.388724 [info ] [Thread-3 (]: 8 of 8 OK created sql table model analytics.importer_score_unpivot ............. [[32mSUCCESS 1[0m in 0.67s]
[0m23:48:51.389841 [debug] [Thread-3 (]: Finished running node model.citrus_trade.importer_score_unpivot
[0m23:48:51.393748 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:48:51.394476 [debug] [MainThread]: Connection 'model.citrus_trade.importer_score_unpivot' was left open.
[0m23:48:51.395098 [debug] [MainThread]: On model.citrus_trade.importer_score_unpivot: Close
[0m23:48:51.500832 [debug] [MainThread]: Connection 'model.citrus_trade.score_2020' was left open.
[0m23:48:51.501703 [debug] [MainThread]: On model.citrus_trade.score_2020: Close
[0m23:48:51.599152 [debug] [MainThread]: Connection 'model.citrus_trade.importer_score' was left open.
[0m23:48:51.600291 [debug] [MainThread]: On model.citrus_trade.importer_score: Close
[0m23:48:51.713839 [info ] [MainThread]: 
[0m23:48:51.715309 [info ] [MainThread]: Finished running 8 table models in 0 hours 0 minutes and 5.52 seconds (5.52s).
[0m23:48:51.718579 [debug] [MainThread]: Command end result
[0m23:48:51.767920 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m23:48:51.771097 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m23:48:51.777803 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/target/run_results.json
[0m23:48:51.778023 [info ] [MainThread]: 
[0m23:48:51.778291 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:48:51.778596 [info ] [MainThread]: 
[0m23:48:51.779052 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=8
[0m23:48:51.780824 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.368372, "process_in_blocks": "0", "process_kernel_time": 0.334892, "process_mem_max_rss": "151324", "process_out_blocks": "4298", "process_user_time": 1.807421}
[0m23:48:51.781286 [debug] [MainThread]: Command `dbt run` succeeded at 23:48:51.781191 after 6.37 seconds
[0m23:48:51.781661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb9af28a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2d757f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1d43d40>]}
[0m23:48:51.781898 [debug] [MainThread]: Flushing usage events
[0m23:48:52.371006 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:52:42.505920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaacbbc80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffab51dc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9ac6870>]}


============================== 23:52:42.508927 | 608794a6-e669-49ec-ab8d-a52ce4942094 ==============================
[0m23:52:42.508927 [info ] [MainThread]: Running with dbt=1.10.13
[0m23:52:42.509287 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'invocation_command': 'dbt run', 'indirect_selection': 'eager', 'fail_fast': 'False', 'quiet': 'False', 'static_parser': 'True', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'log_format': 'default', 'log_cache_events': 'False', 'debug': 'False', 'empty': 'False', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'no_print': 'None', 'warn_error': 'None', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'log_path': '/opt/airflow/dbt/logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'introspect': 'True'}
[0m23:52:42.645865 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m23:52:42.646370 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m23:52:42.646647 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m23:52:42.745971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '608794a6-e669-49ec-ab8d-a52ce4942094', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa75d62d0>]}
[0m23:52:42.779801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '608794a6-e669-49ec-ab8d-a52ce4942094', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa78282f0>]}
[0m23:52:42.780404 [info ] [MainThread]: Registered adapter: snowflake=1.10.3
[0m23:52:42.833797 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m23:52:42.947051 [debug] [MainThread]: Partial parsing enabled: 2 files deleted, 2 files added, 0 files changed.
[0m23:52:42.947433 [debug] [MainThread]: Partial parsing: added file: citrus_trade://models/analytics/imports_score_unpivot.sql
[0m23:52:42.947626 [debug] [MainThread]: Partial parsing: added file: citrus_trade://models/marts/imports_score.sql
[0m23:52:42.947773 [debug] [MainThread]: Partial parsing: deleted file: citrus_trade://models/marts/importer_score.sql
[0m23:52:42.947899 [debug] [MainThread]: Partial parsing: deleted file: citrus_trade://models/analytics/importer_score_unpivot.sql
[0m23:52:43.074312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '608794a6-e669-49ec-ab8d-a52ce4942094', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa712ea50>]}
[0m23:52:43.119635 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m23:52:43.121759 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m23:52:43.137432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '608794a6-e669-49ec-ab8d-a52ce4942094', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa712ec00>]}
[0m23:52:43.137774 [info ] [MainThread]: Found 8 models, 3 sources, 636 macros
[0m23:52:43.137967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '608794a6-e669-49ec-ab8d-a52ce4942094', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa72ff590>]}
[0m23:52:43.139058 [info ] [MainThread]: 
[0m23:52:43.139292 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:52:43.139696 [info ] [MainThread]: 
[0m23:52:43.140147 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:52:43.143102 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRADE_FLOW'
[0m23:52:43.149707 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRADE_FLOW'
[0m23:52:43.153261 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRADE_FLOW'
[0m23:52:43.178077 [debug] [ThreadPool]: Using snowflake connection "list_TRADE_FLOW"
[0m23:52:43.178454 [debug] [ThreadPool]: Using snowflake connection "list_TRADE_FLOW"
[0m23:52:43.178679 [debug] [ThreadPool]: Using snowflake connection "list_TRADE_FLOW"
[0m23:52:43.178889 [debug] [ThreadPool]: On list_TRADE_FLOW: show terse schemas in database TRADE_FLOW
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRADE_FLOW"} */
[0m23:52:43.179165 [debug] [ThreadPool]: On list_TRADE_FLOW: show terse schemas in database TRADE_FLOW
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRADE_FLOW"} */
[0m23:52:43.179403 [debug] [ThreadPool]: On list_TRADE_FLOW: show terse schemas in database TRADE_FLOW
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRADE_FLOW"} */
[0m23:52:43.179611 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:52:43.179893 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:52:43.180165 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:52:43.868283 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.688 seconds
[0m23:52:43.871796 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.691 seconds
[0m23:52:43.892840 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.713 seconds
[0m23:52:43.906945 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRADE_FLOW, now list_TRADE_FLOW_analytics)
[0m23:52:43.908636 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRADE_FLOW, now list_TRADE_FLOW_marts)
[0m23:52:43.909684 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRADE_FLOW, now list_TRADE_FLOW_staging)
[0m23:52:43.961137 [debug] [ThreadPool]: Using snowflake connection "list_TRADE_FLOW_analytics"
[0m23:52:43.961837 [debug] [ThreadPool]: Using snowflake connection "list_TRADE_FLOW_staging"
[0m23:52:43.963735 [debug] [ThreadPool]: Using snowflake connection "list_TRADE_FLOW_marts"
[0m23:52:43.963963 [debug] [ThreadPool]: On list_TRADE_FLOW_analytics: show objects in TRADE_FLOW.analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRADE_FLOW_analytics"} */;
[0m23:52:43.964239 [debug] [ThreadPool]: On list_TRADE_FLOW_staging: show objects in TRADE_FLOW.staging
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRADE_FLOW_staging"} */;
[0m23:52:43.964490 [debug] [ThreadPool]: On list_TRADE_FLOW_marts: show objects in TRADE_FLOW.marts
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRADE_FLOW_marts"} */;
[0m23:52:44.042075 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.076 seconds
[0m23:52:44.042937 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.076 seconds
[0m23:52:44.043415 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.079 seconds
[0m23:52:44.047570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '608794a6-e669-49ec-ab8d-a52ce4942094', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffab28d5e0>]}
[0m23:52:44.050258 [debug] [Thread-1 (]: Began running node model.citrus_trade.stg_trade
[0m23:52:44.050683 [info ] [Thread-1 (]: 1 of 8 START sql table model staging.stg_trade ................................. [RUN]
[0m23:52:44.051148 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_TRADE_FLOW_analytics, now model.citrus_trade.stg_trade)
[0m23:52:44.051478 [debug] [Thread-1 (]: Began compiling node model.citrus_trade.stg_trade
[0m23:52:44.056842 [debug] [Thread-1 (]: Writing injected SQL for node "model.citrus_trade.stg_trade"
[0m23:52:44.058210 [debug] [Thread-1 (]: Began executing node model.citrus_trade.stg_trade
[0m23:52:44.076706 [debug] [Thread-1 (]: Writing runtime sql for node "model.citrus_trade.stg_trade"
[0m23:52:44.078146 [debug] [Thread-1 (]: Using snowflake connection "model.citrus_trade.stg_trade"
[0m23:52:44.078380 [debug] [Thread-1 (]: On model.citrus_trade.stg_trade: create or replace transient table TRADE_FLOW.staging.stg_trade
    
    
    
    as (select
  value:DECLARANT::int as declarant,
  value:DECLARANT_ISO::string as declarant_iso,
  value:PARTNER::string as partner,
  value:PARTNER_ISO::string as partner_iso,
  value:FLOW::int as flow,
  value:TRANSPORT_MODE::int as transport_mode,
  value:PERIOD::int as period,
  year(to_date(left(period,4),'YYYY')) as year,
  value:HS4::string as hs4,
  value:HS4_NAME::string as hs4_name,
  value:HS6::string as hs6,
  value:HS6_NAME::string as hs6_name,
  value:VALUE_IN_EUROS::float as value_in_euros,
  value:QUANTITY_IN_KG::float as quantity_in_kg
from trade_flow.raw.raw_trhs
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.stg_trade"} */;
[0m23:52:44.776606 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.698 seconds
[0m23:52:44.799211 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '608794a6-e669-49ec-ab8d-a52ce4942094', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffab1b5c40>]}
[0m23:52:44.799930 [info ] [Thread-1 (]: 1 of 8 OK created sql table model staging.stg_trade ............................ [[32mSUCCESS 1[0m in 0.75s]
[0m23:52:44.800552 [debug] [Thread-1 (]: Finished running node model.citrus_trade.stg_trade
[0m23:52:44.801988 [debug] [Thread-3 (]: Began running node model.citrus_trade.trade_by_hs
[0m23:52:44.802334 [info ] [Thread-3 (]: 2 of 8 START sql table model marts.trade_by_hs ................................. [RUN]
[0m23:52:44.802800 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_TRADE_FLOW_staging, now model.citrus_trade.trade_by_hs)
[0m23:52:44.803657 [debug] [Thread-3 (]: Began compiling node model.citrus_trade.trade_by_hs
[0m23:52:44.806619 [debug] [Thread-3 (]: Writing injected SQL for node "model.citrus_trade.trade_by_hs"
[0m23:52:44.807988 [debug] [Thread-3 (]: Began executing node model.citrus_trade.trade_by_hs
[0m23:52:44.811716 [debug] [Thread-3 (]: Writing runtime sql for node "model.citrus_trade.trade_by_hs"
[0m23:52:44.813202 [debug] [Thread-3 (]: Using snowflake connection "model.citrus_trade.trade_by_hs"
[0m23:52:44.813574 [debug] [Thread-3 (]: On model.citrus_trade.trade_by_hs: create or replace transient table TRADE_FLOW.marts.trade_by_hs
    
    
    
    as (select
    *
from TRADE_FLOW.staging.stg_trade
where hs6 = '080510'
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.trade_by_hs"} */;
[0m23:52:45.453259 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.639 seconds
[0m23:52:45.460077 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '608794a6-e669-49ec-ab8d-a52ce4942094', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6e6fd10>]}
[0m23:52:45.461471 [info ] [Thread-3 (]: 2 of 8 OK created sql table model marts.trade_by_hs ............................ [[32mSUCCESS 1[0m in 0.66s]
[0m23:52:45.462934 [debug] [Thread-3 (]: Finished running node model.citrus_trade.trade_by_hs
[0m23:52:45.464126 [debug] [Thread-2 (]: Began running node model.citrus_trade.imports_by_year
[0m23:52:45.464542 [debug] [Thread-1 (]: Began running node model.citrus_trade.imports_exports_2020
[0m23:52:45.464909 [info ] [Thread-2 (]: 3 of 8 START sql table model marts.imports_by_year ............................. [RUN]
[0m23:52:45.466570 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_TRADE_FLOW_marts, now model.citrus_trade.imports_by_year)
[0m23:52:45.466941 [debug] [Thread-2 (]: Began compiling node model.citrus_trade.imports_by_year
[0m23:52:45.465819 [info ] [Thread-1 (]: 4 of 8 START sql table model marts.imports_exports_2020 ........................ [RUN]
[0m23:52:45.470616 [debug] [Thread-2 (]: Writing injected SQL for node "model.citrus_trade.imports_by_year"
[0m23:52:45.471268 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.citrus_trade.stg_trade, now model.citrus_trade.imports_exports_2020)
[0m23:52:45.472738 [debug] [Thread-1 (]: Began compiling node model.citrus_trade.imports_exports_2020
[0m23:52:45.476377 [debug] [Thread-1 (]: Writing injected SQL for node "model.citrus_trade.imports_exports_2020"
[0m23:52:45.477204 [debug] [Thread-2 (]: Began executing node model.citrus_trade.imports_by_year
[0m23:52:45.480579 [debug] [Thread-2 (]: Writing runtime sql for node "model.citrus_trade.imports_by_year"
[0m23:52:45.481541 [debug] [Thread-1 (]: Began executing node model.citrus_trade.imports_exports_2020
[0m23:52:45.484861 [debug] [Thread-1 (]: Writing runtime sql for node "model.citrus_trade.imports_exports_2020"
[0m23:52:45.486579 [debug] [Thread-2 (]: Using snowflake connection "model.citrus_trade.imports_by_year"
[0m23:52:45.487376 [debug] [Thread-2 (]: On model.citrus_trade.imports_by_year: create or replace transient table TRADE_FLOW.marts.imports_by_year
    
    
    
    as (select
    declarant_iso,
    year,
    sum(value_in_euros) as revenue,
    sum(quantity_in_kg) as quantity,
    revenue/nullif(quantity,0) as price_avg
from TRADE_FLOW.marts.trade_by_hs
where flow = 1
group by 1,2
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.imports_by_year"} */;
[0m23:52:45.490230 [debug] [Thread-1 (]: Using snowflake connection "model.citrus_trade.imports_exports_2020"
[0m23:52:45.490630 [debug] [Thread-1 (]: On model.citrus_trade.imports_exports_2020: create or replace transient table TRADE_FLOW.marts.imports_exports_2020
    
    
    
    as (select
    declarant_iso,
    flow,
    sum(value_in_euros) over(partition by declarant_iso, flow) as revenue,
    sum(quantity_in_kg) over(partition by declarant_iso, flow) as quantity,
    revenue/nullif(quantity,0) as price_avg
from TRADE_FLOW.marts.trade_by_hs
where year = 2020
group by 
    declarant_iso,
    flow,
    value_in_euros,
    quantity_in_kg
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.imports_exports_2020"} */;
[0m23:52:46.125286 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.634 seconds
[0m23:52:46.127923 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '608794a6-e669-49ec-ab8d-a52ce4942094', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5175ee0>]}
[0m23:52:46.129554 [info ] [Thread-1 (]: 4 of 8 OK created sql table model marts.imports_exports_2020 ................... [[32mSUCCESS 1[0m in 0.66s]
[0m23:52:46.130859 [debug] [Thread-1 (]: Finished running node model.citrus_trade.imports_exports_2020
[0m23:52:46.132647 [debug] [Thread-3 (]: Began running node model.citrus_trade.score_2020
[0m23:52:46.133800 [info ] [Thread-3 (]: 5 of 8 START sql table model marts.score_2020 .................................. [RUN]
[0m23:52:46.134772 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.citrus_trade.trade_by_hs, now model.citrus_trade.score_2020)
[0m23:52:46.137018 [debug] [Thread-3 (]: Began compiling node model.citrus_trade.score_2020
[0m23:52:46.148803 [debug] [Thread-3 (]: Writing injected SQL for node "model.citrus_trade.score_2020"
[0m23:52:46.158404 [debug] [Thread-3 (]: Began executing node model.citrus_trade.score_2020
[0m23:52:46.165128 [debug] [Thread-3 (]: Writing runtime sql for node "model.citrus_trade.score_2020"
[0m23:52:46.168798 [debug] [Thread-3 (]: Using snowflake connection "model.citrus_trade.score_2020"
[0m23:52:46.169334 [debug] [Thread-3 (]: On model.citrus_trade.score_2020: create or replace transient table TRADE_FLOW.marts.score_2020
    
    
    
    as (select distinct 
    declarant_iso,
    revenue,
    quantity,
    price_avg,
    (revenue - min(revenue) over())/((max(revenue) over())-(min(revenue) over())) as revenue_score,
    (quantity - min(quantity) over())/((max(quantity) over())-(min(quantity) over())) as quantity_score,
    (price_avg - min(price_avg) over())/((max(price_avg) over())-(min(price_avg) over())) as price_score
from TRADE_FLOW.marts.imports_exports_2020
where flow = 1
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.score_2020"} */;
[0m23:52:46.172849 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.685 seconds
[0m23:52:46.181437 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '608794a6-e669-49ec-ab8d-a52ce4942094', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa55640b0>]}
[0m23:52:46.186651 [info ] [Thread-2 (]: 3 of 8 OK created sql table model marts.imports_by_year ........................ [[32mSUCCESS 1[0m in 0.71s]
[0m23:52:46.189983 [debug] [Thread-2 (]: Finished running node model.citrus_trade.imports_by_year
[0m23:52:46.197699 [debug] [Thread-1 (]: Began running node model.citrus_trade.growth_score
[0m23:52:46.204292 [info ] [Thread-1 (]: 6 of 8 START sql table model marts.growth_score ................................ [RUN]
[0m23:52:46.213255 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.citrus_trade.imports_exports_2020, now model.citrus_trade.growth_score)
[0m23:52:46.214284 [debug] [Thread-1 (]: Began compiling node model.citrus_trade.growth_score
[0m23:52:46.233864 [debug] [Thread-1 (]: Writing injected SQL for node "model.citrus_trade.growth_score"
[0m23:52:46.248040 [debug] [Thread-1 (]: Began executing node model.citrus_trade.growth_score
[0m23:52:46.253608 [debug] [Thread-1 (]: Writing runtime sql for node "model.citrus_trade.growth_score"
[0m23:52:46.259010 [debug] [Thread-1 (]: Using snowflake connection "model.citrus_trade.growth_score"
[0m23:52:46.261278 [debug] [Thread-1 (]: On model.citrus_trade.growth_score: create or replace transient table TRADE_FLOW.marts.growth_score
    
    
    
    as (with 
    previous_year AS (
        select 
            declarant_iso,
            year,
            lag(revenue,1) over(partition by declarant_iso order by year) revenue_previous_year,
            revenue,
            first_value(revenue) over(partition by declarant_iso order by year) as revenue_first_year,
            last_value(revenue) over(partition by declarant_iso order by year) as revenue_last_year
        from TRADE_FLOW.marts.imports_by_year
    ),
    growth_speed AS (
        select 
            declarant_iso,
            year,
            revenue_first_year,
            revenue_last_year,
            revenue_last_year/nullif(revenue_first_year,0) as growth_overall,
            revenue_previous_year,
            revenue,
            (revenue - revenue_previous_year)/revenue * 100 as growth_speed 
        from previous_year
    ),
    previous_year_growth_speed AS (
        select 
            declarant_iso,
            year,
            revenue_first_year,
            revenue_last_year,
            growth_overall,
            revenue_previous_year,
            revenue,
            growth_speed,
            lag(growth_speed,1) over(partition by declarant_iso order by year) growth_speed_previous_year,
        from growth_speed
    ),
    avg_acc AS (
        select 
            declarant_iso,
            year,
            revenue_first_year,
            revenue_last_year,
            growth_overall,
            revenue_previous_year,
            revenue,
            growth_speed_previous_year,
            growth_speed,
            growth_speed - growth_speed_previous_year as growth_acceleration,
            avg(growth_acceleration) over(partition by declarant_iso) as avg_acceleration
        from previous_year_growth_speed
    ),
    normalized as (
        select 
            declarant_iso,
            year,
            revenue_first_year,
            revenue_last_year,
            growth_overall,
            (growth_overall - min(growth_overall) OVER())/(max(growth_overall) OVER() - min(growth_overall) OVER()) as growth_overall_norm,
            revenue_previous_year,
            revenue,
            growth_speed_previous_year,
            growth_speed,
            growth_acceleration,
            avg_acceleration,
            (avg_acceleration - min(avg_acceleration) OVER())/(max(avg_acceleration) OVER() - min(avg_acceleration) OVER()) as avg_acceleration_norm
        from avg_acc 
    )
    select 
        declarant_iso,
        growth_overall_norm * avg_acceleration_norm as growth_score,
        array_agg(object_construct('year',year,'revenue',cast(revenue as string))) within group (order by year) as revenue_by_year
    from normalized 
    group by 1,2
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.growth_score"} */;
[0m23:52:46.813672 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.639 seconds
[0m23:52:46.817121 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '608794a6-e669-49ec-ab8d-a52ce4942094', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5178a10>]}
[0m23:52:46.817966 [info ] [Thread-3 (]: 5 of 8 OK created sql table model marts.score_2020 ............................. [[32mSUCCESS 1[0m in 0.68s]
[0m23:52:46.818857 [debug] [Thread-3 (]: Finished running node model.citrus_trade.score_2020
[0m23:52:46.973667 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.705 seconds
[0m23:52:46.978394 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '608794a6-e669-49ec-ab8d-a52ce4942094', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa517a450>]}
[0m23:52:46.979705 [info ] [Thread-1 (]: 6 of 8 OK created sql table model marts.growth_score ........................... [[32mSUCCESS 1[0m in 0.77s]
[0m23:52:46.980741 [debug] [Thread-1 (]: Finished running node model.citrus_trade.growth_score
[0m23:52:46.982460 [debug] [Thread-2 (]: Began running node model.citrus_trade.imports_score
[0m23:52:46.983301 [info ] [Thread-2 (]: 7 of 8 START sql table model marts.imports_score ............................... [RUN]
[0m23:52:46.984167 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.citrus_trade.imports_by_year, now model.citrus_trade.imports_score)
[0m23:52:46.984908 [debug] [Thread-2 (]: Began compiling node model.citrus_trade.imports_score
[0m23:52:46.990842 [debug] [Thread-2 (]: Writing injected SQL for node "model.citrus_trade.imports_score"
[0m23:52:46.992830 [debug] [Thread-2 (]: Began executing node model.citrus_trade.imports_score
[0m23:52:46.996543 [debug] [Thread-2 (]: Writing runtime sql for node "model.citrus_trade.imports_score"
[0m23:52:46.998892 [debug] [Thread-2 (]: Using snowflake connection "model.citrus_trade.imports_score"
[0m23:52:46.999481 [debug] [Thread-2 (]: On model.citrus_trade.imports_score: create or replace transient table TRADE_FLOW.marts.imports_score
    
    
    
    as (select distinct
    sc.declarant_iso,
    sc.revenue as revenue_2020,
    sc.quantity as quantity_2020,
    sc.price_avg as price_avg_2020,
    gs.revenue_by_year,
    sc.revenue_score,
    sc.quantity_score,
    sc.price_score,
    gs.growth_score
from TRADE_FLOW.marts.score_2020 as sc
inner join TRADE_FLOW.marts.growth_score as gs
    on gs.declarant_iso = sc.declarant_iso
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.imports_score"} */;
[0m23:52:47.674859 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.674 seconds
[0m23:52:47.680914 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '608794a6-e669-49ec-ab8d-a52ce4942094', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa51473e0>]}
[0m23:52:47.682357 [info ] [Thread-2 (]: 7 of 8 OK created sql table model marts.imports_score .......................... [[32mSUCCESS 1[0m in 0.70s]
[0m23:52:47.683709 [debug] [Thread-2 (]: Finished running node model.citrus_trade.imports_score
[0m23:52:47.685446 [debug] [Thread-3 (]: Began running node model.citrus_trade.imports_score_unpivot
[0m23:52:47.686297 [info ] [Thread-3 (]: 8 of 8 START sql table model analytics.imports_score_unpivot ................... [RUN]
[0m23:52:47.687148 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.citrus_trade.score_2020, now model.citrus_trade.imports_score_unpivot)
[0m23:52:47.687813 [debug] [Thread-3 (]: Began compiling node model.citrus_trade.imports_score_unpivot
[0m23:52:47.693134 [debug] [Thread-3 (]: Writing injected SQL for node "model.citrus_trade.imports_score_unpivot"
[0m23:52:47.695558 [debug] [Thread-3 (]: Began executing node model.citrus_trade.imports_score_unpivot
[0m23:52:47.699239 [debug] [Thread-3 (]: Writing runtime sql for node "model.citrus_trade.imports_score_unpivot"
[0m23:52:47.701998 [debug] [Thread-3 (]: Using snowflake connection "model.citrus_trade.imports_score_unpivot"
[0m23:52:47.702472 [debug] [Thread-3 (]: On model.citrus_trade.imports_score_unpivot: create or replace transient table TRADE_FLOW.analytics.imports_score_unpivot
    
    
    
    as (with 
    scores as (
        select 
            declarant_iso,
            score_type,
            score
        from TRADE_FLOW.marts.imports_score
        unpivot (
            score for score_type in (
                revenue_score as "revenue",
                quantity_score as "quantity",
                price_score as "price",
                growth_score as "growth"
            )
        )
    ),
    metrics as (
        select 
            declarant_iso,
            metric_type,
            metric
        from TRADE_FLOW.marts.imports_score
        unpivot (
            metric for metric_type in (
                revenue_2020 as "revenue",
                quantity_2020 as "quantity",
                price_avg_2020 as "price"
            )
        )
    )
select 
    s.declarant_iso,
    s.score_type,
    s.score,
    m.metric,
    case 
        when s.score_type = 'revenue' then 'Euro'
        when s.score_type = 'quantity' then 'Kg'
        when s.score_type = 'price' then 'Euro per Kg'
    end as metric_unit
from scores as s
left join metrics as m
    on s.declarant_iso = m.declarant_iso
    and s.score_type = m.metric_type
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.imports_score_unpivot"} */;
[0m23:52:48.276896 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.573 seconds
[0m23:52:48.281476 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '608794a6-e669-49ec-ab8d-a52ce4942094', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa51c01a0>]}
[0m23:52:48.282540 [info ] [Thread-3 (]: 8 of 8 OK created sql table model analytics.imports_score_unpivot .............. [[32mSUCCESS 1[0m in 0.59s]
[0m23:52:48.283959 [debug] [Thread-3 (]: Finished running node model.citrus_trade.imports_score_unpivot
[0m23:52:48.286134 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:52:48.286467 [debug] [MainThread]: Connection 'model.citrus_trade.imports_score_unpivot' was left open.
[0m23:52:48.286792 [debug] [MainThread]: On model.citrus_trade.imports_score_unpivot: Close
[0m23:52:48.433266 [debug] [MainThread]: Connection 'model.citrus_trade.imports_score' was left open.
[0m23:52:48.441790 [debug] [MainThread]: On model.citrus_trade.imports_score: Close
[0m23:52:48.518803 [debug] [MainThread]: Connection 'model.citrus_trade.growth_score' was left open.
[0m23:52:48.519302 [debug] [MainThread]: On model.citrus_trade.growth_score: Close
[0m23:52:48.600110 [info ] [MainThread]: 
[0m23:52:48.600785 [info ] [MainThread]: Finished running 8 table models in 0 hours 0 minutes and 5.46 seconds (5.46s).
[0m23:52:48.602491 [debug] [MainThread]: Command end result
[0m23:52:48.636551 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m23:52:48.645301 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m23:52:48.657184 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/target/run_results.json
[0m23:52:48.657601 [info ] [MainThread]: 
[0m23:52:48.658367 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:52:48.659243 [info ] [MainThread]: 
[0m23:52:48.659673 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=8
[0m23:52:48.661781 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.1858754, "process_in_blocks": "0", "process_kernel_time": 0.295662, "process_mem_max_rss": "151248", "process_out_blocks": "4297", "process_user_time": 1.926865}
[0m23:52:48.662475 [debug] [MainThread]: Command `dbt run` succeeded at 23:52:48.662368 after 6.19 seconds
[0m23:52:48.663061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa907b050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6ed27e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5d43980>]}
[0m23:52:48.663431 [debug] [MainThread]: Flushing usage events
[0m23:52:49.299782 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:54:52.662866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d62b2f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f31da00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d1136b0>]}


============================== 23:54:52.665753 | 67ffa40f-1239-400b-804c-6399f4e5dba6 ==============================
[0m23:54:52.665753 [info ] [MainThread]: Running with dbt=1.10.13
[0m23:54:52.666372 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'log_format': 'default', 'partial_parse': 'True', 'empty': 'False', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'write_json': 'True', 'no_print': 'None', 'target_path': 'None', 'quiet': 'False', 'version_check': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'profiles_dir': '/opt/airflow/dbt', 'printer_width': '80', 'indirect_selection': 'eager'}
[0m23:54:52.803247 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m23:54:52.803670 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m23:54:52.803890 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m23:54:52.898612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '67ffa40f-1239-400b-804c-6399f4e5dba6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b29a8d0>]}
[0m23:54:52.929548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '67ffa40f-1239-400b-804c-6399f4e5dba6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b18c6b0>]}
[0m23:54:52.930056 [info ] [MainThread]: Registered adapter: snowflake=1.10.3
[0m23:54:52.982236 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m23:54:53.110684 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 1 files changed.
[0m23:54:53.111049 [debug] [MainThread]: Partial parsing: added file: citrus_trade://models/staging/stg_trhs.sql
[0m23:54:53.111392 [debug] [MainThread]: Partial parsing: deleted file: citrus_trade://models/staging/stg_trade.sql
[0m23:54:53.111574 [debug] [MainThread]: Partial parsing: updated file: citrus_trade://models/marts/trade_by_hs.sql
[0m23:54:53.255633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '67ffa40f-1239-400b-804c-6399f4e5dba6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ac6a2a0>]}
[0m23:54:53.300503 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m23:54:53.301844 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m23:54:53.310984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '67ffa40f-1239-400b-804c-6399f4e5dba6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ab8cce0>]}
[0m23:54:53.311280 [info ] [MainThread]: Found 8 models, 3 sources, 636 macros
[0m23:54:53.311494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '67ffa40f-1239-400b-804c-6399f4e5dba6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9af2c680>]}
[0m23:54:53.312650 [info ] [MainThread]: 
[0m23:54:53.312873 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:54:53.313187 [info ] [MainThread]: 
[0m23:54:53.313666 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:54:53.316467 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRADE_FLOW'
[0m23:54:53.322797 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRADE_FLOW'
[0m23:54:53.325137 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_TRADE_FLOW'
[0m23:54:53.364277 [debug] [ThreadPool]: Using snowflake connection "list_TRADE_FLOW"
[0m23:54:53.364675 [debug] [ThreadPool]: Using snowflake connection "list_TRADE_FLOW"
[0m23:54:53.364938 [debug] [ThreadPool]: Using snowflake connection "list_TRADE_FLOW"
[0m23:54:53.365123 [debug] [ThreadPool]: On list_TRADE_FLOW: show terse schemas in database TRADE_FLOW
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRADE_FLOW"} */
[0m23:54:53.365390 [debug] [ThreadPool]: On list_TRADE_FLOW: show terse schemas in database TRADE_FLOW
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRADE_FLOW"} */
[0m23:54:53.365732 [debug] [ThreadPool]: On list_TRADE_FLOW: show terse schemas in database TRADE_FLOW
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRADE_FLOW"} */
[0m23:54:53.365964 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:54:53.366257 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:54:53.366505 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:54:54.003187 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.637 seconds
[0m23:54:54.004365 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.638 seconds
[0m23:54:54.005384 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.639 seconds
[0m23:54:54.013630 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRADE_FLOW, now list_TRADE_FLOW_marts)
[0m23:54:54.021157 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRADE_FLOW, now list_TRADE_FLOW_analytics)
[0m23:54:54.031607 [debug] [ThreadPool]: Using snowflake connection "list_TRADE_FLOW_analytics"
[0m23:54:54.033423 [debug] [ThreadPool]: Using snowflake connection "list_TRADE_FLOW_marts"
[0m23:54:54.033755 [debug] [ThreadPool]: On list_TRADE_FLOW_analytics: show objects in TRADE_FLOW.analytics
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRADE_FLOW_analytics"} */;
[0m23:54:54.034171 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_TRADE_FLOW, now list_TRADE_FLOW_staging)
[0m23:54:54.034592 [debug] [ThreadPool]: On list_TRADE_FLOW_marts: show objects in TRADE_FLOW.marts
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRADE_FLOW_marts"} */;
[0m23:54:54.037321 [debug] [ThreadPool]: Using snowflake connection "list_TRADE_FLOW_staging"
[0m23:54:54.039784 [debug] [ThreadPool]: On list_TRADE_FLOW_staging: show objects in TRADE_FLOW.staging
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "connection_name": "list_TRADE_FLOW_staging"} */;
[0m23:54:54.118723 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.080 seconds
[0m23:54:54.124960 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.085 seconds
[0m23:54:54.125917 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.091 seconds
[0m23:54:54.130723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '67ffa40f-1239-400b-804c-6399f4e5dba6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ad19c40>]}
[0m23:54:54.134808 [debug] [Thread-1 (]: Began running node model.citrus_trade.stg_trhs
[0m23:54:54.135422 [info ] [Thread-1 (]: 1 of 8 START sql table model staging.stg_trhs .................................. [RUN]
[0m23:54:54.136109 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_TRADE_FLOW_analytics, now model.citrus_trade.stg_trhs)
[0m23:54:54.136643 [debug] [Thread-1 (]: Began compiling node model.citrus_trade.stg_trhs
[0m23:54:54.145351 [debug] [Thread-1 (]: Writing injected SQL for node "model.citrus_trade.stg_trhs"
[0m23:54:54.147711 [debug] [Thread-1 (]: Began executing node model.citrus_trade.stg_trhs
[0m23:54:54.173941 [debug] [Thread-1 (]: Writing runtime sql for node "model.citrus_trade.stg_trhs"
[0m23:54:54.175785 [debug] [Thread-1 (]: Using snowflake connection "model.citrus_trade.stg_trhs"
[0m23:54:54.176090 [debug] [Thread-1 (]: On model.citrus_trade.stg_trhs: create or replace transient table TRADE_FLOW.staging.stg_trhs
    
    
    
    as (select
  value:DECLARANT::int as declarant,
  value:DECLARANT_ISO::string as declarant_iso,
  value:PARTNER::string as partner,
  value:PARTNER_ISO::string as partner_iso,
  value:FLOW::int as flow,
  value:TRANSPORT_MODE::int as transport_mode,
  value:PERIOD::int as period,
  year(to_date(left(period,4),'YYYY')) as year,
  value:HS4::string as hs4,
  value:HS4_NAME::string as hs4_name,
  value:HS6::string as hs6,
  value:HS6_NAME::string as hs6_name,
  value:VALUE_IN_EUROS::float as value_in_euros,
  value:QUANTITY_IN_KG::float as quantity_in_kg
from trade_flow.raw.raw_trhs
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.stg_trhs"} */;
[0m23:54:54.949062 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.772 seconds
[0m23:54:54.980952 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '67ffa40f-1239-400b-804c-6399f4e5dba6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9efb5af0>]}
[0m23:54:54.981985 [info ] [Thread-1 (]: 1 of 8 OK created sql table model staging.stg_trhs ............................. [[32mSUCCESS 1[0m in 0.84s]
[0m23:54:54.982908 [debug] [Thread-1 (]: Finished running node model.citrus_trade.stg_trhs
[0m23:54:54.984090 [debug] [Thread-3 (]: Began running node model.citrus_trade.trade_by_hs
[0m23:54:54.984716 [info ] [Thread-3 (]: 2 of 8 START sql table model marts.trade_by_hs ................................. [RUN]
[0m23:54:54.985304 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_TRADE_FLOW_marts, now model.citrus_trade.trade_by_hs)
[0m23:54:54.985846 [debug] [Thread-3 (]: Began compiling node model.citrus_trade.trade_by_hs
[0m23:54:54.990707 [debug] [Thread-3 (]: Writing injected SQL for node "model.citrus_trade.trade_by_hs"
[0m23:54:54.992965 [debug] [Thread-3 (]: Began executing node model.citrus_trade.trade_by_hs
[0m23:54:54.996277 [debug] [Thread-3 (]: Writing runtime sql for node "model.citrus_trade.trade_by_hs"
[0m23:54:54.998068 [debug] [Thread-3 (]: Using snowflake connection "model.citrus_trade.trade_by_hs"
[0m23:54:54.998705 [debug] [Thread-3 (]: On model.citrus_trade.trade_by_hs: create or replace transient table TRADE_FLOW.marts.trade_by_hs
    
    
    
    as (select
    *
from TRADE_FLOW.staging.stg_trhs
where hs6 = '080510'
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.trade_by_hs"} */;
[0m23:54:55.668197 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.667 seconds
[0m23:54:55.677151 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '67ffa40f-1239-400b-804c-6399f4e5dba6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff997cd220>]}
[0m23:54:55.678268 [info ] [Thread-3 (]: 2 of 8 OK created sql table model marts.trade_by_hs ............................ [[32mSUCCESS 1[0m in 0.69s]
[0m23:54:55.679423 [debug] [Thread-3 (]: Finished running node model.citrus_trade.trade_by_hs
[0m23:54:55.680846 [debug] [Thread-2 (]: Began running node model.citrus_trade.imports_by_year
[0m23:54:55.681491 [debug] [Thread-1 (]: Began running node model.citrus_trade.imports_exports_2020
[0m23:54:55.681996 [info ] [Thread-2 (]: 3 of 8 START sql table model marts.imports_by_year ............................. [RUN]
[0m23:54:55.683939 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_TRADE_FLOW_staging, now model.citrus_trade.imports_by_year)
[0m23:54:55.684435 [debug] [Thread-2 (]: Began compiling node model.citrus_trade.imports_by_year
[0m23:54:55.688240 [debug] [Thread-2 (]: Writing injected SQL for node "model.citrus_trade.imports_by_year"
[0m23:54:55.682897 [info ] [Thread-1 (]: 4 of 8 START sql table model marts.imports_exports_2020 ........................ [RUN]
[0m23:54:55.689066 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.citrus_trade.stg_trhs, now model.citrus_trade.imports_exports_2020)
[0m23:54:55.689609 [debug] [Thread-1 (]: Began compiling node model.citrus_trade.imports_exports_2020
[0m23:54:55.693090 [debug] [Thread-1 (]: Writing injected SQL for node "model.citrus_trade.imports_exports_2020"
[0m23:54:55.693950 [debug] [Thread-2 (]: Began executing node model.citrus_trade.imports_by_year
[0m23:54:55.697152 [debug] [Thread-2 (]: Writing runtime sql for node "model.citrus_trade.imports_by_year"
[0m23:54:55.697844 [debug] [Thread-1 (]: Began executing node model.citrus_trade.imports_exports_2020
[0m23:54:55.700514 [debug] [Thread-1 (]: Writing runtime sql for node "model.citrus_trade.imports_exports_2020"
[0m23:54:55.701915 [debug] [Thread-2 (]: Using snowflake connection "model.citrus_trade.imports_by_year"
[0m23:54:55.702672 [debug] [Thread-2 (]: On model.citrus_trade.imports_by_year: create or replace transient table TRADE_FLOW.marts.imports_by_year
    
    
    
    as (select
    declarant_iso,
    year,
    sum(value_in_euros) as revenue,
    sum(quantity_in_kg) as quantity,
    revenue/nullif(quantity,0) as price_avg
from TRADE_FLOW.marts.trade_by_hs
where flow = 1
group by 1,2
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.imports_by_year"} */;
[0m23:54:55.703761 [debug] [Thread-1 (]: Using snowflake connection "model.citrus_trade.imports_exports_2020"
[0m23:54:55.705653 [debug] [Thread-1 (]: On model.citrus_trade.imports_exports_2020: create or replace transient table TRADE_FLOW.marts.imports_exports_2020
    
    
    
    as (select
    declarant_iso,
    flow,
    sum(value_in_euros) over(partition by declarant_iso, flow) as revenue,
    sum(quantity_in_kg) over(partition by declarant_iso, flow) as quantity,
    revenue/nullif(quantity,0) as price_avg
from TRADE_FLOW.marts.trade_by_hs
where year = 2020
group by 
    declarant_iso,
    flow,
    value_in_euros,
    quantity_in_kg
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.imports_exports_2020"} */;
[0m23:54:56.328127 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.624 seconds
[0m23:54:56.330364 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '67ffa40f-1239-400b-804c-6399f4e5dba6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff993538c0>]}
[0m23:54:56.330902 [info ] [Thread-2 (]: 3 of 8 OK created sql table model marts.imports_by_year ........................ [[32mSUCCESS 1[0m in 0.65s]
[0m23:54:56.331576 [debug] [Thread-2 (]: Finished running node model.citrus_trade.imports_by_year
[0m23:54:56.332133 [debug] [Thread-3 (]: Began running node model.citrus_trade.growth_score
[0m23:54:56.332548 [info ] [Thread-3 (]: 5 of 8 START sql table model marts.growth_score ................................ [RUN]
[0m23:54:56.332916 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.citrus_trade.trade_by_hs, now model.citrus_trade.growth_score)
[0m23:54:56.333203 [debug] [Thread-3 (]: Began compiling node model.citrus_trade.growth_score
[0m23:54:56.335669 [debug] [Thread-3 (]: Writing injected SQL for node "model.citrus_trade.growth_score"
[0m23:54:56.336575 [debug] [Thread-3 (]: Began executing node model.citrus_trade.growth_score
[0m23:54:56.338456 [debug] [Thread-3 (]: Writing runtime sql for node "model.citrus_trade.growth_score"
[0m23:54:56.340668 [debug] [Thread-3 (]: Using snowflake connection "model.citrus_trade.growth_score"
[0m23:54:56.340988 [debug] [Thread-3 (]: On model.citrus_trade.growth_score: create or replace transient table TRADE_FLOW.marts.growth_score
    
    
    
    as (with 
    previous_year AS (
        select 
            declarant_iso,
            year,
            lag(revenue,1) over(partition by declarant_iso order by year) revenue_previous_year,
            revenue,
            first_value(revenue) over(partition by declarant_iso order by year) as revenue_first_year,
            last_value(revenue) over(partition by declarant_iso order by year) as revenue_last_year
        from TRADE_FLOW.marts.imports_by_year
    ),
    growth_speed AS (
        select 
            declarant_iso,
            year,
            revenue_first_year,
            revenue_last_year,
            revenue_last_year/nullif(revenue_first_year,0) as growth_overall,
            revenue_previous_year,
            revenue,
            (revenue - revenue_previous_year)/revenue * 100 as growth_speed 
        from previous_year
    ),
    previous_year_growth_speed AS (
        select 
            declarant_iso,
            year,
            revenue_first_year,
            revenue_last_year,
            growth_overall,
            revenue_previous_year,
            revenue,
            growth_speed,
            lag(growth_speed,1) over(partition by declarant_iso order by year) growth_speed_previous_year,
        from growth_speed
    ),
    avg_acc AS (
        select 
            declarant_iso,
            year,
            revenue_first_year,
            revenue_last_year,
            growth_overall,
            revenue_previous_year,
            revenue,
            growth_speed_previous_year,
            growth_speed,
            growth_speed - growth_speed_previous_year as growth_acceleration,
            avg(growth_acceleration) over(partition by declarant_iso) as avg_acceleration
        from previous_year_growth_speed
    ),
    normalized as (
        select 
            declarant_iso,
            year,
            revenue_first_year,
            revenue_last_year,
            growth_overall,
            (growth_overall - min(growth_overall) OVER())/(max(growth_overall) OVER() - min(growth_overall) OVER()) as growth_overall_norm,
            revenue_previous_year,
            revenue,
            growth_speed_previous_year,
            growth_speed,
            growth_acceleration,
            avg_acceleration,
            (avg_acceleration - min(avg_acceleration) OVER())/(max(avg_acceleration) OVER() - min(avg_acceleration) OVER()) as avg_acceleration_norm
        from avg_acc 
    )
    select 
        declarant_iso,
        growth_overall_norm * avg_acceleration_norm as growth_score,
        array_agg(object_construct('year',year,'revenue',cast(revenue as string))) within group (order by year) as revenue_by_year
    from normalized 
    group by 1,2
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.growth_score"} */;
[0m23:54:56.352113 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.646 seconds
[0m23:54:56.353341 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '67ffa40f-1239-400b-804c-6399f4e5dba6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98f797f0>]}
[0m23:54:56.353764 [info ] [Thread-1 (]: 4 of 8 OK created sql table model marts.imports_exports_2020 ................... [[32mSUCCESS 1[0m in 0.66s]
[0m23:54:56.354143 [debug] [Thread-1 (]: Finished running node model.citrus_trade.imports_exports_2020
[0m23:54:56.354587 [debug] [Thread-2 (]: Began running node model.citrus_trade.score_2020
[0m23:54:56.354839 [info ] [Thread-2 (]: 6 of 8 START sql table model marts.score_2020 .................................. [RUN]
[0m23:54:56.355062 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.citrus_trade.imports_by_year, now model.citrus_trade.score_2020)
[0m23:54:56.355276 [debug] [Thread-2 (]: Began compiling node model.citrus_trade.score_2020
[0m23:54:56.357077 [debug] [Thread-2 (]: Writing injected SQL for node "model.citrus_trade.score_2020"
[0m23:54:56.358042 [debug] [Thread-2 (]: Began executing node model.citrus_trade.score_2020
[0m23:54:56.359631 [debug] [Thread-2 (]: Writing runtime sql for node "model.citrus_trade.score_2020"
[0m23:54:56.360599 [debug] [Thread-2 (]: Using snowflake connection "model.citrus_trade.score_2020"
[0m23:54:56.360836 [debug] [Thread-2 (]: On model.citrus_trade.score_2020: create or replace transient table TRADE_FLOW.marts.score_2020
    
    
    
    as (select distinct 
    declarant_iso,
    revenue,
    quantity,
    price_avg,
    (revenue - min(revenue) over())/((max(revenue) over())-(min(revenue) over())) as revenue_score,
    (quantity - min(quantity) over())/((max(quantity) over())-(min(quantity) over())) as quantity_score,
    (price_avg - min(price_avg) over())/((max(price_avg) over())-(min(price_avg) over())) as price_score
from TRADE_FLOW.marts.imports_exports_2020
where flow = 1
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.score_2020"} */;
[0m23:54:57.100372 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.739 seconds
[0m23:54:57.105588 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '67ffa40f-1239-400b-804c-6399f4e5dba6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98f04fb0>]}
[0m23:54:57.107023 [info ] [Thread-2 (]: 6 of 8 OK created sql table model marts.score_2020 ............................. [[32mSUCCESS 1[0m in 0.75s]
[0m23:54:57.110188 [debug] [Thread-2 (]: Finished running node model.citrus_trade.score_2020
[0m23:54:57.109443 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.768 seconds
[0m23:54:57.113338 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '67ffa40f-1239-400b-804c-6399f4e5dba6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99330890>]}
[0m23:54:57.114165 [info ] [Thread-3 (]: 5 of 8 OK created sql table model marts.growth_score ........................... [[32mSUCCESS 1[0m in 0.78s]
[0m23:54:57.115058 [debug] [Thread-3 (]: Finished running node model.citrus_trade.growth_score
[0m23:54:57.115985 [debug] [Thread-1 (]: Began running node model.citrus_trade.imports_score
[0m23:54:57.116798 [info ] [Thread-1 (]: 7 of 8 START sql table model marts.imports_score ............................... [RUN]
[0m23:54:57.117440 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.citrus_trade.imports_exports_2020, now model.citrus_trade.imports_score)
[0m23:54:57.118083 [debug] [Thread-1 (]: Began compiling node model.citrus_trade.imports_score
[0m23:54:57.122576 [debug] [Thread-1 (]: Writing injected SQL for node "model.citrus_trade.imports_score"
[0m23:54:57.124306 [debug] [Thread-1 (]: Began executing node model.citrus_trade.imports_score
[0m23:54:57.127629 [debug] [Thread-1 (]: Writing runtime sql for node "model.citrus_trade.imports_score"
[0m23:54:57.129484 [debug] [Thread-1 (]: Using snowflake connection "model.citrus_trade.imports_score"
[0m23:54:57.129972 [debug] [Thread-1 (]: On model.citrus_trade.imports_score: create or replace transient table TRADE_FLOW.marts.imports_score
    
    
    
    as (select distinct
    sc.declarant_iso,
    sc.revenue as revenue_2020,
    sc.quantity as quantity_2020,
    sc.price_avg as price_avg_2020,
    gs.revenue_by_year,
    sc.revenue_score,
    sc.quantity_score,
    sc.price_score,
    gs.growth_score
from TRADE_FLOW.marts.score_2020 as sc
inner join TRADE_FLOW.marts.growth_score as gs
    on gs.declarant_iso = sc.declarant_iso
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.imports_score"} */;
[0m23:54:57.919922 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.789 seconds
[0m23:54:57.925611 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '67ffa40f-1239-400b-804c-6399f4e5dba6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98f8b3b0>]}
[0m23:54:57.927059 [info ] [Thread-1 (]: 7 of 8 OK created sql table model marts.imports_score .......................... [[32mSUCCESS 1[0m in 0.81s]
[0m23:54:57.928175 [debug] [Thread-1 (]: Finished running node model.citrus_trade.imports_score
[0m23:54:57.929855 [debug] [Thread-2 (]: Began running node model.citrus_trade.imports_score_unpivot
[0m23:54:57.930750 [info ] [Thread-2 (]: 8 of 8 START sql table model analytics.imports_score_unpivot ................... [RUN]
[0m23:54:57.931573 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.citrus_trade.score_2020, now model.citrus_trade.imports_score_unpivot)
[0m23:54:57.932255 [debug] [Thread-2 (]: Began compiling node model.citrus_trade.imports_score_unpivot
[0m23:54:57.937187 [debug] [Thread-2 (]: Writing injected SQL for node "model.citrus_trade.imports_score_unpivot"
[0m23:54:57.939986 [debug] [Thread-2 (]: Began executing node model.citrus_trade.imports_score_unpivot
[0m23:54:57.943671 [debug] [Thread-2 (]: Writing runtime sql for node "model.citrus_trade.imports_score_unpivot"
[0m23:54:57.946259 [debug] [Thread-2 (]: Using snowflake connection "model.citrus_trade.imports_score_unpivot"
[0m23:54:57.946753 [debug] [Thread-2 (]: On model.citrus_trade.imports_score_unpivot: create or replace transient table TRADE_FLOW.analytics.imports_score_unpivot
    
    
    
    as (with 
    scores as (
        select 
            declarant_iso,
            score_type,
            score
        from TRADE_FLOW.marts.imports_score
        unpivot (
            score for score_type in (
                revenue_score as "revenue",
                quantity_score as "quantity",
                price_score as "price",
                growth_score as "growth"
            )
        )
    ),
    metrics as (
        select 
            declarant_iso,
            metric_type,
            metric
        from TRADE_FLOW.marts.imports_score
        unpivot (
            metric for metric_type in (
                revenue_2020 as "revenue",
                quantity_2020 as "quantity",
                price_avg_2020 as "price"
            )
        )
    )
select 
    s.declarant_iso,
    s.score_type,
    s.score,
    m.metric,
    case 
        when s.score_type = 'revenue' then 'Euro'
        when s.score_type = 'quantity' then 'Kg'
        when s.score_type = 'price' then 'Euro per Kg'
    end as metric_unit
from scores as s
left join metrics as m
    on s.declarant_iso = m.declarant_iso
    and s.score_type = m.metric_type
    )

/* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "citrus_trade", "target_name": "dev", "node_id": "model.citrus_trade.imports_score_unpivot"} */;
[0m23:54:58.533834 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.586 seconds
[0m23:54:58.537033 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '67ffa40f-1239-400b-804c-6399f4e5dba6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98fa7440>]}
[0m23:54:58.537793 [info ] [Thread-2 (]: 8 of 8 OK created sql table model analytics.imports_score_unpivot .............. [[32mSUCCESS 1[0m in 0.61s]
[0m23:54:58.538404 [debug] [Thread-2 (]: Finished running node model.citrus_trade.imports_score_unpivot
[0m23:54:58.541333 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:54:58.541698 [debug] [MainThread]: Connection 'model.citrus_trade.imports_score' was left open.
[0m23:54:58.541917 [debug] [MainThread]: On model.citrus_trade.imports_score: Close
[0m23:54:58.666403 [debug] [MainThread]: Connection 'model.citrus_trade.imports_score_unpivot' was left open.
[0m23:54:58.667008 [debug] [MainThread]: On model.citrus_trade.imports_score_unpivot: Close
[0m23:54:58.751927 [debug] [MainThread]: Connection 'model.citrus_trade.growth_score' was left open.
[0m23:54:58.752703 [debug] [MainThread]: On model.citrus_trade.growth_score: Close
[0m23:54:58.849282 [info ] [MainThread]: 
[0m23:54:58.850610 [info ] [MainThread]: Finished running 8 table models in 0 hours 0 minutes and 5.54 seconds (5.54s).
[0m23:54:58.854798 [debug] [MainThread]: Command end result
[0m23:54:58.908161 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m23:54:58.910634 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m23:54:58.916803 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/target/run_results.json
[0m23:54:58.917139 [info ] [MainThread]: 
[0m23:54:58.917466 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:54:58.917779 [info ] [MainThread]: 
[0m23:54:58.918228 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=8
[0m23:54:58.919953 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.2862606, "process_in_blocks": "0", "process_kernel_time": 0.399526, "process_mem_max_rss": "151292", "process_out_blocks": "4297", "process_user_time": 1.930543}
[0m23:54:58.920608 [debug] [MainThread]: Command `dbt run` succeeded at 23:54:58.920456 after 6.29 seconds
[0m23:54:58.921037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d1136b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ab1c800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ca1cad0>]}
[0m23:54:58.921310 [debug] [MainThread]: Flushing usage events
[0m23:54:59.514614 [debug] [MainThread]: An error was encountered while trying to flush usage events
